2024-08-12 12:49:38,230 : INFO : Starting to tokenize the sequences.
2024-08-12 12:49:38,810 : INFO : Tokenization is finished.
2024-08-12 12:49:38,844 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 414, 2011,  948]))
2024-08-12 12:49:38,847 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([100, 524, 220]))
[I 2024-08-12 12:49:38,847] A new study created in memory with name: no-name-b4fe0e92-f863-4a69-adaf-ca649fd79a81
2024-08-12 12:49:38,847 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:49:38,847 : INFO : Starting training for split 1
2024-08-12 12:49:38,857 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 328, 1596,  774]))
2024-08-12 12:49:38,859 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 86, 415, 174]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:49:39,277 : INFO : Starting epoch 1
2024-08-12 12:49:39,621 : INFO : Current training batch loss: 1.1107 in epoch 1
2024-08-12 12:49:40,423 : INFO : Current training batch loss: 0.6637 in epoch 1
2024-08-12 12:49:41,225 : INFO : Current training batch loss: 0.8251 in epoch 1
2024-08-12 12:49:42,027 : INFO : Current training batch loss: 0.9321 in epoch 1
2024-08-12 12:49:42,829 : INFO : Current training batch loss: 0.9221 in epoch 1
2024-08-12 12:49:42,975 : INFO : Epoch finished, average loss over training batches: 0.8680
2024-08-12 12:49:42,979 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:49:42,979 : INFO : Training metrics:
2024-08-12 12:49:42,979 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:49:42,984 : INFO : Accuracy: 0.6294
2024-08-12 12:49:42,984 : INFO : Precision score for label_class 0: 0.1444
2024-08-12 12:49:42,984 : INFO : Precision score for label_class 1: 0.6762
2024-08-12 12:49:42,984 : INFO : Precision score for label_class 2: 0.5000
2024-08-12 12:49:42,984 : INFO : Recall score for label_class 0: 0.0396
2024-08-12 12:49:42,984 : INFO : Recall score for label_class 1: 0.9160
2024-08-12 12:49:42,984 : INFO : Recall score for label_class 2: 0.2881
2024-08-12 12:49:42,984 : INFO : Average F1 score: 0.4019
2024-08-12 12:49:43,259 : INFO : Average loss over validation batches: 0.8196
2024-08-12 12:49:43,259 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:49:43,259 : INFO : Validation metrics:
2024-08-12 12:49:43,259 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:49:43,261 : INFO : Accuracy: 0.6652
2024-08-12 12:49:43,261 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:49:43,261 : INFO : Precision score for label_class 1: 0.7271
2024-08-12 12:49:43,261 : INFO : Precision score for label_class 2: 0.4286
2024-08-12 12:49:43,261 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:49:43,261 : INFO : Recall score for label_class 1: 0.9373
2024-08-12 12:49:43,261 : INFO : Recall score for label_class 2: 0.3448
2024-08-12 12:49:43,262 : INFO : Average F1 score: 0.4004
2024-08-12 12:49:43,262 : INFO : Validation metric decreased (inf --> 0.819638).  Saving model ...
2024-08-12 12:49:43,342 : INFO : Starting epoch 2
2024-08-12 12:49:43,984 : INFO : Current training batch loss: 0.5910 in epoch 2
2024-08-12 12:49:44,786 : INFO : Current training batch loss: 0.7854 in epoch 2
2024-08-12 12:49:45,587 : INFO : Current training batch loss: 0.8683 in epoch 2
2024-08-12 12:49:46,389 : INFO : Current training batch loss: 0.7089 in epoch 2
2024-08-12 12:49:46,733 : INFO : Epoch finished, average loss over training batches: 0.8117
2024-08-12 12:49:46,734 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:49:46,734 : INFO : Training metrics:
2024-08-12 12:49:46,734 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:49:46,738 : INFO : Accuracy: 0.6642
2024-08-12 12:49:46,738 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:49:46,738 : INFO : Precision score for label_class 1: 0.7157
2024-08-12 12:49:46,738 : INFO : Precision score for label_class 2: 0.4936
2024-08-12 12:49:46,738 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:49:46,738 : INFO : Recall score for label_class 1: 0.9292
2024-08-12 12:49:46,738 : INFO : Recall score for label_class 2: 0.3992
2024-08-12 12:49:46,738 : INFO : Average F1 score: 0.4167
2024-08-12 12:49:47,011 : INFO : Average loss over validation batches: 0.8144
2024-08-12 12:49:47,012 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:49:47,012 : INFO : Validation metrics:
2024-08-12 12:49:47,012 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:49:47,014 : INFO : Accuracy: 0.6637
2024-08-12 12:49:47,014 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:49:47,014 : INFO : Precision score for label_class 1: 0.7323
2024-08-12 12:49:47,014 : INFO : Precision score for label_class 2: 0.4276
2024-08-12 12:49:47,014 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:49:47,014 : INFO : Recall score for label_class 1: 0.9229
2024-08-12 12:49:47,014 : INFO : Recall score for label_class 2: 0.3736
2024-08-12 12:49:47,014 : INFO : Average F1 score: 0.4051
2024-08-12 12:49:47,014 : INFO : Validation metric decreased (0.819638 --> 0.814396).  Saving model ...
2024-08-12 12:49:47,112 : INFO : Starting epoch 3
2024-08-12 12:49:47,554 : INFO : Current training batch loss: 0.8100 in epoch 3
2024-08-12 12:49:48,356 : INFO : Current training batch loss: 0.7885 in epoch 3
2024-08-12 12:49:49,159 : INFO : Current training batch loss: 0.7265 in epoch 3
2024-08-12 12:49:49,962 : INFO : Current training batch loss: 0.6557 in epoch 3
2024-08-12 12:49:50,507 : INFO : Epoch finished, average loss over training batches: 0.8086
2024-08-12 12:49:50,507 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:49:50,507 : INFO : Training metrics:
2024-08-12 12:49:50,507 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:49:50,511 : INFO : Accuracy: 0.6649
2024-08-12 12:49:50,511 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:49:50,511 : INFO : Precision score for label_class 1: 0.7185
2024-08-12 12:49:50,511 : INFO : Precision score for label_class 2: 0.4930
2024-08-12 12:49:50,511 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:49:50,512 : INFO : Recall score for label_class 1: 0.9261
2024-08-12 12:49:50,512 : INFO : Recall score for label_class 2: 0.4083
2024-08-12 12:49:50,512 : INFO : Average F1 score: 0.4186
2024-08-12 12:49:50,785 : INFO : Average loss over validation batches: 0.8149
2024-08-12 12:49:50,786 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:49:50,786 : INFO : Validation metrics:
2024-08-12 12:49:50,786 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:49:50,788 : INFO : Accuracy: 0.6637
2024-08-12 12:49:50,788 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:49:50,788 : INFO : Precision score for label_class 1: 0.7323
2024-08-12 12:49:50,788 : INFO : Precision score for label_class 2: 0.4276
2024-08-12 12:49:50,788 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:49:50,788 : INFO : Recall score for label_class 1: 0.9229
2024-08-12 12:49:50,788 : INFO : Recall score for label_class 2: 0.3736
2024-08-12 12:49:50,788 : INFO : Average F1 score: 0.4051
2024-08-12 12:49:50,789 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 12:49:50,789 : INFO : Starting epoch 4
2024-08-12 12:49:51,030 : INFO : Current training batch loss: 0.8556 in epoch 4
2024-08-12 12:49:51,834 : INFO : Current training batch loss: 0.8039 in epoch 4
2024-08-12 12:49:52,635 : INFO : Current training batch loss: 0.6786 in epoch 4
2024-08-12 12:49:53,438 : INFO : Current training batch loss: 0.6687 in epoch 4
2024-08-12 12:49:54,183 : INFO : Epoch finished, average loss over training batches: 0.8068
2024-08-12 12:49:54,183 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:49:54,183 : INFO : Training metrics:
2024-08-12 12:49:54,183 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:49:54,187 : INFO : Accuracy: 0.6653
2024-08-12 12:49:54,188 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:49:54,188 : INFO : Precision score for label_class 1: 0.7189
2024-08-12 12:49:54,188 : INFO : Precision score for label_class 2: 0.4938
2024-08-12 12:49:54,188 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:49:54,188 : INFO : Recall score for label_class 1: 0.9261
2024-08-12 12:49:54,188 : INFO : Recall score for label_class 2: 0.4096
2024-08-12 12:49:54,188 : INFO : Average F1 score: 0.4191
2024-08-12 12:49:54,461 : INFO : Average loss over validation batches: 0.8154
2024-08-12 12:49:54,461 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:49:54,461 : INFO : Validation metrics:
2024-08-12 12:49:54,461 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:49:54,464 : INFO : Accuracy: 0.6637
2024-08-12 12:49:54,464 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:49:54,464 : INFO : Precision score for label_class 1: 0.7323
2024-08-12 12:49:54,464 : INFO : Precision score for label_class 2: 0.4276
2024-08-12 12:49:54,464 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:49:54,464 : INFO : Recall score for label_class 1: 0.9229
2024-08-12 12:49:54,464 : INFO : Recall score for label_class 2: 0.3736
2024-08-12 12:49:54,464 : INFO : Average F1 score: 0.4051
2024-08-12 12:49:54,464 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 12:49:54,464 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:49:54,502 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 12:49:54,812 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:49:54,812 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 12:49:54,812 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:49:54,815 : INFO : Accuracy: 0.6637
2024-08-12 12:49:54,815 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:49:54,815 : INFO : Precision score for label_class 1: 0.7323
2024-08-12 12:49:54,815 : INFO : Precision score for label_class 2: 0.4276
2024-08-12 12:49:54,815 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:49:54,815 : INFO : Recall score for label_class 1: 0.9229
2024-08-12 12:49:54,815 : INFO : Recall score for label_class 2: 0.3736
2024-08-12 12:49:54,815 : INFO : Average F1 score: 0.4051
2024-08-12 12:49:54,815 : INFO : Determined score from best model, ending training.
2024-08-12 12:49:54,816 : INFO : Split 1 is finished, the score is: 0.4051
2024-08-12 12:49:54,817 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:49:54,817 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:49:54,817 : INFO : Starting training for split 2
2024-08-12 12:49:54,828 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 343, 1601,  754]))
2024-08-12 12:49:54,830 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 71, 410, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:49:54,868 : INFO : Starting epoch 1
2024-08-12 12:49:54,910 : INFO : Current training batch loss: 1.0790 in epoch 1
2024-08-12 12:49:55,712 : INFO : Current training batch loss: 1.0040 in epoch 1
2024-08-12 12:49:56,515 : INFO : Current training batch loss: 0.8806 in epoch 1
2024-08-12 12:49:57,318 : INFO : Current training batch loss: 0.9076 in epoch 1
2024-08-12 12:49:58,121 : INFO : Current training batch loss: 0.6248 in epoch 1
2024-08-12 12:49:58,263 : INFO : Epoch finished, average loss over training batches: 0.7171
2024-08-12 12:49:58,264 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:49:58,264 : INFO : Training metrics:
2024-08-12 12:49:58,264 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:49:58,274 : INFO : Accuracy: 0.7016
2024-08-12 12:49:58,274 : INFO : Precision score for label_class 0: 0.5464
2024-08-12 12:49:58,274 : INFO : Precision score for label_class 1: 0.7400
2024-08-12 12:49:58,274 : INFO : Precision score for label_class 2: 0.6190
2024-08-12 12:49:58,274 : INFO : Recall score for label_class 0: 0.3090
2024-08-12 12:49:58,274 : INFO : Recall score for label_class 1: 0.9051
2024-08-12 12:49:58,274 : INFO : Recall score for label_class 2: 0.4483
2024-08-12 12:49:58,274 : INFO : Average F1 score: 0.5764
2024-08-12 12:49:58,549 : INFO : Average loss over validation batches: 0.5643
2024-08-12 12:49:58,549 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:49:58,549 : INFO : Validation metrics:
2024-08-12 12:49:58,549 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:49:58,553 : INFO : Accuracy: 0.7896
2024-08-12 12:49:58,553 : INFO : Precision score for label_class 0: 0.7609
2024-08-12 12:49:58,553 : INFO : Precision score for label_class 1: 0.7890
2024-08-12 12:49:58,553 : INFO : Precision score for label_class 2: 0.8015
2024-08-12 12:49:58,553 : INFO : Recall score for label_class 0: 0.4930
2024-08-12 12:49:58,553 : INFO : Recall score for label_class 1: 0.9488
2024-08-12 12:49:58,553 : INFO : Recall score for label_class 2: 0.5619
2024-08-12 12:49:58,554 : INFO : Average F1 score: 0.7068
2024-08-12 12:49:58,554 : INFO : Validation metric decreased (inf --> 0.564346).  Saving model ...
2024-08-12 12:49:58,650 : INFO : Starting epoch 2
2024-08-12 12:49:59,293 : INFO : Current training batch loss: 0.5447 in epoch 2
2024-08-12 12:50:00,095 : INFO : Current training batch loss: 0.5138 in epoch 2
2024-08-12 12:50:00,898 : INFO : Current training batch loss: 0.3396 in epoch 2
2024-08-12 12:50:01,701 : INFO : Current training batch loss: 0.4206 in epoch 2
2024-08-12 12:50:02,043 : INFO : Epoch finished, average loss over training batches: 0.4568
2024-08-12 12:50:02,044 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:02,044 : INFO : Training metrics:
2024-08-12 12:50:02,044 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:02,053 : INFO : Accuracy: 0.8251
2024-08-12 12:50:02,053 : INFO : Precision score for label_class 0: 0.6651
2024-08-12 12:50:02,053 : INFO : Precision score for label_class 1: 0.8914
2024-08-12 12:50:02,053 : INFO : Precision score for label_class 2: 0.7719
2024-08-12 12:50:02,053 : INFO : Recall score for label_class 0: 0.8338
2024-08-12 12:50:02,053 : INFO : Recall score for label_class 1: 0.8819
2024-08-12 12:50:02,053 : INFO : Recall score for label_class 2: 0.7003
2024-08-12 12:50:02,053 : INFO : Average F1 score: 0.7870
2024-08-12 12:50:02,328 : INFO : Average loss over validation batches: 0.4977
2024-08-12 12:50:02,329 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:02,329 : INFO : Validation metrics:
2024-08-12 12:50:02,329 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:02,332 : INFO : Accuracy: 0.7911
2024-08-12 12:50:02,332 : INFO : Precision score for label_class 0: 0.6146
2024-08-12 12:50:02,332 : INFO : Precision score for label_class 1: 0.8983
2024-08-12 12:50:02,332 : INFO : Precision score for label_class 2: 0.6978
2024-08-12 12:50:02,332 : INFO : Recall score for label_class 0: 0.8310
2024-08-12 12:50:02,332 : INFO : Recall score for label_class 1: 0.7756
2024-08-12 12:50:02,332 : INFO : Recall score for label_class 2: 0.8093
2024-08-12 12:50:02,332 : INFO : Average F1 score: 0.7628
2024-08-12 12:50:02,332 : INFO : Validation metric decreased (0.564346 --> 0.497689).  Saving model ...
2024-08-12 12:50:02,430 : INFO : Starting epoch 3
2024-08-12 12:50:02,872 : INFO : Current training batch loss: 0.5572 in epoch 3
2024-08-12 12:50:03,676 : INFO : Current training batch loss: 0.3243 in epoch 3
2024-08-12 12:50:04,480 : INFO : Current training batch loss: 0.2485 in epoch 3
2024-08-12 12:50:05,283 : INFO : Current training batch loss: 0.3170 in epoch 3
2024-08-12 12:50:05,827 : INFO : Epoch finished, average loss over training batches: 0.3047
2024-08-12 12:50:05,827 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:05,827 : INFO : Training metrics:
2024-08-12 12:50:05,827 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:05,838 : INFO : Accuracy: 0.8921
2024-08-12 12:50:05,838 : INFO : Precision score for label_class 0: 0.7644
2024-08-12 12:50:05,838 : INFO : Precision score for label_class 1: 0.9327
2024-08-12 12:50:05,838 : INFO : Precision score for label_class 2: 0.8703
2024-08-12 12:50:05,838 : INFO : Recall score for label_class 0: 0.8513
2024-08-12 12:50:05,838 : INFO : Recall score for label_class 1: 0.9269
2024-08-12 12:50:05,838 : INFO : Recall score for label_class 2: 0.8369
2024-08-12 12:50:05,838 : INFO : Average F1 score: 0.8629
2024-08-12 12:50:06,113 : INFO : Average loss over validation batches: 0.5165
2024-08-12 12:50:06,113 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:06,113 : INFO : Validation metrics:
2024-08-12 12:50:06,113 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:06,117 : INFO : Accuracy: 0.8030
2024-08-12 12:50:06,117 : INFO : Precision score for label_class 0: 0.6829
2024-08-12 12:50:06,117 : INFO : Precision score for label_class 1: 0.8981
2024-08-12 12:50:06,117 : INFO : Precision score for label_class 2: 0.6957
2024-08-12 12:50:06,117 : INFO : Recall score for label_class 0: 0.7887
2024-08-12 12:50:06,117 : INFO : Recall score for label_class 1: 0.7951
2024-08-12 12:50:06,117 : INFO : Recall score for label_class 2: 0.8247
2024-08-12 12:50:06,117 : INFO : Average F1 score: 0.7767
2024-08-12 12:50:06,117 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 12:50:06,117 : INFO : Starting epoch 4
2024-08-12 12:50:06,359 : INFO : Current training batch loss: 0.5409 in epoch 4
2024-08-12 12:50:07,163 : INFO : Current training batch loss: 0.0999 in epoch 4
2024-08-12 12:50:07,967 : INFO : Current training batch loss: 0.1976 in epoch 4
2024-08-12 12:50:08,771 : INFO : Current training batch loss: 0.1050 in epoch 4
2024-08-12 12:50:09,515 : INFO : Epoch finished, average loss over training batches: 0.2005
2024-08-12 12:50:09,515 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:09,516 : INFO : Training metrics:
2024-08-12 12:50:09,516 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:09,526 : INFO : Accuracy: 0.9385
2024-08-12 12:50:09,526 : INFO : Precision score for label_class 0: 0.8363
2024-08-12 12:50:09,526 : INFO : Precision score for label_class 1: 0.9738
2024-08-12 12:50:09,526 : INFO : Precision score for label_class 2: 0.9176
2024-08-12 12:50:09,526 : INFO : Recall score for label_class 0: 0.9534
2024-08-12 12:50:09,526 : INFO : Recall score for label_class 1: 0.9532
2024-08-12 12:50:09,526 : INFO : Recall score for label_class 2: 0.9005
2024-08-12 12:50:09,526 : INFO : Average F1 score: 0.9211
2024-08-12 12:50:09,802 : INFO : Average loss over validation batches: 0.5534
2024-08-12 12:50:09,802 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:09,802 : INFO : Validation metrics:
2024-08-12 12:50:09,802 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:09,806 : INFO : Accuracy: 0.8356
2024-08-12 12:50:09,806 : INFO : Precision score for label_class 0: 0.8000
2024-08-12 12:50:09,806 : INFO : Precision score for label_class 1: 0.8545
2024-08-12 12:50:09,806 : INFO : Precision score for label_class 2: 0.8022
2024-08-12 12:50:09,806 : INFO : Recall score for label_class 0: 0.6761
2024-08-12 12:50:09,806 : INFO : Recall score for label_class 1: 0.9024
2024-08-12 12:50:09,806 : INFO : Recall score for label_class 2: 0.7526
2024-08-12 12:50:09,806 : INFO : Average F1 score: 0.7957
2024-08-12 12:50:09,806 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 12:50:09,806 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:50:09,836 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 12:50:10,147 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:10,147 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 12:50:10,148 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:10,151 : INFO : Accuracy: 0.7911
2024-08-12 12:50:10,151 : INFO : Precision score for label_class 0: 0.6146
2024-08-12 12:50:10,151 : INFO : Precision score for label_class 1: 0.8983
2024-08-12 12:50:10,151 : INFO : Precision score for label_class 2: 0.6978
2024-08-12 12:50:10,151 : INFO : Recall score for label_class 0: 0.8310
2024-08-12 12:50:10,151 : INFO : Recall score for label_class 1: 0.7756
2024-08-12 12:50:10,151 : INFO : Recall score for label_class 2: 0.8093
2024-08-12 12:50:10,151 : INFO : Average F1 score: 0.7628
2024-08-12 12:50:10,151 : INFO : Determined score from best model, ending training.
2024-08-12 12:50:10,153 : INFO : Split 2 is finished, the score is: 0.7628
2024-08-12 12:50:10,153 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:10,153 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:10,153 : INFO : Starting training for split 3
2024-08-12 12:50:10,164 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 328, 1611,  759]))
2024-08-12 12:50:10,166 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 86, 400, 189]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:50:10,204 : INFO : Starting epoch 1
2024-08-12 12:50:10,246 : INFO : Current training batch loss: 1.0623 in epoch 1
2024-08-12 12:50:11,052 : INFO : Current training batch loss: 1.0714 in epoch 1
2024-08-12 12:50:11,858 : INFO : Current training batch loss: 0.8676 in epoch 1
2024-08-12 12:50:12,664 : INFO : Current training batch loss: 0.8342 in epoch 1
2024-08-12 12:50:13,471 : INFO : Current training batch loss: 0.8248 in epoch 1
2024-08-12 12:50:13,615 : INFO : Epoch finished, average loss over training batches: 0.8647
2024-08-12 12:50:13,615 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:13,616 : INFO : Training metrics:
2024-08-12 12:50:13,616 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:13,623 : INFO : Accuracy: 0.6408
2024-08-12 12:50:13,623 : INFO : Precision score for label_class 0: 0.3750
2024-08-12 12:50:13,623 : INFO : Precision score for label_class 1: 0.6642
2024-08-12 12:50:13,623 : INFO : Precision score for label_class 2: 0.5159
2024-08-12 12:50:13,623 : INFO : Recall score for label_class 0: 0.0274
2024-08-12 12:50:13,623 : INFO : Recall score for label_class 1: 0.9466
2024-08-12 12:50:13,623 : INFO : Recall score for label_class 2: 0.2569
2024-08-12 12:50:13,623 : INFO : Average F1 score: 0.3916
2024-08-12 12:50:13,899 : INFO : Average loss over validation batches: 0.7862
2024-08-12 12:50:13,899 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:13,899 : INFO : Validation metrics:
2024-08-12 12:50:13,899 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:13,902 : INFO : Accuracy: 0.7007
2024-08-12 12:50:13,902 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:50:13,902 : INFO : Precision score for label_class 1: 0.7668
2024-08-12 12:50:13,902 : INFO : Precision score for label_class 2: 0.5427
2024-08-12 12:50:13,902 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:50:13,902 : INFO : Recall score for label_class 1: 0.9125
2024-08-12 12:50:13,902 : INFO : Recall score for label_class 2: 0.5714
2024-08-12 12:50:13,902 : INFO : Average F1 score: 0.4633
2024-08-12 12:50:13,902 : INFO : Validation metric decreased (inf --> 0.786179).  Saving model ...
2024-08-12 12:50:13,998 : INFO : Starting epoch 2
2024-08-12 12:50:14,643 : INFO : Current training batch loss: 0.8587 in epoch 2
2024-08-12 12:50:15,449 : INFO : Current training batch loss: 0.8861 in epoch 2
2024-08-12 12:50:16,255 : INFO : Current training batch loss: 0.9333 in epoch 2
2024-08-12 12:50:17,061 : INFO : Current training batch loss: 0.8995 in epoch 2
2024-08-12 12:50:17,407 : INFO : Epoch finished, average loss over training batches: 0.8325
2024-08-12 12:50:17,407 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:17,407 : INFO : Training metrics:
2024-08-12 12:50:17,407 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:17,415 : INFO : Accuracy: 0.6649
2024-08-12 12:50:17,415 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:50:17,415 : INFO : Precision score for label_class 1: 0.7022
2024-08-12 12:50:17,415 : INFO : Precision score for label_class 2: 0.5278
2024-08-12 12:50:17,415 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:50:17,415 : INFO : Recall score for label_class 1: 0.9249
2024-08-12 12:50:17,415 : INFO : Recall score for label_class 2: 0.4005
2024-08-12 12:50:17,415 : INFO : Average F1 score: 0.4179
2024-08-12 12:50:17,690 : INFO : Average loss over validation batches: 0.9234
2024-08-12 12:50:17,691 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:17,691 : INFO : Validation metrics:
2024-08-12 12:50:17,691 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:17,694 : INFO : Accuracy: 0.5941
2024-08-12 12:50:17,694 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:50:17,694 : INFO : Precision score for label_class 1: 0.5944
2024-08-12 12:50:17,694 : INFO : Precision score for label_class 2: 0.5000
2024-08-12 12:50:17,694 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:50:17,694 : INFO : Recall score for label_class 1: 1.0000
2024-08-12 12:50:17,694 : INFO : Recall score for label_class 2: 0.0053
2024-08-12 12:50:17,694 : INFO : Average F1 score: 0.2520
2024-08-12 12:50:17,694 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 12:50:17,694 : INFO : Starting epoch 3
2024-08-12 12:50:18,137 : INFO : Current training batch loss: 0.9305 in epoch 3
2024-08-12 12:50:18,943 : INFO : Current training batch loss: 0.9046 in epoch 3
2024-08-12 12:50:19,750 : INFO : Current training batch loss: 1.0064 in epoch 3
2024-08-12 12:50:20,557 : INFO : Current training batch loss: 0.8256 in epoch 3
2024-08-12 12:50:21,104 : INFO : Epoch finished, average loss over training batches: 0.9223
2024-08-12 12:50:21,105 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:21,105 : INFO : Training metrics:
2024-08-12 12:50:21,105 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:21,112 : INFO : Accuracy: 0.5975
2024-08-12 12:50:21,112 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:50:21,112 : INFO : Precision score for label_class 1: 0.5976
2024-08-12 12:50:21,112 : INFO : Precision score for label_class 2: 0.5000
2024-08-12 12:50:21,112 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:50:21,112 : INFO : Recall score for label_class 1: 0.9994
2024-08-12 12:50:21,112 : INFO : Recall score for label_class 2: 0.0026
2024-08-12 12:50:21,112 : INFO : Average F1 score: 0.2511
2024-08-12 12:50:21,388 : INFO : Average loss over validation batches: 0.9231
2024-08-12 12:50:21,388 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:21,388 : INFO : Validation metrics:
2024-08-12 12:50:21,388 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:21,391 : INFO : Accuracy: 0.5926
2024-08-12 12:50:21,391 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:50:21,391 : INFO : Precision score for label_class 1: 0.5926
2024-08-12 12:50:21,391 : INFO : Precision score for label_class 2: 0.0000
2024-08-12 12:50:21,391 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:50:21,391 : INFO : Recall score for label_class 1: 1.0000
2024-08-12 12:50:21,391 : INFO : Recall score for label_class 2: 0.0000
2024-08-12 12:50:21,391 : INFO : Average F1 score: 0.2481
2024-08-12 12:50:21,391 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 12:50:21,391 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:50:21,423 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 12:50:21,727 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:21,727 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 12:50:21,727 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:21,730 : INFO : Accuracy: 0.7007
2024-08-12 12:50:21,730 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:50:21,730 : INFO : Precision score for label_class 1: 0.7668
2024-08-12 12:50:21,730 : INFO : Precision score for label_class 2: 0.5427
2024-08-12 12:50:21,730 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:50:21,730 : INFO : Recall score for label_class 1: 0.9125
2024-08-12 12:50:21,730 : INFO : Recall score for label_class 2: 0.5714
2024-08-12 12:50:21,730 : INFO : Average F1 score: 0.4633
2024-08-12 12:50:21,730 : INFO : Determined score from best model, ending training.
2024-08-12 12:50:21,731 : INFO : Split 3 is finished, the score is: 0.4633
2024-08-12 12:50:21,731 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:21,731 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:21,731 : INFO : Starting training for split 4
2024-08-12 12:50:21,743 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 327, 1621,  751]))
2024-08-12 12:50:21,745 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 87, 390, 197]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:50:21,783 : INFO : Starting epoch 1
2024-08-12 12:50:21,825 : INFO : Current training batch loss: 1.1082 in epoch 1
2024-08-12 12:50:22,633 : INFO : Current training batch loss: 0.9194 in epoch 1
2024-08-12 12:50:23,440 : INFO : Current training batch loss: 0.8413 in epoch 1
2024-08-12 12:50:24,248 : INFO : Current training batch loss: 0.8701 in epoch 1
2024-08-12 12:50:25,055 : INFO : Current training batch loss: 0.8545 in epoch 1
2024-08-12 12:50:25,198 : INFO : Epoch finished, average loss over training batches: 0.9146
2024-08-12 12:50:25,198 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:25,199 : INFO : Training metrics:
2024-08-12 12:50:25,199 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:25,206 : INFO : Accuracy: 0.5924
2024-08-12 12:50:25,206 : INFO : Precision score for label_class 0: 0.3600
2024-08-12 12:50:25,206 : INFO : Precision score for label_class 1: 0.6187
2024-08-12 12:50:25,206 : INFO : Precision score for label_class 2: 0.3242
2024-08-12 12:50:25,206 : INFO : Recall score for label_class 0: 0.0275
2024-08-12 12:50:25,206 : INFO : Recall score for label_class 1: 0.9371
2024-08-12 12:50:25,206 : INFO : Recall score for label_class 2: 0.0945
2024-08-12 12:50:25,206 : INFO : Average F1 score: 0.3143
2024-08-12 12:50:25,483 : INFO : Average loss over validation batches: 0.9614
2024-08-12 12:50:25,483 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:25,483 : INFO : Validation metrics:
2024-08-12 12:50:25,483 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:25,486 : INFO : Accuracy: 0.5786
2024-08-12 12:50:25,486 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:50:25,486 : INFO : Precision score for label_class 1: 0.5786
2024-08-12 12:50:25,486 : INFO : Precision score for label_class 2: 0.0000
2024-08-12 12:50:25,486 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:50:25,486 : INFO : Recall score for label_class 1: 1.0000
2024-08-12 12:50:25,486 : INFO : Recall score for label_class 2: 0.0000
2024-08-12 12:50:25,486 : INFO : Average F1 score: 0.2444
2024-08-12 12:50:25,486 : INFO : Validation metric decreased (inf --> 0.961361).  Saving model ...
2024-08-12 12:50:25,584 : INFO : Starting epoch 2
2024-08-12 12:50:26,229 : INFO : Current training batch loss: 1.0142 in epoch 2
2024-08-12 12:50:27,036 : INFO : Current training batch loss: 0.9802 in epoch 2
2024-08-12 12:50:27,842 : INFO : Current training batch loss: 1.0531 in epoch 2
2024-08-12 12:50:28,650 : INFO : Current training batch loss: 0.8585 in epoch 2
2024-08-12 12:50:28,996 : INFO : Epoch finished, average loss over training batches: 0.9193
2024-08-12 12:50:28,996 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:28,996 : INFO : Training metrics:
2024-08-12 12:50:28,996 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:28,999 : INFO : Accuracy: 0.6006
2024-08-12 12:50:28,999 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:50:28,999 : INFO : Precision score for label_class 1: 0.6006
2024-08-12 12:50:28,999 : INFO : Precision score for label_class 2: 0.0000
2024-08-12 12:50:28,999 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:50:28,999 : INFO : Recall score for label_class 1: 1.0000
2024-08-12 12:50:28,999 : INFO : Recall score for label_class 2: 0.0000
2024-08-12 12:50:28,999 : INFO : Average F1 score: 0.2502
2024-08-12 12:50:29,276 : INFO : Average loss over validation batches: 0.9593
2024-08-12 12:50:29,276 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:29,276 : INFO : Validation metrics:
2024-08-12 12:50:29,276 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:29,279 : INFO : Accuracy: 0.5786
2024-08-12 12:50:29,279 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:50:29,279 : INFO : Precision score for label_class 1: 0.5786
2024-08-12 12:50:29,279 : INFO : Precision score for label_class 2: 0.0000
2024-08-12 12:50:29,279 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:50:29,279 : INFO : Recall score for label_class 1: 1.0000
2024-08-12 12:50:29,279 : INFO : Recall score for label_class 2: 0.0000
2024-08-12 12:50:29,279 : INFO : Average F1 score: 0.2444
2024-08-12 12:50:29,279 : INFO : Validation metric decreased (0.961361 --> 0.959303).  Saving model ...
2024-08-12 12:50:29,375 : INFO : Starting epoch 3
2024-08-12 12:50:29,820 : INFO : Current training batch loss: 0.9293 in epoch 3
2024-08-12 12:50:30,628 : INFO : Current training batch loss: 0.9103 in epoch 3
2024-08-12 12:50:31,436 : INFO : Current training batch loss: 1.0979 in epoch 3
2024-08-12 12:50:32,243 : INFO : Current training batch loss: 0.8186 in epoch 3
2024-08-12 12:50:32,791 : INFO : Epoch finished, average loss over training batches: 0.9186
2024-08-12 12:50:32,792 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:32,792 : INFO : Training metrics:
2024-08-12 12:50:32,792 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:32,795 : INFO : Accuracy: 0.6006
2024-08-12 12:50:32,795 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:50:32,795 : INFO : Precision score for label_class 1: 0.6006
2024-08-12 12:50:32,795 : INFO : Precision score for label_class 2: 0.0000
2024-08-12 12:50:32,795 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:50:32,795 : INFO : Recall score for label_class 1: 1.0000
2024-08-12 12:50:32,795 : INFO : Recall score for label_class 2: 0.0000
2024-08-12 12:50:32,795 : INFO : Average F1 score: 0.2502
2024-08-12 12:50:33,072 : INFO : Average loss over validation batches: 0.9558
2024-08-12 12:50:33,072 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:33,072 : INFO : Validation metrics:
2024-08-12 12:50:33,072 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:33,075 : INFO : Accuracy: 0.5786
2024-08-12 12:50:33,075 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:50:33,075 : INFO : Precision score for label_class 1: 0.5786
2024-08-12 12:50:33,075 : INFO : Precision score for label_class 2: 0.0000
2024-08-12 12:50:33,075 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:50:33,075 : INFO : Recall score for label_class 1: 1.0000
2024-08-12 12:50:33,075 : INFO : Recall score for label_class 2: 0.0000
2024-08-12 12:50:33,075 : INFO : Average F1 score: 0.2444
2024-08-12 12:50:33,075 : INFO : Validation metric decreased (0.959303 --> 0.955809).  Saving model ...
2024-08-12 12:50:33,175 : INFO : Starting epoch 4
2024-08-12 12:50:33,419 : INFO : Current training batch loss: 0.9270 in epoch 4
2024-08-12 12:50:34,228 : INFO : Current training batch loss: 0.9522 in epoch 4
2024-08-12 12:50:35,037 : INFO : Current training batch loss: 0.9330 in epoch 4
2024-08-12 12:50:35,846 : INFO : Current training batch loss: 0.9334 in epoch 4
2024-08-12 12:50:36,594 : INFO : Epoch finished, average loss over training batches: 0.9175
2024-08-12 12:50:36,595 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:36,595 : INFO : Training metrics:
2024-08-12 12:50:36,595 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:36,598 : INFO : Accuracy: 0.6006
2024-08-12 12:50:36,598 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:50:36,598 : INFO : Precision score for label_class 1: 0.6006
2024-08-12 12:50:36,598 : INFO : Precision score for label_class 2: 0.0000
2024-08-12 12:50:36,598 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:50:36,598 : INFO : Recall score for label_class 1: 1.0000
2024-08-12 12:50:36,598 : INFO : Recall score for label_class 2: 0.0000
2024-08-12 12:50:36,598 : INFO : Average F1 score: 0.2502
2024-08-12 12:50:36,875 : INFO : Average loss over validation batches: 0.9557
2024-08-12 12:50:36,875 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:36,875 : INFO : Validation metrics:
2024-08-12 12:50:36,875 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:36,878 : INFO : Accuracy: 0.5786
2024-08-12 12:50:36,878 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:50:36,878 : INFO : Precision score for label_class 1: 0.5786
2024-08-12 12:50:36,878 : INFO : Precision score for label_class 2: 0.0000
2024-08-12 12:50:36,878 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:50:36,878 : INFO : Recall score for label_class 1: 1.0000
2024-08-12 12:50:36,878 : INFO : Recall score for label_class 2: 0.0000
2024-08-12 12:50:36,878 : INFO : Average F1 score: 0.2444
2024-08-12 12:50:36,878 : INFO : Validation metric decreased (0.955809 --> 0.955676).  Saving model ...
2024-08-12 12:50:36,978 : INFO : Starting epoch 5
2024-08-12 12:50:37,020 : INFO : Current training batch loss: 0.9523 in epoch 5
2024-08-12 12:50:37,829 : INFO : Current training batch loss: 1.0057 in epoch 5
2024-08-12 12:50:38,638 : INFO : Current training batch loss: 0.9005 in epoch 5
2024-08-12 12:50:39,448 : INFO : Current training batch loss: 0.8487 in epoch 5
2024-08-12 12:50:40,257 : INFO : Current training batch loss: 0.8452 in epoch 5
2024-08-12 12:50:40,402 : INFO : Epoch finished, average loss over training batches: 0.9163
2024-08-12 12:50:40,402 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:40,402 : INFO : Training metrics:
2024-08-12 12:50:40,402 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:40,405 : INFO : Accuracy: 0.6006
2024-08-12 12:50:40,406 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:50:40,406 : INFO : Precision score for label_class 1: 0.6006
2024-08-12 12:50:40,406 : INFO : Precision score for label_class 2: 0.0000
2024-08-12 12:50:40,406 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:50:40,406 : INFO : Recall score for label_class 1: 1.0000
2024-08-12 12:50:40,406 : INFO : Recall score for label_class 2: 0.0000
2024-08-12 12:50:40,406 : INFO : Average F1 score: 0.2502
2024-08-12 12:50:40,682 : INFO : Average loss over validation batches: 0.9572
2024-08-12 12:50:40,683 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:40,683 : INFO : Validation metrics:
2024-08-12 12:50:40,683 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:40,686 : INFO : Accuracy: 0.5786
2024-08-12 12:50:40,686 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:50:40,686 : INFO : Precision score for label_class 1: 0.5786
2024-08-12 12:50:40,686 : INFO : Precision score for label_class 2: 0.0000
2024-08-12 12:50:40,686 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:50:40,686 : INFO : Recall score for label_class 1: 1.0000
2024-08-12 12:50:40,686 : INFO : Recall score for label_class 2: 0.0000
2024-08-12 12:50:40,686 : INFO : Average F1 score: 0.2444
2024-08-12 12:50:40,686 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 12:50:40,686 : INFO : Last epoch reached, validation loss was better before, loading best model during training.
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:50:40,718 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 12:50:41,022 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:41,022 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 12:50:41,022 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:41,025 : INFO : Accuracy: 0.5786
2024-08-12 12:50:41,025 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:50:41,025 : INFO : Precision score for label_class 1: 0.5786
2024-08-12 12:50:41,025 : INFO : Precision score for label_class 2: 0.0000
2024-08-12 12:50:41,025 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:50:41,025 : INFO : Recall score for label_class 1: 1.0000
2024-08-12 12:50:41,025 : INFO : Recall score for label_class 2: 0.0000
2024-08-12 12:50:41,025 : INFO : Average F1 score: 0.2444
2024-08-12 12:50:41,025 : INFO : Determined score from best model, ending training.
2024-08-12 12:50:41,027 : INFO : Split 4 is finished, the score is: 0.2444
2024-08-12 12:50:41,027 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:41,027 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:41,027 : INFO : Starting training for split 5
2024-08-12 12:50:41,038 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 330, 1615,  754]))
2024-08-12 12:50:41,040 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 84, 396, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:50:41,080 : INFO : Starting epoch 1
2024-08-12 12:50:41,122 : INFO : Current training batch loss: 1.1129 in epoch 1
2024-08-12 12:50:41,932 : INFO : Current training batch loss: 0.9823 in epoch 1
2024-08-12 12:50:42,741 : INFO : Current training batch loss: 0.8334 in epoch 1
2024-08-12 12:50:43,552 : INFO : Current training batch loss: 0.7010 in epoch 1
2024-08-12 12:50:44,361 : INFO : Current training batch loss: 0.9718 in epoch 1
2024-08-12 12:50:44,506 : INFO : Epoch finished, average loss over training batches: 0.8833
2024-08-12 12:50:44,507 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:44,507 : INFO : Training metrics:
2024-08-12 12:50:44,507 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:44,518 : INFO : Accuracy: 0.5973
2024-08-12 12:50:44,518 : INFO : Precision score for label_class 0: 0.2029
2024-08-12 12:50:44,518 : INFO : Precision score for label_class 1: 0.6393
2024-08-12 12:50:44,518 : INFO : Precision score for label_class 2: 0.4017
2024-08-12 12:50:44,518 : INFO : Recall score for label_class 0: 0.0424
2024-08-12 12:50:44,518 : INFO : Recall score for label_class 1: 0.9022
2024-08-12 12:50:44,518 : INFO : Recall score for label_class 2: 0.1870
2024-08-12 12:50:44,518 : INFO : Average F1 score: 0.3579
2024-08-12 12:50:44,795 : INFO : Average loss over validation batches: 0.9216
2024-08-12 12:50:44,795 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:44,795 : INFO : Validation metrics:
2024-08-12 12:50:44,795 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:44,798 : INFO : Accuracy: 0.5875
2024-08-12 12:50:44,798 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:50:44,798 : INFO : Precision score for label_class 1: 0.5875
2024-08-12 12:50:44,798 : INFO : Precision score for label_class 2: 0.0000
2024-08-12 12:50:44,798 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:50:44,798 : INFO : Recall score for label_class 1: 1.0000
2024-08-12 12:50:44,798 : INFO : Recall score for label_class 2: 0.0000
2024-08-12 12:50:44,798 : INFO : Average F1 score: 0.2467
2024-08-12 12:50:44,798 : INFO : Validation metric decreased (inf --> 0.921588).  Saving model ...
2024-08-12 12:50:44,898 : INFO : Starting epoch 2
2024-08-12 12:50:45,544 : INFO : Current training batch loss: 1.0331 in epoch 2
2024-08-12 12:50:46,353 : INFO : Current training batch loss: 0.9763 in epoch 2
2024-08-12 12:50:47,160 : INFO : Current training batch loss: 1.0652 in epoch 2
2024-08-12 12:50:47,969 : INFO : Current training batch loss: 0.8095 in epoch 2
2024-08-12 12:50:48,314 : INFO : Epoch finished, average loss over training batches: 0.9266
2024-08-12 12:50:48,314 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:48,314 : INFO : Training metrics:
2024-08-12 12:50:48,314 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:48,321 : INFO : Accuracy: 0.5984
2024-08-12 12:50:48,321 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:50:48,321 : INFO : Precision score for label_class 1: 0.5984
2024-08-12 12:50:48,321 : INFO : Precision score for label_class 2: 0.0000
2024-08-12 12:50:48,321 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:50:48,321 : INFO : Recall score for label_class 1: 1.0000
2024-08-12 12:50:48,321 : INFO : Recall score for label_class 2: 0.0000
2024-08-12 12:50:48,321 : INFO : Average F1 score: 0.2496
2024-08-12 12:50:48,598 : INFO : Average loss over validation batches: 0.9132
2024-08-12 12:50:48,598 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:48,598 : INFO : Validation metrics:
2024-08-12 12:50:48,598 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:48,601 : INFO : Accuracy: 0.5875
2024-08-12 12:50:48,601 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:50:48,601 : INFO : Precision score for label_class 1: 0.5875
2024-08-12 12:50:48,601 : INFO : Precision score for label_class 2: 0.0000
2024-08-12 12:50:48,601 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:50:48,601 : INFO : Recall score for label_class 1: 1.0000
2024-08-12 12:50:48,601 : INFO : Recall score for label_class 2: 0.0000
2024-08-12 12:50:48,601 : INFO : Average F1 score: 0.2467
2024-08-12 12:50:48,601 : INFO : Validation metric decreased (0.921588 --> 0.913194).  Saving model ...
2024-08-12 12:50:48,704 : INFO : Starting epoch 3
2024-08-12 12:50:49,148 : INFO : Current training batch loss: 0.9277 in epoch 3
2024-08-12 12:50:49,954 : INFO : Current training batch loss: 0.9046 in epoch 3
2024-08-12 12:50:50,760 : INFO : Current training batch loss: 1.0926 in epoch 3
2024-08-12 12:50:51,567 : INFO : Current training batch loss: 0.8600 in epoch 3
2024-08-12 12:50:52,112 : INFO : Epoch finished, average loss over training batches: 0.9227
2024-08-12 12:50:52,112 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:52,112 : INFO : Training metrics:
2024-08-12 12:50:52,112 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:52,119 : INFO : Accuracy: 0.5984
2024-08-12 12:50:52,119 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:50:52,119 : INFO : Precision score for label_class 1: 0.5984
2024-08-12 12:50:52,119 : INFO : Precision score for label_class 2: 0.0000
2024-08-12 12:50:52,119 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:50:52,119 : INFO : Recall score for label_class 1: 1.0000
2024-08-12 12:50:52,119 : INFO : Recall score for label_class 2: 0.0000
2024-08-12 12:50:52,119 : INFO : Average F1 score: 0.2496
2024-08-12 12:50:52,397 : INFO : Average loss over validation batches: 0.9136
2024-08-12 12:50:52,397 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:52,397 : INFO : Validation metrics:
2024-08-12 12:50:52,397 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:52,400 : INFO : Accuracy: 0.5875
2024-08-12 12:50:52,400 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:50:52,400 : INFO : Precision score for label_class 1: 0.5875
2024-08-12 12:50:52,400 : INFO : Precision score for label_class 2: 0.0000
2024-08-12 12:50:52,400 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:50:52,400 : INFO : Recall score for label_class 1: 1.0000
2024-08-12 12:50:52,400 : INFO : Recall score for label_class 2: 0.0000
2024-08-12 12:50:52,400 : INFO : Average F1 score: 0.2467
2024-08-12 12:50:52,400 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 12:50:52,400 : INFO : Starting epoch 4
2024-08-12 12:50:52,642 : INFO : Current training batch loss: 0.9275 in epoch 4
2024-08-12 12:50:53,448 : INFO : Current training batch loss: 0.9566 in epoch 4
2024-08-12 12:50:54,254 : INFO : Current training batch loss: 0.9320 in epoch 4
2024-08-12 12:50:55,061 : INFO : Current training batch loss: 1.0232 in epoch 4
2024-08-12 12:50:55,808 : INFO : Epoch finished, average loss over training batches: 0.9219
2024-08-12 12:50:55,808 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:55,808 : INFO : Training metrics:
2024-08-12 12:50:55,808 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:55,815 : INFO : Accuracy: 0.5984
2024-08-12 12:50:55,815 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:50:55,815 : INFO : Precision score for label_class 1: 0.5984
2024-08-12 12:50:55,815 : INFO : Precision score for label_class 2: 0.0000
2024-08-12 12:50:55,815 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:50:55,815 : INFO : Recall score for label_class 1: 1.0000
2024-08-12 12:50:55,815 : INFO : Recall score for label_class 2: 0.0000
2024-08-12 12:50:55,815 : INFO : Average F1 score: 0.2496
2024-08-12 12:50:56,092 : INFO : Average loss over validation batches: 0.9134
2024-08-12 12:50:56,093 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:56,093 : INFO : Validation metrics:
2024-08-12 12:50:56,093 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:56,096 : INFO : Accuracy: 0.5875
2024-08-12 12:50:56,096 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:50:56,096 : INFO : Precision score for label_class 1: 0.5875
2024-08-12 12:50:56,096 : INFO : Precision score for label_class 2: 0.0000
2024-08-12 12:50:56,096 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:50:56,096 : INFO : Recall score for label_class 1: 1.0000
2024-08-12 12:50:56,096 : INFO : Recall score for label_class 2: 0.0000
2024-08-12 12:50:56,096 : INFO : Average F1 score: 0.2467
2024-08-12 12:50:56,096 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 12:50:56,096 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:50:56,129 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 12:50:56,434 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:56,434 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 12:50:56,434 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:56,437 : INFO : Accuracy: 0.5875
2024-08-12 12:50:56,437 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:50:56,437 : INFO : Precision score for label_class 1: 0.5875
2024-08-12 12:50:56,437 : INFO : Precision score for label_class 2: 0.0000
2024-08-12 12:50:56,437 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:50:56,437 : INFO : Recall score for label_class 1: 1.0000
2024-08-12 12:50:56,437 : INFO : Recall score for label_class 2: 0.0000
2024-08-12 12:50:56,437 : INFO : Average F1 score: 0.2467
2024-08-12 12:50:56,437 : INFO : Determined score from best model, ending training.
2024-08-12 12:50:56,439 : INFO : Split 5 is finished, the score is: 0.2467
2024-08-12 12:50:56,439 : INFO : ----------------------------------------------------------------------------------------------------
[I 2024-08-12 12:50:56,439] Trial 0 finished with value: 0.42447726824901677 and parameters: {}. Best is trial 0 with value: 0.42447726824901677.
2024-08-12 12:50:56,440 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:56,440 : INFO : Starting training for split 1
2024-08-12 12:50:56,450 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 328, 1596,  774]))
2024-08-12 12:50:56,452 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 86, 415, 174]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:50:56,492 : INFO : Starting epoch 1
2024-08-12 12:50:56,534 : INFO : Current training batch loss: 1.1098 in epoch 1
2024-08-12 12:50:57,342 : INFO : Current training batch loss: 0.7855 in epoch 1
2024-08-12 12:50:58,150 : INFO : Current training batch loss: 0.7046 in epoch 1
2024-08-12 12:50:58,957 : INFO : Current training batch loss: 0.6897 in epoch 1
2024-08-12 12:50:59,765 : INFO : Current training batch loss: 0.6188 in epoch 1
2024-08-12 12:50:59,907 : INFO : Epoch finished, average loss over training batches: 0.7786
2024-08-12 12:50:59,907 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:59,908 : INFO : Training metrics:
2024-08-12 12:50:59,908 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:50:59,916 : INFO : Accuracy: 0.6646
2024-08-12 12:50:59,916 : INFO : Precision score for label_class 0: 0.1238
2024-08-12 12:50:59,916 : INFO : Precision score for label_class 1: 0.7240
2024-08-12 12:50:59,916 : INFO : Precision score for label_class 2: 0.5494
2024-08-12 12:50:59,916 : INFO : Recall score for label_class 0: 0.0396
2024-08-12 12:50:59,916 : INFO : Recall score for label_class 1: 0.9236
2024-08-12 12:50:59,916 : INFO : Recall score for label_class 2: 0.3953
2024-08-12 12:50:59,916 : INFO : Average F1 score: 0.4438
2024-08-12 12:51:00,196 : INFO : Average loss over validation batches: 0.5951
2024-08-12 12:51:00,196 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:00,196 : INFO : Validation metrics:
2024-08-12 12:51:00,196 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:00,198 : INFO : Accuracy: 0.7615
2024-08-12 12:51:00,199 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:51:00,199 : INFO : Precision score for label_class 1: 0.8638
2024-08-12 12:51:00,199 : INFO : Precision score for label_class 2: 0.5595
2024-08-12 12:51:00,199 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:51:00,199 : INFO : Recall score for label_class 1: 0.9325
2024-08-12 12:51:00,199 : INFO : Recall score for label_class 2: 0.7299
2024-08-12 12:51:00,199 : INFO : Average F1 score: 0.5101
2024-08-12 12:51:00,199 : INFO : Validation metric decreased (inf --> 0.595139).  Saving model ...
2024-08-12 12:51:00,298 : INFO : Starting epoch 2
2024-08-12 12:51:00,945 : INFO : Current training batch loss: 0.3082 in epoch 2
2024-08-12 12:51:01,752 : INFO : Current training batch loss: 0.5443 in epoch 2
2024-08-12 12:51:02,559 : INFO : Current training batch loss: 0.3767 in epoch 2
2024-08-12 12:51:03,366 : INFO : Current training batch loss: 0.2485 in epoch 2
2024-08-12 12:51:03,710 : INFO : Epoch finished, average loss over training batches: 0.4598
2024-08-12 12:51:03,711 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:03,711 : INFO : Training metrics:
2024-08-12 12:51:03,711 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:03,719 : INFO : Accuracy: 0.8436
2024-08-12 12:51:03,719 : INFO : Precision score for label_class 0: 0.8118
2024-08-12 12:51:03,719 : INFO : Precision score for label_class 1: 0.8926
2024-08-12 12:51:03,719 : INFO : Precision score for label_class 2: 0.7491
2024-08-12 12:51:03,719 : INFO : Recall score for label_class 0: 0.4604
2024-08-12 12:51:03,719 : INFO : Recall score for label_class 1: 0.9480
2024-08-12 12:51:03,719 : INFO : Recall score for label_class 2: 0.7907
2024-08-12 12:51:03,719 : INFO : Average F1 score: 0.7588
2024-08-12 12:51:03,999 : INFO : Average loss over validation batches: 0.4212
2024-08-12 12:51:03,999 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:03,999 : INFO : Validation metrics:
2024-08-12 12:51:03,999 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:04,002 : INFO : Accuracy: 0.8726
2024-08-12 12:51:04,002 : INFO : Precision score for label_class 0: 0.8068
2024-08-12 12:51:04,002 : INFO : Precision score for label_class 1: 0.8972
2024-08-12 12:51:04,002 : INFO : Precision score for label_class 2: 0.8428
2024-08-12 12:51:04,002 : INFO : Recall score for label_class 0: 0.8256
2024-08-12 12:51:04,002 : INFO : Recall score for label_class 1: 0.9253
2024-08-12 12:51:04,002 : INFO : Recall score for label_class 2: 0.7701
2024-08-12 12:51:04,002 : INFO : Average F1 score: 0.8440
2024-08-12 12:51:04,002 : INFO : Validation metric decreased (0.595139 --> 0.421195).  Saving model ...
2024-08-12 12:51:04,103 : INFO : Split 1 is finished, the score is: 0.8440
2024-08-12 12:51:04,103 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:04,103 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:04,103 : INFO : Starting training for split 2
2024-08-12 12:51:04,115 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 343, 1601,  754]))
2024-08-12 12:51:04,117 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 71, 410, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:51:04,159 : INFO : Starting epoch 1
2024-08-12 12:51:04,202 : INFO : Current training batch loss: 1.0984 in epoch 1
2024-08-12 12:51:05,010 : INFO : Current training batch loss: 0.9610 in epoch 1
2024-08-12 12:51:05,818 : INFO : Current training batch loss: 0.7389 in epoch 1
2024-08-12 12:51:06,627 : INFO : Current training batch loss: 0.6901 in epoch 1
2024-08-12 12:51:07,435 : INFO : Current training batch loss: 0.5892 in epoch 1
2024-08-12 12:51:07,578 : INFO : Epoch finished, average loss over training batches: 0.7629
2024-08-12 12:51:07,578 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:07,579 : INFO : Training metrics:
2024-08-12 12:51:07,579 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:07,586 : INFO : Accuracy: 0.6809
2024-08-12 12:51:07,586 : INFO : Precision score for label_class 0: 0.3932
2024-08-12 12:51:07,586 : INFO : Precision score for label_class 1: 0.7246
2024-08-12 12:51:07,586 : INFO : Precision score for label_class 2: 0.5689
2024-08-12 12:51:07,586 : INFO : Recall score for label_class 0: 0.1341
2024-08-12 12:51:07,586 : INFO : Recall score for label_class 1: 0.9382
2024-08-12 12:51:07,586 : INFO : Recall score for label_class 2: 0.3833
2024-08-12 12:51:07,586 : INFO : Average F1 score: 0.4919
2024-08-12 12:51:07,866 : INFO : Average loss over validation batches: 0.5194
2024-08-12 12:51:07,866 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:07,866 : INFO : Validation metrics:
2024-08-12 12:51:07,866 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:07,870 : INFO : Accuracy: 0.8059
2024-08-12 12:51:07,870 : INFO : Precision score for label_class 0: 0.8000
2024-08-12 12:51:07,870 : INFO : Precision score for label_class 1: 0.8800
2024-08-12 12:51:07,870 : INFO : Precision score for label_class 2: 0.6723
2024-08-12 12:51:07,870 : INFO : Recall score for label_class 0: 0.1690
2024-08-12 12:51:07,870 : INFO : Recall score for label_class 1: 0.9122
2024-08-12 12:51:07,870 : INFO : Recall score for label_class 2: 0.8144
2024-08-12 12:51:07,870 : INFO : Average F1 score: 0.6372
2024-08-12 12:51:07,870 : INFO : Validation metric decreased (inf --> 0.519369).  Saving model ...
2024-08-12 12:51:07,973 : INFO : Starting epoch 2
2024-08-12 12:51:08,619 : INFO : Current training batch loss: 0.4915 in epoch 2
2024-08-12 12:51:09,427 : INFO : Current training batch loss: 0.4306 in epoch 2
2024-08-12 12:51:10,236 : INFO : Current training batch loss: 0.3073 in epoch 2
2024-08-12 12:51:11,044 : INFO : Current training batch loss: 0.2258 in epoch 2
2024-08-12 12:51:11,388 : INFO : Epoch finished, average loss over training batches: 0.3919
2024-08-12 12:51:11,388 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:11,388 : INFO : Training metrics:
2024-08-12 12:51:11,388 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:11,395 : INFO : Accuracy: 0.8699
2024-08-12 12:51:11,395 : INFO : Precision score for label_class 0: 0.7802
2024-08-12 12:51:11,395 : INFO : Precision score for label_class 1: 0.9062
2024-08-12 12:51:11,395 : INFO : Precision score for label_class 2: 0.8269
2024-08-12 12:51:11,395 : INFO : Recall score for label_class 0: 0.7347
2024-08-12 12:51:11,395 : INFO : Recall score for label_class 1: 0.9357
2024-08-12 12:51:11,395 : INFO : Recall score for label_class 2: 0.7918
2024-08-12 12:51:11,395 : INFO : Average F1 score: 0.8288
2024-08-12 12:51:11,675 : INFO : Average loss over validation batches: 0.3885
2024-08-12 12:51:11,675 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:11,675 : INFO : Validation metrics:
2024-08-12 12:51:11,675 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:11,678 : INFO : Accuracy: 0.8681
2024-08-12 12:51:11,678 : INFO : Precision score for label_class 0: 0.7632
2024-08-12 12:51:11,678 : INFO : Precision score for label_class 1: 0.8807
2024-08-12 12:51:11,679 : INFO : Precision score for label_class 2: 0.8834
2024-08-12 12:51:11,679 : INFO : Recall score for label_class 0: 0.8169
2024-08-12 12:51:11,679 : INFO : Recall score for label_class 1: 0.9366
2024-08-12 12:51:11,679 : INFO : Recall score for label_class 2: 0.7423
2024-08-12 12:51:11,679 : INFO : Average F1 score: 0.8345
2024-08-12 12:51:11,679 : INFO : Validation metric decreased (0.519369 --> 0.388524).  Saving model ...
2024-08-12 12:51:11,781 : INFO : Split 2 is finished, the score is: 0.8345
2024-08-12 12:51:11,781 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:11,781 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:11,781 : INFO : Starting training for split 3
2024-08-12 12:51:11,793 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 328, 1611,  759]))
2024-08-12 12:51:11,795 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 86, 400, 189]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:51:11,837 : INFO : Starting epoch 1
2024-08-12 12:51:11,880 : INFO : Current training batch loss: 1.0949 in epoch 1
2024-08-12 12:51:12,688 : INFO : Current training batch loss: 0.9487 in epoch 1
2024-08-12 12:51:13,497 : INFO : Current training batch loss: 0.6603 in epoch 1
2024-08-12 12:51:14,306 : INFO : Current training batch loss: 0.7063 in epoch 1
2024-08-12 12:51:15,115 : INFO : Current training batch loss: 0.5949 in epoch 1
2024-08-12 12:51:15,257 : INFO : Epoch finished, average loss over training batches: 0.7438
2024-08-12 12:51:15,258 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:15,258 : INFO : Training metrics:
2024-08-12 12:51:15,258 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:15,265 : INFO : Accuracy: 0.6946
2024-08-12 12:51:15,265 : INFO : Precision score for label_class 0: 0.2840
2024-08-12 12:51:15,265 : INFO : Precision score for label_class 1: 0.7429
2024-08-12 12:51:15,265 : INFO : Precision score for label_class 2: 0.5870
2024-08-12 12:51:15,265 : INFO : Recall score for label_class 0: 0.0701
2024-08-12 12:51:15,265 : INFO : Recall score for label_class 1: 0.9311
2024-08-12 12:51:15,265 : INFO : Recall score for label_class 2: 0.4625
2024-08-12 12:51:15,265 : INFO : Average F1 score: 0.4854
2024-08-12 12:51:15,545 : INFO : Average loss over validation batches: 0.5278
2024-08-12 12:51:15,545 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:15,546 : INFO : Validation metrics:
2024-08-12 12:51:15,546 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:15,548 : INFO : Accuracy: 0.7674
2024-08-12 12:51:15,548 : INFO : Precision score for label_class 0: 1.0000
2024-08-12 12:51:15,548 : INFO : Precision score for label_class 1: 0.8795
2024-08-12 12:51:15,548 : INFO : Precision score for label_class 2: 0.5869
2024-08-12 12:51:15,548 : INFO : Recall score for label_class 0: 0.0116
2024-08-12 12:51:15,548 : INFO : Recall score for label_class 1: 0.9125
2024-08-12 12:51:15,548 : INFO : Recall score for label_class 2: 0.8042
2024-08-12 12:51:15,548 : INFO : Average F1 score: 0.5324
2024-08-12 12:51:15,548 : INFO : Validation metric decreased (inf --> 0.527777).  Saving model ...
2024-08-12 12:51:15,649 : INFO : Starting epoch 2
2024-08-12 12:51:16,296 : INFO : Current training batch loss: 0.5359 in epoch 2
2024-08-12 12:51:17,104 : INFO : Current training batch loss: 0.3607 in epoch 2
2024-08-12 12:51:17,913 : INFO : Current training batch loss: 0.3065 in epoch 2
2024-08-12 12:51:18,721 : INFO : Current training batch loss: 0.2255 in epoch 2
2024-08-12 12:51:19,066 : INFO : Epoch finished, average loss over training batches: 0.3806
2024-08-12 12:51:19,066 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:19,066 : INFO : Training metrics:
2024-08-12 12:51:19,066 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:19,070 : INFO : Accuracy: 0.8736
2024-08-12 12:51:19,070 : INFO : Precision score for label_class 0: 0.7900
2024-08-12 12:51:19,070 : INFO : Precision score for label_class 1: 0.9097
2024-08-12 12:51:19,070 : INFO : Precision score for label_class 2: 0.8263
2024-08-12 12:51:19,070 : INFO : Recall score for label_class 0: 0.7226
2024-08-12 12:51:19,070 : INFO : Recall score for label_class 1: 0.9379
2024-08-12 12:51:19,070 : INFO : Recall score for label_class 2: 0.8024
2024-08-12 12:51:19,070 : INFO : Average F1 score: 0.8308
2024-08-12 12:51:19,350 : INFO : Average loss over validation batches: 0.3579
2024-08-12 12:51:19,350 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:19,350 : INFO : Validation metrics:
2024-08-12 12:51:19,350 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:19,353 : INFO : Accuracy: 0.8889
2024-08-12 12:51:19,353 : INFO : Precision score for label_class 0: 0.8140
2024-08-12 12:51:19,353 : INFO : Precision score for label_class 1: 0.9111
2024-08-12 12:51:19,353 : INFO : Precision score for label_class 2: 0.8728
2024-08-12 12:51:19,353 : INFO : Recall score for label_class 0: 0.8140
2024-08-12 12:51:19,353 : INFO : Recall score for label_class 1: 0.9475
2024-08-12 12:51:19,353 : INFO : Recall score for label_class 2: 0.7989
2024-08-12 12:51:19,353 : INFO : Average F1 score: 0.8590
2024-08-12 12:51:19,353 : INFO : Validation metric decreased (0.527777 --> 0.357947).  Saving model ...
2024-08-12 12:51:19,453 : INFO : Split 3 is finished, the score is: 0.8590
2024-08-12 12:51:19,453 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:19,453 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:19,453 : INFO : Starting training for split 4
2024-08-12 12:51:19,550 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 327, 1621,  751]))
2024-08-12 12:51:19,552 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 87, 390, 197]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:51:19,593 : INFO : Starting epoch 1
2024-08-12 12:51:19,635 : INFO : Current training batch loss: 1.0980 in epoch 1
2024-08-12 12:51:20,444 : INFO : Current training batch loss: 0.9522 in epoch 1
2024-08-12 12:51:21,254 : INFO : Current training batch loss: 0.6445 in epoch 1
2024-08-12 12:51:22,063 : INFO : Current training batch loss: 0.5931 in epoch 1
2024-08-12 12:51:22,873 : INFO : Current training batch loss: 0.5132 in epoch 1
2024-08-12 12:51:23,016 : INFO : Epoch finished, average loss over training batches: 0.7175
2024-08-12 12:51:23,017 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:23,017 : INFO : Training metrics:
2024-08-12 12:51:23,017 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:23,024 : INFO : Accuracy: 0.7258
2024-08-12 12:51:23,024 : INFO : Precision score for label_class 0: 0.7615
2024-08-12 12:51:23,024 : INFO : Precision score for label_class 1: 0.7495
2024-08-12 12:51:23,024 : INFO : Precision score for label_class 2: 0.6384
2024-08-12 12:51:23,024 : INFO : Recall score for label_class 0: 0.3028
2024-08-12 12:51:23,024 : INFO : Recall score for label_class 1: 0.9155
2024-08-12 12:51:23,024 : INFO : Recall score for label_class 2: 0.5007
2024-08-12 12:51:23,024 : INFO : Average F1 score: 0.6062
2024-08-12 12:51:23,304 : INFO : Average loss over validation batches: 0.4514
2024-08-12 12:51:23,305 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:23,305 : INFO : Validation metrics:
2024-08-12 12:51:23,305 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:23,308 : INFO : Accuracy: 0.8501
2024-08-12 12:51:23,309 : INFO : Precision score for label_class 0: 0.6900
2024-08-12 12:51:23,309 : INFO : Precision score for label_class 1: 0.9033
2024-08-12 12:51:23,309 : INFO : Precision score for label_class 2: 0.8232
2024-08-12 12:51:23,309 : INFO : Recall score for label_class 0: 0.7931
2024-08-12 12:51:23,309 : INFO : Recall score for label_class 1: 0.9103
2024-08-12 12:51:23,309 : INFO : Recall score for label_class 2: 0.7563
2024-08-12 12:51:23,309 : INFO : Average F1 score: 0.8110
2024-08-12 12:51:23,309 : INFO : Validation metric decreased (inf --> 0.451427).  Saving model ...
2024-08-12 12:51:23,411 : INFO : Starting epoch 2
2024-08-12 12:51:24,059 : INFO : Current training batch loss: 0.4487 in epoch 2
2024-08-12 12:51:24,868 : INFO : Current training batch loss: 0.2677 in epoch 2
2024-08-12 12:51:25,678 : INFO : Current training batch loss: 0.2682 in epoch 2
2024-08-12 12:51:26,488 : INFO : Current training batch loss: 0.2088 in epoch 2
2024-08-12 12:51:26,835 : INFO : Epoch finished, average loss over training batches: 0.3406
2024-08-12 12:51:26,836 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:26,836 : INFO : Training metrics:
2024-08-12 12:51:26,836 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:26,839 : INFO : Accuracy: 0.8911
2024-08-12 12:51:26,839 : INFO : Precision score for label_class 0: 0.8084
2024-08-12 12:51:26,839 : INFO : Precision score for label_class 1: 0.9179
2024-08-12 12:51:26,839 : INFO : Precision score for label_class 2: 0.8672
2024-08-12 12:51:26,839 : INFO : Recall score for label_class 0: 0.8257
2024-08-12 12:51:26,839 : INFO : Recall score for label_class 1: 0.9383
2024-08-12 12:51:26,839 : INFO : Recall score for label_class 2: 0.8176
2024-08-12 12:51:26,839 : INFO : Average F1 score: 0.8622
2024-08-12 12:51:27,120 : INFO : Average loss over validation batches: 0.3794
2024-08-12 12:51:27,120 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:27,120 : INFO : Validation metrics:
2024-08-12 12:51:27,120 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:27,123 : INFO : Accuracy: 0.8546
2024-08-12 12:51:27,123 : INFO : Precision score for label_class 0: 0.7071
2024-08-12 12:51:27,123 : INFO : Precision score for label_class 1: 0.8894
2024-08-12 12:51:27,123 : INFO : Precision score for label_class 2: 0.8571
2024-08-12 12:51:27,123 : INFO : Recall score for label_class 0: 0.8046
2024-08-12 12:51:27,124 : INFO : Recall score for label_class 1: 0.9282
2024-08-12 12:51:27,124 : INFO : Recall score for label_class 2: 0.7310
2024-08-12 12:51:27,124 : INFO : Average F1 score: 0.8167
2024-08-12 12:51:27,124 : INFO : Validation metric decreased (0.451427 --> 0.379384).  Saving model ...
2024-08-12 12:51:27,226 : INFO : Split 4 is finished, the score is: 0.8167
2024-08-12 12:51:27,226 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:27,226 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:27,226 : INFO : Starting training for split 5
2024-08-12 12:51:27,238 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 330, 1615,  754]))
2024-08-12 12:51:27,240 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 84, 396, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:51:27,282 : INFO : Starting epoch 1
2024-08-12 12:51:27,324 : INFO : Current training batch loss: 1.0755 in epoch 1
2024-08-12 12:51:28,134 : INFO : Current training batch loss: 0.9332 in epoch 1
2024-08-12 12:51:28,943 : INFO : Current training batch loss: 0.6277 in epoch 1
2024-08-12 12:51:29,751 : INFO : Current training batch loss: 0.6114 in epoch 1
2024-08-12 12:51:30,560 : INFO : Current training batch loss: 0.4220 in epoch 1
2024-08-12 12:51:30,703 : INFO : Epoch finished, average loss over training batches: 0.7066
2024-08-12 12:51:30,703 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:30,703 : INFO : Training metrics:
2024-08-12 12:51:30,703 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:30,714 : INFO : Accuracy: 0.7284
2024-08-12 12:51:30,714 : INFO : Precision score for label_class 0: 0.7733
2024-08-12 12:51:30,714 : INFO : Precision score for label_class 1: 0.7478
2024-08-12 12:51:30,714 : INFO : Precision score for label_class 2: 0.6519
2024-08-12 12:51:30,714 : INFO : Recall score for label_class 0: 0.1758
2024-08-12 12:51:30,714 : INFO : Recall score for label_class 1: 0.9529
2024-08-12 12:51:30,714 : INFO : Recall score for label_class 2: 0.4894
2024-08-12 12:51:30,714 : INFO : Average F1 score: 0.5612
2024-08-12 12:51:30,995 : INFO : Average loss over validation batches: 0.5140
2024-08-12 12:51:30,995 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:30,995 : INFO : Validation metrics:
2024-08-12 12:51:30,995 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:30,999 : INFO : Accuracy: 0.8145
2024-08-12 12:51:30,999 : INFO : Precision score for label_class 0: 0.7333
2024-08-12 12:51:30,999 : INFO : Precision score for label_class 1: 0.8141
2024-08-12 12:51:30,999 : INFO : Precision score for label_class 2: 0.8626
2024-08-12 12:51:30,999 : INFO : Recall score for label_class 0: 0.6548
2024-08-12 12:51:30,999 : INFO : Recall score for label_class 1: 0.9621
2024-08-12 12:51:30,999 : INFO : Recall score for label_class 2: 0.5825
2024-08-12 12:51:30,999 : INFO : Average F1 score: 0.7564
2024-08-12 12:51:30,999 : INFO : Validation metric decreased (inf --> 0.513961).  Saving model ...
2024-08-12 12:51:31,101 : INFO : Starting epoch 2
2024-08-12 12:51:31,749 : INFO : Current training batch loss: 0.3763 in epoch 2
2024-08-12 12:51:32,557 : INFO : Current training batch loss: 0.3678 in epoch 2
2024-08-12 12:51:33,365 : INFO : Current training batch loss: 0.2578 in epoch 2
2024-08-12 12:51:34,174 : INFO : Current training batch loss: 0.3154 in epoch 2
2024-08-12 12:51:34,519 : INFO : Epoch finished, average loss over training batches: 0.3457
2024-08-12 12:51:34,519 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:34,519 : INFO : Training metrics:
2024-08-12 12:51:34,519 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:34,526 : INFO : Accuracy: 0.8918
2024-08-12 12:51:34,526 : INFO : Precision score for label_class 0: 0.8101
2024-08-12 12:51:34,526 : INFO : Precision score for label_class 1: 0.9159
2024-08-12 12:51:34,526 : INFO : Precision score for label_class 2: 0.8745
2024-08-12 12:51:34,526 : INFO : Recall score for label_class 0: 0.8273
2024-08-12 12:51:34,526 : INFO : Recall score for label_class 1: 0.9375
2024-08-12 12:51:34,526 : INFO : Recall score for label_class 2: 0.8223
2024-08-12 12:51:34,526 : INFO : Average F1 score: 0.8642
2024-08-12 12:51:34,806 : INFO : Average loss over validation batches: 0.4056
2024-08-12 12:51:34,806 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:34,806 : INFO : Validation metrics:
2024-08-12 12:51:34,806 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:34,810 : INFO : Accuracy: 0.8501
2024-08-12 12:51:34,810 : INFO : Precision score for label_class 0: 0.7792
2024-08-12 12:51:34,810 : INFO : Precision score for label_class 1: 0.8756
2024-08-12 12:51:34,810 : INFO : Precision score for label_class 2: 0.8212
2024-08-12 12:51:34,810 : INFO : Recall score for label_class 0: 0.7143
2024-08-12 12:51:34,810 : INFO : Recall score for label_class 1: 0.9242
2024-08-12 12:51:34,810 : INFO : Recall score for label_class 2: 0.7577
2024-08-12 12:51:34,810 : INFO : Average F1 score: 0.8109
2024-08-12 12:51:34,810 : INFO : Validation metric decreased (0.513961 --> 0.405618).  Saving model ...
2024-08-12 12:51:34,912 : INFO : Split 5 is finished, the score is: 0.8109
2024-08-12 12:51:34,912 : INFO : ----------------------------------------------------------------------------------------------------
[I 2024-08-12 12:51:34,913] Trial 1 finished with value: 0.833042786775897 and parameters: {'n_epochs': 2, 'learning_rate': 8.132806644873276e-05, 'classifier_dropout': 0.24797357264071546, 'warmup_step_fraction': 0.04692822874741785, 'use_gradient_clipping': False}. Best is trial 1 with value: 0.833042786775897.
2024-08-12 12:51:34,913 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:34,913 : INFO : Starting training for split 1
2024-08-12 12:51:34,924 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 328, 1596,  774]))
2024-08-12 12:51:34,926 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 86, 415, 174]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:51:34,967 : INFO : Starting epoch 1
2024-08-12 12:51:35,030 : INFO : Current training batch loss: 1.0969 in epoch 1
2024-08-12 12:51:35,841 : INFO : Current training batch loss: 0.8974 in epoch 1
2024-08-12 12:51:36,653 : INFO : Current training batch loss: 0.8897 in epoch 1
2024-08-12 12:51:37,465 : INFO : Current training batch loss: 0.7317 in epoch 1
2024-08-12 12:51:38,277 : INFO : Current training batch loss: 0.7325 in epoch 1
2024-08-12 12:51:38,421 : INFO : Epoch finished, average loss over training batches: 0.8549
2024-08-12 12:51:38,421 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:38,421 : INFO : Training metrics:
2024-08-12 12:51:38,421 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:38,430 : INFO : Accuracy: 0.6553
2024-08-12 12:51:38,430 : INFO : Precision score for label_class 0: 0.2188
2024-08-12 12:51:38,430 : INFO : Precision score for label_class 1: 0.6822
2024-08-12 12:51:38,430 : INFO : Precision score for label_class 2: 0.5486
2024-08-12 12:51:38,430 : INFO : Recall score for label_class 0: 0.0213
2024-08-12 12:51:38,430 : INFO : Recall score for label_class 1: 0.9549
2024-08-12 12:51:38,430 : INFO : Recall score for label_class 2: 0.3062
2024-08-12 12:51:38,430 : INFO : Average F1 score: 0.4092
2024-08-12 12:51:38,710 : INFO : Average loss over validation batches: 0.7095
2024-08-12 12:51:38,711 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:38,711 : INFO : Validation metrics:
2024-08-12 12:51:38,711 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:38,713 : INFO : Accuracy: 0.7126
2024-08-12 12:51:38,713 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:51:38,713 : INFO : Precision score for label_class 1: 0.8241
2024-08-12 12:51:38,713 : INFO : Precision score for label_class 2: 0.4912
2024-08-12 12:51:38,713 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:51:38,713 : INFO : Recall score for label_class 1: 0.8916
2024-08-12 12:51:38,713 : INFO : Recall score for label_class 2: 0.6379
2024-08-12 12:51:38,713 : INFO : Average F1 score: 0.4705
2024-08-12 12:51:38,713 : INFO : Validation metric decreased (inf --> 0.709459).  Saving model ...
2024-08-12 12:51:38,816 : INFO : Starting epoch 2
2024-08-12 12:51:39,465 : INFO : Current training batch loss: 0.4661 in epoch 2
2024-08-12 12:51:40,277 : INFO : Current training batch loss: 0.6303 in epoch 2
2024-08-12 12:51:41,088 : INFO : Current training batch loss: 0.5855 in epoch 2
2024-08-12 12:51:41,900 : INFO : Current training batch loss: 0.4659 in epoch 2
2024-08-12 12:51:42,249 : INFO : Epoch finished, average loss over training batches: 0.5972
2024-08-12 12:51:42,249 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:42,249 : INFO : Training metrics:
2024-08-12 12:51:42,249 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:42,254 : INFO : Accuracy: 0.7702
2024-08-12 12:51:42,254 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:51:42,254 : INFO : Precision score for label_class 1: 0.8458
2024-08-12 12:51:42,254 : INFO : Precision score for label_class 2: 0.6211
2024-08-12 12:51:42,254 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:51:42,254 : INFO : Recall score for label_class 1: 0.9486
2024-08-12 12:51:42,254 : INFO : Recall score for label_class 2: 0.7287
2024-08-12 12:51:42,254 : INFO : Average F1 score: 0.5216
2024-08-12 12:51:42,534 : INFO : Average loss over validation batches: 0.5886
2024-08-12 12:51:42,534 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:42,534 : INFO : Validation metrics:
2024-08-12 12:51:42,534 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:42,537 : INFO : Accuracy: 0.7585
2024-08-12 12:51:42,537 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:51:42,537 : INFO : Precision score for label_class 1: 0.8616
2024-08-12 12:51:42,537 : INFO : Precision score for label_class 2: 0.5551
2024-08-12 12:51:42,537 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:51:42,537 : INFO : Recall score for label_class 1: 0.9301
2024-08-12 12:51:42,537 : INFO : Recall score for label_class 2: 0.7241
2024-08-12 12:51:42,537 : INFO : Average F1 score: 0.5077
2024-08-12 12:51:42,537 : INFO : Validation metric decreased (0.709459 --> 0.588641).  Saving model ...
2024-08-12 12:51:42,639 : INFO : Split 1 is finished, the score is: 0.5077
2024-08-12 12:51:42,639 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:42,639 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:42,639 : INFO : Starting training for split 2
2024-08-12 12:51:42,651 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 343, 1601,  754]))
2024-08-12 12:51:42,653 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 71, 410, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:51:42,697 : INFO : Starting epoch 1
2024-08-12 12:51:42,740 : INFO : Current training batch loss: 1.1062 in epoch 1
2024-08-12 12:51:43,553 : INFO : Current training batch loss: 1.0021 in epoch 1
2024-08-12 12:51:44,365 : INFO : Current training batch loss: 0.8994 in epoch 1
2024-08-12 12:51:45,177 : INFO : Current training batch loss: 0.7484 in epoch 1
2024-08-12 12:51:45,989 : INFO : Current training batch loss: 0.7000 in epoch 1
2024-08-12 12:51:46,134 : INFO : Epoch finished, average loss over training batches: 0.8598
2024-08-12 12:51:46,134 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:46,134 : INFO : Training metrics:
2024-08-12 12:51:46,134 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:46,145 : INFO : Accuracy: 0.6256
2024-08-12 12:51:46,145 : INFO : Precision score for label_class 0: 0.1982
2024-08-12 12:51:46,145 : INFO : Precision score for label_class 1: 0.6837
2024-08-12 12:51:46,145 : INFO : Precision score for label_class 2: 0.5561
2024-08-12 12:51:46,145 : INFO : Recall score for label_class 0: 0.1283
2024-08-12 12:51:46,145 : INFO : Recall score for label_class 1: 0.8938
2024-08-12 12:51:46,145 : INFO : Recall score for label_class 2: 0.2825
2024-08-12 12:51:46,145 : INFO : Average F1 score: 0.4351
2024-08-12 12:51:46,425 : INFO : Average loss over validation batches: 0.6608
2024-08-12 12:51:46,425 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:46,425 : INFO : Validation metrics:
2024-08-12 12:51:46,425 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:46,428 : INFO : Accuracy: 0.7704
2024-08-12 12:51:46,428 : INFO : Precision score for label_class 0: 0.8889
2024-08-12 12:51:46,429 : INFO : Precision score for label_class 1: 0.8202
2024-08-12 12:51:46,429 : INFO : Precision score for label_class 2: 0.6468
2024-08-12 12:51:46,429 : INFO : Recall score for label_class 0: 0.2254
2024-08-12 12:51:46,429 : INFO : Recall score for label_class 1: 0.9122
2024-08-12 12:51:46,429 : INFO : Recall score for label_class 2: 0.6701
2024-08-12 12:51:46,429 : INFO : Average F1 score: 0.6272
2024-08-12 12:51:46,429 : INFO : Validation metric decreased (inf --> 0.660767).  Saving model ...
2024-08-12 12:51:46,531 : INFO : Starting epoch 2
2024-08-12 12:51:47,181 : INFO : Current training batch loss: 0.6141 in epoch 2
2024-08-12 12:51:47,993 : INFO : Current training batch loss: 0.6208 in epoch 2
2024-08-12 12:51:48,805 : INFO : Current training batch loss: 0.5327 in epoch 2
2024-08-12 12:51:49,616 : INFO : Current training batch loss: 0.4195 in epoch 2
2024-08-12 12:51:49,960 : INFO : Epoch finished, average loss over training batches: 0.5678
2024-08-12 12:51:49,960 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:49,960 : INFO : Training metrics:
2024-08-12 12:51:49,960 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:49,971 : INFO : Accuracy: 0.8325
2024-08-12 12:51:49,971 : INFO : Precision score for label_class 0: 0.7837
2024-08-12 12:51:49,971 : INFO : Precision score for label_class 1: 0.8639
2024-08-12 12:51:49,971 : INFO : Precision score for label_class 2: 0.7704
2024-08-12 12:51:49,971 : INFO : Recall score for label_class 0: 0.5598
2024-08-12 12:51:49,971 : INFO : Recall score for label_class 1: 0.9475
2024-08-12 12:51:49,971 : INFO : Recall score for label_class 2: 0.7122
2024-08-12 12:51:49,971 : INFO : Average F1 score: 0.7657
2024-08-12 12:51:50,251 : INFO : Average loss over validation batches: 0.5420
2024-08-12 12:51:50,251 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:50,251 : INFO : Validation metrics:
2024-08-12 12:51:50,251 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:50,254 : INFO : Accuracy: 0.8489
2024-08-12 12:51:50,255 : INFO : Precision score for label_class 0: 0.7833
2024-08-12 12:51:50,255 : INFO : Precision score for label_class 1: 0.8527
2024-08-12 12:51:50,255 : INFO : Precision score for label_class 2: 0.8625
2024-08-12 12:51:50,255 : INFO : Recall score for label_class 0: 0.6620
2024-08-12 12:51:50,255 : INFO : Recall score for label_class 1: 0.9463
2024-08-12 12:51:50,255 : INFO : Recall score for label_class 2: 0.7113
2024-08-12 12:51:50,255 : INFO : Average F1 score: 0.7981
2024-08-12 12:51:50,255 : INFO : Validation metric decreased (0.660767 --> 0.542011).  Saving model ...
2024-08-12 12:51:50,358 : INFO : Split 2 is finished, the score is: 0.7981
2024-08-12 12:51:50,358 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:50,358 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:50,358 : INFO : Starting training for split 3
2024-08-12 12:51:50,369 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 328, 1611,  759]))
2024-08-12 12:51:50,372 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 86, 400, 189]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:51:50,414 : INFO : Starting epoch 1
2024-08-12 12:51:50,456 : INFO : Current training batch loss: 1.0996 in epoch 1
2024-08-12 12:51:51,265 : INFO : Current training batch loss: 1.0001 in epoch 1
2024-08-12 12:51:52,073 : INFO : Current training batch loss: 0.8014 in epoch 1
2024-08-12 12:51:52,882 : INFO : Current training batch loss: 0.7434 in epoch 1
2024-08-12 12:51:53,691 : INFO : Current training batch loss: 0.7038 in epoch 1
2024-08-12 12:51:53,833 : INFO : Epoch finished, average loss over training batches: 0.8525
2024-08-12 12:51:53,833 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:53,833 : INFO : Training metrics:
2024-08-12 12:51:53,833 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:53,841 : INFO : Accuracy: 0.6442
2024-08-12 12:51:53,841 : INFO : Precision score for label_class 0: 0.1224
2024-08-12 12:51:53,841 : INFO : Precision score for label_class 1: 0.6840
2024-08-12 12:51:53,841 : INFO : Precision score for label_class 2: 0.5561
2024-08-12 12:51:53,841 : INFO : Recall score for label_class 0: 0.0366
2024-08-12 12:51:53,841 : INFO : Recall score for label_class 1: 0.9299
2024-08-12 12:51:53,841 : INFO : Recall score for label_class 2: 0.3004
2024-08-12 12:51:53,841 : INFO : Average F1 score: 0.4115
2024-08-12 12:51:54,121 : INFO : Average loss over validation batches: 0.6746
2024-08-12 12:51:54,121 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:54,121 : INFO : Validation metrics:
2024-08-12 12:51:54,121 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:54,124 : INFO : Accuracy: 0.7348
2024-08-12 12:51:54,124 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:51:54,124 : INFO : Precision score for label_class 1: 0.8414
2024-08-12 12:51:54,124 : INFO : Precision score for label_class 2: 0.5417
2024-08-12 12:51:54,124 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:51:54,124 : INFO : Recall score for label_class 1: 0.9150
2024-08-12 12:51:54,124 : INFO : Recall score for label_class 2: 0.6878
2024-08-12 12:51:54,124 : INFO : Average F1 score: 0.4942
2024-08-12 12:51:54,124 : INFO : Validation metric decreased (inf --> 0.674634).  Saving model ...
2024-08-12 12:51:54,226 : INFO : Starting epoch 2
2024-08-12 12:51:54,872 : INFO : Current training batch loss: 0.6438 in epoch 2
2024-08-12 12:51:55,680 : INFO : Current training batch loss: 0.5163 in epoch 2
2024-08-12 12:51:56,488 : INFO : Current training batch loss: 0.5303 in epoch 2
2024-08-12 12:51:57,296 : INFO : Current training batch loss: 0.4233 in epoch 2
2024-08-12 12:51:57,640 : INFO : Epoch finished, average loss over training batches: 0.5771
2024-08-12 12:51:57,641 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:57,641 : INFO : Training metrics:
2024-08-12 12:51:57,641 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:57,648 : INFO : Accuracy: 0.8150
2024-08-12 12:51:57,648 : INFO : Precision score for label_class 0: 0.8397
2024-08-12 12:51:57,648 : INFO : Precision score for label_class 1: 0.8469
2024-08-12 12:51:57,648 : INFO : Precision score for label_class 2: 0.7300
2024-08-12 12:51:57,648 : INFO : Recall score for label_class 0: 0.3994
2024-08-12 12:51:57,648 : INFO : Recall score for label_class 1: 0.9547
2024-08-12 12:51:57,648 : INFO : Recall score for label_class 2: 0.6983
2024-08-12 12:51:57,648 : INFO : Average F1 score: 0.7176
2024-08-12 12:51:57,929 : INFO : Average loss over validation batches: 0.5386
2024-08-12 12:51:57,929 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:57,929 : INFO : Validation metrics:
2024-08-12 12:51:57,929 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:57,931 : INFO : Accuracy: 0.8593
2024-08-12 12:51:57,931 : INFO : Precision score for label_class 0: 0.8219
2024-08-12 12:51:57,931 : INFO : Precision score for label_class 1: 0.8719
2024-08-12 12:51:57,931 : INFO : Precision score for label_class 2: 0.8424
2024-08-12 12:51:57,931 : INFO : Recall score for label_class 0: 0.6977
2024-08-12 12:51:57,931 : INFO : Recall score for label_class 1: 0.9525
2024-08-12 12:51:57,931 : INFO : Recall score for label_class 2: 0.7354
2024-08-12 12:51:57,931 : INFO : Average F1 score: 0.8168
2024-08-12 12:51:57,931 : INFO : Validation metric decreased (0.674634 --> 0.538616).  Saving model ...
2024-08-12 12:51:58,034 : INFO : Split 3 is finished, the score is: 0.8168
2024-08-12 12:51:58,034 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:58,034 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:51:58,034 : INFO : Starting training for split 4
2024-08-12 12:51:58,045 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 327, 1621,  751]))
2024-08-12 12:51:58,048 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 87, 390, 197]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:51:58,090 : INFO : Starting epoch 1
2024-08-12 12:51:58,132 : INFO : Current training batch loss: 1.1139 in epoch 1
2024-08-12 12:51:58,940 : INFO : Current training batch loss: 1.0062 in epoch 1
2024-08-12 12:51:59,749 : INFO : Current training batch loss: 0.8037 in epoch 1
2024-08-12 12:52:00,558 : INFO : Current training batch loss: 0.6674 in epoch 1
2024-08-12 12:52:01,367 : INFO : Current training batch loss: 0.6570 in epoch 1
2024-08-12 12:52:01,509 : INFO : Epoch finished, average loss over training batches: 0.8481
2024-08-12 12:52:01,509 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:01,509 : INFO : Training metrics:
2024-08-12 12:52:01,509 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:01,517 : INFO : Accuracy: 0.6447
2024-08-12 12:52:01,517 : INFO : Precision score for label_class 0: 0.1379
2024-08-12 12:52:01,517 : INFO : Precision score for label_class 1: 0.6965
2024-08-12 12:52:01,517 : INFO : Precision score for label_class 2: 0.5212
2024-08-12 12:52:01,517 : INFO : Recall score for label_class 0: 0.0367
2024-08-12 12:52:01,517 : INFO : Recall score for label_class 1: 0.8988
2024-08-12 12:52:01,517 : INFO : Recall score for label_class 2: 0.3609
2024-08-12 12:52:01,517 : INFO : Average F1 score: 0.4231
2024-08-12 12:52:01,798 : INFO : Average loss over validation batches: 0.6742
2024-08-12 12:52:01,798 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:01,798 : INFO : Validation metrics:
2024-08-12 12:52:01,798 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:01,802 : INFO : Accuracy: 0.7433
2024-08-12 12:52:01,802 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:52:01,802 : INFO : Precision score for label_class 1: 0.8373
2024-08-12 12:52:01,802 : INFO : Precision score for label_class 2: 0.5840
2024-08-12 12:52:01,802 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:52:01,802 : INFO : Recall score for label_class 1: 0.9103
2024-08-12 12:52:01,802 : INFO : Recall score for label_class 2: 0.7411
2024-08-12 12:52:01,802 : INFO : Average F1 score: 0.5085
2024-08-12 12:52:01,802 : INFO : Validation metric decreased (inf --> 0.674220).  Saving model ...
2024-08-12 12:52:01,902 : INFO : Starting epoch 2
2024-08-12 12:52:02,549 : INFO : Current training batch loss: 0.6672 in epoch 2
2024-08-12 12:52:03,357 : INFO : Current training batch loss: 0.5202 in epoch 2
2024-08-12 12:52:04,166 : INFO : Current training batch loss: 0.4895 in epoch 2
2024-08-12 12:52:04,974 : INFO : Current training batch loss: 0.4306 in epoch 2
2024-08-12 12:52:05,319 : INFO : Epoch finished, average loss over training batches: 0.5790
2024-08-12 12:52:05,319 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:05,319 : INFO : Training metrics:
2024-08-12 12:52:05,319 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:05,323 : INFO : Accuracy: 0.7918
2024-08-12 12:52:05,323 : INFO : Precision score for label_class 0: 0.8200
2024-08-12 12:52:05,323 : INFO : Precision score for label_class 1: 0.8564
2024-08-12 12:52:05,323 : INFO : Precision score for label_class 2: 0.6525
2024-08-12 12:52:05,323 : INFO : Recall score for label_class 0: 0.1254
2024-08-12 12:52:05,323 : INFO : Recall score for label_class 1: 0.9525
2024-08-12 12:52:05,323 : INFO : Recall score for label_class 2: 0.7350
2024-08-12 12:52:05,323 : INFO : Average F1 score: 0.6036
2024-08-12 12:52:05,602 : INFO : Average loss over validation batches: 0.5708
2024-08-12 12:52:05,603 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:05,603 : INFO : Validation metrics:
2024-08-12 12:52:05,603 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:05,606 : INFO : Accuracy: 0.8160
2024-08-12 12:52:05,606 : INFO : Precision score for label_class 0: 0.8043
2024-08-12 12:52:05,606 : INFO : Precision score for label_class 1: 0.8531
2024-08-12 12:52:05,606 : INFO : Precision score for label_class 2: 0.7387
2024-08-12 12:52:05,606 : INFO : Recall score for label_class 0: 0.4253
2024-08-12 12:52:05,606 : INFO : Recall score for label_class 1: 0.9385
2024-08-12 12:52:05,606 : INFO : Recall score for label_class 2: 0.7462
2024-08-12 12:52:05,606 : INFO : Average F1 score: 0.7309
2024-08-12 12:52:05,606 : INFO : Validation metric decreased (0.674220 --> 0.570813).  Saving model ...
2024-08-12 12:52:05,710 : INFO : Split 4 is finished, the score is: 0.7309
2024-08-12 12:52:05,710 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:05,711 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:05,711 : INFO : Starting training for split 5
2024-08-12 12:52:05,722 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 330, 1615,  754]))
2024-08-12 12:52:05,724 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 84, 396, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:52:05,764 : INFO : Starting epoch 1
2024-08-12 12:52:05,806 : INFO : Current training batch loss: 1.0991 in epoch 1
2024-08-12 12:52:06,613 : INFO : Current training batch loss: 1.0036 in epoch 1
2024-08-12 12:52:07,421 : INFO : Current training batch loss: 0.7994 in epoch 1
2024-08-12 12:52:08,229 : INFO : Current training batch loss: 0.7338 in epoch 1
2024-08-12 12:52:09,037 : INFO : Current training batch loss: 0.7707 in epoch 1
2024-08-12 12:52:09,179 : INFO : Epoch finished, average loss over training batches: 0.8568
2024-08-12 12:52:09,179 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:09,179 : INFO : Training metrics:
2024-08-12 12:52:09,179 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:09,190 : INFO : Accuracy: 0.6514
2024-08-12 12:52:09,190 : INFO : Precision score for label_class 0: 0.5000
2024-08-12 12:52:09,190 : INFO : Precision score for label_class 1: 0.6849
2024-08-12 12:52:09,191 : INFO : Precision score for label_class 2: 0.5041
2024-08-12 12:52:09,191 : INFO : Recall score for label_class 0: 0.0212
2024-08-12 12:52:09,191 : INFO : Recall score for label_class 1: 0.9325
2024-08-12 12:52:09,191 : INFO : Recall score for label_class 2: 0.3249
2024-08-12 12:52:09,191 : INFO : Average F1 score: 0.4085
2024-08-12 12:52:09,470 : INFO : Average loss over validation batches: 0.6735
2024-08-12 12:52:09,471 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:09,471 : INFO : Validation metrics:
2024-08-12 12:52:09,471 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:09,474 : INFO : Accuracy: 0.7166
2024-08-12 12:52:09,474 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:52:09,474 : INFO : Precision score for label_class 1: 0.8070
2024-08-12 12:52:09,474 : INFO : Precision score for label_class 2: 0.5275
2024-08-12 12:52:09,474 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:52:09,474 : INFO : Recall score for label_class 1: 0.9293
2024-08-12 12:52:09,474 : INFO : Recall score for label_class 2: 0.5928
2024-08-12 12:52:09,474 : INFO : Average F1 score: 0.4740
2024-08-12 12:52:09,474 : INFO : Validation metric decreased (inf --> 0.673544).  Saving model ...
2024-08-12 12:52:09,577 : INFO : Starting epoch 2
2024-08-12 12:52:10,223 : INFO : Current training batch loss: 0.6815 in epoch 2
2024-08-12 12:52:11,030 : INFO : Current training batch loss: 0.5994 in epoch 2
2024-08-12 12:52:11,838 : INFO : Current training batch loss: 0.5233 in epoch 2
2024-08-12 12:52:12,647 : INFO : Current training batch loss: 0.5524 in epoch 2
2024-08-12 12:52:12,991 : INFO : Epoch finished, average loss over training batches: 0.6108
2024-08-12 12:52:12,991 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:12,991 : INFO : Training metrics:
2024-08-12 12:52:12,991 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:13,002 : INFO : Accuracy: 0.7866
2024-08-12 12:52:13,002 : INFO : Precision score for label_class 0: 0.8295
2024-08-12 12:52:13,002 : INFO : Precision score for label_class 1: 0.8340
2024-08-12 12:52:13,002 : INFO : Precision score for label_class 2: 0.6589
2024-08-12 12:52:13,002 : INFO : Recall score for label_class 0: 0.3242
2024-08-12 12:52:13,002 : INFO : Recall score for label_class 1: 0.9517
2024-08-12 12:52:13,002 : INFO : Recall score for label_class 2: 0.6353
2024-08-12 12:52:13,002 : INFO : Average F1 score: 0.6673
2024-08-12 12:52:13,281 : INFO : Average loss over validation batches: 0.5830
2024-08-12 12:52:13,281 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:13,281 : INFO : Validation metrics:
2024-08-12 12:52:13,281 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:13,285 : INFO : Accuracy: 0.8056
2024-08-12 12:52:13,285 : INFO : Precision score for label_class 0: 0.7679
2024-08-12 12:52:13,285 : INFO : Precision score for label_class 1: 0.8467
2024-08-12 12:52:13,285 : INFO : Precision score for label_class 2: 0.7182
2024-08-12 12:52:13,285 : INFO : Recall score for label_class 0: 0.5119
2024-08-12 12:52:13,285 : INFO : Recall score for label_class 1: 0.9343
2024-08-12 12:52:13,285 : INFO : Recall score for label_class 2: 0.6701
2024-08-12 12:52:13,285 : INFO : Average F1 score: 0.7320
2024-08-12 12:52:13,285 : INFO : Validation metric decreased (0.673544 --> 0.582983).  Saving model ...
2024-08-12 12:52:13,387 : INFO : Split 5 is finished, the score is: 0.7320
2024-08-12 12:52:13,388 : INFO : ----------------------------------------------------------------------------------------------------
[I 2024-08-12 12:52:13,388] Trial 2 finished with value: 0.7170863592773711 and parameters: {'n_epochs': 2, 'learning_rate': 3.9407600209677956e-05, 'classifier_dropout': 0.7702501109929738, 'warmup_step_fraction': 0.07692329063006519, 'use_gradient_clipping': True}. Best is trial 1 with value: 0.833042786775897.
2024-08-12 12:52:13,389 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:13,389 : INFO : Starting training for split 1
2024-08-12 12:52:13,400 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 328, 1596,  774]))
2024-08-12 12:52:13,402 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 86, 415, 174]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:52:13,444 : INFO : Starting epoch 1
2024-08-12 12:52:13,486 : INFO : Current training batch loss: 1.0981 in epoch 1
2024-08-12 12:52:14,293 : INFO : Current training batch loss: 0.9455 in epoch 1
2024-08-12 12:52:15,101 : INFO : Current training batch loss: 0.8785 in epoch 1
2024-08-12 12:52:15,909 : INFO : Current training batch loss: 0.6544 in epoch 1
2024-08-12 12:52:16,717 : INFO : Current training batch loss: 0.5802 in epoch 1
2024-08-12 12:52:16,859 : INFO : Epoch finished, average loss over training batches: 0.8328
2024-08-12 12:52:16,860 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:16,860 : INFO : Training metrics:
2024-08-12 12:52:16,860 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:16,868 : INFO : Accuracy: 0.6586
2024-08-12 12:52:16,868 : INFO : Precision score for label_class 0: 0.1571
2024-08-12 12:52:16,868 : INFO : Precision score for label_class 1: 0.7109
2024-08-12 12:52:16,868 : INFO : Precision score for label_class 2: 0.5453
2024-08-12 12:52:16,868 : INFO : Recall score for label_class 0: 0.0335
2024-08-12 12:52:16,868 : INFO : Recall score for label_class 1: 0.8954
2024-08-12 12:52:16,868 : INFO : Recall score for label_class 2: 0.4354
2024-08-12 12:52:16,868 : INFO : Average F1 score: 0.4440
2024-08-12 12:52:17,147 : INFO : Average loss over validation batches: 0.5990
2024-08-12 12:52:17,147 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:17,147 : INFO : Validation metrics:
2024-08-12 12:52:17,147 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:17,150 : INFO : Accuracy: 0.7363
2024-08-12 12:52:17,150 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:52:17,150 : INFO : Precision score for label_class 1: 0.8934
2024-08-12 12:52:17,150 : INFO : Precision score for label_class 2: 0.5160
2024-08-12 12:52:17,150 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:52:17,150 : INFO : Recall score for label_class 1: 0.8482
2024-08-12 12:52:17,150 : INFO : Recall score for label_class 2: 0.8333
2024-08-12 12:52:17,150 : INFO : Average F1 score: 0.5025
2024-08-12 12:52:17,150 : INFO : Validation metric decreased (inf --> 0.599036).  Saving model ...
2024-08-12 12:52:17,251 : INFO : Starting epoch 2
2024-08-12 12:52:17,898 : INFO : Current training batch loss: 0.2989 in epoch 2
2024-08-12 12:52:18,705 : INFO : Current training batch loss: 0.5680 in epoch 2
2024-08-12 12:52:19,512 : INFO : Current training batch loss: 0.3556 in epoch 2
2024-08-12 12:52:20,320 : INFO : Current training batch loss: 0.2483 in epoch 2
2024-08-12 12:52:20,664 : INFO : Epoch finished, average loss over training batches: 0.4378
2024-08-12 12:52:20,664 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:20,664 : INFO : Training metrics:
2024-08-12 12:52:20,664 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:20,669 : INFO : Accuracy: 0.8488
2024-08-12 12:52:20,669 : INFO : Precision score for label_class 0: 0.7606
2024-08-12 12:52:20,669 : INFO : Precision score for label_class 1: 0.8900
2024-08-12 12:52:20,669 : INFO : Precision score for label_class 2: 0.7930
2024-08-12 12:52:20,669 : INFO : Recall score for label_class 0: 0.6585
2024-08-12 12:52:20,669 : INFO : Recall score for label_class 1: 0.9179
2024-08-12 12:52:20,669 : INFO : Recall score for label_class 2: 0.7868
2024-08-12 12:52:20,669 : INFO : Average F1 score: 0.7998
2024-08-12 12:52:20,949 : INFO : Average loss over validation batches: 0.3972
2024-08-12 12:52:20,949 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:20,949 : INFO : Validation metrics:
2024-08-12 12:52:20,949 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:20,952 : INFO : Accuracy: 0.8533
2024-08-12 12:52:20,952 : INFO : Precision score for label_class 0: 0.8205
2024-08-12 12:52:20,952 : INFO : Precision score for label_class 1: 0.9198
2024-08-12 12:52:20,952 : INFO : Precision score for label_class 2: 0.7323
2024-08-12 12:52:20,952 : INFO : Recall score for label_class 0: 0.7442
2024-08-12 12:52:20,952 : INFO : Recall score for label_class 1: 0.8843
2024-08-12 12:52:20,952 : INFO : Recall score for label_class 2: 0.8333
2024-08-12 12:52:20,952 : INFO : Average F1 score: 0.8206
2024-08-12 12:52:20,952 : INFO : Validation metric decreased (0.599036 --> 0.397214).  Saving model ...
2024-08-12 12:52:21,053 : INFO : Starting epoch 3
2024-08-12 12:52:21,498 : INFO : Current training batch loss: 0.3051 in epoch 3
2024-08-12 12:52:22,305 : INFO : Current training batch loss: 0.3393 in epoch 3
2024-08-12 12:52:23,114 : INFO : Current training batch loss: 0.1878 in epoch 3
2024-08-12 12:52:23,922 : INFO : Current training batch loss: 0.1320 in epoch 3
2024-08-12 12:52:24,468 : INFO : Epoch finished, average loss over training batches: 0.2453
2024-08-12 12:52:24,468 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:24,468 : INFO : Training metrics:
2024-08-12 12:52:24,468 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:24,476 : INFO : Accuracy: 0.9196
2024-08-12 12:52:24,476 : INFO : Precision score for label_class 0: 0.8140
2024-08-12 12:52:24,476 : INFO : Precision score for label_class 1: 0.9529
2024-08-12 12:52:24,476 : INFO : Precision score for label_class 2: 0.8978
2024-08-12 12:52:24,476 : INFO : Recall score for label_class 0: 0.8537
2024-08-12 12:52:24,476 : INFO : Recall score for label_class 1: 0.9499
2024-08-12 12:52:24,476 : INFO : Recall score for label_class 2: 0.8850
2024-08-12 12:52:24,476 : INFO : Average F1 score: 0.8920
2024-08-12 12:52:24,756 : INFO : Average loss over validation batches: 0.4015
2024-08-12 12:52:24,756 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:24,756 : INFO : Validation metrics:
2024-08-12 12:52:24,756 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:24,760 : INFO : Accuracy: 0.8548
2024-08-12 12:52:24,760 : INFO : Precision score for label_class 0: 0.8194
2024-08-12 12:52:24,760 : INFO : Precision score for label_class 1: 0.9051
2024-08-12 12:52:24,760 : INFO : Precision score for label_class 2: 0.7604
2024-08-12 12:52:24,760 : INFO : Recall score for label_class 0: 0.6860
2024-08-12 12:52:24,760 : INFO : Recall score for label_class 1: 0.8964
2024-08-12 12:52:24,760 : INFO : Recall score for label_class 2: 0.8391
2024-08-12 12:52:24,760 : INFO : Average F1 score: 0.8151
2024-08-12 12:52:24,760 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 12:52:24,760 : INFO : Starting epoch 4
2024-08-12 12:52:25,002 : INFO : Current training batch loss: 0.3630 in epoch 4
2024-08-12 12:52:25,810 : INFO : Current training batch loss: 0.0855 in epoch 4
2024-08-12 12:52:26,618 : INFO : Current training batch loss: 0.2202 in epoch 4
2024-08-12 12:52:27,426 : INFO : Current training batch loss: 0.1494 in epoch 4
2024-08-12 12:52:28,173 : INFO : Epoch finished, average loss over training batches: 0.1448
2024-08-12 12:52:28,174 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:28,174 : INFO : Training metrics:
2024-08-12 12:52:28,174 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:28,182 : INFO : Accuracy: 0.9592
2024-08-12 12:52:28,182 : INFO : Precision score for label_class 0: 0.8892
2024-08-12 12:52:28,182 : INFO : Precision score for label_class 1: 0.9774
2024-08-12 12:52:28,182 : INFO : Precision score for label_class 2: 0.9526
2024-08-12 12:52:28,182 : INFO : Recall score for label_class 0: 0.9299
2024-08-12 12:52:28,182 : INFO : Recall score for label_class 1: 0.9774
2024-08-12 12:52:28,182 : INFO : Recall score for label_class 2: 0.9341
2024-08-12 12:52:28,182 : INFO : Average F1 score: 0.9433
2024-08-12 12:52:28,462 : INFO : Average loss over validation batches: 0.3783
2024-08-12 12:52:28,462 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:28,462 : INFO : Validation metrics:
2024-08-12 12:52:28,462 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:28,466 : INFO : Accuracy: 0.8830
2024-08-12 12:52:28,466 : INFO : Precision score for label_class 0: 0.7912
2024-08-12 12:52:28,466 : INFO : Precision score for label_class 1: 0.9291
2024-08-12 12:52:28,466 : INFO : Precision score for label_class 2: 0.8229
2024-08-12 12:52:28,466 : INFO : Recall score for label_class 0: 0.8372
2024-08-12 12:52:28,466 : INFO : Recall score for label_class 1: 0.9157
2024-08-12 12:52:28,466 : INFO : Recall score for label_class 2: 0.8276
2024-08-12 12:52:28,466 : INFO : Average F1 score: 0.8537
2024-08-12 12:52:28,466 : INFO : Validation metric decreased (0.397214 --> 0.378252).  Saving model ...
2024-08-12 12:52:28,566 : INFO : Starting epoch 5
2024-08-12 12:52:28,608 : INFO : Current training batch loss: 0.2005 in epoch 5
2024-08-12 12:52:29,415 : INFO : Current training batch loss: 0.1882 in epoch 5
2024-08-12 12:52:30,223 : INFO : Current training batch loss: 0.0236 in epoch 5
2024-08-12 12:52:31,032 : INFO : Current training batch loss: 0.1313 in epoch 5
2024-08-12 12:52:31,841 : INFO : Current training batch loss: 0.0768 in epoch 5
2024-08-12 12:52:31,983 : INFO : Epoch finished, average loss over training batches: 0.0945
2024-08-12 12:52:31,983 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:31,983 : INFO : Training metrics:
2024-08-12 12:52:31,983 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:31,988 : INFO : Accuracy: 0.9759
2024-08-12 12:52:31,988 : INFO : Precision score for label_class 0: 0.9263
2024-08-12 12:52:31,988 : INFO : Precision score for label_class 1: 0.9844
2024-08-12 12:52:31,988 : INFO : Precision score for label_class 2: 0.9801
2024-08-12 12:52:31,988 : INFO : Recall score for label_class 0: 0.9573
2024-08-12 12:52:31,988 : INFO : Recall score for label_class 1: 0.9900
2024-08-12 12:52:31,988 : INFO : Recall score for label_class 2: 0.9548
2024-08-12 12:52:31,988 : INFO : Average F1 score: 0.9653
2024-08-12 12:52:32,268 : INFO : Average loss over validation batches: 0.4235
2024-08-12 12:52:32,268 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:32,268 : INFO : Validation metrics:
2024-08-12 12:52:32,268 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:32,271 : INFO : Accuracy: 0.8830
2024-08-12 12:52:32,271 : INFO : Precision score for label_class 0: 0.7431
2024-08-12 12:52:32,271 : INFO : Precision score for label_class 1: 0.9394
2024-08-12 12:52:32,271 : INFO : Precision score for label_class 2: 0.8412
2024-08-12 12:52:32,271 : INFO : Recall score for label_class 0: 0.9419
2024-08-12 12:52:32,271 : INFO : Recall score for label_class 1: 0.8964
2024-08-12 12:52:32,271 : INFO : Recall score for label_class 2: 0.8218
2024-08-12 12:52:32,271 : INFO : Average F1 score: 0.8599
2024-08-12 12:52:32,271 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 12:52:32,271 : INFO : Starting epoch 6
2024-08-12 12:52:32,917 : INFO : Current training batch loss: 0.0073 in epoch 6
2024-08-12 12:52:33,725 : INFO : Current training batch loss: 0.0127 in epoch 6
2024-08-12 12:52:34,533 : INFO : Current training batch loss: 0.0119 in epoch 6
2024-08-12 12:52:35,342 : INFO : Current training batch loss: 0.0086 in epoch 6
2024-08-12 12:52:35,685 : INFO : Epoch finished, average loss over training batches: 0.0599
2024-08-12 12:52:35,685 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:35,686 : INFO : Training metrics:
2024-08-12 12:52:35,686 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:35,690 : INFO : Accuracy: 0.9844
2024-08-12 12:52:35,690 : INFO : Precision score for label_class 0: 0.9522
2024-08-12 12:52:35,690 : INFO : Precision score for label_class 1: 0.9912
2024-08-12 12:52:35,690 : INFO : Precision score for label_class 2: 0.9843
2024-08-12 12:52:35,690 : INFO : Recall score for label_class 0: 0.9726
2024-08-12 12:52:35,690 : INFO : Recall score for label_class 1: 0.9919
2024-08-12 12:52:35,690 : INFO : Recall score for label_class 2: 0.9742
2024-08-12 12:52:35,690 : INFO : Average F1 score: 0.9777
2024-08-12 12:52:35,970 : INFO : Average loss over validation batches: 0.4196
2024-08-12 12:52:35,970 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:35,970 : INFO : Validation metrics:
2024-08-12 12:52:35,970 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:35,973 : INFO : Accuracy: 0.8919
2024-08-12 12:52:35,973 : INFO : Precision score for label_class 0: 0.8111
2024-08-12 12:52:35,973 : INFO : Precision score for label_class 1: 0.9229
2024-08-12 12:52:35,973 : INFO : Precision score for label_class 2: 0.8588
2024-08-12 12:52:35,973 : INFO : Recall score for label_class 0: 0.8488
2024-08-12 12:52:35,973 : INFO : Recall score for label_class 1: 0.9229
2024-08-12 12:52:35,974 : INFO : Recall score for label_class 2: 0.8391
2024-08-12 12:52:35,974 : INFO : Average F1 score: 0.8671
2024-08-12 12:52:35,974 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 12:52:35,974 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:52:36,006 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 12:52:36,315 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:36,315 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 12:52:36,315 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:36,318 : INFO : Accuracy: 0.8830
2024-08-12 12:52:36,318 : INFO : Precision score for label_class 0: 0.7912
2024-08-12 12:52:36,318 : INFO : Precision score for label_class 1: 0.9291
2024-08-12 12:52:36,318 : INFO : Precision score for label_class 2: 0.8229
2024-08-12 12:52:36,318 : INFO : Recall score for label_class 0: 0.8372
2024-08-12 12:52:36,318 : INFO : Recall score for label_class 1: 0.9157
2024-08-12 12:52:36,319 : INFO : Recall score for label_class 2: 0.8276
2024-08-12 12:52:36,319 : INFO : Average F1 score: 0.8537
2024-08-12 12:52:36,319 : INFO : Determined score from best model, ending training.
2024-08-12 12:52:36,320 : INFO : Split 1 is finished, the score is: 0.8537
2024-08-12 12:52:36,320 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:36,320 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:36,320 : INFO : Starting training for split 2
2024-08-12 12:52:36,331 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 343, 1601,  754]))
2024-08-12 12:52:36,334 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 71, 410, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:52:36,374 : INFO : Starting epoch 1
2024-08-12 12:52:36,416 : INFO : Current training batch loss: 1.1257 in epoch 1
2024-08-12 12:52:37,228 : INFO : Current training batch loss: 1.0195 in epoch 1
2024-08-12 12:52:38,036 : INFO : Current training batch loss: 0.8210 in epoch 1
2024-08-12 12:52:38,844 : INFO : Current training batch loss: 0.6230 in epoch 1
2024-08-12 12:52:39,652 : INFO : Current training batch loss: 0.6148 in epoch 1
2024-08-12 12:52:39,794 : INFO : Epoch finished, average loss over training batches: 0.8333
2024-08-12 12:52:39,794 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:39,794 : INFO : Training metrics:
2024-08-12 12:52:39,794 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:39,802 : INFO : Accuracy: 0.6156
2024-08-12 12:52:39,802 : INFO : Precision score for label_class 0: 0.1433
2024-08-12 12:52:39,802 : INFO : Precision score for label_class 1: 0.7142
2024-08-12 12:52:39,802 : INFO : Precision score for label_class 2: 0.5418
2024-08-12 12:52:39,802 : INFO : Recall score for label_class 0: 0.1283
2024-08-12 12:52:39,802 : INFO : Recall score for label_class 1: 0.8320
2024-08-12 12:52:39,802 : INFO : Recall score for label_class 2: 0.3780
2024-08-12 12:52:39,802 : INFO : Average F1 score: 0.4498
2024-08-12 12:52:40,081 : INFO : Average loss over validation batches: 0.5671
2024-08-12 12:52:40,081 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:40,081 : INFO : Validation metrics:
2024-08-12 12:52:40,081 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:40,084 : INFO : Accuracy: 0.7896
2024-08-12 12:52:40,084 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:52:40,084 : INFO : Precision score for label_class 1: 0.8556
2024-08-12 12:52:40,084 : INFO : Precision score for label_class 2: 0.6578
2024-08-12 12:52:40,084 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:52:40,084 : INFO : Recall score for label_class 1: 0.9390
2024-08-12 12:52:40,084 : INFO : Recall score for label_class 2: 0.7629
2024-08-12 12:52:40,084 : INFO : Average F1 score: 0.5339
2024-08-12 12:52:40,084 : INFO : Validation metric decreased (inf --> 0.567091).  Saving model ...
2024-08-12 12:52:40,186 : INFO : Starting epoch 2
2024-08-12 12:52:40,832 : INFO : Current training batch loss: 0.6048 in epoch 2
2024-08-12 12:52:41,640 : INFO : Current training batch loss: 0.5342 in epoch 2
2024-08-12 12:52:42,447 : INFO : Current training batch loss: 0.3495 in epoch 2
2024-08-12 12:52:43,255 : INFO : Current training batch loss: 0.3529 in epoch 2
2024-08-12 12:52:43,599 : INFO : Epoch finished, average loss over training batches: 0.4442
2024-08-12 12:52:43,599 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:43,599 : INFO : Training metrics:
2024-08-12 12:52:43,599 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:43,607 : INFO : Accuracy: 0.8436
2024-08-12 12:52:43,607 : INFO : Precision score for label_class 0: 0.7304
2024-08-12 12:52:43,607 : INFO : Precision score for label_class 1: 0.8970
2024-08-12 12:52:43,607 : INFO : Precision score for label_class 2: 0.7673
2024-08-12 12:52:43,607 : INFO : Recall score for label_class 0: 0.6239
2024-08-12 12:52:43,607 : INFO : Recall score for label_class 1: 0.9357
2024-08-12 12:52:43,607 : INFO : Recall score for label_class 2: 0.7480
2024-08-12 12:52:43,607 : INFO : Average F1 score: 0.7821
2024-08-12 12:52:43,886 : INFO : Average loss over validation batches: 0.4074
2024-08-12 12:52:43,886 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:43,886 : INFO : Validation metrics:
2024-08-12 12:52:43,886 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:43,890 : INFO : Accuracy: 0.8533
2024-08-12 12:52:43,890 : INFO : Precision score for label_class 0: 0.7397
2024-08-12 12:52:43,890 : INFO : Precision score for label_class 1: 0.8870
2024-08-12 12:52:43,890 : INFO : Precision score for label_class 2: 0.8226
2024-08-12 12:52:43,890 : INFO : Recall score for label_class 0: 0.7606
2024-08-12 12:52:43,890 : INFO : Recall score for label_class 1: 0.9000
2024-08-12 12:52:43,890 : INFO : Recall score for label_class 2: 0.7887
2024-08-12 12:52:43,890 : INFO : Average F1 score: 0.8162
2024-08-12 12:52:43,890 : INFO : Validation metric decreased (0.567091 --> 0.407438).  Saving model ...
2024-08-12 12:52:43,987 : INFO : Starting epoch 3
2024-08-12 12:52:44,432 : INFO : Current training batch loss: 0.2094 in epoch 3
2024-08-12 12:52:45,240 : INFO : Current training batch loss: 0.2973 in epoch 3
2024-08-12 12:52:46,048 : INFO : Current training batch loss: 0.3149 in epoch 3
2024-08-12 12:52:46,856 : INFO : Current training batch loss: 0.0625 in epoch 3
2024-08-12 12:52:47,401 : INFO : Epoch finished, average loss over training batches: 0.2583
2024-08-12 12:52:47,402 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:47,402 : INFO : Training metrics:
2024-08-12 12:52:47,402 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:47,409 : INFO : Accuracy: 0.9207
2024-08-12 12:52:47,409 : INFO : Precision score for label_class 0: 0.8283
2024-08-12 12:52:47,409 : INFO : Precision score for label_class 1: 0.9520
2024-08-12 12:52:47,410 : INFO : Precision score for label_class 2: 0.8975
2024-08-12 12:52:47,410 : INFO : Recall score for label_class 0: 0.8717
2024-08-12 12:52:47,410 : INFO : Recall score for label_class 1: 0.9544
2024-08-12 12:52:47,410 : INFO : Recall score for label_class 2: 0.8714
2024-08-12 12:52:47,410 : INFO : Average F1 score: 0.8956
2024-08-12 12:52:47,689 : INFO : Average loss over validation batches: 0.4144
2024-08-12 12:52:47,689 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:47,689 : INFO : Validation metrics:
2024-08-12 12:52:47,690 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:47,693 : INFO : Accuracy: 0.8607
2024-08-12 12:52:47,693 : INFO : Precision score for label_class 0: 0.8000
2024-08-12 12:52:47,693 : INFO : Precision score for label_class 1: 0.8871
2024-08-12 12:52:47,693 : INFO : Precision score for label_class 2: 0.8211
2024-08-12 12:52:47,693 : INFO : Recall score for label_class 0: 0.6761
2024-08-12 12:52:47,693 : INFO : Recall score for label_class 1: 0.9195
2024-08-12 12:52:47,693 : INFO : Recall score for label_class 2: 0.8041
2024-08-12 12:52:47,693 : INFO : Average F1 score: 0.8161
2024-08-12 12:52:47,693 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 12:52:47,693 : INFO : Starting epoch 4
2024-08-12 12:52:47,936 : INFO : Current training batch loss: 0.2490 in epoch 4
2024-08-12 12:52:48,744 : INFO : Current training batch loss: 0.1284 in epoch 4
2024-08-12 12:52:49,553 : INFO : Current training batch loss: 0.1004 in epoch 4
2024-08-12 12:52:50,360 : INFO : Current training batch loss: 0.1060 in epoch 4
2024-08-12 12:52:51,108 : INFO : Epoch finished, average loss over training batches: 0.1656
2024-08-12 12:52:51,108 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:51,108 : INFO : Training metrics:
2024-08-12 12:52:51,108 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:51,118 : INFO : Accuracy: 0.9481
2024-08-12 12:52:51,118 : INFO : Precision score for label_class 0: 0.8848
2024-08-12 12:52:51,118 : INFO : Precision score for label_class 1: 0.9665
2024-08-12 12:52:51,118 : INFO : Precision score for label_class 2: 0.9385
2024-08-12 12:52:51,118 : INFO : Recall score for label_class 0: 0.9184
2024-08-12 12:52:51,118 : INFO : Recall score for label_class 1: 0.9719
2024-08-12 12:52:51,118 : INFO : Recall score for label_class 2: 0.9111
2024-08-12 12:52:51,119 : INFO : Average F1 score: 0.9317
2024-08-12 12:52:51,398 : INFO : Average loss over validation batches: 0.5049
2024-08-12 12:52:51,398 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:51,398 : INFO : Validation metrics:
2024-08-12 12:52:51,398 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:51,402 : INFO : Accuracy: 0.8400
2024-08-12 12:52:51,402 : INFO : Precision score for label_class 0: 0.7403
2024-08-12 12:52:51,402 : INFO : Precision score for label_class 1: 0.9110
2024-08-12 12:52:51,402 : INFO : Precision score for label_class 2: 0.7500
2024-08-12 12:52:51,402 : INFO : Recall score for label_class 0: 0.8028
2024-08-12 12:52:51,402 : INFO : Recall score for label_class 1: 0.8488
2024-08-12 12:52:51,402 : INFO : Recall score for label_class 2: 0.8351
2024-08-12 12:52:51,402 : INFO : Average F1 score: 0.8131
2024-08-12 12:52:51,402 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 12:52:51,402 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:52:51,440 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 12:52:51,756 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:51,756 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 12:52:51,756 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:51,759 : INFO : Accuracy: 0.8533
2024-08-12 12:52:51,759 : INFO : Precision score for label_class 0: 0.7397
2024-08-12 12:52:51,759 : INFO : Precision score for label_class 1: 0.8870
2024-08-12 12:52:51,759 : INFO : Precision score for label_class 2: 0.8226
2024-08-12 12:52:51,759 : INFO : Recall score for label_class 0: 0.7606
2024-08-12 12:52:51,759 : INFO : Recall score for label_class 1: 0.9000
2024-08-12 12:52:51,760 : INFO : Recall score for label_class 2: 0.7887
2024-08-12 12:52:51,760 : INFO : Average F1 score: 0.8162
2024-08-12 12:52:51,760 : INFO : Determined score from best model, ending training.
2024-08-12 12:52:51,761 : INFO : Split 2 is finished, the score is: 0.8162
2024-08-12 12:52:51,761 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:51,761 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:51,761 : INFO : Starting training for split 3
2024-08-12 12:52:51,772 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 328, 1611,  759]))
2024-08-12 12:52:51,775 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 86, 400, 189]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:52:51,815 : INFO : Starting epoch 1
2024-08-12 12:52:51,857 : INFO : Current training batch loss: 1.1151 in epoch 1
2024-08-12 12:52:52,665 : INFO : Current training batch loss: 1.0178 in epoch 1
2024-08-12 12:52:53,474 : INFO : Current training batch loss: 0.7567 in epoch 1
2024-08-12 12:52:54,281 : INFO : Current training batch loss: 0.7404 in epoch 1
2024-08-12 12:52:55,090 : INFO : Current training batch loss: 0.6590 in epoch 1
2024-08-12 12:52:55,232 : INFO : Epoch finished, average loss over training batches: 0.8374
2024-08-12 12:52:55,232 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:55,232 : INFO : Training metrics:
2024-08-12 12:52:55,232 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:55,240 : INFO : Accuracy: 0.6175
2024-08-12 12:52:55,240 : INFO : Precision score for label_class 0: 0.3578
2024-08-12 12:52:55,240 : INFO : Precision score for label_class 1: 0.7064
2024-08-12 12:52:55,240 : INFO : Precision score for label_class 2: 0.4217
2024-08-12 12:52:55,240 : INFO : Recall score for label_class 0: 0.1189
2024-08-12 12:52:55,240 : INFO : Recall score for label_class 1: 0.8243
2024-08-12 12:52:55,240 : INFO : Recall score for label_class 2: 0.3939
2024-08-12 12:52:55,240 : INFO : Average F1 score: 0.4489
2024-08-12 12:52:55,520 : INFO : Average loss over validation batches: 0.6166
2024-08-12 12:52:55,520 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:55,520 : INFO : Validation metrics:
2024-08-12 12:52:55,520 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:55,522 : INFO : Accuracy: 0.7393
2024-08-12 12:52:55,522 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:52:55,522 : INFO : Precision score for label_class 1: 0.8676
2024-08-12 12:52:55,522 : INFO : Precision score for label_class 2: 0.5431
2024-08-12 12:52:55,522 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:52:55,522 : INFO : Recall score for label_class 1: 0.8850
2024-08-12 12:52:55,522 : INFO : Recall score for label_class 2: 0.7672
2024-08-12 12:52:55,522 : INFO : Average F1 score: 0.5041
2024-08-12 12:52:55,523 : INFO : Validation metric decreased (inf --> 0.616611).  Saving model ...
2024-08-12 12:52:55,631 : INFO : Starting epoch 2
2024-08-12 12:52:56,277 : INFO : Current training batch loss: 0.5166 in epoch 2
2024-08-12 12:52:57,085 : INFO : Current training batch loss: 0.4270 in epoch 2
2024-08-12 12:52:57,892 : INFO : Current training batch loss: 0.4703 in epoch 2
2024-08-12 12:52:58,700 : INFO : Current training batch loss: 0.4402 in epoch 2
2024-08-12 12:52:59,044 : INFO : Epoch finished, average loss over training batches: 0.4455
2024-08-12 12:52:59,044 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:59,044 : INFO : Training metrics:
2024-08-12 12:52:59,044 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:59,048 : INFO : Accuracy: 0.8425
2024-08-12 12:52:59,048 : INFO : Precision score for label_class 0: 0.7436
2024-08-12 12:52:59,048 : INFO : Precision score for label_class 1: 0.8877
2024-08-12 12:52:59,048 : INFO : Precision score for label_class 2: 0.7819
2024-08-12 12:52:59,048 : INFO : Recall score for label_class 0: 0.7073
2024-08-12 12:52:59,048 : INFO : Recall score for label_class 1: 0.9131
2024-08-12 12:52:59,048 : INFO : Recall score for label_class 2: 0.7510
2024-08-12 12:52:59,048 : INFO : Average F1 score: 0.7971
2024-08-12 12:52:59,328 : INFO : Average loss over validation batches: 0.3855
2024-08-12 12:52:59,328 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:59,328 : INFO : Validation metrics:
2024-08-12 12:52:59,328 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:52:59,331 : INFO : Accuracy: 0.8548
2024-08-12 12:52:59,331 : INFO : Precision score for label_class 0: 0.8493
2024-08-12 12:52:59,331 : INFO : Precision score for label_class 1: 0.8738
2024-08-12 12:52:59,331 : INFO : Precision score for label_class 2: 0.8103
2024-08-12 12:52:59,331 : INFO : Recall score for label_class 0: 0.7209
2024-08-12 12:52:59,331 : INFO : Recall score for label_class 1: 0.9350
2024-08-12 12:52:59,331 : INFO : Recall score for label_class 2: 0.7460
2024-08-12 12:52:59,331 : INFO : Average F1 score: 0.8200
2024-08-12 12:52:59,331 : INFO : Validation metric decreased (0.616611 --> 0.385472).  Saving model ...
2024-08-12 12:52:59,430 : INFO : Starting epoch 3
2024-08-12 12:52:59,875 : INFO : Current training batch loss: 0.1470 in epoch 3
2024-08-12 12:53:00,682 : INFO : Current training batch loss: 0.2839 in epoch 3
2024-08-12 12:53:01,490 : INFO : Current training batch loss: 0.3433 in epoch 3
2024-08-12 12:53:02,298 : INFO : Current training batch loss: 0.0869 in epoch 3
2024-08-12 12:53:02,844 : INFO : Epoch finished, average loss over training batches: 0.2484
2024-08-12 12:53:02,844 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:02,844 : INFO : Training metrics:
2024-08-12 12:53:02,844 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:02,848 : INFO : Accuracy: 0.9225
2024-08-12 12:53:02,848 : INFO : Precision score for label_class 0: 0.8444
2024-08-12 12:53:02,848 : INFO : Precision score for label_class 1: 0.9473
2024-08-12 12:53:02,848 : INFO : Precision score for label_class 2: 0.9051
2024-08-12 12:53:02,848 : INFO : Recall score for label_class 0: 0.8933
2024-08-12 12:53:02,848 : INFO : Recall score for label_class 1: 0.9485
2024-08-12 12:53:02,848 : INFO : Recall score for label_class 2: 0.8801
2024-08-12 12:53:02,848 : INFO : Average F1 score: 0.9028
2024-08-12 12:53:03,128 : INFO : Average loss over validation batches: 0.3982
2024-08-12 12:53:03,128 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:03,128 : INFO : Validation metrics:
2024-08-12 12:53:03,128 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:03,131 : INFO : Accuracy: 0.8711
2024-08-12 12:53:03,131 : INFO : Precision score for label_class 0: 0.7835
2024-08-12 12:53:03,131 : INFO : Precision score for label_class 1: 0.9192
2024-08-12 12:53:03,131 : INFO : Precision score for label_class 2: 0.8132
2024-08-12 12:53:03,131 : INFO : Recall score for label_class 0: 0.8837
2024-08-12 12:53:03,131 : INFO : Recall score for label_class 1: 0.9100
2024-08-12 12:53:03,131 : INFO : Recall score for label_class 2: 0.7831
2024-08-12 12:53:03,131 : INFO : Average F1 score: 0.8477
2024-08-12 12:53:03,131 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 12:53:03,131 : INFO : Starting epoch 4
2024-08-12 12:53:03,374 : INFO : Current training batch loss: 0.4558 in epoch 4
2024-08-12 12:53:04,183 : INFO : Current training batch loss: 0.2496 in epoch 4
2024-08-12 12:53:04,991 : INFO : Current training batch loss: 0.2525 in epoch 4
2024-08-12 12:53:05,799 : INFO : Current training batch loss: 0.0730 in epoch 4
2024-08-12 12:53:06,546 : INFO : Epoch finished, average loss over training batches: 0.1479
2024-08-12 12:53:06,547 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:06,547 : INFO : Training metrics:
2024-08-12 12:53:06,547 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:06,554 : INFO : Accuracy: 0.9600
2024-08-12 12:53:06,554 : INFO : Precision score for label_class 0: 0.8876
2024-08-12 12:53:06,554 : INFO : Precision score for label_class 1: 0.9777
2024-08-12 12:53:06,554 : INFO : Precision score for label_class 2: 0.9545
2024-08-12 12:53:06,554 : INFO : Recall score for label_class 0: 0.9146
2024-08-12 12:53:06,554 : INFO : Recall score for label_class 1: 0.9783
2024-08-12 12:53:06,554 : INFO : Recall score for label_class 2: 0.9407
2024-08-12 12:53:06,554 : INFO : Average F1 score: 0.9421
2024-08-12 12:53:06,834 : INFO : Average loss over validation batches: 0.4344
2024-08-12 12:53:06,834 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:06,835 : INFO : Validation metrics:
2024-08-12 12:53:06,835 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:06,837 : INFO : Accuracy: 0.8711
2024-08-12 12:53:06,837 : INFO : Precision score for label_class 0: 0.7917
2024-08-12 12:53:06,837 : INFO : Precision score for label_class 1: 0.9042
2024-08-12 12:53:06,837 : INFO : Precision score for label_class 2: 0.8372
2024-08-12 12:53:06,837 : INFO : Recall score for label_class 0: 0.8837
2024-08-12 12:53:06,837 : INFO : Recall score for label_class 1: 0.9200
2024-08-12 12:53:06,837 : INFO : Recall score for label_class 2: 0.7619
2024-08-12 12:53:06,837 : INFO : Average F1 score: 0.8483
2024-08-12 12:53:06,837 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 12:53:06,837 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:53:06,961 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 12:53:07,277 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:07,277 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 12:53:07,277 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:07,280 : INFO : Accuracy: 0.8548
2024-08-12 12:53:07,280 : INFO : Precision score for label_class 0: 0.8493
2024-08-12 12:53:07,280 : INFO : Precision score for label_class 1: 0.8738
2024-08-12 12:53:07,280 : INFO : Precision score for label_class 2: 0.8103
2024-08-12 12:53:07,280 : INFO : Recall score for label_class 0: 0.7209
2024-08-12 12:53:07,280 : INFO : Recall score for label_class 1: 0.9350
2024-08-12 12:53:07,280 : INFO : Recall score for label_class 2: 0.7460
2024-08-12 12:53:07,280 : INFO : Average F1 score: 0.8200
2024-08-12 12:53:07,280 : INFO : Determined score from best model, ending training.
2024-08-12 12:53:07,281 : INFO : Split 3 is finished, the score is: 0.8200
2024-08-12 12:53:07,281 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:07,281 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:07,281 : INFO : Starting training for split 4
2024-08-12 12:53:07,293 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 327, 1621,  751]))
2024-08-12 12:53:07,295 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 87, 390, 197]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:53:07,335 : INFO : Starting epoch 1
2024-08-12 12:53:07,377 : INFO : Current training batch loss: 1.0854 in epoch 1
2024-08-12 12:53:08,185 : INFO : Current training batch loss: 1.0131 in epoch 1
2024-08-12 12:53:08,993 : INFO : Current training batch loss: 0.7462 in epoch 1
2024-08-12 12:53:09,801 : INFO : Current training batch loss: 0.6139 in epoch 1
2024-08-12 12:53:10,609 : INFO : Current training batch loss: 0.5876 in epoch 1
2024-08-12 12:53:10,752 : INFO : Epoch finished, average loss over training batches: 0.8263
2024-08-12 12:53:10,752 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:10,752 : INFO : Training metrics:
2024-08-12 12:53:10,752 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:10,760 : INFO : Accuracy: 0.6617
2024-08-12 12:53:10,760 : INFO : Precision score for label_class 0: 0.0938
2024-08-12 12:53:10,760 : INFO : Precision score for label_class 1: 0.6925
2024-08-12 12:53:10,760 : INFO : Precision score for label_class 2: 0.5493
2024-08-12 12:53:10,760 : INFO : Recall score for label_class 0: 0.0092
2024-08-12 12:53:10,760 : INFO : Recall score for label_class 1: 0.9488
2024-08-12 12:53:10,760 : INFO : Recall score for label_class 2: 0.3262
2024-08-12 12:53:10,760 : INFO : Average F1 score: 0.4089
2024-08-12 12:53:11,040 : INFO : Average loss over validation batches: 0.5873
2024-08-12 12:53:11,040 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:11,040 : INFO : Validation metrics:
2024-08-12 12:53:11,040 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:11,044 : INFO : Accuracy: 0.7789
2024-08-12 12:53:11,044 : INFO : Precision score for label_class 0: 1.0000
2024-08-12 12:53:11,044 : INFO : Precision score for label_class 1: 0.8371
2024-08-12 12:53:11,044 : INFO : Precision score for label_class 2: 0.6452
2024-08-12 12:53:11,044 : INFO : Recall score for label_class 0: 0.1724
2024-08-12 12:53:11,044 : INFO : Recall score for label_class 1: 0.9487
2024-08-12 12:53:11,045 : INFO : Recall score for label_class 2: 0.7107
2024-08-12 12:53:11,045 : INFO : Average F1 score: 0.6200
2024-08-12 12:53:11,045 : INFO : Validation metric decreased (inf --> 0.587314).  Saving model ...
2024-08-12 12:53:11,142 : INFO : Starting epoch 2
2024-08-12 12:53:11,789 : INFO : Current training batch loss: 0.5531 in epoch 2
2024-08-12 12:53:12,596 : INFO : Current training batch loss: 0.3241 in epoch 2
2024-08-12 12:53:13,404 : INFO : Current training batch loss: 0.2839 in epoch 2
2024-08-12 12:53:14,212 : INFO : Current training batch loss: 0.4359 in epoch 2
2024-08-12 12:53:14,556 : INFO : Epoch finished, average loss over training batches: 0.4456
2024-08-12 12:53:14,556 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:14,556 : INFO : Training metrics:
2024-08-12 12:53:14,556 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:14,564 : INFO : Accuracy: 0.8481
2024-08-12 12:53:14,564 : INFO : Precision score for label_class 0: 0.7770
2024-08-12 12:53:14,564 : INFO : Precision score for label_class 1: 0.8853
2024-08-12 12:53:14,564 : INFO : Precision score for label_class 2: 0.7892
2024-08-12 12:53:14,564 : INFO : Recall score for label_class 0: 0.6820
2024-08-12 12:53:14,564 : INFO : Recall score for label_class 1: 0.9235
2024-08-12 12:53:14,564 : INFO : Recall score for label_class 2: 0.7577
2024-08-12 12:53:14,564 : INFO : Average F1 score: 0.8012
2024-08-12 12:53:14,843 : INFO : Average loss over validation batches: 0.4071
2024-08-12 12:53:14,844 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:14,844 : INFO : Validation metrics:
2024-08-12 12:53:14,844 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:14,847 : INFO : Accuracy: 0.8561
2024-08-12 12:53:14,847 : INFO : Precision score for label_class 0: 0.8571
2024-08-12 12:53:14,847 : INFO : Precision score for label_class 1: 0.8744
2024-08-12 12:53:14,847 : INFO : Precision score for label_class 2: 0.8158
2024-08-12 12:53:14,847 : INFO : Recall score for label_class 0: 0.6897
2024-08-12 12:53:14,847 : INFO : Recall score for label_class 1: 0.9282
2024-08-12 12:53:14,847 : INFO : Recall score for label_class 2: 0.7868
2024-08-12 12:53:14,847 : INFO : Average F1 score: 0.8220
2024-08-12 12:53:14,847 : INFO : Validation metric decreased (0.587314 --> 0.407126).  Saving model ...
2024-08-12 12:53:14,945 : INFO : Starting epoch 3
2024-08-12 12:53:15,390 : INFO : Current training batch loss: 0.2434 in epoch 3
2024-08-12 12:53:16,198 : INFO : Current training batch loss: 0.4008 in epoch 3
2024-08-12 12:53:17,006 : INFO : Current training batch loss: 0.0963 in epoch 3
2024-08-12 12:53:17,814 : INFO : Current training batch loss: 0.0928 in epoch 3
2024-08-12 12:53:18,360 : INFO : Epoch finished, average loss over training batches: 0.2570
2024-08-12 12:53:18,360 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:18,360 : INFO : Training metrics:
2024-08-12 12:53:18,360 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:18,367 : INFO : Accuracy: 0.9222
2024-08-12 12:53:18,367 : INFO : Precision score for label_class 0: 0.8559
2024-08-12 12:53:18,367 : INFO : Precision score for label_class 1: 0.9493
2024-08-12 12:53:18,368 : INFO : Precision score for label_class 2: 0.8934
2024-08-12 12:53:18,368 : INFO : Recall score for label_class 0: 0.8899
2024-08-12 12:53:18,368 : INFO : Recall score for label_class 1: 0.9476
2024-08-12 12:53:18,368 : INFO : Recall score for label_class 2: 0.8815
2024-08-12 12:53:18,368 : INFO : Average F1 score: 0.9028
2024-08-12 12:53:18,648 : INFO : Average loss over validation batches: 0.4134
2024-08-12 12:53:18,648 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:18,648 : INFO : Validation metrics:
2024-08-12 12:53:18,648 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:18,651 : INFO : Accuracy: 0.8665
2024-08-12 12:53:18,651 : INFO : Precision score for label_class 0: 0.8590
2024-08-12 12:53:18,651 : INFO : Precision score for label_class 1: 0.9096
2024-08-12 12:53:18,651 : INFO : Precision score for label_class 2: 0.7895
2024-08-12 12:53:18,651 : INFO : Recall score for label_class 0: 0.7701
2024-08-12 12:53:18,651 : INFO : Recall score for label_class 1: 0.9026
2024-08-12 12:53:18,651 : INFO : Recall score for label_class 2: 0.8376
2024-08-12 12:53:18,651 : INFO : Average F1 score: 0.8437
2024-08-12 12:53:18,651 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 12:53:18,652 : INFO : Starting epoch 4
2024-08-12 12:53:18,895 : INFO : Current training batch loss: 0.3809 in epoch 4
2024-08-12 12:53:19,703 : INFO : Current training batch loss: 0.1304 in epoch 4
2024-08-12 12:53:20,511 : INFO : Current training batch loss: 0.1963 in epoch 4
2024-08-12 12:53:21,320 : INFO : Current training batch loss: 0.1358 in epoch 4
2024-08-12 12:53:22,067 : INFO : Epoch finished, average loss over training batches: 0.1614
2024-08-12 12:53:22,067 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:22,067 : INFO : Training metrics:
2024-08-12 12:53:22,067 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:22,072 : INFO : Accuracy: 0.9515
2024-08-12 12:53:22,072 : INFO : Precision score for label_class 0: 0.8979
2024-08-12 12:53:22,072 : INFO : Precision score for label_class 1: 0.9687
2024-08-12 12:53:22,072 : INFO : Precision score for label_class 2: 0.9377
2024-08-12 12:53:22,073 : INFO : Recall score for label_class 0: 0.9144
2024-08-12 12:53:22,073 : INFO : Recall score for label_class 1: 0.9729
2024-08-12 12:53:22,073 : INFO : Recall score for label_class 2: 0.9214
2024-08-12 12:53:22,073 : INFO : Average F1 score: 0.9354
2024-08-12 12:53:22,352 : INFO : Average loss over validation batches: 0.5117
2024-08-12 12:53:22,352 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:22,352 : INFO : Validation metrics:
2024-08-12 12:53:22,352 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:22,356 : INFO : Accuracy: 0.8427
2024-08-12 12:53:22,356 : INFO : Precision score for label_class 0: 0.7500
2024-08-12 12:53:22,356 : INFO : Precision score for label_class 1: 0.9318
2024-08-12 12:53:22,356 : INFO : Precision score for label_class 2: 0.7434
2024-08-12 12:53:22,356 : INFO : Recall score for label_class 0: 0.8276
2024-08-12 12:53:22,356 : INFO : Recall score for label_class 1: 0.8410
2024-08-12 12:53:22,356 : INFO : Recall score for label_class 2: 0.8528
2024-08-12 12:53:22,356 : INFO : Average F1 score: 0.8218
2024-08-12 12:53:22,356 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 12:53:22,356 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:53:22,388 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 12:53:22,698 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:22,698 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 12:53:22,698 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:22,701 : INFO : Accuracy: 0.8561
2024-08-12 12:53:22,701 : INFO : Precision score for label_class 0: 0.8571
2024-08-12 12:53:22,701 : INFO : Precision score for label_class 1: 0.8744
2024-08-12 12:53:22,701 : INFO : Precision score for label_class 2: 0.8158
2024-08-12 12:53:22,701 : INFO : Recall score for label_class 0: 0.6897
2024-08-12 12:53:22,701 : INFO : Recall score for label_class 1: 0.9282
2024-08-12 12:53:22,701 : INFO : Recall score for label_class 2: 0.7868
2024-08-12 12:53:22,701 : INFO : Average F1 score: 0.8220
2024-08-12 12:53:22,701 : INFO : Determined score from best model, ending training.
2024-08-12 12:53:22,702 : INFO : Split 4 is finished, the score is: 0.8220
2024-08-12 12:53:22,703 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:22,703 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:22,703 : INFO : Starting training for split 5
2024-08-12 12:53:22,720 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 330, 1615,  754]))
2024-08-12 12:53:22,722 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 84, 396, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:53:22,772 : INFO : Starting epoch 1
2024-08-12 12:53:22,814 : INFO : Current training batch loss: 1.0750 in epoch 1
2024-08-12 12:53:23,622 : INFO : Current training batch loss: 1.0093 in epoch 1
2024-08-12 12:53:24,431 : INFO : Current training batch loss: 0.7596 in epoch 1
2024-08-12 12:53:25,239 : INFO : Current training batch loss: 0.6170 in epoch 1
2024-08-12 12:53:26,047 : INFO : Current training batch loss: 0.6019 in epoch 1
2024-08-12 12:53:26,190 : INFO : Epoch finished, average loss over training batches: 0.8048
2024-08-12 12:53:26,190 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:26,190 : INFO : Training metrics:
2024-08-12 12:53:26,190 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:26,201 : INFO : Accuracy: 0.6773
2024-08-12 12:53:26,201 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:53:26,201 : INFO : Precision score for label_class 1: 0.7053
2024-08-12 12:53:26,201 : INFO : Precision score for label_class 2: 0.5584
2024-08-12 12:53:26,201 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:53:26,201 : INFO : Recall score for label_class 1: 0.9542
2024-08-12 12:53:26,201 : INFO : Recall score for label_class 2: 0.3806
2024-08-12 12:53:26,201 : INFO : Average F1 score: 0.4212
2024-08-12 12:53:26,482 : INFO : Average loss over validation batches: 0.5668
2024-08-12 12:53:26,482 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:26,482 : INFO : Validation metrics:
2024-08-12 12:53:26,482 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:26,486 : INFO : Accuracy: 0.7478
2024-08-12 12:53:26,486 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:53:26,486 : INFO : Precision score for label_class 1: 0.8304
2024-08-12 12:53:26,486 : INFO : Precision score for label_class 2: 0.5841
2024-08-12 12:53:26,486 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:53:26,486 : INFO : Recall score for label_class 1: 0.9394
2024-08-12 12:53:26,486 : INFO : Recall score for label_class 2: 0.6804
2024-08-12 12:53:26,486 : INFO : Average F1 score: 0.5034
2024-08-12 12:53:26,486 : INFO : Validation metric decreased (inf --> 0.566818).  Saving model ...
2024-08-12 12:53:26,593 : INFO : Starting epoch 2
2024-08-12 12:53:27,240 : INFO : Current training batch loss: 0.6042 in epoch 2
2024-08-12 12:53:28,048 : INFO : Current training batch loss: 0.4084 in epoch 2
2024-08-12 12:53:28,856 : INFO : Current training batch loss: 0.2419 in epoch 2
2024-08-12 12:53:29,665 : INFO : Current training batch loss: 0.4422 in epoch 2
2024-08-12 12:53:30,009 : INFO : Epoch finished, average loss over training batches: 0.4354
2024-08-12 12:53:30,009 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:30,009 : INFO : Training metrics:
2024-08-12 12:53:30,009 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:30,020 : INFO : Accuracy: 0.8462
2024-08-12 12:53:30,020 : INFO : Precision score for label_class 0: 0.7687
2024-08-12 12:53:30,020 : INFO : Precision score for label_class 1: 0.8895
2024-08-12 12:53:30,020 : INFO : Precision score for label_class 2: 0.7767
2024-08-12 12:53:30,020 : INFO : Recall score for label_class 0: 0.6848
2024-08-12 12:53:30,020 : INFO : Recall score for label_class 1: 0.9276
2024-08-12 12:53:30,020 : INFO : Recall score for label_class 2: 0.7427
2024-08-12 12:53:30,020 : INFO : Average F1 score: 0.7973
2024-08-12 12:53:30,300 : INFO : Average loss over validation batches: 0.4981
2024-08-12 12:53:30,300 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:30,300 : INFO : Validation metrics:
2024-08-12 12:53:30,300 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:30,304 : INFO : Accuracy: 0.8234
2024-08-12 12:53:30,304 : INFO : Precision score for label_class 0: 0.7903
2024-08-12 12:53:30,304 : INFO : Precision score for label_class 1: 0.8360
2024-08-12 12:53:30,304 : INFO : Precision score for label_class 2: 0.8024
2024-08-12 12:53:30,304 : INFO : Recall score for label_class 0: 0.5833
2024-08-12 12:53:30,304 : INFO : Recall score for label_class 1: 0.9394
2024-08-12 12:53:30,304 : INFO : Recall score for label_class 2: 0.6907
2024-08-12 12:53:30,304 : INFO : Average F1 score: 0.7661
2024-08-12 12:53:30,304 : INFO : Validation metric decreased (0.566818 --> 0.498105).  Saving model ...
2024-08-12 12:53:30,405 : INFO : Starting epoch 3
2024-08-12 12:53:30,850 : INFO : Current training batch loss: 0.2602 in epoch 3
2024-08-12 12:53:31,659 : INFO : Current training batch loss: 0.3118 in epoch 3
2024-08-12 12:53:32,467 : INFO : Current training batch loss: 0.0882 in epoch 3
2024-08-12 12:53:33,275 : INFO : Current training batch loss: 0.2450 in epoch 3
2024-08-12 12:53:33,821 : INFO : Epoch finished, average loss over training batches: 0.2400
2024-08-12 12:53:33,821 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:33,821 : INFO : Training metrics:
2024-08-12 12:53:33,821 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:33,828 : INFO : Accuracy: 0.9252
2024-08-12 12:53:33,828 : INFO : Precision score for label_class 0: 0.8526
2024-08-12 12:53:33,828 : INFO : Precision score for label_class 1: 0.9506
2024-08-12 12:53:33,829 : INFO : Precision score for label_class 2: 0.9031
2024-08-12 12:53:33,829 : INFO : Recall score for label_class 0: 0.8939
2024-08-12 12:53:33,829 : INFO : Recall score for label_class 1: 0.9536
2024-08-12 12:53:33,829 : INFO : Recall score for label_class 2: 0.8780
2024-08-12 12:53:33,829 : INFO : Average F1 score: 0.9051
2024-08-12 12:53:34,109 : INFO : Average loss over validation batches: 0.5218
2024-08-12 12:53:34,109 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:34,109 : INFO : Validation metrics:
2024-08-12 12:53:34,109 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:34,112 : INFO : Accuracy: 0.8427
2024-08-12 12:53:34,112 : INFO : Precision score for label_class 0: 0.8182
2024-08-12 12:53:34,112 : INFO : Precision score for label_class 1: 0.8614
2024-08-12 12:53:34,112 : INFO : Precision score for label_class 2: 0.8057
2024-08-12 12:53:34,112 : INFO : Recall score for label_class 0: 0.6429
2024-08-12 12:53:34,112 : INFO : Recall score for label_class 1: 0.9419
2024-08-12 12:53:34,112 : INFO : Recall score for label_class 2: 0.7268
2024-08-12 12:53:34,112 : INFO : Average F1 score: 0.7947
2024-08-12 12:53:34,112 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 12:53:34,112 : INFO : Starting epoch 4
2024-08-12 12:53:34,356 : INFO : Current training batch loss: 0.2967 in epoch 4
2024-08-12 12:53:35,163 : INFO : Current training batch loss: 0.2315 in epoch 4
2024-08-12 12:53:35,972 : INFO : Current training batch loss: 0.1193 in epoch 4
2024-08-12 12:53:36,781 : INFO : Current training batch loss: 0.0323 in epoch 4
2024-08-12 12:53:37,528 : INFO : Epoch finished, average loss over training batches: 0.1473
2024-08-12 12:53:37,528 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:37,528 : INFO : Training metrics:
2024-08-12 12:53:37,528 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:37,539 : INFO : Accuracy: 0.9589
2024-08-12 12:53:37,539 : INFO : Precision score for label_class 0: 0.9129
2024-08-12 12:53:37,539 : INFO : Precision score for label_class 1: 0.9711
2024-08-12 12:53:37,539 : INFO : Precision score for label_class 2: 0.9526
2024-08-12 12:53:37,539 : INFO : Recall score for label_class 0: 0.9212
2024-08-12 12:53:37,539 : INFO : Recall score for label_class 1: 0.9783
2024-08-12 12:53:37,539 : INFO : Recall score for label_class 2: 0.9337
2024-08-12 12:53:37,539 : INFO : Average F1 score: 0.9449
2024-08-12 12:53:37,819 : INFO : Average loss over validation batches: 0.5499
2024-08-12 12:53:37,819 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:37,819 : INFO : Validation metrics:
2024-08-12 12:53:37,819 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:37,822 : INFO : Accuracy: 0.8398
2024-08-12 12:53:37,822 : INFO : Precision score for label_class 0: 0.7204
2024-08-12 12:53:37,822 : INFO : Precision score for label_class 1: 0.9060
2024-08-12 12:53:37,822 : INFO : Precision score for label_class 2: 0.7677
2024-08-12 12:53:37,822 : INFO : Recall score for label_class 0: 0.7976
2024-08-12 12:53:37,822 : INFO : Recall score for label_class 1: 0.8763
2024-08-12 12:53:37,822 : INFO : Recall score for label_class 2: 0.7835
2024-08-12 12:53:37,822 : INFO : Average F1 score: 0.8078
2024-08-12 12:53:37,822 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 12:53:37,822 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:53:37,859 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 12:53:38,173 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:38,173 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 12:53:38,173 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:38,177 : INFO : Accuracy: 0.8234
2024-08-12 12:53:38,177 : INFO : Precision score for label_class 0: 0.7903
2024-08-12 12:53:38,177 : INFO : Precision score for label_class 1: 0.8360
2024-08-12 12:53:38,177 : INFO : Precision score for label_class 2: 0.8024
2024-08-12 12:53:38,177 : INFO : Recall score for label_class 0: 0.5833
2024-08-12 12:53:38,177 : INFO : Recall score for label_class 1: 0.9394
2024-08-12 12:53:38,177 : INFO : Recall score for label_class 2: 0.6907
2024-08-12 12:53:38,177 : INFO : Average F1 score: 0.7661
2024-08-12 12:53:38,177 : INFO : Determined score from best model, ending training.
2024-08-12 12:53:38,184 : INFO : Split 5 is finished, the score is: 0.7661
2024-08-12 12:53:38,184 : INFO : ----------------------------------------------------------------------------------------------------
[I 2024-08-12 12:53:38,185] Trial 3 finished with value: 0.815605592480104 and parameters: {'n_epochs': 8, 'learning_rate': 9.224432567656072e-05, 'classifier_dropout': 0.20141810451176256, 'warmup_step_fraction': 0.07391860003035589, 'use_gradient_clipping': True}. Best is trial 1 with value: 0.833042786775897.
2024-08-12 12:53:38,185 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:38,185 : INFO : Starting training for split 1
2024-08-12 12:53:38,196 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 328, 1596,  774]))
2024-08-12 12:53:38,198 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 86, 415, 174]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:53:38,249 : INFO : Starting epoch 1
2024-08-12 12:53:38,291 : INFO : Current training batch loss: 1.1027 in epoch 1
2024-08-12 12:53:39,099 : INFO : Current training batch loss: 0.9881 in epoch 1
2024-08-12 12:53:39,907 : INFO : Current training batch loss: 0.9866 in epoch 1
2024-08-12 12:53:40,715 : INFO : Current training batch loss: 0.7365 in epoch 1
2024-08-12 12:53:41,524 : INFO : Current training batch loss: 0.7245 in epoch 1
2024-08-12 12:53:41,666 : INFO : Epoch finished, average loss over training batches: 0.8849
2024-08-12 12:53:41,666 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:41,666 : INFO : Training metrics:
2024-08-12 12:53:41,666 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:41,674 : INFO : Accuracy: 0.6197
2024-08-12 12:53:41,674 : INFO : Precision score for label_class 0: 0.2143
2024-08-12 12:53:41,675 : INFO : Precision score for label_class 1: 0.6741
2024-08-12 12:53:41,675 : INFO : Precision score for label_class 2: 0.4553
2024-08-12 12:53:41,675 : INFO : Recall score for label_class 0: 0.0274
2024-08-12 12:53:41,675 : INFO : Recall score for label_class 1: 0.8759
2024-08-12 12:53:41,675 : INFO : Recall score for label_class 2: 0.3424
2024-08-12 12:53:41,675 : INFO : Average F1 score: 0.4005
2024-08-12 12:53:41,954 : INFO : Average loss over validation batches: 0.6721
2024-08-12 12:53:41,954 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:41,954 : INFO : Validation metrics:
2024-08-12 12:53:41,954 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:41,957 : INFO : Accuracy: 0.7274
2024-08-12 12:53:41,957 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:53:41,957 : INFO : Precision score for label_class 1: 0.8506
2024-08-12 12:53:41,957 : INFO : Precision score for label_class 2: 0.5042
2024-08-12 12:53:41,957 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:53:41,957 : INFO : Recall score for label_class 1: 0.8916
2024-08-12 12:53:41,957 : INFO : Recall score for label_class 2: 0.6954
2024-08-12 12:53:41,957 : INFO : Average F1 score: 0.4850
2024-08-12 12:53:41,957 : INFO : Validation metric decreased (inf --> 0.672077).  Saving model ...
2024-08-12 12:53:42,066 : INFO : Starting epoch 2
2024-08-12 12:53:42,712 : INFO : Current training batch loss: 0.4027 in epoch 2
2024-08-12 12:53:43,520 : INFO : Current training batch loss: 0.5912 in epoch 2
2024-08-12 12:53:44,328 : INFO : Current training batch loss: 0.3715 in epoch 2
2024-08-12 12:53:45,136 : INFO : Current training batch loss: 0.4058 in epoch 2
2024-08-12 12:53:45,480 : INFO : Epoch finished, average loss over training batches: 0.5037
2024-08-12 12:53:45,480 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:45,480 : INFO : Training metrics:
2024-08-12 12:53:45,480 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:45,485 : INFO : Accuracy: 0.8258
2024-08-12 12:53:45,485 : INFO : Precision score for label_class 0: 0.7500
2024-08-12 12:53:45,485 : INFO : Precision score for label_class 1: 0.8715
2024-08-12 12:53:45,485 : INFO : Precision score for label_class 2: 0.7468
2024-08-12 12:53:45,485 : INFO : Recall score for label_class 0: 0.5122
2024-08-12 12:53:45,485 : INFO : Recall score for label_class 1: 0.9305
2024-08-12 12:53:45,485 : INFO : Recall score for label_class 2: 0.7429
2024-08-12 12:53:45,485 : INFO : Average F1 score: 0.7512
2024-08-12 12:53:45,764 : INFO : Average loss over validation batches: 0.4080
2024-08-12 12:53:45,765 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:45,765 : INFO : Validation metrics:
2024-08-12 12:53:45,765 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:45,768 : INFO : Accuracy: 0.8652
2024-08-12 12:53:45,768 : INFO : Precision score for label_class 0: 0.7872
2024-08-12 12:53:45,768 : INFO : Precision score for label_class 1: 0.9223
2024-08-12 12:53:45,768 : INFO : Precision score for label_class 2: 0.7802
2024-08-12 12:53:45,768 : INFO : Recall score for label_class 0: 0.8605
2024-08-12 12:53:45,768 : INFO : Recall score for label_class 1: 0.8867
2024-08-12 12:53:45,768 : INFO : Recall score for label_class 2: 0.8161
2024-08-12 12:53:45,768 : INFO : Average F1 score: 0.8414
2024-08-12 12:53:45,768 : INFO : Validation metric decreased (0.672077 --> 0.408027).  Saving model ...
2024-08-12 12:53:45,868 : INFO : Starting epoch 3
2024-08-12 12:53:46,314 : INFO : Current training batch loss: 0.3359 in epoch 3
2024-08-12 12:53:47,122 : INFO : Current training batch loss: 0.3509 in epoch 3
2024-08-12 12:53:47,930 : INFO : Current training batch loss: 0.2968 in epoch 3
2024-08-12 12:53:48,738 : INFO : Current training batch loss: 0.2552 in epoch 3
2024-08-12 12:53:49,284 : INFO : Epoch finished, average loss over training batches: 0.3004
2024-08-12 12:53:49,284 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:49,284 : INFO : Training metrics:
2024-08-12 12:53:49,284 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:49,289 : INFO : Accuracy: 0.9125
2024-08-12 12:53:49,289 : INFO : Precision score for label_class 0: 0.8227
2024-08-12 12:53:49,289 : INFO : Precision score for label_class 1: 0.9380
2024-08-12 12:53:49,289 : INFO : Precision score for label_class 2: 0.8986
2024-08-12 12:53:49,290 : INFO : Recall score for label_class 0: 0.8628
2024-08-12 12:53:49,290 : INFO : Recall score for label_class 1: 0.9486
2024-08-12 12:53:49,290 : INFO : Recall score for label_class 2: 0.8592
2024-08-12 12:53:49,290 : INFO : Average F1 score: 0.8880
2024-08-12 12:53:49,569 : INFO : Average loss over validation batches: 0.3612
2024-08-12 12:53:49,569 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:49,569 : INFO : Validation metrics:
2024-08-12 12:53:49,569 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:49,572 : INFO : Accuracy: 0.8696
2024-08-12 12:53:49,573 : INFO : Precision score for label_class 0: 0.7755
2024-08-12 12:53:49,573 : INFO : Precision score for label_class 1: 0.9356
2024-08-12 12:53:49,573 : INFO : Precision score for label_class 2: 0.7831
2024-08-12 12:53:49,573 : INFO : Recall score for label_class 0: 0.8837
2024-08-12 12:53:49,573 : INFO : Recall score for label_class 1: 0.8747
2024-08-12 12:53:49,573 : INFO : Recall score for label_class 2: 0.8506
2024-08-12 12:53:49,573 : INFO : Average F1 score: 0.8485
2024-08-12 12:53:49,573 : INFO : Validation metric decreased (0.408027 --> 0.361245).  Saving model ...
2024-08-12 12:53:49,674 : INFO : Starting epoch 4
2024-08-12 12:53:49,916 : INFO : Current training batch loss: 0.6041 in epoch 4
2024-08-12 12:53:50,719 : INFO : Current training batch loss: 0.2322 in epoch 4
2024-08-12 12:53:51,522 : INFO : Current training batch loss: 0.2848 in epoch 4
2024-08-12 12:53:52,326 : INFO : Current training batch loss: 0.1635 in epoch 4
2024-08-12 12:53:53,062 : INFO : Epoch finished, average loss over training batches: 0.2011
2024-08-12 12:53:53,063 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:53,063 : INFO : Training metrics:
2024-08-12 12:53:53,063 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:53,069 : INFO : Accuracy: 0.9466
2024-08-12 12:53:53,069 : INFO : Precision score for label_class 0: 0.8853
2024-08-12 12:53:53,069 : INFO : Precision score for label_class 1: 0.9587
2024-08-12 12:53:53,069 : INFO : Precision score for label_class 2: 0.9484
2024-08-12 12:53:53,069 : INFO : Recall score for label_class 0: 0.9177
2024-08-12 12:53:53,069 : INFO : Recall score for label_class 1: 0.9737
2024-08-12 12:53:53,069 : INFO : Recall score for label_class 2: 0.9031
2024-08-12 12:53:53,069 : INFO : Average F1 score: 0.9308
2024-08-12 12:53:53,349 : INFO : Average loss over validation batches: 0.4071
2024-08-12 12:53:53,349 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:53,349 : INFO : Validation metrics:
2024-08-12 12:53:53,349 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:53,352 : INFO : Accuracy: 0.8563
2024-08-12 12:53:53,352 : INFO : Precision score for label_class 0: 0.6807
2024-08-12 12:53:53,352 : INFO : Precision score for label_class 1: 0.9510
2024-08-12 12:53:53,352 : INFO : Precision score for label_class 2: 0.7831
2024-08-12 12:53:53,352 : INFO : Recall score for label_class 0: 0.9419
2024-08-12 12:53:53,352 : INFO : Recall score for label_class 1: 0.8410
2024-08-12 12:53:53,352 : INFO : Recall score for label_class 2: 0.8506
2024-08-12 12:53:53,352 : INFO : Average F1 score: 0.8328
2024-08-12 12:53:53,352 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 12:53:53,352 : INFO : Starting epoch 5
2024-08-12 12:53:53,393 : INFO : Current training batch loss: 0.0948 in epoch 5
2024-08-12 12:53:54,196 : INFO : Current training batch loss: 0.2695 in epoch 5
2024-08-12 12:53:54,999 : INFO : Current training batch loss: 0.0617 in epoch 5
2024-08-12 12:53:55,803 : INFO : Current training batch loss: 0.1818 in epoch 5
2024-08-12 12:53:56,607 : INFO : Current training batch loss: 0.2807 in epoch 5
2024-08-12 12:53:56,742 : INFO : Epoch finished, average loss over training batches: 0.1372
2024-08-12 12:53:56,742 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:56,742 : INFO : Training metrics:
2024-08-12 12:53:56,742 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:56,751 : INFO : Accuracy: 0.9666
2024-08-12 12:53:56,752 : INFO : Precision score for label_class 0: 0.9099
2024-08-12 12:53:56,752 : INFO : Precision score for label_class 1: 0.9781
2024-08-12 12:53:56,752 : INFO : Precision score for label_class 2: 0.9682
2024-08-12 12:53:56,752 : INFO : Recall score for label_class 0: 0.9543
2024-08-12 12:53:56,752 : INFO : Recall score for label_class 1: 0.9799
2024-08-12 12:53:56,752 : INFO : Recall score for label_class 2: 0.9444
2024-08-12 12:53:56,752 : INFO : Average F1 score: 0.9556
2024-08-12 12:53:57,031 : INFO : Average loss over validation batches: 0.4133
2024-08-12 12:53:57,031 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:57,031 : INFO : Validation metrics:
2024-08-12 12:53:57,032 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:57,035 : INFO : Accuracy: 0.8667
2024-08-12 12:53:57,035 : INFO : Precision score for label_class 0: 0.7573
2024-08-12 12:53:57,035 : INFO : Precision score for label_class 1: 0.8897
2024-08-12 12:53:57,035 : INFO : Precision score for label_class 2: 0.8759
2024-08-12 12:53:57,035 : INFO : Recall score for label_class 0: 0.9070
2024-08-12 12:53:57,035 : INFO : Recall score for label_class 1: 0.9325
2024-08-12 12:53:57,035 : INFO : Recall score for label_class 2: 0.6897
2024-08-12 12:53:57,035 : INFO : Average F1 score: 0.8359
2024-08-12 12:53:57,035 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 12:53:57,035 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:53:57,075 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 12:53:57,388 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:57,389 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 12:53:57,389 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:57,392 : INFO : Accuracy: 0.8696
2024-08-12 12:53:57,392 : INFO : Precision score for label_class 0: 0.7755
2024-08-12 12:53:57,392 : INFO : Precision score for label_class 1: 0.9356
2024-08-12 12:53:57,392 : INFO : Precision score for label_class 2: 0.7831
2024-08-12 12:53:57,392 : INFO : Recall score for label_class 0: 0.8837
2024-08-12 12:53:57,392 : INFO : Recall score for label_class 1: 0.8747
2024-08-12 12:53:57,392 : INFO : Recall score for label_class 2: 0.8506
2024-08-12 12:53:57,392 : INFO : Average F1 score: 0.8485
2024-08-12 12:53:57,392 : INFO : Determined score from best model, ending training.
2024-08-12 12:53:57,393 : INFO : Split 1 is finished, the score is: 0.8485
2024-08-12 12:53:57,394 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:57,394 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:53:57,394 : INFO : Starting training for split 2
2024-08-12 12:53:57,405 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 343, 1601,  754]))
2024-08-12 12:53:57,407 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 71, 410, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:53:57,449 : INFO : Starting epoch 1
2024-08-12 12:53:57,490 : INFO : Current training batch loss: 1.1138 in epoch 1
2024-08-12 12:53:58,298 : INFO : Current training batch loss: 1.0384 in epoch 1
2024-08-12 12:53:59,102 : INFO : Current training batch loss: 0.9268 in epoch 1
2024-08-12 12:53:59,905 : INFO : Current training batch loss: 0.6671 in epoch 1
2024-08-12 12:54:00,709 : INFO : Current training batch loss: 0.7035 in epoch 1
2024-08-12 12:54:00,843 : INFO : Epoch finished, average loss over training batches: 0.8656
2024-08-12 12:54:00,844 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:00,844 : INFO : Training metrics:
2024-08-12 12:54:00,844 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:00,855 : INFO : Accuracy: 0.6086
2024-08-12 12:54:00,855 : INFO : Precision score for label_class 0: 0.1235
2024-08-12 12:54:00,855 : INFO : Precision score for label_class 1: 0.6868
2024-08-12 12:54:00,855 : INFO : Precision score for label_class 2: 0.5358
2024-08-12 12:54:00,855 : INFO : Recall score for label_class 0: 0.0904
2024-08-12 12:54:00,855 : INFO : Recall score for label_class 1: 0.8520
2024-08-12 12:54:00,855 : INFO : Recall score for label_class 2: 0.3276
2024-08-12 12:54:00,855 : INFO : Average F1 score: 0.4238
2024-08-12 12:54:01,135 : INFO : Average loss over validation batches: 0.6083
2024-08-12 12:54:01,135 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:01,135 : INFO : Validation metrics:
2024-08-12 12:54:01,135 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:01,139 : INFO : Accuracy: 0.7674
2024-08-12 12:54:01,139 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:54:01,139 : INFO : Precision score for label_class 1: 0.8230
2024-08-12 12:54:01,139 : INFO : Precision score for label_class 2: 0.6408
2024-08-12 12:54:01,139 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:54:01,139 : INFO : Recall score for label_class 1: 0.9415
2024-08-12 12:54:01,139 : INFO : Recall score for label_class 2: 0.6804
2024-08-12 12:54:01,139 : INFO : Average F1 score: 0.5128
2024-08-12 12:54:01,139 : INFO : Validation metric decreased (inf --> 0.608265).  Saving model ...
2024-08-12 12:54:01,246 : INFO : Starting epoch 2
2024-08-12 12:54:01,889 : INFO : Current training batch loss: 0.6019 in epoch 2
2024-08-12 12:54:02,692 : INFO : Current training batch loss: 0.5364 in epoch 2
2024-08-12 12:54:03,494 : INFO : Current training batch loss: 0.3874 in epoch 2
2024-08-12 12:54:04,297 : INFO : Current training batch loss: 0.3987 in epoch 2
2024-08-12 12:54:04,632 : INFO : Epoch finished, average loss over training batches: 0.4851
2024-08-12 12:54:04,632 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:04,632 : INFO : Training metrics:
2024-08-12 12:54:04,632 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:04,641 : INFO : Accuracy: 0.8410
2024-08-12 12:54:04,641 : INFO : Precision score for label_class 0: 0.7442
2024-08-12 12:54:04,641 : INFO : Precision score for label_class 1: 0.8878
2024-08-12 12:54:04,641 : INFO : Precision score for label_class 2: 0.7698
2024-08-12 12:54:04,641 : INFO : Recall score for label_class 0: 0.5598
2024-08-12 12:54:04,641 : INFO : Recall score for label_class 1: 0.9338
2024-08-12 12:54:04,641 : INFO : Recall score for label_class 2: 0.7719
2024-08-12 12:54:04,641 : INFO : Average F1 score: 0.7733
2024-08-12 12:54:04,921 : INFO : Average loss over validation batches: 0.4152
2024-08-12 12:54:04,921 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:04,921 : INFO : Validation metrics:
2024-08-12 12:54:04,921 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:04,925 : INFO : Accuracy: 0.8578
2024-08-12 12:54:04,925 : INFO : Precision score for label_class 0: 0.7568
2024-08-12 12:54:04,925 : INFO : Precision score for label_class 1: 0.8785
2024-08-12 12:54:04,925 : INFO : Precision score for label_class 2: 0.8497
2024-08-12 12:54:04,925 : INFO : Recall score for label_class 0: 0.7887
2024-08-12 12:54:04,925 : INFO : Recall score for label_class 1: 0.9171
2024-08-12 12:54:04,925 : INFO : Recall score for label_class 2: 0.7577
2024-08-12 12:54:04,925 : INFO : Average F1 score: 0.8236
2024-08-12 12:54:04,925 : INFO : Validation metric decreased (0.608265 --> 0.415224).  Saving model ...
2024-08-12 12:54:05,027 : INFO : Starting epoch 3
2024-08-12 12:54:05,469 : INFO : Current training batch loss: 0.3176 in epoch 3
2024-08-12 12:54:06,272 : INFO : Current training batch loss: 0.3423 in epoch 3
2024-08-12 12:54:07,075 : INFO : Current training batch loss: 0.3351 in epoch 3
2024-08-12 12:54:07,879 : INFO : Current training batch loss: 0.1036 in epoch 3
2024-08-12 12:54:08,414 : INFO : Epoch finished, average loss over training batches: 0.2871
2024-08-12 12:54:08,415 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:08,415 : INFO : Training metrics:
2024-08-12 12:54:08,415 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:08,426 : INFO : Accuracy: 0.9188
2024-08-12 12:54:08,427 : INFO : Precision score for label_class 0: 0.8338
2024-08-12 12:54:08,427 : INFO : Precision score for label_class 1: 0.9473
2024-08-12 12:54:08,427 : INFO : Precision score for label_class 2: 0.8971
2024-08-12 12:54:08,427 : INFO : Recall score for label_class 0: 0.8630
2024-08-12 12:54:08,427 : INFO : Recall score for label_class 1: 0.9550
2024-08-12 12:54:08,427 : INFO : Recall score for label_class 2: 0.8674
2024-08-12 12:54:08,427 : INFO : Average F1 score: 0.8938
2024-08-12 12:54:08,706 : INFO : Average loss over validation batches: 0.3729
2024-08-12 12:54:08,706 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:08,706 : INFO : Validation metrics:
2024-08-12 12:54:08,706 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:08,710 : INFO : Accuracy: 0.8563
2024-08-12 12:54:08,710 : INFO : Precision score for label_class 0: 0.7229
2024-08-12 12:54:08,710 : INFO : Precision score for label_class 1: 0.8966
2024-08-12 12:54:08,710 : INFO : Precision score for label_class 2: 0.8280
2024-08-12 12:54:08,710 : INFO : Recall score for label_class 0: 0.8451
2024-08-12 12:54:08,710 : INFO : Recall score for label_class 1: 0.8878
2024-08-12 12:54:08,710 : INFO : Recall score for label_class 2: 0.7938
2024-08-12 12:54:08,710 : INFO : Average F1 score: 0.8273
2024-08-12 12:54:08,710 : INFO : Validation metric decreased (0.415224 --> 0.372862).  Saving model ...
2024-08-12 12:54:08,812 : INFO : Starting epoch 4
2024-08-12 12:54:09,054 : INFO : Current training batch loss: 0.3027 in epoch 4
2024-08-12 12:54:09,857 : INFO : Current training batch loss: 0.2396 in epoch 4
2024-08-12 12:54:10,660 : INFO : Current training batch loss: 0.2814 in epoch 4
2024-08-12 12:54:11,464 : INFO : Current training batch loss: 0.1573 in epoch 4
2024-08-12 12:54:12,199 : INFO : Epoch finished, average loss over training batches: 0.1813
2024-08-12 12:54:12,200 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:12,200 : INFO : Training metrics:
2024-08-12 12:54:12,200 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:12,211 : INFO : Accuracy: 0.9537
2024-08-12 12:54:12,211 : INFO : Precision score for label_class 0: 0.8936
2024-08-12 12:54:12,211 : INFO : Precision score for label_class 1: 0.9708
2024-08-12 12:54:12,211 : INFO : Precision score for label_class 2: 0.9455
2024-08-12 12:54:12,211 : INFO : Recall score for label_class 0: 0.9300
2024-08-12 12:54:12,211 : INFO : Recall score for label_class 1: 0.9744
2024-08-12 12:54:12,211 : INFO : Recall score for label_class 2: 0.9204
2024-08-12 12:54:12,211 : INFO : Average F1 score: 0.9389
2024-08-12 12:54:12,491 : INFO : Average loss over validation batches: 0.4373
2024-08-12 12:54:12,491 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:12,491 : INFO : Validation metrics:
2024-08-12 12:54:12,491 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:12,495 : INFO : Accuracy: 0.8504
2024-08-12 12:54:12,495 : INFO : Precision score for label_class 0: 0.7500
2024-08-12 12:54:12,495 : INFO : Precision score for label_class 1: 0.9276
2024-08-12 12:54:12,495 : INFO : Precision score for label_class 2: 0.7568
2024-08-12 12:54:12,495 : INFO : Recall score for label_class 0: 0.8451
2024-08-12 12:54:12,495 : INFO : Recall score for label_class 1: 0.8439
2024-08-12 12:54:12,495 : INFO : Recall score for label_class 2: 0.8660
2024-08-12 12:54:12,495 : INFO : Average F1 score: 0.8287
2024-08-12 12:54:12,495 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 12:54:12,495 : INFO : Starting epoch 5
2024-08-12 12:54:12,536 : INFO : Current training batch loss: 0.0554 in epoch 5
2024-08-12 12:54:13,339 : INFO : Current training batch loss: 0.3922 in epoch 5
2024-08-12 12:54:14,143 : INFO : Current training batch loss: 0.1161 in epoch 5
2024-08-12 12:54:14,947 : INFO : Current training batch loss: 0.1529 in epoch 5
2024-08-12 12:54:15,750 : INFO : Current training batch loss: 0.1968 in epoch 5
2024-08-12 12:54:15,885 : INFO : Epoch finished, average loss over training batches: 0.1419
2024-08-12 12:54:15,885 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:15,885 : INFO : Training metrics:
2024-08-12 12:54:15,885 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:15,894 : INFO : Accuracy: 0.9648
2024-08-12 12:54:15,894 : INFO : Precision score for label_class 0: 0.9025
2024-08-12 12:54:15,894 : INFO : Precision score for label_class 1: 0.9788
2024-08-12 12:54:15,894 : INFO : Precision score for label_class 2: 0.9646
2024-08-12 12:54:15,894 : INFO : Recall score for label_class 0: 0.9446
2024-08-12 12:54:15,894 : INFO : Recall score for label_class 1: 0.9813
2024-08-12 12:54:15,894 : INFO : Recall score for label_class 2: 0.9390
2024-08-12 12:54:15,894 : INFO : Average F1 score: 0.9516
2024-08-12 12:54:16,174 : INFO : Average loss over validation batches: 0.4710
2024-08-12 12:54:16,174 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:16,174 : INFO : Validation metrics:
2024-08-12 12:54:16,174 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:16,178 : INFO : Accuracy: 0.8637
2024-08-12 12:54:16,178 : INFO : Precision score for label_class 0: 0.7536
2024-08-12 12:54:16,178 : INFO : Precision score for label_class 1: 0.8615
2024-08-12 12:54:16,178 : INFO : Precision score for label_class 2: 0.9205
2024-08-12 12:54:16,178 : INFO : Recall score for label_class 0: 0.7324
2024-08-12 12:54:16,178 : INFO : Recall score for label_class 1: 0.9561
2024-08-12 12:54:16,178 : INFO : Recall score for label_class 2: 0.7165
2024-08-12 12:54:16,178 : INFO : Average F1 score: 0.8183
2024-08-12 12:54:16,178 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 12:54:16,178 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:54:16,218 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 12:54:16,531 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:16,531 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 12:54:16,531 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:16,535 : INFO : Accuracy: 0.8563
2024-08-12 12:54:16,535 : INFO : Precision score for label_class 0: 0.7229
2024-08-12 12:54:16,535 : INFO : Precision score for label_class 1: 0.8966
2024-08-12 12:54:16,535 : INFO : Precision score for label_class 2: 0.8280
2024-08-12 12:54:16,535 : INFO : Recall score for label_class 0: 0.8451
2024-08-12 12:54:16,535 : INFO : Recall score for label_class 1: 0.8878
2024-08-12 12:54:16,535 : INFO : Recall score for label_class 2: 0.7938
2024-08-12 12:54:16,535 : INFO : Average F1 score: 0.8273
2024-08-12 12:54:16,535 : INFO : Determined score from best model, ending training.
2024-08-12 12:54:16,536 : INFO : Split 2 is finished, the score is: 0.8273
2024-08-12 12:54:16,536 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:16,536 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:16,536 : INFO : Starting training for split 3
2024-08-12 12:54:16,548 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 328, 1611,  759]))
2024-08-12 12:54:16,550 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 86, 400, 189]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:54:16,591 : INFO : Starting epoch 1
2024-08-12 12:54:16,633 : INFO : Current training batch loss: 1.1143 in epoch 1
2024-08-12 12:54:17,442 : INFO : Current training batch loss: 1.0492 in epoch 1
2024-08-12 12:54:18,246 : INFO : Current training batch loss: 0.8664 in epoch 1
2024-08-12 12:54:19,049 : INFO : Current training batch loss: 0.7756 in epoch 1
2024-08-12 12:54:19,852 : INFO : Current training batch loss: 0.6869 in epoch 1
2024-08-12 12:54:19,987 : INFO : Epoch finished, average loss over training batches: 0.8800
2024-08-12 12:54:19,987 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:19,987 : INFO : Training metrics:
2024-08-12 12:54:19,987 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:19,992 : INFO : Accuracy: 0.5908
2024-08-12 12:54:19,992 : INFO : Precision score for label_class 0: 0.1254
2024-08-12 12:54:19,992 : INFO : Precision score for label_class 1: 0.6861
2024-08-12 12:54:19,992 : INFO : Precision score for label_class 2: 0.5245
2024-08-12 12:54:19,992 : INFO : Recall score for label_class 0: 0.1280
2024-08-12 12:54:19,992 : INFO : Recall score for label_class 1: 0.8237
2024-08-12 12:54:19,992 : INFO : Recall score for label_class 2: 0.2964
2024-08-12 12:54:19,992 : INFO : Average F1 score: 0.4180
2024-08-12 12:54:20,272 : INFO : Average loss over validation batches: 0.6224
2024-08-12 12:54:20,272 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:20,273 : INFO : Validation metrics:
2024-08-12 12:54:20,273 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:20,275 : INFO : Accuracy: 0.7585
2024-08-12 12:54:20,275 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:54:20,275 : INFO : Precision score for label_class 1: 0.8581
2024-08-12 12:54:20,275 : INFO : Precision score for label_class 2: 0.5756
2024-08-12 12:54:20,275 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:54:20,275 : INFO : Recall score for label_class 1: 0.9375
2024-08-12 12:54:20,275 : INFO : Recall score for label_class 2: 0.7249
2024-08-12 12:54:20,275 : INFO : Average F1 score: 0.5126
2024-08-12 12:54:20,275 : INFO : Validation metric decreased (inf --> 0.622397).  Saving model ...
2024-08-12 12:54:20,384 : INFO : Starting epoch 2
2024-08-12 12:54:21,027 : INFO : Current training batch loss: 0.6098 in epoch 2
2024-08-12 12:54:21,829 : INFO : Current training batch loss: 0.5350 in epoch 2
2024-08-12 12:54:22,632 : INFO : Current training batch loss: 0.4214 in epoch 2
2024-08-12 12:54:23,435 : INFO : Current training batch loss: 0.3980 in epoch 2
2024-08-12 12:54:23,771 : INFO : Epoch finished, average loss over training batches: 0.5261
2024-08-12 12:54:23,771 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:23,771 : INFO : Training metrics:
2024-08-12 12:54:23,771 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:23,776 : INFO : Accuracy: 0.8076
2024-08-12 12:54:23,776 : INFO : Precision score for label_class 0: 0.7609
2024-08-12 12:54:23,776 : INFO : Precision score for label_class 1: 0.8706
2024-08-12 12:54:23,776 : INFO : Precision score for label_class 2: 0.6854
2024-08-12 12:54:23,776 : INFO : Recall score for label_class 0: 0.3201
2024-08-12 12:54:23,776 : INFO : Recall score for label_class 1: 0.9317
2024-08-12 12:54:23,776 : INFO : Recall score for label_class 2: 0.7549
2024-08-12 12:54:23,776 : INFO : Average F1 score: 0.6898
2024-08-12 12:54:24,057 : INFO : Average loss over validation batches: 0.4189
2024-08-12 12:54:24,057 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:24,057 : INFO : Validation metrics:
2024-08-12 12:54:24,057 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:24,060 : INFO : Accuracy: 0.8563
2024-08-12 12:54:24,060 : INFO : Precision score for label_class 0: 0.7327
2024-08-12 12:54:24,060 : INFO : Precision score for label_class 1: 0.9162
2024-08-12 12:54:24,060 : INFO : Precision score for label_class 2: 0.7944
2024-08-12 12:54:24,060 : INFO : Recall score for label_class 0: 0.8605
2024-08-12 12:54:24,060 : INFO : Recall score for label_class 1: 0.9025
2024-08-12 12:54:24,060 : INFO : Recall score for label_class 2: 0.7566
2024-08-12 12:54:24,060 : INFO : Average F1 score: 0.8253
2024-08-12 12:54:24,060 : INFO : Validation metric decreased (0.622397 --> 0.418908).  Saving model ...
2024-08-12 12:54:24,160 : INFO : Starting epoch 3
2024-08-12 12:54:24,602 : INFO : Current training batch loss: 0.2895 in epoch 3
2024-08-12 12:54:25,406 : INFO : Current training batch loss: 0.3582 in epoch 3
2024-08-12 12:54:26,209 : INFO : Current training batch loss: 0.3368 in epoch 3
2024-08-12 12:54:27,012 : INFO : Current training batch loss: 0.1587 in epoch 3
2024-08-12 12:54:27,548 : INFO : Epoch finished, average loss over training batches: 0.2960
2024-08-12 12:54:27,548 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:27,548 : INFO : Training metrics:
2024-08-12 12:54:27,548 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:27,556 : INFO : Accuracy: 0.9155
2024-08-12 12:54:27,556 : INFO : Precision score for label_class 0: 0.8218
2024-08-12 12:54:27,556 : INFO : Precision score for label_class 1: 0.9429
2024-08-12 12:54:27,556 : INFO : Precision score for label_class 2: 0.8969
2024-08-12 12:54:27,556 : INFO : Recall score for label_class 0: 0.8293
2024-08-12 12:54:27,556 : INFO : Recall score for label_class 1: 0.9541
2024-08-12 12:54:27,556 : INFO : Recall score for label_class 2: 0.8709
2024-08-12 12:54:27,556 : INFO : Average F1 score: 0.8859
2024-08-12 12:54:27,837 : INFO : Average loss over validation batches: 0.3864
2024-08-12 12:54:27,837 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:27,837 : INFO : Validation metrics:
2024-08-12 12:54:27,837 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:27,840 : INFO : Accuracy: 0.8563
2024-08-12 12:54:27,840 : INFO : Precision score for label_class 0: 0.8205
2024-08-12 12:54:27,840 : INFO : Precision score for label_class 1: 0.9383
2024-08-12 12:54:27,840 : INFO : Precision score for label_class 2: 0.7321
2024-08-12 12:54:27,840 : INFO : Recall score for label_class 0: 0.7442
2024-08-12 12:54:27,840 : INFO : Recall score for label_class 1: 0.8750
2024-08-12 12:54:27,840 : INFO : Recall score for label_class 2: 0.8677
2024-08-12 12:54:27,840 : INFO : Average F1 score: 0.8267
2024-08-12 12:54:27,840 : INFO : Validation metric decreased (0.418908 --> 0.386391).  Saving model ...
2024-08-12 12:54:27,941 : INFO : Starting epoch 4
2024-08-12 12:54:28,183 : INFO : Current training batch loss: 0.4295 in epoch 4
2024-08-12 12:54:28,986 : INFO : Current training batch loss: 0.3357 in epoch 4
2024-08-12 12:54:29,790 : INFO : Current training batch loss: 0.2186 in epoch 4
2024-08-12 12:54:30,593 : INFO : Current training batch loss: 0.1534 in epoch 4
2024-08-12 12:54:31,330 : INFO : Epoch finished, average loss over training batches: 0.1879
2024-08-12 12:54:31,330 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:31,331 : INFO : Training metrics:
2024-08-12 12:54:31,331 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:31,336 : INFO : Accuracy: 0.9514
2024-08-12 12:54:31,336 : INFO : Precision score for label_class 0: 0.8765
2024-08-12 12:54:31,336 : INFO : Precision score for label_class 1: 0.9667
2024-08-12 12:54:31,336 : INFO : Precision score for label_class 2: 0.9524
2024-08-12 12:54:31,336 : INFO : Recall score for label_class 0: 0.9085
2024-08-12 12:54:31,336 : INFO : Recall score for label_class 1: 0.9739
2024-08-12 12:54:31,336 : INFO : Recall score for label_class 2: 0.9223
2024-08-12 12:54:31,336 : INFO : Average F1 score: 0.9332
2024-08-12 12:54:31,617 : INFO : Average loss over validation batches: 0.4357
2024-08-12 12:54:31,617 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:31,617 : INFO : Validation metrics:
2024-08-12 12:54:31,617 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:31,620 : INFO : Accuracy: 0.8430
2024-08-12 12:54:31,620 : INFO : Precision score for label_class 0: 0.7000
2024-08-12 12:54:31,620 : INFO : Precision score for label_class 1: 0.9463
2024-08-12 12:54:31,620 : INFO : Precision score for label_class 2: 0.7441
2024-08-12 12:54:31,620 : INFO : Recall score for label_class 0: 0.8953
2024-08-12 12:54:31,620 : INFO : Recall score for label_class 1: 0.8375
2024-08-12 12:54:31,620 : INFO : Recall score for label_class 2: 0.8307
2024-08-12 12:54:31,620 : INFO : Average F1 score: 0.8198
2024-08-12 12:54:31,620 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 12:54:31,620 : INFO : Starting epoch 5
2024-08-12 12:54:31,661 : INFO : Current training batch loss: 0.1791 in epoch 5
2024-08-12 12:54:32,464 : INFO : Current training batch loss: 0.3803 in epoch 5
2024-08-12 12:54:33,268 : INFO : Current training batch loss: 0.0547 in epoch 5
2024-08-12 12:54:34,072 : INFO : Current training batch loss: 0.1536 in epoch 5
2024-08-12 12:54:34,877 : INFO : Current training batch loss: 0.1427 in epoch 5
2024-08-12 12:54:35,012 : INFO : Epoch finished, average loss over training batches: 0.1369
2024-08-12 12:54:35,012 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:35,012 : INFO : Training metrics:
2024-08-12 12:54:35,012 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:35,020 : INFO : Accuracy: 0.9689
2024-08-12 12:54:35,020 : INFO : Precision score for label_class 0: 0.9041
2024-08-12 12:54:35,020 : INFO : Precision score for label_class 1: 0.9802
2024-08-12 12:54:35,020 : INFO : Precision score for label_class 2: 0.9742
2024-08-12 12:54:35,020 : INFO : Recall score for label_class 0: 0.9482
2024-08-12 12:54:35,020 : INFO : Recall score for label_class 1: 0.9839
2024-08-12 12:54:35,020 : INFO : Recall score for label_class 2: 0.9460
2024-08-12 12:54:35,021 : INFO : Average F1 score: 0.9558
2024-08-12 12:54:35,301 : INFO : Average loss over validation batches: 0.4179
2024-08-12 12:54:35,301 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:35,301 : INFO : Validation metrics:
2024-08-12 12:54:35,301 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:35,304 : INFO : Accuracy: 0.8681
2024-08-12 12:54:35,304 : INFO : Precision score for label_class 0: 0.7732
2024-08-12 12:54:35,304 : INFO : Precision score for label_class 1: 0.8905
2024-08-12 12:54:35,304 : INFO : Precision score for label_class 2: 0.8671
2024-08-12 12:54:35,304 : INFO : Recall score for label_class 0: 0.8721
2024-08-12 12:54:35,304 : INFO : Recall score for label_class 1: 0.9350
2024-08-12 12:54:35,304 : INFO : Recall score for label_class 2: 0.7249
2024-08-12 12:54:35,304 : INFO : Average F1 score: 0.8405
2024-08-12 12:54:35,305 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 12:54:35,305 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:54:35,345 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 12:54:35,659 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:35,659 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 12:54:35,659 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:35,661 : INFO : Accuracy: 0.8563
2024-08-12 12:54:35,661 : INFO : Precision score for label_class 0: 0.8205
2024-08-12 12:54:35,661 : INFO : Precision score for label_class 1: 0.9383
2024-08-12 12:54:35,661 : INFO : Precision score for label_class 2: 0.7321
2024-08-12 12:54:35,661 : INFO : Recall score for label_class 0: 0.7442
2024-08-12 12:54:35,661 : INFO : Recall score for label_class 1: 0.8750
2024-08-12 12:54:35,661 : INFO : Recall score for label_class 2: 0.8677
2024-08-12 12:54:35,661 : INFO : Average F1 score: 0.8267
2024-08-12 12:54:35,661 : INFO : Determined score from best model, ending training.
2024-08-12 12:54:35,663 : INFO : Split 3 is finished, the score is: 0.8267
2024-08-12 12:54:35,663 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:35,663 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:35,663 : INFO : Starting training for split 4
2024-08-12 12:54:35,680 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 327, 1621,  751]))
2024-08-12 12:54:35,682 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 87, 390, 197]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:54:35,733 : INFO : Starting epoch 1
2024-08-12 12:54:35,775 : INFO : Current training batch loss: 1.1061 in epoch 1
2024-08-12 12:54:36,578 : INFO : Current training batch loss: 1.0347 in epoch 1
2024-08-12 12:54:37,381 : INFO : Current training batch loss: 0.8329 in epoch 1
2024-08-12 12:54:38,184 : INFO : Current training batch loss: 0.6577 in epoch 1
2024-08-12 12:54:38,987 : INFO : Current training batch loss: 0.6370 in epoch 1
2024-08-12 12:54:39,122 : INFO : Epoch finished, average loss over training batches: 0.8616
2024-08-12 12:54:39,123 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:39,123 : INFO : Training metrics:
2024-08-12 12:54:39,123 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:39,131 : INFO : Accuracy: 0.6065
2024-08-12 12:54:39,131 : INFO : Precision score for label_class 0: 0.1340
2024-08-12 12:54:39,131 : INFO : Precision score for label_class 1: 0.6877
2024-08-12 12:54:39,131 : INFO : Precision score for label_class 2: 0.5406
2024-08-12 12:54:39,131 : INFO : Recall score for label_class 0: 0.1193
2024-08-12 12:54:39,131 : INFO : Recall score for label_class 1: 0.8544
2024-08-12 12:54:39,131 : INFO : Recall score for label_class 2: 0.2836
2024-08-12 12:54:39,131 : INFO : Average F1 score: 0.4201
2024-08-12 12:54:39,412 : INFO : Average loss over validation batches: 0.6242
2024-08-12 12:54:39,412 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:39,412 : INFO : Validation metrics:
2024-08-12 12:54:39,412 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:39,415 : INFO : Accuracy: 0.7478
2024-08-12 12:54:39,415 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:54:39,415 : INFO : Precision score for label_class 1: 0.8234
2024-08-12 12:54:39,415 : INFO : Precision score for label_class 2: 0.5928
2024-08-12 12:54:39,415 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:54:39,416 : INFO : Recall score for label_class 1: 0.9564
2024-08-12 12:54:39,416 : INFO : Recall score for label_class 2: 0.6650
2024-08-12 12:54:39,416 : INFO : Average F1 score: 0.5039
2024-08-12 12:54:39,416 : INFO : Validation metric decreased (inf --> 0.624183).  Saving model ...
2024-08-12 12:54:39,523 : INFO : Starting epoch 2
2024-08-12 12:54:40,165 : INFO : Current training batch loss: 0.5745 in epoch 2
2024-08-12 12:54:40,968 : INFO : Current training batch loss: 0.4135 in epoch 2
2024-08-12 12:54:41,771 : INFO : Current training batch loss: 0.2889 in epoch 2
2024-08-12 12:54:42,574 : INFO : Current training batch loss: 0.4593 in epoch 2
2024-08-12 12:54:42,909 : INFO : Epoch finished, average loss over training batches: 0.4762
2024-08-12 12:54:42,909 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:42,909 : INFO : Training metrics:
2024-08-12 12:54:42,909 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:42,914 : INFO : Accuracy: 0.8462
2024-08-12 12:54:42,915 : INFO : Precision score for label_class 0: 0.7695
2024-08-12 12:54:42,915 : INFO : Precision score for label_class 1: 0.8755
2024-08-12 12:54:42,915 : INFO : Precision score for label_class 2: 0.8043
2024-08-12 12:54:42,915 : INFO : Recall score for label_class 0: 0.6636
2024-08-12 12:54:42,915 : INFO : Recall score for label_class 1: 0.9328
2024-08-12 12:54:42,915 : INFO : Recall score for label_class 2: 0.7390
2024-08-12 12:54:42,915 : INFO : Average F1 score: 0.7954
2024-08-12 12:54:43,194 : INFO : Average loss over validation batches: 0.4066
2024-08-12 12:54:43,194 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:43,194 : INFO : Validation metrics:
2024-08-12 12:54:43,194 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:43,198 : INFO : Accuracy: 0.8620
2024-08-12 12:54:43,198 : INFO : Precision score for label_class 0: 0.7416
2024-08-12 12:54:43,198 : INFO : Precision score for label_class 1: 0.8810
2024-08-12 12:54:43,198 : INFO : Precision score for label_class 2: 0.8788
2024-08-12 12:54:43,198 : INFO : Recall score for label_class 0: 0.7586
2024-08-12 12:54:43,198 : INFO : Recall score for label_class 1: 0.9487
2024-08-12 12:54:43,198 : INFO : Recall score for label_class 2: 0.7360
2024-08-12 12:54:43,198 : INFO : Average F1 score: 0.8216
2024-08-12 12:54:43,198 : INFO : Validation metric decreased (0.624183 --> 0.406575).  Saving model ...
2024-08-12 12:54:43,296 : INFO : Starting epoch 3
2024-08-12 12:54:43,739 : INFO : Current training batch loss: 0.2511 in epoch 3
2024-08-12 12:54:44,542 : INFO : Current training batch loss: 0.2856 in epoch 3
2024-08-12 12:54:45,345 : INFO : Current training batch loss: 0.2762 in epoch 3
2024-08-12 12:54:46,149 : INFO : Current training batch loss: 0.2393 in epoch 3
2024-08-12 12:54:46,685 : INFO : Epoch finished, average loss over training batches: 0.2846
2024-08-12 12:54:46,685 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:46,685 : INFO : Training metrics:
2024-08-12 12:54:46,685 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:46,693 : INFO : Accuracy: 0.9148
2024-08-12 12:54:46,693 : INFO : Precision score for label_class 0: 0.8392
2024-08-12 12:54:46,693 : INFO : Precision score for label_class 1: 0.9423
2024-08-12 12:54:46,693 : INFO : Precision score for label_class 2: 0.8889
2024-08-12 12:54:46,694 : INFO : Recall score for label_class 0: 0.8777
2024-08-12 12:54:46,694 : INFO : Recall score for label_class 1: 0.9463
2024-08-12 12:54:46,694 : INFO : Recall score for label_class 2: 0.8628
2024-08-12 12:54:46,694 : INFO : Average F1 score: 0.8927
2024-08-12 12:54:46,974 : INFO : Average loss over validation batches: 0.4217
2024-08-12 12:54:46,974 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:46,974 : INFO : Validation metrics:
2024-08-12 12:54:46,974 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:46,977 : INFO : Accuracy: 0.8591
2024-08-12 12:54:46,977 : INFO : Precision score for label_class 0: 0.7917
2024-08-12 12:54:46,977 : INFO : Precision score for label_class 1: 0.9331
2024-08-12 12:54:46,977 : INFO : Precision score for label_class 2: 0.7671
2024-08-12 12:54:46,977 : INFO : Recall score for label_class 0: 0.8736
2024-08-12 12:54:46,977 : INFO : Recall score for label_class 1: 0.8590
2024-08-12 12:54:46,977 : INFO : Recall score for label_class 2: 0.8528
2024-08-12 12:54:46,977 : INFO : Average F1 score: 0.8443
2024-08-12 12:54:46,978 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 12:54:46,978 : INFO : Starting epoch 4
2024-08-12 12:54:47,219 : INFO : Current training batch loss: 0.2798 in epoch 4
2024-08-12 12:54:48,022 : INFO : Current training batch loss: 0.2112 in epoch 4
2024-08-12 12:54:48,825 : INFO : Current training batch loss: 0.2175 in epoch 4
2024-08-12 12:54:49,629 : INFO : Current training batch loss: 0.1667 in epoch 4
2024-08-12 12:54:50,366 : INFO : Epoch finished, average loss over training batches: 0.1830
2024-08-12 12:54:50,366 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:50,366 : INFO : Training metrics:
2024-08-12 12:54:50,366 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:50,375 : INFO : Accuracy: 0.9526
2024-08-12 12:54:50,375 : INFO : Precision score for label_class 0: 0.8830
2024-08-12 12:54:50,375 : INFO : Precision score for label_class 1: 0.9704
2024-08-12 12:54:50,375 : INFO : Precision score for label_class 2: 0.9457
2024-08-12 12:54:50,375 : INFO : Recall score for label_class 0: 0.9235
2024-08-12 12:54:50,375 : INFO : Recall score for label_class 1: 0.9698
2024-08-12 12:54:50,375 : INFO : Recall score for label_class 2: 0.9281
2024-08-12 12:54:50,375 : INFO : Average F1 score: 0.9366
2024-08-12 12:54:50,655 : INFO : Average loss over validation batches: 0.4090
2024-08-12 12:54:50,655 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:50,655 : INFO : Validation metrics:
2024-08-12 12:54:50,655 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:50,658 : INFO : Accuracy: 0.8635
2024-08-12 12:54:50,658 : INFO : Precision score for label_class 0: 0.7130
2024-08-12 12:54:50,658 : INFO : Precision score for label_class 1: 0.9375
2024-08-12 12:54:50,658 : INFO : Precision score for label_class 2: 0.8081
2024-08-12 12:54:50,658 : INFO : Recall score for label_class 0: 0.8851
2024-08-12 12:54:50,658 : INFO : Recall score for label_class 1: 0.8846
2024-08-12 12:54:50,658 : INFO : Recall score for label_class 2: 0.8122
2024-08-12 12:54:50,658 : INFO : Average F1 score: 0.8367
2024-08-12 12:54:50,658 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 12:54:50,658 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:54:50,698 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 12:54:51,015 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:51,015 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 12:54:51,015 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:51,018 : INFO : Accuracy: 0.8620
2024-08-12 12:54:51,019 : INFO : Precision score for label_class 0: 0.7416
2024-08-12 12:54:51,019 : INFO : Precision score for label_class 1: 0.8810
2024-08-12 12:54:51,019 : INFO : Precision score for label_class 2: 0.8788
2024-08-12 12:54:51,019 : INFO : Recall score for label_class 0: 0.7586
2024-08-12 12:54:51,019 : INFO : Recall score for label_class 1: 0.9487
2024-08-12 12:54:51,019 : INFO : Recall score for label_class 2: 0.7360
2024-08-12 12:54:51,019 : INFO : Average F1 score: 0.8216
2024-08-12 12:54:51,019 : INFO : Determined score from best model, ending training.
2024-08-12 12:54:51,020 : INFO : Split 4 is finished, the score is: 0.8216
2024-08-12 12:54:51,020 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:51,020 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:51,020 : INFO : Starting training for split 5
2024-08-12 12:54:51,031 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 330, 1615,  754]))
2024-08-12 12:54:51,033 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 84, 396, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:54:51,073 : INFO : Starting epoch 1
2024-08-12 12:54:51,115 : INFO : Current training batch loss: 1.1077 in epoch 1
2024-08-12 12:54:51,928 : INFO : Current training batch loss: 1.0399 in epoch 1
2024-08-12 12:54:52,741 : INFO : Current training batch loss: 0.8345 in epoch 1
2024-08-12 12:54:53,555 : INFO : Current training batch loss: 0.7193 in epoch 1
2024-08-12 12:54:54,368 : INFO : Current training batch loss: 0.7395 in epoch 1
2024-08-12 12:54:54,515 : INFO : Epoch finished, average loss over training batches: 0.8667
2024-08-12 12:54:54,515 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:54,515 : INFO : Training metrics:
2024-08-12 12:54:54,515 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:54,526 : INFO : Accuracy: 0.6221
2024-08-12 12:54:54,526 : INFO : Precision score for label_class 0: 0.3925
2024-08-12 12:54:54,526 : INFO : Precision score for label_class 1: 0.6887
2024-08-12 12:54:54,526 : INFO : Precision score for label_class 2: 0.4382
2024-08-12 12:54:54,526 : INFO : Recall score for label_class 0: 0.1273
2024-08-12 12:54:54,526 : INFO : Recall score for label_class 1: 0.8533
2024-08-12 12:54:54,526 : INFO : Recall score for label_class 2: 0.3435
2024-08-12 12:54:54,526 : INFO : Average F1 score: 0.4465
2024-08-12 12:54:54,806 : INFO : Average loss over validation batches: 0.6302
2024-08-12 12:54:54,807 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:54,807 : INFO : Validation metrics:
2024-08-12 12:54:54,807 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:54,810 : INFO : Accuracy: 0.7196
2024-08-12 12:54:54,810 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:54:54,810 : INFO : Precision score for label_class 1: 0.8133
2024-08-12 12:54:54,810 : INFO : Precision score for label_class 2: 0.5312
2024-08-12 12:54:54,810 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:54:54,810 : INFO : Recall score for label_class 1: 0.9242
2024-08-12 12:54:54,810 : INFO : Recall score for label_class 2: 0.6134
2024-08-12 12:54:54,810 : INFO : Average F1 score: 0.4782
2024-08-12 12:54:54,810 : INFO : Validation metric decreased (inf --> 0.630246).  Saving model ...
2024-08-12 12:54:54,917 : INFO : Starting epoch 2
2024-08-12 12:54:55,567 : INFO : Current training batch loss: 0.5970 in epoch 2
2024-08-12 12:54:56,380 : INFO : Current training batch loss: 0.5119 in epoch 2
2024-08-12 12:54:57,194 : INFO : Current training batch loss: 0.3060 in epoch 2
2024-08-12 12:54:58,007 : INFO : Current training batch loss: 0.4904 in epoch 2
2024-08-12 12:54:58,356 : INFO : Epoch finished, average loss over training batches: 0.5006
2024-08-12 12:54:58,357 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:58,357 : INFO : Training metrics:
2024-08-12 12:54:58,357 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:58,366 : INFO : Accuracy: 0.8329
2024-08-12 12:54:58,366 : INFO : Precision score for label_class 0: 0.7915
2024-08-12 12:54:58,366 : INFO : Precision score for label_class 1: 0.8782
2024-08-12 12:54:58,366 : INFO : Precision score for label_class 2: 0.7434
2024-08-12 12:54:58,366 : INFO : Recall score for label_class 0: 0.5636
2024-08-12 12:54:58,366 : INFO : Recall score for label_class 1: 0.9288
2024-08-12 12:54:58,366 : INFO : Recall score for label_class 2: 0.7454
2024-08-12 12:54:58,366 : INFO : Average F1 score: 0.7685
2024-08-12 12:54:58,645 : INFO : Average loss over validation batches: 0.4561
2024-08-12 12:54:58,645 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:58,646 : INFO : Validation metrics:
2024-08-12 12:54:58,646 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:54:58,649 : INFO : Accuracy: 0.8234
2024-08-12 12:54:58,649 : INFO : Precision score for label_class 0: 0.7222
2024-08-12 12:54:58,649 : INFO : Precision score for label_class 1: 0.8595
2024-08-12 12:54:58,649 : INFO : Precision score for label_class 2: 0.7866
2024-08-12 12:54:58,649 : INFO : Recall score for label_class 0: 0.7738
2024-08-12 12:54:58,649 : INFO : Recall score for label_class 1: 0.9116
2024-08-12 12:54:58,649 : INFO : Recall score for label_class 2: 0.6649
2024-08-12 12:54:58,649 : INFO : Average F1 score: 0.7842
2024-08-12 12:54:58,649 : INFO : Validation metric decreased (0.630246 --> 0.456087).  Saving model ...
2024-08-12 12:54:58,747 : INFO : Starting epoch 3
2024-08-12 12:54:59,197 : INFO : Current training batch loss: 0.2830 in epoch 3
2024-08-12 12:55:00,009 : INFO : Current training batch loss: 0.4056 in epoch 3
2024-08-12 12:55:00,822 : INFO : Current training batch loss: 0.3274 in epoch 3
2024-08-12 12:55:01,635 : INFO : Current training batch loss: 0.2418 in epoch 3
2024-08-12 12:55:02,187 : INFO : Epoch finished, average loss over training batches: 0.3091
2024-08-12 12:55:02,187 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:02,187 : INFO : Training metrics:
2024-08-12 12:55:02,187 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:02,198 : INFO : Accuracy: 0.9133
2024-08-12 12:55:02,198 : INFO : Precision score for label_class 0: 0.8506
2024-08-12 12:55:02,198 : INFO : Precision score for label_class 1: 0.9372
2024-08-12 12:55:02,198 : INFO : Precision score for label_class 2: 0.8878
2024-08-12 12:55:02,198 : INFO : Recall score for label_class 0: 0.8455
2024-08-12 12:55:02,198 : INFO : Recall score for label_class 1: 0.9517
2024-08-12 12:55:02,198 : INFO : Recall score for label_class 2: 0.8607
2024-08-12 12:55:02,198 : INFO : Average F1 score: 0.8888
2024-08-12 12:55:02,479 : INFO : Average loss over validation batches: 0.4166
2024-08-12 12:55:02,479 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:02,479 : INFO : Validation metrics:
2024-08-12 12:55:02,479 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:02,482 : INFO : Accuracy: 0.8457
2024-08-12 12:55:02,482 : INFO : Precision score for label_class 0: 0.7444
2024-08-12 12:55:02,482 : INFO : Precision score for label_class 1: 0.8920
2024-08-12 12:55:02,482 : INFO : Precision score for label_class 2: 0.7957
2024-08-12 12:55:02,482 : INFO : Recall score for label_class 0: 0.7976
2024-08-12 12:55:02,482 : INFO : Recall score for label_class 1: 0.8965
2024-08-12 12:55:02,482 : INFO : Recall score for label_class 2: 0.7629
2024-08-12 12:55:02,482 : INFO : Average F1 score: 0.8144
2024-08-12 12:55:02,482 : INFO : Validation metric decreased (0.456087 --> 0.416615).  Saving model ...
2024-08-12 12:55:02,585 : INFO : Starting epoch 4
2024-08-12 12:55:02,831 : INFO : Current training batch loss: 0.3218 in epoch 4
2024-08-12 12:55:03,643 : INFO : Current training batch loss: 0.1979 in epoch 4
2024-08-12 12:55:04,456 : INFO : Current training batch loss: 0.3259 in epoch 4
2024-08-12 12:55:05,270 : INFO : Current training batch loss: 0.1045 in epoch 4
2024-08-12 12:55:06,025 : INFO : Epoch finished, average loss over training batches: 0.2115
2024-08-12 12:55:06,025 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:06,025 : INFO : Training metrics:
2024-08-12 12:55:06,025 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:06,032 : INFO : Accuracy: 0.9470
2024-08-12 12:55:06,032 : INFO : Precision score for label_class 0: 0.8722
2024-08-12 12:55:06,032 : INFO : Precision score for label_class 1: 0.9647
2024-08-12 12:55:06,032 : INFO : Precision score for label_class 2: 0.9440
2024-08-12 12:55:06,032 : INFO : Recall score for label_class 0: 0.9303
2024-08-12 12:55:06,032 : INFO : Recall score for label_class 1: 0.9647
2024-08-12 12:55:06,033 : INFO : Recall score for label_class 2: 0.9164
2024-08-12 12:55:06,033 : INFO : Average F1 score: 0.9317
2024-08-12 12:55:06,313 : INFO : Average loss over validation batches: 0.4444
2024-08-12 12:55:06,313 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:06,313 : INFO : Validation metrics:
2024-08-12 12:55:06,313 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:06,316 : INFO : Accuracy: 0.8457
2024-08-12 12:55:06,316 : INFO : Precision score for label_class 0: 0.7019
2024-08-12 12:55:06,316 : INFO : Precision score for label_class 1: 0.9191
2024-08-12 12:55:06,316 : INFO : Precision score for label_class 2: 0.7839
2024-08-12 12:55:06,316 : INFO : Recall score for label_class 0: 0.8690
2024-08-12 12:55:06,316 : INFO : Recall score for label_class 1: 0.8611
2024-08-12 12:55:06,316 : INFO : Recall score for label_class 2: 0.8041
2024-08-12 12:55:06,316 : INFO : Average F1 score: 0.8199
2024-08-12 12:55:06,316 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 12:55:06,316 : INFO : Starting epoch 5
2024-08-12 12:55:06,358 : INFO : Current training batch loss: 0.0885 in epoch 5
2024-08-12 12:55:07,170 : INFO : Current training batch loss: 0.3228 in epoch 5
2024-08-12 12:55:07,983 : INFO : Current training batch loss: 0.0712 in epoch 5
2024-08-12 12:55:08,797 : INFO : Current training batch loss: 0.1949 in epoch 5
2024-08-12 12:55:09,610 : INFO : Current training batch loss: 0.0611 in epoch 5
2024-08-12 12:55:09,756 : INFO : Epoch finished, average loss over training batches: 0.1524
2024-08-12 12:55:09,756 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:09,756 : INFO : Training metrics:
2024-08-12 12:55:09,756 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:09,767 : INFO : Accuracy: 0.9633
2024-08-12 12:55:09,767 : INFO : Precision score for label_class 0: 0.9006
2024-08-12 12:55:09,767 : INFO : Precision score for label_class 1: 0.9771
2024-08-12 12:55:09,767 : INFO : Precision score for label_class 2: 0.9621
2024-08-12 12:55:09,767 : INFO : Recall score for label_class 0: 0.9333
2024-08-12 12:55:09,767 : INFO : Recall score for label_class 1: 0.9789
2024-08-12 12:55:09,767 : INFO : Recall score for label_class 2: 0.9430
2024-08-12 12:55:09,767 : INFO : Average F1 score: 0.9491
2024-08-12 12:55:10,047 : INFO : Average loss over validation batches: 0.4350
2024-08-12 12:55:10,047 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:10,047 : INFO : Validation metrics:
2024-08-12 12:55:10,047 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:10,051 : INFO : Accuracy: 0.8531
2024-08-12 12:55:10,051 : INFO : Precision score for label_class 0: 0.7447
2024-08-12 12:55:10,051 : INFO : Precision score for label_class 1: 0.9176
2024-08-12 12:55:10,051 : INFO : Precision score for label_class 2: 0.7843
2024-08-12 12:55:10,051 : INFO : Recall score for label_class 0: 0.8333
2024-08-12 12:55:10,051 : INFO : Recall score for label_class 1: 0.8712
2024-08-12 12:55:10,051 : INFO : Recall score for label_class 2: 0.8247
2024-08-12 12:55:10,051 : INFO : Average F1 score: 0.8281
2024-08-12 12:55:10,051 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 12:55:10,051 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:55:10,088 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 12:55:10,403 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:10,403 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 12:55:10,403 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:10,406 : INFO : Accuracy: 0.8457
2024-08-12 12:55:10,406 : INFO : Precision score for label_class 0: 0.7444
2024-08-12 12:55:10,406 : INFO : Precision score for label_class 1: 0.8920
2024-08-12 12:55:10,406 : INFO : Precision score for label_class 2: 0.7957
2024-08-12 12:55:10,406 : INFO : Recall score for label_class 0: 0.7976
2024-08-12 12:55:10,406 : INFO : Recall score for label_class 1: 0.8965
2024-08-12 12:55:10,406 : INFO : Recall score for label_class 2: 0.7629
2024-08-12 12:55:10,406 : INFO : Average F1 score: 0.8144
2024-08-12 12:55:10,406 : INFO : Determined score from best model, ending training.
2024-08-12 12:55:10,413 : INFO : Split 5 is finished, the score is: 0.8144
2024-08-12 12:55:10,413 : INFO : ----------------------------------------------------------------------------------------------------
[I 2024-08-12 12:55:10,414] Trial 4 finished with value: 0.8277147326230521 and parameters: {'n_epochs': 6, 'learning_rate': 4.9346895505750796e-05, 'classifier_dropout': 0.4520350893497075, 'warmup_step_fraction': 0.07458873200511033, 'use_gradient_clipping': True}. Best is trial 1 with value: 0.833042786775897.
2024-08-12 12:55:10,414 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:10,414 : INFO : Starting training for split 1
2024-08-12 12:55:10,425 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 328, 1596,  774]))
2024-08-12 12:55:10,427 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 86, 415, 174]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:55:10,563 : INFO : Starting epoch 1
2024-08-12 12:55:10,605 : INFO : Current training batch loss: 1.1316 in epoch 1
2024-08-12 12:55:11,415 : INFO : Current training batch loss: 0.8913 in epoch 1
2024-08-12 12:55:12,226 : INFO : Current training batch loss: 0.9083 in epoch 1
2024-08-12 12:55:13,037 : INFO : Current training batch loss: 0.6705 in epoch 1
2024-08-12 12:55:13,847 : INFO : Current training batch loss: 0.6066 in epoch 1
2024-08-12 12:55:13,992 : INFO : Epoch finished, average loss over training batches: 0.8410
2024-08-12 12:55:13,993 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:13,993 : INFO : Training metrics:
2024-08-12 12:55:13,993 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:14,001 : INFO : Accuracy: 0.6042
2024-08-12 12:55:14,001 : INFO : Precision score for label_class 0: 0.1662
2024-08-12 12:55:14,001 : INFO : Precision score for label_class 1: 0.6871
2024-08-12 12:55:14,001 : INFO : Precision score for label_class 2: 0.5512
2024-08-12 12:55:14,001 : INFO : Recall score for label_class 0: 0.1738
2024-08-12 12:55:14,001 : INFO : Recall score for label_class 1: 0.8709
2024-08-12 12:55:14,001 : INFO : Recall score for label_class 2: 0.2364
2024-08-12 12:55:14,001 : INFO : Average F1 score: 0.4230
2024-08-12 12:55:14,281 : INFO : Average loss over validation batches: 0.5947
2024-08-12 12:55:14,281 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:14,281 : INFO : Validation metrics:
2024-08-12 12:55:14,281 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:14,283 : INFO : Accuracy: 0.7615
2024-08-12 12:55:14,283 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:55:14,283 : INFO : Precision score for label_class 1: 0.8705
2024-08-12 12:55:14,283 : INFO : Precision score for label_class 2: 0.5574
2024-08-12 12:55:14,283 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:55:14,283 : INFO : Recall score for label_class 1: 0.9229
2024-08-12 12:55:14,283 : INFO : Recall score for label_class 2: 0.7529
2024-08-12 12:55:14,283 : INFO : Average F1 score: 0.5122
2024-08-12 12:55:14,284 : INFO : Validation metric decreased (inf --> 0.594667).  Saving model ...
2024-08-12 12:55:14,393 : INFO : Starting epoch 2
2024-08-12 12:55:15,041 : INFO : Current training batch loss: 0.3266 in epoch 2
2024-08-12 12:55:15,851 : INFO : Current training batch loss: 0.5284 in epoch 2
2024-08-12 12:55:16,661 : INFO : Current training batch loss: 0.4233 in epoch 2
2024-08-12 12:55:17,472 : INFO : Current training batch loss: 0.4893 in epoch 2
2024-08-12 12:55:17,819 : INFO : Epoch finished, average loss over training batches: 0.4537
2024-08-12 12:55:17,819 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:17,820 : INFO : Training metrics:
2024-08-12 12:55:17,820 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:17,824 : INFO : Accuracy: 0.8295
2024-08-12 12:55:17,824 : INFO : Precision score for label_class 0: 0.7477
2024-08-12 12:55:17,824 : INFO : Precision score for label_class 1: 0.8777
2024-08-12 12:55:17,824 : INFO : Precision score for label_class 2: 0.7487
2024-08-12 12:55:17,824 : INFO : Recall score for label_class 0: 0.4970
2024-08-12 12:55:17,824 : INFO : Recall score for label_class 1: 0.9305
2024-08-12 12:55:17,824 : INFO : Recall score for label_class 2: 0.7623
2024-08-12 12:55:17,824 : INFO : Average F1 score: 0.7519
2024-08-12 12:55:18,104 : INFO : Average loss over validation batches: 0.4134
2024-08-12 12:55:18,104 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:18,104 : INFO : Validation metrics:
2024-08-12 12:55:18,104 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:18,106 : INFO : Accuracy: 0.8400
2024-08-12 12:55:18,106 : INFO : Precision score for label_class 0: 0.7683
2024-08-12 12:55:18,106 : INFO : Precision score for label_class 1: 0.9254
2024-08-12 12:55:18,106 : INFO : Precision score for label_class 2: 0.7059
2024-08-12 12:55:18,106 : INFO : Recall score for label_class 0: 0.7326
2024-08-12 12:55:18,106 : INFO : Recall score for label_class 1: 0.8675
2024-08-12 12:55:18,106 : INFO : Recall score for label_class 2: 0.8276
2024-08-12 12:55:18,107 : INFO : Average F1 score: 0.8025
2024-08-12 12:55:18,107 : INFO : Validation metric decreased (0.594667 --> 0.413380).  Saving model ...
2024-08-12 12:55:18,208 : INFO : Starting epoch 3
2024-08-12 12:55:18,654 : INFO : Current training batch loss: 0.3146 in epoch 3
2024-08-12 12:55:19,464 : INFO : Current training batch loss: 0.4142 in epoch 3
2024-08-12 12:55:20,275 : INFO : Current training batch loss: 0.2608 in epoch 3
2024-08-12 12:55:21,085 : INFO : Current training batch loss: 0.0583 in epoch 3
2024-08-12 12:55:21,635 : INFO : Epoch finished, average loss over training batches: 0.2462
2024-08-12 12:55:21,635 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:21,635 : INFO : Training metrics:
2024-08-12 12:55:21,635 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:21,643 : INFO : Accuracy: 0.9170
2024-08-12 12:55:21,643 : INFO : Precision score for label_class 0: 0.8068
2024-08-12 12:55:21,643 : INFO : Precision score for label_class 1: 0.9470
2024-08-12 12:55:21,643 : INFO : Precision score for label_class 2: 0.9042
2024-08-12 12:55:21,643 : INFO : Recall score for label_class 0: 0.8659
2024-08-12 12:55:21,643 : INFO : Recall score for label_class 1: 0.9524
2024-08-12 12:55:21,643 : INFO : Recall score for label_class 2: 0.8656
2024-08-12 12:55:21,643 : INFO : Average F1 score: 0.8898
2024-08-12 12:55:21,923 : INFO : Average loss over validation batches: 0.3730
2024-08-12 12:55:21,923 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:21,923 : INFO : Validation metrics:
2024-08-12 12:55:21,923 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:21,926 : INFO : Accuracy: 0.8726
2024-08-12 12:55:21,926 : INFO : Precision score for label_class 0: 0.8235
2024-08-12 12:55:21,926 : INFO : Precision score for label_class 1: 0.9028
2024-08-12 12:55:21,926 : INFO : Precision score for label_class 2: 0.8214
2024-08-12 12:55:21,926 : INFO : Recall score for label_class 0: 0.8140
2024-08-12 12:55:21,926 : INFO : Recall score for label_class 1: 0.9181
2024-08-12 12:55:21,926 : INFO : Recall score for label_class 2: 0.7931
2024-08-12 12:55:21,926 : INFO : Average F1 score: 0.8454
2024-08-12 12:55:21,926 : INFO : Validation metric decreased (0.413380 --> 0.373047).  Saving model ...
2024-08-12 12:55:22,028 : INFO : Starting epoch 4
2024-08-12 12:55:22,272 : INFO : Current training batch loss: 0.4358 in epoch 4
2024-08-12 12:55:23,083 : INFO : Current training batch loss: 0.0754 in epoch 4
2024-08-12 12:55:23,894 : INFO : Current training batch loss: 0.2233 in epoch 4
2024-08-12 12:55:24,705 : INFO : Current training batch loss: 0.1568 in epoch 4
2024-08-12 12:55:25,457 : INFO : Epoch finished, average loss over training batches: 0.1404
2024-08-12 12:55:25,457 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:25,457 : INFO : Training metrics:
2024-08-12 12:55:25,457 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:25,465 : INFO : Accuracy: 0.9570
2024-08-12 12:55:25,465 : INFO : Precision score for label_class 0: 0.8815
2024-08-12 12:55:25,465 : INFO : Precision score for label_class 1: 0.9768
2024-08-12 12:55:25,465 : INFO : Precision score for label_class 2: 0.9497
2024-08-12 12:55:25,465 : INFO : Recall score for label_class 0: 0.9299
2024-08-12 12:55:25,465 : INFO : Recall score for label_class 1: 0.9774
2024-08-12 12:55:25,465 : INFO : Recall score for label_class 2: 0.9264
2024-08-12 12:55:25,465 : INFO : Average F1 score: 0.9400
2024-08-12 12:55:25,745 : INFO : Average loss over validation batches: 0.4288
2024-08-12 12:55:25,745 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:25,745 : INFO : Validation metrics:
2024-08-12 12:55:25,745 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:25,748 : INFO : Accuracy: 0.8622
2024-08-12 12:55:25,748 : INFO : Precision score for label_class 0: 0.7912
2024-08-12 12:55:25,748 : INFO : Precision score for label_class 1: 0.9492
2024-08-12 12:55:25,748 : INFO : Precision score for label_class 2: 0.7381
2024-08-12 12:55:25,748 : INFO : Recall score for label_class 0: 0.8372
2024-08-12 12:55:25,748 : INFO : Recall score for label_class 1: 0.8554
2024-08-12 12:55:25,748 : INFO : Recall score for label_class 2: 0.8908
2024-08-12 12:55:25,748 : INFO : Average F1 score: 0.8402
2024-08-12 12:55:25,748 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 12:55:25,748 : INFO : Starting epoch 5
2024-08-12 12:55:25,790 : INFO : Current training batch loss: 0.1906 in epoch 5
2024-08-12 12:55:26,600 : INFO : Current training batch loss: 0.1253 in epoch 5
2024-08-12 12:55:27,411 : INFO : Current training batch loss: 0.0303 in epoch 5
2024-08-12 12:55:28,223 : INFO : Current training batch loss: 0.0821 in epoch 5
2024-08-12 12:55:29,034 : INFO : Current training batch loss: 0.0377 in epoch 5
2024-08-12 12:55:29,179 : INFO : Epoch finished, average loss over training batches: 0.0938
2024-08-12 12:55:29,180 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:29,180 : INFO : Training metrics:
2024-08-12 12:55:29,180 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:29,185 : INFO : Accuracy: 0.9770
2024-08-12 12:55:29,185 : INFO : Precision score for label_class 0: 0.9357
2024-08-12 12:55:29,185 : INFO : Precision score for label_class 1: 0.9856
2024-08-12 12:55:29,185 : INFO : Precision score for label_class 2: 0.9776
2024-08-12 12:55:29,185 : INFO : Recall score for label_class 0: 0.9756
2024-08-12 12:55:29,185 : INFO : Recall score for label_class 1: 0.9868
2024-08-12 12:55:29,185 : INFO : Recall score for label_class 2: 0.9574
2024-08-12 12:55:29,185 : INFO : Average F1 score: 0.9696
2024-08-12 12:55:29,465 : INFO : Average loss over validation batches: 0.3825
2024-08-12 12:55:29,465 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:29,465 : INFO : Validation metrics:
2024-08-12 12:55:29,465 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:29,468 : INFO : Accuracy: 0.8859
2024-08-12 12:55:29,468 : INFO : Precision score for label_class 0: 0.7573
2024-08-12 12:55:29,468 : INFO : Precision score for label_class 1: 0.9444
2024-08-12 12:55:29,468 : INFO : Precision score for label_class 2: 0.8295
2024-08-12 12:55:29,468 : INFO : Recall score for label_class 0: 0.9070
2024-08-12 12:55:29,468 : INFO : Recall score for label_class 1: 0.9012
2024-08-12 12:55:29,468 : INFO : Recall score for label_class 2: 0.8391
2024-08-12 12:55:29,468 : INFO : Average F1 score: 0.8607
2024-08-12 12:55:29,468 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 12:55:29,468 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:55:29,505 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 12:55:29,819 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:29,819 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 12:55:29,819 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:29,822 : INFO : Accuracy: 0.8726
2024-08-12 12:55:29,822 : INFO : Precision score for label_class 0: 0.8235
2024-08-12 12:55:29,822 : INFO : Precision score for label_class 1: 0.9028
2024-08-12 12:55:29,822 : INFO : Precision score for label_class 2: 0.8214
2024-08-12 12:55:29,822 : INFO : Recall score for label_class 0: 0.8140
2024-08-12 12:55:29,822 : INFO : Recall score for label_class 1: 0.9181
2024-08-12 12:55:29,822 : INFO : Recall score for label_class 2: 0.7931
2024-08-12 12:55:29,822 : INFO : Average F1 score: 0.8454
2024-08-12 12:55:29,822 : INFO : Determined score from best model, ending training.
2024-08-12 12:55:29,829 : INFO : Split 1 is finished, the score is: 0.8454
2024-08-12 12:55:29,829 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:29,829 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:29,829 : INFO : Starting training for split 2
2024-08-12 12:55:29,841 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 343, 1601,  754]))
2024-08-12 12:55:29,843 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 71, 410, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:55:29,892 : INFO : Starting epoch 1
2024-08-12 12:55:29,935 : INFO : Current training batch loss: 1.1127 in epoch 1
2024-08-12 12:55:30,746 : INFO : Current training batch loss: 1.0099 in epoch 1
2024-08-12 12:55:31,557 : INFO : Current training batch loss: 0.8067 in epoch 1
2024-08-12 12:55:32,367 : INFO : Current training batch loss: 0.7855 in epoch 1
2024-08-12 12:55:33,178 : INFO : Current training batch loss: 0.6491 in epoch 1
2024-08-12 12:55:33,323 : INFO : Epoch finished, average loss over training batches: 0.8151
2024-08-12 12:55:33,323 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:33,323 : INFO : Training metrics:
2024-08-12 12:55:33,323 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:33,330 : INFO : Accuracy: 0.6394
2024-08-12 12:55:33,330 : INFO : Precision score for label_class 0: 0.1624
2024-08-12 12:55:33,330 : INFO : Precision score for label_class 1: 0.7112
2024-08-12 12:55:33,330 : INFO : Precision score for label_class 2: 0.5048
2024-08-12 12:55:33,330 : INFO : Recall score for label_class 0: 0.0554
2024-08-12 12:55:33,330 : INFO : Recall score for label_class 1: 0.8676
2024-08-12 12:55:33,330 : INFO : Recall score for label_class 2: 0.4204
2024-08-12 12:55:33,330 : INFO : Average F1 score: 0.4410
2024-08-12 12:55:33,610 : INFO : Average loss over validation batches: 0.5729
2024-08-12 12:55:33,610 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:33,610 : INFO : Validation metrics:
2024-08-12 12:55:33,610 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:33,614 : INFO : Accuracy: 0.7733
2024-08-12 12:55:33,614 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:55:33,614 : INFO : Precision score for label_class 1: 0.8840
2024-08-12 12:55:33,614 : INFO : Precision score for label_class 2: 0.6074
2024-08-12 12:55:33,614 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:55:33,614 : INFO : Recall score for label_class 1: 0.8732
2024-08-12 12:55:33,614 : INFO : Recall score for label_class 2: 0.8454
2024-08-12 12:55:33,614 : INFO : Average F1 score: 0.5285
2024-08-12 12:55:33,614 : INFO : Validation metric decreased (inf --> 0.572942).  Saving model ...
2024-08-12 12:55:33,724 : INFO : Starting epoch 2
2024-08-12 12:55:34,372 : INFO : Current training batch loss: 0.5380 in epoch 2
2024-08-12 12:55:35,183 : INFO : Current training batch loss: 0.5358 in epoch 2
2024-08-12 12:55:35,993 : INFO : Current training batch loss: 0.3389 in epoch 2
2024-08-12 12:55:36,803 : INFO : Current training batch loss: 0.3281 in epoch 2
2024-08-12 12:55:37,150 : INFO : Epoch finished, average loss over training batches: 0.4354
2024-08-12 12:55:37,151 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:37,151 : INFO : Training metrics:
2024-08-12 12:55:37,151 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:37,159 : INFO : Accuracy: 0.8443
2024-08-12 12:55:37,159 : INFO : Precision score for label_class 0: 0.7152
2024-08-12 12:55:37,159 : INFO : Precision score for label_class 1: 0.8987
2024-08-12 12:55:37,159 : INFO : Precision score for label_class 2: 0.7799
2024-08-12 12:55:37,159 : INFO : Recall score for label_class 0: 0.6735
2024-08-12 12:55:37,159 : INFO : Recall score for label_class 1: 0.9200
2024-08-12 12:55:37,159 : INFO : Recall score for label_class 2: 0.7613
2024-08-12 12:55:37,159 : INFO : Average F1 score: 0.7911
2024-08-12 12:55:37,439 : INFO : Average loss over validation batches: 0.3917
2024-08-12 12:55:37,439 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:37,439 : INFO : Validation metrics:
2024-08-12 12:55:37,439 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:37,442 : INFO : Accuracy: 0.8607
2024-08-12 12:55:37,442 : INFO : Precision score for label_class 0: 0.7727
2024-08-12 12:55:37,442 : INFO : Precision score for label_class 1: 0.8741
2024-08-12 12:55:37,442 : INFO : Precision score for label_class 2: 0.8605
2024-08-12 12:55:37,442 : INFO : Recall score for label_class 0: 0.7183
2024-08-12 12:55:37,442 : INFO : Recall score for label_class 1: 0.9317
2024-08-12 12:55:37,442 : INFO : Recall score for label_class 2: 0.7629
2024-08-12 12:55:37,442 : INFO : Average F1 score: 0.8184
2024-08-12 12:55:37,442 : INFO : Validation metric decreased (0.572942 --> 0.391729).  Saving model ...
2024-08-12 12:55:37,543 : INFO : Starting epoch 3
2024-08-12 12:55:37,990 : INFO : Current training batch loss: 0.1952 in epoch 3
2024-08-12 12:55:38,800 : INFO : Current training batch loss: 0.2474 in epoch 3
2024-08-12 12:55:39,611 : INFO : Current training batch loss: 0.3285 in epoch 3
2024-08-12 12:55:40,422 : INFO : Current training batch loss: 0.1270 in epoch 3
2024-08-12 12:55:40,972 : INFO : Epoch finished, average loss over training batches: 0.2335
2024-08-12 12:55:40,972 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:40,972 : INFO : Training metrics:
2024-08-12 12:55:40,972 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:40,979 : INFO : Accuracy: 0.9255
2024-08-12 12:55:40,979 : INFO : Precision score for label_class 0: 0.8324
2024-08-12 12:55:40,979 : INFO : Precision score for label_class 1: 0.9539
2024-08-12 12:55:40,979 : INFO : Precision score for label_class 2: 0.9093
2024-08-12 12:55:40,980 : INFO : Recall score for label_class 0: 0.8834
2024-08-12 12:55:40,980 : INFO : Recall score for label_class 1: 0.9569
2024-08-12 12:55:40,980 : INFO : Recall score for label_class 2: 0.8780
2024-08-12 12:55:40,980 : INFO : Average F1 score: 0.9020
2024-08-12 12:55:41,260 : INFO : Average loss over validation batches: 0.4541
2024-08-12 12:55:41,260 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:41,260 : INFO : Validation metrics:
2024-08-12 12:55:41,260 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:41,263 : INFO : Accuracy: 0.8370
2024-08-12 12:55:41,263 : INFO : Precision score for label_class 0: 0.7468
2024-08-12 12:55:41,263 : INFO : Precision score for label_class 1: 0.9212
2024-08-12 12:55:41,263 : INFO : Precision score for label_class 2: 0.7325
2024-08-12 12:55:41,263 : INFO : Recall score for label_class 0: 0.8310
2024-08-12 12:55:41,263 : INFO : Recall score for label_class 1: 0.8268
2024-08-12 12:55:41,263 : INFO : Recall score for label_class 2: 0.8608
2024-08-12 12:55:41,263 : INFO : Average F1 score: 0.8165
2024-08-12 12:55:41,263 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 12:55:41,263 : INFO : Starting epoch 4
2024-08-12 12:55:41,507 : INFO : Current training batch loss: 0.2752 in epoch 4
2024-08-12 12:55:42,318 : INFO : Current training batch loss: 0.0739 in epoch 4
2024-08-12 12:55:43,128 : INFO : Current training batch loss: 0.1861 in epoch 4
2024-08-12 12:55:43,939 : INFO : Current training batch loss: 0.0947 in epoch 4
2024-08-12 12:55:44,692 : INFO : Epoch finished, average loss over training batches: 0.1431
2024-08-12 12:55:44,692 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:44,692 : INFO : Training metrics:
2024-08-12 12:55:44,692 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:44,699 : INFO : Accuracy: 0.9570
2024-08-12 12:55:44,699 : INFO : Precision score for label_class 0: 0.8895
2024-08-12 12:55:44,699 : INFO : Precision score for label_class 1: 0.9756
2024-08-12 12:55:44,699 : INFO : Precision score for label_class 2: 0.9507
2024-08-12 12:55:44,699 : INFO : Recall score for label_class 0: 0.9621
2024-08-12 12:55:44,699 : INFO : Recall score for label_class 1: 0.9731
2024-08-12 12:55:44,699 : INFO : Recall score for label_class 2: 0.9204
2024-08-12 12:55:44,699 : INFO : Average F1 score: 0.9447
2024-08-12 12:55:44,979 : INFO : Average loss over validation batches: 0.3763
2024-08-12 12:55:44,980 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:44,980 : INFO : Validation metrics:
2024-08-12 12:55:44,980 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:44,983 : INFO : Accuracy: 0.8756
2024-08-12 12:55:44,984 : INFO : Precision score for label_class 0: 0.7922
2024-08-12 12:55:44,984 : INFO : Precision score for label_class 1: 0.9017
2024-08-12 12:55:44,984 : INFO : Precision score for label_class 2: 0.8508
2024-08-12 12:55:44,984 : INFO : Recall score for label_class 0: 0.8592
2024-08-12 12:55:44,984 : INFO : Recall score for label_class 1: 0.9171
2024-08-12 12:55:44,984 : INFO : Recall score for label_class 2: 0.7938
2024-08-12 12:55:44,984 : INFO : Average F1 score: 0.8517
2024-08-12 12:55:44,984 : INFO : Validation metric decreased (0.391729 --> 0.376262).  Saving model ...
2024-08-12 12:55:45,082 : INFO : Starting epoch 5
2024-08-12 12:55:45,125 : INFO : Current training batch loss: 0.0291 in epoch 5
2024-08-12 12:55:45,935 : INFO : Current training batch loss: 0.2474 in epoch 5
2024-08-12 12:55:46,747 : INFO : Current training batch loss: 0.0298 in epoch 5
2024-08-12 12:55:47,558 : INFO : Current training batch loss: 0.0190 in epoch 5
2024-08-12 12:55:48,369 : INFO : Current training batch loss: 0.0387 in epoch 5
2024-08-12 12:55:48,515 : INFO : Epoch finished, average loss over training batches: 0.0831
2024-08-12 12:55:48,515 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:48,515 : INFO : Training metrics:
2024-08-12 12:55:48,515 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:48,525 : INFO : Accuracy: 0.9755
2024-08-12 12:55:48,525 : INFO : Precision score for label_class 0: 0.9169
2024-08-12 12:55:48,525 : INFO : Precision score for label_class 1: 0.9900
2024-08-12 12:55:48,525 : INFO : Precision score for label_class 2: 0.9730
2024-08-12 12:55:48,525 : INFO : Recall score for label_class 0: 0.9650
2024-08-12 12:55:48,525 : INFO : Recall score for label_class 1: 0.9869
2024-08-12 12:55:48,525 : INFO : Recall score for label_class 2: 0.9562
2024-08-12 12:55:48,525 : INFO : Average F1 score: 0.9644
2024-08-12 12:55:48,805 : INFO : Average loss over validation batches: 0.4347
2024-08-12 12:55:48,806 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:48,806 : INFO : Validation metrics:
2024-08-12 12:55:48,806 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:48,809 : INFO : Accuracy: 0.8667
2024-08-12 12:55:48,809 : INFO : Precision score for label_class 0: 0.8060
2024-08-12 12:55:48,809 : INFO : Precision score for label_class 1: 0.8782
2024-08-12 12:55:48,809 : INFO : Precision score for label_class 2: 0.8613
2024-08-12 12:55:48,809 : INFO : Recall score for label_class 0: 0.7606
2024-08-12 12:55:48,809 : INFO : Recall score for label_class 1: 0.9317
2024-08-12 12:55:48,809 : INFO : Recall score for label_class 2: 0.7680
2024-08-12 12:55:48,809 : INFO : Average F1 score: 0.8329
2024-08-12 12:55:48,809 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 12:55:48,809 : INFO : Starting epoch 6
2024-08-12 12:55:49,458 : INFO : Current training batch loss: 0.0184 in epoch 6
2024-08-12 12:55:50,269 : INFO : Current training batch loss: 0.0168 in epoch 6
2024-08-12 12:55:51,079 : INFO : Current training batch loss: 0.0132 in epoch 6
2024-08-12 12:55:51,890 : INFO : Current training batch loss: 0.0114 in epoch 6
2024-08-12 12:55:52,238 : INFO : Epoch finished, average loss over training batches: 0.0479
2024-08-12 12:55:52,238 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:52,238 : INFO : Training metrics:
2024-08-12 12:55:52,238 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:52,245 : INFO : Accuracy: 0.9863
2024-08-12 12:55:52,245 : INFO : Precision score for label_class 0: 0.9468
2024-08-12 12:55:52,245 : INFO : Precision score for label_class 1: 0.9938
2024-08-12 12:55:52,245 : INFO : Precision score for label_class 2: 0.9892
2024-08-12 12:55:52,245 : INFO : Recall score for label_class 0: 0.9854
2024-08-12 12:55:52,245 : INFO : Recall score for label_class 1: 0.9944
2024-08-12 12:55:52,245 : INFO : Recall score for label_class 2: 0.9695
2024-08-12 12:55:52,245 : INFO : Average F1 score: 0.9797
2024-08-12 12:55:52,525 : INFO : Average loss over validation batches: 0.4591
2024-08-12 12:55:52,525 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:52,525 : INFO : Validation metrics:
2024-08-12 12:55:52,525 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:52,529 : INFO : Accuracy: 0.8696
2024-08-12 12:55:52,529 : INFO : Precision score for label_class 0: 0.8056
2024-08-12 12:55:52,529 : INFO : Precision score for label_class 1: 0.8819
2024-08-12 12:55:52,529 : INFO : Precision score for label_class 2: 0.8655
2024-08-12 12:55:52,529 : INFO : Recall score for label_class 0: 0.8169
2024-08-12 12:55:52,529 : INFO : Recall score for label_class 1: 0.9293
2024-08-12 12:55:52,529 : INFO : Recall score for label_class 2: 0.7629
2024-08-12 12:55:52,529 : INFO : Average F1 score: 0.8424
2024-08-12 12:55:52,529 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 12:55:52,529 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:55:52,567 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 12:55:52,876 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:52,877 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 12:55:52,877 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:52,880 : INFO : Accuracy: 0.8756
2024-08-12 12:55:52,880 : INFO : Precision score for label_class 0: 0.7922
2024-08-12 12:55:52,881 : INFO : Precision score for label_class 1: 0.9017
2024-08-12 12:55:52,881 : INFO : Precision score for label_class 2: 0.8508
2024-08-12 12:55:52,881 : INFO : Recall score for label_class 0: 0.8592
2024-08-12 12:55:52,881 : INFO : Recall score for label_class 1: 0.9171
2024-08-12 12:55:52,881 : INFO : Recall score for label_class 2: 0.7938
2024-08-12 12:55:52,881 : INFO : Average F1 score: 0.8517
2024-08-12 12:55:52,881 : INFO : Determined score from best model, ending training.
2024-08-12 12:55:52,887 : INFO : Split 2 is finished, the score is: 0.8517
2024-08-12 12:55:52,887 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:52,888 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:52,888 : INFO : Starting training for split 3
2024-08-12 12:55:52,899 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 328, 1611,  759]))
2024-08-12 12:55:52,901 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 86, 400, 189]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:55:52,951 : INFO : Starting epoch 1
2024-08-12 12:55:52,993 : INFO : Current training batch loss: 1.1210 in epoch 1
2024-08-12 12:55:53,803 : INFO : Current training batch loss: 1.0058 in epoch 1
2024-08-12 12:55:54,614 : INFO : Current training batch loss: 0.7179 in epoch 1
2024-08-12 12:55:55,425 : INFO : Current training batch loss: 0.8928 in epoch 1
2024-08-12 12:55:56,235 : INFO : Current training batch loss: 0.7237 in epoch 1
2024-08-12 12:55:56,381 : INFO : Epoch finished, average loss over training batches: 0.8044
2024-08-12 12:55:56,381 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:56,381 : INFO : Training metrics:
2024-08-12 12:55:56,381 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:56,385 : INFO : Accuracy: 0.6394
2024-08-12 12:55:56,385 : INFO : Precision score for label_class 0: 0.6727
2024-08-12 12:55:56,385 : INFO : Precision score for label_class 1: 0.7163
2024-08-12 12:55:56,385 : INFO : Precision score for label_class 2: 0.4563
2024-08-12 12:55:56,385 : INFO : Recall score for label_class 0: 0.1128
2024-08-12 12:55:56,385 : INFO : Recall score for label_class 1: 0.8243
2024-08-12 12:55:56,385 : INFO : Recall score for label_class 2: 0.4743
2024-08-12 12:55:56,385 : INFO : Average F1 score: 0.4750
2024-08-12 12:55:56,665 : INFO : Average loss over validation batches: 0.4954
2024-08-12 12:55:56,665 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:56,665 : INFO : Validation metrics:
2024-08-12 12:55:56,665 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:55:56,668 : INFO : Accuracy: 0.8193
2024-08-12 12:55:56,668 : INFO : Precision score for label_class 0: 0.7590
2024-08-12 12:55:56,668 : INFO : Precision score for label_class 1: 0.8932
2024-08-12 12:55:56,668 : INFO : Precision score for label_class 2: 0.7067
2024-08-12 12:55:56,668 : INFO : Recall score for label_class 0: 0.7326
2024-08-12 12:55:56,668 : INFO : Recall score for label_class 1: 0.8575
2024-08-12 12:55:56,668 : INFO : Recall score for label_class 2: 0.7778
2024-08-12 12:55:56,668 : INFO : Average F1 score: 0.7870
2024-08-12 12:55:56,668 : INFO : Validation metric decreased (inf --> 0.495442).  Saving model ...
2024-08-12 12:55:56,778 : INFO : Starting epoch 2
2024-08-12 12:55:57,426 : INFO : Current training batch loss: 0.4848 in epoch 2
2024-08-12 12:55:58,237 : INFO : Current training batch loss: 0.3568 in epoch 2
2024-08-12 12:55:59,047 : INFO : Current training batch loss: 0.4234 in epoch 2
2024-08-12 12:55:59,858 : INFO : Current training batch loss: 0.3080 in epoch 2
2024-08-12 12:56:00,205 : INFO : Epoch finished, average loss over training batches: 0.3900
2024-08-12 12:56:00,206 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:00,206 : INFO : Training metrics:
2024-08-12 12:56:00,206 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:00,209 : INFO : Accuracy: 0.8666
2024-08-12 12:56:00,210 : INFO : Precision score for label_class 0: 0.7915
2024-08-12 12:56:00,210 : INFO : Precision score for label_class 1: 0.8983
2024-08-12 12:56:00,210 : INFO : Precision score for label_class 2: 0.8290
2024-08-12 12:56:00,210 : INFO : Recall score for label_class 0: 0.7988
2024-08-12 12:56:00,210 : INFO : Recall score for label_class 1: 0.9156
2024-08-12 12:56:00,210 : INFO : Recall score for label_class 2: 0.7918
2024-08-12 12:56:00,210 : INFO : Average F1 score: 0.8373
2024-08-12 12:56:00,490 : INFO : Average loss over validation batches: 0.3878
2024-08-12 12:56:00,490 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:00,490 : INFO : Validation metrics:
2024-08-12 12:56:00,490 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:00,493 : INFO : Accuracy: 0.8607
2024-08-12 12:56:00,493 : INFO : Precision score for label_class 0: 0.7935
2024-08-12 12:56:00,493 : INFO : Precision score for label_class 1: 0.8881
2024-08-12 12:56:00,493 : INFO : Precision score for label_class 2: 0.8282
2024-08-12 12:56:00,493 : INFO : Recall score for label_class 0: 0.8488
2024-08-12 12:56:00,493 : INFO : Recall score for label_class 1: 0.9325
2024-08-12 12:56:00,493 : INFO : Recall score for label_class 2: 0.7143
2024-08-12 12:56:00,493 : INFO : Average F1 score: 0.8323
2024-08-12 12:56:00,493 : INFO : Validation metric decreased (0.495442 --> 0.387786).  Saving model ...
2024-08-12 12:56:00,593 : INFO : Starting epoch 3
2024-08-12 12:56:01,040 : INFO : Current training batch loss: 0.2411 in epoch 3
2024-08-12 12:56:01,850 : INFO : Current training batch loss: 0.2747 in epoch 3
2024-08-12 12:56:02,661 : INFO : Current training batch loss: 0.3314 in epoch 3
2024-08-12 12:56:03,472 : INFO : Current training batch loss: 0.0615 in epoch 3
2024-08-12 12:56:04,022 : INFO : Epoch finished, average loss over training batches: 0.2150
2024-08-12 12:56:04,022 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:04,022 : INFO : Training metrics:
2024-08-12 12:56:04,022 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:04,026 : INFO : Accuracy: 0.9325
2024-08-12 12:56:04,026 : INFO : Precision score for label_class 0: 0.8490
2024-08-12 12:56:04,026 : INFO : Precision score for label_class 1: 0.9595
2024-08-12 12:56:04,026 : INFO : Precision score for label_class 2: 0.9140
2024-08-12 12:56:04,026 : INFO : Recall score for label_class 0: 0.9085
2024-08-12 12:56:04,026 : INFO : Recall score for label_class 1: 0.9547
2024-08-12 12:56:04,026 : INFO : Recall score for label_class 2: 0.8959
2024-08-12 12:56:04,026 : INFO : Average F1 score: 0.9132
2024-08-12 12:56:04,307 : INFO : Average loss over validation batches: 0.4017
2024-08-12 12:56:04,307 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:04,307 : INFO : Validation metrics:
2024-08-12 12:56:04,307 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:04,309 : INFO : Accuracy: 0.8711
2024-08-12 12:56:04,310 : INFO : Precision score for label_class 0: 0.8085
2024-08-12 12:56:04,310 : INFO : Precision score for label_class 1: 0.8942
2024-08-12 12:56:04,310 : INFO : Precision score for label_class 2: 0.8485
2024-08-12 12:56:04,310 : INFO : Recall score for label_class 0: 0.8837
2024-08-12 12:56:04,310 : INFO : Recall score for label_class 1: 0.9300
2024-08-12 12:56:04,310 : INFO : Recall score for label_class 2: 0.7407
2024-08-12 12:56:04,310 : INFO : Average F1 score: 0.8491
2024-08-12 12:56:04,310 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 12:56:04,310 : INFO : Starting epoch 4
2024-08-12 12:56:04,553 : INFO : Current training batch loss: 0.4161 in epoch 4
2024-08-12 12:56:05,364 : INFO : Current training batch loss: 0.1706 in epoch 4
2024-08-12 12:56:06,175 : INFO : Current training batch loss: 0.2210 in epoch 4
2024-08-12 12:56:06,986 : INFO : Current training batch loss: 0.0640 in epoch 4
2024-08-12 12:56:07,738 : INFO : Epoch finished, average loss over training batches: 0.1265
2024-08-12 12:56:07,738 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:07,738 : INFO : Training metrics:
2024-08-12 12:56:07,738 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:07,742 : INFO : Accuracy: 0.9629
2024-08-12 12:56:07,742 : INFO : Precision score for label_class 0: 0.9054
2024-08-12 12:56:07,742 : INFO : Precision score for label_class 1: 0.9765
2024-08-12 12:56:07,742 : INFO : Precision score for label_class 2: 0.9605
2024-08-12 12:56:07,742 : INFO : Recall score for label_class 0: 0.9634
2024-08-12 12:56:07,742 : INFO : Recall score for label_class 1: 0.9783
2024-08-12 12:56:07,742 : INFO : Recall score for label_class 2: 0.9302
2024-08-12 12:56:07,742 : INFO : Average F1 score: 0.9520
2024-08-12 12:56:08,022 : INFO : Average loss over validation batches: 0.4020
2024-08-12 12:56:08,022 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:08,022 : INFO : Validation metrics:
2024-08-12 12:56:08,022 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:08,025 : INFO : Accuracy: 0.8593
2024-08-12 12:56:08,025 : INFO : Precision score for label_class 0: 0.8765
2024-08-12 12:56:08,025 : INFO : Precision score for label_class 1: 0.9193
2024-08-12 12:56:08,025 : INFO : Precision score for label_class 2: 0.7429
2024-08-12 12:56:08,025 : INFO : Recall score for label_class 0: 0.8256
2024-08-12 12:56:08,025 : INFO : Recall score for label_class 1: 0.8825
2024-08-12 12:56:08,025 : INFO : Recall score for label_class 2: 0.8254
2024-08-12 12:56:08,025 : INFO : Average F1 score: 0.8443
2024-08-12 12:56:08,025 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 12:56:08,025 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:56:08,062 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 12:56:08,379 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:08,379 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 12:56:08,379 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:08,382 : INFO : Accuracy: 0.8607
2024-08-12 12:56:08,382 : INFO : Precision score for label_class 0: 0.7935
2024-08-12 12:56:08,382 : INFO : Precision score for label_class 1: 0.8881
2024-08-12 12:56:08,382 : INFO : Precision score for label_class 2: 0.8282
2024-08-12 12:56:08,382 : INFO : Recall score for label_class 0: 0.8488
2024-08-12 12:56:08,382 : INFO : Recall score for label_class 1: 0.9325
2024-08-12 12:56:08,382 : INFO : Recall score for label_class 2: 0.7143
2024-08-12 12:56:08,382 : INFO : Average F1 score: 0.8323
2024-08-12 12:56:08,382 : INFO : Determined score from best model, ending training.
2024-08-12 12:56:08,383 : INFO : Split 3 is finished, the score is: 0.8323
2024-08-12 12:56:08,384 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:08,384 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:08,384 : INFO : Starting training for split 4
2024-08-12 12:56:08,400 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 327, 1621,  751]))
2024-08-12 12:56:08,402 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 87, 390, 197]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:56:08,452 : INFO : Starting epoch 1
2024-08-12 12:56:08,495 : INFO : Current training batch loss: 1.0845 in epoch 1
2024-08-12 12:56:09,305 : INFO : Current training batch loss: 1.0055 in epoch 1
2024-08-12 12:56:10,116 : INFO : Current training batch loss: 0.7477 in epoch 1
2024-08-12 12:56:10,927 : INFO : Current training batch loss: 0.5708 in epoch 1
2024-08-12 12:56:11,737 : INFO : Current training batch loss: 0.5730 in epoch 1
2024-08-12 12:56:11,883 : INFO : Epoch finished, average loss over training batches: 0.8046
2024-08-12 12:56:11,883 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:11,883 : INFO : Training metrics:
2024-08-12 12:56:11,883 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:11,891 : INFO : Accuracy: 0.6743
2024-08-12 12:56:11,891 : INFO : Precision score for label_class 0: 0.2545
2024-08-12 12:56:11,891 : INFO : Precision score for label_class 1: 0.7152
2024-08-12 12:56:11,891 : INFO : Precision score for label_class 2: 0.5526
2024-08-12 12:56:11,891 : INFO : Recall score for label_class 0: 0.0428
2024-08-12 12:56:11,891 : INFO : Recall score for label_class 1: 0.9358
2024-08-12 12:56:11,891 : INFO : Recall score for label_class 2: 0.3848
2024-08-12 12:56:11,891 : INFO : Average F1 score: 0.4459
2024-08-12 12:56:12,171 : INFO : Average loss over validation batches: 0.5908
2024-08-12 12:56:12,171 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:12,171 : INFO : Validation metrics:
2024-08-12 12:56:12,171 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:12,175 : INFO : Accuracy: 0.7567
2024-08-12 12:56:12,175 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:56:12,175 : INFO : Precision score for label_class 1: 0.8759
2024-08-12 12:56:12,175 : INFO : Precision score for label_class 2: 0.5878
2024-08-12 12:56:12,175 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:56:12,175 : INFO : Recall score for label_class 1: 0.8872
2024-08-12 12:56:12,175 : INFO : Recall score for label_class 2: 0.8325
2024-08-12 12:56:12,175 : INFO : Average F1 score: 0.5235
2024-08-12 12:56:12,175 : INFO : Validation metric decreased (inf --> 0.590845).  Saving model ...
2024-08-12 12:56:12,282 : INFO : Starting epoch 2
2024-08-12 12:56:12,931 : INFO : Current training batch loss: 0.6517 in epoch 2
2024-08-12 12:56:13,741 : INFO : Current training batch loss: 0.3650 in epoch 2
2024-08-12 12:56:14,551 : INFO : Current training batch loss: 0.2615 in epoch 2
2024-08-12 12:56:15,362 : INFO : Current training batch loss: 0.3140 in epoch 2
2024-08-12 12:56:15,710 : INFO : Epoch finished, average loss over training batches: 0.4287
2024-08-12 12:56:15,710 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:15,710 : INFO : Training metrics:
2024-08-12 12:56:15,710 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:15,714 : INFO : Accuracy: 0.8448
2024-08-12 12:56:15,714 : INFO : Precision score for label_class 0: 0.7803
2024-08-12 12:56:15,714 : INFO : Precision score for label_class 1: 0.8927
2024-08-12 12:56:15,714 : INFO : Precision score for label_class 2: 0.7627
2024-08-12 12:56:15,714 : INFO : Recall score for label_class 0: 0.6300
2024-08-12 12:56:15,714 : INFO : Recall score for label_class 1: 0.9186
2024-08-12 12:56:15,714 : INFO : Recall score for label_class 2: 0.7790
2024-08-12 12:56:15,714 : INFO : Average F1 score: 0.7911
2024-08-12 12:56:15,994 : INFO : Average loss over validation batches: 0.4033
2024-08-12 12:56:15,994 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:15,994 : INFO : Validation metrics:
2024-08-12 12:56:15,994 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:15,997 : INFO : Accuracy: 0.8605
2024-08-12 12:56:15,997 : INFO : Precision score for label_class 0: 0.8382
2024-08-12 12:56:15,997 : INFO : Precision score for label_class 1: 0.8914
2024-08-12 12:56:15,997 : INFO : Precision score for label_class 2: 0.8060
2024-08-12 12:56:15,997 : INFO : Recall score for label_class 0: 0.6552
2024-08-12 12:56:15,997 : INFO : Recall score for label_class 1: 0.9256
2024-08-12 12:56:15,997 : INFO : Recall score for label_class 2: 0.8223
2024-08-12 12:56:15,997 : INFO : Average F1 score: 0.8192
2024-08-12 12:56:15,997 : INFO : Validation metric decreased (0.590845 --> 0.403317).  Saving model ...
2024-08-12 12:56:16,098 : INFO : Starting epoch 3
2024-08-12 12:56:16,545 : INFO : Current training batch loss: 0.2521 in epoch 3
2024-08-12 12:56:17,355 : INFO : Current training batch loss: 0.3803 in epoch 3
2024-08-12 12:56:18,166 : INFO : Current training batch loss: 0.1316 in epoch 3
2024-08-12 12:56:18,977 : INFO : Current training batch loss: 0.0498 in epoch 3
2024-08-12 12:56:19,527 : INFO : Epoch finished, average loss over training batches: 0.2311
2024-08-12 12:56:19,527 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:19,527 : INFO : Training metrics:
2024-08-12 12:56:19,527 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:19,531 : INFO : Accuracy: 0.9226
2024-08-12 12:56:19,531 : INFO : Precision score for label_class 0: 0.8444
2024-08-12 12:56:19,531 : INFO : Precision score for label_class 1: 0.9535
2024-08-12 12:56:19,531 : INFO : Precision score for label_class 2: 0.8916
2024-08-12 12:56:19,531 : INFO : Recall score for label_class 0: 0.8960
2024-08-12 12:56:19,531 : INFO : Recall score for label_class 1: 0.9494
2024-08-12 12:56:19,531 : INFO : Recall score for label_class 2: 0.8762
2024-08-12 12:56:19,531 : INFO : Average F1 score: 0.9016
2024-08-12 12:56:19,811 : INFO : Average loss over validation batches: 0.3970
2024-08-12 12:56:19,811 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:19,811 : INFO : Validation metrics:
2024-08-12 12:56:19,811 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:19,814 : INFO : Accuracy: 0.8546
2024-08-12 12:56:19,814 : INFO : Precision score for label_class 0: 0.8118
2024-08-12 12:56:19,814 : INFO : Precision score for label_class 1: 0.8941
2024-08-12 12:56:19,814 : INFO : Precision score for label_class 2: 0.7970
2024-08-12 12:56:19,814 : INFO : Recall score for label_class 0: 0.7931
2024-08-12 12:56:19,814 : INFO : Recall score for label_class 1: 0.8872
2024-08-12 12:56:19,814 : INFO : Recall score for label_class 2: 0.8173
2024-08-12 12:56:19,814 : INFO : Average F1 score: 0.8333
2024-08-12 12:56:19,814 : INFO : Validation metric decreased (0.403317 --> 0.396956).  Saving model ...
2024-08-12 12:56:19,917 : INFO : Starting epoch 4
2024-08-12 12:56:20,161 : INFO : Current training batch loss: 0.3056 in epoch 4
2024-08-12 12:56:20,971 : INFO : Current training batch loss: 0.2095 in epoch 4
2024-08-12 12:56:21,781 : INFO : Current training batch loss: 0.1675 in epoch 4
2024-08-12 12:56:22,592 : INFO : Current training batch loss: 0.2337 in epoch 4
2024-08-12 12:56:23,344 : INFO : Epoch finished, average loss over training batches: 0.1303
2024-08-12 12:56:23,344 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:23,344 : INFO : Training metrics:
2024-08-12 12:56:23,344 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:23,348 : INFO : Accuracy: 0.9578
2024-08-12 12:56:23,348 : INFO : Precision score for label_class 0: 0.8941
2024-08-12 12:56:23,348 : INFO : Precision score for label_class 1: 0.9777
2024-08-12 12:56:23,348 : INFO : Precision score for label_class 2: 0.9438
2024-08-12 12:56:23,348 : INFO : Recall score for label_class 0: 0.9297
2024-08-12 12:56:23,348 : INFO : Recall score for label_class 1: 0.9722
2024-08-12 12:56:23,348 : INFO : Recall score for label_class 2: 0.9387
2024-08-12 12:56:23,348 : INFO : Average F1 score: 0.9426
2024-08-12 12:56:23,628 : INFO : Average loss over validation batches: 0.4451
2024-08-12 12:56:23,628 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:23,628 : INFO : Validation metrics:
2024-08-12 12:56:23,628 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:23,631 : INFO : Accuracy: 0.8576
2024-08-12 12:56:23,631 : INFO : Precision score for label_class 0: 0.8000
2024-08-12 12:56:23,631 : INFO : Precision score for label_class 1: 0.8946
2024-08-12 12:56:23,631 : INFO : Precision score for label_class 2: 0.8103
2024-08-12 12:56:23,631 : INFO : Recall score for label_class 0: 0.8276
2024-08-12 12:56:23,631 : INFO : Recall score for label_class 1: 0.8923
2024-08-12 12:56:23,631 : INFO : Recall score for label_class 2: 0.8020
2024-08-12 12:56:23,631 : INFO : Average F1 score: 0.8377
2024-08-12 12:56:23,631 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 12:56:23,631 : INFO : Starting epoch 5
2024-08-12 12:56:23,673 : INFO : Current training batch loss: 0.0414 in epoch 5
2024-08-12 12:56:24,484 : INFO : Current training batch loss: 0.1509 in epoch 5
2024-08-12 12:56:25,294 : INFO : Current training batch loss: 0.0281 in epoch 5
2024-08-12 12:56:26,105 : INFO : Current training batch loss: 0.0328 in epoch 5
2024-08-12 12:56:26,916 : INFO : Current training batch loss: 0.0176 in epoch 5
2024-08-12 12:56:27,061 : INFO : Epoch finished, average loss over training batches: 0.0762
2024-08-12 12:56:27,061 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:27,061 : INFO : Training metrics:
2024-08-12 12:56:27,061 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:27,066 : INFO : Accuracy: 0.9811
2024-08-12 12:56:27,066 : INFO : Precision score for label_class 0: 0.9607
2024-08-12 12:56:27,066 : INFO : Precision score for label_class 1: 0.9895
2024-08-12 12:56:27,066 : INFO : Precision score for label_class 2: 0.9720
2024-08-12 12:56:27,066 : INFO : Recall score for label_class 0: 0.9725
2024-08-12 12:56:27,066 : INFO : Recall score for label_class 1: 0.9870
2024-08-12 12:56:27,066 : INFO : Recall score for label_class 2: 0.9720
2024-08-12 12:56:27,066 : INFO : Average F1 score: 0.9756
2024-08-12 12:56:27,346 : INFO : Average loss over validation batches: 0.4937
2024-08-12 12:56:27,346 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:27,346 : INFO : Validation metrics:
2024-08-12 12:56:27,346 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:27,349 : INFO : Accuracy: 0.8516
2024-08-12 12:56:27,349 : INFO : Precision score for label_class 0: 0.7447
2024-08-12 12:56:27,349 : INFO : Precision score for label_class 1: 0.9167
2024-08-12 12:56:27,349 : INFO : Precision score for label_class 2: 0.7837
2024-08-12 12:56:27,349 : INFO : Recall score for label_class 0: 0.8046
2024-08-12 12:56:27,349 : INFO : Recall score for label_class 1: 0.8744
2024-08-12 12:56:27,349 : INFO : Recall score for label_class 2: 0.8274
2024-08-12 12:56:27,349 : INFO : Average F1 score: 0.8245
2024-08-12 12:56:27,350 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 12:56:27,350 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:56:27,387 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 12:56:27,702 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:27,702 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 12:56:27,702 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:27,705 : INFO : Accuracy: 0.8546
2024-08-12 12:56:27,705 : INFO : Precision score for label_class 0: 0.8118
2024-08-12 12:56:27,705 : INFO : Precision score for label_class 1: 0.8941
2024-08-12 12:56:27,706 : INFO : Precision score for label_class 2: 0.7970
2024-08-12 12:56:27,706 : INFO : Recall score for label_class 0: 0.7931
2024-08-12 12:56:27,706 : INFO : Recall score for label_class 1: 0.8872
2024-08-12 12:56:27,706 : INFO : Recall score for label_class 2: 0.8173
2024-08-12 12:56:27,706 : INFO : Average F1 score: 0.8333
2024-08-12 12:56:27,706 : INFO : Determined score from best model, ending training.
2024-08-12 12:56:27,707 : INFO : Split 4 is finished, the score is: 0.8333
2024-08-12 12:56:27,707 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:27,707 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:27,707 : INFO : Starting training for split 5
2024-08-12 12:56:27,718 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 330, 1615,  754]))
2024-08-12 12:56:27,720 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 84, 396, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:56:27,759 : INFO : Starting epoch 1
2024-08-12 12:56:27,801 : INFO : Current training batch loss: 1.0946 in epoch 1
2024-08-12 12:56:28,617 : INFO : Current training batch loss: 1.0023 in epoch 1
2024-08-12 12:56:29,428 : INFO : Current training batch loss: 0.7063 in epoch 1
2024-08-12 12:56:30,238 : INFO : Current training batch loss: 0.6230 in epoch 1
2024-08-12 12:56:31,049 : INFO : Current training batch loss: 0.6928 in epoch 1
2024-08-12 12:56:31,194 : INFO : Epoch finished, average loss over training batches: 0.7988
2024-08-12 12:56:31,194 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:31,194 : INFO : Training metrics:
2024-08-12 12:56:31,194 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:31,205 : INFO : Accuracy: 0.6695
2024-08-12 12:56:31,205 : INFO : Precision score for label_class 0: 0.3125
2024-08-12 12:56:31,205 : INFO : Precision score for label_class 1: 0.7081
2024-08-12 12:56:31,205 : INFO : Precision score for label_class 2: 0.5828
2024-08-12 12:56:31,205 : INFO : Recall score for label_class 0: 0.1061
2024-08-12 12:56:31,205 : INFO : Recall score for label_class 1: 0.9251
2024-08-12 12:56:31,205 : INFO : Recall score for label_class 2: 0.3687
2024-08-12 12:56:31,205 : INFO : Average F1 score: 0.4707
2024-08-12 12:56:31,486 : INFO : Average loss over validation batches: 0.5209
2024-08-12 12:56:31,486 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:31,486 : INFO : Validation metrics:
2024-08-12 12:56:31,486 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:31,490 : INFO : Accuracy: 0.8249
2024-08-12 12:56:31,490 : INFO : Precision score for label_class 0: 0.7108
2024-08-12 12:56:31,490 : INFO : Precision score for label_class 1: 0.8753
2024-08-12 12:56:31,490 : INFO : Precision score for label_class 2: 0.7637
2024-08-12 12:56:31,490 : INFO : Recall score for label_class 0: 0.7024
2024-08-12 12:56:31,490 : INFO : Recall score for label_class 1: 0.9040
2024-08-12 12:56:31,490 : INFO : Recall score for label_class 2: 0.7165
2024-08-12 12:56:31,490 : INFO : Average F1 score: 0.7785
2024-08-12 12:56:31,490 : INFO : Validation metric decreased (inf --> 0.520918).  Saving model ...
2024-08-12 12:56:31,599 : INFO : Starting epoch 2
2024-08-12 12:56:32,248 : INFO : Current training batch loss: 0.4213 in epoch 2
2024-08-12 12:56:33,058 : INFO : Current training batch loss: 0.3765 in epoch 2
2024-08-12 12:56:33,868 : INFO : Current training batch loss: 0.2982 in epoch 2
2024-08-12 12:56:34,679 : INFO : Current training batch loss: 0.5384 in epoch 2
2024-08-12 12:56:35,027 : INFO : Epoch finished, average loss over training batches: 0.3936
2024-08-12 12:56:35,027 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:35,028 : INFO : Training metrics:
2024-08-12 12:56:35,028 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:35,034 : INFO : Accuracy: 0.8618
2024-08-12 12:56:35,035 : INFO : Precision score for label_class 0: 0.7900
2024-08-12 12:56:35,035 : INFO : Precision score for label_class 1: 0.8975
2024-08-12 12:56:35,035 : INFO : Precision score for label_class 2: 0.8114
2024-08-12 12:56:35,035 : INFO : Recall score for label_class 0: 0.7636
2024-08-12 12:56:35,035 : INFO : Recall score for label_class 1: 0.9220
2024-08-12 12:56:35,035 : INFO : Recall score for label_class 2: 0.7759
2024-08-12 12:56:35,035 : INFO : Average F1 score: 0.8265
2024-08-12 12:56:35,315 : INFO : Average loss over validation batches: 0.4144
2024-08-12 12:56:35,315 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:35,315 : INFO : Validation metrics:
2024-08-12 12:56:35,315 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:35,319 : INFO : Accuracy: 0.8576
2024-08-12 12:56:35,319 : INFO : Precision score for label_class 0: 0.7500
2024-08-12 12:56:35,319 : INFO : Precision score for label_class 1: 0.8822
2024-08-12 12:56:35,319 : INFO : Precision score for label_class 2: 0.8554
2024-08-12 12:56:35,319 : INFO : Recall score for label_class 0: 0.8214
2024-08-12 12:56:35,319 : INFO : Recall score for label_class 1: 0.9268
2024-08-12 12:56:35,319 : INFO : Recall score for label_class 2: 0.7320
2024-08-12 12:56:35,319 : INFO : Average F1 score: 0.8256
2024-08-12 12:56:35,319 : INFO : Validation metric decreased (0.520918 --> 0.414402).  Saving model ...
2024-08-12 12:56:35,417 : INFO : Starting epoch 3
2024-08-12 12:56:35,863 : INFO : Current training batch loss: 0.2051 in epoch 3
2024-08-12 12:56:36,674 : INFO : Current training batch loss: 0.2179 in epoch 3
2024-08-12 12:56:37,485 : INFO : Current training batch loss: 0.1729 in epoch 3
2024-08-12 12:56:38,295 : INFO : Current training batch loss: 0.0881 in epoch 3
2024-08-12 12:56:38,845 : INFO : Epoch finished, average loss over training batches: 0.2056
2024-08-12 12:56:38,845 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:38,845 : INFO : Training metrics:
2024-08-12 12:56:38,845 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:38,852 : INFO : Accuracy: 0.9359
2024-08-12 12:56:38,852 : INFO : Precision score for label_class 0: 0.8739
2024-08-12 12:56:38,852 : INFO : Precision score for label_class 1: 0.9608
2024-08-12 12:56:38,852 : INFO : Precision score for label_class 2: 0.9107
2024-08-12 12:56:38,852 : INFO : Recall score for label_class 0: 0.9030
2024-08-12 12:56:38,852 : INFO : Recall score for label_class 1: 0.9567
2024-08-12 12:56:38,852 : INFO : Recall score for label_class 2: 0.9058
2024-08-12 12:56:38,852 : INFO : Average F1 score: 0.9184
2024-08-12 12:56:39,133 : INFO : Average loss over validation batches: 0.4231
2024-08-12 12:56:39,133 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:39,133 : INFO : Validation metrics:
2024-08-12 12:56:39,133 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:39,137 : INFO : Accuracy: 0.8561
2024-08-12 12:56:39,137 : INFO : Precision score for label_class 0: 0.7927
2024-08-12 12:56:39,137 : INFO : Precision score for label_class 1: 0.8892
2024-08-12 12:56:39,137 : INFO : Precision score for label_class 2: 0.8118
2024-08-12 12:56:39,137 : INFO : Recall score for label_class 0: 0.7738
2024-08-12 12:56:39,137 : INFO : Recall score for label_class 1: 0.9116
2024-08-12 12:56:39,137 : INFO : Recall score for label_class 2: 0.7784
2024-08-12 12:56:39,137 : INFO : Average F1 score: 0.8260
2024-08-12 12:56:39,137 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 12:56:39,137 : INFO : Starting epoch 4
2024-08-12 12:56:39,381 : INFO : Current training batch loss: 0.1921 in epoch 4
2024-08-12 12:56:40,191 : INFO : Current training batch loss: 0.1685 in epoch 4
2024-08-12 12:56:41,002 : INFO : Current training batch loss: 0.1058 in epoch 4
2024-08-12 12:56:41,813 : INFO : Current training batch loss: 0.2194 in epoch 4
2024-08-12 12:56:42,565 : INFO : Epoch finished, average loss over training batches: 0.1198
2024-08-12 12:56:42,565 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:42,565 : INFO : Training metrics:
2024-08-12 12:56:42,565 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:42,575 : INFO : Accuracy: 0.9678
2024-08-12 12:56:42,575 : INFO : Precision score for label_class 0: 0.9186
2024-08-12 12:56:42,575 : INFO : Precision score for label_class 1: 0.9814
2024-08-12 12:56:42,575 : INFO : Precision score for label_class 2: 0.9611
2024-08-12 12:56:42,575 : INFO : Recall score for label_class 0: 0.9576
2024-08-12 12:56:42,575 : INFO : Recall score for label_class 1: 0.9783
2024-08-12 12:56:42,575 : INFO : Recall score for label_class 2: 0.9496
2024-08-12 12:56:42,575 : INFO : Average F1 score: 0.9576
2024-08-12 12:56:42,855 : INFO : Average loss over validation batches: 0.4380
2024-08-12 12:56:42,855 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:42,855 : INFO : Validation metrics:
2024-08-12 12:56:42,855 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:42,859 : INFO : Accuracy: 0.8531
2024-08-12 12:56:42,859 : INFO : Precision score for label_class 0: 0.7727
2024-08-12 12:56:42,859 : INFO : Precision score for label_class 1: 0.9136
2024-08-12 12:56:42,859 : INFO : Precision score for label_class 2: 0.7745
2024-08-12 12:56:42,859 : INFO : Recall score for label_class 0: 0.8095
2024-08-12 12:56:42,859 : INFO : Recall score for label_class 1: 0.8813
2024-08-12 12:56:42,859 : INFO : Recall score for label_class 2: 0.8144
2024-08-12 12:56:42,859 : INFO : Average F1 score: 0.8273
2024-08-12 12:56:42,859 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 12:56:42,859 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:56:42,897 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 12:56:43,210 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:43,211 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 12:56:43,211 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:43,214 : INFO : Accuracy: 0.8576
2024-08-12 12:56:43,214 : INFO : Precision score for label_class 0: 0.7500
2024-08-12 12:56:43,215 : INFO : Precision score for label_class 1: 0.8822
2024-08-12 12:56:43,215 : INFO : Precision score for label_class 2: 0.8554
2024-08-12 12:56:43,215 : INFO : Recall score for label_class 0: 0.8214
2024-08-12 12:56:43,215 : INFO : Recall score for label_class 1: 0.9268
2024-08-12 12:56:43,215 : INFO : Recall score for label_class 2: 0.7320
2024-08-12 12:56:43,215 : INFO : Average F1 score: 0.8256
2024-08-12 12:56:43,215 : INFO : Determined score from best model, ending training.
2024-08-12 12:56:43,216 : INFO : Split 5 is finished, the score is: 0.8256
2024-08-12 12:56:43,216 : INFO : ----------------------------------------------------------------------------------------------------
[I 2024-08-12 12:56:43,216] Trial 5 finished with value: 0.8376659100386018 and parameters: {'n_epochs': 8, 'learning_rate': 8.188416770828417e-05, 'classifier_dropout': 0.4579828193064062, 'warmup_step_fraction': 0.04943187416272693, 'use_gradient_clipping': False}. Best is trial 5 with value: 0.8376659100386018.
2024-08-12 12:56:43,217 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:43,217 : INFO : Starting training for split 1
2024-08-12 12:56:43,228 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 328, 1596,  774]))
2024-08-12 12:56:43,230 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 86, 415, 174]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:56:43,269 : INFO : Starting epoch 1
2024-08-12 12:56:43,311 : INFO : Current training batch loss: 1.1222 in epoch 1
2024-08-12 12:56:44,122 : INFO : Current training batch loss: 0.9223 in epoch 1
2024-08-12 12:56:44,933 : INFO : Current training batch loss: 0.8962 in epoch 1
2024-08-12 12:56:45,744 : INFO : Current training batch loss: 0.7127 in epoch 1
2024-08-12 12:56:46,554 : INFO : Current training batch loss: 0.7520 in epoch 1
2024-08-12 12:56:46,700 : INFO : Epoch finished, average loss over training batches: 0.8625
2024-08-12 12:56:46,700 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:46,700 : INFO : Training metrics:
2024-08-12 12:56:46,700 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:46,708 : INFO : Accuracy: 0.6116
2024-08-12 12:56:46,708 : INFO : Precision score for label_class 0: 0.1476
2024-08-12 12:56:46,708 : INFO : Precision score for label_class 1: 0.6910
2024-08-12 12:56:46,708 : INFO : Precision score for label_class 2: 0.4857
2024-08-12 12:56:46,708 : INFO : Recall score for label_class 0: 0.0945
2024-08-12 12:56:46,708 : INFO : Recall score for label_class 1: 0.8659
2024-08-12 12:56:46,708 : INFO : Recall score for label_class 2: 0.3062
2024-08-12 12:56:46,708 : INFO : Average F1 score: 0.4198
2024-08-12 12:56:46,988 : INFO : Average loss over validation batches: 0.7023
2024-08-12 12:56:46,988 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:46,988 : INFO : Validation metrics:
2024-08-12 12:56:46,988 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:46,990 : INFO : Accuracy: 0.7111
2024-08-12 12:56:46,990 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:56:46,990 : INFO : Precision score for label_class 1: 0.8756
2024-08-12 12:56:46,990 : INFO : Precision score for label_class 2: 0.4804
2024-08-12 12:56:46,990 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:56:46,990 : INFO : Recall score for label_class 1: 0.8313
2024-08-12 12:56:46,990 : INFO : Recall score for label_class 2: 0.7759
2024-08-12 12:56:46,990 : INFO : Average F1 score: 0.4821
2024-08-12 12:56:46,991 : INFO : Validation metric decreased (inf --> 0.702297).  Saving model ...
2024-08-12 12:56:47,098 : INFO : Starting epoch 2
2024-08-12 12:56:47,746 : INFO : Current training batch loss: 0.3865 in epoch 2
2024-08-12 12:56:48,556 : INFO : Current training batch loss: 0.6241 in epoch 2
2024-08-12 12:56:49,365 : INFO : Current training batch loss: 0.3716 in epoch 2
2024-08-12 12:56:50,175 : INFO : Current training batch loss: 0.3006 in epoch 2
2024-08-12 12:56:50,522 : INFO : Epoch finished, average loss over training batches: 0.4922
2024-08-12 12:56:50,523 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:50,523 : INFO : Training metrics:
2024-08-12 12:56:50,523 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:50,527 : INFO : Accuracy: 0.8210
2024-08-12 12:56:50,527 : INFO : Precision score for label_class 0: 0.7500
2024-08-12 12:56:50,527 : INFO : Precision score for label_class 1: 0.8702
2024-08-12 12:56:50,527 : INFO : Precision score for label_class 2: 0.7322
2024-08-12 12:56:50,527 : INFO : Recall score for label_class 0: 0.4573
2024-08-12 12:56:50,527 : INFO : Recall score for label_class 1: 0.9323
2024-08-12 12:56:50,527 : INFO : Recall score for label_class 2: 0.7455
2024-08-12 12:56:50,527 : INFO : Average F1 score: 0.7357
2024-08-12 12:56:50,807 : INFO : Average loss over validation batches: 0.3946
2024-08-12 12:56:50,807 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:50,807 : INFO : Validation metrics:
2024-08-12 12:56:50,807 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:50,810 : INFO : Accuracy: 0.8533
2024-08-12 12:56:50,810 : INFO : Precision score for label_class 0: 0.7653
2024-08-12 12:56:50,810 : INFO : Precision score for label_class 1: 0.9253
2024-08-12 12:56:50,810 : INFO : Precision score for label_class 2: 0.7513
2024-08-12 12:56:50,810 : INFO : Recall score for label_class 0: 0.8721
2024-08-12 12:56:50,810 : INFO : Recall score for label_class 1: 0.8651
2024-08-12 12:56:50,810 : INFO : Recall score for label_class 2: 0.8161
2024-08-12 12:56:50,810 : INFO : Average F1 score: 0.8306
2024-08-12 12:56:50,810 : INFO : Validation metric decreased (0.702297 --> 0.394593).  Saving model ...
2024-08-12 12:56:50,911 : INFO : Starting epoch 3
2024-08-12 12:56:51,357 : INFO : Current training batch loss: 0.3354 in epoch 3
2024-08-12 12:56:52,167 : INFO : Current training batch loss: 0.2718 in epoch 3
2024-08-12 12:56:52,977 : INFO : Current training batch loss: 0.2675 in epoch 3
2024-08-12 12:56:53,788 : INFO : Current training batch loss: 0.1318 in epoch 3
2024-08-12 12:56:54,338 : INFO : Epoch finished, average loss over training batches: 0.2814
2024-08-12 12:56:54,338 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:54,338 : INFO : Training metrics:
2024-08-12 12:56:54,338 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:54,346 : INFO : Accuracy: 0.9092
2024-08-12 12:56:54,346 : INFO : Precision score for label_class 0: 0.8171
2024-08-12 12:56:54,346 : INFO : Precision score for label_class 1: 0.9389
2024-08-12 12:56:54,346 : INFO : Precision score for label_class 2: 0.8883
2024-08-12 12:56:54,346 : INFO : Recall score for label_class 0: 0.8720
2024-08-12 12:56:54,346 : INFO : Recall score for label_class 1: 0.9442
2024-08-12 12:56:54,346 : INFO : Recall score for label_class 2: 0.8527
2024-08-12 12:56:54,346 : INFO : Average F1 score: 0.8851
2024-08-12 12:56:54,626 : INFO : Average loss over validation batches: 0.3587
2024-08-12 12:56:54,626 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:54,626 : INFO : Validation metrics:
2024-08-12 12:56:54,626 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:54,629 : INFO : Accuracy: 0.8785
2024-08-12 12:56:54,629 : INFO : Precision score for label_class 0: 0.8118
2024-08-12 12:56:54,629 : INFO : Precision score for label_class 1: 0.9059
2024-08-12 12:56:54,629 : INFO : Precision score for label_class 2: 0.8424
2024-08-12 12:56:54,629 : INFO : Recall score for label_class 0: 0.8023
2024-08-12 12:56:54,629 : INFO : Recall score for label_class 1: 0.9277
2024-08-12 12:56:54,629 : INFO : Recall score for label_class 2: 0.7989
2024-08-12 12:56:54,629 : INFO : Average F1 score: 0.8479
2024-08-12 12:56:54,629 : INFO : Validation metric decreased (0.394593 --> 0.358689).  Saving model ...
2024-08-12 12:56:54,731 : INFO : Starting epoch 4
2024-08-12 12:56:54,975 : INFO : Current training batch loss: 0.5027 in epoch 4
2024-08-12 12:56:55,785 : INFO : Current training batch loss: 0.1742 in epoch 4
2024-08-12 12:56:56,595 : INFO : Current training batch loss: 0.3005 in epoch 4
2024-08-12 12:56:57,405 : INFO : Current training batch loss: 0.1462 in epoch 4
2024-08-12 12:56:58,157 : INFO : Epoch finished, average loss over training batches: 0.1873
2024-08-12 12:56:58,157 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:58,157 : INFO : Training metrics:
2024-08-12 12:56:58,157 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:58,163 : INFO : Accuracy: 0.9448
2024-08-12 12:56:58,163 : INFO : Precision score for label_class 0: 0.8736
2024-08-12 12:56:58,163 : INFO : Precision score for label_class 1: 0.9639
2024-08-12 12:56:58,163 : INFO : Precision score for label_class 2: 0.9369
2024-08-12 12:56:58,163 : INFO : Recall score for label_class 0: 0.9268
2024-08-12 12:56:58,163 : INFO : Recall score for label_class 1: 0.9693
2024-08-12 12:56:58,163 : INFO : Recall score for label_class 2: 0.9018
2024-08-12 12:56:58,163 : INFO : Average F1 score: 0.9283
2024-08-12 12:56:58,443 : INFO : Average loss over validation batches: 0.3560
2024-08-12 12:56:58,443 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:58,443 : INFO : Validation metrics:
2024-08-12 12:56:58,443 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:56:58,446 : INFO : Accuracy: 0.8652
2024-08-12 12:56:58,446 : INFO : Precision score for label_class 0: 0.7714
2024-08-12 12:56:58,446 : INFO : Precision score for label_class 1: 0.9351
2024-08-12 12:56:58,446 : INFO : Precision score for label_class 2: 0.7730
2024-08-12 12:56:58,446 : INFO : Recall score for label_class 0: 0.9419
2024-08-12 12:56:58,446 : INFO : Recall score for label_class 1: 0.8675
2024-08-12 12:56:58,446 : INFO : Recall score for label_class 2: 0.8218
2024-08-12 12:56:58,446 : INFO : Average F1 score: 0.8483
2024-08-12 12:56:58,447 : INFO : Validation metric decreased (0.358689 --> 0.355967).  Saving model ...
2024-08-12 12:56:58,547 : INFO : Starting epoch 5
2024-08-12 12:56:58,589 : INFO : Current training batch loss: 0.0559 in epoch 5
2024-08-12 12:56:59,399 : INFO : Current training batch loss: 0.2195 in epoch 5
2024-08-12 12:57:00,209 : INFO : Current training batch loss: 0.0462 in epoch 5
2024-08-12 12:57:01,020 : INFO : Current training batch loss: 0.1708 in epoch 5
2024-08-12 12:57:01,830 : INFO : Current training batch loss: 0.1199 in epoch 5
2024-08-12 12:57:01,976 : INFO : Epoch finished, average loss over training batches: 0.1233
2024-08-12 12:57:01,976 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:01,976 : INFO : Training metrics:
2024-08-12 12:57:01,976 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:01,981 : INFO : Accuracy: 0.9681
2024-08-12 12:57:01,981 : INFO : Precision score for label_class 0: 0.9057
2024-08-12 12:57:01,981 : INFO : Precision score for label_class 1: 0.9782
2024-08-12 12:57:01,981 : INFO : Precision score for label_class 2: 0.9757
2024-08-12 12:57:01,981 : INFO : Recall score for label_class 0: 0.9665
2024-08-12 12:57:01,981 : INFO : Recall score for label_class 1: 0.9850
2024-08-12 12:57:01,981 : INFO : Recall score for label_class 2: 0.9341
2024-08-12 12:57:01,981 : INFO : Average F1 score: 0.9570
2024-08-12 12:57:02,261 : INFO : Average loss over validation batches: 0.3690
2024-08-12 12:57:02,262 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:02,262 : INFO : Validation metrics:
2024-08-12 12:57:02,262 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:02,264 : INFO : Accuracy: 0.8756
2024-08-12 12:57:02,264 : INFO : Precision score for label_class 0: 0.8000
2024-08-12 12:57:02,264 : INFO : Precision score for label_class 1: 0.9475
2024-08-12 12:57:02,264 : INFO : Precision score for label_class 2: 0.7739
2024-08-12 12:57:02,264 : INFO : Recall score for label_class 0: 0.8837
2024-08-12 12:57:02,264 : INFO : Recall score for label_class 1: 0.8699
2024-08-12 12:57:02,264 : INFO : Recall score for label_class 2: 0.8851
2024-08-12 12:57:02,264 : INFO : Average F1 score: 0.8575
2024-08-12 12:57:02,264 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 12:57:02,264 : INFO : Starting epoch 6
2024-08-12 12:57:02,913 : INFO : Current training batch loss: 0.0171 in epoch 6
2024-08-12 12:57:03,723 : INFO : Current training batch loss: 0.0528 in epoch 6
2024-08-12 12:57:04,533 : INFO : Current training batch loss: 0.0239 in epoch 6
2024-08-12 12:57:05,343 : INFO : Current training batch loss: 0.0215 in epoch 6
2024-08-12 12:57:05,691 : INFO : Epoch finished, average loss over training batches: 0.0951
2024-08-12 12:57:05,691 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:05,691 : INFO : Training metrics:
2024-08-12 12:57:05,691 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:05,697 : INFO : Accuracy: 0.9770
2024-08-12 12:57:05,697 : INFO : Precision score for label_class 0: 0.9277
2024-08-12 12:57:05,697 : INFO : Precision score for label_class 1: 0.9869
2024-08-12 12:57:05,697 : INFO : Precision score for label_class 2: 0.9788
2024-08-12 12:57:05,697 : INFO : Recall score for label_class 0: 0.9787
2024-08-12 12:57:05,697 : INFO : Recall score for label_class 1: 0.9875
2024-08-12 12:57:05,697 : INFO : Recall score for label_class 2: 0.9548
2024-08-12 12:57:05,697 : INFO : Average F1 score: 0.9688
2024-08-12 12:57:05,977 : INFO : Average loss over validation batches: 0.3629
2024-08-12 12:57:05,977 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:05,977 : INFO : Validation metrics:
2024-08-12 12:57:05,977 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:05,980 : INFO : Accuracy: 0.8830
2024-08-12 12:57:05,980 : INFO : Precision score for label_class 0: 0.7900
2024-08-12 12:57:05,980 : INFO : Precision score for label_class 1: 0.9044
2024-08-12 12:57:05,980 : INFO : Precision score for label_class 2: 0.8836
2024-08-12 12:57:05,980 : INFO : Recall score for label_class 0: 0.9186
2024-08-12 12:57:05,980 : INFO : Recall score for label_class 1: 0.9349
2024-08-12 12:57:05,980 : INFO : Recall score for label_class 2: 0.7414
2024-08-12 12:57:05,980 : INFO : Average F1 score: 0.8584
2024-08-12 12:57:05,980 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 12:57:05,980 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:57:06,018 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 12:57:06,327 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:06,328 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 12:57:06,328 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:06,331 : INFO : Accuracy: 0.8652
2024-08-12 12:57:06,331 : INFO : Precision score for label_class 0: 0.7714
2024-08-12 12:57:06,331 : INFO : Precision score for label_class 1: 0.9351
2024-08-12 12:57:06,331 : INFO : Precision score for label_class 2: 0.7730
2024-08-12 12:57:06,331 : INFO : Recall score for label_class 0: 0.9419
2024-08-12 12:57:06,331 : INFO : Recall score for label_class 1: 0.8675
2024-08-12 12:57:06,331 : INFO : Recall score for label_class 2: 0.8218
2024-08-12 12:57:06,331 : INFO : Average F1 score: 0.8483
2024-08-12 12:57:06,331 : INFO : Determined score from best model, ending training.
2024-08-12 12:57:06,338 : INFO : Split 1 is finished, the score is: 0.8483
2024-08-12 12:57:06,338 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:06,338 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:06,338 : INFO : Starting training for split 2
2024-08-12 12:57:06,349 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 343, 1601,  754]))
2024-08-12 12:57:06,351 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 71, 410, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:57:06,401 : INFO : Starting epoch 1
2024-08-12 12:57:06,444 : INFO : Current training batch loss: 1.0966 in epoch 1
2024-08-12 12:57:07,254 : INFO : Current training batch loss: 1.0148 in epoch 1
2024-08-12 12:57:08,064 : INFO : Current training batch loss: 0.8642 in epoch 1
2024-08-12 12:57:08,875 : INFO : Current training batch loss: 0.6933 in epoch 1
2024-08-12 12:57:09,685 : INFO : Current training batch loss: 0.6003 in epoch 1
2024-08-12 12:57:09,830 : INFO : Epoch finished, average loss over training batches: 0.8442
2024-08-12 12:57:09,830 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:09,830 : INFO : Training metrics:
2024-08-12 12:57:09,830 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:09,841 : INFO : Accuracy: 0.6305
2024-08-12 12:57:09,841 : INFO : Precision score for label_class 0: 0.1951
2024-08-12 12:57:09,841 : INFO : Precision score for label_class 1: 0.6906
2024-08-12 12:57:09,841 : INFO : Precision score for label_class 2: 0.5491
2024-08-12 12:57:09,841 : INFO : Recall score for label_class 0: 0.1166
2024-08-12 12:57:09,841 : INFO : Recall score for label_class 1: 0.8907
2024-08-12 12:57:09,841 : INFO : Recall score for label_class 2: 0.3117
2024-08-12 12:57:09,841 : INFO : Average F1 score: 0.4405
2024-08-12 12:57:10,121 : INFO : Average loss over validation batches: 0.5802
2024-08-12 12:57:10,121 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:10,121 : INFO : Validation metrics:
2024-08-12 12:57:10,121 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:10,124 : INFO : Accuracy: 0.7704
2024-08-12 12:57:10,124 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:57:10,124 : INFO : Precision score for label_class 1: 0.8456
2024-08-12 12:57:10,124 : INFO : Precision score for label_class 2: 0.6228
2024-08-12 12:57:10,124 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:57:10,124 : INFO : Recall score for label_class 1: 0.9220
2024-08-12 12:57:10,124 : INFO : Recall score for label_class 2: 0.7320
2024-08-12 12:57:10,124 : INFO : Average F1 score: 0.5184
2024-08-12 12:57:10,124 : INFO : Validation metric decreased (inf --> 0.580218).  Saving model ...
2024-08-12 12:57:10,233 : INFO : Starting epoch 2
2024-08-12 12:57:10,881 : INFO : Current training batch loss: 0.5435 in epoch 2
2024-08-12 12:57:11,691 : INFO : Current training batch loss: 0.4551 in epoch 2
2024-08-12 12:57:12,501 : INFO : Current training batch loss: 0.2975 in epoch 2
2024-08-12 12:57:13,311 : INFO : Current training batch loss: 0.3617 in epoch 2
2024-08-12 12:57:13,658 : INFO : Epoch finished, average loss over training batches: 0.4364
2024-08-12 12:57:13,658 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:13,658 : INFO : Training metrics:
2024-08-12 12:57:13,658 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:13,669 : INFO : Accuracy: 0.8536
2024-08-12 12:57:13,669 : INFO : Precision score for label_class 0: 0.7880
2024-08-12 12:57:13,669 : INFO : Precision score for label_class 1: 0.8796
2024-08-12 12:57:13,669 : INFO : Precision score for label_class 2: 0.8189
2024-08-12 12:57:13,669 : INFO : Recall score for label_class 0: 0.7259
2024-08-12 12:57:13,669 : INFO : Recall score for label_class 1: 0.9357
2024-08-12 12:57:13,669 : INFO : Recall score for label_class 2: 0.7374
2024-08-12 12:57:13,669 : INFO : Average F1 score: 0.8128
2024-08-12 12:57:13,949 : INFO : Average loss over validation batches: 0.3784
2024-08-12 12:57:13,949 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:13,949 : INFO : Validation metrics:
2024-08-12 12:57:13,949 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:13,952 : INFO : Accuracy: 0.8652
2024-08-12 12:57:13,952 : INFO : Precision score for label_class 0: 0.8000
2024-08-12 12:57:13,952 : INFO : Precision score for label_class 1: 0.8964
2024-08-12 12:57:13,952 : INFO : Precision score for label_class 2: 0.8211
2024-08-12 12:57:13,952 : INFO : Recall score for label_class 0: 0.7887
2024-08-12 12:57:13,952 : INFO : Recall score for label_class 1: 0.9073
2024-08-12 12:57:13,952 : INFO : Recall score for label_class 2: 0.8041
2024-08-12 12:57:13,952 : INFO : Average F1 score: 0.8362
2024-08-12 12:57:13,952 : INFO : Validation metric decreased (0.580218 --> 0.378428).  Saving model ...
2024-08-12 12:57:14,051 : INFO : Starting epoch 3
2024-08-12 12:57:14,497 : INFO : Current training batch loss: 0.2795 in epoch 3
2024-08-12 12:57:15,308 : INFO : Current training batch loss: 0.2566 in epoch 3
2024-08-12 12:57:16,118 : INFO : Current training batch loss: 0.3062 in epoch 3
2024-08-12 12:57:16,928 : INFO : Current training batch loss: 0.1252 in epoch 3
2024-08-12 12:57:17,477 : INFO : Epoch finished, average loss over training batches: 0.2431
2024-08-12 12:57:17,478 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:17,478 : INFO : Training metrics:
2024-08-12 12:57:17,478 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:17,486 : INFO : Accuracy: 0.9248
2024-08-12 12:57:17,486 : INFO : Precision score for label_class 0: 0.8652
2024-08-12 12:57:17,486 : INFO : Precision score for label_class 1: 0.9495
2024-08-12 12:57:17,486 : INFO : Precision score for label_class 2: 0.8999
2024-08-12 12:57:17,486 : INFO : Recall score for label_class 0: 0.8980
2024-08-12 12:57:17,486 : INFO : Recall score for label_class 1: 0.9507
2024-08-12 12:57:17,486 : INFO : Recall score for label_class 2: 0.8820
2024-08-12 12:57:17,486 : INFO : Average F1 score: 0.9074
2024-08-12 12:57:17,765 : INFO : Average loss over validation batches: 0.3583
2024-08-12 12:57:17,766 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:17,766 : INFO : Validation metrics:
2024-08-12 12:57:17,766 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:17,769 : INFO : Accuracy: 0.8756
2024-08-12 12:57:17,769 : INFO : Precision score for label_class 0: 0.8056
2024-08-12 12:57:17,769 : INFO : Precision score for label_class 1: 0.8813
2024-08-12 12:57:17,769 : INFO : Precision score for label_class 2: 0.8909
2024-08-12 12:57:17,769 : INFO : Recall score for label_class 0: 0.8169
2024-08-12 12:57:17,769 : INFO : Recall score for label_class 1: 0.9415
2024-08-12 12:57:17,769 : INFO : Recall score for label_class 2: 0.7577
2024-08-12 12:57:17,769 : INFO : Average F1 score: 0.8468
2024-08-12 12:57:17,769 : INFO : Validation metric decreased (0.378428 --> 0.358327).  Saving model ...
2024-08-12 12:57:17,871 : INFO : Starting epoch 4
2024-08-12 12:57:18,115 : INFO : Current training batch loss: 0.2268 in epoch 4
2024-08-12 12:57:18,926 : INFO : Current training batch loss: 0.0795 in epoch 4
2024-08-12 12:57:19,736 : INFO : Current training batch loss: 0.2041 in epoch 4
2024-08-12 12:57:20,546 : INFO : Current training batch loss: 0.1338 in epoch 4
2024-08-12 12:57:21,298 : INFO : Epoch finished, average loss over training batches: 0.1469
2024-08-12 12:57:21,298 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:21,298 : INFO : Training metrics:
2024-08-12 12:57:21,298 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:21,306 : INFO : Accuracy: 0.9611
2024-08-12 12:57:21,306 : INFO : Precision score for label_class 0: 0.9078
2024-08-12 12:57:21,306 : INFO : Precision score for label_class 1: 0.9733
2024-08-12 12:57:21,306 : INFO : Precision score for label_class 2: 0.9602
2024-08-12 12:57:21,306 : INFO : Recall score for label_class 0: 0.9475
2024-08-12 12:57:21,306 : INFO : Recall score for label_class 1: 0.9794
2024-08-12 12:57:21,306 : INFO : Recall score for label_class 2: 0.9284
2024-08-12 12:57:21,306 : INFO : Average F1 score: 0.9492
2024-08-12 12:57:21,586 : INFO : Average loss over validation batches: 0.4510
2024-08-12 12:57:21,586 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:21,586 : INFO : Validation metrics:
2024-08-12 12:57:21,586 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:21,589 : INFO : Accuracy: 0.8533
2024-08-12 12:57:21,589 : INFO : Precision score for label_class 0: 0.7326
2024-08-12 12:57:21,589 : INFO : Precision score for label_class 1: 0.9280
2024-08-12 12:57:21,589 : INFO : Precision score for label_class 2: 0.7710
2024-08-12 12:57:21,589 : INFO : Recall score for label_class 0: 0.8873
2024-08-12 12:57:21,589 : INFO : Recall score for label_class 1: 0.8488
2024-08-12 12:57:21,589 : INFO : Recall score for label_class 2: 0.8505
2024-08-12 12:57:21,589 : INFO : Average F1 score: 0.8327
2024-08-12 12:57:21,589 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 12:57:21,589 : INFO : Starting epoch 5
2024-08-12 12:57:21,631 : INFO : Current training batch loss: 0.0779 in epoch 5
2024-08-12 12:57:22,441 : INFO : Current training batch loss: 0.1329 in epoch 5
2024-08-12 12:57:23,251 : INFO : Current training batch loss: 0.0305 in epoch 5
2024-08-12 12:57:24,062 : INFO : Current training batch loss: 0.1313 in epoch 5
2024-08-12 12:57:24,873 : INFO : Current training batch loss: 0.3465 in epoch 5
2024-08-12 12:57:25,019 : INFO : Epoch finished, average loss over training batches: 0.1111
2024-08-12 12:57:25,019 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:25,019 : INFO : Training metrics:
2024-08-12 12:57:25,019 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:25,026 : INFO : Accuracy: 0.9733
2024-08-12 12:57:25,026 : INFO : Precision score for label_class 0: 0.9380
2024-08-12 12:57:25,026 : INFO : Precision score for label_class 1: 0.9807
2024-08-12 12:57:25,026 : INFO : Precision score for label_class 2: 0.9741
2024-08-12 12:57:25,026 : INFO : Recall score for label_class 0: 0.9708
2024-08-12 12:57:25,026 : INFO : Recall score for label_class 1: 0.9863
2024-08-12 12:57:25,026 : INFO : Recall score for label_class 2: 0.9469
2024-08-12 12:57:25,026 : INFO : Average F1 score: 0.9660
2024-08-12 12:57:25,306 : INFO : Average loss over validation batches: 0.4426
2024-08-12 12:57:25,307 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:25,307 : INFO : Validation metrics:
2024-08-12 12:57:25,307 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:25,310 : INFO : Accuracy: 0.8533
2024-08-12 12:57:25,310 : INFO : Precision score for label_class 0: 0.7262
2024-08-12 12:57:25,310 : INFO : Precision score for label_class 1: 0.9147
2024-08-12 12:57:25,310 : INFO : Precision score for label_class 2: 0.7892
2024-08-12 12:57:25,310 : INFO : Recall score for label_class 0: 0.8592
2024-08-12 12:57:25,310 : INFO : Recall score for label_class 1: 0.8634
2024-08-12 12:57:25,310 : INFO : Recall score for label_class 2: 0.8299
2024-08-12 12:57:25,310 : INFO : Average F1 score: 0.8282
2024-08-12 12:57:25,310 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 12:57:25,310 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:57:25,347 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 12:57:25,661 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:25,661 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 12:57:25,661 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:25,665 : INFO : Accuracy: 0.8756
2024-08-12 12:57:25,665 : INFO : Precision score for label_class 0: 0.8056
2024-08-12 12:57:25,665 : INFO : Precision score for label_class 1: 0.8813
2024-08-12 12:57:25,665 : INFO : Precision score for label_class 2: 0.8909
2024-08-12 12:57:25,665 : INFO : Recall score for label_class 0: 0.8169
2024-08-12 12:57:25,665 : INFO : Recall score for label_class 1: 0.9415
2024-08-12 12:57:25,665 : INFO : Recall score for label_class 2: 0.7577
2024-08-12 12:57:25,665 : INFO : Average F1 score: 0.8468
2024-08-12 12:57:25,665 : INFO : Determined score from best model, ending training.
2024-08-12 12:57:25,666 : INFO : Split 2 is finished, the score is: 0.8468
2024-08-12 12:57:25,666 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:25,666 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:25,666 : INFO : Starting training for split 3
2024-08-12 12:57:25,678 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 328, 1611,  759]))
2024-08-12 12:57:25,680 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 86, 400, 189]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:57:25,719 : INFO : Starting epoch 1
2024-08-12 12:57:25,761 : INFO : Current training batch loss: 1.0989 in epoch 1
2024-08-12 12:57:26,570 : INFO : Current training batch loss: 1.0160 in epoch 1
2024-08-12 12:57:27,381 : INFO : Current training batch loss: 0.8049 in epoch 1
2024-08-12 12:57:28,191 : INFO : Current training batch loss: 0.7150 in epoch 1
2024-08-12 12:57:29,001 : INFO : Current training batch loss: 0.5879 in epoch 1
2024-08-12 12:57:29,146 : INFO : Epoch finished, average loss over training batches: 0.8384
2024-08-12 12:57:29,147 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:29,147 : INFO : Training metrics:
2024-08-12 12:57:29,147 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:29,151 : INFO : Accuracy: 0.6520
2024-08-12 12:57:29,151 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:57:29,151 : INFO : Precision score for label_class 1: 0.6909
2024-08-12 12:57:29,151 : INFO : Precision score for label_class 2: 0.5062
2024-08-12 12:57:29,151 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:57:29,151 : INFO : Recall score for label_class 1: 0.9131
2024-08-12 12:57:29,151 : INFO : Recall score for label_class 2: 0.3794
2024-08-12 12:57:29,151 : INFO : Average F1 score: 0.4068
2024-08-12 12:57:29,431 : INFO : Average loss over validation batches: 0.5813
2024-08-12 12:57:29,431 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:29,431 : INFO : Validation metrics:
2024-08-12 12:57:29,431 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:29,434 : INFO : Accuracy: 0.7600
2024-08-12 12:57:29,434 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:57:29,434 : INFO : Precision score for label_class 1: 0.8765
2024-08-12 12:57:29,434 : INFO : Precision score for label_class 2: 0.5763
2024-08-12 12:57:29,434 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:57:29,434 : INFO : Recall score for label_class 1: 0.9050
2024-08-12 12:57:29,434 : INFO : Recall score for label_class 2: 0.7989
2024-08-12 12:57:29,434 : INFO : Average F1 score: 0.5201
2024-08-12 12:57:29,434 : INFO : Validation metric decreased (inf --> 0.581311).  Saving model ...
2024-08-12 12:57:29,532 : INFO : Starting epoch 2
2024-08-12 12:57:30,180 : INFO : Current training batch loss: 0.6026 in epoch 2
2024-08-12 12:57:30,990 : INFO : Current training batch loss: 0.3817 in epoch 2
2024-08-12 12:57:31,800 : INFO : Current training batch loss: 0.4219 in epoch 2
2024-08-12 12:57:32,610 : INFO : Current training batch loss: 0.3094 in epoch 2
2024-08-12 12:57:32,957 : INFO : Epoch finished, average loss over training batches: 0.4457
2024-08-12 12:57:32,957 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:32,957 : INFO : Training metrics:
2024-08-12 12:57:32,957 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:32,962 : INFO : Accuracy: 0.8443
2024-08-12 12:57:32,962 : INFO : Precision score for label_class 0: 0.7535
2024-08-12 12:57:32,962 : INFO : Precision score for label_class 1: 0.8834
2024-08-12 12:57:32,962 : INFO : Precision score for label_class 2: 0.7890
2024-08-12 12:57:32,962 : INFO : Recall score for label_class 0: 0.6524
2024-08-12 12:57:32,962 : INFO : Recall score for label_class 1: 0.9261
2024-08-12 12:57:32,962 : INFO : Recall score for label_class 2: 0.7536
2024-08-12 12:57:32,962 : INFO : Average F1 score: 0.7915
2024-08-12 12:57:33,242 : INFO : Average loss over validation batches: 0.3892
2024-08-12 12:57:33,242 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:33,242 : INFO : Validation metrics:
2024-08-12 12:57:33,242 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:33,245 : INFO : Accuracy: 0.8637
2024-08-12 12:57:33,245 : INFO : Precision score for label_class 0: 0.7955
2024-08-12 12:57:33,245 : INFO : Precision score for label_class 1: 0.9002
2024-08-12 12:57:33,245 : INFO : Precision score for label_class 2: 0.8125
2024-08-12 12:57:33,245 : INFO : Recall score for label_class 0: 0.8140
2024-08-12 12:57:33,245 : INFO : Recall score for label_class 1: 0.9250
2024-08-12 12:57:33,245 : INFO : Recall score for label_class 2: 0.7566
2024-08-12 12:57:33,245 : INFO : Average F1 score: 0.8335
2024-08-12 12:57:33,245 : INFO : Validation metric decreased (0.581311 --> 0.389177).  Saving model ...
2024-08-12 12:57:33,346 : INFO : Starting epoch 3
2024-08-12 12:57:33,793 : INFO : Current training batch loss: 0.2438 in epoch 3
2024-08-12 12:57:34,604 : INFO : Current training batch loss: 0.2922 in epoch 3
2024-08-12 12:57:35,414 : INFO : Current training batch loss: 0.1612 in epoch 3
2024-08-12 12:57:36,224 : INFO : Current training batch loss: 0.0899 in epoch 3
2024-08-12 12:57:36,774 : INFO : Epoch finished, average loss over training batches: 0.2409
2024-08-12 12:57:36,774 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:36,774 : INFO : Training metrics:
2024-08-12 12:57:36,774 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:36,778 : INFO : Accuracy: 0.9248
2024-08-12 12:57:36,778 : INFO : Precision score for label_class 0: 0.8291
2024-08-12 12:57:36,778 : INFO : Precision score for label_class 1: 0.9539
2024-08-12 12:57:36,778 : INFO : Precision score for label_class 2: 0.9077
2024-08-12 12:57:36,778 : INFO : Recall score for label_class 0: 0.9024
2024-08-12 12:57:36,778 : INFO : Recall score for label_class 1: 0.9497
2024-08-12 12:57:36,778 : INFO : Recall score for label_class 2: 0.8814
2024-08-12 12:57:36,778 : INFO : Average F1 score: 0.9035
2024-08-12 12:57:37,059 : INFO : Average loss over validation batches: 0.3567
2024-08-12 12:57:37,059 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:37,059 : INFO : Validation metrics:
2024-08-12 12:57:37,059 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:37,061 : INFO : Accuracy: 0.8770
2024-08-12 12:57:37,061 : INFO : Precision score for label_class 0: 0.8235
2024-08-12 12:57:37,061 : INFO : Precision score for label_class 1: 0.9177
2024-08-12 12:57:37,061 : INFO : Precision score for label_class 2: 0.8148
2024-08-12 12:57:37,061 : INFO : Recall score for label_class 0: 0.8140
2024-08-12 12:57:37,061 : INFO : Recall score for label_class 1: 0.9200
2024-08-12 12:57:37,061 : INFO : Recall score for label_class 2: 0.8148
2024-08-12 12:57:37,061 : INFO : Average F1 score: 0.8508
2024-08-12 12:57:37,061 : INFO : Validation metric decreased (0.389177 --> 0.356703).  Saving model ...
2024-08-12 12:57:37,161 : INFO : Starting epoch 4
2024-08-12 12:57:37,405 : INFO : Current training batch loss: 0.3203 in epoch 4
2024-08-12 12:57:38,215 : INFO : Current training batch loss: 0.2612 in epoch 4
2024-08-12 12:57:39,026 : INFO : Current training batch loss: 0.1669 in epoch 4
2024-08-12 12:57:39,836 : INFO : Current training batch loss: 0.0648 in epoch 4
2024-08-12 12:57:40,588 : INFO : Epoch finished, average loss over training batches: 0.1488
2024-08-12 12:57:40,588 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:40,588 : INFO : Training metrics:
2024-08-12 12:57:40,588 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:40,593 : INFO : Accuracy: 0.9577
2024-08-12 12:57:40,593 : INFO : Precision score for label_class 0: 0.8905
2024-08-12 12:57:40,593 : INFO : Precision score for label_class 1: 0.9698
2024-08-12 12:57:40,593 : INFO : Precision score for label_class 2: 0.9631
2024-08-12 12:57:40,593 : INFO : Recall score for label_class 0: 0.9421
2024-08-12 12:57:40,593 : INFO : Recall score for label_class 1: 0.9752
2024-08-12 12:57:40,593 : INFO : Recall score for label_class 2: 0.9275
2024-08-12 12:57:40,593 : INFO : Average F1 score: 0.9443
2024-08-12 12:57:40,874 : INFO : Average loss over validation batches: 0.4749
2024-08-12 12:57:40,874 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:40,874 : INFO : Validation metrics:
2024-08-12 12:57:40,874 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:40,877 : INFO : Accuracy: 0.8533
2024-08-12 12:57:40,877 : INFO : Precision score for label_class 0: 0.7130
2024-08-12 12:57:40,877 : INFO : Precision score for label_class 1: 0.9469
2024-08-12 12:57:40,877 : INFO : Precision score for label_class 2: 0.7656
2024-08-12 12:57:40,877 : INFO : Recall score for label_class 0: 0.8953
2024-08-12 12:57:40,877 : INFO : Recall score for label_class 1: 0.8475
2024-08-12 12:57:40,877 : INFO : Recall score for label_class 2: 0.8466
2024-08-12 12:57:40,877 : INFO : Average F1 score: 0.8308
2024-08-12 12:57:40,877 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 12:57:40,877 : INFO : Starting epoch 5
2024-08-12 12:57:40,919 : INFO : Current training batch loss: 0.0464 in epoch 5
2024-08-12 12:57:41,728 : INFO : Current training batch loss: 0.1690 in epoch 5
2024-08-12 12:57:42,539 : INFO : Current training batch loss: 0.0284 in epoch 5
2024-08-12 12:57:43,350 : INFO : Current training batch loss: 0.3219 in epoch 5
2024-08-12 12:57:44,161 : INFO : Current training batch loss: 0.0392 in epoch 5
2024-08-12 12:57:44,306 : INFO : Epoch finished, average loss over training batches: 0.1163
2024-08-12 12:57:44,306 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:44,306 : INFO : Training metrics:
2024-08-12 12:57:44,306 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:44,310 : INFO : Accuracy: 0.9681
2024-08-12 12:57:44,310 : INFO : Precision score for label_class 0: 0.9011
2024-08-12 12:57:44,310 : INFO : Precision score for label_class 1: 0.9819
2024-08-12 12:57:44,310 : INFO : Precision score for label_class 2: 0.9702
2024-08-12 12:57:44,310 : INFO : Recall score for label_class 0: 0.9726
2024-08-12 12:57:44,310 : INFO : Recall score for label_class 1: 0.9783
2024-08-12 12:57:44,310 : INFO : Recall score for label_class 2: 0.9447
2024-08-12 12:57:44,310 : INFO : Average F1 score: 0.9576
2024-08-12 12:57:44,590 : INFO : Average loss over validation batches: 0.4171
2024-08-12 12:57:44,590 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:44,590 : INFO : Validation metrics:
2024-08-12 12:57:44,591 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:44,593 : INFO : Accuracy: 0.8726
2024-08-12 12:57:44,593 : INFO : Precision score for label_class 0: 0.8280
2024-08-12 12:57:44,593 : INFO : Precision score for label_class 1: 0.9291
2024-08-12 12:57:44,593 : INFO : Precision score for label_class 2: 0.7861
2024-08-12 12:57:44,593 : INFO : Recall score for label_class 0: 0.8953
2024-08-12 12:57:44,593 : INFO : Recall score for label_class 1: 0.8850
2024-08-12 12:57:44,593 : INFO : Recall score for label_class 2: 0.8360
2024-08-12 12:57:44,593 : INFO : Average F1 score: 0.8590
2024-08-12 12:57:44,593 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 12:57:44,593 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:57:44,627 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 12:57:44,935 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:44,935 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 12:57:44,935 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:44,937 : INFO : Accuracy: 0.8770
2024-08-12 12:57:44,937 : INFO : Precision score for label_class 0: 0.8235
2024-08-12 12:57:44,937 : INFO : Precision score for label_class 1: 0.9177
2024-08-12 12:57:44,937 : INFO : Precision score for label_class 2: 0.8148
2024-08-12 12:57:44,937 : INFO : Recall score for label_class 0: 0.8140
2024-08-12 12:57:44,937 : INFO : Recall score for label_class 1: 0.9200
2024-08-12 12:57:44,937 : INFO : Recall score for label_class 2: 0.8148
2024-08-12 12:57:44,937 : INFO : Average F1 score: 0.8508
2024-08-12 12:57:44,937 : INFO : Determined score from best model, ending training.
2024-08-12 12:57:44,939 : INFO : Split 3 is finished, the score is: 0.8508
2024-08-12 12:57:44,939 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:44,939 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:44,939 : INFO : Starting training for split 4
2024-08-12 12:57:44,950 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 327, 1621,  751]))
2024-08-12 12:57:44,952 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 87, 390, 197]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:57:44,993 : INFO : Starting epoch 1
2024-08-12 12:57:45,036 : INFO : Current training batch loss: 1.1087 in epoch 1
2024-08-12 12:57:45,851 : INFO : Current training batch loss: 1.0051 in epoch 1
2024-08-12 12:57:46,662 : INFO : Current training batch loss: 0.7641 in epoch 1
2024-08-12 12:57:47,472 : INFO : Current training batch loss: 0.6207 in epoch 1
2024-08-12 12:57:48,282 : INFO : Current training batch loss: 0.6992 in epoch 1
2024-08-12 12:57:48,427 : INFO : Epoch finished, average loss over training batches: 0.8338
2024-08-12 12:57:48,428 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:48,428 : INFO : Training metrics:
2024-08-12 12:57:48,428 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:48,435 : INFO : Accuracy: 0.6299
2024-08-12 12:57:48,435 : INFO : Precision score for label_class 0: 0.1522
2024-08-12 12:57:48,435 : INFO : Precision score for label_class 1: 0.7000
2024-08-12 12:57:48,435 : INFO : Precision score for label_class 2: 0.5558
2024-08-12 12:57:48,435 : INFO : Recall score for label_class 0: 0.1070
2024-08-12 12:57:48,435 : INFO : Recall score for label_class 1: 0.8766
2024-08-12 12:57:48,435 : INFO : Recall score for label_class 2: 0.3249
2024-08-12 12:57:48,435 : INFO : Average F1 score: 0.4381
2024-08-12 12:57:48,715 : INFO : Average loss over validation batches: 0.6380
2024-08-12 12:57:48,715 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:48,716 : INFO : Validation metrics:
2024-08-12 12:57:48,716 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:48,719 : INFO : Accuracy: 0.7270
2024-08-12 12:57:48,719 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:57:48,719 : INFO : Precision score for label_class 1: 0.7868
2024-08-12 12:57:48,719 : INFO : Precision score for label_class 2: 0.5902
2024-08-12 12:57:48,719 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:57:48,719 : INFO : Recall score for label_class 1: 0.9462
2024-08-12 12:57:48,719 : INFO : Recall score for label_class 2: 0.6142
2024-08-12 12:57:48,719 : INFO : Average F1 score: 0.4870
2024-08-12 12:57:48,719 : INFO : Validation metric decreased (inf --> 0.638029).  Saving model ...
2024-08-12 12:57:48,826 : INFO : Starting epoch 2
2024-08-12 12:57:49,474 : INFO : Current training batch loss: 0.5985 in epoch 2
2024-08-12 12:57:50,283 : INFO : Current training batch loss: 0.4089 in epoch 2
2024-08-12 12:57:51,094 : INFO : Current training batch loss: 0.2860 in epoch 2
2024-08-12 12:57:51,904 : INFO : Current training batch loss: 0.4573 in epoch 2
2024-08-12 12:57:52,251 : INFO : Epoch finished, average loss over training batches: 0.4534
2024-08-12 12:57:52,252 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:52,252 : INFO : Training metrics:
2024-08-12 12:57:52,252 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:52,257 : INFO : Accuracy: 0.8485
2024-08-12 12:57:52,257 : INFO : Precision score for label_class 0: 0.7897
2024-08-12 12:57:52,257 : INFO : Precision score for label_class 1: 0.8807
2024-08-12 12:57:52,257 : INFO : Precision score for label_class 2: 0.7952
2024-08-12 12:57:52,257 : INFO : Recall score for label_class 0: 0.7003
2024-08-12 12:57:52,257 : INFO : Recall score for label_class 1: 0.9241
2024-08-12 12:57:52,257 : INFO : Recall score for label_class 2: 0.7497
2024-08-12 12:57:52,257 : INFO : Average F1 score: 0.8053
2024-08-12 12:57:52,537 : INFO : Average loss over validation batches: 0.3856
2024-08-12 12:57:52,537 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:52,537 : INFO : Validation metrics:
2024-08-12 12:57:52,537 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:52,541 : INFO : Accuracy: 0.8531
2024-08-12 12:57:52,541 : INFO : Precision score for label_class 0: 0.7292
2024-08-12 12:57:52,541 : INFO : Precision score for label_class 1: 0.8832
2024-08-12 12:57:52,541 : INFO : Precision score for label_class 2: 0.8503
2024-08-12 12:57:52,541 : INFO : Recall score for label_class 0: 0.8046
2024-08-12 12:57:52,541 : INFO : Recall score for label_class 1: 0.9308
2024-08-12 12:57:52,541 : INFO : Recall score for label_class 2: 0.7208
2024-08-12 12:57:52,541 : INFO : Average F1 score: 0.8172
2024-08-12 12:57:52,541 : INFO : Validation metric decreased (0.638029 --> 0.385586).  Saving model ...
2024-08-12 12:57:52,638 : INFO : Starting epoch 3
2024-08-12 12:57:53,085 : INFO : Current training batch loss: 0.2850 in epoch 3
2024-08-12 12:57:53,895 : INFO : Current training batch loss: 0.2229 in epoch 3
2024-08-12 12:57:54,705 : INFO : Current training batch loss: 0.3381 in epoch 3
2024-08-12 12:57:55,516 : INFO : Current training batch loss: 0.0853 in epoch 3
2024-08-12 12:57:56,065 : INFO : Epoch finished, average loss over training batches: 0.2575
2024-08-12 12:57:56,065 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:56,065 : INFO : Training metrics:
2024-08-12 12:57:56,065 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:56,070 : INFO : Accuracy: 0.9196
2024-08-12 12:57:56,070 : INFO : Precision score for label_class 0: 0.8601
2024-08-12 12:57:56,070 : INFO : Precision score for label_class 1: 0.9454
2024-08-12 12:57:56,070 : INFO : Precision score for label_class 2: 0.8893
2024-08-12 12:57:56,070 : INFO : Recall score for label_class 0: 0.8838
2024-08-12 12:57:56,070 : INFO : Recall score for label_class 1: 0.9513
2024-08-12 12:57:56,070 : INFO : Recall score for label_class 2: 0.8668
2024-08-12 12:57:56,070 : INFO : Average F1 score: 0.8994
2024-08-12 12:57:56,351 : INFO : Average loss over validation batches: 0.3744
2024-08-12 12:57:56,351 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:56,351 : INFO : Validation metrics:
2024-08-12 12:57:56,351 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:56,354 : INFO : Accuracy: 0.8635
2024-08-12 12:57:56,354 : INFO : Precision score for label_class 0: 0.8462
2024-08-12 12:57:56,354 : INFO : Precision score for label_class 1: 0.8970
2024-08-12 12:57:56,354 : INFO : Precision score for label_class 2: 0.8030
2024-08-12 12:57:56,354 : INFO : Recall score for label_class 0: 0.7586
2024-08-12 12:57:56,354 : INFO : Recall score for label_class 1: 0.9154
2024-08-12 12:57:56,354 : INFO : Recall score for label_class 2: 0.8071
2024-08-12 12:57:56,354 : INFO : Average F1 score: 0.8371
2024-08-12 12:57:56,354 : INFO : Validation metric decreased (0.385586 --> 0.374448).  Saving model ...
2024-08-12 12:57:56,457 : INFO : Starting epoch 4
2024-08-12 12:57:56,701 : INFO : Current training batch loss: 0.3344 in epoch 4
2024-08-12 12:57:57,510 : INFO : Current training batch loss: 0.1974 in epoch 4
2024-08-12 12:57:58,320 : INFO : Current training batch loss: 0.1049 in epoch 4
2024-08-12 12:57:59,130 : INFO : Current training batch loss: 0.1608 in epoch 4
2024-08-12 12:57:59,882 : INFO : Epoch finished, average loss over training batches: 0.1600
2024-08-12 12:57:59,882 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:59,883 : INFO : Training metrics:
2024-08-12 12:57:59,883 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:57:59,887 : INFO : Accuracy: 0.9537
2024-08-12 12:57:59,887 : INFO : Precision score for label_class 0: 0.8997
2024-08-12 12:57:59,887 : INFO : Precision score for label_class 1: 0.9716
2024-08-12 12:57:59,887 : INFO : Precision score for label_class 2: 0.9393
2024-08-12 12:57:59,887 : INFO : Recall score for label_class 0: 0.9327
2024-08-12 12:57:59,887 : INFO : Recall score for label_class 1: 0.9704
2024-08-12 12:57:59,887 : INFO : Recall score for label_class 2: 0.9268
2024-08-12 12:57:59,887 : INFO : Average F1 score: 0.9400
2024-08-12 12:58:00,166 : INFO : Average loss over validation batches: 0.3840
2024-08-12 12:58:00,166 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:00,166 : INFO : Validation metrics:
2024-08-12 12:58:00,166 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:00,170 : INFO : Accuracy: 0.8635
2024-08-12 12:58:00,170 : INFO : Precision score for label_class 0: 0.7978
2024-08-12 12:58:00,170 : INFO : Precision score for label_class 1: 0.9046
2024-08-12 12:58:00,170 : INFO : Precision score for label_class 2: 0.8122
2024-08-12 12:58:00,170 : INFO : Recall score for label_class 0: 0.8161
2024-08-12 12:58:00,170 : INFO : Recall score for label_class 1: 0.9000
2024-08-12 12:58:00,170 : INFO : Recall score for label_class 2: 0.8122
2024-08-12 12:58:00,170 : INFO : Average F1 score: 0.8404
2024-08-12 12:58:00,170 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 12:58:00,170 : INFO : Starting epoch 5
2024-08-12 12:58:00,212 : INFO : Current training batch loss: 0.0499 in epoch 5
2024-08-12 12:58:01,021 : INFO : Current training batch loss: 0.1225 in epoch 5
2024-08-12 12:58:01,831 : INFO : Current training batch loss: 0.0266 in epoch 5
2024-08-12 12:58:02,642 : INFO : Current training batch loss: 0.0745 in epoch 5
2024-08-12 12:58:03,452 : INFO : Current training batch loss: 0.3373 in epoch 5
2024-08-12 12:58:03,597 : INFO : Epoch finished, average loss over training batches: 0.0963
2024-08-12 12:58:03,598 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:03,598 : INFO : Training metrics:
2024-08-12 12:58:03,598 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:03,605 : INFO : Accuracy: 0.9755
2024-08-12 12:58:03,605 : INFO : Precision score for label_class 0: 0.9265
2024-08-12 12:58:03,605 : INFO : Precision score for label_class 1: 0.9870
2024-08-12 12:58:03,605 : INFO : Precision score for label_class 2: 0.9732
2024-08-12 12:58:03,605 : INFO : Recall score for label_class 0: 0.9633
2024-08-12 12:58:03,605 : INFO : Recall score for label_class 1: 0.9827
2024-08-12 12:58:03,605 : INFO : Recall score for label_class 2: 0.9654
2024-08-12 12:58:03,605 : INFO : Average F1 score: 0.9662
2024-08-12 12:58:03,884 : INFO : Average loss over validation batches: 0.4144
2024-08-12 12:58:03,884 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:03,884 : INFO : Validation metrics:
2024-08-12 12:58:03,884 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:03,888 : INFO : Accuracy: 0.8680
2024-08-12 12:58:03,888 : INFO : Precision score for label_class 0: 0.7789
2024-08-12 12:58:03,888 : INFO : Precision score for label_class 1: 0.8987
2024-08-12 12:58:03,888 : INFO : Precision score for label_class 2: 0.8478
2024-08-12 12:58:03,888 : INFO : Recall score for label_class 0: 0.8506
2024-08-12 12:58:03,888 : INFO : Recall score for label_class 1: 0.9103
2024-08-12 12:58:03,888 : INFO : Recall score for label_class 2: 0.7919
2024-08-12 12:58:03,888 : INFO : Average F1 score: 0.8455
2024-08-12 12:58:03,888 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 12:58:03,888 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:58:04,014 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 12:58:04,329 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:04,329 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 12:58:04,329 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:04,332 : INFO : Accuracy: 0.8635
2024-08-12 12:58:04,333 : INFO : Precision score for label_class 0: 0.8462
2024-08-12 12:58:04,333 : INFO : Precision score for label_class 1: 0.8970
2024-08-12 12:58:04,333 : INFO : Precision score for label_class 2: 0.8030
2024-08-12 12:58:04,333 : INFO : Recall score for label_class 0: 0.7586
2024-08-12 12:58:04,333 : INFO : Recall score for label_class 1: 0.9154
2024-08-12 12:58:04,333 : INFO : Recall score for label_class 2: 0.8071
2024-08-12 12:58:04,333 : INFO : Average F1 score: 0.8371
2024-08-12 12:58:04,333 : INFO : Determined score from best model, ending training.
2024-08-12 12:58:04,334 : INFO : Split 4 is finished, the score is: 0.8371
2024-08-12 12:58:04,334 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:04,334 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:04,334 : INFO : Starting training for split 5
2024-08-12 12:58:04,351 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 330, 1615,  754]))
2024-08-12 12:58:04,353 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 84, 396, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:58:04,405 : INFO : Starting epoch 1
2024-08-12 12:58:04,448 : INFO : Current training batch loss: 1.1170 in epoch 1
2024-08-12 12:58:05,258 : INFO : Current training batch loss: 1.0100 in epoch 1
2024-08-12 12:58:06,068 : INFO : Current training batch loss: 0.7810 in epoch 1
2024-08-12 12:58:06,878 : INFO : Current training batch loss: 0.6420 in epoch 1
2024-08-12 12:58:07,689 : INFO : Current training batch loss: 0.6839 in epoch 1
2024-08-12 12:58:07,834 : INFO : Epoch finished, average loss over training batches: 0.8399
2024-08-12 12:58:07,834 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:07,834 : INFO : Training metrics:
2024-08-12 12:58:07,834 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:07,845 : INFO : Accuracy: 0.6299
2024-08-12 12:58:07,845 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:58:07,845 : INFO : Precision score for label_class 1: 0.6983
2024-08-12 12:58:07,845 : INFO : Precision score for label_class 2: 0.4417
2024-08-12 12:58:07,845 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:58:07,845 : INFO : Recall score for label_class 1: 0.8557
2024-08-12 12:58:07,845 : INFO : Recall score for label_class 2: 0.4218
2024-08-12 12:58:07,845 : INFO : Average F1 score: 0.4002
2024-08-12 12:58:08,126 : INFO : Average loss over validation batches: 0.6236
2024-08-12 12:58:08,126 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:08,126 : INFO : Validation metrics:
2024-08-12 12:58:08,126 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:08,130 : INFO : Accuracy: 0.7226
2024-08-12 12:58:08,130 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:58:08,130 : INFO : Precision score for label_class 1: 0.7961
2024-08-12 12:58:08,130 : INFO : Precision score for label_class 2: 0.5577
2024-08-12 12:58:08,130 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:58:08,130 : INFO : Recall score for label_class 1: 0.9369
2024-08-12 12:58:08,130 : INFO : Recall score for label_class 2: 0.5979
2024-08-12 12:58:08,130 : INFO : Average F1 score: 0.4793
2024-08-12 12:58:08,130 : INFO : Validation metric decreased (inf --> 0.623602).  Saving model ...
2024-08-12 12:58:08,241 : INFO : Starting epoch 2
2024-08-12 12:58:08,889 : INFO : Current training batch loss: 0.5900 in epoch 2
2024-08-12 12:58:09,699 : INFO : Current training batch loss: 0.3975 in epoch 2
2024-08-12 12:58:10,509 : INFO : Current training batch loss: 0.2731 in epoch 2
2024-08-12 12:58:11,319 : INFO : Current training batch loss: 0.4497 in epoch 2
2024-08-12 12:58:11,667 : INFO : Epoch finished, average loss over training batches: 0.4660
2024-08-12 12:58:11,667 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:11,667 : INFO : Training metrics:
2024-08-12 12:58:11,667 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:11,674 : INFO : Accuracy: 0.8385
2024-08-12 12:58:11,674 : INFO : Precision score for label_class 0: 0.7606
2024-08-12 12:58:11,674 : INFO : Precision score for label_class 1: 0.8728
2024-08-12 12:58:11,674 : INFO : Precision score for label_class 2: 0.7839
2024-08-12 12:58:11,674 : INFO : Recall score for label_class 0: 0.6545
2024-08-12 12:58:11,674 : INFO : Recall score for label_class 1: 0.9350
2024-08-12 12:58:11,674 : INFO : Recall score for label_class 2: 0.7122
2024-08-12 12:58:11,674 : INFO : Average F1 score: 0.7843
2024-08-12 12:58:11,954 : INFO : Average loss over validation batches: 0.4319
2024-08-12 12:58:11,955 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:11,955 : INFO : Validation metrics:
2024-08-12 12:58:11,955 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:11,958 : INFO : Accuracy: 0.8383
2024-08-12 12:58:11,959 : INFO : Precision score for label_class 0: 0.7284
2024-08-12 12:58:11,959 : INFO : Precision score for label_class 1: 0.8690
2024-08-12 12:58:11,959 : INFO : Precision score for label_class 2: 0.8150
2024-08-12 12:58:11,959 : INFO : Recall score for label_class 0: 0.7024
2024-08-12 12:58:11,959 : INFO : Recall score for label_class 1: 0.9217
2024-08-12 12:58:11,959 : INFO : Recall score for label_class 2: 0.7268
2024-08-12 12:58:11,959 : INFO : Average F1 score: 0.7927
2024-08-12 12:58:11,959 : INFO : Validation metric decreased (0.623602 --> 0.431921).  Saving model ...
2024-08-12 12:58:12,060 : INFO : Starting epoch 3
2024-08-12 12:58:12,506 : INFO : Current training batch loss: 0.2507 in epoch 3
2024-08-12 12:58:13,315 : INFO : Current training batch loss: 0.3633 in epoch 3
2024-08-12 12:58:14,125 : INFO : Current training batch loss: 0.3001 in epoch 3
2024-08-12 12:58:14,936 : INFO : Current training batch loss: 0.1576 in epoch 3
2024-08-12 12:58:15,486 : INFO : Epoch finished, average loss over training batches: 0.2633
2024-08-12 12:58:15,486 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:15,486 : INFO : Training metrics:
2024-08-12 12:58:15,486 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:15,493 : INFO : Accuracy: 0.9207
2024-08-12 12:58:15,493 : INFO : Precision score for label_class 0: 0.8441
2024-08-12 12:58:15,493 : INFO : Precision score for label_class 1: 0.9452
2024-08-12 12:58:15,493 : INFO : Precision score for label_class 2: 0.9020
2024-08-12 12:58:15,493 : INFO : Recall score for label_class 0: 0.8697
2024-08-12 12:58:15,494 : INFO : Recall score for label_class 1: 0.9505
2024-08-12 12:58:15,494 : INFO : Recall score for label_class 2: 0.8793
2024-08-12 12:58:15,494 : INFO : Average F1 score: 0.8984
2024-08-12 12:58:15,774 : INFO : Average loss over validation batches: 0.3905
2024-08-12 12:58:15,774 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:15,775 : INFO : Validation metrics:
2024-08-12 12:58:15,775 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:15,778 : INFO : Accuracy: 0.8620
2024-08-12 12:58:15,778 : INFO : Precision score for label_class 0: 0.8133
2024-08-12 12:58:15,778 : INFO : Precision score for label_class 1: 0.9050
2024-08-12 12:58:15,778 : INFO : Precision score for label_class 2: 0.7940
2024-08-12 12:58:15,778 : INFO : Recall score for label_class 0: 0.7262
2024-08-12 12:58:15,778 : INFO : Recall score for label_class 1: 0.9141
2024-08-12 12:58:15,779 : INFO : Recall score for label_class 2: 0.8144
2024-08-12 12:58:15,779 : INFO : Average F1 score: 0.8270
2024-08-12 12:58:15,779 : INFO : Validation metric decreased (0.431921 --> 0.390477).  Saving model ...
2024-08-12 12:58:15,881 : INFO : Starting epoch 4
2024-08-12 12:58:16,125 : INFO : Current training batch loss: 0.2970 in epoch 4
2024-08-12 12:58:16,935 : INFO : Current training batch loss: 0.2116 in epoch 4
2024-08-12 12:58:17,745 : INFO : Current training batch loss: 0.2180 in epoch 4
2024-08-12 12:58:18,555 : INFO : Current training batch loss: 0.0857 in epoch 4
2024-08-12 12:58:19,308 : INFO : Epoch finished, average loss over training batches: 0.1533
2024-08-12 12:58:19,308 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:19,308 : INFO : Training metrics:
2024-08-12 12:58:19,308 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:19,315 : INFO : Accuracy: 0.9567
2024-08-12 12:58:19,315 : INFO : Precision score for label_class 0: 0.8924
2024-08-12 12:58:19,315 : INFO : Precision score for label_class 1: 0.9757
2024-08-12 12:58:19,315 : INFO : Precision score for label_class 2: 0.9453
2024-08-12 12:58:19,315 : INFO : Recall score for label_class 0: 0.9303
2024-08-12 12:58:19,315 : INFO : Recall score for label_class 1: 0.9703
2024-08-12 12:58:19,315 : INFO : Recall score for label_class 2: 0.9390
2024-08-12 12:58:19,315 : INFO : Average F1 score: 0.9420
2024-08-12 12:58:19,596 : INFO : Average loss over validation batches: 0.4093
2024-08-12 12:58:19,596 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:19,596 : INFO : Validation metrics:
2024-08-12 12:58:19,596 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:19,599 : INFO : Accuracy: 0.8635
2024-08-12 12:58:19,599 : INFO : Precision score for label_class 0: 0.7831
2024-08-12 12:58:19,599 : INFO : Precision score for label_class 1: 0.8968
2024-08-12 12:58:19,599 : INFO : Precision score for label_class 2: 0.8261
2024-08-12 12:58:19,599 : INFO : Recall score for label_class 0: 0.7738
2024-08-12 12:58:19,599 : INFO : Recall score for label_class 1: 0.9217
2024-08-12 12:58:19,599 : INFO : Recall score for label_class 2: 0.7835
2024-08-12 12:58:19,599 : INFO : Average F1 score: 0.8306
2024-08-12 12:58:19,599 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 12:58:19,599 : INFO : Starting epoch 5
2024-08-12 12:58:19,641 : INFO : Current training batch loss: 0.0552 in epoch 5
2024-08-12 12:58:20,451 : INFO : Current training batch loss: 0.0582 in epoch 5
2024-08-12 12:58:21,261 : INFO : Current training batch loss: 0.1066 in epoch 5
2024-08-12 12:58:22,072 : INFO : Current training batch loss: 0.0815 in epoch 5
2024-08-12 12:58:22,882 : INFO : Current training batch loss: 0.0523 in epoch 5
2024-08-12 12:58:23,027 : INFO : Epoch finished, average loss over training batches: 0.0967
2024-08-12 12:58:23,028 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:23,028 : INFO : Training metrics:
2024-08-12 12:58:23,028 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:23,038 : INFO : Accuracy: 0.9744
2024-08-12 12:58:23,038 : INFO : Precision score for label_class 0: 0.9267
2024-08-12 12:58:23,038 : INFO : Precision score for label_class 1: 0.9869
2024-08-12 12:58:23,038 : INFO : Precision score for label_class 2: 0.9693
2024-08-12 12:58:23,038 : INFO : Recall score for label_class 0: 0.9576
2024-08-12 12:58:23,038 : INFO : Recall score for label_class 1: 0.9827
2024-08-12 12:58:23,038 : INFO : Recall score for label_class 2: 0.9642
2024-08-12 12:58:23,038 : INFO : Average F1 score: 0.9645
2024-08-12 12:58:23,318 : INFO : Average loss over validation batches: 0.4766
2024-08-12 12:58:23,318 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:23,318 : INFO : Validation metrics:
2024-08-12 12:58:23,318 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:23,322 : INFO : Accuracy: 0.8472
2024-08-12 12:58:23,322 : INFO : Precision score for label_class 0: 0.6325
2024-08-12 12:58:23,322 : INFO : Precision score for label_class 1: 0.9321
2024-08-12 12:58:23,322 : INFO : Precision score for label_class 2: 0.8148
2024-08-12 12:58:23,322 : INFO : Recall score for label_class 0: 0.8810
2024-08-12 12:58:23,322 : INFO : Recall score for label_class 1: 0.8662
2024-08-12 12:58:23,322 : INFO : Recall score for label_class 2: 0.7938
2024-08-12 12:58:23,322 : INFO : Average F1 score: 0.8128
2024-08-12 12:58:23,322 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 12:58:23,322 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:58:23,359 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 12:58:23,675 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:23,675 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 12:58:23,675 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:23,679 : INFO : Accuracy: 0.8620
2024-08-12 12:58:23,679 : INFO : Precision score for label_class 0: 0.8133
2024-08-12 12:58:23,679 : INFO : Precision score for label_class 1: 0.9050
2024-08-12 12:58:23,679 : INFO : Precision score for label_class 2: 0.7940
2024-08-12 12:58:23,679 : INFO : Recall score for label_class 0: 0.7262
2024-08-12 12:58:23,679 : INFO : Recall score for label_class 1: 0.9141
2024-08-12 12:58:23,679 : INFO : Recall score for label_class 2: 0.8144
2024-08-12 12:58:23,679 : INFO : Average F1 score: 0.8270
2024-08-12 12:58:23,679 : INFO : Determined score from best model, ending training.
2024-08-12 12:58:23,681 : INFO : Split 5 is finished, the score is: 0.8270
2024-08-12 12:58:23,681 : INFO : ----------------------------------------------------------------------------------------------------
[I 2024-08-12 12:58:23,681] Trial 6 finished with value: 0.8419854360165029 and parameters: {'n_epochs': 9, 'learning_rate': 4.878346120794999e-05, 'classifier_dropout': 0.8899027085471156, 'warmup_step_fraction': 0.02931397528633447, 'use_gradient_clipping': False}. Best is trial 6 with value: 0.8419854360165029.
2024-08-12 12:58:23,682 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:23,682 : INFO : Starting training for split 1
2024-08-12 12:58:23,698 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 328, 1596,  774]))
2024-08-12 12:58:23,700 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 86, 415, 174]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:58:23,750 : INFO : Starting epoch 1
2024-08-12 12:58:23,792 : INFO : Current training batch loss: 1.0807 in epoch 1
2024-08-12 12:58:24,602 : INFO : Current training batch loss: 0.9406 in epoch 1
2024-08-12 12:58:25,413 : INFO : Current training batch loss: 0.9726 in epoch 1
2024-08-12 12:58:26,223 : INFO : Current training batch loss: 0.7753 in epoch 1
2024-08-12 12:58:27,033 : INFO : Current training batch loss: 0.8033 in epoch 1
2024-08-12 12:58:27,178 : INFO : Epoch finished, average loss over training batches: 0.8862
2024-08-12 12:58:27,179 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:27,179 : INFO : Training metrics:
2024-08-12 12:58:27,179 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:27,187 : INFO : Accuracy: 0.6345
2024-08-12 12:58:27,187 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:58:27,187 : INFO : Precision score for label_class 1: 0.6688
2024-08-12 12:58:27,187 : INFO : Precision score for label_class 2: 0.4795
2024-08-12 12:58:27,187 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:58:27,187 : INFO : Recall score for label_class 1: 0.9261
2024-08-12 12:58:27,187 : INFO : Recall score for label_class 2: 0.3023
2024-08-12 12:58:27,187 : INFO : Average F1 score: 0.3825
2024-08-12 12:58:27,467 : INFO : Average loss over validation batches: 0.7086
2024-08-12 12:58:27,467 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:27,467 : INFO : Validation metrics:
2024-08-12 12:58:27,468 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:27,470 : INFO : Accuracy: 0.7200
2024-08-12 12:58:27,470 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:58:27,470 : INFO : Precision score for label_class 1: 0.7948
2024-08-12 12:58:27,470 : INFO : Precision score for label_class 2: 0.5112
2024-08-12 12:58:27,470 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:58:27,470 : INFO : Recall score for label_class 1: 0.9518
2024-08-12 12:58:27,470 : INFO : Recall score for label_class 2: 0.5230
2024-08-12 12:58:27,470 : INFO : Average F1 score: 0.4611
2024-08-12 12:58:27,470 : INFO : Validation metric decreased (inf --> 0.708623).  Saving model ...
2024-08-12 12:58:27,579 : INFO : Starting epoch 2
2024-08-12 12:58:28,227 : INFO : Current training batch loss: 0.4898 in epoch 2
2024-08-12 12:58:29,038 : INFO : Current training batch loss: 0.6458 in epoch 2
2024-08-12 12:58:29,848 : INFO : Current training batch loss: 0.5685 in epoch 2
2024-08-12 12:58:30,659 : INFO : Current training batch loss: 0.4603 in epoch 2
2024-08-12 12:58:31,007 : INFO : Epoch finished, average loss over training batches: 0.5940
2024-08-12 12:58:31,007 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:31,007 : INFO : Training metrics:
2024-08-12 12:58:31,007 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:31,015 : INFO : Accuracy: 0.7683
2024-08-12 12:58:31,015 : INFO : Precision score for label_class 0: 0.5000
2024-08-12 12:58:31,015 : INFO : Precision score for label_class 1: 0.8497
2024-08-12 12:58:31,015 : INFO : Precision score for label_class 2: 0.6115
2024-08-12 12:58:31,015 : INFO : Recall score for label_class 0: 0.0030
2024-08-12 12:58:31,015 : INFO : Recall score for label_class 1: 0.9461
2024-08-12 12:58:31,015 : INFO : Recall score for label_class 2: 0.7261
2024-08-12 12:58:31,015 : INFO : Average F1 score: 0.5218
2024-08-12 12:58:31,295 : INFO : Average loss over validation batches: 0.5463
2024-08-12 12:58:31,295 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:31,295 : INFO : Validation metrics:
2024-08-12 12:58:31,295 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:31,298 : INFO : Accuracy: 0.7719
2024-08-12 12:58:31,298 : INFO : Precision score for label_class 0: 0.7500
2024-08-12 12:58:31,298 : INFO : Precision score for label_class 1: 0.8819
2024-08-12 12:58:31,298 : INFO : Precision score for label_class 2: 0.5732
2024-08-12 12:58:31,298 : INFO : Recall score for label_class 0: 0.0349
2024-08-12 12:58:31,298 : INFO : Recall score for label_class 1: 0.9181
2024-08-12 12:58:31,298 : INFO : Recall score for label_class 2: 0.7874
2024-08-12 12:58:31,298 : INFO : Average F1 score: 0.5433
2024-08-12 12:58:31,298 : INFO : Validation metric decreased (0.708623 --> 0.546290).  Saving model ...
2024-08-12 12:58:31,399 : INFO : Starting epoch 3
2024-08-12 12:58:31,846 : INFO : Current training batch loss: 0.4792 in epoch 3
2024-08-12 12:58:32,656 : INFO : Current training batch loss: 0.4886 in epoch 3
2024-08-12 12:58:33,465 : INFO : Current training batch loss: 0.4095 in epoch 3
2024-08-12 12:58:34,271 : INFO : Current training batch loss: 0.3138 in epoch 3
2024-08-12 12:58:34,814 : INFO : Epoch finished, average loss over training batches: 0.4426
2024-08-12 12:58:34,814 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:34,814 : INFO : Training metrics:
2024-08-12 12:58:34,814 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:34,823 : INFO : Accuracy: 0.8647
2024-08-12 12:58:34,823 : INFO : Precision score for label_class 0: 0.8478
2024-08-12 12:58:34,823 : INFO : Precision score for label_class 1: 0.9045
2024-08-12 12:58:34,823 : INFO : Precision score for label_class 2: 0.7858
2024-08-12 12:58:34,823 : INFO : Recall score for label_class 0: 0.4756
2024-08-12 12:58:34,823 : INFO : Recall score for label_class 1: 0.9618
2024-08-12 12:58:34,823 : INFO : Recall score for label_class 2: 0.8295
2024-08-12 12:58:34,823 : INFO : Average F1 score: 0.7829
2024-08-12 12:58:35,103 : INFO : Average loss over validation batches: 0.4719
2024-08-12 12:58:35,103 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:35,103 : INFO : Validation metrics:
2024-08-12 12:58:35,103 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:35,106 : INFO : Accuracy: 0.8504
2024-08-12 12:58:35,106 : INFO : Precision score for label_class 0: 0.8060
2024-08-12 12:58:35,106 : INFO : Precision score for label_class 1: 0.8858
2024-08-12 12:58:35,106 : INFO : Precision score for label_class 2: 0.7765
2024-08-12 12:58:35,106 : INFO : Recall score for label_class 0: 0.6279
2024-08-12 12:58:35,106 : INFO : Recall score for label_class 1: 0.9349
2024-08-12 12:58:35,106 : INFO : Recall score for label_class 2: 0.7586
2024-08-12 12:58:35,106 : INFO : Average F1 score: 0.7944
2024-08-12 12:58:35,106 : INFO : Validation metric decreased (0.546290 --> 0.471896).  Saving model ...
2024-08-12 12:58:35,205 : INFO : Split 1 is finished, the score is: 0.7944
2024-08-12 12:58:35,206 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:35,206 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:35,206 : INFO : Starting training for split 2
2024-08-12 12:58:35,218 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 343, 1601,  754]))
2024-08-12 12:58:35,220 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 71, 410, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:58:35,269 : INFO : Starting epoch 1
2024-08-12 12:58:35,311 : INFO : Current training batch loss: 1.1288 in epoch 1
2024-08-12 12:58:36,116 : INFO : Current training batch loss: 1.0439 in epoch 1
2024-08-12 12:58:36,923 : INFO : Current training batch loss: 1.0168 in epoch 1
2024-08-12 12:58:37,728 : INFO : Current training batch loss: 0.8104 in epoch 1
2024-08-12 12:58:38,534 : INFO : Current training batch loss: 0.8435 in epoch 1
2024-08-12 12:58:38,675 : INFO : Epoch finished, average loss over training batches: 0.9254
2024-08-12 12:58:38,675 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:38,675 : INFO : Training metrics:
2024-08-12 12:58:38,675 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:38,686 : INFO : Accuracy: 0.5567
2024-08-12 12:58:38,686 : INFO : Precision score for label_class 0: 0.1917
2024-08-12 12:58:38,686 : INFO : Precision score for label_class 1: 0.6368
2024-08-12 12:58:38,686 : INFO : Precision score for label_class 2: 0.4694
2024-08-12 12:58:38,686 : INFO : Recall score for label_class 0: 0.2303
2024-08-12 12:58:38,686 : INFO : Recall score for label_class 1: 0.8314
2024-08-12 12:58:38,686 : INFO : Recall score for label_class 2: 0.1220
2024-08-12 12:58:38,686 : INFO : Average F1 score: 0.3747
2024-08-12 12:58:38,965 : INFO : Average loss over validation batches: 0.7158
2024-08-12 12:58:38,966 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:38,966 : INFO : Validation metrics:
2024-08-12 12:58:38,966 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:38,970 : INFO : Accuracy: 0.7215
2024-08-12 12:58:38,970 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:58:38,970 : INFO : Precision score for label_class 1: 0.7866
2024-08-12 12:58:38,970 : INFO : Precision score for label_class 2: 0.5635
2024-08-12 12:58:38,970 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:58:38,970 : INFO : Recall score for label_class 1: 0.9171
2024-08-12 12:58:38,970 : INFO : Recall score for label_class 2: 0.5722
2024-08-12 12:58:38,970 : INFO : Average F1 score: 0.4715
2024-08-12 12:58:38,970 : INFO : Validation metric decreased (inf --> 0.715769).  Saving model ...
2024-08-12 12:58:39,075 : INFO : Starting epoch 2
2024-08-12 12:58:39,720 : INFO : Current training batch loss: 0.6836 in epoch 2
2024-08-12 12:58:40,525 : INFO : Current training batch loss: 0.6251 in epoch 2
2024-08-12 12:58:41,330 : INFO : Current training batch loss: 0.5556 in epoch 2
2024-08-12 12:58:42,136 : INFO : Current training batch loss: 0.4453 in epoch 2
2024-08-12 12:58:42,478 : INFO : Epoch finished, average loss over training batches: 0.6012
2024-08-12 12:58:42,478 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:42,478 : INFO : Training metrics:
2024-08-12 12:58:42,478 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:42,486 : INFO : Accuracy: 0.7809
2024-08-12 12:58:42,486 : INFO : Precision score for label_class 0: 0.8036
2024-08-12 12:58:42,486 : INFO : Precision score for label_class 1: 0.8439
2024-08-12 12:58:42,486 : INFO : Precision score for label_class 2: 0.6370
2024-08-12 12:58:42,486 : INFO : Recall score for label_class 0: 0.2624
2024-08-12 12:58:42,486 : INFO : Recall score for label_class 1: 0.9419
2024-08-12 12:58:42,486 : INFO : Recall score for label_class 2: 0.6751
2024-08-12 12:58:42,486 : INFO : Average F1 score: 0.6471
2024-08-12 12:58:42,765 : INFO : Average loss over validation batches: 0.5054
2024-08-12 12:58:42,766 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:42,766 : INFO : Validation metrics:
2024-08-12 12:58:42,766 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:42,769 : INFO : Accuracy: 0.8415
2024-08-12 12:58:42,769 : INFO : Precision score for label_class 0: 0.8125
2024-08-12 12:58:42,769 : INFO : Precision score for label_class 1: 0.8629
2024-08-12 12:58:42,769 : INFO : Precision score for label_class 2: 0.7967
2024-08-12 12:58:42,769 : INFO : Recall score for label_class 0: 0.5493
2024-08-12 12:58:42,769 : INFO : Recall score for label_class 1: 0.9366
2024-08-12 12:58:42,769 : INFO : Recall score for label_class 2: 0.7474
2024-08-12 12:58:42,769 : INFO : Average F1 score: 0.7750
2024-08-12 12:58:42,769 : INFO : Validation metric decreased (0.715769 --> 0.505427).  Saving model ...
2024-08-12 12:58:42,867 : INFO : Starting epoch 3
2024-08-12 12:58:43,307 : INFO : Current training batch loss: 0.3949 in epoch 3
2024-08-12 12:58:44,108 : INFO : Current training batch loss: 0.4503 in epoch 3
2024-08-12 12:58:44,908 : INFO : Current training batch loss: 0.4195 in epoch 3
2024-08-12 12:58:45,709 : INFO : Current training batch loss: 0.3199 in epoch 3
2024-08-12 12:58:46,242 : INFO : Epoch finished, average loss over training batches: 0.4211
2024-08-12 12:58:46,243 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:46,243 : INFO : Training metrics:
2024-08-12 12:58:46,243 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:46,253 : INFO : Accuracy: 0.8892
2024-08-12 12:58:46,253 : INFO : Precision score for label_class 0: 0.7878
2024-08-12 12:58:46,253 : INFO : Precision score for label_class 1: 0.9114
2024-08-12 12:58:46,253 : INFO : Precision score for label_class 2: 0.8854
2024-08-12 12:58:46,253 : INFO : Recall score for label_class 0: 0.7901
2024-08-12 12:58:46,253 : INFO : Recall score for label_class 1: 0.9575
2024-08-12 12:58:46,253 : INFO : Recall score for label_class 2: 0.7891
2024-08-12 12:58:46,253 : INFO : Average F1 score: 0.8524
2024-08-12 12:58:46,533 : INFO : Average loss over validation batches: 0.4430
2024-08-12 12:58:46,533 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:46,533 : INFO : Validation metrics:
2024-08-12 12:58:46,533 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:46,537 : INFO : Accuracy: 0.8607
2024-08-12 12:58:46,537 : INFO : Precision score for label_class 0: 0.7681
2024-08-12 12:58:46,537 : INFO : Precision score for label_class 1: 0.8710
2024-08-12 12:58:46,537 : INFO : Precision score for label_class 2: 0.8720
2024-08-12 12:58:46,537 : INFO : Recall score for label_class 0: 0.7465
2024-08-12 12:58:46,537 : INFO : Recall score for label_class 1: 0.9390
2024-08-12 12:58:46,537 : INFO : Recall score for label_class 2: 0.7371
2024-08-12 12:58:46,537 : INFO : Average F1 score: 0.8199
2024-08-12 12:58:46,537 : INFO : Validation metric decreased (0.505427 --> 0.443046).  Saving model ...
2024-08-12 12:58:46,635 : INFO : Split 2 is finished, the score is: 0.8199
2024-08-12 12:58:46,636 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:46,636 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:46,636 : INFO : Starting training for split 3
2024-08-12 12:58:46,647 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 328, 1611,  759]))
2024-08-12 12:58:46,649 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 86, 400, 189]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:58:46,692 : INFO : Starting epoch 1
2024-08-12 12:58:46,734 : INFO : Current training batch loss: 1.0965 in epoch 1
2024-08-12 12:58:47,534 : INFO : Current training batch loss: 1.0334 in epoch 1
2024-08-12 12:58:48,335 : INFO : Current training batch loss: 0.8588 in epoch 1
2024-08-12 12:58:49,136 : INFO : Current training batch loss: 0.7709 in epoch 1
2024-08-12 12:58:49,936 : INFO : Current training batch loss: 0.7624 in epoch 1
2024-08-12 12:58:50,070 : INFO : Epoch finished, average loss over training batches: 0.8775
2024-08-12 12:58:50,070 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:50,070 : INFO : Training metrics:
2024-08-12 12:58:50,070 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:50,079 : INFO : Accuracy: 0.6375
2024-08-12 12:58:50,079 : INFO : Precision score for label_class 0: 0.0441
2024-08-12 12:58:50,079 : INFO : Precision score for label_class 1: 0.6711
2024-08-12 12:58:50,079 : INFO : Precision score for label_class 2: 0.5418
2024-08-12 12:58:50,079 : INFO : Recall score for label_class 0: 0.0091
2024-08-12 12:58:50,079 : INFO : Recall score for label_class 1: 0.9410
2024-08-12 12:58:50,079 : INFO : Recall score for label_class 2: 0.2648
2024-08-12 12:58:50,079 : INFO : Average F1 score: 0.3848
2024-08-12 12:58:50,360 : INFO : Average loss over validation batches: 0.6706
2024-08-12 12:58:50,360 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:50,360 : INFO : Validation metrics:
2024-08-12 12:58:50,360 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:50,362 : INFO : Accuracy: 0.7289
2024-08-12 12:58:50,362 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:58:50,362 : INFO : Precision score for label_class 1: 0.8314
2024-08-12 12:58:50,362 : INFO : Precision score for label_class 2: 0.5381
2024-08-12 12:58:50,363 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:58:50,363 : INFO : Recall score for label_class 1: 0.9125
2024-08-12 12:58:50,363 : INFO : Recall score for label_class 2: 0.6720
2024-08-12 12:58:50,363 : INFO : Average F1 score: 0.4892
2024-08-12 12:58:50,363 : INFO : Validation metric decreased (inf --> 0.670598).  Saving model ...
2024-08-12 12:58:50,463 : INFO : Starting epoch 2
2024-08-12 12:58:51,103 : INFO : Current training batch loss: 0.6514 in epoch 2
2024-08-12 12:58:51,902 : INFO : Current training batch loss: 0.5632 in epoch 2
2024-08-12 12:58:52,702 : INFO : Current training batch loss: 0.5656 in epoch 2
2024-08-12 12:58:53,502 : INFO : Current training batch loss: 0.4493 in epoch 2
2024-08-12 12:58:53,835 : INFO : Epoch finished, average loss over training batches: 0.5807
2024-08-12 12:58:53,835 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:53,835 : INFO : Training metrics:
2024-08-12 12:58:53,835 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:53,845 : INFO : Accuracy: 0.7717
2024-08-12 12:58:53,845 : INFO : Precision score for label_class 0: 0.8333
2024-08-12 12:58:53,845 : INFO : Precision score for label_class 1: 0.8574
2024-08-12 12:58:53,845 : INFO : Precision score for label_class 2: 0.6076
2024-08-12 12:58:53,845 : INFO : Recall score for label_class 0: 0.0152
2024-08-12 12:58:53,845 : INFO : Recall score for label_class 1: 0.9404
2024-08-12 12:58:53,845 : INFO : Recall score for label_class 2: 0.7404
2024-08-12 12:58:53,845 : INFO : Average F1 score: 0.5315
2024-08-12 12:58:54,125 : INFO : Average loss over validation batches: 0.5174
2024-08-12 12:58:54,125 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:54,125 : INFO : Validation metrics:
2024-08-12 12:58:54,125 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:54,128 : INFO : Accuracy: 0.7941
2024-08-12 12:58:54,128 : INFO : Precision score for label_class 0: 0.8000
2024-08-12 12:58:54,128 : INFO : Precision score for label_class 1: 0.8773
2024-08-12 12:58:54,128 : INFO : Precision score for label_class 2: 0.6395
2024-08-12 12:58:54,128 : INFO : Recall score for label_class 0: 0.0930
2024-08-12 12:58:54,128 : INFO : Recall score for label_class 1: 0.9475
2024-08-12 12:58:54,128 : INFO : Recall score for label_class 2: 0.7884
2024-08-12 12:58:54,128 : INFO : Average F1 score: 0.5946
2024-08-12 12:58:54,128 : INFO : Validation metric decreased (0.670598 --> 0.517403).  Saving model ...
2024-08-12 12:58:54,227 : INFO : Starting epoch 3
2024-08-12 12:58:54,668 : INFO : Current training batch loss: 0.4506 in epoch 3
2024-08-12 12:58:55,469 : INFO : Current training batch loss: 0.4353 in epoch 3
2024-08-12 12:58:56,270 : INFO : Current training batch loss: 0.4239 in epoch 3
2024-08-12 12:58:57,071 : INFO : Current training batch loss: 0.3217 in epoch 3
2024-08-12 12:58:57,604 : INFO : Epoch finished, average loss over training batches: 0.4429
2024-08-12 12:58:57,605 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:57,605 : INFO : Training metrics:
2024-08-12 12:58:57,605 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:57,614 : INFO : Accuracy: 0.8599
2024-08-12 12:58:57,614 : INFO : Precision score for label_class 0: 0.8173
2024-08-12 12:58:57,614 : INFO : Precision score for label_class 1: 0.9026
2024-08-12 12:58:57,614 : INFO : Precision score for label_class 2: 0.7792
2024-08-12 12:58:57,614 : INFO : Recall score for label_class 0: 0.4909
2024-08-12 12:58:57,614 : INFO : Recall score for label_class 1: 0.9547
2024-08-12 12:58:57,614 : INFO : Recall score for label_class 2: 0.8182
2024-08-12 12:58:57,614 : INFO : Average F1 score: 0.7798
2024-08-12 12:58:57,894 : INFO : Average loss over validation batches: 0.4587
2024-08-12 12:58:57,894 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:57,894 : INFO : Validation metrics:
2024-08-12 12:58:57,894 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:57,897 : INFO : Accuracy: 0.8681
2024-08-12 12:58:57,897 : INFO : Precision score for label_class 0: 0.8333
2024-08-12 12:58:57,897 : INFO : Precision score for label_class 1: 0.8858
2024-08-12 12:58:57,897 : INFO : Precision score for label_class 2: 0.8391
2024-08-12 12:58:57,897 : INFO : Recall score for label_class 0: 0.6977
2024-08-12 12:58:57,897 : INFO : Recall score for label_class 1: 0.9500
2024-08-12 12:58:57,897 : INFO : Recall score for label_class 2: 0.7725
2024-08-12 12:58:57,897 : INFO : Average F1 score: 0.8269
2024-08-12 12:58:57,897 : INFO : Validation metric decreased (0.517403 --> 0.458747).  Saving model ...
2024-08-12 12:58:57,995 : INFO : Split 3 is finished, the score is: 0.8269
2024-08-12 12:58:57,996 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:57,996 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:58:57,996 : INFO : Starting training for split 4
2024-08-12 12:58:58,007 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 327, 1621,  751]))
2024-08-12 12:58:58,010 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 87, 390, 197]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:58:58,049 : INFO : Starting epoch 1
2024-08-12 12:58:58,091 : INFO : Current training batch loss: 1.0958 in epoch 1
2024-08-12 12:58:58,896 : INFO : Current training batch loss: 1.0447 in epoch 1
2024-08-12 12:58:59,702 : INFO : Current training batch loss: 0.9081 in epoch 1
2024-08-12 12:59:00,508 : INFO : Current training batch loss: 0.8102 in epoch 1
2024-08-12 12:59:01,315 : INFO : Current training batch loss: 0.7528 in epoch 1
2024-08-12 12:59:01,456 : INFO : Epoch finished, average loss over training batches: 0.9047
2024-08-12 12:59:01,456 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:01,456 : INFO : Training metrics:
2024-08-12 12:59:01,456 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:01,464 : INFO : Accuracy: 0.6454
2024-08-12 12:59:01,464 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:59:01,464 : INFO : Precision score for label_class 1: 0.6619
2024-08-12 12:59:01,464 : INFO : Precision score for label_class 2: 0.5358
2024-08-12 12:59:01,464 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:59:01,464 : INFO : Recall score for label_class 1: 0.9685
2024-08-12 12:59:01,464 : INFO : Recall score for label_class 2: 0.2290
2024-08-12 12:59:01,464 : INFO : Average F1 score: 0.3691
2024-08-12 12:59:01,744 : INFO : Average loss over validation batches: 0.7209
2024-08-12 12:59:01,744 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:01,744 : INFO : Validation metrics:
2024-08-12 12:59:01,744 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:01,748 : INFO : Accuracy: 0.7270
2024-08-12 12:59:01,748 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:59:01,748 : INFO : Precision score for label_class 1: 0.8086
2024-08-12 12:59:01,748 : INFO : Precision score for label_class 2: 0.5696
2024-08-12 12:59:01,748 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:59:01,748 : INFO : Recall score for label_class 1: 0.9205
2024-08-12 12:59:01,748 : INFO : Recall score for label_class 2: 0.6650
2024-08-12 12:59:01,748 : INFO : Average F1 score: 0.4915
2024-08-12 12:59:01,748 : INFO : Validation metric decreased (inf --> 0.720948).  Saving model ...
2024-08-12 12:59:01,845 : INFO : Starting epoch 2
2024-08-12 12:59:02,489 : INFO : Current training batch loss: 0.7071 in epoch 2
2024-08-12 12:59:03,294 : INFO : Current training batch loss: 0.6111 in epoch 2
2024-08-12 12:59:04,099 : INFO : Current training batch loss: 0.5173 in epoch 2
2024-08-12 12:59:04,905 : INFO : Current training batch loss: 0.5093 in epoch 2
2024-08-12 12:59:05,247 : INFO : Epoch finished, average loss over training batches: 0.6230
2024-08-12 12:59:05,248 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:05,248 : INFO : Training metrics:
2024-08-12 12:59:05,248 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:05,252 : INFO : Accuracy: 0.7599
2024-08-12 12:59:05,252 : INFO : Precision score for label_class 0: 0.7500
2024-08-12 12:59:05,252 : INFO : Precision score for label_class 1: 0.8399
2024-08-12 12:59:05,252 : INFO : Precision score for label_class 2: 0.5947
2024-08-12 12:59:05,252 : INFO : Recall score for label_class 0: 0.0275
2024-08-12 12:59:05,252 : INFO : Recall score for label_class 1: 0.9383
2024-08-12 12:59:05,252 : INFO : Recall score for label_class 2: 0.6937
2024-08-12 12:59:05,252 : INFO : Average F1 score: 0.5266
2024-08-12 12:59:05,531 : INFO : Average loss over validation batches: 0.5716
2024-08-12 12:59:05,532 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:05,532 : INFO : Validation metrics:
2024-08-12 12:59:05,532 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:05,535 : INFO : Accuracy: 0.7789
2024-08-12 12:59:05,535 : INFO : Precision score for label_class 0: 0.6667
2024-08-12 12:59:05,535 : INFO : Precision score for label_class 1: 0.8615
2024-08-12 12:59:05,535 : INFO : Precision score for label_class 2: 0.6367
2024-08-12 12:59:05,535 : INFO : Recall score for label_class 0: 0.0230
2024-08-12 12:59:05,535 : INFO : Recall score for label_class 1: 0.9410
2024-08-12 12:59:05,535 : INFO : Recall score for label_class 2: 0.7919
2024-08-12 12:59:05,535 : INFO : Average F1 score: 0.5499
2024-08-12 12:59:05,535 : INFO : Validation metric decreased (0.720948 --> 0.571566).  Saving model ...
2024-08-12 12:59:05,636 : INFO : Starting epoch 3
2024-08-12 12:59:06,076 : INFO : Current training batch loss: 0.4837 in epoch 3
2024-08-12 12:59:06,882 : INFO : Current training batch loss: 0.4694 in epoch 3
2024-08-12 12:59:07,687 : INFO : Current training batch loss: 0.5745 in epoch 3
2024-08-12 12:59:08,493 : INFO : Current training batch loss: 0.3746 in epoch 3
2024-08-12 12:59:09,036 : INFO : Epoch finished, average loss over training batches: 0.4924
2024-08-12 12:59:09,036 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:09,036 : INFO : Training metrics:
2024-08-12 12:59:09,036 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:09,043 : INFO : Accuracy: 0.8333
2024-08-12 12:59:09,044 : INFO : Precision score for label_class 0: 0.7986
2024-08-12 12:59:09,044 : INFO : Precision score for label_class 1: 0.8861
2024-08-12 12:59:09,044 : INFO : Precision score for label_class 2: 0.7267
2024-08-12 12:59:09,044 : INFO : Recall score for label_class 0: 0.3517
2024-08-12 12:59:09,044 : INFO : Recall score for label_class 1: 0.9506
2024-08-12 12:59:09,044 : INFO : Recall score for label_class 2: 0.7896
2024-08-12 12:59:09,044 : INFO : Average F1 score: 0.7208
2024-08-12 12:59:09,324 : INFO : Average loss over validation batches: 0.5151
2024-08-12 12:59:09,324 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:09,324 : INFO : Validation metrics:
2024-08-12 12:59:09,324 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:09,327 : INFO : Accuracy: 0.8294
2024-08-12 12:59:09,327 : INFO : Precision score for label_class 0: 0.7164
2024-08-12 12:59:09,327 : INFO : Precision score for label_class 1: 0.8601
2024-08-12 12:59:09,327 : INFO : Precision score for label_class 2: 0.7978
2024-08-12 12:59:09,327 : INFO : Recall score for label_class 0: 0.5517
2024-08-12 12:59:09,327 : INFO : Recall score for label_class 1: 0.9462
2024-08-12 12:59:09,327 : INFO : Recall score for label_class 2: 0.7208
2024-08-12 12:59:09,327 : INFO : Average F1 score: 0.7606
2024-08-12 12:59:09,327 : INFO : Validation metric decreased (0.571566 --> 0.515062).  Saving model ...
2024-08-12 12:59:09,428 : INFO : Split 4 is finished, the score is: 0.7606
2024-08-12 12:59:09,428 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:09,429 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:09,429 : INFO : Starting training for split 5
2024-08-12 12:59:09,440 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 330, 1615,  754]))
2024-08-12 12:59:09,442 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 84, 396, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:59:09,484 : INFO : Starting epoch 1
2024-08-12 12:59:09,526 : INFO : Current training batch loss: 1.0921 in epoch 1
2024-08-12 12:59:10,331 : INFO : Current training batch loss: 1.0377 in epoch 1
2024-08-12 12:59:11,137 : INFO : Current training batch loss: 0.9036 in epoch 1
2024-08-12 12:59:11,943 : INFO : Current training batch loss: 0.8010 in epoch 1
2024-08-12 12:59:12,749 : INFO : Current training batch loss: 0.8388 in epoch 1
2024-08-12 12:59:12,891 : INFO : Epoch finished, average loss over training batches: 0.9006
2024-08-12 12:59:12,891 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:12,891 : INFO : Training metrics:
2024-08-12 12:59:12,891 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:12,902 : INFO : Accuracy: 0.6451
2024-08-12 12:59:12,902 : INFO : Precision score for label_class 0: 0.4167
2024-08-12 12:59:12,902 : INFO : Precision score for label_class 1: 0.6609
2024-08-12 12:59:12,902 : INFO : Precision score for label_class 2: 0.5379
2024-08-12 12:59:12,902 : INFO : Recall score for label_class 0: 0.0455
2024-08-12 12:59:12,902 : INFO : Recall score for label_class 1: 0.9765
2024-08-12 12:59:12,902 : INFO : Recall score for label_class 2: 0.1976
2024-08-12 12:59:12,902 : INFO : Average F1 score: 0.3864
2024-08-12 12:59:13,182 : INFO : Average loss over validation batches: 0.6991
2024-08-12 12:59:13,182 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:13,182 : INFO : Validation metrics:
2024-08-12 12:59:13,182 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:13,186 : INFO : Accuracy: 0.7226
2024-08-12 12:59:13,186 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:59:13,186 : INFO : Precision score for label_class 1: 0.7928
2024-08-12 12:59:13,186 : INFO : Precision score for label_class 2: 0.5572
2024-08-12 12:59:13,186 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:59:13,186 : INFO : Recall score for label_class 1: 0.9470
2024-08-12 12:59:13,186 : INFO : Recall score for label_class 2: 0.5773
2024-08-12 12:59:13,186 : INFO : Average F1 score: 0.4767
2024-08-12 12:59:13,186 : INFO : Validation metric decreased (inf --> 0.699053).  Saving model ...
2024-08-12 12:59:13,287 : INFO : Starting epoch 2
2024-08-12 12:59:13,927 : INFO : Current training batch loss: 0.7151 in epoch 2
2024-08-12 12:59:14,727 : INFO : Current training batch loss: 0.6245 in epoch 2
2024-08-12 12:59:15,527 : INFO : Current training batch loss: 0.5169 in epoch 2
2024-08-12 12:59:16,328 : INFO : Current training batch loss: 0.5231 in epoch 2
2024-08-12 12:59:16,661 : INFO : Epoch finished, average loss over training batches: 0.6183
2024-08-12 12:59:16,661 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:16,661 : INFO : Training metrics:
2024-08-12 12:59:16,661 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:16,671 : INFO : Accuracy: 0.7655
2024-08-12 12:59:16,671 : INFO : Precision score for label_class 0: 0.8462
2024-08-12 12:59:16,671 : INFO : Precision score for label_class 1: 0.8390
2024-08-12 12:59:16,671 : INFO : Precision score for label_class 2: 0.6056
2024-08-12 12:59:16,671 : INFO : Recall score for label_class 0: 0.1000
2024-08-12 12:59:16,671 : INFO : Recall score for label_class 1: 0.9393
2024-08-12 12:59:16,671 : INFO : Recall score for label_class 2: 0.6844
2024-08-12 12:59:16,671 : INFO : Average F1 score: 0.5693
2024-08-12 12:59:16,951 : INFO : Average loss over validation batches: 0.5762
2024-08-12 12:59:16,951 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:16,951 : INFO : Validation metrics:
2024-08-12 12:59:16,951 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:16,955 : INFO : Accuracy: 0.7552
2024-08-12 12:59:16,955 : INFO : Precision score for label_class 0: 1.0000
2024-08-12 12:59:16,955 : INFO : Precision score for label_class 1: 0.8168
2024-08-12 12:59:16,955 : INFO : Precision score for label_class 2: 0.6078
2024-08-12 12:59:16,955 : INFO : Recall score for label_class 0: 0.0714
2024-08-12 12:59:16,955 : INFO : Recall score for label_class 1: 0.9571
2024-08-12 12:59:16,955 : INFO : Recall score for label_class 2: 0.6392
2024-08-12 12:59:16,955 : INFO : Average F1 score: 0.5459
2024-08-12 12:59:16,955 : INFO : Validation metric decreased (0.699053 --> 0.576192).  Saving model ...
2024-08-12 12:59:17,053 : INFO : Starting epoch 3
2024-08-12 12:59:17,494 : INFO : Current training batch loss: 0.5095 in epoch 3
2024-08-12 12:59:18,294 : INFO : Current training batch loss: 0.4582 in epoch 3
2024-08-12 12:59:19,094 : INFO : Current training batch loss: 0.5698 in epoch 3
2024-08-12 12:59:19,894 : INFO : Current training batch loss: 0.4322 in epoch 3
2024-08-12 12:59:20,427 : INFO : Epoch finished, average loss over training batches: 0.4832
2024-08-12 12:59:20,427 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:20,427 : INFO : Training metrics:
2024-08-12 12:59:20,428 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:20,440 : INFO : Accuracy: 0.8533
2024-08-12 12:59:20,440 : INFO : Precision score for label_class 0: 0.7945
2024-08-12 12:59:20,440 : INFO : Precision score for label_class 1: 0.9002
2024-08-12 12:59:20,440 : INFO : Precision score for label_class 2: 0.7653
2024-08-12 12:59:20,440 : INFO : Recall score for label_class 0: 0.5273
2024-08-12 12:59:20,440 : INFO : Recall score for label_class 1: 0.9548
2024-08-12 12:59:20,440 : INFO : Recall score for label_class 2: 0.7785
2024-08-12 12:59:20,440 : INFO : Average F1 score: 0.7775
2024-08-12 12:59:20,720 : INFO : Average loss over validation batches: 0.5115
2024-08-12 12:59:20,721 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:20,721 : INFO : Validation metrics:
2024-08-12 12:59:20,721 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:20,724 : INFO : Accuracy: 0.8190
2024-08-12 12:59:20,725 : INFO : Precision score for label_class 0: 0.7302
2024-08-12 12:59:20,725 : INFO : Precision score for label_class 1: 0.8662
2024-08-12 12:59:20,725 : INFO : Precision score for label_class 2: 0.7405
2024-08-12 12:59:20,725 : INFO : Recall score for label_class 0: 0.5476
2024-08-12 12:59:20,725 : INFO : Recall score for label_class 1: 0.9318
2024-08-12 12:59:20,725 : INFO : Recall score for label_class 2: 0.7062
2024-08-12 12:59:20,725 : INFO : Average F1 score: 0.7489
2024-08-12 12:59:20,725 : INFO : Validation metric decreased (0.576192 --> 0.511506).  Saving model ...
2024-08-12 12:59:20,826 : INFO : Split 5 is finished, the score is: 0.7489
2024-08-12 12:59:20,826 : INFO : ----------------------------------------------------------------------------------------------------
[I 2024-08-12 12:59:20,827] Trial 7 finished with value: 0.7901286079928305 and parameters: {'n_epochs': 3, 'learning_rate': 3.1702795245487824e-05, 'classifier_dropout': 0.6257730274910118, 'warmup_step_fraction': 0.09613256850766703, 'use_gradient_clipping': False}. Best is trial 6 with value: 0.8419854360165029.
2024-08-12 12:59:20,827 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:20,827 : INFO : Starting training for split 1
2024-08-12 12:59:20,842 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 328, 1596,  774]))
2024-08-12 12:59:20,844 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 86, 415, 174]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:59:20,885 : INFO : Starting epoch 1
2024-08-12 12:59:20,927 : INFO : Current training batch loss: 1.1131 in epoch 1
2024-08-12 12:59:21,732 : INFO : Current training batch loss: 1.0879 in epoch 1
2024-08-12 12:59:22,538 : INFO : Current training batch loss: 1.0577 in epoch 1
2024-08-12 12:59:23,344 : INFO : Current training batch loss: 0.9472 in epoch 1
2024-08-12 12:59:24,150 : INFO : Current training batch loss: 0.9341 in epoch 1
2024-08-12 12:59:24,291 : INFO : Epoch finished, average loss over training batches: 1.0240
2024-08-12 12:59:24,292 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:24,292 : INFO : Training metrics:
2024-08-12 12:59:24,292 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:24,299 : INFO : Accuracy: 0.4963
2024-08-12 12:59:24,300 : INFO : Precision score for label_class 0: 0.1333
2024-08-12 12:59:24,300 : INFO : Precision score for label_class 1: 0.5822
2024-08-12 12:59:24,300 : INFO : Precision score for label_class 2: 0.1437
2024-08-12 12:59:24,300 : INFO : Recall score for label_class 0: 0.1463
2024-08-12 12:59:24,300 : INFO : Recall score for label_class 1: 0.7945
2024-08-12 12:59:24,300 : INFO : Recall score for label_class 2: 0.0297
2024-08-12 12:59:24,300 : INFO : Average F1 score: 0.2869
2024-08-12 12:59:24,579 : INFO : Average loss over validation batches: 0.8989
2024-08-12 12:59:24,580 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:24,580 : INFO : Validation metrics:
2024-08-12 12:59:24,580 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:24,582 : INFO : Accuracy: 0.6148
2024-08-12 12:59:24,582 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:59:24,582 : INFO : Precision score for label_class 1: 0.6148
2024-08-12 12:59:24,582 : INFO : Precision score for label_class 2: 0.0000
2024-08-12 12:59:24,582 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:59:24,582 : INFO : Recall score for label_class 1: 1.0000
2024-08-12 12:59:24,582 : INFO : Recall score for label_class 2: 0.0000
2024-08-12 12:59:24,582 : INFO : Average F1 score: 0.2538
2024-08-12 12:59:24,582 : INFO : Validation metric decreased (inf --> 0.898852).  Saving model ...
2024-08-12 12:59:24,683 : INFO : Starting epoch 2
2024-08-12 12:59:25,327 : INFO : Current training batch loss: 0.7621 in epoch 2
2024-08-12 12:59:26,132 : INFO : Current training batch loss: 0.8173 in epoch 2
2024-08-12 12:59:26,937 : INFO : Current training batch loss: 0.7626 in epoch 2
2024-08-12 12:59:27,743 : INFO : Current training batch loss: 0.6419 in epoch 2
2024-08-12 12:59:28,085 : INFO : Epoch finished, average loss over training batches: 0.8086
2024-08-12 12:59:28,086 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:28,086 : INFO : Training metrics:
2024-08-12 12:59:28,086 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:28,091 : INFO : Accuracy: 0.6864
2024-08-12 12:59:28,091 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:59:28,091 : INFO : Precision score for label_class 1: 0.7116
2024-08-12 12:59:28,091 : INFO : Precision score for label_class 2: 0.5765
2024-08-12 12:59:28,091 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:59:28,091 : INFO : Recall score for label_class 1: 0.9787
2024-08-12 12:59:28,091 : INFO : Recall score for label_class 2: 0.3747
2024-08-12 12:59:28,091 : INFO : Average F1 score: 0.4261
2024-08-12 12:59:28,370 : INFO : Average loss over validation batches: 0.7344
2024-08-12 12:59:28,371 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:28,371 : INFO : Validation metrics:
2024-08-12 12:59:28,371 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:28,373 : INFO : Accuracy: 0.7200
2024-08-12 12:59:28,373 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:59:28,373 : INFO : Precision score for label_class 1: 0.8079
2024-08-12 12:59:28,373 : INFO : Precision score for label_class 2: 0.5051
2024-08-12 12:59:28,373 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:59:28,373 : INFO : Recall score for label_class 1: 0.9325
2024-08-12 12:59:28,373 : INFO : Recall score for label_class 2: 0.5690
2024-08-12 12:59:28,373 : INFO : Average F1 score: 0.4670
2024-08-12 12:59:28,373 : INFO : Validation metric decreased (0.898852 --> 0.734449).  Saving model ...
2024-08-12 12:59:28,475 : INFO : Starting epoch 3
2024-08-12 12:59:28,916 : INFO : Current training batch loss: 0.6566 in epoch 3
2024-08-12 12:59:29,717 : INFO : Current training batch loss: 0.7055 in epoch 3
2024-08-12 12:59:30,518 : INFO : Current training batch loss: 0.6435 in epoch 3
2024-08-12 12:59:31,318 : INFO : Current training batch loss: 0.5221 in epoch 3
2024-08-12 12:59:31,851 : INFO : Epoch finished, average loss over training batches: 0.6569
2024-08-12 12:59:31,851 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:31,851 : INFO : Training metrics:
2024-08-12 12:59:31,851 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:31,858 : INFO : Accuracy: 0.7602
2024-08-12 12:59:31,858 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:59:31,858 : INFO : Precision score for label_class 1: 0.8293
2024-08-12 12:59:31,858 : INFO : Precision score for label_class 2: 0.6134
2024-08-12 12:59:31,858 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:59:31,858 : INFO : Recall score for label_class 1: 0.9530
2024-08-12 12:59:31,858 : INFO : Recall score for label_class 2: 0.6848
2024-08-12 12:59:31,858 : INFO : Average F1 score: 0.5113
2024-08-12 12:59:32,138 : INFO : Average loss over validation batches: 0.6301
2024-08-12 12:59:32,138 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:32,138 : INFO : Validation metrics:
2024-08-12 12:59:32,138 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:32,140 : INFO : Accuracy: 0.7496
2024-08-12 12:59:32,140 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:59:32,140 : INFO : Precision score for label_class 1: 0.8718
2024-08-12 12:59:32,141 : INFO : Precision score for label_class 2: 0.5366
2024-08-12 12:59:32,141 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:59:32,141 : INFO : Recall score for label_class 1: 0.9012
2024-08-12 12:59:32,141 : INFO : Recall score for label_class 2: 0.7586
2024-08-12 12:59:32,141 : INFO : Average F1 score: 0.5049
2024-08-12 12:59:32,141 : INFO : Validation metric decreased (0.734449 --> 0.630082).  Saving model ...
2024-08-12 12:59:32,240 : INFO : Starting epoch 4
2024-08-12 12:59:32,482 : INFO : Current training batch loss: 0.8153 in epoch 4
2024-08-12 12:59:33,282 : INFO : Current training batch loss: 0.5589 in epoch 4
2024-08-12 12:59:34,082 : INFO : Current training batch loss: 0.5132 in epoch 4
2024-08-12 12:59:34,882 : INFO : Current training batch loss: 0.4622 in epoch 4
2024-08-12 12:59:35,616 : INFO : Epoch finished, average loss over training batches: 0.5495
2024-08-12 12:59:35,616 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:35,616 : INFO : Training metrics:
2024-08-12 12:59:35,616 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:35,623 : INFO : Accuracy: 0.8069
2024-08-12 12:59:35,623 : INFO : Precision score for label_class 0: 0.8438
2024-08-12 12:59:35,623 : INFO : Precision score for label_class 1: 0.8828
2024-08-12 12:59:35,623 : INFO : Precision score for label_class 2: 0.6649
2024-08-12 12:59:35,623 : INFO : Recall score for label_class 0: 0.0823
2024-08-12 12:59:35,623 : INFO : Recall score for label_class 1: 0.9580
2024-08-12 12:59:35,623 : INFO : Recall score for label_class 2: 0.8023
2024-08-12 12:59:35,623 : INFO : Average F1 score: 0.5987
2024-08-12 12:59:35,902 : INFO : Average loss over validation batches: 0.5604
2024-08-12 12:59:35,902 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:35,902 : INFO : Validation metrics:
2024-08-12 12:59:35,902 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:35,905 : INFO : Accuracy: 0.7956
2024-08-12 12:59:35,905 : INFO : Precision score for label_class 0: 0.8276
2024-08-12 12:59:35,905 : INFO : Precision score for label_class 1: 0.8964
2024-08-12 12:59:35,905 : INFO : Precision score for label_class 2: 0.6104
2024-08-12 12:59:35,905 : INFO : Recall score for label_class 0: 0.2791
2024-08-12 12:59:35,905 : INFO : Recall score for label_class 1: 0.8964
2024-08-12 12:59:35,905 : INFO : Recall score for label_class 2: 0.8103
2024-08-12 12:59:35,905 : INFO : Average F1 score: 0.6700
2024-08-12 12:59:35,905 : INFO : Validation metric decreased (0.630082 --> 0.560356).  Saving model ...
2024-08-12 12:59:36,007 : INFO : Starting epoch 5
2024-08-12 12:59:36,048 : INFO : Current training batch loss: 0.4919 in epoch 5
2024-08-12 12:59:36,851 : INFO : Current training batch loss: 0.5362 in epoch 5
2024-08-12 12:59:37,651 : INFO : Current training batch loss: 0.4784 in epoch 5
2024-08-12 12:59:38,453 : INFO : Current training batch loss: 0.5096 in epoch 5
2024-08-12 12:59:39,255 : INFO : Current training batch loss: 0.4350 in epoch 5
2024-08-12 12:59:39,388 : INFO : Epoch finished, average loss over training batches: 0.4748
2024-08-12 12:59:39,388 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:39,388 : INFO : Training metrics:
2024-08-12 12:59:39,388 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:39,395 : INFO : Accuracy: 0.8762
2024-08-12 12:59:39,395 : INFO : Precision score for label_class 0: 0.8507
2024-08-12 12:59:39,395 : INFO : Precision score for label_class 1: 0.9032
2024-08-12 12:59:39,395 : INFO : Precision score for label_class 2: 0.8238
2024-08-12 12:59:39,395 : INFO : Recall score for label_class 0: 0.5732
2024-08-12 12:59:39,395 : INFO : Recall score for label_class 1: 0.9649
2024-08-12 12:59:39,395 : INFO : Recall score for label_class 2: 0.8217
2024-08-12 12:59:39,395 : INFO : Average F1 score: 0.8136
2024-08-12 12:59:39,675 : INFO : Average loss over validation batches: 0.5247
2024-08-12 12:59:39,675 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:39,675 : INFO : Validation metrics:
2024-08-12 12:59:39,675 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:39,677 : INFO : Accuracy: 0.8489
2024-08-12 12:59:39,677 : INFO : Precision score for label_class 0: 0.8400
2024-08-12 12:59:39,677 : INFO : Precision score for label_class 1: 0.9186
2024-08-12 12:59:39,677 : INFO : Precision score for label_class 2: 0.7198
2024-08-12 12:59:39,678 : INFO : Recall score for label_class 0: 0.7326
2024-08-12 12:59:39,678 : INFO : Recall score for label_class 1: 0.8699
2024-08-12 12:59:39,678 : INFO : Recall score for label_class 2: 0.8563
2024-08-12 12:59:39,678 : INFO : Average F1 score: 0.8194
2024-08-12 12:59:39,678 : INFO : Validation metric decreased (0.560356 --> 0.524728).  Saving model ...
2024-08-12 12:59:39,777 : INFO : Starting epoch 6
2024-08-12 12:59:40,418 : INFO : Current training batch loss: 0.2623 in epoch 6
2024-08-12 12:59:41,220 : INFO : Current training batch loss: 0.4688 in epoch 6
2024-08-12 12:59:42,021 : INFO : Current training batch loss: 0.4204 in epoch 6
2024-08-12 12:59:42,822 : INFO : Current training batch loss: 0.3088 in epoch 6
2024-08-12 12:59:43,155 : INFO : Epoch finished, average loss over training batches: 0.4338
2024-08-12 12:59:43,156 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:43,156 : INFO : Training metrics:
2024-08-12 12:59:43,156 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:43,162 : INFO : Accuracy: 0.8973
2024-08-12 12:59:43,162 : INFO : Precision score for label_class 0: 0.8407
2024-08-12 12:59:43,162 : INFO : Precision score for label_class 1: 0.9169
2024-08-12 12:59:43,162 : INFO : Precision score for label_class 2: 0.8737
2024-08-12 12:59:43,162 : INFO : Recall score for label_class 0: 0.6921
2024-08-12 12:59:43,162 : INFO : Recall score for label_class 1: 0.9674
2024-08-12 12:59:43,162 : INFO : Recall score for label_class 2: 0.8398
2024-08-12 12:59:43,162 : INFO : Average F1 score: 0.8524
2024-08-12 12:59:43,442 : INFO : Average loss over validation batches: 0.4934
2024-08-12 12:59:43,442 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:43,442 : INFO : Validation metrics:
2024-08-12 12:59:43,442 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:43,445 : INFO : Accuracy: 0.8607
2024-08-12 12:59:43,445 : INFO : Precision score for label_class 0: 0.8442
2024-08-12 12:59:43,445 : INFO : Precision score for label_class 1: 0.8825
2024-08-12 12:59:43,445 : INFO : Precision score for label_class 2: 0.8110
2024-08-12 12:59:43,445 : INFO : Recall score for label_class 0: 0.7558
2024-08-12 12:59:43,445 : INFO : Recall score for label_class 1: 0.9229
2024-08-12 12:59:43,445 : INFO : Recall score for label_class 2: 0.7644
2024-08-12 12:59:43,445 : INFO : Average F1 score: 0.8289
2024-08-12 12:59:43,445 : INFO : Validation metric decreased (0.524728 --> 0.493400).  Saving model ...
2024-08-12 12:59:43,548 : INFO : Split 1 is finished, the score is: 0.8289
2024-08-12 12:59:43,548 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:43,548 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:43,548 : INFO : Starting training for split 2
2024-08-12 12:59:43,560 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 343, 1601,  754]))
2024-08-12 12:59:43,562 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 71, 410, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 12:59:43,602 : INFO : Starting epoch 1
2024-08-12 12:59:43,644 : INFO : Current training batch loss: 1.1130 in epoch 1
2024-08-12 12:59:44,450 : INFO : Current training batch loss: 1.0907 in epoch 1
2024-08-12 12:59:45,256 : INFO : Current training batch loss: 1.0563 in epoch 1
2024-08-12 12:59:46,062 : INFO : Current training batch loss: 0.9484 in epoch 1
2024-08-12 12:59:46,868 : INFO : Current training batch loss: 0.9309 in epoch 1
2024-08-12 12:59:47,009 : INFO : Epoch finished, average loss over training batches: 1.0198
2024-08-12 12:59:47,009 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:47,009 : INFO : Training metrics:
2024-08-12 12:59:47,009 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:47,020 : INFO : Accuracy: 0.5122
2024-08-12 12:59:47,020 : INFO : Precision score for label_class 0: 0.1245
2024-08-12 12:59:47,020 : INFO : Precision score for label_class 1: 0.5928
2024-08-12 12:59:47,020 : INFO : Precision score for label_class 2: 0.3194
2024-08-12 12:59:47,020 : INFO : Recall score for label_class 0: 0.0875
2024-08-12 12:59:47,020 : INFO : Recall score for label_class 1: 0.7683
2024-08-12 12:59:47,020 : INFO : Recall score for label_class 2: 0.1618
2024-08-12 12:59:47,020 : INFO : Average F1 score: 0.3289
2024-08-12 12:59:47,300 : INFO : Average loss over validation batches: 0.8759
2024-08-12 12:59:47,300 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:47,300 : INFO : Validation metrics:
2024-08-12 12:59:47,300 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:47,304 : INFO : Accuracy: 0.6637
2024-08-12 12:59:47,304 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:59:47,304 : INFO : Precision score for label_class 1: 0.6827
2024-08-12 12:59:47,304 : INFO : Precision score for label_class 2: 0.5435
2024-08-12 12:59:47,304 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:59:47,304 : INFO : Recall score for label_class 1: 0.9707
2024-08-12 12:59:47,304 : INFO : Recall score for label_class 2: 0.2577
2024-08-12 12:59:47,304 : INFO : Average F1 score: 0.3838
2024-08-12 12:59:47,304 : INFO : Validation metric decreased (inf --> 0.875944).  Saving model ...
2024-08-12 12:59:47,404 : INFO : Starting epoch 2
2024-08-12 12:59:48,048 : INFO : Current training batch loss: 0.8480 in epoch 2
2024-08-12 12:59:48,853 : INFO : Current training batch loss: 0.7927 in epoch 2
2024-08-12 12:59:49,659 : INFO : Current training batch loss: 0.7364 in epoch 2
2024-08-12 12:59:50,465 : INFO : Current training batch loss: 0.6047 in epoch 2
2024-08-12 12:59:50,806 : INFO : Epoch finished, average loss over training batches: 0.7704
2024-08-12 12:59:50,807 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:50,807 : INFO : Training metrics:
2024-08-12 12:59:50,807 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:50,814 : INFO : Accuracy: 0.7079
2024-08-12 12:59:50,814 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:59:50,814 : INFO : Precision score for label_class 1: 0.7576
2024-08-12 12:59:50,814 : INFO : Precision score for label_class 2: 0.5557
2024-08-12 12:59:50,814 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:59:50,814 : INFO : Recall score for label_class 1: 0.9625
2024-08-12 12:59:50,814 : INFO : Recall score for label_class 2: 0.4894
2024-08-12 12:59:50,814 : INFO : Average F1 score: 0.4561
2024-08-12 12:59:51,094 : INFO : Average loss over validation batches: 0.6723
2024-08-12 12:59:51,094 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:51,094 : INFO : Validation metrics:
2024-08-12 12:59:51,094 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:51,101 : INFO : Accuracy: 0.7526
2024-08-12 12:59:51,101 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 12:59:51,101 : INFO : Precision score for label_class 1: 0.8207
2024-08-12 12:59:51,101 : INFO : Precision score for label_class 2: 0.6038
2024-08-12 12:59:51,101 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 12:59:51,101 : INFO : Recall score for label_class 1: 0.9268
2024-08-12 12:59:51,101 : INFO : Recall score for label_class 2: 0.6598
2024-08-12 12:59:51,101 : INFO : Average F1 score: 0.5004
2024-08-12 12:59:51,101 : INFO : Validation metric decreased (0.875944 --> 0.672273).  Saving model ...
2024-08-12 12:59:51,203 : INFO : Starting epoch 3
2024-08-12 12:59:51,649 : INFO : Current training batch loss: 0.6732 in epoch 3
2024-08-12 12:59:52,460 : INFO : Current training batch loss: 0.6217 in epoch 3
2024-08-12 12:59:53,269 : INFO : Current training batch loss: 0.5815 in epoch 3
2024-08-12 12:59:54,077 : INFO : Current training batch loss: 0.5161 in epoch 3
2024-08-12 12:59:54,620 : INFO : Epoch finished, average loss over training batches: 0.6035
2024-08-12 12:59:54,620 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:54,620 : INFO : Training metrics:
2024-08-12 12:59:54,621 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:54,628 : INFO : Accuracy: 0.7869
2024-08-12 12:59:54,628 : INFO : Precision score for label_class 0: 0.8627
2024-08-12 12:59:54,628 : INFO : Precision score for label_class 1: 0.8596
2024-08-12 12:59:54,628 : INFO : Precision score for label_class 2: 0.6350
2024-08-12 12:59:54,628 : INFO : Recall score for label_class 0: 0.1283
2024-08-12 12:59:54,628 : INFO : Recall score for label_class 1: 0.9519
2024-08-12 12:59:54,628 : INFO : Recall score for label_class 2: 0.7361
2024-08-12 12:59:54,628 : INFO : Average F1 score: 0.6028
2024-08-12 12:59:54,908 : INFO : Average loss over validation batches: 0.5547
2024-08-12 12:59:54,908 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:54,908 : INFO : Validation metrics:
2024-08-12 12:59:54,908 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:54,911 : INFO : Accuracy: 0.8474
2024-08-12 12:59:54,912 : INFO : Precision score for label_class 0: 0.7959
2024-08-12 12:59:54,912 : INFO : Precision score for label_class 1: 0.8638
2024-08-12 12:59:54,912 : INFO : Precision score for label_class 2: 0.8202
2024-08-12 12:59:54,912 : INFO : Recall score for label_class 0: 0.5493
2024-08-12 12:59:54,912 : INFO : Recall score for label_class 1: 0.9439
2024-08-12 12:59:54,912 : INFO : Recall score for label_class 2: 0.7526
2024-08-12 12:59:54,912 : INFO : Average F1 score: 0.7790
2024-08-12 12:59:54,912 : INFO : Validation metric decreased (0.672273 --> 0.554714).  Saving model ...
2024-08-12 12:59:55,013 : INFO : Starting epoch 4
2024-08-12 12:59:55,256 : INFO : Current training batch loss: 0.6478 in epoch 4
2024-08-12 12:59:56,062 : INFO : Current training batch loss: 0.4655 in epoch 4
2024-08-12 12:59:56,867 : INFO : Current training batch loss: 0.4798 in epoch 4
2024-08-12 12:59:57,673 : INFO : Current training batch loss: 0.3759 in epoch 4
2024-08-12 12:59:58,417 : INFO : Epoch finished, average loss over training batches: 0.4843
2024-08-12 12:59:58,417 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:58,417 : INFO : Training metrics:
2024-08-12 12:59:58,417 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:58,426 : INFO : Accuracy: 0.8758
2024-08-12 12:59:58,426 : INFO : Precision score for label_class 0: 0.8227
2024-08-12 12:59:58,426 : INFO : Precision score for label_class 1: 0.8990
2024-08-12 12:59:58,426 : INFO : Precision score for label_class 2: 0.8415
2024-08-12 12:59:58,426 : INFO : Recall score for label_class 0: 0.6764
2024-08-12 12:59:58,426 : INFO : Recall score for label_class 1: 0.9563
2024-08-12 12:59:58,426 : INFO : Recall score for label_class 2: 0.7958
2024-08-12 12:59:58,426 : INFO : Average F1 score: 0.8291
2024-08-12 12:59:58,706 : INFO : Average loss over validation batches: 0.4948
2024-08-12 12:59:58,706 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:58,706 : INFO : Validation metrics:
2024-08-12 12:59:58,706 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 12:59:58,710 : INFO : Accuracy: 0.8563
2024-08-12 12:59:58,710 : INFO : Precision score for label_class 0: 0.7910
2024-08-12 12:59:58,710 : INFO : Precision score for label_class 1: 0.8839
2024-08-12 12:59:58,710 : INFO : Precision score for label_class 2: 0.8172
2024-08-12 12:59:58,710 : INFO : Recall score for label_class 0: 0.7465
2024-08-12 12:59:58,710 : INFO : Recall score for label_class 1: 0.9098
2024-08-12 12:59:58,710 : INFO : Recall score for label_class 2: 0.7835
2024-08-12 12:59:58,710 : INFO : Average F1 score: 0.8216
2024-08-12 12:59:58,710 : INFO : Validation metric decreased (0.554714 --> 0.494828).  Saving model ...
2024-08-12 12:59:58,813 : INFO : Starting epoch 5
2024-08-12 12:59:58,855 : INFO : Current training batch loss: 0.3996 in epoch 5
2024-08-12 12:59:59,660 : INFO : Current training batch loss: 0.6045 in epoch 5
2024-08-12 13:00:00,466 : INFO : Current training batch loss: 0.3888 in epoch 5
2024-08-12 13:00:01,272 : INFO : Current training batch loss: 0.4483 in epoch 5
2024-08-12 13:00:02,078 : INFO : Current training batch loss: 0.4367 in epoch 5
2024-08-12 13:00:02,219 : INFO : Epoch finished, average loss over training batches: 0.4149
2024-08-12 13:00:02,219 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:02,219 : INFO : Training metrics:
2024-08-12 13:00:02,219 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:02,226 : INFO : Accuracy: 0.8973
2024-08-12 13:00:02,227 : INFO : Precision score for label_class 0: 0.8261
2024-08-12 13:00:02,227 : INFO : Precision score for label_class 1: 0.9171
2024-08-12 13:00:02,227 : INFO : Precision score for label_class 2: 0.8829
2024-08-12 13:00:02,227 : INFO : Recall score for label_class 0: 0.7755
2024-08-12 13:00:02,227 : INFO : Recall score for label_class 1: 0.9600
2024-08-12 13:00:02,227 : INFO : Recall score for label_class 2: 0.8196
2024-08-12 13:00:02,227 : INFO : Average F1 score: 0.8627
2024-08-12 13:00:02,506 : INFO : Average loss over validation batches: 0.4630
2024-08-12 13:00:02,506 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:02,506 : INFO : Validation metrics:
2024-08-12 13:00:02,506 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:02,510 : INFO : Accuracy: 0.8593
2024-08-12 13:00:02,510 : INFO : Precision score for label_class 0: 0.7714
2024-08-12 13:00:02,510 : INFO : Precision score for label_class 1: 0.8788
2024-08-12 13:00:02,510 : INFO : Precision score for label_class 2: 0.8466
2024-08-12 13:00:02,510 : INFO : Recall score for label_class 0: 0.7606
2024-08-12 13:00:02,510 : INFO : Recall score for label_class 1: 0.9195
2024-08-12 13:00:02,510 : INFO : Recall score for label_class 2: 0.7680
2024-08-12 13:00:02,510 : INFO : Average F1 score: 0.8234
2024-08-12 13:00:02,510 : INFO : Validation metric decreased (0.494828 --> 0.462994).  Saving model ...
2024-08-12 13:00:02,611 : INFO : Starting epoch 6
2024-08-12 13:00:03,256 : INFO : Current training batch loss: 0.4394 in epoch 6
2024-08-12 13:00:04,062 : INFO : Current training batch loss: 0.4101 in epoch 6
2024-08-12 13:00:04,867 : INFO : Current training batch loss: 0.3475 in epoch 6
2024-08-12 13:00:05,673 : INFO : Current training batch loss: 0.3014 in epoch 6
2024-08-12 13:00:06,015 : INFO : Epoch finished, average loss over training batches: 0.3811
2024-08-12 13:00:06,015 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:06,016 : INFO : Training metrics:
2024-08-12 13:00:06,016 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:06,023 : INFO : Accuracy: 0.9110
2024-08-12 13:00:06,023 : INFO : Precision score for label_class 0: 0.8369
2024-08-12 13:00:06,023 : INFO : Precision score for label_class 1: 0.9355
2024-08-12 13:00:06,023 : INFO : Precision score for label_class 2: 0.8890
2024-08-12 13:00:06,023 : INFO : Recall score for label_class 0: 0.7930
2024-08-12 13:00:06,023 : INFO : Recall score for label_class 1: 0.9600
2024-08-12 13:00:06,023 : INFO : Recall score for label_class 2: 0.8607
2024-08-12 13:00:06,023 : INFO : Average F1 score: 0.8789
2024-08-12 13:00:06,303 : INFO : Average loss over validation batches: 0.4518
2024-08-12 13:00:06,303 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:06,303 : INFO : Validation metrics:
2024-08-12 13:00:06,303 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:06,307 : INFO : Accuracy: 0.8637
2024-08-12 13:00:06,307 : INFO : Precision score for label_class 0: 0.8154
2024-08-12 13:00:06,307 : INFO : Precision score for label_class 1: 0.8759
2024-08-12 13:00:06,307 : INFO : Precision score for label_class 2: 0.8514
2024-08-12 13:00:06,307 : INFO : Recall score for label_class 0: 0.7465
2024-08-12 13:00:06,307 : INFO : Recall score for label_class 1: 0.9293
2024-08-12 13:00:06,307 : INFO : Recall score for label_class 2: 0.7680
2024-08-12 13:00:06,307 : INFO : Average F1 score: 0.8296
2024-08-12 13:00:06,307 : INFO : Validation metric decreased (0.462994 --> 0.451784).  Saving model ...
2024-08-12 13:00:06,410 : INFO : Split 2 is finished, the score is: 0.8296
2024-08-12 13:00:06,410 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:06,410 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:06,410 : INFO : Starting training for split 3
2024-08-12 13:00:06,422 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 328, 1611,  759]))
2024-08-12 13:00:06,424 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 86, 400, 189]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:00:06,466 : INFO : Starting epoch 1
2024-08-12 13:00:06,508 : INFO : Current training batch loss: 1.0949 in epoch 1
2024-08-12 13:00:07,313 : INFO : Current training batch loss: 1.0782 in epoch 1
2024-08-12 13:00:08,119 : INFO : Current training batch loss: 1.0118 in epoch 1
2024-08-12 13:00:08,925 : INFO : Current training batch loss: 0.9400 in epoch 1
2024-08-12 13:00:09,731 : INFO : Current training batch loss: 0.9075 in epoch 1
2024-08-12 13:00:09,872 : INFO : Epoch finished, average loss over training batches: 1.0051
2024-08-12 13:00:09,872 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:09,872 : INFO : Training metrics:
2024-08-12 13:00:09,872 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:09,880 : INFO : Accuracy: 0.5886
2024-08-12 13:00:09,880 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:00:09,880 : INFO : Precision score for label_class 1: 0.5962
2024-08-12 13:00:09,880 : INFO : Precision score for label_class 2: 0.3797
2024-08-12 13:00:09,880 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:00:09,880 : INFO : Recall score for label_class 1: 0.9671
2024-08-12 13:00:09,880 : INFO : Recall score for label_class 2: 0.0395
2024-08-12 13:00:09,880 : INFO : Average F1 score: 0.2698
2024-08-12 13:00:10,161 : INFO : Average loss over validation batches: 0.8871
2024-08-12 13:00:10,161 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:10,161 : INFO : Validation metrics:
2024-08-12 13:00:10,161 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:10,164 : INFO : Accuracy: 0.6474
2024-08-12 13:00:10,164 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:00:10,164 : INFO : Precision score for label_class 1: 0.6524
2024-08-12 13:00:10,164 : INFO : Precision score for label_class 2: 0.6029
2024-08-12 13:00:10,164 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:00:10,164 : INFO : Recall score for label_class 1: 0.9900
2024-08-12 13:00:10,164 : INFO : Recall score for label_class 2: 0.2169
2024-08-12 13:00:10,164 : INFO : Average F1 score: 0.3685
2024-08-12 13:00:10,164 : INFO : Validation metric decreased (inf --> 0.887141).  Saving model ...
2024-08-12 13:00:10,265 : INFO : Starting epoch 2
2024-08-12 13:00:10,909 : INFO : Current training batch loss: 0.8516 in epoch 2
2024-08-12 13:00:11,714 : INFO : Current training batch loss: 0.8023 in epoch 2
2024-08-12 13:00:12,519 : INFO : Current training batch loss: 0.7659 in epoch 2
2024-08-12 13:00:13,324 : INFO : Current training batch loss: 0.6319 in epoch 2
2024-08-12 13:00:13,666 : INFO : Epoch finished, average loss over training batches: 0.7719
2024-08-12 13:00:13,667 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:13,667 : INFO : Training metrics:
2024-08-12 13:00:13,667 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:13,671 : INFO : Accuracy: 0.7076
2024-08-12 13:00:13,671 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:00:13,671 : INFO : Precision score for label_class 1: 0.7532
2024-08-12 13:00:13,671 : INFO : Precision score for label_class 2: 0.5633
2024-08-12 13:00:13,671 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:00:13,671 : INFO : Recall score for label_class 1: 0.9584
2024-08-12 13:00:13,671 : INFO : Recall score for label_class 2: 0.4809
2024-08-12 13:00:13,671 : INFO : Average F1 score: 0.4541
2024-08-12 13:00:13,951 : INFO : Average loss over validation batches: 0.6852
2024-08-12 13:00:13,951 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:13,951 : INFO : Validation metrics:
2024-08-12 13:00:13,951 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:13,954 : INFO : Accuracy: 0.7422
2024-08-12 13:00:13,954 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:00:13,954 : INFO : Precision score for label_class 1: 0.8217
2024-08-12 13:00:13,954 : INFO : Precision score for label_class 2: 0.5721
2024-08-12 13:00:13,954 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:00:13,954 : INFO : Recall score for label_class 1: 0.9450
2024-08-12 13:00:13,954 : INFO : Recall score for label_class 2: 0.6508
2024-08-12 13:00:13,954 : INFO : Average F1 score: 0.4960
2024-08-12 13:00:13,954 : INFO : Validation metric decreased (0.887141 --> 0.685232).  Saving model ...
2024-08-12 13:00:14,056 : INFO : Starting epoch 3
2024-08-12 13:00:14,500 : INFO : Current training batch loss: 0.7055 in epoch 3
2024-08-12 13:00:15,305 : INFO : Current training batch loss: 0.5799 in epoch 3
2024-08-12 13:00:16,111 : INFO : Current training batch loss: 0.6132 in epoch 3
2024-08-12 13:00:16,917 : INFO : Current training batch loss: 0.5064 in epoch 3
2024-08-12 13:00:17,460 : INFO : Epoch finished, average loss over training batches: 0.6188
2024-08-12 13:00:17,460 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:17,460 : INFO : Training metrics:
2024-08-12 13:00:17,460 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:17,464 : INFO : Accuracy: 0.7724
2024-08-12 13:00:17,464 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:00:17,464 : INFO : Precision score for label_class 1: 0.8511
2024-08-12 13:00:17,464 : INFO : Precision score for label_class 2: 0.6166
2024-08-12 13:00:17,464 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:00:17,464 : INFO : Recall score for label_class 1: 0.9472
2024-08-12 13:00:17,464 : INFO : Recall score for label_class 2: 0.7352
2024-08-12 13:00:17,464 : INFO : Average F1 score: 0.5224
2024-08-12 13:00:17,745 : INFO : Average loss over validation batches: 0.5781
2024-08-12 13:00:17,745 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:17,745 : INFO : Validation metrics:
2024-08-12 13:00:17,745 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:17,748 : INFO : Accuracy: 0.7704
2024-08-12 13:00:17,748 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:00:17,748 : INFO : Precision score for label_class 1: 0.8753
2024-08-12 13:00:17,748 : INFO : Precision score for label_class 2: 0.5920
2024-08-12 13:00:17,748 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:00:17,748 : INFO : Recall score for label_class 1: 0.9300
2024-08-12 13:00:17,748 : INFO : Recall score for label_class 2: 0.7831
2024-08-12 13:00:17,748 : INFO : Average F1 score: 0.5254
2024-08-12 13:00:17,748 : INFO : Validation metric decreased (0.685232 --> 0.578125).  Saving model ...
2024-08-12 13:00:17,848 : INFO : Starting epoch 4
2024-08-12 13:00:18,091 : INFO : Current training batch loss: 0.7356 in epoch 4
2024-08-12 13:00:18,897 : INFO : Current training batch loss: 0.7291 in epoch 4
2024-08-12 13:00:19,702 : INFO : Current training batch loss: 0.5151 in epoch 4
2024-08-12 13:00:20,508 : INFO : Current training batch loss: 0.4363 in epoch 4
2024-08-12 13:00:21,252 : INFO : Epoch finished, average loss over training batches: 0.5325
2024-08-12 13:00:21,252 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:21,252 : INFO : Training metrics:
2024-08-12 13:00:21,252 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:21,260 : INFO : Accuracy: 0.8106
2024-08-12 13:00:21,260 : INFO : Precision score for label_class 0: 0.8837
2024-08-12 13:00:21,260 : INFO : Precision score for label_class 1: 0.8845
2024-08-12 13:00:21,260 : INFO : Precision score for label_class 2: 0.6663
2024-08-12 13:00:21,260 : INFO : Recall score for label_class 0: 0.1159
2024-08-12 13:00:21,260 : INFO : Recall score for label_class 1: 0.9559
2024-08-12 13:00:21,260 : INFO : Recall score for label_class 2: 0.8024
2024-08-12 13:00:21,260 : INFO : Average F1 score: 0.6172
2024-08-12 13:00:21,540 : INFO : Average loss over validation batches: 0.5422
2024-08-12 13:00:21,541 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:21,541 : INFO : Validation metrics:
2024-08-12 13:00:21,541 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:21,543 : INFO : Accuracy: 0.8193
2024-08-12 13:00:21,543 : INFO : Precision score for label_class 0: 0.9268
2024-08-12 13:00:21,543 : INFO : Precision score for label_class 1: 0.9143
2024-08-12 13:00:21,543 : INFO : Precision score for label_class 2: 0.6546
2024-08-12 13:00:21,543 : INFO : Recall score for label_class 0: 0.4419
2024-08-12 13:00:21,543 : INFO : Recall score for label_class 1: 0.8800
2024-08-12 13:00:21,543 : INFO : Recall score for label_class 2: 0.8624
2024-08-12 13:00:21,543 : INFO : Average F1 score: 0.7465
2024-08-12 13:00:21,543 : INFO : Validation metric decreased (0.578125 --> 0.542197).  Saving model ...
2024-08-12 13:00:21,646 : INFO : Starting epoch 5
2024-08-12 13:00:21,688 : INFO : Current training batch loss: 0.4879 in epoch 5
2024-08-12 13:00:22,493 : INFO : Current training batch loss: 0.6594 in epoch 5
2024-08-12 13:00:23,300 : INFO : Current training batch loss: 0.4361 in epoch 5
2024-08-12 13:00:24,106 : INFO : Current training batch loss: 0.4746 in epoch 5
2024-08-12 13:00:24,912 : INFO : Current training batch loss: 0.4443 in epoch 5
2024-08-12 13:00:25,053 : INFO : Epoch finished, average loss over training batches: 0.4698
2024-08-12 13:00:25,053 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:25,054 : INFO : Training metrics:
2024-08-12 13:00:25,054 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:25,057 : INFO : Accuracy: 0.8710
2024-08-12 13:00:25,058 : INFO : Precision score for label_class 0: 0.8806
2024-08-12 13:00:25,058 : INFO : Precision score for label_class 1: 0.8995
2024-08-12 13:00:25,058 : INFO : Precision score for label_class 2: 0.8052
2024-08-12 13:00:25,058 : INFO : Recall score for label_class 0: 0.5396
2024-08-12 13:00:25,058 : INFO : Recall score for label_class 1: 0.9615
2024-08-12 13:00:25,058 : INFO : Recall score for label_class 2: 0.8221
2024-08-12 13:00:25,058 : INFO : Average F1 score: 0.8041
2024-08-12 13:00:25,338 : INFO : Average loss over validation batches: 0.4845
2024-08-12 13:00:25,338 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:25,338 : INFO : Validation metrics:
2024-08-12 13:00:25,338 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:25,341 : INFO : Accuracy: 0.8489
2024-08-12 13:00:25,341 : INFO : Precision score for label_class 0: 0.8169
2024-08-12 13:00:25,341 : INFO : Precision score for label_class 1: 0.8876
2024-08-12 13:00:25,341 : INFO : Precision score for label_class 2: 0.7742
2024-08-12 13:00:25,341 : INFO : Recall score for label_class 0: 0.6744
2024-08-12 13:00:25,341 : INFO : Recall score for label_class 1: 0.9275
2024-08-12 13:00:25,341 : INFO : Recall score for label_class 2: 0.7619
2024-08-12 13:00:25,341 : INFO : Average F1 score: 0.8046
2024-08-12 13:00:25,341 : INFO : Validation metric decreased (0.542197 --> 0.484511).  Saving model ...
2024-08-12 13:00:25,442 : INFO : Starting epoch 6
2024-08-12 13:00:26,088 : INFO : Current training batch loss: 0.5047 in epoch 6
2024-08-12 13:00:26,893 : INFO : Current training batch loss: 0.3549 in epoch 6
2024-08-12 13:00:27,699 : INFO : Current training batch loss: 0.4339 in epoch 6
2024-08-12 13:00:28,505 : INFO : Current training batch loss: 0.3292 in epoch 6
2024-08-12 13:00:28,847 : INFO : Epoch finished, average loss over training batches: 0.4271
2024-08-12 13:00:28,847 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:28,847 : INFO : Training metrics:
2024-08-12 13:00:28,847 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:28,851 : INFO : Accuracy: 0.8925
2024-08-12 13:00:28,851 : INFO : Precision score for label_class 0: 0.8403
2024-08-12 13:00:28,851 : INFO : Precision score for label_class 1: 0.9156
2024-08-12 13:00:28,851 : INFO : Precision score for label_class 2: 0.8581
2024-08-12 13:00:28,851 : INFO : Recall score for label_class 0: 0.6738
2024-08-12 13:00:28,851 : INFO : Recall score for label_class 1: 0.9634
2024-08-12 13:00:28,851 : INFO : Recall score for label_class 2: 0.8366
2024-08-12 13:00:28,851 : INFO : Average F1 score: 0.8447
2024-08-12 13:00:29,132 : INFO : Average loss over validation batches: 0.4732
2024-08-12 13:00:29,132 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:29,132 : INFO : Validation metrics:
2024-08-12 13:00:29,132 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:29,134 : INFO : Accuracy: 0.8504
2024-08-12 13:00:29,135 : INFO : Precision score for label_class 0: 0.8615
2024-08-12 13:00:29,135 : INFO : Precision score for label_class 1: 0.8913
2024-08-12 13:00:29,135 : INFO : Precision score for label_class 2: 0.7602
2024-08-12 13:00:29,135 : INFO : Recall score for label_class 0: 0.6512
2024-08-12 13:00:29,135 : INFO : Recall score for label_class 1: 0.9225
2024-08-12 13:00:29,135 : INFO : Recall score for label_class 2: 0.7884
2024-08-12 13:00:29,135 : INFO : Average F1 score: 0.8075
2024-08-12 13:00:29,135 : INFO : Validation metric decreased (0.484511 --> 0.473172).  Saving model ...
2024-08-12 13:00:29,239 : INFO : Split 3 is finished, the score is: 0.8075
2024-08-12 13:00:29,239 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:29,239 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:29,239 : INFO : Starting training for split 4
2024-08-12 13:00:29,250 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 327, 1621,  751]))
2024-08-12 13:00:29,252 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 87, 390, 197]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:00:29,296 : INFO : Starting epoch 1
2024-08-12 13:00:29,338 : INFO : Current training batch loss: 1.0680 in epoch 1
2024-08-12 13:00:30,143 : INFO : Current training batch loss: 1.0667 in epoch 1
2024-08-12 13:00:30,949 : INFO : Current training batch loss: 1.0023 in epoch 1
2024-08-12 13:00:31,755 : INFO : Current training batch loss: 0.9269 in epoch 1
2024-08-12 13:00:32,561 : INFO : Current training batch loss: 0.8946 in epoch 1
2024-08-12 13:00:32,702 : INFO : Epoch finished, average loss over training batches: 0.9918
2024-08-12 13:00:32,702 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:32,702 : INFO : Training metrics:
2024-08-12 13:00:32,702 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:32,710 : INFO : Accuracy: 0.6032
2024-08-12 13:00:32,710 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:00:32,710 : INFO : Precision score for label_class 1: 0.6034
2024-08-12 13:00:32,710 : INFO : Precision score for label_class 2: 0.5714
2024-08-12 13:00:32,710 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:00:32,710 : INFO : Recall score for label_class 1: 0.9994
2024-08-12 13:00:32,710 : INFO : Recall score for label_class 2: 0.0107
2024-08-12 13:00:32,710 : INFO : Average F1 score: 0.2578
2024-08-12 13:00:32,990 : INFO : Average loss over validation batches: 0.8914
2024-08-12 13:00:32,991 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:32,991 : INFO : Validation metrics:
2024-08-12 13:00:32,991 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:32,995 : INFO : Accuracy: 0.6677
2024-08-12 13:00:32,995 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:00:32,995 : INFO : Precision score for label_class 1: 0.6784
2024-08-12 13:00:32,995 : INFO : Precision score for label_class 2: 0.6095
2024-08-12 13:00:32,995 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:00:32,995 : INFO : Recall score for label_class 1: 0.9897
2024-08-12 13:00:32,995 : INFO : Recall score for label_class 2: 0.3249
2024-08-12 13:00:32,995 : INFO : Average F1 score: 0.4096
2024-08-12 13:00:32,995 : INFO : Validation metric decreased (inf --> 0.891389).  Saving model ...
2024-08-12 13:00:33,096 : INFO : Starting epoch 2
2024-08-12 13:00:33,740 : INFO : Current training batch loss: 0.8366 in epoch 2
2024-08-12 13:00:34,545 : INFO : Current training batch loss: 0.7872 in epoch 2
2024-08-12 13:00:35,351 : INFO : Current training batch loss: 0.7139 in epoch 2
2024-08-12 13:00:36,157 : INFO : Current training batch loss: 0.6428 in epoch 2
2024-08-12 13:00:36,499 : INFO : Epoch finished, average loss over training batches: 0.7561
2024-08-12 13:00:36,499 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:36,499 : INFO : Training metrics:
2024-08-12 13:00:36,499 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:36,507 : INFO : Accuracy: 0.7169
2024-08-12 13:00:36,507 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:00:36,507 : INFO : Precision score for label_class 1: 0.7659
2024-08-12 13:00:36,507 : INFO : Precision score for label_class 2: 0.5687
2024-08-12 13:00:36,507 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:00:36,507 : INFO : Recall score for label_class 1: 0.9587
2024-08-12 13:00:36,507 : INFO : Recall score for label_class 2: 0.5073
2024-08-12 13:00:36,507 : INFO : Average F1 score: 0.4626
2024-08-12 13:00:36,787 : INFO : Average loss over validation batches: 0.6761
2024-08-12 13:00:36,787 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:36,788 : INFO : Validation metrics:
2024-08-12 13:00:36,788 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:36,791 : INFO : Accuracy: 0.7567
2024-08-12 13:00:36,791 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:00:36,791 : INFO : Precision score for label_class 1: 0.8360
2024-08-12 13:00:36,791 : INFO : Precision score for label_class 2: 0.6085
2024-08-12 13:00:36,791 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:00:36,791 : INFO : Recall score for label_class 1: 0.9410
2024-08-12 13:00:36,791 : INFO : Recall score for label_class 2: 0.7259
2024-08-12 13:00:36,791 : INFO : Average F1 score: 0.5158
2024-08-12 13:00:36,791 : INFO : Validation metric decreased (0.891389 --> 0.676107).  Saving model ...
2024-08-12 13:00:36,894 : INFO : Starting epoch 3
2024-08-12 13:00:37,338 : INFO : Current training batch loss: 0.6655 in epoch 3
2024-08-12 13:00:38,144 : INFO : Current training batch loss: 0.5724 in epoch 3
2024-08-12 13:00:38,949 : INFO : Current training batch loss: 0.6556 in epoch 3
2024-08-12 13:00:39,754 : INFO : Current training batch loss: 0.4810 in epoch 3
2024-08-12 13:00:40,298 : INFO : Epoch finished, average loss over training batches: 0.5985
2024-08-12 13:00:40,298 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:40,298 : INFO : Training metrics:
2024-08-12 13:00:40,298 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:40,306 : INFO : Accuracy: 0.7792
2024-08-12 13:00:40,306 : INFO : Precision score for label_class 0: 0.8000
2024-08-12 13:00:40,306 : INFO : Precision score for label_class 1: 0.8612
2024-08-12 13:00:40,306 : INFO : Precision score for label_class 2: 0.6174
2024-08-12 13:00:40,306 : INFO : Recall score for label_class 0: 0.0122
2024-08-12 13:00:40,306 : INFO : Recall score for label_class 1: 0.9494
2024-08-12 13:00:40,306 : INFO : Recall score for label_class 2: 0.7457
2024-08-12 13:00:40,306 : INFO : Average F1 score: 0.5343
2024-08-12 13:00:40,587 : INFO : Average loss over validation batches: 0.5798
2024-08-12 13:00:40,587 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:40,587 : INFO : Validation metrics:
2024-08-12 13:00:40,587 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:40,591 : INFO : Accuracy: 0.7849
2024-08-12 13:00:40,591 : INFO : Precision score for label_class 0: 0.8000
2024-08-12 13:00:40,591 : INFO : Precision score for label_class 1: 0.8662
2024-08-12 13:00:40,591 : INFO : Precision score for label_class 2: 0.6420
2024-08-12 13:00:40,591 : INFO : Recall score for label_class 0: 0.0460
2024-08-12 13:00:40,591 : INFO : Recall score for label_class 1: 0.9462
2024-08-12 13:00:40,591 : INFO : Recall score for label_class 2: 0.7919
2024-08-12 13:00:40,591 : INFO : Average F1 score: 0.5668
2024-08-12 13:00:40,591 : INFO : Validation metric decreased (0.676107 --> 0.579817).  Saving model ...
2024-08-12 13:00:40,778 : INFO : Starting epoch 4
2024-08-12 13:00:41,020 : INFO : Current training batch loss: 0.7063 in epoch 4
2024-08-12 13:00:41,825 : INFO : Current training batch loss: 0.6637 in epoch 4
2024-08-12 13:00:42,630 : INFO : Current training batch loss: 0.4921 in epoch 4
2024-08-12 13:00:43,436 : INFO : Current training batch loss: 0.3831 in epoch 4
2024-08-12 13:00:44,181 : INFO : Epoch finished, average loss over training batches: 0.5007
2024-08-12 13:00:44,182 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:44,182 : INFO : Training metrics:
2024-08-12 13:00:44,182 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:44,189 : INFO : Accuracy: 0.8581
2024-08-12 13:00:44,189 : INFO : Precision score for label_class 0: 0.8457
2024-08-12 13:00:44,189 : INFO : Precision score for label_class 1: 0.8987
2024-08-12 13:00:44,189 : INFO : Precision score for label_class 2: 0.7713
2024-08-12 13:00:44,189 : INFO : Recall score for label_class 0: 0.4526
2024-08-12 13:00:44,189 : INFO : Recall score for label_class 1: 0.9630
2024-08-12 13:00:44,189 : INFO : Recall score for label_class 2: 0.8083
2024-08-12 13:00:44,189 : INFO : Average F1 score: 0.7696
2024-08-12 13:00:44,469 : INFO : Average loss over validation batches: 0.5260
2024-08-12 13:00:44,469 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:44,469 : INFO : Validation metrics:
2024-08-12 13:00:44,469 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:44,473 : INFO : Accuracy: 0.8398
2024-08-12 13:00:44,473 : INFO : Precision score for label_class 0: 0.7568
2024-08-12 13:00:44,473 : INFO : Precision score for label_class 1: 0.9000
2024-08-12 13:00:44,473 : INFO : Precision score for label_class 2: 0.7571
2024-08-12 13:00:44,473 : INFO : Recall score for label_class 0: 0.6437
2024-08-12 13:00:44,473 : INFO : Recall score for label_class 1: 0.9000
2024-08-12 13:00:44,473 : INFO : Recall score for label_class 2: 0.8071
2024-08-12 13:00:44,473 : INFO : Average F1 score: 0.7923
2024-08-12 13:00:44,473 : INFO : Validation metric decreased (0.579817 --> 0.526040).  Saving model ...
2024-08-12 13:00:44,574 : INFO : Starting epoch 5
2024-08-12 13:00:44,616 : INFO : Current training batch loss: 0.4303 in epoch 5
2024-08-12 13:00:45,421 : INFO : Current training batch loss: 0.5852 in epoch 5
2024-08-12 13:00:46,226 : INFO : Current training batch loss: 0.4054 in epoch 5
2024-08-12 13:00:47,032 : INFO : Current training batch loss: 0.3913 in epoch 5
2024-08-12 13:00:47,838 : INFO : Current training batch loss: 0.4097 in epoch 5
2024-08-12 13:00:47,980 : INFO : Epoch finished, average loss over training batches: 0.4329
2024-08-12 13:00:47,980 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:47,980 : INFO : Training metrics:
2024-08-12 13:00:47,980 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:47,984 : INFO : Accuracy: 0.9014
2024-08-12 13:00:47,984 : INFO : Precision score for label_class 0: 0.8587
2024-08-12 13:00:47,984 : INFO : Precision score for label_class 1: 0.9180
2024-08-12 13:00:47,984 : INFO : Precision score for label_class 2: 0.8787
2024-08-12 13:00:47,984 : INFO : Recall score for label_class 0: 0.7431
2024-08-12 13:00:47,984 : INFO : Recall score for label_class 1: 0.9667
2024-08-12 13:00:47,984 : INFO : Recall score for label_class 2: 0.8296
2024-08-12 13:00:47,984 : INFO : Average F1 score: 0.8640
2024-08-12 13:00:48,264 : INFO : Average loss over validation batches: 0.4833
2024-08-12 13:00:48,264 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:48,264 : INFO : Validation metrics:
2024-08-12 13:00:48,264 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:48,267 : INFO : Accuracy: 0.8591
2024-08-12 13:00:48,268 : INFO : Precision score for label_class 0: 0.7444
2024-08-12 13:00:48,268 : INFO : Precision score for label_class 1: 0.8919
2024-08-12 13:00:48,268 : INFO : Precision score for label_class 2: 0.8418
2024-08-12 13:00:48,268 : INFO : Recall score for label_class 0: 0.7701
2024-08-12 13:00:48,268 : INFO : Recall score for label_class 1: 0.9308
2024-08-12 13:00:48,268 : INFO : Recall score for label_class 2: 0.7563
2024-08-12 13:00:48,268 : INFO : Average F1 score: 0.8216
2024-08-12 13:00:48,268 : INFO : Validation metric decreased (0.526040 --> 0.483320).  Saving model ...
2024-08-12 13:00:48,368 : INFO : Starting epoch 6
2024-08-12 13:00:49,013 : INFO : Current training batch loss: 0.4946 in epoch 6
2024-08-12 13:00:49,819 : INFO : Current training batch loss: 0.3403 in epoch 6
2024-08-12 13:00:50,625 : INFO : Current training batch loss: 0.3541 in epoch 6
2024-08-12 13:00:51,431 : INFO : Current training batch loss: 0.2823 in epoch 6
2024-08-12 13:00:51,774 : INFO : Epoch finished, average loss over training batches: 0.3973
2024-08-12 13:00:51,774 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:51,774 : INFO : Training metrics:
2024-08-12 13:00:51,774 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:51,779 : INFO : Accuracy: 0.9126
2024-08-12 13:00:51,779 : INFO : Precision score for label_class 0: 0.8533
2024-08-12 13:00:51,779 : INFO : Precision score for label_class 1: 0.9310
2024-08-12 13:00:51,779 : INFO : Precision score for label_class 2: 0.8942
2024-08-12 13:00:51,779 : INFO : Recall score for label_class 0: 0.7829
2024-08-12 13:00:51,779 : INFO : Recall score for label_class 1: 0.9655
2024-08-12 13:00:51,779 : INFO : Recall score for label_class 2: 0.8549
2024-08-12 13:00:51,779 : INFO : Average F1 score: 0.8795
2024-08-12 13:00:52,059 : INFO : Average loss over validation batches: 0.4748
2024-08-12 13:00:52,059 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:52,059 : INFO : Validation metrics:
2024-08-12 13:00:52,059 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:52,063 : INFO : Accuracy: 0.8605
2024-08-12 13:00:52,063 : INFO : Precision score for label_class 0: 0.7701
2024-08-12 13:00:52,063 : INFO : Precision score for label_class 1: 0.8841
2024-08-12 13:00:52,063 : INFO : Precision score for label_class 2: 0.8497
2024-08-12 13:00:52,063 : INFO : Recall score for label_class 0: 0.7701
2024-08-12 13:00:52,063 : INFO : Recall score for label_class 1: 0.9385
2024-08-12 13:00:52,063 : INFO : Recall score for label_class 2: 0.7462
2024-08-12 13:00:52,063 : INFO : Average F1 score: 0.8251
2024-08-12 13:00:52,063 : INFO : Validation metric decreased (0.483320 --> 0.474780).  Saving model ...
2024-08-12 13:00:52,166 : INFO : Split 4 is finished, the score is: 0.8251
2024-08-12 13:00:52,167 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:52,167 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:52,167 : INFO : Starting training for split 5
2024-08-12 13:00:52,181 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 330, 1615,  754]))
2024-08-12 13:00:52,184 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 84, 396, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:00:52,225 : INFO : Starting epoch 1
2024-08-12 13:00:52,267 : INFO : Current training batch loss: 1.1279 in epoch 1
2024-08-12 13:00:53,073 : INFO : Current training batch loss: 1.1002 in epoch 1
2024-08-12 13:00:53,880 : INFO : Current training batch loss: 1.0352 in epoch 1
2024-08-12 13:00:54,686 : INFO : Current training batch loss: 0.9423 in epoch 1
2024-08-12 13:00:55,492 : INFO : Current training batch loss: 0.9835 in epoch 1
2024-08-12 13:00:55,633 : INFO : Epoch finished, average loss over training batches: 1.0316
2024-08-12 13:00:55,633 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:55,633 : INFO : Training metrics:
2024-08-12 13:00:55,633 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:55,644 : INFO : Accuracy: 0.4761
2024-08-12 13:00:55,644 : INFO : Precision score for label_class 0: 0.1799
2024-08-12 13:00:55,644 : INFO : Precision score for label_class 1: 0.5944
2024-08-12 13:00:55,644 : INFO : Precision score for label_class 2: 0.2537
2024-08-12 13:00:55,644 : INFO : Recall score for label_class 0: 0.2061
2024-08-12 13:00:55,644 : INFO : Recall score for label_class 1: 0.6786
2024-08-12 13:00:55,644 : INFO : Recall score for label_class 2: 0.1605
2024-08-12 13:00:55,644 : INFO : Average F1 score: 0.3408
2024-08-12 13:00:55,924 : INFO : Average loss over validation batches: 0.9082
2024-08-12 13:00:55,925 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:55,925 : INFO : Validation metrics:
2024-08-12 13:00:55,925 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:55,928 : INFO : Accuracy: 0.5875
2024-08-12 13:00:55,928 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:00:55,928 : INFO : Precision score for label_class 1: 0.5875
2024-08-12 13:00:55,928 : INFO : Precision score for label_class 2: 0.0000
2024-08-12 13:00:55,928 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:00:55,928 : INFO : Recall score for label_class 1: 1.0000
2024-08-12 13:00:55,928 : INFO : Recall score for label_class 2: 0.0000
2024-08-12 13:00:55,928 : INFO : Average F1 score: 0.2467
2024-08-12 13:00:55,928 : INFO : Validation metric decreased (inf --> 0.908177).  Saving model ...
2024-08-12 13:00:56,027 : INFO : Starting epoch 2
2024-08-12 13:00:56,672 : INFO : Current training batch loss: 0.9066 in epoch 2
2024-08-12 13:00:57,478 : INFO : Current training batch loss: 0.8606 in epoch 2
2024-08-12 13:00:58,284 : INFO : Current training batch loss: 0.7946 in epoch 2
2024-08-12 13:00:59,090 : INFO : Current training batch loss: 0.7081 in epoch 2
2024-08-12 13:00:59,432 : INFO : Epoch finished, average loss over training batches: 0.8227
2024-08-12 13:00:59,432 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:59,432 : INFO : Training metrics:
2024-08-12 13:00:59,432 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:59,443 : INFO : Accuracy: 0.6769
2024-08-12 13:00:59,443 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:00:59,444 : INFO : Precision score for label_class 1: 0.6945
2024-08-12 13:00:59,444 : INFO : Precision score for label_class 2: 0.5791
2024-08-12 13:00:59,444 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:00:59,444 : INFO : Recall score for label_class 1: 0.9839
2024-08-12 13:00:59,444 : INFO : Recall score for label_class 2: 0.3156
2024-08-12 13:00:59,444 : INFO : Average F1 score: 0.4076
2024-08-12 13:00:59,723 : INFO : Average loss over validation batches: 0.7511
2024-08-12 13:00:59,724 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:59,724 : INFO : Validation metrics:
2024-08-12 13:00:59,724 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:00:59,727 : INFO : Accuracy: 0.7107
2024-08-12 13:00:59,727 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:00:59,727 : INFO : Precision score for label_class 1: 0.7651
2024-08-12 13:00:59,727 : INFO : Precision score for label_class 2: 0.5568
2024-08-12 13:00:59,727 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:00:59,727 : INFO : Recall score for label_class 1: 0.9621
2024-08-12 13:00:59,727 : INFO : Recall score for label_class 2: 0.5052
2024-08-12 13:00:59,727 : INFO : Average F1 score: 0.4607
2024-08-12 13:00:59,727 : INFO : Validation metric decreased (0.908177 --> 0.751134).  Saving model ...
2024-08-12 13:00:59,827 : INFO : Starting epoch 3
2024-08-12 13:01:00,271 : INFO : Current training batch loss: 0.7656 in epoch 3
2024-08-12 13:01:01,077 : INFO : Current training batch loss: 0.6615 in epoch 3
2024-08-12 13:01:01,883 : INFO : Current training batch loss: 0.7810 in epoch 3
2024-08-12 13:01:02,688 : INFO : Current training batch loss: 0.6012 in epoch 3
2024-08-12 13:01:03,232 : INFO : Epoch finished, average loss over training batches: 0.6914
2024-08-12 13:01:03,232 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:03,232 : INFO : Training metrics:
2024-08-12 13:01:03,232 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:03,243 : INFO : Accuracy: 0.7273
2024-08-12 13:01:03,243 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:01:03,243 : INFO : Precision score for label_class 1: 0.7924
2024-08-12 13:01:03,243 : INFO : Precision score for label_class 2: 0.5607
2024-08-12 13:01:03,243 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:01:03,243 : INFO : Recall score for label_class 1: 0.9523
2024-08-12 13:01:03,243 : INFO : Recall score for label_class 2: 0.5637
2024-08-12 13:01:03,243 : INFO : Average F1 score: 0.4757
2024-08-12 13:01:03,524 : INFO : Average loss over validation batches: 0.6533
2024-08-12 13:01:03,524 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:03,525 : INFO : Validation metrics:
2024-08-12 13:01:03,525 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:03,528 : INFO : Accuracy: 0.7226
2024-08-12 13:01:03,528 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:01:03,528 : INFO : Precision score for label_class 1: 0.7936
2024-08-12 13:01:03,528 : INFO : Precision score for label_class 2: 0.5588
2024-08-12 13:01:03,528 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:01:03,528 : INFO : Recall score for label_class 1: 0.9419
2024-08-12 13:01:03,528 : INFO : Recall score for label_class 2: 0.5876
2024-08-12 13:01:03,528 : INFO : Average F1 score: 0.4781
2024-08-12 13:01:03,528 : INFO : Validation metric decreased (0.751134 --> 0.653333).  Saving model ...
2024-08-12 13:01:03,628 : INFO : Starting epoch 4
2024-08-12 13:01:03,871 : INFO : Current training batch loss: 0.7610 in epoch 4
2024-08-12 13:01:04,677 : INFO : Current training batch loss: 0.8071 in epoch 4
2024-08-12 13:01:05,483 : INFO : Current training batch loss: 0.6060 in epoch 4
2024-08-12 13:01:06,288 : INFO : Current training batch loss: 0.6608 in epoch 4
2024-08-12 13:01:07,033 : INFO : Epoch finished, average loss over training batches: 0.6011
2024-08-12 13:01:07,033 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:07,033 : INFO : Training metrics:
2024-08-12 13:01:07,033 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:07,045 : INFO : Accuracy: 0.7699
2024-08-12 13:01:07,045 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:01:07,045 : INFO : Precision score for label_class 1: 0.8503
2024-08-12 13:01:07,045 : INFO : Precision score for label_class 2: 0.6043
2024-08-12 13:01:07,045 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:01:07,045 : INFO : Recall score for label_class 1: 0.9567
2024-08-12 13:01:07,045 : INFO : Recall score for label_class 2: 0.7069
2024-08-12 13:01:07,045 : INFO : Average F1 score: 0.5173
2024-08-12 13:01:07,325 : INFO : Average loss over validation batches: 0.5985
2024-08-12 13:01:07,325 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:07,325 : INFO : Validation metrics:
2024-08-12 13:01:07,325 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:07,328 : INFO : Accuracy: 0.7537
2024-08-12 13:01:07,328 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:01:07,328 : INFO : Precision score for label_class 1: 0.8341
2024-08-12 13:01:07,328 : INFO : Precision score for label_class 2: 0.5965
2024-08-12 13:01:07,328 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:01:07,328 : INFO : Recall score for label_class 1: 0.9394
2024-08-12 13:01:07,328 : INFO : Recall score for label_class 2: 0.7010
2024-08-12 13:01:07,328 : INFO : Average F1 score: 0.5094
2024-08-12 13:01:07,328 : INFO : Validation metric decreased (0.653333 --> 0.598501).  Saving model ...
2024-08-12 13:01:07,431 : INFO : Starting epoch 5
2024-08-12 13:01:07,473 : INFO : Current training batch loss: 0.5377 in epoch 5
2024-08-12 13:01:08,278 : INFO : Current training batch loss: 0.6775 in epoch 5
2024-08-12 13:01:09,084 : INFO : Current training batch loss: 0.4983 in epoch 5
2024-08-12 13:01:09,890 : INFO : Current training batch loss: 0.5197 in epoch 5
2024-08-12 13:01:10,696 : INFO : Current training batch loss: 0.4918 in epoch 5
2024-08-12 13:01:10,837 : INFO : Epoch finished, average loss over training batches: 0.5392
2024-08-12 13:01:10,837 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:10,837 : INFO : Training metrics:
2024-08-12 13:01:10,837 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:10,848 : INFO : Accuracy: 0.7981
2024-08-12 13:01:10,849 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:01:10,849 : INFO : Precision score for label_class 1: 0.8860
2024-08-12 13:01:10,849 : INFO : Precision score for label_class 2: 0.6349
2024-08-12 13:01:10,849 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:01:10,849 : INFO : Recall score for label_class 1: 0.9622
2024-08-12 13:01:10,849 : INFO : Recall score for label_class 2: 0.7958
2024-08-12 13:01:10,849 : INFO : Average F1 score: 0.5429
2024-08-12 13:01:11,129 : INFO : Average loss over validation batches: 0.5738
2024-08-12 13:01:11,129 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:11,129 : INFO : Validation metrics:
2024-08-12 13:01:11,129 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:11,132 : INFO : Accuracy: 0.7582
2024-08-12 13:01:11,132 : INFO : Precision score for label_class 0: 1.0000
2024-08-12 13:01:11,132 : INFO : Precision score for label_class 1: 0.8744
2024-08-12 13:01:11,132 : INFO : Precision score for label_class 2: 0.5805
2024-08-12 13:01:11,132 : INFO : Recall score for label_class 0: 0.0119
2024-08-12 13:01:11,132 : INFO : Recall score for label_class 1: 0.8965
2024-08-12 13:01:11,132 : INFO : Recall score for label_class 2: 0.7990
2024-08-12 13:01:11,132 : INFO : Average F1 score: 0.5271
2024-08-12 13:01:11,132 : INFO : Validation metric decreased (0.598501 --> 0.573781).  Saving model ...
2024-08-12 13:01:11,234 : INFO : Starting epoch 6
2024-08-12 13:01:11,879 : INFO : Current training batch loss: 0.5709 in epoch 6
2024-08-12 13:01:12,685 : INFO : Current training batch loss: 0.4931 in epoch 6
2024-08-12 13:01:13,490 : INFO : Current training batch loss: 0.4711 in epoch 6
2024-08-12 13:01:14,296 : INFO : Current training batch loss: 0.5115 in epoch 6
2024-08-12 13:01:14,639 : INFO : Epoch finished, average loss over training batches: 0.5057
2024-08-12 13:01:14,639 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:14,639 : INFO : Training metrics:
2024-08-12 13:01:14,639 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:14,650 : INFO : Accuracy: 0.8092
2024-08-12 13:01:14,650 : INFO : Precision score for label_class 0: 0.8000
2024-08-12 13:01:14,650 : INFO : Precision score for label_class 1: 0.8999
2024-08-12 13:01:14,650 : INFO : Precision score for label_class 2: 0.6466
2024-08-12 13:01:14,650 : INFO : Recall score for label_class 0: 0.0121
2024-08-12 13:01:14,650 : INFO : Recall score for label_class 1: 0.9635
2024-08-12 13:01:14,650 : INFO : Recall score for label_class 2: 0.8276
2024-08-12 13:01:14,650 : INFO : Average F1 score: 0.5602
2024-08-12 13:01:14,930 : INFO : Average loss over validation batches: 0.5620
2024-08-12 13:01:14,930 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:14,930 : INFO : Validation metrics:
2024-08-12 13:01:14,931 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:14,934 : INFO : Accuracy: 0.7596
2024-08-12 13:01:14,934 : INFO : Precision score for label_class 0: 1.0000
2024-08-12 13:01:14,934 : INFO : Precision score for label_class 1: 0.8444
2024-08-12 13:01:14,934 : INFO : Precision score for label_class 2: 0.6017
2024-08-12 13:01:14,934 : INFO : Recall score for label_class 0: 0.0119
2024-08-12 13:01:14,934 : INFO : Recall score for label_class 1: 0.9318
2024-08-12 13:01:14,934 : INFO : Recall score for label_class 2: 0.7320
2024-08-12 13:01:14,934 : INFO : Average F1 score: 0.5233
2024-08-12 13:01:14,934 : INFO : Validation metric decreased (0.573781 --> 0.561993).  Saving model ...
2024-08-12 13:01:15,037 : INFO : Split 5 is finished, the score is: 0.5233
2024-08-12 13:01:15,037 : INFO : ----------------------------------------------------------------------------------------------------
[I 2024-08-12 13:01:15,038] Trial 8 finished with value: 0.7628686079571698 and parameters: {'n_epochs': 6, 'learning_rate': 1.1755370912849952e-05, 'classifier_dropout': 0.20247450701852074, 'warmup_step_fraction': 0.0921203593429666, 'use_gradient_clipping': False}. Best is trial 6 with value: 0.8419854360165029.
2024-08-12 13:01:15,038 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:15,038 : INFO : Starting training for split 1
2024-08-12 13:01:15,049 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 328, 1596,  774]))
2024-08-12 13:01:15,051 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 86, 415, 174]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:01:15,092 : INFO : Starting epoch 1
2024-08-12 13:01:15,134 : INFO : Current training batch loss: 1.0956 in epoch 1
2024-08-12 13:01:15,941 : INFO : Current training batch loss: 0.9223 in epoch 1
2024-08-12 13:01:16,750 : INFO : Current training batch loss: 0.8265 in epoch 1
2024-08-12 13:01:17,558 : INFO : Current training batch loss: 0.6547 in epoch 1
2024-08-12 13:01:18,366 : INFO : Current training batch loss: 0.5817 in epoch 1
2024-08-12 13:01:18,508 : INFO : Epoch finished, average loss over training batches: 0.8199
2024-08-12 13:01:18,508 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:18,508 : INFO : Training metrics:
2024-08-12 13:01:18,509 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:18,513 : INFO : Accuracy: 0.6527
2024-08-12 13:01:18,514 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:01:18,514 : INFO : Precision score for label_class 1: 0.7215
2024-08-12 13:01:18,514 : INFO : Precision score for label_class 2: 0.4847
2024-08-12 13:01:18,514 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:01:18,514 : INFO : Recall score for label_class 1: 0.8653
2024-08-12 13:01:18,514 : INFO : Recall score for label_class 2: 0.4910
2024-08-12 13:01:18,514 : INFO : Average F1 score: 0.4249
2024-08-12 13:01:18,794 : INFO : Average loss over validation batches: 0.5860
2024-08-12 13:01:18,794 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:18,794 : INFO : Validation metrics:
2024-08-12 13:01:18,794 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:18,796 : INFO : Accuracy: 0.7556
2024-08-12 13:01:18,796 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:01:18,796 : INFO : Precision score for label_class 1: 0.8857
2024-08-12 13:01:18,796 : INFO : Precision score for label_class 2: 0.5412
2024-08-12 13:01:18,796 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:01:18,796 : INFO : Recall score for label_class 1: 0.8964
2024-08-12 13:01:18,796 : INFO : Recall score for label_class 2: 0.7931
2024-08-12 13:01:18,796 : INFO : Average F1 score: 0.5115
2024-08-12 13:01:18,796 : INFO : Validation metric decreased (inf --> 0.585974).  Saving model ...
2024-08-12 13:01:18,897 : INFO : Starting epoch 2
2024-08-12 13:01:19,544 : INFO : Current training batch loss: 0.3112 in epoch 2
2024-08-12 13:01:20,352 : INFO : Current training batch loss: 0.5847 in epoch 2
2024-08-12 13:01:21,159 : INFO : Current training batch loss: 0.4798 in epoch 2
2024-08-12 13:01:21,967 : INFO : Current training batch loss: 0.3443 in epoch 2
2024-08-12 13:01:22,311 : INFO : Epoch finished, average loss over training batches: 0.4754
2024-08-12 13:01:22,311 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:22,311 : INFO : Training metrics:
2024-08-12 13:01:22,311 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:22,316 : INFO : Accuracy: 0.8247
2024-08-12 13:01:22,316 : INFO : Precision score for label_class 0: 0.7306
2024-08-12 13:01:22,316 : INFO : Precision score for label_class 1: 0.8941
2024-08-12 13:01:22,316 : INFO : Precision score for label_class 2: 0.7113
2024-08-12 13:01:22,316 : INFO : Recall score for label_class 0: 0.4299
2024-08-12 13:01:22,316 : INFO : Recall score for label_class 1: 0.9261
2024-08-12 13:01:22,316 : INFO : Recall score for label_class 2: 0.7829
2024-08-12 13:01:22,316 : INFO : Average F1 score: 0.7322
2024-08-12 13:01:22,596 : INFO : Average loss over validation batches: 0.3716
2024-08-12 13:01:22,596 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:22,596 : INFO : Validation metrics:
2024-08-12 13:01:22,596 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:22,599 : INFO : Accuracy: 0.8756
2024-08-12 13:01:22,599 : INFO : Precision score for label_class 0: 0.7551
2024-08-12 13:01:22,599 : INFO : Precision score for label_class 1: 0.9265
2024-08-12 13:01:22,599 : INFO : Precision score for label_class 2: 0.8225
2024-08-12 13:01:22,599 : INFO : Recall score for label_class 0: 0.8605
2024-08-12 13:01:22,599 : INFO : Recall score for label_class 1: 0.9108
2024-08-12 13:01:22,599 : INFO : Recall score for label_class 2: 0.7989
2024-08-12 13:01:22,599 : INFO : Average F1 score: 0.8445
2024-08-12 13:01:22,599 : INFO : Validation metric decreased (0.585974 --> 0.371578).  Saving model ...
2024-08-12 13:01:22,701 : INFO : Starting epoch 3
2024-08-12 13:01:23,146 : INFO : Current training batch loss: 0.3101 in epoch 3
2024-08-12 13:01:23,954 : INFO : Current training batch loss: 0.3872 in epoch 3
2024-08-12 13:01:24,762 : INFO : Current training batch loss: 0.3118 in epoch 3
2024-08-12 13:01:25,570 : INFO : Current training batch loss: 0.0939 in epoch 3
2024-08-12 13:01:26,115 : INFO : Epoch finished, average loss over training batches: 0.2592
2024-08-12 13:01:26,116 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:26,116 : INFO : Training metrics:
2024-08-12 13:01:26,116 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:26,121 : INFO : Accuracy: 0.9248
2024-08-12 13:01:26,121 : INFO : Precision score for label_class 0: 0.8242
2024-08-12 13:01:26,121 : INFO : Precision score for label_class 1: 0.9562
2024-08-12 13:01:26,121 : INFO : Precision score for label_class 2: 0.9043
2024-08-12 13:01:26,121 : INFO : Recall score for label_class 0: 0.8720
2024-08-12 13:01:26,121 : INFO : Recall score for label_class 1: 0.9580
2024-08-12 13:01:26,121 : INFO : Recall score for label_class 2: 0.8786
2024-08-12 13:01:26,121 : INFO : Average F1 score: 0.8986
2024-08-12 13:01:26,400 : INFO : Average loss over validation batches: 0.3945
2024-08-12 13:01:26,400 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:26,400 : INFO : Validation metrics:
2024-08-12 13:01:26,400 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:26,403 : INFO : Accuracy: 0.8519
2024-08-12 13:01:26,403 : INFO : Precision score for label_class 0: 0.7453
2024-08-12 13:01:26,403 : INFO : Precision score for label_class 1: 0.9383
2024-08-12 13:01:26,403 : INFO : Precision score for label_class 2: 0.7449
2024-08-12 13:01:26,403 : INFO : Recall score for label_class 0: 0.9186
2024-08-12 13:01:26,403 : INFO : Recall score for label_class 1: 0.8434
2024-08-12 13:01:26,403 : INFO : Recall score for label_class 2: 0.8391
2024-08-12 13:01:26,403 : INFO : Average F1 score: 0.8335
2024-08-12 13:01:26,403 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 13:01:26,403 : INFO : Starting epoch 4
2024-08-12 13:01:26,646 : INFO : Current training batch loss: 0.4497 in epoch 4
2024-08-12 13:01:27,454 : INFO : Current training batch loss: 0.1112 in epoch 4
2024-08-12 13:01:28,262 : INFO : Current training batch loss: 0.2729 in epoch 4
2024-08-12 13:01:29,070 : INFO : Current training batch loss: 0.1426 in epoch 4
2024-08-12 13:01:29,817 : INFO : Epoch finished, average loss over training batches: 0.1540
2024-08-12 13:01:29,817 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:29,817 : INFO : Training metrics:
2024-08-12 13:01:29,817 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:29,822 : INFO : Accuracy: 0.9592
2024-08-12 13:01:29,822 : INFO : Precision score for label_class 0: 0.8812
2024-08-12 13:01:29,822 : INFO : Precision score for label_class 1: 0.9793
2024-08-12 13:01:29,822 : INFO : Precision score for label_class 2: 0.9526
2024-08-12 13:01:29,822 : INFO : Recall score for label_class 0: 0.9268
2024-08-12 13:01:29,823 : INFO : Recall score for label_class 1: 0.9781
2024-08-12 13:01:29,823 : INFO : Recall score for label_class 2: 0.9341
2024-08-12 13:01:29,823 : INFO : Average F1 score: 0.9418
2024-08-12 13:01:30,103 : INFO : Average loss over validation batches: 0.3636
2024-08-12 13:01:30,104 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:30,104 : INFO : Validation metrics:
2024-08-12 13:01:30,104 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:30,106 : INFO : Accuracy: 0.8889
2024-08-12 13:01:30,106 : INFO : Precision score for label_class 0: 0.7647
2024-08-12 13:01:30,106 : INFO : Precision score for label_class 1: 0.9255
2024-08-12 13:01:30,106 : INFO : Precision score for label_class 2: 0.8726
2024-08-12 13:01:30,106 : INFO : Recall score for label_class 0: 0.9070
2024-08-12 13:01:30,106 : INFO : Recall score for label_class 1: 0.9277
2024-08-12 13:01:30,106 : INFO : Recall score for label_class 2: 0.7874
2024-08-12 13:01:30,106 : INFO : Average F1 score: 0.8614
2024-08-12 13:01:30,107 : INFO : Validation metric decreased (0.371578 --> 0.363582).  Saving model ...
2024-08-12 13:01:30,203 : INFO : Starting epoch 5
2024-08-12 13:01:30,245 : INFO : Current training batch loss: 0.0554 in epoch 5
2024-08-12 13:01:31,055 : INFO : Current training batch loss: 0.2086 in epoch 5
2024-08-12 13:01:31,868 : INFO : Current training batch loss: 0.0537 in epoch 5
2024-08-12 13:01:32,682 : INFO : Current training batch loss: 0.1354 in epoch 5
2024-08-12 13:01:33,495 : INFO : Current training batch loss: 0.1307 in epoch 5
2024-08-12 13:01:33,642 : INFO : Epoch finished, average loss over training batches: 0.0998
2024-08-12 13:01:33,642 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:33,642 : INFO : Training metrics:
2024-08-12 13:01:33,642 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:33,650 : INFO : Accuracy: 0.9778
2024-08-12 13:01:33,650 : INFO : Precision score for label_class 0: 0.9164
2024-08-12 13:01:33,650 : INFO : Precision score for label_class 1: 0.9906
2024-08-12 13:01:33,650 : INFO : Precision score for label_class 2: 0.9790
2024-08-12 13:01:33,650 : INFO : Recall score for label_class 0: 0.9695
2024-08-12 13:01:33,650 : INFO : Recall score for label_class 1: 0.9868
2024-08-12 13:01:33,650 : INFO : Recall score for label_class 2: 0.9625
2024-08-12 13:01:33,650 : INFO : Average F1 score: 0.9672
2024-08-12 13:01:33,930 : INFO : Average loss over validation batches: 0.3538
2024-08-12 13:01:33,930 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:33,930 : INFO : Validation metrics:
2024-08-12 13:01:33,930 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:33,933 : INFO : Accuracy: 0.8993
2024-08-12 13:01:33,933 : INFO : Precision score for label_class 0: 0.8298
2024-08-12 13:01:33,933 : INFO : Precision score for label_class 1: 0.9296
2024-08-12 13:01:33,933 : INFO : Precision score for label_class 2: 0.8639
2024-08-12 13:01:33,933 : INFO : Recall score for label_class 0: 0.9070
2024-08-12 13:01:33,933 : INFO : Recall score for label_class 1: 0.9229
2024-08-12 13:01:33,933 : INFO : Recall score for label_class 2: 0.8391
2024-08-12 13:01:33,933 : INFO : Average F1 score: 0.8814
2024-08-12 13:01:33,933 : INFO : Validation metric decreased (0.363582 --> 0.353778).  Saving model ...
2024-08-12 13:01:34,031 : INFO : Split 1 is finished, the score is: 0.8814
2024-08-12 13:01:34,031 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:34,031 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:34,031 : INFO : Starting training for split 2
2024-08-12 13:01:34,043 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 343, 1601,  754]))
2024-08-12 13:01:34,045 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 71, 410, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:01:34,084 : INFO : Starting epoch 1
2024-08-12 13:01:34,127 : INFO : Current training batch loss: 1.0973 in epoch 1
2024-08-12 13:01:34,940 : INFO : Current training batch loss: 1.0054 in epoch 1
2024-08-12 13:01:35,753 : INFO : Current training batch loss: 0.9061 in epoch 1
2024-08-12 13:01:36,566 : INFO : Current training batch loss: 0.7062 in epoch 1
2024-08-12 13:01:37,379 : INFO : Current training batch loss: 0.6700 in epoch 1
2024-08-12 13:01:37,525 : INFO : Epoch finished, average loss over training batches: 0.8538
2024-08-12 13:01:37,526 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:37,526 : INFO : Training metrics:
2024-08-12 13:01:37,526 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:37,533 : INFO : Accuracy: 0.6193
2024-08-12 13:01:37,533 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:01:37,533 : INFO : Precision score for label_class 1: 0.6737
2024-08-12 13:01:37,533 : INFO : Precision score for label_class 2: 0.4326
2024-08-12 13:01:37,533 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:01:37,533 : INFO : Recall score for label_class 1: 0.8795
2024-08-12 13:01:37,533 : INFO : Recall score for label_class 2: 0.3488
2024-08-12 13:01:37,533 : INFO : Average F1 score: 0.3830
2024-08-12 13:01:37,813 : INFO : Average loss over validation batches: 0.6257
2024-08-12 13:01:37,813 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:37,813 : INFO : Validation metrics:
2024-08-12 13:01:37,813 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:37,816 : INFO : Accuracy: 0.7556
2024-08-12 13:01:37,816 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:01:37,816 : INFO : Precision score for label_class 1: 0.8578
2024-08-12 13:01:37,816 : INFO : Precision score for label_class 2: 0.5850
2024-08-12 13:01:37,816 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:01:37,816 : INFO : Recall score for label_class 1: 0.8829
2024-08-12 13:01:37,816 : INFO : Recall score for label_class 2: 0.7629
2024-08-12 13:01:37,816 : INFO : Average F1 score: 0.5108
2024-08-12 13:01:37,816 : INFO : Validation metric decreased (inf --> 0.625738).  Saving model ...
2024-08-12 13:01:37,915 : INFO : Starting epoch 2
2024-08-12 13:01:38,565 : INFO : Current training batch loss: 0.6314 in epoch 2
2024-08-12 13:01:39,378 : INFO : Current training batch loss: 0.5996 in epoch 2
2024-08-12 13:01:40,190 : INFO : Current training batch loss: 0.3731 in epoch 2
2024-08-12 13:01:41,003 : INFO : Current training batch loss: 0.4221 in epoch 2
2024-08-12 13:01:41,352 : INFO : Epoch finished, average loss over training batches: 0.4982
2024-08-12 13:01:41,352 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:41,352 : INFO : Training metrics:
2024-08-12 13:01:41,352 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:41,360 : INFO : Accuracy: 0.8165
2024-08-12 13:01:41,360 : INFO : Precision score for label_class 0: 0.7130
2024-08-12 13:01:41,360 : INFO : Precision score for label_class 1: 0.8795
2024-08-12 13:01:41,360 : INFO : Precision score for label_class 2: 0.7080
2024-08-12 13:01:41,360 : INFO : Recall score for label_class 0: 0.4636
2024-08-12 13:01:41,360 : INFO : Recall score for label_class 1: 0.9344
2024-08-12 13:01:41,360 : INFO : Recall score for label_class 2: 0.7268
2024-08-12 13:01:41,360 : INFO : Average F1 score: 0.7284
2024-08-12 13:01:41,640 : INFO : Average loss over validation batches: 0.3919
2024-08-12 13:01:41,640 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:41,640 : INFO : Validation metrics:
2024-08-12 13:01:41,640 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:41,644 : INFO : Accuracy: 0.8652
2024-08-12 13:01:41,644 : INFO : Precision score for label_class 0: 0.7639
2024-08-12 13:01:41,644 : INFO : Precision score for label_class 1: 0.8913
2024-08-12 13:01:41,644 : INFO : Precision score for label_class 2: 0.8444
2024-08-12 13:01:41,644 : INFO : Recall score for label_class 0: 0.7746
2024-08-12 13:01:41,644 : INFO : Recall score for label_class 1: 0.9195
2024-08-12 13:01:41,644 : INFO : Recall score for label_class 2: 0.7835
2024-08-12 13:01:41,644 : INFO : Average F1 score: 0.8291
2024-08-12 13:01:41,644 : INFO : Validation metric decreased (0.625738 --> 0.391888).  Saving model ...
2024-08-12 13:01:41,743 : INFO : Starting epoch 3
2024-08-12 13:01:42,191 : INFO : Current training batch loss: 0.2698 in epoch 3
2024-08-12 13:01:43,003 : INFO : Current training batch loss: 0.2690 in epoch 3
2024-08-12 13:01:43,816 : INFO : Current training batch loss: 0.2336 in epoch 3
2024-08-12 13:01:44,629 : INFO : Current training batch loss: 0.2173 in epoch 3
2024-08-12 13:01:45,181 : INFO : Epoch finished, average loss over training batches: 0.2719
2024-08-12 13:01:45,181 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:45,181 : INFO : Training metrics:
2024-08-12 13:01:45,181 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:45,188 : INFO : Accuracy: 0.9155
2024-08-12 13:01:45,188 : INFO : Precision score for label_class 0: 0.8244
2024-08-12 13:01:45,188 : INFO : Precision score for label_class 1: 0.9468
2024-08-12 13:01:45,188 : INFO : Precision score for label_class 2: 0.8900
2024-08-12 13:01:45,188 : INFO : Recall score for label_class 0: 0.8484
2024-08-12 13:01:45,188 : INFO : Recall score for label_class 1: 0.9569
2024-08-12 13:01:45,188 : INFO : Recall score for label_class 2: 0.8581
2024-08-12 13:01:45,188 : INFO : Average F1 score: 0.8873
2024-08-12 13:01:45,468 : INFO : Average loss over validation batches: 0.3781
2024-08-12 13:01:45,468 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:45,468 : INFO : Validation metrics:
2024-08-12 13:01:45,468 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:45,471 : INFO : Accuracy: 0.8667
2024-08-12 13:01:45,471 : INFO : Precision score for label_class 0: 0.7432
2024-08-12 13:01:45,471 : INFO : Precision score for label_class 1: 0.9066
2024-08-12 13:01:45,471 : INFO : Precision score for label_class 2: 0.8299
2024-08-12 13:01:45,471 : INFO : Recall score for label_class 0: 0.7746
2024-08-12 13:01:45,471 : INFO : Recall score for label_class 1: 0.9000
2024-08-12 13:01:45,471 : INFO : Recall score for label_class 2: 0.8299
2024-08-12 13:01:45,471 : INFO : Average F1 score: 0.8306
2024-08-12 13:01:45,471 : INFO : Validation metric decreased (0.391888 --> 0.378114).  Saving model ...
2024-08-12 13:01:45,571 : INFO : Starting epoch 4
2024-08-12 13:01:45,816 : INFO : Current training batch loss: 0.3196 in epoch 4
2024-08-12 13:01:46,629 : INFO : Current training batch loss: 0.1844 in epoch 4
2024-08-12 13:01:47,442 : INFO : Current training batch loss: 0.2723 in epoch 4
2024-08-12 13:01:48,255 : INFO : Current training batch loss: 0.1588 in epoch 4
2024-08-12 13:01:49,010 : INFO : Epoch finished, average loss over training batches: 0.1572
2024-08-12 13:01:49,010 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:49,010 : INFO : Training metrics:
2024-08-12 13:01:49,010 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:49,018 : INFO : Accuracy: 0.9596
2024-08-12 13:01:49,018 : INFO : Precision score for label_class 0: 0.8799
2024-08-12 13:01:49,018 : INFO : Precision score for label_class 1: 0.9788
2024-08-12 13:01:49,018 : INFO : Precision score for label_class 2: 0.9565
2024-08-12 13:01:49,018 : INFO : Recall score for label_class 0: 0.9184
2024-08-12 13:01:49,018 : INFO : Recall score for label_class 1: 0.9813
2024-08-12 13:01:49,018 : INFO : Recall score for label_class 2: 0.9324
2024-08-12 13:01:49,018 : INFO : Average F1 score: 0.9410
2024-08-12 13:01:49,298 : INFO : Average loss over validation batches: 0.4228
2024-08-12 13:01:49,299 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:49,299 : INFO : Validation metrics:
2024-08-12 13:01:49,299 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:49,302 : INFO : Accuracy: 0.8681
2024-08-12 13:01:49,302 : INFO : Precision score for label_class 0: 0.7317
2024-08-12 13:01:49,302 : INFO : Precision score for label_class 1: 0.9175
2024-08-12 13:01:49,302 : INFO : Precision score for label_class 2: 0.8238
2024-08-12 13:01:49,302 : INFO : Recall score for label_class 0: 0.8451
2024-08-12 13:01:49,302 : INFO : Recall score for label_class 1: 0.8951
2024-08-12 13:01:49,302 : INFO : Recall score for label_class 2: 0.8196
2024-08-12 13:01:49,302 : INFO : Average F1 score: 0.8374
2024-08-12 13:01:49,302 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 13:01:49,302 : INFO : Starting epoch 5
2024-08-12 13:01:49,344 : INFO : Current training batch loss: 0.0774 in epoch 5
2024-08-12 13:01:50,157 : INFO : Current training batch loss: 0.2677 in epoch 5
2024-08-12 13:01:50,970 : INFO : Current training batch loss: 0.1165 in epoch 5
2024-08-12 13:01:51,784 : INFO : Current training batch loss: 0.1665 in epoch 5
2024-08-12 13:01:52,597 : INFO : Current training batch loss: 0.1762 in epoch 5
2024-08-12 13:01:52,744 : INFO : Epoch finished, average loss over training batches: 0.1096
2024-08-12 13:01:52,744 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:52,744 : INFO : Training metrics:
2024-08-12 13:01:52,744 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:52,754 : INFO : Accuracy: 0.9752
2024-08-12 13:01:52,754 : INFO : Precision score for label_class 0: 0.9192
2024-08-12 13:01:52,754 : INFO : Precision score for label_class 1: 0.9875
2024-08-12 13:01:52,755 : INFO : Precision score for label_class 2: 0.9757
2024-08-12 13:01:52,755 : INFO : Recall score for label_class 0: 0.9621
2024-08-12 13:01:52,755 : INFO : Recall score for label_class 1: 0.9856
2024-08-12 13:01:52,755 : INFO : Recall score for label_class 2: 0.9589
2024-08-12 13:01:52,755 : INFO : Average F1 score: 0.9647
2024-08-12 13:01:53,035 : INFO : Average loss over validation batches: 0.4024
2024-08-12 13:01:53,035 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:53,035 : INFO : Validation metrics:
2024-08-12 13:01:53,035 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:53,038 : INFO : Accuracy: 0.8741
2024-08-12 13:01:53,038 : INFO : Precision score for label_class 0: 0.7600
2024-08-12 13:01:53,038 : INFO : Precision score for label_class 1: 0.9002
2024-08-12 13:01:53,038 : INFO : Precision score for label_class 2: 0.8603
2024-08-12 13:01:53,038 : INFO : Recall score for label_class 0: 0.8028
2024-08-12 13:01:53,038 : INFO : Recall score for label_class 1: 0.9244
2024-08-12 13:01:53,038 : INFO : Recall score for label_class 2: 0.7938
2024-08-12 13:01:53,038 : INFO : Average F1 score: 0.8396
2024-08-12 13:01:53,038 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 13:01:53,038 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:01:53,070 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 13:01:53,383 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:53,383 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 13:01:53,383 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:53,386 : INFO : Accuracy: 0.8667
2024-08-12 13:01:53,386 : INFO : Precision score for label_class 0: 0.7432
2024-08-12 13:01:53,386 : INFO : Precision score for label_class 1: 0.9066
2024-08-12 13:01:53,386 : INFO : Precision score for label_class 2: 0.8299
2024-08-12 13:01:53,386 : INFO : Recall score for label_class 0: 0.7746
2024-08-12 13:01:53,386 : INFO : Recall score for label_class 1: 0.9000
2024-08-12 13:01:53,386 : INFO : Recall score for label_class 2: 0.8299
2024-08-12 13:01:53,386 : INFO : Average F1 score: 0.8306
2024-08-12 13:01:53,386 : INFO : Determined score from best model, ending training.
2024-08-12 13:01:53,388 : INFO : Split 2 is finished, the score is: 0.8306
2024-08-12 13:01:53,388 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:53,388 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:53,388 : INFO : Starting training for split 3
2024-08-12 13:01:53,399 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 328, 1611,  759]))
2024-08-12 13:01:53,401 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 86, 400, 189]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:01:53,440 : INFO : Starting epoch 1
2024-08-12 13:01:53,482 : INFO : Current training batch loss: 1.0977 in epoch 1
2024-08-12 13:01:54,295 : INFO : Current training batch loss: 1.0209 in epoch 1
2024-08-12 13:01:55,109 : INFO : Current training batch loss: 0.7795 in epoch 1
2024-08-12 13:01:55,922 : INFO : Current training batch loss: 0.7898 in epoch 1
2024-08-12 13:01:56,735 : INFO : Current training batch loss: 0.6182 in epoch 1
2024-08-12 13:01:56,882 : INFO : Epoch finished, average loss over training batches: 0.8430
2024-08-12 13:01:56,882 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:56,882 : INFO : Training metrics:
2024-08-12 13:01:56,882 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:56,889 : INFO : Accuracy: 0.6420
2024-08-12 13:01:56,889 : INFO : Precision score for label_class 0: 0.2143
2024-08-12 13:01:56,889 : INFO : Precision score for label_class 1: 0.6881
2024-08-12 13:01:56,889 : INFO : Precision score for label_class 2: 0.5270
2024-08-12 13:01:56,889 : INFO : Recall score for label_class 0: 0.0732
2024-08-12 13:01:56,889 : INFO : Recall score for label_class 1: 0.9150
2024-08-12 13:01:56,889 : INFO : Recall score for label_class 2: 0.3083
2024-08-12 13:01:56,889 : INFO : Average F1 score: 0.4279
2024-08-12 13:01:57,169 : INFO : Average loss over validation batches: 0.5888
2024-08-12 13:01:57,170 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:57,170 : INFO : Validation metrics:
2024-08-12 13:01:57,170 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:01:57,172 : INFO : Accuracy: 0.7837
2024-08-12 13:01:57,173 : INFO : Precision score for label_class 0: 0.6818
2024-08-12 13:01:57,173 : INFO : Precision score for label_class 1: 0.8471
2024-08-12 13:01:57,173 : INFO : Precision score for label_class 2: 0.6739
2024-08-12 13:01:57,173 : INFO : Recall score for label_class 0: 0.5233
2024-08-12 13:01:57,173 : INFO : Recall score for label_class 1: 0.9000
2024-08-12 13:01:57,173 : INFO : Recall score for label_class 2: 0.6561
2024-08-12 13:01:57,173 : INFO : Average F1 score: 0.7099
2024-08-12 13:01:57,173 : INFO : Validation metric decreased (inf --> 0.588847).  Saving model ...
2024-08-12 13:01:57,269 : INFO : Starting epoch 2
2024-08-12 13:01:57,919 : INFO : Current training batch loss: 0.5520 in epoch 2
2024-08-12 13:01:58,731 : INFO : Current training batch loss: 0.3671 in epoch 2
2024-08-12 13:01:59,544 : INFO : Current training batch loss: 0.4143 in epoch 2
2024-08-12 13:02:00,357 : INFO : Current training batch loss: 0.3623 in epoch 2
2024-08-12 13:02:00,706 : INFO : Epoch finished, average loss over training batches: 0.4443
2024-08-12 13:02:00,706 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:00,706 : INFO : Training metrics:
2024-08-12 13:02:00,706 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:00,711 : INFO : Accuracy: 0.8588
2024-08-12 13:02:00,711 : INFO : Precision score for label_class 0: 0.8034
2024-08-12 13:02:00,711 : INFO : Precision score for label_class 1: 0.8809
2024-08-12 13:02:00,711 : INFO : Precision score for label_class 2: 0.8283
2024-08-12 13:02:00,711 : INFO : Recall score for label_class 0: 0.7226
2024-08-12 13:02:00,711 : INFO : Recall score for label_class 1: 0.9317
2024-08-12 13:02:00,711 : INFO : Recall score for label_class 2: 0.7628
2024-08-12 13:02:00,711 : INFO : Average F1 score: 0.8202
2024-08-12 13:02:00,990 : INFO : Average loss over validation batches: 0.3725
2024-08-12 13:02:00,991 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:00,991 : INFO : Validation metrics:
2024-08-12 13:02:00,991 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:00,993 : INFO : Accuracy: 0.8667
2024-08-12 13:02:00,993 : INFO : Precision score for label_class 0: 0.8667
2024-08-12 13:02:00,993 : INFO : Precision score for label_class 1: 0.8956
2024-08-12 13:02:00,993 : INFO : Precision score for label_class 2: 0.8032
2024-08-12 13:02:00,993 : INFO : Recall score for label_class 0: 0.7558
2024-08-12 13:02:00,993 : INFO : Recall score for label_class 1: 0.9225
2024-08-12 13:02:00,993 : INFO : Recall score for label_class 2: 0.7989
2024-08-12 13:02:00,993 : INFO : Average F1 score: 0.8391
2024-08-12 13:02:00,993 : INFO : Validation metric decreased (0.588847 --> 0.372525).  Saving model ...
2024-08-12 13:02:01,091 : INFO : Starting epoch 3
2024-08-12 13:02:01,540 : INFO : Current training batch loss: 0.1783 in epoch 3
2024-08-12 13:02:02,353 : INFO : Current training batch loss: 0.2242 in epoch 3
2024-08-12 13:02:03,165 : INFO : Current training batch loss: 0.3597 in epoch 3
2024-08-12 13:02:03,979 : INFO : Current training batch loss: 0.0860 in epoch 3
2024-08-12 13:02:04,531 : INFO : Epoch finished, average loss over training batches: 0.2399
2024-08-12 13:02:04,531 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:04,531 : INFO : Training metrics:
2024-08-12 13:02:04,531 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:04,536 : INFO : Accuracy: 0.9333
2024-08-12 13:02:04,536 : INFO : Precision score for label_class 0: 0.8653
2024-08-12 13:02:04,536 : INFO : Precision score for label_class 1: 0.9521
2024-08-12 13:02:04,536 : INFO : Precision score for label_class 2: 0.9224
2024-08-12 13:02:04,536 : INFO : Recall score for label_class 0: 0.8811
2024-08-12 13:02:04,536 : INFO : Recall score for label_class 1: 0.9628
2024-08-12 13:02:04,536 : INFO : Recall score for label_class 2: 0.8933
2024-08-12 13:02:04,536 : INFO : Average F1 score: 0.9127
2024-08-12 13:02:04,815 : INFO : Average loss over validation batches: 0.3913
2024-08-12 13:02:04,816 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:04,816 : INFO : Validation metrics:
2024-08-12 13:02:04,816 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:04,818 : INFO : Accuracy: 0.8637
2024-08-12 13:02:04,818 : INFO : Precision score for label_class 0: 0.7308
2024-08-12 13:02:04,818 : INFO : Precision score for label_class 1: 0.9209
2024-08-12 13:02:04,818 : INFO : Precision score for label_class 2: 0.8156
2024-08-12 13:02:04,818 : INFO : Recall score for label_class 0: 0.8837
2024-08-12 13:02:04,818 : INFO : Recall score for label_class 1: 0.9025
2024-08-12 13:02:04,818 : INFO : Recall score for label_class 2: 0.7725
2024-08-12 13:02:04,818 : INFO : Average F1 score: 0.8350
2024-08-12 13:02:04,818 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 13:02:04,818 : INFO : Starting epoch 4
2024-08-12 13:02:05,063 : INFO : Current training batch loss: 0.3435 in epoch 4
2024-08-12 13:02:05,875 : INFO : Current training batch loss: 0.2290 in epoch 4
2024-08-12 13:02:06,688 : INFO : Current training batch loss: 0.3272 in epoch 4
2024-08-12 13:02:07,502 : INFO : Current training batch loss: 0.1500 in epoch 4
2024-08-12 13:02:08,257 : INFO : Epoch finished, average loss over training batches: 0.1648
2024-08-12 13:02:08,257 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:08,257 : INFO : Training metrics:
2024-08-12 13:02:08,257 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:08,264 : INFO : Accuracy: 0.9533
2024-08-12 13:02:08,264 : INFO : Precision score for label_class 0: 0.8853
2024-08-12 13:02:08,264 : INFO : Precision score for label_class 1: 0.9662
2024-08-12 13:02:08,264 : INFO : Precision score for label_class 2: 0.9562
2024-08-12 13:02:08,264 : INFO : Recall score for label_class 0: 0.9177
2024-08-12 13:02:08,264 : INFO : Recall score for label_class 1: 0.9764
2024-08-12 13:02:08,264 : INFO : Recall score for label_class 2: 0.9196
2024-08-12 13:02:08,264 : INFO : Average F1 score: 0.9367
2024-08-12 13:02:08,544 : INFO : Average loss over validation batches: 0.3739
2024-08-12 13:02:08,545 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:08,545 : INFO : Validation metrics:
2024-08-12 13:02:08,545 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:08,547 : INFO : Accuracy: 0.8800
2024-08-12 13:02:08,547 : INFO : Precision score for label_class 0: 0.8022
2024-08-12 13:02:08,547 : INFO : Precision score for label_class 1: 0.9132
2024-08-12 13:02:08,547 : INFO : Precision score for label_class 2: 0.8453
2024-08-12 13:02:08,547 : INFO : Recall score for label_class 0: 0.8488
2024-08-12 13:02:08,547 : INFO : Recall score for label_class 1: 0.9200
2024-08-12 13:02:08,547 : INFO : Recall score for label_class 2: 0.8095
2024-08-12 13:02:08,547 : INFO : Average F1 score: 0.8561
2024-08-12 13:02:08,547 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 13:02:08,547 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:02:08,579 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 13:02:08,888 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:08,888 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 13:02:08,888 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:08,890 : INFO : Accuracy: 0.8667
2024-08-12 13:02:08,890 : INFO : Precision score for label_class 0: 0.8667
2024-08-12 13:02:08,890 : INFO : Precision score for label_class 1: 0.8956
2024-08-12 13:02:08,891 : INFO : Precision score for label_class 2: 0.8032
2024-08-12 13:02:08,891 : INFO : Recall score for label_class 0: 0.7558
2024-08-12 13:02:08,891 : INFO : Recall score for label_class 1: 0.9225
2024-08-12 13:02:08,891 : INFO : Recall score for label_class 2: 0.7989
2024-08-12 13:02:08,891 : INFO : Average F1 score: 0.8391
2024-08-12 13:02:08,891 : INFO : Determined score from best model, ending training.
2024-08-12 13:02:08,892 : INFO : Split 3 is finished, the score is: 0.8391
2024-08-12 13:02:08,892 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:08,892 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:08,892 : INFO : Starting training for split 4
2024-08-12 13:02:08,909 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 327, 1621,  751]))
2024-08-12 13:02:08,911 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 87, 390, 197]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:02:08,962 : INFO : Starting epoch 1
2024-08-12 13:02:09,005 : INFO : Current training batch loss: 1.0865 in epoch 1
2024-08-12 13:02:09,818 : INFO : Current training batch loss: 1.0135 in epoch 1
2024-08-12 13:02:10,631 : INFO : Current training batch loss: 0.7488 in epoch 1
2024-08-12 13:02:11,444 : INFO : Current training batch loss: 0.6051 in epoch 1
2024-08-12 13:02:12,257 : INFO : Current training batch loss: 0.5628 in epoch 1
2024-08-12 13:02:12,404 : INFO : Epoch finished, average loss over training batches: 0.8211
2024-08-12 13:02:12,404 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:12,404 : INFO : Training metrics:
2024-08-12 13:02:12,404 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:12,412 : INFO : Accuracy: 0.6621
2024-08-12 13:02:12,412 : INFO : Precision score for label_class 0: 0.1250
2024-08-12 13:02:12,412 : INFO : Precision score for label_class 1: 0.6986
2024-08-12 13:02:12,412 : INFO : Precision score for label_class 2: 0.5551
2024-08-12 13:02:12,412 : INFO : Recall score for label_class 0: 0.0214
2024-08-12 13:02:12,412 : INFO : Recall score for label_class 1: 0.9395
2024-08-12 13:02:12,412 : INFO : Recall score for label_class 2: 0.3422
2024-08-12 13:02:12,412 : INFO : Average F1 score: 0.4204
2024-08-12 13:02:12,692 : INFO : Average loss over validation batches: 0.5948
2024-08-12 13:02:12,692 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:12,692 : INFO : Validation metrics:
2024-08-12 13:02:12,692 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:12,695 : INFO : Accuracy: 0.7611
2024-08-12 13:02:12,695 : INFO : Precision score for label_class 0: 1.0000
2024-08-12 13:02:12,695 : INFO : Precision score for label_class 1: 0.8633
2024-08-12 13:02:12,695 : INFO : Precision score for label_class 2: 0.5938
2024-08-12 13:02:12,695 : INFO : Recall score for label_class 0: 0.0115
2024-08-12 13:02:12,695 : INFO : Recall score for label_class 1: 0.9231
2024-08-12 13:02:12,695 : INFO : Recall score for label_class 2: 0.7716
2024-08-12 13:02:12,695 : INFO : Average F1 score: 0.5287
2024-08-12 13:02:12,695 : INFO : Validation metric decreased (inf --> 0.594814).  Saving model ...
2024-08-12 13:02:12,802 : INFO : Starting epoch 2
2024-08-12 13:02:13,452 : INFO : Current training batch loss: 0.6220 in epoch 2
2024-08-12 13:02:14,265 : INFO : Current training batch loss: 0.3742 in epoch 2
2024-08-12 13:02:15,077 : INFO : Current training batch loss: 0.2602 in epoch 2
2024-08-12 13:02:15,890 : INFO : Current training batch loss: 0.2823 in epoch 2
2024-08-12 13:02:16,239 : INFO : Epoch finished, average loss over training batches: 0.4235
2024-08-12 13:02:16,240 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:16,240 : INFO : Training metrics:
2024-08-12 13:02:16,240 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:16,245 : INFO : Accuracy: 0.8596
2024-08-12 13:02:16,245 : INFO : Precision score for label_class 0: 0.7974
2024-08-12 13:02:16,245 : INFO : Precision score for label_class 1: 0.8867
2024-08-12 13:02:16,245 : INFO : Precision score for label_class 2: 0.8200
2024-08-12 13:02:16,245 : INFO : Recall score for label_class 0: 0.7462
2024-08-12 13:02:16,245 : INFO : Recall score for label_class 1: 0.9321
2024-08-12 13:02:16,245 : INFO : Recall score for label_class 2: 0.7523
2024-08-12 13:02:16,245 : INFO : Average F1 score: 0.8215
2024-08-12 13:02:16,524 : INFO : Average loss over validation batches: 0.3955
2024-08-12 13:02:16,524 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:16,524 : INFO : Validation metrics:
2024-08-12 13:02:16,524 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:16,527 : INFO : Accuracy: 0.8501
2024-08-12 13:02:16,527 : INFO : Precision score for label_class 0: 0.8451
2024-08-12 13:02:16,527 : INFO : Precision score for label_class 1: 0.8939
2024-08-12 13:02:16,527 : INFO : Precision score for label_class 2: 0.7681
2024-08-12 13:02:16,527 : INFO : Recall score for label_class 0: 0.6897
2024-08-12 13:02:16,527 : INFO : Recall score for label_class 1: 0.9077
2024-08-12 13:02:16,527 : INFO : Recall score for label_class 2: 0.8071
2024-08-12 13:02:16,527 : INFO : Average F1 score: 0.8158
2024-08-12 13:02:16,527 : INFO : Validation metric decreased (0.594814 --> 0.395526).  Saving model ...
2024-08-12 13:02:16,626 : INFO : Starting epoch 3
2024-08-12 13:02:17,074 : INFO : Current training batch loss: 0.1242 in epoch 3
2024-08-12 13:02:17,886 : INFO : Current training batch loss: 0.1683 in epoch 3
2024-08-12 13:02:18,699 : INFO : Current training batch loss: 0.1008 in epoch 3
2024-08-12 13:02:19,512 : INFO : Current training batch loss: 0.1968 in epoch 3
2024-08-12 13:02:20,064 : INFO : Epoch finished, average loss over training batches: 0.2178
2024-08-12 13:02:20,065 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:20,065 : INFO : Training metrics:
2024-08-12 13:02:20,065 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:20,072 : INFO : Accuracy: 0.9370
2024-08-12 13:02:20,072 : INFO : Precision score for label_class 0: 0.8728
2024-08-12 13:02:20,072 : INFO : Precision score for label_class 1: 0.9617
2024-08-12 13:02:20,072 : INFO : Precision score for label_class 2: 0.9126
2024-08-12 13:02:20,072 : INFO : Recall score for label_class 0: 0.9021
2024-08-12 13:02:20,072 : INFO : Recall score for label_class 1: 0.9593
2024-08-12 13:02:20,072 : INFO : Recall score for label_class 2: 0.9041
2024-08-12 13:02:20,072 : INFO : Average F1 score: 0.9187
2024-08-12 13:02:20,352 : INFO : Average loss over validation batches: 0.4232
2024-08-12 13:02:20,352 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:20,352 : INFO : Validation metrics:
2024-08-12 13:02:20,352 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:20,355 : INFO : Accuracy: 0.8605
2024-08-12 13:02:20,355 : INFO : Precision score for label_class 0: 0.8452
2024-08-12 13:02:20,356 : INFO : Precision score for label_class 1: 0.9187
2024-08-12 13:02:20,356 : INFO : Precision score for label_class 2: 0.7692
2024-08-12 13:02:20,356 : INFO : Recall score for label_class 0: 0.8161
2024-08-12 13:02:20,356 : INFO : Recall score for label_class 1: 0.8692
2024-08-12 13:02:20,356 : INFO : Recall score for label_class 2: 0.8629
2024-08-12 13:02:20,356 : INFO : Average F1 score: 0.8457
2024-08-12 13:02:20,356 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 13:02:20,356 : INFO : Starting epoch 4
2024-08-12 13:02:20,600 : INFO : Current training batch loss: 0.2666 in epoch 4
2024-08-12 13:02:21,413 : INFO : Current training batch loss: 0.2058 in epoch 4
2024-08-12 13:02:22,226 : INFO : Current training batch loss: 0.1169 in epoch 4
2024-08-12 13:02:23,038 : INFO : Current training batch loss: 0.1428 in epoch 4
2024-08-12 13:02:23,794 : INFO : Epoch finished, average loss over training batches: 0.1383
2024-08-12 13:02:23,794 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:23,794 : INFO : Training metrics:
2024-08-12 13:02:23,794 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:23,801 : INFO : Accuracy: 0.9644
2024-08-12 13:02:23,801 : INFO : Precision score for label_class 0: 0.9086
2024-08-12 13:02:23,801 : INFO : Precision score for label_class 1: 0.9767
2024-08-12 13:02:23,801 : INFO : Precision score for label_class 2: 0.9631
2024-08-12 13:02:23,801 : INFO : Recall score for label_class 0: 0.9419
2024-08-12 13:02:23,801 : INFO : Recall score for label_class 1: 0.9815
2024-08-12 13:02:23,801 : INFO : Recall score for label_class 2: 0.9374
2024-08-12 13:02:23,801 : INFO : Average F1 score: 0.9514
2024-08-12 13:02:24,081 : INFO : Average loss over validation batches: 0.4068
2024-08-12 13:02:24,081 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:24,081 : INFO : Validation metrics:
2024-08-12 13:02:24,081 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:24,084 : INFO : Accuracy: 0.8754
2024-08-12 13:02:24,084 : INFO : Precision score for label_class 0: 0.7935
2024-08-12 13:02:24,084 : INFO : Precision score for label_class 1: 0.8873
2024-08-12 13:02:24,084 : INFO : Precision score for label_class 2: 0.8909
2024-08-12 13:02:24,084 : INFO : Recall score for label_class 0: 0.8391
2024-08-12 13:02:24,084 : INFO : Recall score for label_class 1: 0.9487
2024-08-12 13:02:24,084 : INFO : Recall score for label_class 2: 0.7462
2024-08-12 13:02:24,084 : INFO : Average F1 score: 0.8483
2024-08-12 13:02:24,084 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 13:02:24,084 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:02:24,122 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 13:02:24,436 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:24,436 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 13:02:24,436 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:24,439 : INFO : Accuracy: 0.8501
2024-08-12 13:02:24,439 : INFO : Precision score for label_class 0: 0.8451
2024-08-12 13:02:24,439 : INFO : Precision score for label_class 1: 0.8939
2024-08-12 13:02:24,439 : INFO : Precision score for label_class 2: 0.7681
2024-08-12 13:02:24,439 : INFO : Recall score for label_class 0: 0.6897
2024-08-12 13:02:24,439 : INFO : Recall score for label_class 1: 0.9077
2024-08-12 13:02:24,439 : INFO : Recall score for label_class 2: 0.8071
2024-08-12 13:02:24,439 : INFO : Average F1 score: 0.8158
2024-08-12 13:02:24,439 : INFO : Determined score from best model, ending training.
2024-08-12 13:02:24,441 : INFO : Split 4 is finished, the score is: 0.8158
2024-08-12 13:02:24,441 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:24,441 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:24,441 : INFO : Starting training for split 5
2024-08-12 13:02:24,452 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 330, 1615,  754]))
2024-08-12 13:02:24,454 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 84, 396, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:02:24,493 : INFO : Starting epoch 1
2024-08-12 13:02:24,536 : INFO : Current training batch loss: 1.1135 in epoch 1
2024-08-12 13:02:25,354 : INFO : Current training batch loss: 1.0170 in epoch 1
2024-08-12 13:02:26,167 : INFO : Current training batch loss: 0.7635 in epoch 1
2024-08-12 13:02:26,980 : INFO : Current training batch loss: 0.6531 in epoch 1
2024-08-12 13:02:27,793 : INFO : Current training batch loss: 0.6579 in epoch 1
2024-08-12 13:02:27,939 : INFO : Epoch finished, average loss over training batches: 0.8329
2024-08-12 13:02:27,939 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:27,939 : INFO : Training metrics:
2024-08-12 13:02:27,939 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:27,950 : INFO : Accuracy: 0.6380
2024-08-12 13:02:27,950 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:02:27,950 : INFO : Precision score for label_class 1: 0.7064
2024-08-12 13:02:27,950 : INFO : Precision score for label_class 2: 0.4682
2024-08-12 13:02:27,950 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:02:27,950 : INFO : Recall score for label_class 1: 0.8656
2024-08-12 13:02:27,950 : INFO : Recall score for label_class 2: 0.4297
2024-08-12 13:02:27,950 : INFO : Average F1 score: 0.4087
2024-08-12 13:02:28,231 : INFO : Average loss over validation batches: 0.5856
2024-08-12 13:02:28,231 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:28,231 : INFO : Validation metrics:
2024-08-12 13:02:28,231 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:28,235 : INFO : Accuracy: 0.7404
2024-08-12 13:02:28,235 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:02:28,235 : INFO : Precision score for label_class 1: 0.8034
2024-08-12 13:02:28,235 : INFO : Precision score for label_class 2: 0.5920
2024-08-12 13:02:28,235 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:02:28,235 : INFO : Recall score for label_class 1: 0.9596
2024-08-12 13:02:28,235 : INFO : Recall score for label_class 2: 0.6134
2024-08-12 13:02:28,235 : INFO : Average F1 score: 0.4924
2024-08-12 13:02:28,235 : INFO : Validation metric decreased (inf --> 0.585649).  Saving model ...
2024-08-12 13:02:28,345 : INFO : Starting epoch 2
2024-08-12 13:02:28,995 : INFO : Current training batch loss: 0.5491 in epoch 2
2024-08-12 13:02:29,808 : INFO : Current training batch loss: 0.4223 in epoch 2
2024-08-12 13:02:30,620 : INFO : Current training batch loss: 0.2797 in epoch 2
2024-08-12 13:02:31,433 : INFO : Current training batch loss: 0.4210 in epoch 2
2024-08-12 13:02:31,783 : INFO : Epoch finished, average loss over training batches: 0.4561
2024-08-12 13:02:31,783 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:31,783 : INFO : Training metrics:
2024-08-12 13:02:31,783 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:31,794 : INFO : Accuracy: 0.8485
2024-08-12 13:02:31,794 : INFO : Precision score for label_class 0: 0.7766
2024-08-12 13:02:31,794 : INFO : Precision score for label_class 1: 0.8832
2024-08-12 13:02:31,794 : INFO : Precision score for label_class 2: 0.7938
2024-08-12 13:02:31,794 : INFO : Recall score for label_class 0: 0.6636
2024-08-12 13:02:31,794 : INFO : Recall score for label_class 1: 0.9319
2024-08-12 13:02:31,794 : INFO : Recall score for label_class 2: 0.7507
2024-08-12 13:02:31,794 : INFO : Average F1 score: 0.7981
2024-08-12 13:02:32,073 : INFO : Average loss over validation batches: 0.4339
2024-08-12 13:02:32,073 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:32,073 : INFO : Validation metrics:
2024-08-12 13:02:32,073 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:32,077 : INFO : Accuracy: 0.8323
2024-08-12 13:02:32,077 : INFO : Precision score for label_class 0: 0.6703
2024-08-12 13:02:32,077 : INFO : Precision score for label_class 1: 0.8931
2024-08-12 13:02:32,077 : INFO : Precision score for label_class 2: 0.7842
2024-08-12 13:02:32,077 : INFO : Recall score for label_class 0: 0.7262
2024-08-12 13:02:32,077 : INFO : Recall score for label_class 1: 0.8864
2024-08-12 13:02:32,077 : INFO : Recall score for label_class 2: 0.7680
2024-08-12 13:02:32,077 : INFO : Average F1 score: 0.7876
2024-08-12 13:02:32,077 : INFO : Validation metric decreased (0.585649 --> 0.433916).  Saving model ...
2024-08-12 13:02:32,175 : INFO : Starting epoch 3
2024-08-12 13:02:32,623 : INFO : Current training batch loss: 0.2287 in epoch 3
2024-08-12 13:02:33,435 : INFO : Current training batch loss: 0.3655 in epoch 3
2024-08-12 13:02:34,248 : INFO : Current training batch loss: 0.1749 in epoch 3
2024-08-12 13:02:35,061 : INFO : Current training batch loss: 0.2296 in epoch 3
2024-08-12 13:02:35,613 : INFO : Epoch finished, average loss over training batches: 0.2636
2024-08-12 13:02:35,613 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:35,613 : INFO : Training metrics:
2024-08-12 13:02:35,613 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:35,624 : INFO : Accuracy: 0.9215
2024-08-12 13:02:35,624 : INFO : Precision score for label_class 0: 0.8491
2024-08-12 13:02:35,624 : INFO : Precision score for label_class 1: 0.9445
2024-08-12 13:02:35,624 : INFO : Precision score for label_class 2: 0.9038
2024-08-12 13:02:35,624 : INFO : Recall score for label_class 0: 0.8697
2024-08-12 13:02:35,624 : INFO : Recall score for label_class 1: 0.9492
2024-08-12 13:02:35,624 : INFO : Recall score for label_class 2: 0.8846
2024-08-12 13:02:35,624 : INFO : Average F1 score: 0.9001
2024-08-12 13:02:35,904 : INFO : Average loss over validation batches: 0.4364
2024-08-12 13:02:35,904 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:35,904 : INFO : Validation metrics:
2024-08-12 13:02:35,904 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:35,908 : INFO : Accuracy: 0.8501
2024-08-12 13:02:35,908 : INFO : Precision score for label_class 0: 0.7283
2024-08-12 13:02:35,908 : INFO : Precision score for label_class 1: 0.8832
2024-08-12 13:02:35,908 : INFO : Precision score for label_class 2: 0.8363
2024-08-12 13:02:35,908 : INFO : Recall score for label_class 0: 0.7976
2024-08-12 13:02:35,908 : INFO : Recall score for label_class 1: 0.9167
2024-08-12 13:02:35,908 : INFO : Recall score for label_class 2: 0.7371
2024-08-12 13:02:35,908 : INFO : Average F1 score: 0.8149
2024-08-12 13:02:35,908 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 13:02:35,908 : INFO : Starting epoch 4
2024-08-12 13:02:36,153 : INFO : Current training batch loss: 0.3175 in epoch 4
2024-08-12 13:02:36,966 : INFO : Current training batch loss: 0.2199 in epoch 4
2024-08-12 13:02:37,778 : INFO : Current training batch loss: 0.1534 in epoch 4
2024-08-12 13:02:38,591 : INFO : Current training batch loss: 0.0510 in epoch 4
2024-08-12 13:02:39,346 : INFO : Epoch finished, average loss over training batches: 0.1705
2024-08-12 13:02:39,346 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:39,346 : INFO : Training metrics:
2024-08-12 13:02:39,346 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:39,353 : INFO : Accuracy: 0.9552
2024-08-12 13:02:39,353 : INFO : Precision score for label_class 0: 0.8879
2024-08-12 13:02:39,353 : INFO : Precision score for label_class 1: 0.9698
2024-08-12 13:02:39,353 : INFO : Precision score for label_class 2: 0.9547
2024-08-12 13:02:39,353 : INFO : Recall score for label_class 0: 0.9364
2024-08-12 13:02:39,353 : INFO : Recall score for label_class 1: 0.9740
2024-08-12 13:02:39,353 : INFO : Recall score for label_class 2: 0.9231
2024-08-12 13:02:39,353 : INFO : Average F1 score: 0.9407
2024-08-12 13:02:39,633 : INFO : Average loss over validation batches: 0.4528
2024-08-12 13:02:39,633 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:39,633 : INFO : Validation metrics:
2024-08-12 13:02:39,633 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:39,637 : INFO : Accuracy: 0.8457
2024-08-12 13:02:39,637 : INFO : Precision score for label_class 0: 0.7283
2024-08-12 13:02:39,637 : INFO : Precision score for label_class 1: 0.9196
2024-08-12 13:02:39,637 : INFO : Precision score for label_class 2: 0.7656
2024-08-12 13:02:39,637 : INFO : Recall score for label_class 0: 0.7976
2024-08-12 13:02:39,637 : INFO : Recall score for label_class 1: 0.8662
2024-08-12 13:02:39,637 : INFO : Recall score for label_class 2: 0.8247
2024-08-12 13:02:39,637 : INFO : Average F1 score: 0.8158
2024-08-12 13:02:39,637 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 13:02:39,637 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:02:39,671 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 13:02:39,984 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:39,985 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 13:02:39,985 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:39,988 : INFO : Accuracy: 0.8323
2024-08-12 13:02:39,988 : INFO : Precision score for label_class 0: 0.6703
2024-08-12 13:02:39,988 : INFO : Precision score for label_class 1: 0.8931
2024-08-12 13:02:39,988 : INFO : Precision score for label_class 2: 0.7842
2024-08-12 13:02:39,988 : INFO : Recall score for label_class 0: 0.7262
2024-08-12 13:02:39,988 : INFO : Recall score for label_class 1: 0.8864
2024-08-12 13:02:39,989 : INFO : Recall score for label_class 2: 0.7680
2024-08-12 13:02:39,989 : INFO : Average F1 score: 0.7876
2024-08-12 13:02:39,989 : INFO : Determined score from best model, ending training.
2024-08-12 13:02:39,994 : INFO : Split 5 is finished, the score is: 0.7876
2024-08-12 13:02:39,994 : INFO : ----------------------------------------------------------------------------------------------------
[I 2024-08-12 13:02:39,994] Trial 9 finished with value: 0.830915062391467 and parameters: {'n_epochs': 5, 'learning_rate': 7.532475054262501e-05, 'classifier_dropout': 0.7388909119523113, 'warmup_step_fraction': 0.08978986078275805, 'use_gradient_clipping': True}. Best is trial 6 with value: 0.8419854360165029.
2024-08-12 13:02:40,002 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:40,002 : INFO : Starting training for split 1
2024-08-12 13:02:40,013 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 328, 1596,  774]))
2024-08-12 13:02:40,015 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 86, 415, 174]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:02:40,064 : INFO : Starting epoch 1
2024-08-12 13:02:40,106 : INFO : Current training batch loss: 1.1090 in epoch 1
2024-08-12 13:02:40,917 : INFO : Current training batch loss: 0.8467 in epoch 1
2024-08-12 13:02:41,728 : INFO : Current training batch loss: 0.7893 in epoch 1
2024-08-12 13:02:42,539 : INFO : Current training batch loss: 0.6137 in epoch 1
2024-08-12 13:02:43,349 : INFO : Current training batch loss: 0.7208 in epoch 1
2024-08-12 13:02:43,494 : INFO : Epoch finished, average loss over training batches: 0.8202
2024-08-12 13:02:43,495 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:43,495 : INFO : Training metrics:
2024-08-12 13:02:43,495 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:43,503 : INFO : Accuracy: 0.6516
2024-08-12 13:02:43,503 : INFO : Precision score for label_class 0: 0.1667
2024-08-12 13:02:43,503 : INFO : Precision score for label_class 1: 0.7201
2024-08-12 13:02:43,503 : INFO : Precision score for label_class 2: 0.5252
2024-08-12 13:02:43,503 : INFO : Recall score for label_class 0: 0.0701
2024-08-12 13:02:43,503 : INFO : Recall score for label_class 1: 0.9041
2024-08-12 13:02:43,503 : INFO : Recall score for label_class 2: 0.3773
2024-08-12 13:02:43,503 : INFO : Average F1 score: 0.4465
2024-08-12 13:02:43,782 : INFO : Average loss over validation batches: 0.6690
2024-08-12 13:02:43,782 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:43,782 : INFO : Validation metrics:
2024-08-12 13:02:43,782 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:43,785 : INFO : Accuracy: 0.7215
2024-08-12 13:02:43,785 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:02:43,785 : INFO : Precision score for label_class 1: 0.8136
2024-08-12 13:02:43,785 : INFO : Precision score for label_class 2: 0.5074
2024-08-12 13:02:43,785 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:02:43,785 : INFO : Recall score for label_class 1: 0.9253
2024-08-12 13:02:43,785 : INFO : Recall score for label_class 2: 0.5920
2024-08-12 13:02:43,785 : INFO : Average F1 score: 0.4708
2024-08-12 13:02:43,785 : INFO : Validation metric decreased (inf --> 0.668999).  Saving model ...
2024-08-12 13:02:43,895 : INFO : Starting epoch 2
2024-08-12 13:02:44,544 : INFO : Current training batch loss: 0.3075 in epoch 2
2024-08-12 13:02:45,353 : INFO : Current training batch loss: 0.4862 in epoch 2
2024-08-12 13:02:46,164 : INFO : Current training batch loss: 0.3354 in epoch 2
2024-08-12 13:02:46,974 : INFO : Current training batch loss: 0.3300 in epoch 2
2024-08-12 13:02:47,321 : INFO : Epoch finished, average loss over training batches: 0.4652
2024-08-12 13:02:47,321 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:47,321 : INFO : Training metrics:
2024-08-12 13:02:47,321 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:47,329 : INFO : Accuracy: 0.8388
2024-08-12 13:02:47,329 : INFO : Precision score for label_class 0: 0.7529
2024-08-12 13:02:47,329 : INFO : Precision score for label_class 1: 0.8799
2024-08-12 13:02:47,329 : INFO : Precision score for label_class 2: 0.7766
2024-08-12 13:02:47,329 : INFO : Recall score for label_class 0: 0.5854
2024-08-12 13:02:47,329 : INFO : Recall score for label_class 1: 0.9273
2024-08-12 13:02:47,329 : INFO : Recall score for label_class 2: 0.7636
2024-08-12 13:02:47,329 : INFO : Average F1 score: 0.7772
2024-08-12 13:02:47,609 : INFO : Average loss over validation batches: 0.4251
2024-08-12 13:02:47,609 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:47,609 : INFO : Validation metrics:
2024-08-12 13:02:47,609 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:47,611 : INFO : Accuracy: 0.8311
2024-08-12 13:02:47,611 : INFO : Precision score for label_class 0: 0.7245
2024-08-12 13:02:47,612 : INFO : Precision score for label_class 1: 0.9253
2024-08-12 13:02:47,612 : INFO : Precision score for label_class 2: 0.7079
2024-08-12 13:02:47,612 : INFO : Recall score for label_class 0: 0.8256
2024-08-12 13:02:47,612 : INFO : Recall score for label_class 1: 0.8361
2024-08-12 13:02:47,612 : INFO : Recall score for label_class 2: 0.8218
2024-08-12 13:02:47,612 : INFO : Average F1 score: 0.8036
2024-08-12 13:02:47,612 : INFO : Validation metric decreased (0.668999 --> 0.425059).  Saving model ...
2024-08-12 13:02:47,713 : INFO : Starting epoch 3
2024-08-12 13:02:48,159 : INFO : Current training batch loss: 0.3156 in epoch 3
2024-08-12 13:02:48,971 : INFO : Current training batch loss: 0.3284 in epoch 3
2024-08-12 13:02:49,781 : INFO : Current training batch loss: 0.3172 in epoch 3
2024-08-12 13:02:50,592 : INFO : Current training batch loss: 0.1245 in epoch 3
2024-08-12 13:02:51,142 : INFO : Epoch finished, average loss over training batches: 0.2773
2024-08-12 13:02:51,142 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:51,142 : INFO : Training metrics:
2024-08-12 13:02:51,142 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:51,150 : INFO : Accuracy: 0.9073
2024-08-12 13:02:51,150 : INFO : Precision score for label_class 0: 0.8156
2024-08-12 13:02:51,150 : INFO : Precision score for label_class 1: 0.9371
2024-08-12 13:02:51,150 : INFO : Precision score for label_class 2: 0.8859
2024-08-12 13:02:51,150 : INFO : Recall score for label_class 0: 0.8628
2024-08-12 13:02:51,150 : INFO : Recall score for label_class 1: 0.9430
2024-08-12 13:02:51,150 : INFO : Recall score for label_class 2: 0.8527
2024-08-12 13:02:51,150 : INFO : Average F1 score: 0.8825
2024-08-12 13:02:51,430 : INFO : Average loss over validation batches: 0.3624
2024-08-12 13:02:51,430 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:51,430 : INFO : Validation metrics:
2024-08-12 13:02:51,430 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:51,433 : INFO : Accuracy: 0.8652
2024-08-12 13:02:51,433 : INFO : Precision score for label_class 0: 0.7931
2024-08-12 13:02:51,433 : INFO : Precision score for label_class 1: 0.9189
2024-08-12 13:02:51,433 : INFO : Precision score for label_class 2: 0.7790
2024-08-12 13:02:51,433 : INFO : Recall score for label_class 0: 0.8023
2024-08-12 13:02:51,433 : INFO : Recall score for label_class 1: 0.9012
2024-08-12 13:02:51,433 : INFO : Recall score for label_class 2: 0.8103
2024-08-12 13:02:51,433 : INFO : Average F1 score: 0.8340
2024-08-12 13:02:51,433 : INFO : Validation metric decreased (0.425059 --> 0.362405).  Saving model ...
2024-08-12 13:02:51,533 : INFO : Starting epoch 4
2024-08-12 13:02:51,778 : INFO : Current training batch loss: 0.5534 in epoch 4
2024-08-12 13:02:52,589 : INFO : Current training batch loss: 0.1214 in epoch 4
2024-08-12 13:02:53,399 : INFO : Current training batch loss: 0.2418 in epoch 4
2024-08-12 13:02:54,210 : INFO : Current training batch loss: 0.1146 in epoch 4
2024-08-12 13:02:54,962 : INFO : Epoch finished, average loss over training batches: 0.1595
2024-08-12 13:02:54,962 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:54,962 : INFO : Training metrics:
2024-08-12 13:02:54,962 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:54,966 : INFO : Accuracy: 0.9526
2024-08-12 13:02:54,967 : INFO : Precision score for label_class 0: 0.8866
2024-08-12 13:02:54,967 : INFO : Precision score for label_class 1: 0.9718
2024-08-12 13:02:54,967 : INFO : Precision score for label_class 2: 0.9422
2024-08-12 13:02:54,967 : INFO : Recall score for label_class 0: 0.9299
2024-08-12 13:02:54,967 : INFO : Recall score for label_class 1: 0.9699
2024-08-12 13:02:54,967 : INFO : Recall score for label_class 2: 0.9264
2024-08-12 13:02:54,967 : INFO : Average F1 score: 0.9376
2024-08-12 13:02:55,246 : INFO : Average loss over validation batches: 0.4053
2024-08-12 13:02:55,246 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:55,246 : INFO : Validation metrics:
2024-08-12 13:02:55,246 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:55,249 : INFO : Accuracy: 0.8489
2024-08-12 13:02:55,249 : INFO : Precision score for label_class 0: 0.7553
2024-08-12 13:02:55,249 : INFO : Precision score for label_class 1: 0.9412
2024-08-12 13:02:55,249 : INFO : Precision score for label_class 2: 0.7246
2024-08-12 13:02:55,249 : INFO : Recall score for label_class 0: 0.8256
2024-08-12 13:02:55,249 : INFO : Recall score for label_class 1: 0.8482
2024-08-12 13:02:55,249 : INFO : Recall score for label_class 2: 0.8621
2024-08-12 13:02:55,249 : INFO : Average F1 score: 0.8229
2024-08-12 13:02:55,249 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 13:02:55,249 : INFO : Starting epoch 5
2024-08-12 13:02:55,291 : INFO : Current training batch loss: 0.0521 in epoch 5
2024-08-12 13:02:56,101 : INFO : Current training batch loss: 0.1025 in epoch 5
2024-08-12 13:02:56,913 : INFO : Current training batch loss: 0.0269 in epoch 5
2024-08-12 13:02:57,724 : INFO : Current training batch loss: 0.1111 in epoch 5
2024-08-12 13:02:58,535 : INFO : Current training batch loss: 0.0568 in epoch 5
2024-08-12 13:02:58,680 : INFO : Epoch finished, average loss over training batches: 0.0971
2024-08-12 13:02:58,680 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:58,680 : INFO : Training metrics:
2024-08-12 13:02:58,680 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:58,688 : INFO : Accuracy: 0.9741
2024-08-12 13:02:58,688 : INFO : Precision score for label_class 0: 0.9135
2024-08-12 13:02:58,688 : INFO : Precision score for label_class 1: 0.9856
2024-08-12 13:02:58,688 : INFO : Precision score for label_class 2: 0.9776
2024-08-12 13:02:58,688 : INFO : Recall score for label_class 0: 0.9665
2024-08-12 13:02:58,688 : INFO : Recall score for label_class 1: 0.9837
2024-08-12 13:02:58,688 : INFO : Recall score for label_class 2: 0.9574
2024-08-12 13:02:58,688 : INFO : Average F1 score: 0.9638
2024-08-12 13:02:58,968 : INFO : Average loss over validation batches: 0.4260
2024-08-12 13:02:58,968 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:58,968 : INFO : Validation metrics:
2024-08-12 13:02:58,968 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:58,972 : INFO : Accuracy: 0.8578
2024-08-12 13:02:58,972 : INFO : Precision score for label_class 0: 0.7080
2024-08-12 13:02:58,972 : INFO : Precision score for label_class 1: 0.9441
2024-08-12 13:02:58,972 : INFO : Precision score for label_class 2: 0.7742
2024-08-12 13:02:58,972 : INFO : Recall score for label_class 0: 0.9302
2024-08-12 13:02:58,972 : INFO : Recall score for label_class 1: 0.8554
2024-08-12 13:02:58,972 : INFO : Recall score for label_class 2: 0.8276
2024-08-12 13:02:58,972 : INFO : Average F1 score: 0.8339
2024-08-12 13:02:58,972 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 13:02:58,972 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:02:59,009 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 13:02:59,322 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:59,322 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 13:02:59,322 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:59,324 : INFO : Accuracy: 0.8652
2024-08-12 13:02:59,324 : INFO : Precision score for label_class 0: 0.7931
2024-08-12 13:02:59,324 : INFO : Precision score for label_class 1: 0.9189
2024-08-12 13:02:59,324 : INFO : Precision score for label_class 2: 0.7790
2024-08-12 13:02:59,324 : INFO : Recall score for label_class 0: 0.8023
2024-08-12 13:02:59,325 : INFO : Recall score for label_class 1: 0.9012
2024-08-12 13:02:59,325 : INFO : Recall score for label_class 2: 0.8103
2024-08-12 13:02:59,325 : INFO : Average F1 score: 0.8340
2024-08-12 13:02:59,325 : INFO : Determined score from best model, ending training.
2024-08-12 13:02:59,326 : INFO : Split 1 is finished, the score is: 0.8340
2024-08-12 13:02:59,326 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:59,326 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:02:59,326 : INFO : Starting training for split 2
2024-08-12 13:02:59,337 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 343, 1601,  754]))
2024-08-12 13:02:59,339 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 71, 410, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:02:59,379 : INFO : Starting epoch 1
2024-08-12 13:02:59,421 : INFO : Current training batch loss: 1.0967 in epoch 1
2024-08-12 13:03:00,232 : INFO : Current training batch loss: 0.9861 in epoch 1
2024-08-12 13:03:01,043 : INFO : Current training batch loss: 0.7656 in epoch 1
2024-08-12 13:03:01,853 : INFO : Current training batch loss: 0.6967 in epoch 1
2024-08-12 13:03:02,663 : INFO : Current training batch loss: 0.6239 in epoch 1
2024-08-12 13:03:02,808 : INFO : Epoch finished, average loss over training batches: 0.7900
2024-08-12 13:03:02,809 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:02,809 : INFO : Training metrics:
2024-08-12 13:03:02,809 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:02,819 : INFO : Accuracy: 0.6735
2024-08-12 13:03:02,820 : INFO : Precision score for label_class 0: 0.3333
2024-08-12 13:03:02,820 : INFO : Precision score for label_class 1: 0.7126
2024-08-12 13:03:02,820 : INFO : Precision score for label_class 2: 0.5777
2024-08-12 13:03:02,820 : INFO : Recall score for label_class 0: 0.0904
2024-08-12 13:03:02,820 : INFO : Recall score for label_class 1: 0.9275
2024-08-12 13:03:02,820 : INFO : Recall score for label_class 2: 0.3992
2024-08-12 13:03:02,820 : INFO : Average F1 score: 0.4734
2024-08-12 13:03:03,100 : INFO : Average loss over validation batches: 0.5354
2024-08-12 13:03:03,100 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:03,100 : INFO : Validation metrics:
2024-08-12 13:03:03,100 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:03,103 : INFO : Accuracy: 0.8252
2024-08-12 13:03:03,103 : INFO : Precision score for label_class 0: 0.8684
2024-08-12 13:03:03,103 : INFO : Precision score for label_class 1: 0.8436
2024-08-12 13:03:03,103 : INFO : Precision score for label_class 2: 0.7705
2024-08-12 13:03:03,103 : INFO : Recall score for label_class 0: 0.4648
2024-08-12 13:03:03,103 : INFO : Recall score for label_class 1: 0.9341
2024-08-12 13:03:03,103 : INFO : Recall score for label_class 2: 0.7268
2024-08-12 13:03:03,103 : INFO : Average F1 score: 0.7467
2024-08-12 13:03:03,103 : INFO : Validation metric decreased (inf --> 0.535365).  Saving model ...
2024-08-12 13:03:03,204 : INFO : Starting epoch 2
2024-08-12 13:03:03,852 : INFO : Current training batch loss: 0.4696 in epoch 2
2024-08-12 13:03:04,662 : INFO : Current training batch loss: 0.5399 in epoch 2
2024-08-12 13:03:05,472 : INFO : Current training batch loss: 0.3614 in epoch 2
2024-08-12 13:03:06,282 : INFO : Current training batch loss: 0.3902 in epoch 2
2024-08-12 13:03:06,630 : INFO : Epoch finished, average loss over training batches: 0.3929
2024-08-12 13:03:06,630 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:06,630 : INFO : Training metrics:
2024-08-12 13:03:06,630 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:06,638 : INFO : Accuracy: 0.8718
2024-08-12 13:03:06,638 : INFO : Precision score for label_class 0: 0.7957
2024-08-12 13:03:06,638 : INFO : Precision score for label_class 1: 0.9075
2024-08-12 13:03:06,638 : INFO : Precision score for label_class 2: 0.8251
2024-08-12 13:03:06,638 : INFO : Recall score for label_class 0: 0.7609
2024-08-12 13:03:06,638 : INFO : Recall score for label_class 1: 0.9319
2024-08-12 13:03:06,638 : INFO : Recall score for label_class 2: 0.7944
2024-08-12 13:03:06,638 : INFO : Average F1 score: 0.8357
2024-08-12 13:03:06,918 : INFO : Average loss over validation batches: 0.3749
2024-08-12 13:03:06,918 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:06,918 : INFO : Validation metrics:
2024-08-12 13:03:06,918 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:06,922 : INFO : Accuracy: 0.8800
2024-08-12 13:03:06,922 : INFO : Precision score for label_class 0: 0.7386
2024-08-12 13:03:06,922 : INFO : Precision score for label_class 1: 0.9165
2024-08-12 13:03:06,922 : INFO : Precision score for label_class 2: 0.8667
2024-08-12 13:03:06,922 : INFO : Recall score for label_class 0: 0.9155
2024-08-12 13:03:06,922 : INFO : Recall score for label_class 1: 0.9098
2024-08-12 13:03:06,922 : INFO : Recall score for label_class 2: 0.8041
2024-08-12 13:03:06,922 : INFO : Average F1 score: 0.8550
2024-08-12 13:03:06,922 : INFO : Validation metric decreased (0.535365 --> 0.374907).  Saving model ...
2024-08-12 13:03:07,024 : INFO : Starting epoch 3
2024-08-12 13:03:07,471 : INFO : Current training batch loss: 0.1761 in epoch 3
2024-08-12 13:03:08,282 : INFO : Current training batch loss: 0.2533 in epoch 3
2024-08-12 13:03:09,092 : INFO : Current training batch loss: 0.3691 in epoch 3
2024-08-12 13:03:09,902 : INFO : Current training batch loss: 0.1476 in epoch 3
2024-08-12 13:03:10,452 : INFO : Epoch finished, average loss over training batches: 0.2327
2024-08-12 13:03:10,452 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:10,452 : INFO : Training metrics:
2024-08-12 13:03:10,452 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:10,463 : INFO : Accuracy: 0.9211
2024-08-12 13:03:10,463 : INFO : Precision score for label_class 0: 0.8371
2024-08-12 13:03:10,463 : INFO : Precision score for label_class 1: 0.9536
2024-08-12 13:03:10,463 : INFO : Precision score for label_class 2: 0.8917
2024-08-12 13:03:10,463 : INFO : Recall score for label_class 0: 0.8688
2024-08-12 13:03:10,463 : INFO : Recall score for label_class 1: 0.9494
2024-08-12 13:03:10,463 : INFO : Recall score for label_class 2: 0.8846
2024-08-12 13:03:10,463 : INFO : Average F1 score: 0.8974
2024-08-12 13:03:10,742 : INFO : Average loss over validation batches: 0.3951
2024-08-12 13:03:10,743 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:10,743 : INFO : Validation metrics:
2024-08-12 13:03:10,743 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:10,746 : INFO : Accuracy: 0.8578
2024-08-12 13:03:10,746 : INFO : Precision score for label_class 0: 0.7692
2024-08-12 13:03:10,746 : INFO : Precision score for label_class 1: 0.9059
2024-08-12 13:03:10,746 : INFO : Precision score for label_class 2: 0.7913
2024-08-12 13:03:10,746 : INFO : Recall score for label_class 0: 0.7042
2024-08-12 13:03:10,746 : INFO : Recall score for label_class 1: 0.8927
2024-08-12 13:03:10,746 : INFO : Recall score for label_class 2: 0.8402
2024-08-12 13:03:10,746 : INFO : Average F1 score: 0.8165
2024-08-12 13:03:10,746 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 13:03:10,746 : INFO : Starting epoch 4
2024-08-12 13:03:10,990 : INFO : Current training batch loss: 0.2614 in epoch 4
2024-08-12 13:03:11,800 : INFO : Current training batch loss: 0.0745 in epoch 4
2024-08-12 13:03:12,611 : INFO : Current training batch loss: 0.2209 in epoch 4
2024-08-12 13:03:13,421 : INFO : Current training batch loss: 0.1289 in epoch 4
2024-08-12 13:03:14,173 : INFO : Epoch finished, average loss over training batches: 0.1255
2024-08-12 13:03:14,174 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:14,174 : INFO : Training metrics:
2024-08-12 13:03:14,174 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:14,181 : INFO : Accuracy: 0.9652
2024-08-12 13:03:14,181 : INFO : Precision score for label_class 0: 0.9222
2024-08-12 13:03:14,181 : INFO : Precision score for label_class 1: 0.9794
2024-08-12 13:03:14,181 : INFO : Precision score for label_class 2: 0.9544
2024-08-12 13:03:14,181 : INFO : Recall score for label_class 0: 0.9329
2024-08-12 13:03:14,181 : INFO : Recall score for label_class 1: 0.9819
2024-08-12 13:03:14,181 : INFO : Recall score for label_class 2: 0.9443
2024-08-12 13:03:14,181 : INFO : Average F1 score: 0.9525
2024-08-12 13:03:14,461 : INFO : Average loss over validation batches: 0.4279
2024-08-12 13:03:14,461 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:14,461 : INFO : Validation metrics:
2024-08-12 13:03:14,461 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:14,465 : INFO : Accuracy: 0.8474
2024-08-12 13:03:14,465 : INFO : Precision score for label_class 0: 0.7703
2024-08-12 13:03:14,465 : INFO : Precision score for label_class 1: 0.9136
2024-08-12 13:03:14,465 : INFO : Precision score for label_class 2: 0.7580
2024-08-12 13:03:14,465 : INFO : Recall score for label_class 0: 0.8028
2024-08-12 13:03:14,465 : INFO : Recall score for label_class 1: 0.8512
2024-08-12 13:03:14,465 : INFO : Recall score for label_class 2: 0.8557
2024-08-12 13:03:14,465 : INFO : Average F1 score: 0.8238
2024-08-12 13:03:14,465 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 13:03:14,465 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:03:14,497 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 13:03:14,807 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:14,807 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 13:03:14,807 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:14,811 : INFO : Accuracy: 0.8800
2024-08-12 13:03:14,811 : INFO : Precision score for label_class 0: 0.7386
2024-08-12 13:03:14,811 : INFO : Precision score for label_class 1: 0.9165
2024-08-12 13:03:14,811 : INFO : Precision score for label_class 2: 0.8667
2024-08-12 13:03:14,811 : INFO : Recall score for label_class 0: 0.9155
2024-08-12 13:03:14,811 : INFO : Recall score for label_class 1: 0.9098
2024-08-12 13:03:14,811 : INFO : Recall score for label_class 2: 0.8041
2024-08-12 13:03:14,811 : INFO : Average F1 score: 0.8550
2024-08-12 13:03:14,811 : INFO : Determined score from best model, ending training.
2024-08-12 13:03:14,812 : INFO : Split 2 is finished, the score is: 0.8550
2024-08-12 13:03:14,812 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:14,812 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:14,812 : INFO : Starting training for split 3
2024-08-12 13:03:14,829 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 328, 1611,  759]))
2024-08-12 13:03:14,831 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 86, 400, 189]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:03:14,881 : INFO : Starting epoch 1
2024-08-12 13:03:14,923 : INFO : Current training batch loss: 1.1041 in epoch 1
2024-08-12 13:03:15,734 : INFO : Current training batch loss: 0.9863 in epoch 1
2024-08-12 13:03:16,545 : INFO : Current training batch loss: 0.7340 in epoch 1
2024-08-12 13:03:17,434 : INFO : Current training batch loss: 0.7768 in epoch 1
2024-08-12 13:03:18,245 : INFO : Current training batch loss: 0.5465 in epoch 1
2024-08-12 13:03:18,390 : INFO : Epoch finished, average loss over training batches: 0.7764
2024-08-12 13:03:18,390 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:18,390 : INFO : Training metrics:
2024-08-12 13:03:18,390 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:18,396 : INFO : Accuracy: 0.6716
2024-08-12 13:03:18,396 : INFO : Precision score for label_class 0: 0.2632
2024-08-12 13:03:18,396 : INFO : Precision score for label_class 1: 0.7225
2024-08-12 13:03:18,396 : INFO : Precision score for label_class 2: 0.6252
2024-08-12 13:03:18,396 : INFO : Recall score for label_class 0: 0.1524
2024-08-12 13:03:18,396 : INFO : Recall score for label_class 1: 0.8939
2024-08-12 13:03:18,396 : INFO : Recall score for label_class 2: 0.4242
2024-08-12 13:03:18,396 : INFO : Average F1 score: 0.4992
2024-08-12 13:03:18,676 : INFO : Average loss over validation batches: 0.4941
2024-08-12 13:03:18,676 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:18,676 : INFO : Validation metrics:
2024-08-12 13:03:18,676 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:18,679 : INFO : Accuracy: 0.8430
2024-08-12 13:03:18,679 : INFO : Precision score for label_class 0: 0.8000
2024-08-12 13:03:18,679 : INFO : Precision score for label_class 1: 0.8835
2024-08-12 13:03:18,679 : INFO : Precision score for label_class 2: 0.7713
2024-08-12 13:03:18,679 : INFO : Recall score for label_class 0: 0.6977
2024-08-12 13:03:18,679 : INFO : Recall score for label_class 1: 0.9100
2024-08-12 13:03:18,679 : INFO : Recall score for label_class 2: 0.7672
2024-08-12 13:03:18,679 : INFO : Average F1 score: 0.8037
2024-08-12 13:03:18,679 : INFO : Validation metric decreased (inf --> 0.494105).  Saving model ...
2024-08-12 13:03:18,789 : INFO : Starting epoch 2
2024-08-12 13:03:19,438 : INFO : Current training batch loss: 0.4530 in epoch 2
2024-08-12 13:03:20,248 : INFO : Current training batch loss: 0.3569 in epoch 2
2024-08-12 13:03:21,058 : INFO : Current training batch loss: 0.2537 in epoch 2
2024-08-12 13:03:21,869 : INFO : Current training batch loss: 0.2604 in epoch 2
2024-08-12 13:03:22,216 : INFO : Epoch finished, average loss over training batches: 0.3865
2024-08-12 13:03:22,217 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:22,217 : INFO : Training metrics:
2024-08-12 13:03:22,217 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:22,220 : INFO : Accuracy: 0.8718
2024-08-12 13:03:22,220 : INFO : Precision score for label_class 0: 0.7939
2024-08-12 13:03:22,220 : INFO : Precision score for label_class 1: 0.9047
2024-08-12 13:03:22,220 : INFO : Precision score for label_class 2: 0.8331
2024-08-12 13:03:22,220 : INFO : Recall score for label_class 0: 0.7988
2024-08-12 13:03:22,221 : INFO : Recall score for label_class 1: 0.9193
2024-08-12 13:03:22,221 : INFO : Recall score for label_class 2: 0.8024
2024-08-12 13:03:22,221 : INFO : Average F1 score: 0.8419
2024-08-12 13:03:22,501 : INFO : Average loss over validation batches: 0.4344
2024-08-12 13:03:22,501 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:22,501 : INFO : Validation metrics:
2024-08-12 13:03:22,501 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:22,504 : INFO : Accuracy: 0.8548
2024-08-12 13:03:22,504 : INFO : Precision score for label_class 0: 0.7849
2024-08-12 13:03:22,504 : INFO : Precision score for label_class 1: 0.8673
2024-08-12 13:03:22,504 : INFO : Precision score for label_class 2: 0.8621
2024-08-12 13:03:22,504 : INFO : Recall score for label_class 0: 0.8488
2024-08-12 13:03:22,504 : INFO : Recall score for label_class 1: 0.9475
2024-08-12 13:03:22,504 : INFO : Recall score for label_class 2: 0.6614
2024-08-12 13:03:22,504 : INFO : Average F1 score: 0.8233
2024-08-12 13:03:22,504 : INFO : Validation metric decreased (0.494105 --> 0.434385).  Saving model ...
2024-08-12 13:03:22,606 : INFO : Starting epoch 3
2024-08-12 13:03:23,052 : INFO : Current training batch loss: 0.2382 in epoch 3
2024-08-12 13:03:23,863 : INFO : Current training batch loss: 0.2810 in epoch 3
2024-08-12 13:03:24,674 : INFO : Current training batch loss: 0.2587 in epoch 3
2024-08-12 13:03:25,485 : INFO : Current training batch loss: 0.1534 in epoch 3
2024-08-12 13:03:26,035 : INFO : Epoch finished, average loss over training batches: 0.2236
2024-08-12 13:03:26,035 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:26,035 : INFO : Training metrics:
2024-08-12 13:03:26,035 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:26,042 : INFO : Accuracy: 0.9244
2024-08-12 13:03:26,042 : INFO : Precision score for label_class 0: 0.8357
2024-08-12 13:03:26,042 : INFO : Precision score for label_class 1: 0.9509
2024-08-12 13:03:26,042 : INFO : Precision score for label_class 2: 0.9091
2024-08-12 13:03:26,042 : INFO : Recall score for label_class 0: 0.8994
2024-08-12 13:03:26,042 : INFO : Recall score for label_class 1: 0.9491
2024-08-12 13:03:26,042 : INFO : Recall score for label_class 2: 0.8827
2024-08-12 13:03:26,042 : INFO : Average F1 score: 0.9040
2024-08-12 13:03:26,322 : INFO : Average loss over validation batches: 0.3924
2024-08-12 13:03:26,322 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:26,322 : INFO : Validation metrics:
2024-08-12 13:03:26,322 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:26,325 : INFO : Accuracy: 0.8563
2024-08-12 13:03:26,325 : INFO : Precision score for label_class 0: 0.8625
2024-08-12 13:03:26,325 : INFO : Precision score for label_class 1: 0.9402
2024-08-12 13:03:26,325 : INFO : Precision score for label_class 2: 0.7181
2024-08-12 13:03:26,325 : INFO : Recall score for label_class 0: 0.8023
2024-08-12 13:03:26,325 : INFO : Recall score for label_class 1: 0.8650
2024-08-12 13:03:26,325 : INFO : Recall score for label_class 2: 0.8624
2024-08-12 13:03:26,325 : INFO : Average F1 score: 0.8387
2024-08-12 13:03:26,325 : INFO : Validation metric decreased (0.434385 --> 0.392366).  Saving model ...
2024-08-12 13:03:26,427 : INFO : Starting epoch 4
2024-08-12 13:03:26,671 : INFO : Current training batch loss: 0.2651 in epoch 4
2024-08-12 13:03:27,481 : INFO : Current training batch loss: 0.1320 in epoch 4
2024-08-12 13:03:28,292 : INFO : Current training batch loss: 0.0869 in epoch 4
2024-08-12 13:03:29,102 : INFO : Current training batch loss: 0.0391 in epoch 4
2024-08-12 13:03:29,855 : INFO : Epoch finished, average loss over training batches: 0.1261
2024-08-12 13:03:29,855 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:29,855 : INFO : Training metrics:
2024-08-12 13:03:29,855 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:29,862 : INFO : Accuracy: 0.9644
2024-08-12 13:03:29,862 : INFO : Precision score for label_class 0: 0.8949
2024-08-12 13:03:29,862 : INFO : Precision score for label_class 1: 0.9795
2024-08-12 13:03:29,862 : INFO : Precision score for label_class 2: 0.9649
2024-08-12 13:03:29,862 : INFO : Recall score for label_class 0: 0.9604
2024-08-12 13:03:29,862 : INFO : Recall score for label_class 1: 0.9764
2024-08-12 13:03:29,862 : INFO : Recall score for label_class 2: 0.9407
2024-08-12 13:03:29,862 : INFO : Average F1 score: 0.9523
2024-08-12 13:03:30,142 : INFO : Average loss over validation batches: 0.4063
2024-08-12 13:03:30,142 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:30,142 : INFO : Validation metrics:
2024-08-12 13:03:30,142 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:30,144 : INFO : Accuracy: 0.8622
2024-08-12 13:03:30,144 : INFO : Precision score for label_class 0: 0.7917
2024-08-12 13:03:30,144 : INFO : Precision score for label_class 1: 0.9501
2024-08-12 13:03:30,144 : INFO : Precision score for label_class 2: 0.7477
2024-08-12 13:03:30,144 : INFO : Recall score for label_class 0: 0.8837
2024-08-12 13:03:30,144 : INFO : Recall score for label_class 1: 0.8575
2024-08-12 13:03:30,144 : INFO : Recall score for label_class 2: 0.8624
2024-08-12 13:03:30,144 : INFO : Average F1 score: 0.8459
2024-08-12 13:03:30,144 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 13:03:30,145 : INFO : Starting epoch 5
2024-08-12 13:03:30,186 : INFO : Current training batch loss: 0.0599 in epoch 5
2024-08-12 13:03:30,996 : INFO : Current training batch loss: 0.2010 in epoch 5
2024-08-12 13:03:31,807 : INFO : Current training batch loss: 0.0238 in epoch 5
2024-08-12 13:03:32,618 : INFO : Current training batch loss: 0.0619 in epoch 5
2024-08-12 13:03:33,430 : INFO : Current training batch loss: 0.0157 in epoch 5
2024-08-12 13:03:33,575 : INFO : Epoch finished, average loss over training batches: 0.0888
2024-08-12 13:03:33,575 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:33,575 : INFO : Training metrics:
2024-08-12 13:03:33,575 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:33,579 : INFO : Accuracy: 0.9759
2024-08-12 13:03:33,579 : INFO : Precision score for label_class 0: 0.9135
2024-08-12 13:03:33,579 : INFO : Precision score for label_class 1: 0.9900
2024-08-12 13:03:33,579 : INFO : Precision score for label_class 2: 0.9746
2024-08-12 13:03:33,579 : INFO : Recall score for label_class 0: 0.9665
2024-08-12 13:03:33,579 : INFO : Recall score for label_class 1: 0.9851
2024-08-12 13:03:33,579 : INFO : Recall score for label_class 2: 0.9605
2024-08-12 13:03:33,579 : INFO : Average F1 score: 0.9648
2024-08-12 13:03:33,859 : INFO : Average loss over validation batches: 0.5003
2024-08-12 13:03:33,859 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:33,859 : INFO : Validation metrics:
2024-08-12 13:03:33,859 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:33,862 : INFO : Accuracy: 0.8726
2024-08-12 13:03:33,862 : INFO : Precision score for label_class 0: 0.8152
2024-08-12 13:03:33,862 : INFO : Precision score for label_class 1: 0.8871
2024-08-12 13:03:33,862 : INFO : Precision score for label_class 2: 0.8671
2024-08-12 13:03:33,862 : INFO : Recall score for label_class 0: 0.8721
2024-08-12 13:03:33,862 : INFO : Recall score for label_class 1: 0.9425
2024-08-12 13:03:33,862 : INFO : Recall score for label_class 2: 0.7249
2024-08-12 13:03:33,862 : INFO : Average F1 score: 0.8488
2024-08-12 13:03:33,862 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 13:03:33,862 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:03:33,899 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 13:03:34,214 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:34,214 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 13:03:34,214 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:34,216 : INFO : Accuracy: 0.8563
2024-08-12 13:03:34,216 : INFO : Precision score for label_class 0: 0.8625
2024-08-12 13:03:34,216 : INFO : Precision score for label_class 1: 0.9402
2024-08-12 13:03:34,217 : INFO : Precision score for label_class 2: 0.7181
2024-08-12 13:03:34,217 : INFO : Recall score for label_class 0: 0.8023
2024-08-12 13:03:34,217 : INFO : Recall score for label_class 1: 0.8650
2024-08-12 13:03:34,217 : INFO : Recall score for label_class 2: 0.8624
2024-08-12 13:03:34,217 : INFO : Average F1 score: 0.8387
2024-08-12 13:03:34,217 : INFO : Determined score from best model, ending training.
2024-08-12 13:03:34,218 : INFO : Split 3 is finished, the score is: 0.8387
2024-08-12 13:03:34,218 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:34,218 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:34,218 : INFO : Starting training for split 4
2024-08-12 13:03:34,235 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 327, 1621,  751]))
2024-08-12 13:03:34,237 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 87, 390, 197]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:03:34,287 : INFO : Starting epoch 1
2024-08-12 13:03:34,329 : INFO : Current training batch loss: 1.0958 in epoch 1
2024-08-12 13:03:35,140 : INFO : Current training batch loss: 0.9855 in epoch 1
2024-08-12 13:03:35,951 : INFO : Current training batch loss: 0.7805 in epoch 1
2024-08-12 13:03:36,762 : INFO : Current training batch loss: 0.6406 in epoch 1
2024-08-12 13:03:37,572 : INFO : Current training batch loss: 0.6883 in epoch 1
2024-08-12 13:03:37,717 : INFO : Epoch finished, average loss over training batches: 0.8112
2024-08-12 13:03:37,718 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:37,718 : INFO : Training metrics:
2024-08-12 13:03:37,718 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:37,725 : INFO : Accuracy: 0.6654
2024-08-12 13:03:37,725 : INFO : Precision score for label_class 0: 1.0000
2024-08-12 13:03:37,725 : INFO : Precision score for label_class 1: 0.7131
2024-08-12 13:03:37,725 : INFO : Precision score for label_class 2: 0.5008
2024-08-12 13:03:37,725 : INFO : Recall score for label_class 0: 0.0061
2024-08-12 13:03:37,725 : INFO : Recall score for label_class 1: 0.9186
2024-08-12 13:03:37,725 : INFO : Recall score for label_class 2: 0.4061
2024-08-12 13:03:37,725 : INFO : Average F1 score: 0.4212
2024-08-12 13:03:38,005 : INFO : Average loss over validation batches: 0.6957
2024-08-12 13:03:38,005 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:38,005 : INFO : Validation metrics:
2024-08-12 13:03:38,005 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:38,009 : INFO : Accuracy: 0.7300
2024-08-12 13:03:38,009 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:03:38,009 : INFO : Precision score for label_class 1: 0.7711
2024-08-12 13:03:38,009 : INFO : Precision score for label_class 2: 0.6243
2024-08-12 13:03:38,009 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:03:38,009 : INFO : Recall score for label_class 1: 0.9590
2024-08-12 13:03:38,009 : INFO : Recall score for label_class 2: 0.5990
2024-08-12 13:03:38,009 : INFO : Average F1 score: 0.4888
2024-08-12 13:03:38,009 : INFO : Validation metric decreased (inf --> 0.695741).  Saving model ...
2024-08-12 13:03:38,119 : INFO : Starting epoch 2
2024-08-12 13:03:38,767 : INFO : Current training batch loss: 0.6481 in epoch 2
2024-08-12 13:03:39,577 : INFO : Current training batch loss: 0.3442 in epoch 2
2024-08-12 13:03:40,388 : INFO : Current training batch loss: 0.2612 in epoch 2
2024-08-12 13:03:41,199 : INFO : Current training batch loss: 0.4548 in epoch 2
2024-08-12 13:03:41,546 : INFO : Epoch finished, average loss over training batches: 0.4664
2024-08-12 13:03:41,546 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:41,547 : INFO : Training metrics:
2024-08-12 13:03:41,547 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:41,552 : INFO : Accuracy: 0.8314
2024-08-12 13:03:41,552 : INFO : Precision score for label_class 0: 0.7683
2024-08-12 13:03:41,552 : INFO : Precision score for label_class 1: 0.8722
2024-08-12 13:03:41,552 : INFO : Precision score for label_class 2: 0.7579
2024-08-12 13:03:41,552 : INFO : Recall score for label_class 0: 0.6086
2024-08-12 13:03:41,552 : INFO : Recall score for label_class 1: 0.9217
2024-08-12 13:03:41,552 : INFO : Recall score for label_class 2: 0.7337
2024-08-12 13:03:41,552 : INFO : Average F1 score: 0.7737
2024-08-12 13:03:41,831 : INFO : Average loss over validation batches: 0.3744
2024-08-12 13:03:41,832 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:41,832 : INFO : Validation metrics:
2024-08-12 13:03:41,832 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:41,835 : INFO : Accuracy: 0.8680
2024-08-12 13:03:41,835 : INFO : Precision score for label_class 0: 0.7018
2024-08-12 13:03:41,835 : INFO : Precision score for label_class 1: 0.9005
2024-08-12 13:03:41,835 : INFO : Precision score for label_class 2: 0.9051
2024-08-12 13:03:41,835 : INFO : Recall score for label_class 0: 0.9195
2024-08-12 13:03:41,835 : INFO : Recall score for label_class 1: 0.9282
2024-08-12 13:03:41,835 : INFO : Recall score for label_class 2: 0.7259
2024-08-12 13:03:41,835 : INFO : Average F1 score: 0.8386
2024-08-12 13:03:41,835 : INFO : Validation metric decreased (0.695741 --> 0.374423).  Saving model ...
2024-08-12 13:03:41,936 : INFO : Starting epoch 3
2024-08-12 13:03:42,383 : INFO : Current training batch loss: 0.2560 in epoch 3
2024-08-12 13:03:43,194 : INFO : Current training batch loss: 0.2766 in epoch 3
2024-08-12 13:03:44,004 : INFO : Current training batch loss: 0.3559 in epoch 3
2024-08-12 13:03:44,814 : INFO : Current training batch loss: 0.1370 in epoch 3
2024-08-12 13:03:45,364 : INFO : Epoch finished, average loss over training batches: 0.2576
2024-08-12 13:03:45,365 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:45,365 : INFO : Training metrics:
2024-08-12 13:03:45,365 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:45,369 : INFO : Accuracy: 0.9140
2024-08-12 13:03:45,369 : INFO : Precision score for label_class 0: 0.8348
2024-08-12 13:03:45,369 : INFO : Precision score for label_class 1: 0.9427
2024-08-12 13:03:45,369 : INFO : Precision score for label_class 2: 0.8877
2024-08-12 13:03:45,369 : INFO : Recall score for label_class 0: 0.8807
2024-08-12 13:03:45,369 : INFO : Recall score for label_class 1: 0.9445
2024-08-12 13:03:45,369 : INFO : Recall score for label_class 2: 0.8628
2024-08-12 13:03:45,369 : INFO : Average F1 score: 0.8919
2024-08-12 13:03:45,650 : INFO : Average loss over validation batches: 0.3998
2024-08-12 13:03:45,651 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:45,651 : INFO : Validation metrics:
2024-08-12 13:03:45,651 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:45,654 : INFO : Accuracy: 0.8472
2024-08-12 13:03:45,654 : INFO : Precision score for label_class 0: 0.8657
2024-08-12 13:03:45,654 : INFO : Precision score for label_class 1: 0.9125
2024-08-12 13:03:45,654 : INFO : Precision score for label_class 2: 0.7348
2024-08-12 13:03:45,654 : INFO : Recall score for label_class 0: 0.6667
2024-08-12 13:03:45,654 : INFO : Recall score for label_class 1: 0.8821
2024-08-12 13:03:45,654 : INFO : Recall score for label_class 2: 0.8579
2024-08-12 13:03:45,654 : INFO : Average F1 score: 0.8139
2024-08-12 13:03:45,654 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 13:03:45,654 : INFO : Starting epoch 4
2024-08-12 13:03:45,898 : INFO : Current training batch loss: 0.2519 in epoch 4
2024-08-12 13:03:46,708 : INFO : Current training batch loss: 0.1441 in epoch 4
2024-08-12 13:03:47,516 : INFO : Current training batch loss: 0.1035 in epoch 4
2024-08-12 13:03:48,324 : INFO : Current training batch loss: 0.1361 in epoch 4
2024-08-12 13:03:49,072 : INFO : Epoch finished, average loss over training batches: 0.1401
2024-08-12 13:03:49,073 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:49,073 : INFO : Training metrics:
2024-08-12 13:03:49,073 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:49,078 : INFO : Accuracy: 0.9596
2024-08-12 13:03:49,078 : INFO : Precision score for label_class 0: 0.9056
2024-08-12 13:03:49,078 : INFO : Precision score for label_class 1: 0.9770
2024-08-12 13:03:49,078 : INFO : Precision score for label_class 2: 0.9465
2024-08-12 13:03:49,078 : INFO : Recall score for label_class 0: 0.9388
2024-08-12 13:03:49,078 : INFO : Recall score for label_class 1: 0.9716
2024-08-12 13:03:49,078 : INFO : Recall score for label_class 2: 0.9427
2024-08-12 13:03:49,078 : INFO : Average F1 score: 0.9470
2024-08-12 13:03:49,358 : INFO : Average loss over validation batches: 0.3734
2024-08-12 13:03:49,358 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:49,358 : INFO : Validation metrics:
2024-08-12 13:03:49,358 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:49,361 : INFO : Accuracy: 0.8694
2024-08-12 13:03:49,361 : INFO : Precision score for label_class 0: 0.7889
2024-08-12 13:03:49,361 : INFO : Precision score for label_class 1: 0.9098
2024-08-12 13:03:49,361 : INFO : Precision score for label_class 2: 0.8265
2024-08-12 13:03:49,361 : INFO : Recall score for label_class 0: 0.8161
2024-08-12 13:03:49,361 : INFO : Recall score for label_class 1: 0.9051
2024-08-12 13:03:49,361 : INFO : Recall score for label_class 2: 0.8223
2024-08-12 13:03:49,361 : INFO : Average F1 score: 0.8447
2024-08-12 13:03:49,361 : INFO : Validation metric decreased (0.374423 --> 0.373409).  Saving model ...
2024-08-12 13:03:49,462 : INFO : Starting epoch 5
2024-08-12 13:03:49,504 : INFO : Current training batch loss: 0.0549 in epoch 5
2024-08-12 13:03:50,313 : INFO : Current training batch loss: 0.1667 in epoch 5
2024-08-12 13:03:51,123 : INFO : Current training batch loss: 0.0295 in epoch 5
2024-08-12 13:03:51,933 : INFO : Current training batch loss: 0.0892 in epoch 5
2024-08-12 13:03:52,743 : INFO : Current training batch loss: 0.0167 in epoch 5
2024-08-12 13:03:52,888 : INFO : Epoch finished, average loss over training batches: 0.0752
2024-08-12 13:03:52,889 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:52,889 : INFO : Training metrics:
2024-08-12 13:03:52,889 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:52,892 : INFO : Accuracy: 0.9796
2024-08-12 13:03:52,892 : INFO : Precision score for label_class 0: 0.9347
2024-08-12 13:03:52,892 : INFO : Precision score for label_class 1: 0.9901
2024-08-12 13:03:52,892 : INFO : Precision score for label_class 2: 0.9772
2024-08-12 13:03:52,892 : INFO : Recall score for label_class 0: 0.9633
2024-08-12 13:03:52,892 : INFO : Recall score for label_class 1: 0.9877
2024-08-12 13:03:52,892 : INFO : Recall score for label_class 2: 0.9694
2024-08-12 13:03:52,892 : INFO : Average F1 score: 0.9703
2024-08-12 13:03:53,172 : INFO : Average loss over validation batches: 0.4443
2024-08-12 13:03:53,172 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:53,172 : INFO : Validation metrics:
2024-08-12 13:03:53,172 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:53,175 : INFO : Accuracy: 0.8635
2024-08-12 13:03:53,175 : INFO : Precision score for label_class 0: 0.7551
2024-08-12 13:03:53,175 : INFO : Precision score for label_class 1: 0.9134
2024-08-12 13:03:53,176 : INFO : Precision score for label_class 2: 0.8205
2024-08-12 13:03:53,176 : INFO : Recall score for label_class 0: 0.8506
2024-08-12 13:03:53,176 : INFO : Recall score for label_class 1: 0.8923
2024-08-12 13:03:53,176 : INFO : Recall score for label_class 2: 0.8122
2024-08-12 13:03:53,176 : INFO : Average F1 score: 0.8397
2024-08-12 13:03:53,176 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 13:03:53,176 : INFO : Starting epoch 6
2024-08-12 13:03:53,823 : INFO : Current training batch loss: 0.1763 in epoch 6
2024-08-12 13:03:54,633 : INFO : Current training batch loss: 0.0145 in epoch 6
2024-08-12 13:03:55,443 : INFO : Current training batch loss: 0.0153 in epoch 6
2024-08-12 13:03:56,254 : INFO : Current training batch loss: 0.0114 in epoch 6
2024-08-12 13:03:56,601 : INFO : Epoch finished, average loss over training batches: 0.0455
2024-08-12 13:03:56,602 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:56,602 : INFO : Training metrics:
2024-08-12 13:03:56,602 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:56,609 : INFO : Accuracy: 0.9893
2024-08-12 13:03:56,609 : INFO : Precision score for label_class 0: 0.9555
2024-08-12 13:03:56,609 : INFO : Precision score for label_class 1: 0.9969
2024-08-12 13:03:56,609 : INFO : Precision score for label_class 2: 0.9880
2024-08-12 13:03:56,609 : INFO : Recall score for label_class 0: 0.9847
2024-08-12 13:03:56,609 : INFO : Recall score for label_class 1: 0.9920
2024-08-12 13:03:56,609 : INFO : Recall score for label_class 2: 0.9854
2024-08-12 13:03:56,609 : INFO : Average F1 score: 0.9837
2024-08-12 13:03:56,889 : INFO : Average loss over validation batches: 0.4909
2024-08-12 13:03:56,889 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:56,889 : INFO : Validation metrics:
2024-08-12 13:03:56,889 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:56,892 : INFO : Accuracy: 0.8635
2024-08-12 13:03:56,892 : INFO : Precision score for label_class 0: 0.7955
2024-08-12 13:03:56,892 : INFO : Precision score for label_class 1: 0.8697
2024-08-12 13:03:56,892 : INFO : Precision score for label_class 2: 0.8841
2024-08-12 13:03:56,892 : INFO : Recall score for label_class 0: 0.8046
2024-08-12 13:03:56,892 : INFO : Recall score for label_class 1: 0.9410
2024-08-12 13:03:56,892 : INFO : Recall score for label_class 2: 0.7360
2024-08-12 13:03:56,892 : INFO : Average F1 score: 0.8358
2024-08-12 13:03:56,892 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 13:03:56,892 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:03:56,929 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 13:03:57,243 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:57,243 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 13:03:57,243 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:57,247 : INFO : Accuracy: 0.8694
2024-08-12 13:03:57,247 : INFO : Precision score for label_class 0: 0.7889
2024-08-12 13:03:57,247 : INFO : Precision score for label_class 1: 0.9098
2024-08-12 13:03:57,247 : INFO : Precision score for label_class 2: 0.8265
2024-08-12 13:03:57,247 : INFO : Recall score for label_class 0: 0.8161
2024-08-12 13:03:57,247 : INFO : Recall score for label_class 1: 0.9051
2024-08-12 13:03:57,247 : INFO : Recall score for label_class 2: 0.8223
2024-08-12 13:03:57,247 : INFO : Average F1 score: 0.8447
2024-08-12 13:03:57,247 : INFO : Determined score from best model, ending training.
2024-08-12 13:03:57,248 : INFO : Split 4 is finished, the score is: 0.8447
2024-08-12 13:03:57,249 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:57,249 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:03:57,249 : INFO : Starting training for split 5
2024-08-12 13:03:57,265 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 330, 1615,  754]))
2024-08-12 13:03:57,268 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 84, 396, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:03:57,318 : INFO : Starting epoch 1
2024-08-12 13:03:57,360 : INFO : Current training batch loss: 1.0858 in epoch 1
2024-08-12 13:03:58,170 : INFO : Current training batch loss: 0.9835 in epoch 1
2024-08-12 13:03:58,980 : INFO : Current training batch loss: 0.7491 in epoch 1
2024-08-12 13:03:59,790 : INFO : Current training batch loss: 0.5768 in epoch 1
2024-08-12 13:04:00,600 : INFO : Current training batch loss: 0.6574 in epoch 1
2024-08-12 13:04:00,745 : INFO : Epoch finished, average loss over training batches: 0.7881
2024-08-12 13:04:00,746 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:00,746 : INFO : Training metrics:
2024-08-12 13:04:00,746 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:00,756 : INFO : Accuracy: 0.6791
2024-08-12 13:04:00,756 : INFO : Precision score for label_class 0: 0.2647
2024-08-12 13:04:00,756 : INFO : Precision score for label_class 1: 0.7179
2024-08-12 13:04:00,756 : INFO : Precision score for label_class 2: 0.5535
2024-08-12 13:04:00,756 : INFO : Recall score for label_class 0: 0.0273
2024-08-12 13:04:00,756 : INFO : Recall score for label_class 1: 0.9437
2024-08-12 13:04:00,756 : INFO : Recall score for label_class 2: 0.3979
2024-08-12 13:04:00,756 : INFO : Average F1 score: 0.4426
2024-08-12 13:04:01,037 : INFO : Average loss over validation batches: 0.5484
2024-08-12 13:04:01,037 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:01,037 : INFO : Validation metrics:
2024-08-12 13:04:01,037 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:01,041 : INFO : Accuracy: 0.7804
2024-08-12 13:04:01,041 : INFO : Precision score for label_class 0: 0.9259
2024-08-12 13:04:01,041 : INFO : Precision score for label_class 1: 0.8133
2024-08-12 13:04:01,041 : INFO : Precision score for label_class 2: 0.6740
2024-08-12 13:04:01,041 : INFO : Recall score for label_class 0: 0.2976
2024-08-12 13:04:01,041 : INFO : Recall score for label_class 1: 0.9571
2024-08-12 13:04:01,041 : INFO : Recall score for label_class 2: 0.6289
2024-08-12 13:04:01,041 : INFO : Average F1 score: 0.6602
2024-08-12 13:04:01,041 : INFO : Validation metric decreased (inf --> 0.548410).  Saving model ...
2024-08-12 13:04:01,151 : INFO : Starting epoch 2
2024-08-12 13:04:01,799 : INFO : Current training batch loss: 0.5021 in epoch 2
2024-08-12 13:04:02,607 : INFO : Current training batch loss: 0.4017 in epoch 2
2024-08-12 13:04:03,415 : INFO : Current training batch loss: 0.2229 in epoch 2
2024-08-12 13:04:04,223 : INFO : Current training batch loss: 0.3968 in epoch 2
2024-08-12 13:04:04,567 : INFO : Epoch finished, average loss over training batches: 0.4089
2024-08-12 13:04:04,568 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:04,568 : INFO : Training metrics:
2024-08-12 13:04:04,568 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:04,575 : INFO : Accuracy: 0.8566
2024-08-12 13:04:04,575 : INFO : Precision score for label_class 0: 0.7560
2024-08-12 13:04:04,575 : INFO : Precision score for label_class 1: 0.8940
2024-08-12 13:04:04,575 : INFO : Precision score for label_class 2: 0.8162
2024-08-12 13:04:04,575 : INFO : Recall score for label_class 0: 0.7697
2024-08-12 13:04:04,575 : INFO : Recall score for label_class 1: 0.9195
2024-08-12 13:04:04,575 : INFO : Recall score for label_class 2: 0.7599
2024-08-12 13:04:04,575 : INFO : Average F1 score: 0.8188
2024-08-12 13:04:04,855 : INFO : Average loss over validation batches: 0.3893
2024-08-12 13:04:04,855 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:04,855 : INFO : Validation metrics:
2024-08-12 13:04:04,855 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:04,859 : INFO : Accuracy: 0.8531
2024-08-12 13:04:04,859 : INFO : Precision score for label_class 0: 0.7683
2024-08-12 13:04:04,859 : INFO : Precision score for label_class 1: 0.8789
2024-08-12 13:04:04,859 : INFO : Precision score for label_class 2: 0.8304
2024-08-12 13:04:04,859 : INFO : Recall score for label_class 0: 0.7500
2024-08-12 13:04:04,859 : INFO : Recall score for label_class 1: 0.9343
2024-08-12 13:04:04,859 : INFO : Recall score for label_class 2: 0.7320
2024-08-12 13:04:04,859 : INFO : Average F1 score: 0.8143
2024-08-12 13:04:04,859 : INFO : Validation metric decreased (0.548410 --> 0.389341).  Saving model ...
2024-08-12 13:04:04,960 : INFO : Starting epoch 3
2024-08-12 13:04:05,407 : INFO : Current training batch loss: 0.1629 in epoch 3
2024-08-12 13:04:06,217 : INFO : Current training batch loss: 0.3473 in epoch 3
2024-08-12 13:04:07,027 : INFO : Current training batch loss: 0.2077 in epoch 3
2024-08-12 13:04:07,836 : INFO : Current training batch loss: 0.1121 in epoch 3
2024-08-12 13:04:08,386 : INFO : Epoch finished, average loss over training batches: 0.2282
2024-08-12 13:04:08,386 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:08,386 : INFO : Training metrics:
2024-08-12 13:04:08,386 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:08,394 : INFO : Accuracy: 0.9252
2024-08-12 13:04:08,394 : INFO : Precision score for label_class 0: 0.8486
2024-08-12 13:04:08,394 : INFO : Precision score for label_class 1: 0.9517
2024-08-12 13:04:08,394 : INFO : Precision score for label_class 2: 0.9031
2024-08-12 13:04:08,394 : INFO : Recall score for label_class 0: 0.9000
2024-08-12 13:04:08,394 : INFO : Recall score for label_class 1: 0.9523
2024-08-12 13:04:08,394 : INFO : Recall score for label_class 2: 0.8780
2024-08-12 13:04:08,394 : INFO : Average F1 score: 0.9053
2024-08-12 13:04:08,674 : INFO : Average loss over validation batches: 0.3936
2024-08-12 13:04:08,674 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:08,674 : INFO : Validation metrics:
2024-08-12 13:04:08,674 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:08,678 : INFO : Accuracy: 0.8412
2024-08-12 13:04:08,678 : INFO : Precision score for label_class 0: 0.7895
2024-08-12 13:04:08,678 : INFO : Precision score for label_class 1: 0.8762
2024-08-12 13:04:08,678 : INFO : Precision score for label_class 2: 0.7849
2024-08-12 13:04:08,678 : INFO : Recall score for label_class 0: 0.7143
2024-08-12 13:04:08,678 : INFO : Recall score for label_class 1: 0.9116
2024-08-12 13:04:08,678 : INFO : Recall score for label_class 2: 0.7526
2024-08-12 13:04:08,678 : INFO : Average F1 score: 0.8040
2024-08-12 13:04:08,678 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 13:04:08,678 : INFO : Starting epoch 4
2024-08-12 13:04:08,922 : INFO : Current training batch loss: 0.2721 in epoch 4
2024-08-12 13:04:09,731 : INFO : Current training batch loss: 0.2182 in epoch 4
2024-08-12 13:04:10,541 : INFO : Current training batch loss: 0.1265 in epoch 4
2024-08-12 13:04:11,351 : INFO : Current training batch loss: 0.1246 in epoch 4
2024-08-12 13:04:12,102 : INFO : Epoch finished, average loss over training batches: 0.1289
2024-08-12 13:04:12,103 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:12,103 : INFO : Training metrics:
2024-08-12 13:04:12,103 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:12,110 : INFO : Accuracy: 0.9622
2024-08-12 13:04:12,110 : INFO : Precision score for label_class 0: 0.9135
2024-08-12 13:04:12,110 : INFO : Precision score for label_class 1: 0.9752
2024-08-12 13:04:12,110 : INFO : Precision score for label_class 2: 0.9566
2024-08-12 13:04:12,110 : INFO : Recall score for label_class 0: 0.9606
2024-08-12 13:04:12,110 : INFO : Recall score for label_class 1: 0.9752
2024-08-12 13:04:12,110 : INFO : Recall score for label_class 2: 0.9350
2024-08-12 13:04:12,110 : INFO : Average F1 score: 0.9525
2024-08-12 13:04:12,390 : INFO : Average loss over validation batches: 0.4470
2024-08-12 13:04:12,390 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:12,390 : INFO : Validation metrics:
2024-08-12 13:04:12,390 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:12,394 : INFO : Accuracy: 0.8427
2024-08-12 13:04:12,394 : INFO : Precision score for label_class 0: 0.8101
2024-08-12 13:04:12,394 : INFO : Precision score for label_class 1: 0.8717
2024-08-12 13:04:12,394 : INFO : Precision score for label_class 2: 0.7912
2024-08-12 13:04:12,394 : INFO : Recall score for label_class 0: 0.7619
2024-08-12 13:04:12,394 : INFO : Recall score for label_class 1: 0.9091
2024-08-12 13:04:12,394 : INFO : Recall score for label_class 2: 0.7423
2024-08-12 13:04:12,394 : INFO : Average F1 score: 0.8137
2024-08-12 13:04:12,394 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 13:04:12,394 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:04:12,431 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 13:04:12,746 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:12,746 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 13:04:12,746 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:12,750 : INFO : Accuracy: 0.8531
2024-08-12 13:04:12,750 : INFO : Precision score for label_class 0: 0.7683
2024-08-12 13:04:12,750 : INFO : Precision score for label_class 1: 0.8789
2024-08-12 13:04:12,750 : INFO : Precision score for label_class 2: 0.8304
2024-08-12 13:04:12,750 : INFO : Recall score for label_class 0: 0.7500
2024-08-12 13:04:12,750 : INFO : Recall score for label_class 1: 0.9343
2024-08-12 13:04:12,750 : INFO : Recall score for label_class 2: 0.7320
2024-08-12 13:04:12,750 : INFO : Average F1 score: 0.8143
2024-08-12 13:04:12,750 : INFO : Determined score from best model, ending training.
2024-08-12 13:04:12,751 : INFO : Split 5 is finished, the score is: 0.8143
2024-08-12 13:04:12,751 : INFO : ----------------------------------------------------------------------------------------------------
[I 2024-08-12 13:04:12,752] Trial 10 finished with value: 0.8373330246494746 and parameters: {'n_epochs': 10, 'learning_rate': 6.362781290648887e-05, 'classifier_dropout': 0.8994407792593633, 'warmup_step_fraction': 0.01620428745232877, 'use_gradient_clipping': False}. Best is trial 6 with value: 0.8419854360165029.
2024-08-12 13:04:12,760 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:12,760 : INFO : Starting training for split 1
2024-08-12 13:04:12,771 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 328, 1596,  774]))
2024-08-12 13:04:12,773 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 86, 415, 174]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:04:12,812 : INFO : Starting epoch 1
2024-08-12 13:04:12,854 : INFO : Current training batch loss: 1.0832 in epoch 1
2024-08-12 13:04:13,664 : INFO : Current training batch loss: 0.9071 in epoch 1
2024-08-12 13:04:14,474 : INFO : Current training batch loss: 0.8701 in epoch 1
2024-08-12 13:04:15,283 : INFO : Current training batch loss: 0.7245 in epoch 1
2024-08-12 13:04:16,092 : INFO : Current training batch loss: 0.8283 in epoch 1
2024-08-12 13:04:16,237 : INFO : Epoch finished, average loss over training batches: 0.8313
2024-08-12 13:04:16,237 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:16,238 : INFO : Training metrics:
2024-08-12 13:04:16,238 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:16,246 : INFO : Accuracy: 0.6427
2024-08-12 13:04:16,246 : INFO : Precision score for label_class 0: 0.4000
2024-08-12 13:04:16,246 : INFO : Precision score for label_class 1: 0.6968
2024-08-12 13:04:16,246 : INFO : Precision score for label_class 2: 0.4786
2024-08-12 13:04:16,246 : INFO : Recall score for label_class 0: 0.0549
2024-08-12 13:04:16,246 : INFO : Recall score for label_class 1: 0.8929
2024-08-12 13:04:16,246 : INFO : Recall score for label_class 2: 0.3760
2024-08-12 13:04:16,246 : INFO : Average F1 score: 0.4335
2024-08-12 13:04:16,525 : INFO : Average loss over validation batches: 0.6328
2024-08-12 13:04:16,525 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:16,526 : INFO : Validation metrics:
2024-08-12 13:04:16,526 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:16,528 : INFO : Accuracy: 0.7230
2024-08-12 13:04:16,528 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:04:16,528 : INFO : Precision score for label_class 1: 0.8852
2024-08-12 13:04:16,528 : INFO : Precision score for label_class 2: 0.4982
2024-08-12 13:04:16,528 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:04:16,528 : INFO : Recall score for label_class 1: 0.8361
2024-08-12 13:04:16,528 : INFO : Recall score for label_class 2: 0.8103
2024-08-12 13:04:16,528 : INFO : Average F1 score: 0.4923
2024-08-12 13:04:16,528 : INFO : Validation metric decreased (inf --> 0.632796).  Saving model ...
2024-08-12 13:04:16,638 : INFO : Starting epoch 2
2024-08-12 13:04:17,286 : INFO : Current training batch loss: 0.2582 in epoch 2
2024-08-12 13:04:18,096 : INFO : Current training batch loss: 0.5586 in epoch 2
2024-08-12 13:04:18,905 : INFO : Current training batch loss: 0.3570 in epoch 2
2024-08-12 13:04:19,714 : INFO : Current training batch loss: 0.3404 in epoch 2
2024-08-12 13:04:20,061 : INFO : Epoch finished, average loss over training batches: 0.4447
2024-08-12 13:04:20,062 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:20,062 : INFO : Training metrics:
2024-08-12 13:04:20,062 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:20,066 : INFO : Accuracy: 0.8529
2024-08-12 13:04:20,066 : INFO : Precision score for label_class 0: 0.7816
2024-08-12 13:04:20,066 : INFO : Precision score for label_class 1: 0.8930
2024-08-12 13:04:20,066 : INFO : Precision score for label_class 2: 0.7904
2024-08-12 13:04:20,066 : INFO : Recall score for label_class 0: 0.6220
2024-08-12 13:04:20,066 : INFO : Recall score for label_class 1: 0.9311
2024-08-12 13:04:20,066 : INFO : Recall score for label_class 2: 0.7894
2024-08-12 13:04:20,066 : INFO : Average F1 score: 0.7981
2024-08-12 13:04:20,346 : INFO : Average loss over validation batches: 0.3796
2024-08-12 13:04:20,346 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:20,346 : INFO : Validation metrics:
2024-08-12 13:04:20,346 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:20,349 : INFO : Accuracy: 0.8607
2024-08-12 13:04:20,349 : INFO : Precision score for label_class 0: 0.8228
2024-08-12 13:04:20,349 : INFO : Precision score for label_class 1: 0.9111
2024-08-12 13:04:20,349 : INFO : Precision score for label_class 2: 0.7611
2024-08-12 13:04:20,349 : INFO : Recall score for label_class 0: 0.7558
2024-08-12 13:04:20,349 : INFO : Recall score for label_class 1: 0.9133
2024-08-12 13:04:20,349 : INFO : Recall score for label_class 2: 0.7874
2024-08-12 13:04:20,349 : INFO : Average F1 score: 0.8247
2024-08-12 13:04:20,349 : INFO : Validation metric decreased (0.632796 --> 0.379608).  Saving model ...
2024-08-12 13:04:20,450 : INFO : Starting epoch 3
2024-08-12 13:04:20,897 : INFO : Current training batch loss: 0.3249 in epoch 3
2024-08-12 13:04:21,709 : INFO : Current training batch loss: 0.2892 in epoch 3
2024-08-12 13:04:22,520 : INFO : Current training batch loss: 0.2810 in epoch 3
2024-08-12 13:04:23,332 : INFO : Current training batch loss: 0.1375 in epoch 3
2024-08-12 13:04:23,882 : INFO : Epoch finished, average loss over training batches: 0.2611
2024-08-12 13:04:23,882 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:23,882 : INFO : Training metrics:
2024-08-12 13:04:23,882 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:23,887 : INFO : Accuracy: 0.9151
2024-08-12 13:04:23,887 : INFO : Precision score for label_class 0: 0.8246
2024-08-12 13:04:23,887 : INFO : Precision score for label_class 1: 0.9453
2024-08-12 13:04:23,887 : INFO : Precision score for label_class 2: 0.8916
2024-08-12 13:04:23,887 : INFO : Recall score for label_class 0: 0.8598
2024-08-12 13:04:23,887 : INFO : Recall score for label_class 1: 0.9530
2024-08-12 13:04:23,887 : INFO : Recall score for label_class 2: 0.8605
2024-08-12 13:04:23,887 : INFO : Average F1 score: 0.8889
2024-08-12 13:04:24,167 : INFO : Average loss over validation batches: 0.3511
2024-08-12 13:04:24,167 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:24,167 : INFO : Validation metrics:
2024-08-12 13:04:24,167 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:24,170 : INFO : Accuracy: 0.8681
2024-08-12 13:04:24,170 : INFO : Precision score for label_class 0: 0.8072
2024-08-12 13:04:24,170 : INFO : Precision score for label_class 1: 0.9135
2024-08-12 13:04:24,170 : INFO : Precision score for label_class 2: 0.7898
2024-08-12 13:04:24,170 : INFO : Recall score for label_class 0: 0.7791
2024-08-12 13:04:24,170 : INFO : Recall score for label_class 1: 0.9157
2024-08-12 13:04:24,170 : INFO : Recall score for label_class 2: 0.7989
2024-08-12 13:04:24,170 : INFO : Average F1 score: 0.8339
2024-08-12 13:04:24,170 : INFO : Validation metric decreased (0.379608 --> 0.351100).  Saving model ...
2024-08-12 13:04:24,272 : INFO : Starting epoch 4
2024-08-12 13:04:24,517 : INFO : Current training batch loss: 0.5377 in epoch 4
2024-08-12 13:04:25,328 : INFO : Current training batch loss: 0.1235 in epoch 4
2024-08-12 13:04:26,140 : INFO : Current training batch loss: 0.2030 in epoch 4
2024-08-12 13:04:26,952 : INFO : Current training batch loss: 0.1100 in epoch 4
2024-08-12 13:04:27,705 : INFO : Epoch finished, average loss over training batches: 0.1491
2024-08-12 13:04:27,705 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:27,705 : INFO : Training metrics:
2024-08-12 13:04:27,705 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:27,713 : INFO : Accuracy: 0.9533
2024-08-12 13:04:27,713 : INFO : Precision score for label_class 0: 0.8853
2024-08-12 13:04:27,713 : INFO : Precision score for label_class 1: 0.9713
2024-08-12 13:04:27,713 : INFO : Precision score for label_class 2: 0.9456
2024-08-12 13:04:27,713 : INFO : Recall score for label_class 0: 0.9177
2024-08-12 13:04:27,713 : INFO : Recall score for label_class 1: 0.9768
2024-08-12 13:04:27,713 : INFO : Recall score for label_class 2: 0.9199
2024-08-12 13:04:27,713 : INFO : Average F1 score: 0.9359
2024-08-12 13:04:27,993 : INFO : Average loss over validation batches: 0.4527
2024-08-12 13:04:27,993 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:27,993 : INFO : Validation metrics:
2024-08-12 13:04:27,993 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:27,996 : INFO : Accuracy: 0.8430
2024-08-12 13:04:27,996 : INFO : Precision score for label_class 0: 0.7364
2024-08-12 13:04:27,996 : INFO : Precision score for label_class 1: 0.9625
2024-08-12 13:04:27,996 : INFO : Precision score for label_class 2: 0.7064
2024-08-12 13:04:27,996 : INFO : Recall score for label_class 0: 0.9419
2024-08-12 13:04:27,996 : INFO : Recall score for label_class 1: 0.8048
2024-08-12 13:04:27,996 : INFO : Recall score for label_class 2: 0.8851
2024-08-12 13:04:27,996 : INFO : Average F1 score: 0.8296
2024-08-12 13:04:27,996 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 13:04:27,996 : INFO : Starting epoch 5
2024-08-12 13:04:28,038 : INFO : Current training batch loss: 0.1933 in epoch 5
2024-08-12 13:04:28,849 : INFO : Current training batch loss: 0.1905 in epoch 5
2024-08-12 13:04:29,661 : INFO : Current training batch loss: 0.0540 in epoch 5
2024-08-12 13:04:30,473 : INFO : Current training batch loss: 0.0770 in epoch 5
2024-08-12 13:04:31,285 : INFO : Current training batch loss: 0.0301 in epoch 5
2024-08-12 13:04:31,431 : INFO : Epoch finished, average loss over training batches: 0.1048
2024-08-12 13:04:31,431 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:31,431 : INFO : Training metrics:
2024-08-12 13:04:31,431 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:31,435 : INFO : Accuracy: 0.9718
2024-08-12 13:04:31,435 : INFO : Precision score for label_class 0: 0.9238
2024-08-12 13:04:31,435 : INFO : Precision score for label_class 1: 0.9831
2024-08-12 13:04:31,435 : INFO : Precision score for label_class 2: 0.9698
2024-08-12 13:04:31,435 : INFO : Recall score for label_class 0: 0.9604
2024-08-12 13:04:31,435 : INFO : Recall score for label_class 1: 0.9825
2024-08-12 13:04:31,435 : INFO : Recall score for label_class 2: 0.9548
2024-08-12 13:04:31,435 : INFO : Average F1 score: 0.9622
2024-08-12 13:04:31,715 : INFO : Average loss over validation batches: 0.3490
2024-08-12 13:04:31,715 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:31,715 : INFO : Validation metrics:
2024-08-12 13:04:31,715 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:31,718 : INFO : Accuracy: 0.8830
2024-08-12 13:04:31,718 : INFO : Precision score for label_class 0: 0.7524
2024-08-12 13:04:31,718 : INFO : Precision score for label_class 1: 0.9531
2024-08-12 13:04:31,718 : INFO : Precision score for label_class 2: 0.8118
2024-08-12 13:04:31,718 : INFO : Recall score for label_class 0: 0.9186
2024-08-12 13:04:31,718 : INFO : Recall score for label_class 1: 0.8819
2024-08-12 13:04:31,718 : INFO : Recall score for label_class 2: 0.8678
2024-08-12 13:04:31,718 : INFO : Average F1 score: 0.8608
2024-08-12 13:04:31,718 : INFO : Validation metric decreased (0.351100 --> 0.349032).  Saving model ...
2024-08-12 13:04:31,818 : INFO : Starting epoch 6
2024-08-12 13:04:32,468 : INFO : Current training batch loss: 0.0125 in epoch 6
2024-08-12 13:04:33,279 : INFO : Current training batch loss: 0.0238 in epoch 6
2024-08-12 13:04:34,091 : INFO : Current training batch loss: 0.0278 in epoch 6
2024-08-12 13:04:34,903 : INFO : Current training batch loss: 0.0171 in epoch 6
2024-08-12 13:04:35,251 : INFO : Epoch finished, average loss over training batches: 0.0691
2024-08-12 13:04:35,252 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:35,252 : INFO : Training metrics:
2024-08-12 13:04:35,252 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:35,260 : INFO : Accuracy: 0.9826
2024-08-12 13:04:35,260 : INFO : Precision score for label_class 0: 0.9413
2024-08-12 13:04:35,260 : INFO : Precision score for label_class 1: 0.9918
2024-08-12 13:04:35,260 : INFO : Precision score for label_class 2: 0.9817
2024-08-12 13:04:35,260 : INFO : Recall score for label_class 0: 0.9787
2024-08-12 13:04:35,260 : INFO : Recall score for label_class 1: 0.9900
2024-08-12 13:04:35,260 : INFO : Recall score for label_class 2: 0.9690
2024-08-12 13:04:35,260 : INFO : Average F1 score: 0.9753
2024-08-12 13:04:35,539 : INFO : Average loss over validation batches: 0.4170
2024-08-12 13:04:35,539 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:35,539 : INFO : Validation metrics:
2024-08-12 13:04:35,539 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:35,542 : INFO : Accuracy: 0.8815
2024-08-12 13:04:35,542 : INFO : Precision score for label_class 0: 0.7800
2024-08-12 13:04:35,542 : INFO : Precision score for label_class 1: 0.9007
2024-08-12 13:04:35,542 : INFO : Precision score for label_class 2: 0.8944
2024-08-12 13:04:35,542 : INFO : Recall score for label_class 0: 0.9070
2024-08-12 13:04:35,542 : INFO : Recall score for label_class 1: 0.9398
2024-08-12 13:04:35,542 : INFO : Recall score for label_class 2: 0.7299
2024-08-12 13:04:35,542 : INFO : Average F1 score: 0.8541
2024-08-12 13:04:35,542 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 13:04:35,542 : INFO : Starting epoch 7
2024-08-12 13:04:35,989 : INFO : Current training batch loss: 0.0169 in epoch 7
2024-08-12 13:04:36,800 : INFO : Current training batch loss: 0.0218 in epoch 7
2024-08-12 13:04:37,612 : INFO : Current training batch loss: 0.0143 in epoch 7
2024-08-12 13:04:38,424 : INFO : Current training batch loss: 0.0099 in epoch 7
2024-08-12 13:04:38,975 : INFO : Epoch finished, average loss over training batches: 0.0451
2024-08-12 13:04:38,975 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:38,975 : INFO : Training metrics:
2024-08-12 13:04:38,975 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:38,979 : INFO : Accuracy: 0.9900
2024-08-12 13:04:38,979 : INFO : Precision score for label_class 0: 0.9702
2024-08-12 13:04:38,979 : INFO : Precision score for label_class 1: 0.9931
2024-08-12 13:04:38,980 : INFO : Precision score for label_class 2: 0.9921
2024-08-12 13:04:38,980 : INFO : Recall score for label_class 0: 0.9939
2024-08-12 13:04:38,980 : INFO : Recall score for label_class 1: 0.9944
2024-08-12 13:04:38,980 : INFO : Recall score for label_class 2: 0.9793
2024-08-12 13:04:38,980 : INFO : Average F1 score: 0.9871
2024-08-12 13:04:39,259 : INFO : Average loss over validation batches: 0.4316
2024-08-12 13:04:39,259 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:39,259 : INFO : Validation metrics:
2024-08-12 13:04:39,259 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:39,262 : INFO : Accuracy: 0.8844
2024-08-12 13:04:39,262 : INFO : Precision score for label_class 0: 0.8105
2024-08-12 13:04:39,262 : INFO : Precision score for label_class 1: 0.8991
2024-08-12 13:04:39,262 : INFO : Precision score for label_class 2: 0.8889
2024-08-12 13:04:39,262 : INFO : Recall score for label_class 0: 0.8953
2024-08-12 13:04:39,262 : INFO : Recall score for label_class 1: 0.9446
2024-08-12 13:04:39,262 : INFO : Recall score for label_class 2: 0.7356
2024-08-12 13:04:39,262 : INFO : Average F1 score: 0.8590
2024-08-12 13:04:39,262 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 13:04:39,262 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:04:39,299 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 13:04:39,619 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:39,619 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 13:04:39,619 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:39,622 : INFO : Accuracy: 0.8830
2024-08-12 13:04:39,622 : INFO : Precision score for label_class 0: 0.7524
2024-08-12 13:04:39,622 : INFO : Precision score for label_class 1: 0.9531
2024-08-12 13:04:39,622 : INFO : Precision score for label_class 2: 0.8118
2024-08-12 13:04:39,622 : INFO : Recall score for label_class 0: 0.9186
2024-08-12 13:04:39,622 : INFO : Recall score for label_class 1: 0.8819
2024-08-12 13:04:39,622 : INFO : Recall score for label_class 2: 0.8678
2024-08-12 13:04:39,622 : INFO : Average F1 score: 0.8608
2024-08-12 13:04:39,622 : INFO : Determined score from best model, ending training.
2024-08-12 13:04:39,623 : INFO : Split 1 is finished, the score is: 0.8608
2024-08-12 13:04:39,624 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:39,624 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:39,624 : INFO : Starting training for split 2
2024-08-12 13:04:39,635 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 343, 1601,  754]))
2024-08-12 13:04:39,637 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 71, 410, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:04:39,676 : INFO : Starting epoch 1
2024-08-12 13:04:39,718 : INFO : Current training batch loss: 1.0947 in epoch 1
2024-08-12 13:04:40,530 : INFO : Current training batch loss: 1.0191 in epoch 1
2024-08-12 13:04:41,342 : INFO : Current training batch loss: 0.8734 in epoch 1
2024-08-12 13:04:42,153 : INFO : Current training batch loss: 0.8401 in epoch 1
2024-08-12 13:04:42,965 : INFO : Current training batch loss: 0.7154 in epoch 1
2024-08-12 13:04:43,110 : INFO : Epoch finished, average loss over training batches: 0.8555
2024-08-12 13:04:43,111 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:43,111 : INFO : Training metrics:
2024-08-12 13:04:43,111 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:43,122 : INFO : Accuracy: 0.6520
2024-08-12 13:04:43,122 : INFO : Precision score for label_class 0: 0.1000
2024-08-12 13:04:43,122 : INFO : Precision score for label_class 1: 0.6871
2024-08-12 13:04:43,122 : INFO : Precision score for label_class 2: 0.5146
2024-08-12 13:04:43,122 : INFO : Recall score for label_class 0: 0.0029
2024-08-12 13:04:43,122 : INFO : Recall score for label_class 1: 0.9325
2024-08-12 13:04:43,122 : INFO : Recall score for label_class 2: 0.3515
2024-08-12 13:04:43,122 : INFO : Average F1 score: 0.4048
2024-08-12 13:04:43,402 : INFO : Average loss over validation batches: 0.6110
2024-08-12 13:04:43,402 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:43,402 : INFO : Validation metrics:
2024-08-12 13:04:43,402 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:43,406 : INFO : Accuracy: 0.7511
2024-08-12 13:04:43,406 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:04:43,406 : INFO : Precision score for label_class 1: 0.8176
2024-08-12 13:04:43,406 : INFO : Precision score for label_class 2: 0.6029
2024-08-12 13:04:43,406 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:04:43,406 : INFO : Recall score for label_class 1: 0.9293
2024-08-12 13:04:43,406 : INFO : Recall score for label_class 2: 0.6495
2024-08-12 13:04:43,406 : INFO : Average F1 score: 0.4984
2024-08-12 13:04:43,406 : INFO : Validation metric decreased (inf --> 0.611003).  Saving model ...
2024-08-12 13:04:43,516 : INFO : Starting epoch 2
2024-08-12 13:04:44,166 : INFO : Current training batch loss: 0.6145 in epoch 2
2024-08-12 13:04:44,977 : INFO : Current training batch loss: 0.6482 in epoch 2
2024-08-12 13:04:45,788 : INFO : Current training batch loss: 0.4208 in epoch 2
2024-08-12 13:04:46,599 : INFO : Current training batch loss: 0.3486 in epoch 2
2024-08-12 13:04:46,947 : INFO : Epoch finished, average loss over training batches: 0.4901
2024-08-12 13:04:46,948 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:46,948 : INFO : Training metrics:
2024-08-12 13:04:46,948 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:46,956 : INFO : Accuracy: 0.8236
2024-08-12 13:04:46,956 : INFO : Precision score for label_class 0: 0.7488
2024-08-12 13:04:46,956 : INFO : Precision score for label_class 1: 0.8843
2024-08-12 13:04:46,956 : INFO : Precision score for label_class 2: 0.7141
2024-08-12 13:04:46,956 : INFO : Recall score for label_class 0: 0.4431
2024-08-12 13:04:46,956 : INFO : Recall score for label_class 1: 0.9357
2024-08-12 13:04:46,956 : INFO : Recall score for label_class 2: 0.7586
2024-08-12 13:04:46,956 : INFO : Average F1 score: 0.7339
2024-08-12 13:04:47,236 : INFO : Average loss over validation batches: 0.3978
2024-08-12 13:04:47,236 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:47,236 : INFO : Validation metrics:
2024-08-12 13:04:47,236 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:47,239 : INFO : Accuracy: 0.8489
2024-08-12 13:04:47,239 : INFO : Precision score for label_class 0: 0.6829
2024-08-12 13:04:47,239 : INFO : Precision score for label_class 1: 0.9070
2024-08-12 13:04:47,239 : INFO : Precision score for label_class 2: 0.8000
2024-08-12 13:04:47,239 : INFO : Recall score for label_class 0: 0.7887
2024-08-12 13:04:47,239 : INFO : Recall score for label_class 1: 0.8805
2024-08-12 13:04:47,239 : INFO : Recall score for label_class 2: 0.8041
2024-08-12 13:04:47,239 : INFO : Average F1 score: 0.8092
2024-08-12 13:04:47,239 : INFO : Validation metric decreased (0.611003 --> 0.397784).  Saving model ...
2024-08-12 13:04:47,340 : INFO : Starting epoch 3
2024-08-12 13:04:47,787 : INFO : Current training batch loss: 0.3085 in epoch 3
2024-08-12 13:04:48,597 : INFO : Current training batch loss: 0.2827 in epoch 3
2024-08-12 13:04:49,407 : INFO : Current training batch loss: 0.3134 in epoch 3
2024-08-12 13:04:50,217 : INFO : Current training batch loss: 0.0965 in epoch 3
2024-08-12 13:04:50,767 : INFO : Epoch finished, average loss over training batches: 0.2897
2024-08-12 13:04:50,767 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:50,767 : INFO : Training metrics:
2024-08-12 13:04:50,767 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:50,774 : INFO : Accuracy: 0.9051
2024-08-12 13:04:50,774 : INFO : Precision score for label_class 0: 0.8125
2024-08-12 13:04:50,775 : INFO : Precision score for label_class 1: 0.9415
2024-08-12 13:04:50,775 : INFO : Precision score for label_class 2: 0.8699
2024-08-12 13:04:50,775 : INFO : Recall score for label_class 0: 0.8338
2024-08-12 13:04:50,775 : INFO : Recall score for label_class 1: 0.9457
2024-08-12 13:04:50,775 : INFO : Recall score for label_class 2: 0.8515
2024-08-12 13:04:50,775 : INFO : Average F1 score: 0.8757
2024-08-12 13:04:51,055 : INFO : Average loss over validation batches: 0.3594
2024-08-12 13:04:51,055 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:51,055 : INFO : Validation metrics:
2024-08-12 13:04:51,055 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:51,059 : INFO : Accuracy: 0.8785
2024-08-12 13:04:51,059 : INFO : Precision score for label_class 0: 0.7763
2024-08-12 13:04:51,059 : INFO : Precision score for label_class 1: 0.8995
2024-08-12 13:04:51,059 : INFO : Precision score for label_class 2: 0.8729
2024-08-12 13:04:51,059 : INFO : Recall score for label_class 0: 0.8310
2024-08-12 13:04:51,059 : INFO : Recall score for label_class 1: 0.9171
2024-08-12 13:04:51,059 : INFO : Recall score for label_class 2: 0.8144
2024-08-12 13:04:51,059 : INFO : Average F1 score: 0.8512
2024-08-12 13:04:51,059 : INFO : Validation metric decreased (0.397784 --> 0.359448).  Saving model ...
2024-08-12 13:04:51,161 : INFO : Starting epoch 4
2024-08-12 13:04:51,405 : INFO : Current training batch loss: 0.3145 in epoch 4
2024-08-12 13:04:52,215 : INFO : Current training batch loss: 0.1665 in epoch 4
2024-08-12 13:04:53,025 : INFO : Current training batch loss: 0.1328 in epoch 4
2024-08-12 13:04:53,835 : INFO : Current training batch loss: 0.1558 in epoch 4
2024-08-12 13:04:54,587 : INFO : Epoch finished, average loss over training batches: 0.1659
2024-08-12 13:04:54,588 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:54,588 : INFO : Training metrics:
2024-08-12 13:04:54,588 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:54,595 : INFO : Accuracy: 0.9540
2024-08-12 13:04:54,595 : INFO : Precision score for label_class 0: 0.8827
2024-08-12 13:04:54,595 : INFO : Precision score for label_class 1: 0.9738
2024-08-12 13:04:54,595 : INFO : Precision score for label_class 2: 0.9459
2024-08-12 13:04:54,595 : INFO : Recall score for label_class 0: 0.9213
2024-08-12 13:04:54,595 : INFO : Recall score for label_class 1: 0.9738
2024-08-12 13:04:54,595 : INFO : Recall score for label_class 2: 0.9271
2024-08-12 13:04:54,595 : INFO : Average F1 score: 0.9372
2024-08-12 13:04:54,875 : INFO : Average loss over validation batches: 0.4201
2024-08-12 13:04:54,875 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:54,875 : INFO : Validation metrics:
2024-08-12 13:04:54,875 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:54,879 : INFO : Accuracy: 0.8548
2024-08-12 13:04:54,879 : INFO : Precision score for label_class 0: 0.7595
2024-08-12 13:04:54,879 : INFO : Precision score for label_class 1: 0.9002
2024-08-12 13:04:54,879 : INFO : Precision score for label_class 2: 0.8000
2024-08-12 13:04:54,879 : INFO : Recall score for label_class 0: 0.8451
2024-08-12 13:04:54,879 : INFO : Recall score for label_class 1: 0.8805
2024-08-12 13:04:54,879 : INFO : Recall score for label_class 2: 0.8041
2024-08-12 13:04:54,879 : INFO : Average F1 score: 0.8308
2024-08-12 13:04:54,879 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 13:04:54,879 : INFO : Starting epoch 5
2024-08-12 13:04:54,921 : INFO : Current training batch loss: 0.1388 in epoch 5
2024-08-12 13:04:55,731 : INFO : Current training batch loss: 0.2433 in epoch 5
2024-08-12 13:04:56,542 : INFO : Current training batch loss: 0.0500 in epoch 5
2024-08-12 13:04:57,352 : INFO : Current training batch loss: 0.1533 in epoch 5
2024-08-12 13:04:58,163 : INFO : Current training batch loss: 0.3851 in epoch 5
2024-08-12 13:04:58,308 : INFO : Epoch finished, average loss over training batches: 0.1152
2024-08-12 13:04:58,308 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:58,309 : INFO : Training metrics:
2024-08-12 13:04:58,309 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:58,319 : INFO : Accuracy: 0.9689
2024-08-12 13:04:58,319 : INFO : Precision score for label_class 0: 0.9048
2024-08-12 13:04:58,319 : INFO : Precision score for label_class 1: 0.9837
2024-08-12 13:04:58,319 : INFO : Precision score for label_class 2: 0.9677
2024-08-12 13:04:58,319 : INFO : Recall score for label_class 0: 0.9417
2024-08-12 13:04:58,319 : INFO : Recall score for label_class 1: 0.9819
2024-08-12 13:04:58,319 : INFO : Recall score for label_class 2: 0.9536
2024-08-12 13:04:58,319 : INFO : Average F1 score: 0.9554
2024-08-12 13:04:58,599 : INFO : Average loss over validation batches: 0.4320
2024-08-12 13:04:58,599 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:58,599 : INFO : Validation metrics:
2024-08-12 13:04:58,599 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:58,602 : INFO : Accuracy: 0.8593
2024-08-12 13:04:58,602 : INFO : Precision score for label_class 0: 0.7500
2024-08-12 13:04:58,602 : INFO : Precision score for label_class 1: 0.8916
2024-08-12 13:04:58,602 : INFO : Precision score for label_class 2: 0.8352
2024-08-12 13:04:58,603 : INFO : Recall score for label_class 0: 0.8873
2024-08-12 13:04:58,603 : INFO : Recall score for label_class 1: 0.9024
2024-08-12 13:04:58,603 : INFO : Recall score for label_class 2: 0.7577
2024-08-12 13:04:58,603 : INFO : Average F1 score: 0.8348
2024-08-12 13:04:58,603 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 13:04:58,603 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:04:58,640 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 13:04:58,953 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:58,953 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 13:04:58,954 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:58,957 : INFO : Accuracy: 0.8785
2024-08-12 13:04:58,957 : INFO : Precision score for label_class 0: 0.7763
2024-08-12 13:04:58,957 : INFO : Precision score for label_class 1: 0.8995
2024-08-12 13:04:58,957 : INFO : Precision score for label_class 2: 0.8729
2024-08-12 13:04:58,957 : INFO : Recall score for label_class 0: 0.8310
2024-08-12 13:04:58,958 : INFO : Recall score for label_class 1: 0.9171
2024-08-12 13:04:58,958 : INFO : Recall score for label_class 2: 0.8144
2024-08-12 13:04:58,958 : INFO : Average F1 score: 0.8512
2024-08-12 13:04:58,958 : INFO : Determined score from best model, ending training.
2024-08-12 13:04:58,959 : INFO : Split 2 is finished, the score is: 0.8512
2024-08-12 13:04:58,959 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:58,959 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:04:58,959 : INFO : Starting training for split 3
2024-08-12 13:04:58,970 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 328, 1611,  759]))
2024-08-12 13:04:58,972 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 86, 400, 189]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:04:59,011 : INFO : Starting epoch 1
2024-08-12 13:04:59,053 : INFO : Current training batch loss: 1.0792 in epoch 1
2024-08-12 13:04:59,863 : INFO : Current training batch loss: 1.0172 in epoch 1
2024-08-12 13:05:00,673 : INFO : Current training batch loss: 0.7876 in epoch 1
2024-08-12 13:05:01,483 : INFO : Current training batch loss: 0.6838 in epoch 1
2024-08-12 13:05:02,294 : INFO : Current training batch loss: 0.6849 in epoch 1
2024-08-12 13:05:02,439 : INFO : Epoch finished, average loss over training batches: 0.8329
2024-08-12 13:05:02,439 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:02,439 : INFO : Training metrics:
2024-08-12 13:05:02,439 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:02,446 : INFO : Accuracy: 0.6642
2024-08-12 13:05:02,446 : INFO : Precision score for label_class 0: 0.3810
2024-08-12 13:05:02,446 : INFO : Precision score for label_class 1: 0.6895
2024-08-12 13:05:02,446 : INFO : Precision score for label_class 2: 0.5547
2024-08-12 13:05:02,447 : INFO : Recall score for label_class 0: 0.0488
2024-08-12 13:05:02,447 : INFO : Recall score for label_class 1: 0.9609
2024-08-12 13:05:02,447 : INFO : Recall score for label_class 2: 0.3004
2024-08-12 13:05:02,447 : INFO : Average F1 score: 0.4264
2024-08-12 13:05:02,727 : INFO : Average loss over validation batches: 0.5990
2024-08-12 13:05:02,727 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:02,727 : INFO : Validation metrics:
2024-08-12 13:05:02,727 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:02,729 : INFO : Accuracy: 0.7422
2024-08-12 13:05:02,729 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:05:02,729 : INFO : Precision score for label_class 1: 0.8304
2024-08-12 13:05:02,729 : INFO : Precision score for label_class 2: 0.5683
2024-08-12 13:05:02,729 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:05:02,729 : INFO : Recall score for label_class 1: 0.9300
2024-08-12 13:05:02,729 : INFO : Recall score for label_class 2: 0.6825
2024-08-12 13:05:02,729 : INFO : Average F1 score: 0.4992
2024-08-12 13:05:02,729 : INFO : Validation metric decreased (inf --> 0.598961).  Saving model ...
2024-08-12 13:05:02,830 : INFO : Starting epoch 2
2024-08-12 13:05:03,478 : INFO : Current training batch loss: 0.6263 in epoch 2
2024-08-12 13:05:04,288 : INFO : Current training batch loss: 0.4404 in epoch 2
2024-08-12 13:05:05,097 : INFO : Current training batch loss: 0.3943 in epoch 2
2024-08-12 13:05:05,907 : INFO : Current training batch loss: 0.4135 in epoch 2
2024-08-12 13:05:06,254 : INFO : Epoch finished, average loss over training batches: 0.4709
2024-08-12 13:05:06,254 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:06,254 : INFO : Training metrics:
2024-08-12 13:05:06,254 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:06,258 : INFO : Accuracy: 0.8306
2024-08-12 13:05:06,258 : INFO : Precision score for label_class 0: 0.7597
2024-08-12 13:05:06,258 : INFO : Precision score for label_class 1: 0.8788
2024-08-12 13:05:06,258 : INFO : Precision score for label_class 2: 0.7451
2024-08-12 13:05:06,258 : INFO : Recall score for label_class 0: 0.5396
2024-08-12 13:05:06,258 : INFO : Recall score for label_class 1: 0.9274
2024-08-12 13:05:06,258 : INFO : Recall score for label_class 2: 0.7510
2024-08-12 13:05:06,258 : INFO : Average F1 score: 0.7605
2024-08-12 13:05:06,538 : INFO : Average loss over validation batches: 0.3853
2024-08-12 13:05:06,538 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:06,538 : INFO : Validation metrics:
2024-08-12 13:05:06,538 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:06,541 : INFO : Accuracy: 0.8593
2024-08-12 13:05:06,541 : INFO : Precision score for label_class 0: 0.7802
2024-08-12 13:05:06,541 : INFO : Precision score for label_class 1: 0.8892
2024-08-12 13:05:06,541 : INFO : Precision score for label_class 2: 0.8284
2024-08-12 13:05:06,541 : INFO : Recall score for label_class 0: 0.8256
2024-08-12 13:05:06,541 : INFO : Recall score for label_class 1: 0.9225
2024-08-12 13:05:06,541 : INFO : Recall score for label_class 2: 0.7407
2024-08-12 13:05:06,541 : INFO : Average F1 score: 0.8300
2024-08-12 13:05:06,541 : INFO : Validation metric decreased (0.598961 --> 0.385306).  Saving model ...
2024-08-12 13:05:06,643 : INFO : Starting epoch 3
2024-08-12 13:05:07,090 : INFO : Current training batch loss: 0.2169 in epoch 3
2024-08-12 13:05:07,900 : INFO : Current training batch loss: 0.2563 in epoch 3
2024-08-12 13:05:08,711 : INFO : Current training batch loss: 0.2026 in epoch 3
2024-08-12 13:05:09,522 : INFO : Current training batch loss: 0.1427 in epoch 3
2024-08-12 13:05:10,072 : INFO : Epoch finished, average loss over training batches: 0.2431
2024-08-12 13:05:10,072 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:10,072 : INFO : Training metrics:
2024-08-12 13:05:10,073 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:10,079 : INFO : Accuracy: 0.9251
2024-08-12 13:05:10,079 : INFO : Precision score for label_class 0: 0.8348
2024-08-12 13:05:10,079 : INFO : Precision score for label_class 1: 0.9472
2024-08-12 13:05:10,080 : INFO : Precision score for label_class 2: 0.9179
2024-08-12 13:05:10,080 : INFO : Recall score for label_class 0: 0.8628
2024-08-12 13:05:10,080 : INFO : Recall score for label_class 1: 0.9572
2024-08-12 13:05:10,080 : INFO : Recall score for label_class 2: 0.8841
2024-08-12 13:05:10,080 : INFO : Average F1 score: 0.9005
2024-08-12 13:05:10,360 : INFO : Average loss over validation batches: 0.4297
2024-08-12 13:05:10,360 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:10,360 : INFO : Validation metrics:
2024-08-12 13:05:10,360 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:10,363 : INFO : Accuracy: 0.8593
2024-08-12 13:05:10,363 : INFO : Precision score for label_class 0: 0.8140
2024-08-12 13:05:10,363 : INFO : Precision score for label_class 1: 0.9037
2024-08-12 13:05:10,363 : INFO : Precision score for label_class 2: 0.7826
2024-08-12 13:05:10,363 : INFO : Recall score for label_class 0: 0.8140
2024-08-12 13:05:10,363 : INFO : Recall score for label_class 1: 0.9150
2024-08-12 13:05:10,363 : INFO : Recall score for label_class 2: 0.7619
2024-08-12 13:05:10,363 : INFO : Average F1 score: 0.8318
2024-08-12 13:05:10,364 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 13:05:10,364 : INFO : Starting epoch 4
2024-08-12 13:05:10,607 : INFO : Current training batch loss: 0.3397 in epoch 4
2024-08-12 13:05:11,418 : INFO : Current training batch loss: 0.2453 in epoch 4
2024-08-12 13:05:12,229 : INFO : Current training batch loss: 0.1698 in epoch 4
2024-08-12 13:05:13,040 : INFO : Current training batch loss: 0.0986 in epoch 4
2024-08-12 13:05:13,792 : INFO : Epoch finished, average loss over training batches: 0.1533
2024-08-12 13:05:13,792 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:13,792 : INFO : Training metrics:
2024-08-12 13:05:13,792 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:13,799 : INFO : Accuracy: 0.9570
2024-08-12 13:05:13,799 : INFO : Precision score for label_class 0: 0.8746
2024-08-12 13:05:13,799 : INFO : Precision score for label_class 1: 0.9734
2024-08-12 13:05:13,799 : INFO : Precision score for label_class 2: 0.9604
2024-08-12 13:05:13,799 : INFO : Recall score for label_class 0: 0.9360
2024-08-12 13:05:13,799 : INFO : Recall score for label_class 1: 0.9752
2024-08-12 13:05:13,799 : INFO : Recall score for label_class 2: 0.9275
2024-08-12 13:05:13,799 : INFO : Average F1 score: 0.9407
2024-08-12 13:05:14,080 : INFO : Average loss over validation batches: 0.4621
2024-08-12 13:05:14,080 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:14,080 : INFO : Validation metrics:
2024-08-12 13:05:14,080 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:14,083 : INFO : Accuracy: 0.8430
2024-08-12 13:05:14,083 : INFO : Precision score for label_class 0: 0.7018
2024-08-12 13:05:14,083 : INFO : Precision score for label_class 1: 0.9412
2024-08-12 13:05:14,083 : INFO : Precision score for label_class 2: 0.7500
2024-08-12 13:05:14,083 : INFO : Recall score for label_class 0: 0.9302
2024-08-12 13:05:14,083 : INFO : Recall score for label_class 1: 0.8400
2024-08-12 13:05:14,083 : INFO : Recall score for label_class 2: 0.8095
2024-08-12 13:05:14,083 : INFO : Average F1 score: 0.8221
2024-08-12 13:05:14,083 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 13:05:14,083 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:05:14,114 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 13:05:14,424 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:14,424 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 13:05:14,424 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:14,426 : INFO : Accuracy: 0.8593
2024-08-12 13:05:14,426 : INFO : Precision score for label_class 0: 0.7802
2024-08-12 13:05:14,426 : INFO : Precision score for label_class 1: 0.8892
2024-08-12 13:05:14,426 : INFO : Precision score for label_class 2: 0.8284
2024-08-12 13:05:14,426 : INFO : Recall score for label_class 0: 0.8256
2024-08-12 13:05:14,426 : INFO : Recall score for label_class 1: 0.9225
2024-08-12 13:05:14,427 : INFO : Recall score for label_class 2: 0.7407
2024-08-12 13:05:14,427 : INFO : Average F1 score: 0.8300
2024-08-12 13:05:14,427 : INFO : Determined score from best model, ending training.
2024-08-12 13:05:14,428 : INFO : Split 3 is finished, the score is: 0.8300
2024-08-12 13:05:14,428 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:14,428 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:14,428 : INFO : Starting training for split 4
2024-08-12 13:05:14,439 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 327, 1621,  751]))
2024-08-12 13:05:14,441 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 87, 390, 197]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:05:14,481 : INFO : Starting epoch 1
2024-08-12 13:05:14,523 : INFO : Current training batch loss: 1.0991 in epoch 1
2024-08-12 13:05:15,333 : INFO : Current training batch loss: 1.0148 in epoch 1
2024-08-12 13:05:16,144 : INFO : Current training batch loss: 0.7916 in epoch 1
2024-08-12 13:05:16,956 : INFO : Current training batch loss: 0.6402 in epoch 1
2024-08-12 13:05:17,766 : INFO : Current training batch loss: 0.7505 in epoch 1
2024-08-12 13:05:17,912 : INFO : Epoch finished, average loss over training batches: 0.8370
2024-08-12 13:05:17,912 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:17,912 : INFO : Training metrics:
2024-08-12 13:05:17,912 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:17,919 : INFO : Accuracy: 0.6506
2024-08-12 13:05:17,919 : INFO : Precision score for label_class 0: 0.1864
2024-08-12 13:05:17,919 : INFO : Precision score for label_class 1: 0.6928
2024-08-12 13:05:17,919 : INFO : Precision score for label_class 2: 0.5232
2024-08-12 13:05:17,919 : INFO : Recall score for label_class 0: 0.0336
2024-08-12 13:05:17,919 : INFO : Recall score for label_class 1: 0.9167
2024-08-12 13:05:17,919 : INFO : Recall score for label_class 2: 0.3449
2024-08-12 13:05:17,919 : INFO : Average F1 score: 0.4206
2024-08-12 13:05:18,200 : INFO : Average loss over validation batches: 0.6487
2024-08-12 13:05:18,200 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:18,200 : INFO : Validation metrics:
2024-08-12 13:05:18,200 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:18,203 : INFO : Accuracy: 0.7344
2024-08-12 13:05:18,204 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:05:18,204 : INFO : Precision score for label_class 1: 0.8994
2024-08-12 13:05:18,204 : INFO : Precision score for label_class 2: 0.5475
2024-08-12 13:05:18,204 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:05:18,204 : INFO : Recall score for label_class 1: 0.8256
2024-08-12 13:05:18,204 : INFO : Recall score for label_class 2: 0.8782
2024-08-12 13:05:18,204 : INFO : Average F1 score: 0.5118
2024-08-12 13:05:18,204 : INFO : Validation metric decreased (inf --> 0.648681).  Saving model ...
2024-08-12 13:05:18,314 : INFO : Starting epoch 2
2024-08-12 13:05:18,962 : INFO : Current training batch loss: 0.6166 in epoch 2
2024-08-12 13:05:19,773 : INFO : Current training batch loss: 0.4490 in epoch 2
2024-08-12 13:05:20,583 : INFO : Current training batch loss: 0.2882 in epoch 2
2024-08-12 13:05:21,394 : INFO : Current training batch loss: 0.3655 in epoch 2
2024-08-12 13:05:21,742 : INFO : Epoch finished, average loss over training batches: 0.4399
2024-08-12 13:05:21,742 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:21,742 : INFO : Training metrics:
2024-08-12 13:05:21,742 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:21,749 : INFO : Accuracy: 0.8503
2024-08-12 13:05:21,749 : INFO : Precision score for label_class 0: 0.7722
2024-08-12 13:05:21,750 : INFO : Precision score for label_class 1: 0.8903
2024-08-12 13:05:21,750 : INFO : Precision score for label_class 2: 0.7883
2024-08-12 13:05:21,750 : INFO : Recall score for label_class 0: 0.6636
2024-08-12 13:05:21,750 : INFO : Recall score for label_class 1: 0.9260
2024-08-12 13:05:21,750 : INFO : Recall score for label_class 2: 0.7683
2024-08-12 13:05:21,750 : INFO : Average F1 score: 0.7999
2024-08-12 13:05:22,030 : INFO : Average loss over validation batches: 0.3884
2024-08-12 13:05:22,030 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:22,030 : INFO : Validation metrics:
2024-08-12 13:05:22,030 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:22,034 : INFO : Accuracy: 0.8457
2024-08-12 13:05:22,034 : INFO : Precision score for label_class 0: 0.7158
2024-08-12 13:05:22,034 : INFO : Precision score for label_class 1: 0.8747
2024-08-12 13:05:22,034 : INFO : Precision score for label_class 2: 0.8476
2024-08-12 13:05:22,034 : INFO : Recall score for label_class 0: 0.7816
2024-08-12 13:05:22,034 : INFO : Recall score for label_class 1: 0.9308
2024-08-12 13:05:22,034 : INFO : Recall score for label_class 2: 0.7056
2024-08-12 13:05:22,034 : INFO : Average F1 score: 0.8064
2024-08-12 13:05:22,034 : INFO : Validation metric decreased (0.648681 --> 0.388413).  Saving model ...
2024-08-12 13:05:22,136 : INFO : Starting epoch 3
2024-08-12 13:05:22,582 : INFO : Current training batch loss: 0.2283 in epoch 3
2024-08-12 13:05:23,393 : INFO : Current training batch loss: 0.2760 in epoch 3
2024-08-12 13:05:24,204 : INFO : Current training batch loss: 0.2208 in epoch 3
2024-08-12 13:05:25,015 : INFO : Current training batch loss: 0.0510 in epoch 3
2024-08-12 13:05:25,564 : INFO : Epoch finished, average loss over training batches: 0.2372
2024-08-12 13:05:25,565 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:25,565 : INFO : Training metrics:
2024-08-12 13:05:25,565 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:25,572 : INFO : Accuracy: 0.9270
2024-08-12 13:05:25,572 : INFO : Precision score for label_class 0: 0.8466
2024-08-12 13:05:25,572 : INFO : Precision score for label_class 1: 0.9538
2024-08-12 13:05:25,572 : INFO : Precision score for label_class 2: 0.9048
2024-08-12 13:05:25,572 : INFO : Recall score for label_class 0: 0.8777
2024-08-12 13:05:25,572 : INFO : Recall score for label_class 1: 0.9562
2024-08-12 13:05:25,572 : INFO : Recall score for label_class 2: 0.8855
2024-08-12 13:05:25,572 : INFO : Average F1 score: 0.9040
2024-08-12 13:05:25,852 : INFO : Average loss over validation batches: 0.3809
2024-08-12 13:05:25,852 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:25,852 : INFO : Validation metrics:
2024-08-12 13:05:25,852 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:25,856 : INFO : Accuracy: 0.8561
2024-08-12 13:05:25,856 : INFO : Precision score for label_class 0: 0.8310
2024-08-12 13:05:25,856 : INFO : Precision score for label_class 1: 0.8894
2024-08-12 13:05:25,856 : INFO : Precision score for label_class 2: 0.7959
2024-08-12 13:05:25,856 : INFO : Recall score for label_class 0: 0.6782
2024-08-12 13:05:25,856 : INFO : Recall score for label_class 1: 0.9282
2024-08-12 13:05:25,856 : INFO : Recall score for label_class 2: 0.7919
2024-08-12 13:05:25,856 : INFO : Average F1 score: 0.8164
2024-08-12 13:05:25,856 : INFO : Validation metric decreased (0.388413 --> 0.380885).  Saving model ...
2024-08-12 13:05:25,956 : INFO : Starting epoch 4
2024-08-12 13:05:26,200 : INFO : Current training batch loss: 0.2642 in epoch 4
2024-08-12 13:05:27,010 : INFO : Current training batch loss: 0.1914 in epoch 4
2024-08-12 13:05:27,821 : INFO : Current training batch loss: 0.1355 in epoch 4
2024-08-12 13:05:28,632 : INFO : Current training batch loss: 0.2012 in epoch 4
2024-08-12 13:05:29,385 : INFO : Epoch finished, average loss over training batches: 0.1432
2024-08-12 13:05:29,385 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:29,385 : INFO : Training metrics:
2024-08-12 13:05:29,385 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:29,389 : INFO : Accuracy: 0.9589
2024-08-12 13:05:29,389 : INFO : Precision score for label_class 0: 0.9107
2024-08-12 13:05:29,389 : INFO : Precision score for label_class 1: 0.9729
2024-08-12 13:05:29,389 : INFO : Precision score for label_class 2: 0.9501
2024-08-12 13:05:29,389 : INFO : Recall score for label_class 0: 0.9358
2024-08-12 13:05:29,389 : INFO : Recall score for label_class 1: 0.9735
2024-08-12 13:05:29,389 : INFO : Recall score for label_class 2: 0.9374
2024-08-12 13:05:29,389 : INFO : Average F1 score: 0.9466
2024-08-12 13:05:29,669 : INFO : Average loss over validation batches: 0.4103
2024-08-12 13:05:29,669 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:29,669 : INFO : Validation metrics:
2024-08-12 13:05:29,669 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:29,673 : INFO : Accuracy: 0.8665
2024-08-12 13:05:29,673 : INFO : Precision score for label_class 0: 0.7835
2024-08-12 13:05:29,673 : INFO : Precision score for label_class 1: 0.9391
2024-08-12 13:05:29,673 : INFO : Precision score for label_class 2: 0.7824
2024-08-12 13:05:29,673 : INFO : Recall score for label_class 0: 0.8736
2024-08-12 13:05:29,673 : INFO : Recall score for label_class 1: 0.8692
2024-08-12 13:05:29,673 : INFO : Recall score for label_class 2: 0.8579
2024-08-12 13:05:29,673 : INFO : Average F1 score: 0.8491
2024-08-12 13:05:29,673 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 13:05:29,673 : INFO : Starting epoch 5
2024-08-12 13:05:29,714 : INFO : Current training batch loss: 0.0825 in epoch 5
2024-08-12 13:05:30,524 : INFO : Current training batch loss: 0.0606 in epoch 5
2024-08-12 13:05:31,335 : INFO : Current training batch loss: 0.0223 in epoch 5
2024-08-12 13:05:32,146 : INFO : Current training batch loss: 0.0395 in epoch 5
2024-08-12 13:05:32,958 : INFO : Current training batch loss: 0.2864 in epoch 5
2024-08-12 13:05:33,103 : INFO : Epoch finished, average loss over training batches: 0.0976
2024-08-12 13:05:33,103 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:33,103 : INFO : Training metrics:
2024-08-12 13:05:33,103 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:33,107 : INFO : Accuracy: 0.9755
2024-08-12 13:05:33,107 : INFO : Precision score for label_class 0: 0.9433
2024-08-12 13:05:33,107 : INFO : Precision score for label_class 1: 0.9852
2024-08-12 13:05:33,107 : INFO : Precision score for label_class 2: 0.9690
2024-08-12 13:05:33,107 : INFO : Recall score for label_class 0: 0.9664
2024-08-12 13:05:33,107 : INFO : Recall score for label_class 1: 0.9852
2024-08-12 13:05:33,107 : INFO : Recall score for label_class 2: 0.9587
2024-08-12 13:05:33,107 : INFO : Average F1 score: 0.9679
2024-08-12 13:05:33,387 : INFO : Average loss over validation batches: 0.4466
2024-08-12 13:05:33,387 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:33,387 : INFO : Validation metrics:
2024-08-12 13:05:33,387 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:33,390 : INFO : Accuracy: 0.8694
2024-08-12 13:05:33,390 : INFO : Precision score for label_class 0: 0.7684
2024-08-12 13:05:33,390 : INFO : Precision score for label_class 1: 0.9372
2024-08-12 13:05:33,390 : INFO : Precision score for label_class 2: 0.7981
2024-08-12 13:05:33,390 : INFO : Recall score for label_class 0: 0.8391
2024-08-12 13:05:33,390 : INFO : Recall score for label_class 1: 0.8795
2024-08-12 13:05:33,390 : INFO : Recall score for label_class 2: 0.8629
2024-08-12 13:05:33,390 : INFO : Average F1 score: 0.8463
2024-08-12 13:05:33,390 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 13:05:33,390 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:05:33,429 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 13:05:33,745 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:33,745 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 13:05:33,745 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:33,748 : INFO : Accuracy: 0.8561
2024-08-12 13:05:33,748 : INFO : Precision score for label_class 0: 0.8310
2024-08-12 13:05:33,748 : INFO : Precision score for label_class 1: 0.8894
2024-08-12 13:05:33,748 : INFO : Precision score for label_class 2: 0.7959
2024-08-12 13:05:33,748 : INFO : Recall score for label_class 0: 0.6782
2024-08-12 13:05:33,748 : INFO : Recall score for label_class 1: 0.9282
2024-08-12 13:05:33,748 : INFO : Recall score for label_class 2: 0.7919
2024-08-12 13:05:33,748 : INFO : Average F1 score: 0.8164
2024-08-12 13:05:33,748 : INFO : Determined score from best model, ending training.
2024-08-12 13:05:33,750 : INFO : Split 4 is finished, the score is: 0.8164
2024-08-12 13:05:33,750 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:33,750 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:33,750 : INFO : Starting training for split 5
2024-08-12 13:05:33,761 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 330, 1615,  754]))
2024-08-12 13:05:33,763 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 84, 396, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:05:33,804 : INFO : Starting epoch 1
2024-08-12 13:05:33,846 : INFO : Current training batch loss: 1.0935 in epoch 1
2024-08-12 13:05:34,656 : INFO : Current training batch loss: 1.0110 in epoch 1
2024-08-12 13:05:35,467 : INFO : Current training batch loss: 0.7608 in epoch 1
2024-08-12 13:05:36,278 : INFO : Current training batch loss: 0.6832 in epoch 1
2024-08-12 13:05:37,089 : INFO : Current training batch loss: 0.7290 in epoch 1
2024-08-12 13:05:37,235 : INFO : Epoch finished, average loss over training batches: 0.8395
2024-08-12 13:05:37,235 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:37,235 : INFO : Training metrics:
2024-08-12 13:05:37,235 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:37,246 : INFO : Accuracy: 0.6625
2024-08-12 13:05:37,246 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:05:37,246 : INFO : Precision score for label_class 1: 0.6919
2024-08-12 13:05:37,246 : INFO : Precision score for label_class 2: 0.5297
2024-08-12 13:05:37,246 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:05:37,246 : INFO : Recall score for label_class 1: 0.9523
2024-08-12 13:05:37,246 : INFO : Recall score for label_class 2: 0.3316
2024-08-12 13:05:37,246 : INFO : Average F1 score: 0.4031
2024-08-12 13:05:37,526 : INFO : Average loss over validation batches: 0.6259
2024-08-12 13:05:37,526 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:37,526 : INFO : Validation metrics:
2024-08-12 13:05:37,526 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:37,530 : INFO : Accuracy: 0.7211
2024-08-12 13:05:37,530 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:05:37,530 : INFO : Precision score for label_class 1: 0.8182
2024-08-12 13:05:37,530 : INFO : Precision score for label_class 2: 0.5385
2024-08-12 13:05:37,530 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:05:37,530 : INFO : Recall score for label_class 1: 0.9091
2024-08-12 13:05:37,530 : INFO : Recall score for label_class 2: 0.6495
2024-08-12 13:05:37,530 : INFO : Average F1 score: 0.4833
2024-08-12 13:05:37,530 : INFO : Validation metric decreased (inf --> 0.625921).  Saving model ...
2024-08-12 13:05:37,636 : INFO : Starting epoch 2
2024-08-12 13:05:38,285 : INFO : Current training batch loss: 0.6314 in epoch 2
2024-08-12 13:05:39,094 : INFO : Current training batch loss: 0.4219 in epoch 2
2024-08-12 13:05:39,905 : INFO : Current training batch loss: 0.3135 in epoch 2
2024-08-12 13:05:40,716 : INFO : Current training batch loss: 0.4907 in epoch 2
2024-08-12 13:05:41,064 : INFO : Epoch finished, average loss over training batches: 0.5103
2024-08-12 13:05:41,064 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:41,064 : INFO : Training metrics:
2024-08-12 13:05:41,064 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:41,071 : INFO : Accuracy: 0.8136
2024-08-12 13:05:41,071 : INFO : Precision score for label_class 0: 0.7320
2024-08-12 13:05:41,071 : INFO : Precision score for label_class 1: 0.8657
2024-08-12 13:05:41,071 : INFO : Precision score for label_class 2: 0.7171
2024-08-12 13:05:41,071 : INFO : Recall score for label_class 0: 0.5545
2024-08-12 13:05:41,071 : INFO : Recall score for label_class 1: 0.9263
2024-08-12 13:05:41,071 : INFO : Recall score for label_class 2: 0.6857
2024-08-12 13:05:41,071 : INFO : Average F1 score: 0.7424
2024-08-12 13:05:41,351 : INFO : Average loss over validation batches: 0.4348
2024-08-12 13:05:41,352 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:41,352 : INFO : Validation metrics:
2024-08-12 13:05:41,352 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:41,355 : INFO : Accuracy: 0.8175
2024-08-12 13:05:41,355 : INFO : Precision score for label_class 0: 0.7237
2024-08-12 13:05:41,355 : INFO : Precision score for label_class 1: 0.8534
2024-08-12 13:05:41,356 : INFO : Precision score for label_class 2: 0.7714
2024-08-12 13:05:41,356 : INFO : Recall score for label_class 0: 0.6548
2024-08-12 13:05:41,356 : INFO : Recall score for label_class 1: 0.9116
2024-08-12 13:05:41,356 : INFO : Recall score for label_class 2: 0.6959
2024-08-12 13:05:41,356 : INFO : Average F1 score: 0.7669
2024-08-12 13:05:41,356 : INFO : Validation metric decreased (0.625921 --> 0.434829).  Saving model ...
2024-08-12 13:05:41,454 : INFO : Starting epoch 3
2024-08-12 13:05:41,900 : INFO : Current training batch loss: 0.2348 in epoch 3
2024-08-12 13:05:42,712 : INFO : Current training batch loss: 0.3468 in epoch 3
2024-08-12 13:05:43,522 : INFO : Current training batch loss: 0.3908 in epoch 3
2024-08-12 13:05:44,333 : INFO : Current training batch loss: 0.2543 in epoch 3
2024-08-12 13:05:44,883 : INFO : Epoch finished, average loss over training batches: 0.2957
2024-08-12 13:05:44,883 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:44,883 : INFO : Training metrics:
2024-08-12 13:05:44,883 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:44,890 : INFO : Accuracy: 0.9074
2024-08-12 13:05:44,890 : INFO : Precision score for label_class 0: 0.8382
2024-08-12 13:05:44,890 : INFO : Precision score for label_class 1: 0.9312
2024-08-12 13:05:44,890 : INFO : Precision score for label_class 2: 0.8855
2024-08-12 13:05:44,890 : INFO : Recall score for label_class 0: 0.8636
2024-08-12 13:05:44,890 : INFO : Recall score for label_class 1: 0.9474
2024-08-12 13:05:44,890 : INFO : Recall score for label_class 2: 0.8408
2024-08-12 13:05:44,890 : INFO : Average F1 score: 0.8842
2024-08-12 13:05:45,171 : INFO : Average loss over validation batches: 0.4098
2024-08-12 13:05:45,171 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:45,171 : INFO : Validation metrics:
2024-08-12 13:05:45,171 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:45,174 : INFO : Accuracy: 0.8442
2024-08-12 13:05:45,174 : INFO : Precision score for label_class 0: 0.7614
2024-08-12 13:05:45,174 : INFO : Precision score for label_class 1: 0.8509
2024-08-12 13:05:45,175 : INFO : Precision score for label_class 2: 0.8733
2024-08-12 13:05:45,175 : INFO : Recall score for label_class 0: 0.7976
2024-08-12 13:05:45,175 : INFO : Recall score for label_class 1: 0.9369
2024-08-12 13:05:45,175 : INFO : Recall score for label_class 2: 0.6753
2024-08-12 13:05:45,175 : INFO : Average F1 score: 0.8108
2024-08-12 13:05:45,175 : INFO : Validation metric decreased (0.434829 --> 0.409785).  Saving model ...
2024-08-12 13:05:45,273 : INFO : Starting epoch 4
2024-08-12 13:05:45,518 : INFO : Current training batch loss: 0.3838 in epoch 4
2024-08-12 13:05:46,328 : INFO : Current training batch loss: 0.1716 in epoch 4
2024-08-12 13:05:47,139 : INFO : Current training batch loss: 0.3202 in epoch 4
2024-08-12 13:05:47,950 : INFO : Current training batch loss: 0.0756 in epoch 4
2024-08-12 13:05:48,702 : INFO : Epoch finished, average loss over training batches: 0.1954
2024-08-12 13:05:48,702 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:48,702 : INFO : Training metrics:
2024-08-12 13:05:48,702 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:48,709 : INFO : Accuracy: 0.9441
2024-08-12 13:05:48,709 : INFO : Precision score for label_class 0: 0.8812
2024-08-12 13:05:48,709 : INFO : Precision score for label_class 1: 0.9653
2024-08-12 13:05:48,709 : INFO : Precision score for label_class 2: 0.9269
2024-08-12 13:05:48,709 : INFO : Recall score for label_class 0: 0.9212
2024-08-12 13:05:48,709 : INFO : Recall score for label_class 1: 0.9653
2024-08-12 13:05:48,709 : INFO : Recall score for label_class 2: 0.9085
2024-08-12 13:05:48,709 : INFO : Average F1 score: 0.9279
2024-08-12 13:05:48,989 : INFO : Average loss over validation batches: 0.4591
2024-08-12 13:05:48,990 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:48,990 : INFO : Validation metrics:
2024-08-12 13:05:48,990 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:48,993 : INFO : Accuracy: 0.8472
2024-08-12 13:05:48,993 : INFO : Precision score for label_class 0: 0.7808
2024-08-12 13:05:48,993 : INFO : Precision score for label_class 1: 0.8689
2024-08-12 13:05:48,993 : INFO : Precision score for label_class 2: 0.8218
2024-08-12 13:05:48,993 : INFO : Recall score for label_class 0: 0.6786
2024-08-12 13:05:48,993 : INFO : Recall score for label_class 1: 0.9369
2024-08-12 13:05:48,993 : INFO : Recall score for label_class 2: 0.7371
2024-08-12 13:05:48,993 : INFO : Average F1 score: 0.8016
2024-08-12 13:05:48,993 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 13:05:48,993 : INFO : Starting epoch 5
2024-08-12 13:05:49,035 : INFO : Current training batch loss: 0.0473 in epoch 5
2024-08-12 13:05:49,845 : INFO : Current training batch loss: 0.1271 in epoch 5
2024-08-12 13:05:50,656 : INFO : Current training batch loss: 0.0353 in epoch 5
2024-08-12 13:05:51,467 : INFO : Current training batch loss: 0.1895 in epoch 5
2024-08-12 13:05:52,279 : INFO : Current training batch loss: 0.0769 in epoch 5
2024-08-12 13:05:52,424 : INFO : Epoch finished, average loss over training batches: 0.1467
2024-08-12 13:05:52,424 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:52,424 : INFO : Training metrics:
2024-08-12 13:05:52,424 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:52,435 : INFO : Accuracy: 0.9559
2024-08-12 13:05:52,435 : INFO : Precision score for label_class 0: 0.9012
2024-08-12 13:05:52,435 : INFO : Precision score for label_class 1: 0.9704
2024-08-12 13:05:52,435 : INFO : Precision score for label_class 2: 0.9495
2024-08-12 13:05:52,435 : INFO : Recall score for label_class 0: 0.9394
2024-08-12 13:05:52,435 : INFO : Recall score for label_class 1: 0.9746
2024-08-12 13:05:52,435 : INFO : Recall score for label_class 2: 0.9231
2024-08-12 13:05:52,435 : INFO : Average F1 score: 0.9428
2024-08-12 13:05:52,715 : INFO : Average loss over validation batches: 0.4920
2024-08-12 13:05:52,715 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:52,715 : INFO : Validation metrics:
2024-08-12 13:05:52,715 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:52,718 : INFO : Accuracy: 0.8383
2024-08-12 13:05:52,718 : INFO : Precision score for label_class 0: 0.7059
2024-08-12 13:05:52,718 : INFO : Precision score for label_class 1: 0.9246
2024-08-12 13:05:52,718 : INFO : Precision score for label_class 2: 0.7570
2024-08-12 13:05:52,718 : INFO : Recall score for label_class 0: 0.8571
2024-08-12 13:05:52,718 : INFO : Recall score for label_class 1: 0.8359
2024-08-12 13:05:52,718 : INFO : Recall score for label_class 2: 0.8351
2024-08-12 13:05:52,718 : INFO : Average F1 score: 0.8154
2024-08-12 13:05:52,718 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 13:05:52,718 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:05:52,757 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 13:05:53,072 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:53,072 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 13:05:53,072 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:53,076 : INFO : Accuracy: 0.8442
2024-08-12 13:05:53,076 : INFO : Precision score for label_class 0: 0.7614
2024-08-12 13:05:53,076 : INFO : Precision score for label_class 1: 0.8509
2024-08-12 13:05:53,076 : INFO : Precision score for label_class 2: 0.8733
2024-08-12 13:05:53,076 : INFO : Recall score for label_class 0: 0.7976
2024-08-12 13:05:53,076 : INFO : Recall score for label_class 1: 0.9369
2024-08-12 13:05:53,076 : INFO : Recall score for label_class 2: 0.6753
2024-08-12 13:05:53,076 : INFO : Average F1 score: 0.8108
2024-08-12 13:05:53,076 : INFO : Determined score from best model, ending training.
2024-08-12 13:05:53,077 : INFO : Split 5 is finished, the score is: 0.8108
2024-08-12 13:05:53,077 : INFO : ----------------------------------------------------------------------------------------------------
[I 2024-08-12 13:05:53,078] Trial 11 finished with value: 0.8338282317294512 and parameters: {'n_epochs': 10, 'learning_rate': 5.8610404653777286e-05, 'classifier_dropout': 0.45611337467218754, 'warmup_step_fraction': 0.0341947753278213, 'use_gradient_clipping': False}. Best is trial 6 with value: 0.8419854360165029.
2024-08-12 13:05:53,086 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:53,086 : INFO : Starting training for split 1
2024-08-12 13:05:53,097 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 328, 1596,  774]))
2024-08-12 13:05:53,099 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 86, 415, 174]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:05:53,140 : INFO : Starting epoch 1
2024-08-12 13:05:53,182 : INFO : Current training batch loss: 1.0966 in epoch 1
2024-08-12 13:05:53,998 : INFO : Current training batch loss: 0.8070 in epoch 1
2024-08-12 13:05:54,809 : INFO : Current training batch loss: 0.7138 in epoch 1
2024-08-12 13:05:55,619 : INFO : Current training batch loss: 0.7346 in epoch 1
2024-08-12 13:05:56,430 : INFO : Current training batch loss: 0.6237 in epoch 1
2024-08-12 13:05:56,575 : INFO : Epoch finished, average loss over training batches: 0.7995
2024-08-12 13:05:56,576 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:56,576 : INFO : Training metrics:
2024-08-12 13:05:56,576 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:56,581 : INFO : Accuracy: 0.6683
2024-08-12 13:05:56,581 : INFO : Precision score for label_class 0: 0.2881
2024-08-12 13:05:56,581 : INFO : Precision score for label_class 1: 0.7115
2024-08-12 13:05:56,581 : INFO : Precision score for label_class 2: 0.5402
2024-08-12 13:05:56,581 : INFO : Recall score for label_class 0: 0.0518
2024-08-12 13:05:56,581 : INFO : Recall score for label_class 1: 0.9380
2024-08-12 13:05:56,581 : INFO : Recall score for label_class 2: 0.3734
2024-08-12 13:05:56,581 : INFO : Average F1 score: 0.4462
2024-08-12 13:05:56,860 : INFO : Average loss over validation batches: 0.6085
2024-08-12 13:05:56,861 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:56,861 : INFO : Validation metrics:
2024-08-12 13:05:56,861 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:05:56,863 : INFO : Accuracy: 0.7422
2024-08-12 13:05:56,863 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:05:56,863 : INFO : Precision score for label_class 1: 0.8875
2024-08-12 13:05:56,863 : INFO : Precision score for label_class 2: 0.5188
2024-08-12 13:05:56,863 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:05:56,863 : INFO : Recall score for label_class 1: 0.8747
2024-08-12 13:05:56,863 : INFO : Recall score for label_class 2: 0.7931
2024-08-12 13:05:56,863 : INFO : Average F1 score: 0.5028
2024-08-12 13:05:56,863 : INFO : Validation metric decreased (inf --> 0.608547).  Saving model ...
2024-08-12 13:05:56,969 : INFO : Starting epoch 2
2024-08-12 13:05:57,618 : INFO : Current training batch loss: 0.3307 in epoch 2
2024-08-12 13:05:58,428 : INFO : Current training batch loss: 0.5076 in epoch 2
2024-08-12 13:05:59,239 : INFO : Current training batch loss: 0.2754 in epoch 2
2024-08-12 13:06:00,049 : INFO : Current training batch loss: 0.3110 in epoch 2
2024-08-12 13:06:00,396 : INFO : Epoch finished, average loss over training batches: 0.4341
2024-08-12 13:06:00,397 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:00,397 : INFO : Training metrics:
2024-08-12 13:06:00,397 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:00,405 : INFO : Accuracy: 0.8436
2024-08-12 13:06:00,405 : INFO : Precision score for label_class 0: 0.7782
2024-08-12 13:06:00,405 : INFO : Precision score for label_class 1: 0.8763
2024-08-12 13:06:00,405 : INFO : Precision score for label_class 2: 0.7926
2024-08-12 13:06:00,405 : INFO : Recall score for label_class 0: 0.6524
2024-08-12 13:06:00,405 : INFO : Recall score for label_class 1: 0.9279
2024-08-12 13:06:00,405 : INFO : Recall score for label_class 2: 0.7506
2024-08-12 13:06:00,405 : INFO : Average F1 score: 0.7941
2024-08-12 13:06:00,685 : INFO : Average loss over validation batches: 0.4006
2024-08-12 13:06:00,685 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:00,685 : INFO : Validation metrics:
2024-08-12 13:06:00,685 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:00,688 : INFO : Accuracy: 0.8415
2024-08-12 13:06:00,688 : INFO : Precision score for label_class 0: 0.7949
2024-08-12 13:06:00,688 : INFO : Precision score for label_class 1: 0.9235
2024-08-12 13:06:00,688 : INFO : Precision score for label_class 2: 0.7024
2024-08-12 13:06:00,688 : INFO : Recall score for label_class 0: 0.7209
2024-08-12 13:06:00,688 : INFO : Recall score for label_class 1: 0.8723
2024-08-12 13:06:00,688 : INFO : Recall score for label_class 2: 0.8276
2024-08-12 13:06:00,688 : INFO : Average F1 score: 0.8044
2024-08-12 13:06:00,688 : INFO : Validation metric decreased (0.608547 --> 0.400599).  Saving model ...
2024-08-12 13:06:00,789 : INFO : Starting epoch 3
2024-08-12 13:06:01,236 : INFO : Current training batch loss: 0.2456 in epoch 3
2024-08-12 13:06:02,125 : INFO : Current training batch loss: 0.3760 in epoch 3
2024-08-12 13:06:02,936 : INFO : Current training batch loss: 0.2292 in epoch 3
2024-08-12 13:06:03,747 : INFO : Current training batch loss: 0.0812 in epoch 3
2024-08-12 13:06:04,297 : INFO : Epoch finished, average loss over training batches: 0.2518
2024-08-12 13:06:04,298 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:04,298 : INFO : Training metrics:
2024-08-12 13:06:04,298 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:04,306 : INFO : Accuracy: 0.9133
2024-08-12 13:06:04,306 : INFO : Precision score for label_class 0: 0.8338
2024-08-12 13:06:04,306 : INFO : Precision score for label_class 1: 0.9356
2024-08-12 13:06:04,306 : INFO : Precision score for label_class 2: 0.9007
2024-08-12 13:06:04,306 : INFO : Recall score for label_class 0: 0.8720
2024-08-12 13:06:04,306 : INFO : Recall score for label_class 1: 0.9555
2024-08-12 13:06:04,306 : INFO : Recall score for label_class 2: 0.8437
2024-08-12 13:06:04,306 : INFO : Average F1 score: 0.8897
2024-08-12 13:06:04,586 : INFO : Average loss over validation batches: 0.3831
2024-08-12 13:06:04,586 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:04,586 : INFO : Validation metrics:
2024-08-12 13:06:04,586 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:04,588 : INFO : Accuracy: 0.8533
2024-08-12 13:06:04,588 : INFO : Precision score for label_class 0: 0.7526
2024-08-12 13:06:04,588 : INFO : Precision score for label_class 1: 0.8969
2024-08-12 13:06:04,588 : INFO : Precision score for label_class 2: 0.8012
2024-08-12 13:06:04,588 : INFO : Recall score for label_class 0: 0.8488
2024-08-12 13:06:04,588 : INFO : Recall score for label_class 1: 0.9012
2024-08-12 13:06:04,588 : INFO : Recall score for label_class 2: 0.7414
2024-08-12 13:06:04,589 : INFO : Average F1 score: 0.8223
2024-08-12 13:06:04,589 : INFO : Validation metric decreased (0.400599 --> 0.383068).  Saving model ...
2024-08-12 13:06:04,688 : INFO : Starting epoch 4
2024-08-12 13:06:04,932 : INFO : Current training batch loss: 0.3365 in epoch 4
2024-08-12 13:06:05,743 : INFO : Current training batch loss: 0.0728 in epoch 4
2024-08-12 13:06:06,554 : INFO : Current training batch loss: 0.2409 in epoch 4
2024-08-12 13:06:07,364 : INFO : Current training batch loss: 0.0786 in epoch 4
2024-08-12 13:06:08,117 : INFO : Epoch finished, average loss over training batches: 0.1485
2024-08-12 13:06:08,117 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:08,117 : INFO : Training metrics:
2024-08-12 13:06:08,117 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:08,125 : INFO : Accuracy: 0.9540
2024-08-12 13:06:08,125 : INFO : Precision score for label_class 0: 0.8785
2024-08-12 13:06:08,125 : INFO : Precision score for label_class 1: 0.9749
2024-08-12 13:06:08,125 : INFO : Precision score for label_class 2: 0.9455
2024-08-12 13:06:08,125 : INFO : Recall score for label_class 0: 0.9482
2024-08-12 13:06:08,125 : INFO : Recall score for label_class 1: 0.9724
2024-08-12 13:06:08,125 : INFO : Recall score for label_class 2: 0.9186
2024-08-12 13:06:08,125 : INFO : Average F1 score: 0.9392
2024-08-12 13:06:08,405 : INFO : Average loss over validation batches: 0.3657
2024-08-12 13:06:08,405 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:08,405 : INFO : Validation metrics:
2024-08-12 13:06:08,405 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:08,408 : INFO : Accuracy: 0.8622
2024-08-12 13:06:08,408 : INFO : Precision score for label_class 0: 0.7634
2024-08-12 13:06:08,408 : INFO : Precision score for label_class 1: 0.9223
2024-08-12 13:06:08,408 : INFO : Precision score for label_class 2: 0.7814
2024-08-12 13:06:08,408 : INFO : Recall score for label_class 0: 0.8256
2024-08-12 13:06:08,408 : INFO : Recall score for label_class 1: 0.8867
2024-08-12 13:06:08,408 : INFO : Recall score for label_class 2: 0.8218
2024-08-12 13:06:08,408 : INFO : Average F1 score: 0.8329
2024-08-12 13:06:08,408 : INFO : Validation metric decreased (0.383068 --> 0.365750).  Saving model ...
2024-08-12 13:06:08,510 : INFO : Starting epoch 5
2024-08-12 13:06:08,552 : INFO : Current training batch loss: 0.0611 in epoch 5
2024-08-12 13:06:09,362 : INFO : Current training batch loss: 0.1025 in epoch 5
2024-08-12 13:06:10,174 : INFO : Current training batch loss: 0.0883 in epoch 5
2024-08-12 13:06:10,985 : INFO : Current training batch loss: 0.0229 in epoch 5
2024-08-12 13:06:11,797 : INFO : Current training batch loss: 0.1863 in epoch 5
2024-08-12 13:06:11,942 : INFO : Epoch finished, average loss over training batches: 0.0942
2024-08-12 13:06:11,942 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:11,942 : INFO : Training metrics:
2024-08-12 13:06:11,942 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:11,947 : INFO : Accuracy: 0.9715
2024-08-12 13:06:11,947 : INFO : Precision score for label_class 0: 0.9130
2024-08-12 13:06:11,947 : INFO : Precision score for label_class 1: 0.9832
2024-08-12 13:06:11,947 : INFO : Precision score for label_class 2: 0.9733
2024-08-12 13:06:11,947 : INFO : Recall score for label_class 0: 0.9604
2024-08-12 13:06:11,947 : INFO : Recall score for label_class 1: 0.9875
2024-08-12 13:06:11,947 : INFO : Recall score for label_class 2: 0.9432
2024-08-12 13:06:11,947 : INFO : Average F1 score: 0.9598
2024-08-12 13:06:12,227 : INFO : Average loss over validation batches: 0.3927
2024-08-12 13:06:12,227 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:12,227 : INFO : Validation metrics:
2024-08-12 13:06:12,227 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:12,230 : INFO : Accuracy: 0.8770
2024-08-12 13:06:12,230 : INFO : Precision score for label_class 0: 0.7500
2024-08-12 13:06:12,230 : INFO : Precision score for label_class 1: 0.9026
2024-08-12 13:06:12,230 : INFO : Precision score for label_class 2: 0.8929
2024-08-12 13:06:12,230 : INFO : Recall score for label_class 0: 0.9070
2024-08-12 13:06:12,230 : INFO : Recall score for label_class 1: 0.9373
2024-08-12 13:06:12,230 : INFO : Recall score for label_class 2: 0.7184
2024-08-12 13:06:12,230 : INFO : Average F1 score: 0.8456
2024-08-12 13:06:12,230 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 13:06:12,230 : INFO : Starting epoch 6
2024-08-12 13:06:12,878 : INFO : Current training batch loss: 0.0597 in epoch 6
2024-08-12 13:06:13,690 : INFO : Current training batch loss: 0.0473 in epoch 6
2024-08-12 13:06:14,501 : INFO : Current training batch loss: 0.0145 in epoch 6
2024-08-12 13:06:15,312 : INFO : Current training batch loss: 0.0101 in epoch 6
2024-08-12 13:06:15,660 : INFO : Epoch finished, average loss over training batches: 0.0557
2024-08-12 13:06:15,660 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:15,660 : INFO : Training metrics:
2024-08-12 13:06:15,660 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:15,668 : INFO : Accuracy: 0.9833
2024-08-12 13:06:15,668 : INFO : Precision score for label_class 0: 0.9362
2024-08-12 13:06:15,668 : INFO : Precision score for label_class 1: 0.9925
2024-08-12 13:06:15,668 : INFO : Precision score for label_class 2: 0.9854
2024-08-12 13:06:15,668 : INFO : Recall score for label_class 0: 0.9848
2024-08-12 13:06:15,668 : INFO : Recall score for label_class 1: 0.9944
2024-08-12 13:06:15,668 : INFO : Recall score for label_class 2: 0.9599
2024-08-12 13:06:15,668 : INFO : Average F1 score: 0.9753
2024-08-12 13:06:15,948 : INFO : Average loss over validation batches: 0.3857
2024-08-12 13:06:15,948 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:15,948 : INFO : Validation metrics:
2024-08-12 13:06:15,948 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:15,951 : INFO : Accuracy: 0.8904
2024-08-12 13:06:15,951 : INFO : Precision score for label_class 0: 0.7723
2024-08-12 13:06:15,951 : INFO : Precision score for label_class 1: 0.9231
2024-08-12 13:06:15,951 : INFO : Precision score for label_class 2: 0.8797
2024-08-12 13:06:15,951 : INFO : Recall score for label_class 0: 0.9070
2024-08-12 13:06:15,951 : INFO : Recall score for label_class 1: 0.9253
2024-08-12 13:06:15,951 : INFO : Recall score for label_class 2: 0.7989
2024-08-12 13:06:15,951 : INFO : Average F1 score: 0.8653
2024-08-12 13:06:15,951 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 13:06:15,951 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:06:15,988 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 13:06:16,297 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:16,298 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 13:06:16,298 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:16,301 : INFO : Accuracy: 0.8622
2024-08-12 13:06:16,301 : INFO : Precision score for label_class 0: 0.7634
2024-08-12 13:06:16,301 : INFO : Precision score for label_class 1: 0.9223
2024-08-12 13:06:16,301 : INFO : Precision score for label_class 2: 0.7814
2024-08-12 13:06:16,301 : INFO : Recall score for label_class 0: 0.8256
2024-08-12 13:06:16,301 : INFO : Recall score for label_class 1: 0.8867
2024-08-12 13:06:16,301 : INFO : Recall score for label_class 2: 0.8218
2024-08-12 13:06:16,301 : INFO : Average F1 score: 0.8329
2024-08-12 13:06:16,301 : INFO : Determined score from best model, ending training.
2024-08-12 13:06:16,302 : INFO : Split 1 is finished, the score is: 0.8329
2024-08-12 13:06:16,302 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:16,303 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:16,303 : INFO : Starting training for split 2
2024-08-12 13:06:16,314 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 343, 1601,  754]))
2024-08-12 13:06:16,316 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 71, 410, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:06:16,355 : INFO : Starting epoch 1
2024-08-12 13:06:16,397 : INFO : Current training batch loss: 1.1233 in epoch 1
2024-08-12 13:06:17,207 : INFO : Current training batch loss: 0.9725 in epoch 1
2024-08-12 13:06:18,019 : INFO : Current training batch loss: 0.7394 in epoch 1
2024-08-12 13:06:18,829 : INFO : Current training batch loss: 0.6768 in epoch 1
2024-08-12 13:06:19,640 : INFO : Current training batch loss: 0.5673 in epoch 1
2024-08-12 13:06:19,785 : INFO : Epoch finished, average loss over training batches: 0.7501
2024-08-12 13:06:19,785 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:19,786 : INFO : Training metrics:
2024-08-12 13:06:19,786 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:19,796 : INFO : Accuracy: 0.6809
2024-08-12 13:06:19,796 : INFO : Precision score for label_class 0: 0.3399
2024-08-12 13:06:19,796 : INFO : Precision score for label_class 1: 0.7417
2024-08-12 13:06:19,796 : INFO : Precision score for label_class 2: 0.6277
2024-08-12 13:06:19,796 : INFO : Recall score for label_class 0: 0.2507
2024-08-12 13:06:19,796 : INFO : Recall score for label_class 1: 0.8788
2024-08-12 13:06:19,796 : INFO : Recall score for label_class 2: 0.4562
2024-08-12 13:06:19,796 : INFO : Average F1 score: 0.5405
2024-08-12 13:06:20,076 : INFO : Average loss over validation batches: 0.4449
2024-08-12 13:06:20,076 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:20,076 : INFO : Validation metrics:
2024-08-12 13:06:20,076 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:20,079 : INFO : Accuracy: 0.8311
2024-08-12 13:06:20,079 : INFO : Precision score for label_class 0: 0.7200
2024-08-12 13:06:20,079 : INFO : Precision score for label_class 1: 0.9013
2024-08-12 13:06:20,079 : INFO : Precision score for label_class 2: 0.7442
2024-08-12 13:06:20,079 : INFO : Recall score for label_class 0: 0.7606
2024-08-12 13:06:20,079 : INFO : Recall score for label_class 1: 0.8463
2024-08-12 13:06:20,079 : INFO : Recall score for label_class 2: 0.8247
2024-08-12 13:06:20,079 : INFO : Average F1 score: 0.7984
2024-08-12 13:06:20,079 : INFO : Validation metric decreased (inf --> 0.444895).  Saving model ...
2024-08-12 13:06:20,189 : INFO : Starting epoch 2
2024-08-12 13:06:20,838 : INFO : Current training batch loss: 0.3916 in epoch 2
2024-08-12 13:06:21,647 : INFO : Current training batch loss: 0.3542 in epoch 2
2024-08-12 13:06:22,458 : INFO : Current training batch loss: 0.2563 in epoch 2
2024-08-12 13:06:23,268 : INFO : Current training batch loss: 0.3808 in epoch 2
2024-08-12 13:06:23,616 : INFO : Epoch finished, average loss over training batches: 0.3493
2024-08-12 13:06:23,616 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:23,616 : INFO : Training metrics:
2024-08-12 13:06:23,616 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:23,623 : INFO : Accuracy: 0.8795
2024-08-12 13:06:23,623 : INFO : Precision score for label_class 0: 0.7922
2024-08-12 13:06:23,623 : INFO : Precision score for label_class 1: 0.9121
2024-08-12 13:06:23,623 : INFO : Precision score for label_class 2: 0.8493
2024-08-12 13:06:23,623 : INFO : Recall score for label_class 0: 0.8338
2024-08-12 13:06:23,623 : INFO : Recall score for label_class 1: 0.9269
2024-08-12 13:06:23,623 : INFO : Recall score for label_class 2: 0.7997
2024-08-12 13:06:23,623 : INFO : Average F1 score: 0.8519
2024-08-12 13:06:23,903 : INFO : Average loss over validation batches: 0.3844
2024-08-12 13:06:23,904 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:23,904 : INFO : Validation metrics:
2024-08-12 13:06:23,904 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:23,907 : INFO : Accuracy: 0.8622
2024-08-12 13:06:23,907 : INFO : Precision score for label_class 0: 0.7595
2024-08-12 13:06:23,907 : INFO : Precision score for label_class 1: 0.9162
2024-08-12 13:06:23,907 : INFO : Precision score for label_class 2: 0.7970
2024-08-12 13:06:23,907 : INFO : Recall score for label_class 0: 0.8451
2024-08-12 13:06:23,907 : INFO : Recall score for label_class 1: 0.8805
2024-08-12 13:06:23,907 : INFO : Recall score for label_class 2: 0.8299
2024-08-12 13:06:23,907 : INFO : Average F1 score: 0.8370
2024-08-12 13:06:23,907 : INFO : Validation metric decreased (0.444895 --> 0.384384).  Saving model ...
2024-08-12 13:06:24,004 : INFO : Starting epoch 3
2024-08-12 13:06:24,450 : INFO : Current training batch loss: 0.2694 in epoch 3
2024-08-12 13:06:25,261 : INFO : Current training batch loss: 0.1917 in epoch 3
2024-08-12 13:06:26,072 : INFO : Current training batch loss: 0.4175 in epoch 3
2024-08-12 13:06:26,883 : INFO : Current training batch loss: 0.1049 in epoch 3
2024-08-12 13:06:27,433 : INFO : Epoch finished, average loss over training batches: 0.1974
2024-08-12 13:06:27,433 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:27,433 : INFO : Training metrics:
2024-08-12 13:06:27,433 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:27,443 : INFO : Accuracy: 0.9403
2024-08-12 13:06:27,443 : INFO : Precision score for label_class 0: 0.8709
2024-08-12 13:06:27,443 : INFO : Precision score for label_class 1: 0.9613
2024-08-12 13:06:27,443 : INFO : Precision score for label_class 2: 0.9289
2024-08-12 13:06:27,443 : INFO : Recall score for label_class 0: 0.9242
2024-08-12 13:06:27,443 : INFO : Recall score for label_class 1: 0.9625
2024-08-12 13:06:27,443 : INFO : Recall score for label_class 2: 0.9005
2024-08-12 13:06:27,443 : INFO : Average F1 score: 0.9244
2024-08-12 13:06:27,723 : INFO : Average loss over validation batches: 0.4142
2024-08-12 13:06:27,724 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:27,724 : INFO : Validation metrics:
2024-08-12 13:06:27,724 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:27,727 : INFO : Accuracy: 0.8578
2024-08-12 13:06:27,727 : INFO : Precision score for label_class 0: 0.7083
2024-08-12 13:06:27,727 : INFO : Precision score for label_class 1: 0.8756
2024-08-12 13:06:27,727 : INFO : Precision score for label_class 2: 0.8757
2024-08-12 13:06:27,727 : INFO : Recall score for label_class 0: 0.7183
2024-08-12 13:06:27,727 : INFO : Recall score for label_class 1: 0.9268
2024-08-12 13:06:27,727 : INFO : Recall score for label_class 2: 0.7629
2024-08-12 13:06:27,727 : INFO : Average F1 score: 0.8097
2024-08-12 13:06:27,727 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 13:06:27,727 : INFO : Starting epoch 4
2024-08-12 13:06:27,970 : INFO : Current training batch loss: 0.3626 in epoch 4
2024-08-12 13:06:28,781 : INFO : Current training batch loss: 0.1382 in epoch 4
2024-08-12 13:06:29,592 : INFO : Current training batch loss: 0.1095 in epoch 4
2024-08-12 13:06:30,403 : INFO : Current training batch loss: 0.2401 in epoch 4
2024-08-12 13:06:31,156 : INFO : Epoch finished, average loss over training batches: 0.1255
2024-08-12 13:06:31,156 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:31,156 : INFO : Training metrics:
2024-08-12 13:06:31,156 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:31,167 : INFO : Accuracy: 0.9652
2024-08-12 13:06:31,167 : INFO : Precision score for label_class 0: 0.9088
2024-08-12 13:06:31,167 : INFO : Precision score for label_class 1: 0.9843
2024-08-12 13:06:31,167 : INFO : Precision score for label_class 2: 0.9518
2024-08-12 13:06:31,167 : INFO : Recall score for label_class 0: 0.9592
2024-08-12 13:06:31,167 : INFO : Recall score for label_class 1: 0.9769
2024-08-12 13:06:31,167 : INFO : Recall score for label_class 2: 0.9430
2024-08-12 13:06:31,167 : INFO : Average F1 score: 0.9538
2024-08-12 13:06:31,447 : INFO : Average loss over validation batches: 0.5056
2024-08-12 13:06:31,447 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:31,447 : INFO : Validation metrics:
2024-08-12 13:06:31,447 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:31,450 : INFO : Accuracy: 0.8563
2024-08-12 13:06:31,450 : INFO : Precision score for label_class 0: 0.8364
2024-08-12 13:06:31,450 : INFO : Precision score for label_class 1: 0.8688
2024-08-12 13:06:31,450 : INFO : Precision score for label_class 2: 0.8315
2024-08-12 13:06:31,450 : INFO : Recall score for label_class 0: 0.6479
2024-08-12 13:06:31,450 : INFO : Recall score for label_class 1: 0.9366
2024-08-12 13:06:31,450 : INFO : Recall score for label_class 2: 0.7629
2024-08-12 13:06:31,450 : INFO : Average F1 score: 0.8091
2024-08-12 13:06:31,450 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 13:06:31,450 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:06:31,487 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 13:06:31,804 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:31,804 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 13:06:31,804 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:31,807 : INFO : Accuracy: 0.8622
2024-08-12 13:06:31,807 : INFO : Precision score for label_class 0: 0.7595
2024-08-12 13:06:31,807 : INFO : Precision score for label_class 1: 0.9162
2024-08-12 13:06:31,807 : INFO : Precision score for label_class 2: 0.7970
2024-08-12 13:06:31,807 : INFO : Recall score for label_class 0: 0.8451
2024-08-12 13:06:31,807 : INFO : Recall score for label_class 1: 0.8805
2024-08-12 13:06:31,807 : INFO : Recall score for label_class 2: 0.8299
2024-08-12 13:06:31,807 : INFO : Average F1 score: 0.8370
2024-08-12 13:06:31,807 : INFO : Determined score from best model, ending training.
2024-08-12 13:06:31,814 : INFO : Split 2 is finished, the score is: 0.8370
2024-08-12 13:06:31,814 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:31,814 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:31,814 : INFO : Starting training for split 3
2024-08-12 13:06:31,826 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 328, 1611,  759]))
2024-08-12 13:06:31,828 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 86, 400, 189]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:06:31,878 : INFO : Starting epoch 1
2024-08-12 13:06:31,920 : INFO : Current training batch loss: 1.1129 in epoch 1
2024-08-12 13:06:32,731 : INFO : Current training batch loss: 0.9697 in epoch 1
2024-08-12 13:06:33,542 : INFO : Current training batch loss: 0.6351 in epoch 1
2024-08-12 13:06:34,353 : INFO : Current training batch loss: 0.5534 in epoch 1
2024-08-12 13:06:35,164 : INFO : Current training batch loss: 0.5171 in epoch 1
2024-08-12 13:06:35,309 : INFO : Epoch finished, average loss over training batches: 0.7457
2024-08-12 13:06:35,309 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:35,309 : INFO : Training metrics:
2024-08-12 13:06:35,309 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:35,313 : INFO : Accuracy: 0.6775
2024-08-12 13:06:35,313 : INFO : Precision score for label_class 0: 0.2500
2024-08-12 13:06:35,313 : INFO : Precision score for label_class 1: 0.7496
2024-08-12 13:06:35,313 : INFO : Precision score for label_class 2: 0.6090
2024-08-12 13:06:35,313 : INFO : Recall score for label_class 0: 0.1677
2024-08-12 13:06:35,313 : INFO : Recall score for label_class 1: 0.8734
2024-08-12 13:06:35,313 : INFO : Recall score for label_class 2: 0.4822
2024-08-12 13:06:35,313 : INFO : Average F1 score: 0.5152
2024-08-12 13:06:35,594 : INFO : Average loss over validation batches: 0.4674
2024-08-12 13:06:35,594 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:35,594 : INFO : Validation metrics:
2024-08-12 13:06:35,594 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:35,596 : INFO : Accuracy: 0.8148
2024-08-12 13:06:35,596 : INFO : Precision score for label_class 0: 0.6900
2024-08-12 13:06:35,596 : INFO : Precision score for label_class 1: 0.9185
2024-08-12 13:06:35,596 : INFO : Precision score for label_class 2: 0.6908
2024-08-12 13:06:35,596 : INFO : Recall score for label_class 0: 0.8023
2024-08-12 13:06:35,597 : INFO : Recall score for label_class 1: 0.8450
2024-08-12 13:06:35,597 : INFO : Recall score for label_class 2: 0.7566
2024-08-12 13:06:35,597 : INFO : Average F1 score: 0.7815
2024-08-12 13:06:35,597 : INFO : Validation metric decreased (inf --> 0.467413).  Saving model ...
2024-08-12 13:06:35,707 : INFO : Starting epoch 2
2024-08-12 13:06:36,355 : INFO : Current training batch loss: 0.4482 in epoch 2
2024-08-12 13:06:37,165 : INFO : Current training batch loss: 0.2675 in epoch 2
2024-08-12 13:06:37,976 : INFO : Current training batch loss: 0.3854 in epoch 2
2024-08-12 13:06:38,786 : INFO : Current training batch loss: 0.3546 in epoch 2
2024-08-12 13:06:39,134 : INFO : Epoch finished, average loss over training batches: 0.3631
2024-08-12 13:06:39,134 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:39,134 : INFO : Training metrics:
2024-08-12 13:06:39,134 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:39,139 : INFO : Accuracy: 0.8781
2024-08-12 13:06:39,139 : INFO : Precision score for label_class 0: 0.7742
2024-08-12 13:06:39,139 : INFO : Precision score for label_class 1: 0.9086
2024-08-12 13:06:39,139 : INFO : Precision score for label_class 2: 0.8575
2024-08-12 13:06:39,139 : INFO : Recall score for label_class 0: 0.8049
2024-08-12 13:06:39,139 : INFO : Recall score for label_class 1: 0.9255
2024-08-12 13:06:39,139 : INFO : Recall score for label_class 2: 0.8090
2024-08-12 13:06:39,139 : INFO : Average F1 score: 0.8463
2024-08-12 13:06:39,420 : INFO : Average loss over validation batches: 0.3666
2024-08-12 13:06:39,420 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:39,420 : INFO : Validation metrics:
2024-08-12 13:06:39,420 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:39,422 : INFO : Accuracy: 0.8741
2024-08-12 13:06:39,422 : INFO : Precision score for label_class 0: 0.7653
2024-08-12 13:06:39,422 : INFO : Precision score for label_class 1: 0.9202
2024-08-12 13:06:39,422 : INFO : Precision score for label_class 2: 0.8295
2024-08-12 13:06:39,422 : INFO : Recall score for label_class 0: 0.8721
2024-08-12 13:06:39,422 : INFO : Recall score for label_class 1: 0.9225
2024-08-12 13:06:39,422 : INFO : Recall score for label_class 2: 0.7725
2024-08-12 13:06:39,422 : INFO : Average F1 score: 0.8455
2024-08-12 13:06:39,422 : INFO : Validation metric decreased (0.467413 --> 0.366588).  Saving model ...
2024-08-12 13:06:39,523 : INFO : Starting epoch 3
2024-08-12 13:06:39,970 : INFO : Current training batch loss: 0.1626 in epoch 3
2024-08-12 13:06:40,781 : INFO : Current training batch loss: 0.2587 in epoch 3
2024-08-12 13:06:41,592 : INFO : Current training batch loss: 0.1585 in epoch 3
2024-08-12 13:06:42,402 : INFO : Current training batch loss: 0.0638 in epoch 3
2024-08-12 13:06:42,953 : INFO : Epoch finished, average loss over training batches: 0.2194
2024-08-12 13:06:42,953 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:42,953 : INFO : Training metrics:
2024-08-12 13:06:42,953 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:42,957 : INFO : Accuracy: 0.9318
2024-08-12 13:06:42,957 : INFO : Precision score for label_class 0: 0.8352
2024-08-12 13:06:42,957 : INFO : Precision score for label_class 1: 0.9590
2024-08-12 13:06:42,957 : INFO : Precision score for label_class 2: 0.9194
2024-08-12 13:06:42,957 : INFO : Recall score for label_class 0: 0.9116
2024-08-12 13:06:42,957 : INFO : Recall score for label_class 1: 0.9572
2024-08-12 13:06:42,957 : INFO : Recall score for label_class 2: 0.8867
2024-08-12 13:06:42,957 : INFO : Average F1 score: 0.9108
2024-08-12 13:06:43,238 : INFO : Average loss over validation batches: 0.3772
2024-08-12 13:06:43,238 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:43,238 : INFO : Validation metrics:
2024-08-12 13:06:43,238 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:43,240 : INFO : Accuracy: 0.8652
2024-08-12 13:06:43,240 : INFO : Precision score for label_class 0: 0.8750
2024-08-12 13:06:43,240 : INFO : Precision score for label_class 1: 0.9129
2024-08-12 13:06:43,240 : INFO : Precision score for label_class 2: 0.7662
2024-08-12 13:06:43,240 : INFO : Recall score for label_class 0: 0.7326
2024-08-12 13:06:43,240 : INFO : Recall score for label_class 1: 0.9175
2024-08-12 13:06:43,240 : INFO : Recall score for label_class 2: 0.8148
2024-08-12 13:06:43,240 : INFO : Average F1 score: 0.8341
2024-08-12 13:06:43,240 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 13:06:43,240 : INFO : Starting epoch 4
2024-08-12 13:06:43,484 : INFO : Current training batch loss: 0.2859 in epoch 4
2024-08-12 13:06:44,296 : INFO : Current training batch loss: 0.2288 in epoch 4
2024-08-12 13:06:45,107 : INFO : Current training batch loss: 0.1715 in epoch 4
2024-08-12 13:06:45,917 : INFO : Current training batch loss: 0.0394 in epoch 4
2024-08-12 13:06:46,670 : INFO : Epoch finished, average loss over training batches: 0.1372
2024-08-12 13:06:46,671 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:46,671 : INFO : Training metrics:
2024-08-12 13:06:46,671 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:46,674 : INFO : Accuracy: 0.9563
2024-08-12 13:06:46,674 : INFO : Precision score for label_class 0: 0.8807
2024-08-12 13:06:46,674 : INFO : Precision score for label_class 1: 0.9751
2024-08-12 13:06:46,674 : INFO : Precision score for label_class 2: 0.9513
2024-08-12 13:06:46,674 : INFO : Recall score for label_class 0: 0.9451
2024-08-12 13:06:46,674 : INFO : Recall score for label_class 1: 0.9727
2024-08-12 13:06:46,674 : INFO : Recall score for label_class 2: 0.9262
2024-08-12 13:06:46,674 : INFO : Average F1 score: 0.9414
2024-08-12 13:06:46,955 : INFO : Average loss over validation batches: 0.4089
2024-08-12 13:06:46,955 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:46,955 : INFO : Validation metrics:
2024-08-12 13:06:46,955 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:46,958 : INFO : Accuracy: 0.8652
2024-08-12 13:06:46,958 : INFO : Precision score for label_class 0: 0.8625
2024-08-12 13:06:46,958 : INFO : Precision score for label_class 1: 0.9251
2024-08-12 13:06:46,958 : INFO : Precision score for label_class 2: 0.7548
2024-08-12 13:06:46,958 : INFO : Recall score for label_class 0: 0.8023
2024-08-12 13:06:46,958 : INFO : Recall score for label_class 1: 0.8950
2024-08-12 13:06:46,958 : INFO : Recall score for label_class 2: 0.8307
2024-08-12 13:06:46,958 : INFO : Average F1 score: 0.8440
2024-08-12 13:06:46,958 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 13:06:46,958 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:06:46,992 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 13:06:47,308 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:47,308 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 13:06:47,308 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:47,310 : INFO : Accuracy: 0.8741
2024-08-12 13:06:47,310 : INFO : Precision score for label_class 0: 0.7653
2024-08-12 13:06:47,310 : INFO : Precision score for label_class 1: 0.9202
2024-08-12 13:06:47,310 : INFO : Precision score for label_class 2: 0.8295
2024-08-12 13:06:47,311 : INFO : Recall score for label_class 0: 0.8721
2024-08-12 13:06:47,311 : INFO : Recall score for label_class 1: 0.9225
2024-08-12 13:06:47,311 : INFO : Recall score for label_class 2: 0.7725
2024-08-12 13:06:47,311 : INFO : Average F1 score: 0.8455
2024-08-12 13:06:47,311 : INFO : Determined score from best model, ending training.
2024-08-12 13:06:47,312 : INFO : Split 3 is finished, the score is: 0.8455
2024-08-12 13:06:47,312 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:47,312 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:47,312 : INFO : Starting training for split 4
2024-08-12 13:06:47,323 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 327, 1621,  751]))
2024-08-12 13:06:47,326 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 87, 390, 197]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:06:47,365 : INFO : Starting epoch 1
2024-08-12 13:06:47,407 : INFO : Current training batch loss: 1.1158 in epoch 1
2024-08-12 13:06:48,223 : INFO : Current training batch loss: 0.9853 in epoch 1
2024-08-12 13:06:49,034 : INFO : Current training batch loss: 0.6907 in epoch 1
2024-08-12 13:06:49,845 : INFO : Current training batch loss: 0.6093 in epoch 1
2024-08-12 13:06:50,656 : INFO : Current training batch loss: 0.4980 in epoch 1
2024-08-12 13:06:50,802 : INFO : Epoch finished, average loss over training batches: 0.7657
2024-08-12 13:06:50,802 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:50,802 : INFO : Training metrics:
2024-08-12 13:06:50,802 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:50,809 : INFO : Accuracy: 0.6651
2024-08-12 13:06:50,809 : INFO : Precision score for label_class 0: 0.3529
2024-08-12 13:06:50,809 : INFO : Precision score for label_class 1: 0.7296
2024-08-12 13:06:50,810 : INFO : Precision score for label_class 2: 0.4993
2024-08-12 13:06:50,810 : INFO : Recall score for label_class 0: 0.0550
2024-08-12 13:06:50,810 : INFO : Recall score for label_class 1: 0.8890
2024-08-12 13:06:50,810 : INFO : Recall score for label_class 2: 0.4474
2024-08-12 13:06:50,810 : INFO : Average F1 score: 0.4562
2024-08-12 13:06:51,090 : INFO : Average loss over validation batches: 0.5647
2024-08-12 13:06:51,090 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:51,090 : INFO : Validation metrics:
2024-08-12 13:06:51,090 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:51,094 : INFO : Accuracy: 0.7552
2024-08-12 13:06:51,094 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:06:51,094 : INFO : Precision score for label_class 1: 0.8942
2024-08-12 13:06:51,094 : INFO : Precision score for label_class 2: 0.5777
2024-08-12 13:06:51,094 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:06:51,094 : INFO : Recall score for label_class 1: 0.8667
2024-08-12 13:06:51,094 : INFO : Recall score for label_class 2: 0.8680
2024-08-12 13:06:51,094 : INFO : Average F1 score: 0.5246
2024-08-12 13:06:51,094 : INFO : Validation metric decreased (inf --> 0.564714).  Saving model ...
2024-08-12 13:06:51,200 : INFO : Starting epoch 2
2024-08-12 13:06:51,849 : INFO : Current training batch loss: 0.5334 in epoch 2
2024-08-12 13:06:52,659 : INFO : Current training batch loss: 0.2632 in epoch 2
2024-08-12 13:06:53,470 : INFO : Current training batch loss: 0.2216 in epoch 2
2024-08-12 13:06:54,281 : INFO : Current training batch loss: 0.3736 in epoch 2
2024-08-12 13:06:54,629 : INFO : Epoch finished, average loss over training batches: 0.4039
2024-08-12 13:06:54,629 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:54,629 : INFO : Training metrics:
2024-08-12 13:06:54,629 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:54,633 : INFO : Accuracy: 0.8588
2024-08-12 13:06:54,633 : INFO : Precision score for label_class 0: 0.7619
2024-08-12 13:06:54,633 : INFO : Precision score for label_class 1: 0.8977
2024-08-12 13:06:54,633 : INFO : Precision score for label_class 2: 0.8104
2024-08-12 13:06:54,633 : INFO : Recall score for label_class 0: 0.7339
2024-08-12 13:06:54,633 : INFO : Recall score for label_class 1: 0.9260
2024-08-12 13:06:54,633 : INFO : Recall score for label_class 2: 0.7683
2024-08-12 13:06:54,633 : INFO : Average F1 score: 0.8160
2024-08-12 13:06:54,913 : INFO : Average loss over validation batches: 0.4185
2024-08-12 13:06:54,914 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:54,914 : INFO : Validation metrics:
2024-08-12 13:06:54,914 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:54,917 : INFO : Accuracy: 0.8457
2024-08-12 13:06:54,917 : INFO : Precision score for label_class 0: 0.7033
2024-08-12 13:06:54,917 : INFO : Precision score for label_class 1: 0.8824
2024-08-12 13:06:54,917 : INFO : Precision score for label_class 2: 0.8343
2024-08-12 13:06:54,917 : INFO : Recall score for label_class 0: 0.7356
2024-08-12 13:06:54,917 : INFO : Recall score for label_class 1: 0.9231
2024-08-12 13:06:54,917 : INFO : Recall score for label_class 2: 0.7411
2024-08-12 13:06:54,917 : INFO : Average F1 score: 0.8021
2024-08-12 13:06:54,917 : INFO : Validation metric decreased (0.564714 --> 0.418517).  Saving model ...
2024-08-12 13:06:55,015 : INFO : Starting epoch 3
2024-08-12 13:06:55,461 : INFO : Current training batch loss: 0.2773 in epoch 3
2024-08-12 13:06:56,272 : INFO : Current training batch loss: 0.2903 in epoch 3
2024-08-12 13:06:57,083 : INFO : Current training batch loss: 0.0762 in epoch 3
2024-08-12 13:06:57,893 : INFO : Current training batch loss: 0.1026 in epoch 3
2024-08-12 13:06:58,443 : INFO : Epoch finished, average loss over training batches: 0.2109
2024-08-12 13:06:58,444 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:58,444 : INFO : Training metrics:
2024-08-12 13:06:58,444 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:58,451 : INFO : Accuracy: 0.9340
2024-08-12 13:06:58,451 : INFO : Precision score for label_class 0: 0.8494
2024-08-12 13:06:58,451 : INFO : Precision score for label_class 1: 0.9594
2024-08-12 13:06:58,451 : INFO : Precision score for label_class 2: 0.9182
2024-08-12 13:06:58,451 : INFO : Recall score for label_class 0: 0.9144
2024-08-12 13:06:58,451 : INFO : Recall score for label_class 1: 0.9624
2024-08-12 13:06:58,451 : INFO : Recall score for label_class 2: 0.8815
2024-08-12 13:06:58,451 : INFO : Average F1 score: 0.9137
2024-08-12 13:06:58,731 : INFO : Average loss over validation batches: 0.4000
2024-08-12 13:06:58,731 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:58,731 : INFO : Validation metrics:
2024-08-12 13:06:58,731 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:06:58,735 : INFO : Accuracy: 0.8635
2024-08-12 13:06:58,735 : INFO : Precision score for label_class 0: 0.7857
2024-08-12 13:06:58,735 : INFO : Precision score for label_class 1: 0.8777
2024-08-12 13:06:58,735 : INFO : Precision score for label_class 2: 0.8671
2024-08-12 13:06:58,735 : INFO : Recall score for label_class 0: 0.7586
2024-08-12 13:06:58,735 : INFO : Recall score for label_class 1: 0.9385
2024-08-12 13:06:58,735 : INFO : Recall score for label_class 2: 0.7614
2024-08-12 13:06:58,735 : INFO : Average F1 score: 0.8299
2024-08-12 13:06:58,735 : INFO : Validation metric decreased (0.418517 --> 0.400018).  Saving model ...
2024-08-12 13:06:58,834 : INFO : Starting epoch 4
2024-08-12 13:06:59,079 : INFO : Current training batch loss: 0.2531 in epoch 4
2024-08-12 13:06:59,889 : INFO : Current training batch loss: 0.1739 in epoch 4
2024-08-12 13:07:00,700 : INFO : Current training batch loss: 0.0645 in epoch 4
2024-08-12 13:07:01,511 : INFO : Current training batch loss: 0.1595 in epoch 4
2024-08-12 13:07:02,264 : INFO : Epoch finished, average loss over training batches: 0.1235
2024-08-12 13:07:02,264 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:02,264 : INFO : Training metrics:
2024-08-12 13:07:02,264 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:02,271 : INFO : Accuracy: 0.9615
2024-08-12 13:07:02,271 : INFO : Precision score for label_class 0: 0.8983
2024-08-12 13:07:02,271 : INFO : Precision score for label_class 1: 0.9742
2024-08-12 13:07:02,271 : INFO : Precision score for label_class 2: 0.9628
2024-08-12 13:07:02,271 : INFO : Recall score for label_class 0: 0.9450
2024-08-12 13:07:02,271 : INFO : Recall score for label_class 1: 0.9796
2024-08-12 13:07:02,271 : INFO : Recall score for label_class 2: 0.9294
2024-08-12 13:07:02,271 : INFO : Average F1 score: 0.9479
2024-08-12 13:07:02,551 : INFO : Average loss over validation batches: 0.5628
2024-08-12 13:07:02,551 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:02,551 : INFO : Validation metrics:
2024-08-12 13:07:02,551 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:02,555 : INFO : Accuracy: 0.8353
2024-08-12 13:07:02,555 : INFO : Precision score for label_class 0: 0.6893
2024-08-12 13:07:02,555 : INFO : Precision score for label_class 1: 0.9420
2024-08-12 13:07:02,555 : INFO : Precision score for label_class 2: 0.7389
2024-08-12 13:07:02,555 : INFO : Recall score for label_class 0: 0.8161
2024-08-12 13:07:02,555 : INFO : Recall score for label_class 1: 0.8333
2024-08-12 13:07:02,555 : INFO : Recall score for label_class 2: 0.8477
2024-08-12 13:07:02,555 : INFO : Average F1 score: 0.8071
2024-08-12 13:07:02,555 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 13:07:02,555 : INFO : Starting epoch 5
2024-08-12 13:07:02,596 : INFO : Current training batch loss: 0.0841 in epoch 5
2024-08-12 13:07:03,407 : INFO : Current training batch loss: 0.1360 in epoch 5
2024-08-12 13:07:04,217 : INFO : Current training batch loss: 0.0243 in epoch 5
2024-08-12 13:07:05,028 : INFO : Current training batch loss: 0.0208 in epoch 5
2024-08-12 13:07:05,839 : INFO : Current training batch loss: 0.1132 in epoch 5
2024-08-12 13:07:05,985 : INFO : Epoch finished, average loss over training batches: 0.0865
2024-08-12 13:07:05,985 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:05,985 : INFO : Training metrics:
2024-08-12 13:07:05,985 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:05,992 : INFO : Accuracy: 0.9737
2024-08-12 13:07:05,992 : INFO : Precision score for label_class 0: 0.9371
2024-08-12 13:07:05,992 : INFO : Precision score for label_class 1: 0.9846
2024-08-12 13:07:05,992 : INFO : Precision score for label_class 2: 0.9664
2024-08-12 13:07:05,992 : INFO : Recall score for label_class 0: 0.9572
2024-08-12 13:07:05,992 : INFO : Recall score for label_class 1: 0.9846
2024-08-12 13:07:05,992 : INFO : Recall score for label_class 2: 0.9574
2024-08-12 13:07:05,992 : INFO : Average F1 score: 0.9645
2024-08-12 13:07:06,272 : INFO : Average loss over validation batches: 0.4629
2024-08-12 13:07:06,272 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:06,272 : INFO : Validation metrics:
2024-08-12 13:07:06,272 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:06,276 : INFO : Accuracy: 0.8665
2024-08-12 13:07:06,276 : INFO : Precision score for label_class 0: 0.8023
2024-08-12 13:07:06,276 : INFO : Precision score for label_class 1: 0.9138
2024-08-12 13:07:06,276 : INFO : Precision score for label_class 2: 0.8049
2024-08-12 13:07:06,276 : INFO : Recall score for label_class 0: 0.7931
2024-08-12 13:07:06,276 : INFO : Recall score for label_class 1: 0.8974
2024-08-12 13:07:06,276 : INFO : Recall score for label_class 2: 0.8376
2024-08-12 13:07:06,276 : INFO : Average F1 score: 0.8414
2024-08-12 13:07:06,276 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 13:07:06,276 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:07:06,317 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 13:07:06,631 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:06,631 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 13:07:06,631 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:06,635 : INFO : Accuracy: 0.8635
2024-08-12 13:07:06,635 : INFO : Precision score for label_class 0: 0.7857
2024-08-12 13:07:06,635 : INFO : Precision score for label_class 1: 0.8777
2024-08-12 13:07:06,635 : INFO : Precision score for label_class 2: 0.8671
2024-08-12 13:07:06,635 : INFO : Recall score for label_class 0: 0.7586
2024-08-12 13:07:06,635 : INFO : Recall score for label_class 1: 0.9385
2024-08-12 13:07:06,635 : INFO : Recall score for label_class 2: 0.7614
2024-08-12 13:07:06,635 : INFO : Average F1 score: 0.8299
2024-08-12 13:07:06,635 : INFO : Determined score from best model, ending training.
2024-08-12 13:07:06,637 : INFO : Split 4 is finished, the score is: 0.8299
2024-08-12 13:07:06,637 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:06,637 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:06,637 : INFO : Starting training for split 5
2024-08-12 13:07:06,653 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 330, 1615,  754]))
2024-08-12 13:07:06,655 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 84, 396, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:07:06,709 : INFO : Starting epoch 1
2024-08-12 13:07:06,751 : INFO : Current training batch loss: 1.1188 in epoch 1
2024-08-12 13:07:07,562 : INFO : Current training batch loss: 0.9777 in epoch 1
2024-08-12 13:07:08,373 : INFO : Current training batch loss: 0.6484 in epoch 1
2024-08-12 13:07:09,183 : INFO : Current training batch loss: 0.6058 in epoch 1
2024-08-12 13:07:09,994 : INFO : Current training batch loss: 0.4610 in epoch 1
2024-08-12 13:07:10,140 : INFO : Epoch finished, average loss over training batches: 0.7467
2024-08-12 13:07:10,140 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:10,140 : INFO : Training metrics:
2024-08-12 13:07:10,140 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:10,151 : INFO : Accuracy: 0.6840
2024-08-12 13:07:10,151 : INFO : Precision score for label_class 0: 0.4948
2024-08-12 13:07:10,151 : INFO : Precision score for label_class 1: 0.7488
2024-08-12 13:07:10,151 : INFO : Precision score for label_class 2: 0.5408
2024-08-12 13:07:10,151 : INFO : Recall score for label_class 0: 0.1455
2024-08-12 13:07:10,151 : INFO : Recall score for label_class 1: 0.8712
2024-08-12 13:07:10,151 : INFO : Recall score for label_class 2: 0.5186
2024-08-12 13:07:10,151 : INFO : Average F1 score: 0.5199
2024-08-12 13:07:10,431 : INFO : Average loss over validation batches: 0.4955
2024-08-12 13:07:10,431 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:10,431 : INFO : Validation metrics:
2024-08-12 13:07:10,431 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:10,435 : INFO : Accuracy: 0.8205
2024-08-12 13:07:10,435 : INFO : Precision score for label_class 0: 0.7429
2024-08-12 13:07:10,435 : INFO : Precision score for label_class 1: 0.8390
2024-08-12 13:07:10,435 : INFO : Precision score for label_class 2: 0.8037
2024-08-12 13:07:10,435 : INFO : Recall score for label_class 0: 0.6190
2024-08-12 13:07:10,435 : INFO : Recall score for label_class 1: 0.9343
2024-08-12 13:07:10,435 : INFO : Recall score for label_class 2: 0.6753
2024-08-12 13:07:10,435 : INFO : Average F1 score: 0.7644
2024-08-12 13:07:10,435 : INFO : Validation metric decreased (inf --> 0.495492).  Saving model ...
2024-08-12 13:07:10,544 : INFO : Starting epoch 2
2024-08-12 13:07:11,193 : INFO : Current training batch loss: 0.4906 in epoch 2
2024-08-12 13:07:12,002 : INFO : Current training batch loss: 0.2786 in epoch 2
2024-08-12 13:07:12,812 : INFO : Current training batch loss: 0.2190 in epoch 2
2024-08-12 13:07:13,623 : INFO : Current training batch loss: 0.5173 in epoch 2
2024-08-12 13:07:13,967 : INFO : Epoch finished, average loss over training batches: 0.3696
2024-08-12 13:07:13,967 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:13,967 : INFO : Training metrics:
2024-08-12 13:07:13,967 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:13,978 : INFO : Accuracy: 0.8729
2024-08-12 13:07:13,978 : INFO : Precision score for label_class 0: 0.7874
2024-08-12 13:07:13,978 : INFO : Precision score for label_class 1: 0.9055
2024-08-12 13:07:13,978 : INFO : Precision score for label_class 2: 0.8375
2024-08-12 13:07:13,978 : INFO : Recall score for label_class 0: 0.7970
2024-08-12 13:07:13,978 : INFO : Recall score for label_class 1: 0.9257
2024-08-12 13:07:13,978 : INFO : Recall score for label_class 2: 0.7931
2024-08-12 13:07:13,978 : INFO : Average F1 score: 0.8408
2024-08-12 13:07:14,257 : INFO : Average loss over validation batches: 0.4509
2024-08-12 13:07:14,258 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:14,258 : INFO : Validation metrics:
2024-08-12 13:07:14,258 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:14,262 : INFO : Accuracy: 0.8294
2024-08-12 13:07:14,262 : INFO : Precision score for label_class 0: 0.8060
2024-08-12 13:07:14,262 : INFO : Precision score for label_class 1: 0.8462
2024-08-12 13:07:14,262 : INFO : Precision score for label_class 2: 0.7939
2024-08-12 13:07:14,262 : INFO : Recall score for label_class 0: 0.6429
2024-08-12 13:07:14,262 : INFO : Recall score for label_class 1: 0.9444
2024-08-12 13:07:14,262 : INFO : Recall score for label_class 2: 0.6753
2024-08-12 13:07:14,262 : INFO : Average F1 score: 0.7792
2024-08-12 13:07:14,262 : INFO : Validation metric decreased (0.495492 --> 0.450871).  Saving model ...
2024-08-12 13:07:14,362 : INFO : Starting epoch 3
2024-08-12 13:07:14,805 : INFO : Current training batch loss: 0.2034 in epoch 3
2024-08-12 13:07:15,610 : INFO : Current training batch loss: 0.3650 in epoch 3
2024-08-12 13:07:16,416 : INFO : Current training batch loss: 0.1286 in epoch 3
2024-08-12 13:07:17,221 : INFO : Current training batch loss: 0.1346 in epoch 3
2024-08-12 13:07:17,764 : INFO : Epoch finished, average loss over training batches: 0.2071
2024-08-12 13:07:17,764 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:17,764 : INFO : Training metrics:
2024-08-12 13:07:17,764 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:17,774 : INFO : Accuracy: 0.9340
2024-08-12 13:07:17,775 : INFO : Precision score for label_class 0: 0.8717
2024-08-12 13:07:17,775 : INFO : Precision score for label_class 1: 0.9580
2024-08-12 13:07:17,775 : INFO : Precision score for label_class 2: 0.9104
2024-08-12 13:07:17,775 : INFO : Recall score for label_class 0: 0.9061
2024-08-12 13:07:17,775 : INFO : Recall score for label_class 1: 0.9604
2024-08-12 13:07:17,775 : INFO : Recall score for label_class 2: 0.8899
2024-08-12 13:07:17,775 : INFO : Average F1 score: 0.9159
2024-08-12 13:07:18,055 : INFO : Average loss over validation batches: 0.4190
2024-08-12 13:07:18,055 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:18,055 : INFO : Validation metrics:
2024-08-12 13:07:18,055 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:18,059 : INFO : Accuracy: 0.8457
2024-08-12 13:07:18,059 : INFO : Precision score for label_class 0: 0.7791
2024-08-12 13:07:18,059 : INFO : Precision score for label_class 1: 0.8917
2024-08-12 13:07:18,059 : INFO : Precision score for label_class 2: 0.7801
2024-08-12 13:07:18,059 : INFO : Recall score for label_class 0: 0.7976
2024-08-12 13:07:18,059 : INFO : Recall score for label_class 1: 0.8939
2024-08-12 13:07:18,059 : INFO : Recall score for label_class 2: 0.7680
2024-08-12 13:07:18,059 : INFO : Average F1 score: 0.8184
2024-08-12 13:07:18,059 : INFO : Validation metric decreased (0.450871 --> 0.419002).  Saving model ...
2024-08-12 13:07:18,160 : INFO : Starting epoch 4
2024-08-12 13:07:18,402 : INFO : Current training batch loss: 0.2635 in epoch 4
2024-08-12 13:07:19,208 : INFO : Current training batch loss: 0.1476 in epoch 4
2024-08-12 13:07:20,014 : INFO : Current training batch loss: 0.0374 in epoch 4
2024-08-12 13:07:20,819 : INFO : Current training batch loss: 0.0238 in epoch 4
2024-08-12 13:07:21,563 : INFO : Epoch finished, average loss over training batches: 0.1119
2024-08-12 13:07:21,564 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:21,564 : INFO : Training metrics:
2024-08-12 13:07:21,564 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:21,571 : INFO : Accuracy: 0.9681
2024-08-12 13:07:21,571 : INFO : Precision score for label_class 0: 0.9135
2024-08-12 13:07:21,571 : INFO : Precision score for label_class 1: 0.9801
2024-08-12 13:07:21,571 : INFO : Precision score for label_class 2: 0.9676
2024-08-12 13:07:21,571 : INFO : Recall score for label_class 0: 0.9606
2024-08-12 13:07:21,571 : INFO : Recall score for label_class 1: 0.9783
2024-08-12 13:07:21,571 : INFO : Recall score for label_class 2: 0.9496
2024-08-12 13:07:21,571 : INFO : Average F1 score: 0.9581
2024-08-12 13:07:21,851 : INFO : Average loss over validation batches: 0.4507
2024-08-12 13:07:21,851 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:21,851 : INFO : Validation metrics:
2024-08-12 13:07:21,851 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:21,855 : INFO : Accuracy: 0.8531
2024-08-12 13:07:21,855 : INFO : Precision score for label_class 0: 0.7527
2024-08-12 13:07:21,855 : INFO : Precision score for label_class 1: 0.9005
2024-08-12 13:07:21,855 : INFO : Precision score for label_class 2: 0.8042
2024-08-12 13:07:21,855 : INFO : Recall score for label_class 0: 0.8333
2024-08-12 13:07:21,855 : INFO : Recall score for label_class 1: 0.8914
2024-08-12 13:07:21,855 : INFO : Recall score for label_class 2: 0.7835
2024-08-12 13:07:21,855 : INFO : Average F1 score: 0.8269
2024-08-12 13:07:21,855 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 13:07:21,855 : INFO : Starting epoch 5
2024-08-12 13:07:21,896 : INFO : Current training batch loss: 0.0197 in epoch 5
2024-08-12 13:07:22,701 : INFO : Current training batch loss: 0.0738 in epoch 5
2024-08-12 13:07:23,507 : INFO : Current training batch loss: 0.0199 in epoch 5
2024-08-12 13:07:24,313 : INFO : Current training batch loss: 0.0670 in epoch 5
2024-08-12 13:07:25,119 : INFO : Current training batch loss: 0.0149 in epoch 5
2024-08-12 13:07:25,260 : INFO : Epoch finished, average loss over training batches: 0.0589
2024-08-12 13:07:25,261 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:25,261 : INFO : Training metrics:
2024-08-12 13:07:25,261 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:25,268 : INFO : Accuracy: 0.9830
2024-08-12 13:07:25,268 : INFO : Precision score for label_class 0: 0.9440
2024-08-12 13:07:25,268 : INFO : Precision score for label_class 1: 0.9907
2024-08-12 13:07:25,268 : INFO : Precision score for label_class 2: 0.9839
2024-08-12 13:07:25,268 : INFO : Recall score for label_class 0: 0.9697
2024-08-12 13:07:25,268 : INFO : Recall score for label_class 1: 0.9901
2024-08-12 13:07:25,268 : INFO : Recall score for label_class 2: 0.9735
2024-08-12 13:07:25,268 : INFO : Average F1 score: 0.9752
2024-08-12 13:07:25,548 : INFO : Average loss over validation batches: 0.5530
2024-08-12 13:07:25,548 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:25,548 : INFO : Validation metrics:
2024-08-12 13:07:25,548 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:25,552 : INFO : Accuracy: 0.8501
2024-08-12 13:07:25,552 : INFO : Precision score for label_class 0: 0.7245
2024-08-12 13:07:25,552 : INFO : Precision score for label_class 1: 0.8892
2024-08-12 13:07:25,552 : INFO : Precision score for label_class 2: 0.8294
2024-08-12 13:07:25,552 : INFO : Recall score for label_class 0: 0.8452
2024-08-12 13:07:25,552 : INFO : Recall score for label_class 1: 0.9116
2024-08-12 13:07:25,552 : INFO : Recall score for label_class 2: 0.7268
2024-08-12 13:07:25,552 : INFO : Average F1 score: 0.8184
2024-08-12 13:07:25,552 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 13:07:25,552 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:07:25,590 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 13:07:25,905 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:25,905 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 13:07:25,905 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:25,908 : INFO : Accuracy: 0.8457
2024-08-12 13:07:25,908 : INFO : Precision score for label_class 0: 0.7791
2024-08-12 13:07:25,908 : INFO : Precision score for label_class 1: 0.8917
2024-08-12 13:07:25,908 : INFO : Precision score for label_class 2: 0.7801
2024-08-12 13:07:25,908 : INFO : Recall score for label_class 0: 0.7976
2024-08-12 13:07:25,908 : INFO : Recall score for label_class 1: 0.8939
2024-08-12 13:07:25,908 : INFO : Recall score for label_class 2: 0.7680
2024-08-12 13:07:25,909 : INFO : Average F1 score: 0.8184
2024-08-12 13:07:25,909 : INFO : Determined score from best model, ending training.
2024-08-12 13:07:25,915 : INFO : Split 5 is finished, the score is: 0.8184
2024-08-12 13:07:25,916 : INFO : ----------------------------------------------------------------------------------------------------
[I 2024-08-12 13:07:25,916] Trial 12 finished with value: 0.8327451745001018 and parameters: {'n_epochs': 8, 'learning_rate': 9.777453689809067e-05, 'classifier_dropout': 0.3927719437449689, 'warmup_step_fraction': 0.028275159428402866, 'use_gradient_clipping': False}. Best is trial 6 with value: 0.8419854360165029.
2024-08-12 13:07:25,924 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:25,924 : INFO : Starting training for split 1
2024-08-12 13:07:25,935 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 328, 1596,  774]))
2024-08-12 13:07:25,937 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 86, 415, 174]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:07:25,985 : INFO : Starting epoch 1
2024-08-12 13:07:26,027 : INFO : Current training batch loss: 1.1144 in epoch 1
2024-08-12 13:07:26,833 : INFO : Current training batch loss: 0.9353 in epoch 1
2024-08-12 13:07:27,639 : INFO : Current training batch loss: 0.8946 in epoch 1
2024-08-12 13:07:28,445 : INFO : Current training batch loss: 0.6717 in epoch 1
2024-08-12 13:07:29,250 : INFO : Current training batch loss: 0.6679 in epoch 1
2024-08-12 13:07:29,391 : INFO : Epoch finished, average loss over training batches: 0.8385
2024-08-12 13:07:29,392 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:29,392 : INFO : Training metrics:
2024-08-12 13:07:29,392 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:29,400 : INFO : Accuracy: 0.6201
2024-08-12 13:07:29,400 : INFO : Precision score for label_class 0: 0.1734
2024-08-12 13:07:29,400 : INFO : Precision score for label_class 1: 0.6944
2024-08-12 13:07:29,400 : INFO : Precision score for label_class 2: 0.5490
2024-08-12 13:07:29,400 : INFO : Recall score for label_class 0: 0.1433
2024-08-12 13:07:29,400 : INFO : Recall score for label_class 1: 0.8784
2024-08-12 13:07:29,400 : INFO : Recall score for label_class 2: 0.2894
2024-08-12 13:07:29,400 : INFO : Average F1 score: 0.4372
2024-08-12 13:07:29,679 : INFO : Average loss over validation batches: 0.6074
2024-08-12 13:07:29,680 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:29,680 : INFO : Validation metrics:
2024-08-12 13:07:29,680 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:29,682 : INFO : Accuracy: 0.7200
2024-08-12 13:07:29,682 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:07:29,682 : INFO : Precision score for label_class 1: 0.8945
2024-08-12 13:07:29,682 : INFO : Precision score for label_class 2: 0.4983
2024-08-12 13:07:29,682 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:07:29,682 : INFO : Recall score for label_class 1: 0.8169
2024-08-12 13:07:29,682 : INFO : Recall score for label_class 2: 0.8448
2024-08-12 13:07:29,682 : INFO : Average F1 score: 0.4936
2024-08-12 13:07:29,682 : INFO : Validation metric decreased (inf --> 0.607371).  Saving model ...
2024-08-12 13:07:29,792 : INFO : Starting epoch 2
2024-08-12 13:07:30,436 : INFO : Current training batch loss: 0.2580 in epoch 2
2024-08-12 13:07:31,241 : INFO : Current training batch loss: 0.5661 in epoch 2
2024-08-12 13:07:32,046 : INFO : Current training batch loss: 0.3669 in epoch 2
2024-08-12 13:07:32,851 : INFO : Current training batch loss: 0.3505 in epoch 2
2024-08-12 13:07:33,193 : INFO : Epoch finished, average loss over training batches: 0.4097
2024-08-12 13:07:33,194 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:33,194 : INFO : Training metrics:
2024-08-12 13:07:33,194 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:33,198 : INFO : Accuracy: 0.8606
2024-08-12 13:07:33,198 : INFO : Precision score for label_class 0: 0.7579
2024-08-12 13:07:33,198 : INFO : Precision score for label_class 1: 0.8924
2024-08-12 13:07:33,198 : INFO : Precision score for label_class 2: 0.8331
2024-08-12 13:07:33,198 : INFO : Recall score for label_class 0: 0.7348
2024-08-12 13:07:33,198 : INFO : Recall score for label_class 1: 0.9254
2024-08-12 13:07:33,198 : INFO : Recall score for label_class 2: 0.7804
2024-08-12 13:07:33,198 : INFO : Average F1 score: 0.8202
2024-08-12 13:07:33,478 : INFO : Average loss over validation batches: 0.3619
2024-08-12 13:07:33,478 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:33,478 : INFO : Validation metrics:
2024-08-12 13:07:33,478 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:33,481 : INFO : Accuracy: 0.8726
2024-08-12 13:07:33,481 : INFO : Precision score for label_class 0: 0.7789
2024-08-12 13:07:33,481 : INFO : Precision score for label_class 1: 0.9259
2024-08-12 13:07:33,481 : INFO : Precision score for label_class 2: 0.8000
2024-08-12 13:07:33,481 : INFO : Recall score for label_class 0: 0.8605
2024-08-12 13:07:33,481 : INFO : Recall score for label_class 1: 0.9036
2024-08-12 13:07:33,481 : INFO : Recall score for label_class 2: 0.8046
2024-08-12 13:07:33,481 : INFO : Average F1 score: 0.8449
2024-08-12 13:07:33,481 : INFO : Validation metric decreased (0.607371 --> 0.361863).  Saving model ...
2024-08-12 13:07:33,581 : INFO : Starting epoch 3
2024-08-12 13:07:34,025 : INFO : Current training batch loss: 0.2317 in epoch 3
2024-08-12 13:07:34,831 : INFO : Current training batch loss: 0.3212 in epoch 3
2024-08-12 13:07:35,637 : INFO : Current training batch loss: 0.1949 in epoch 3
2024-08-12 13:07:36,443 : INFO : Current training batch loss: 0.2109 in epoch 3
2024-08-12 13:07:36,986 : INFO : Epoch finished, average loss over training batches: 0.2333
2024-08-12 13:07:36,986 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:36,986 : INFO : Training metrics:
2024-08-12 13:07:36,986 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:36,992 : INFO : Accuracy: 0.9248
2024-08-12 13:07:36,992 : INFO : Precision score for label_class 0: 0.8457
2024-08-12 13:07:36,992 : INFO : Precision score for label_class 1: 0.9512
2024-08-12 13:07:36,992 : INFO : Precision score for label_class 2: 0.9052
2024-08-12 13:07:36,992 : INFO : Recall score for label_class 0: 0.9024
2024-08-12 13:07:36,992 : INFO : Recall score for label_class 1: 0.9530
2024-08-12 13:07:36,992 : INFO : Recall score for label_class 2: 0.8760
2024-08-12 13:07:36,992 : INFO : Average F1 score: 0.9052
2024-08-12 13:07:37,271 : INFO : Average loss over validation batches: 0.3512
2024-08-12 13:07:37,271 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:37,271 : INFO : Validation metrics:
2024-08-12 13:07:37,271 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:37,275 : INFO : Accuracy: 0.8756
2024-08-12 13:07:37,275 : INFO : Precision score for label_class 0: 0.8272
2024-08-12 13:07:37,275 : INFO : Precision score for label_class 1: 0.9119
2024-08-12 13:07:37,275 : INFO : Precision score for label_class 2: 0.8103
2024-08-12 13:07:37,275 : INFO : Recall score for label_class 0: 0.7791
2024-08-12 13:07:37,275 : INFO : Recall score for label_class 1: 0.9229
2024-08-12 13:07:37,275 : INFO : Recall score for label_class 2: 0.8103
2024-08-12 13:07:37,275 : INFO : Average F1 score: 0.8434
2024-08-12 13:07:37,275 : INFO : Validation metric decreased (0.361863 --> 0.351243).  Saving model ...
2024-08-12 13:07:37,377 : INFO : Starting epoch 4
2024-08-12 13:07:37,620 : INFO : Current training batch loss: 0.3672 in epoch 4
2024-08-12 13:07:38,426 : INFO : Current training batch loss: 0.0867 in epoch 4
2024-08-12 13:07:39,232 : INFO : Current training batch loss: 0.2385 in epoch 4
2024-08-12 13:07:40,038 : INFO : Current training batch loss: 0.1564 in epoch 4
2024-08-12 13:07:40,782 : INFO : Epoch finished, average loss over training batches: 0.1400
2024-08-12 13:07:40,782 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:40,782 : INFO : Training metrics:
2024-08-12 13:07:40,782 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:40,790 : INFO : Accuracy: 0.9611
2024-08-12 13:07:40,790 : INFO : Precision score for label_class 0: 0.8960
2024-08-12 13:07:40,790 : INFO : Precision score for label_class 1: 0.9750
2024-08-12 13:07:40,790 : INFO : Precision score for label_class 2: 0.9614
2024-08-12 13:07:40,790 : INFO : Recall score for label_class 0: 0.9451
2024-08-12 13:07:40,790 : INFO : Recall score for label_class 1: 0.9774
2024-08-12 13:07:40,790 : INFO : Recall score for label_class 2: 0.9341
2024-08-12 13:07:40,790 : INFO : Average F1 score: 0.9479
2024-08-12 13:07:41,070 : INFO : Average loss over validation batches: 0.3418
2024-08-12 13:07:41,070 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:41,070 : INFO : Validation metrics:
2024-08-12 13:07:41,070 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:41,073 : INFO : Accuracy: 0.8904
2024-08-12 13:07:41,073 : INFO : Precision score for label_class 0: 0.7822
2024-08-12 13:07:41,073 : INFO : Precision score for label_class 1: 0.9400
2024-08-12 13:07:41,073 : INFO : Precision score for label_class 2: 0.8391
2024-08-12 13:07:41,073 : INFO : Recall score for label_class 0: 0.9186
2024-08-12 13:07:41,073 : INFO : Recall score for label_class 1: 0.9060
2024-08-12 13:07:41,073 : INFO : Recall score for label_class 2: 0.8391
2024-08-12 13:07:41,073 : INFO : Average F1 score: 0.8689
2024-08-12 13:07:41,073 : INFO : Validation metric decreased (0.351243 --> 0.341771).  Saving model ...
2024-08-12 13:07:41,174 : INFO : Starting epoch 5
2024-08-12 13:07:41,216 : INFO : Current training batch loss: 0.0329 in epoch 5
2024-08-12 13:07:42,021 : INFO : Current training batch loss: 0.0395 in epoch 5
2024-08-12 13:07:42,827 : INFO : Current training batch loss: 0.0351 in epoch 5
2024-08-12 13:07:43,634 : INFO : Current training batch loss: 0.0532 in epoch 5
2024-08-12 13:07:44,441 : INFO : Current training batch loss: 0.1612 in epoch 5
2024-08-12 13:07:44,582 : INFO : Epoch finished, average loss over training batches: 0.0815
2024-08-12 13:07:44,582 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:44,582 : INFO : Training metrics:
2024-08-12 13:07:44,582 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:44,587 : INFO : Accuracy: 0.9789
2024-08-12 13:07:44,587 : INFO : Precision score for label_class 0: 0.9275
2024-08-12 13:07:44,587 : INFO : Precision score for label_class 1: 0.9887
2024-08-12 13:07:44,587 : INFO : Precision score for label_class 2: 0.9815
2024-08-12 13:07:44,587 : INFO : Recall score for label_class 0: 0.9756
2024-08-12 13:07:44,587 : INFO : Recall score for label_class 1: 0.9887
2024-08-12 13:07:44,587 : INFO : Recall score for label_class 2: 0.9599
2024-08-12 13:07:44,587 : INFO : Average F1 score: 0.9701
2024-08-12 13:07:44,866 : INFO : Average loss over validation batches: 0.3520
2024-08-12 13:07:44,867 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:44,867 : INFO : Validation metrics:
2024-08-12 13:07:44,867 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:44,870 : INFO : Accuracy: 0.8963
2024-08-12 13:07:44,870 : INFO : Precision score for label_class 0: 0.7778
2024-08-12 13:07:44,870 : INFO : Precision score for label_class 1: 0.9262
2024-08-12 13:07:44,870 : INFO : Precision score for label_class 2: 0.8910
2024-08-12 13:07:44,870 : INFO : Recall score for label_class 0: 0.8953
2024-08-12 13:07:44,870 : INFO : Recall score for label_class 1: 0.9373
2024-08-12 13:07:44,870 : INFO : Recall score for label_class 2: 0.7989
2024-08-12 13:07:44,870 : INFO : Average F1 score: 0.8689
2024-08-12 13:07:44,870 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 13:07:44,870 : INFO : Starting epoch 6
2024-08-12 13:07:45,514 : INFO : Current training batch loss: 0.0180 in epoch 6
2024-08-12 13:07:46,320 : INFO : Current training batch loss: 0.0197 in epoch 6
2024-08-12 13:07:47,126 : INFO : Current training batch loss: 0.0189 in epoch 6
2024-08-12 13:07:47,931 : INFO : Current training batch loss: 0.0147 in epoch 6
2024-08-12 13:07:48,273 : INFO : Epoch finished, average loss over training batches: 0.0552
2024-08-12 13:07:48,274 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:48,274 : INFO : Training metrics:
2024-08-12 13:07:48,274 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:48,279 : INFO : Accuracy: 0.9885
2024-08-12 13:07:48,279 : INFO : Precision score for label_class 0: 0.9446
2024-08-12 13:07:48,279 : INFO : Precision score for label_class 1: 0.9956
2024-08-12 13:07:48,279 : INFO : Precision score for label_class 2: 0.9934
2024-08-12 13:07:48,279 : INFO : Recall score for label_class 0: 0.9878
2024-08-12 13:07:48,279 : INFO : Recall score for label_class 1: 0.9944
2024-08-12 13:07:48,279 : INFO : Recall score for label_class 2: 0.9767
2024-08-12 13:07:48,279 : INFO : Average F1 score: 0.9819
2024-08-12 13:07:48,559 : INFO : Average loss over validation batches: 0.4150
2024-08-12 13:07:48,559 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:48,559 : INFO : Validation metrics:
2024-08-12 13:07:48,559 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:48,562 : INFO : Accuracy: 0.8741
2024-08-12 13:07:48,562 : INFO : Precision score for label_class 0: 0.8023
2024-08-12 13:07:48,562 : INFO : Precision score for label_class 1: 0.8849
2024-08-12 13:07:48,562 : INFO : Precision score for label_class 2: 0.8836
2024-08-12 13:07:48,562 : INFO : Recall score for label_class 0: 0.8023
2024-08-12 13:07:48,562 : INFO : Recall score for label_class 1: 0.9446
2024-08-12 13:07:48,562 : INFO : Recall score for label_class 2: 0.7414
2024-08-12 13:07:48,562 : INFO : Average F1 score: 0.8408
2024-08-12 13:07:48,563 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 13:07:48,563 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:07:48,601 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 13:07:48,910 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:48,910 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 13:07:48,910 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:48,913 : INFO : Accuracy: 0.8904
2024-08-12 13:07:48,913 : INFO : Precision score for label_class 0: 0.7822
2024-08-12 13:07:48,913 : INFO : Precision score for label_class 1: 0.9400
2024-08-12 13:07:48,913 : INFO : Precision score for label_class 2: 0.8391
2024-08-12 13:07:48,913 : INFO : Recall score for label_class 0: 0.9186
2024-08-12 13:07:48,913 : INFO : Recall score for label_class 1: 0.9060
2024-08-12 13:07:48,913 : INFO : Recall score for label_class 2: 0.8391
2024-08-12 13:07:48,913 : INFO : Average F1 score: 0.8689
2024-08-12 13:07:48,913 : INFO : Determined score from best model, ending training.
2024-08-12 13:07:48,915 : INFO : Split 1 is finished, the score is: 0.8689
2024-08-12 13:07:48,915 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:48,915 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:48,915 : INFO : Starting training for split 2
2024-08-12 13:07:48,926 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 343, 1601,  754]))
2024-08-12 13:07:48,928 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 71, 410, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:07:48,968 : INFO : Starting epoch 1
2024-08-12 13:07:49,010 : INFO : Current training batch loss: 1.1163 in epoch 1
2024-08-12 13:07:49,815 : INFO : Current training batch loss: 1.0214 in epoch 1
2024-08-12 13:07:50,621 : INFO : Current training batch loss: 0.8520 in epoch 1
2024-08-12 13:07:51,427 : INFO : Current training batch loss: 0.7311 in epoch 1
2024-08-12 13:07:52,233 : INFO : Current training batch loss: 0.6612 in epoch 1
2024-08-12 13:07:52,374 : INFO : Epoch finished, average loss over training batches: 0.8431
2024-08-12 13:07:52,374 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:52,374 : INFO : Training metrics:
2024-08-12 13:07:52,374 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:52,385 : INFO : Accuracy: 0.6208
2024-08-12 13:07:52,385 : INFO : Precision score for label_class 0: 0.2673
2024-08-12 13:07:52,385 : INFO : Precision score for label_class 1: 0.6944
2024-08-12 13:07:52,385 : INFO : Precision score for label_class 2: 0.4403
2024-08-12 13:07:52,385 : INFO : Recall score for label_class 0: 0.0787
2024-08-12 13:07:52,385 : INFO : Recall score for label_class 1: 0.8613
2024-08-12 13:07:52,385 : INFO : Recall score for label_class 2: 0.3568
2024-08-12 13:07:52,385 : INFO : Average F1 score: 0.4282
2024-08-12 13:07:52,665 : INFO : Average loss over validation batches: 0.5864
2024-08-12 13:07:52,665 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:52,665 : INFO : Validation metrics:
2024-08-12 13:07:52,665 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:52,668 : INFO : Accuracy: 0.7689
2024-08-12 13:07:52,668 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:07:52,668 : INFO : Precision score for label_class 1: 0.8738
2024-08-12 13:07:52,668 : INFO : Precision score for label_class 2: 0.6046
2024-08-12 13:07:52,668 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:07:52,668 : INFO : Recall score for label_class 1: 0.8780
2024-08-12 13:07:52,668 : INFO : Recall score for label_class 2: 0.8196
2024-08-12 13:07:52,668 : INFO : Average F1 score: 0.5239
2024-08-12 13:07:52,668 : INFO : Validation metric decreased (inf --> 0.586430).  Saving model ...
2024-08-12 13:07:52,777 : INFO : Starting epoch 2
2024-08-12 13:07:53,421 : INFO : Current training batch loss: 0.6495 in epoch 2
2024-08-12 13:07:54,227 : INFO : Current training batch loss: 0.5399 in epoch 2
2024-08-12 13:07:55,032 : INFO : Current training batch loss: 0.3524 in epoch 2
2024-08-12 13:07:55,838 : INFO : Current training batch loss: 0.3125 in epoch 2
2024-08-12 13:07:56,180 : INFO : Epoch finished, average loss over training batches: 0.4475
2024-08-12 13:07:56,180 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:56,180 : INFO : Training metrics:
2024-08-12 13:07:56,180 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:56,191 : INFO : Accuracy: 0.8428
2024-08-12 13:07:56,191 : INFO : Precision score for label_class 0: 0.7338
2024-08-12 13:07:56,191 : INFO : Precision score for label_class 1: 0.8908
2024-08-12 13:07:56,191 : INFO : Precision score for label_class 2: 0.7764
2024-08-12 13:07:56,191 : INFO : Recall score for label_class 0: 0.6268
2024-08-12 13:07:56,191 : INFO : Recall score for label_class 1: 0.9325
2024-08-12 13:07:56,191 : INFO : Recall score for label_class 2: 0.7507
2024-08-12 13:07:56,191 : INFO : Average F1 score: 0.7835
2024-08-12 13:07:56,471 : INFO : Average loss over validation batches: 0.3703
2024-08-12 13:07:56,471 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:56,471 : INFO : Validation metrics:
2024-08-12 13:07:56,471 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:56,474 : INFO : Accuracy: 0.8652
2024-08-12 13:07:56,474 : INFO : Precision score for label_class 0: 0.7600
2024-08-12 13:07:56,474 : INFO : Precision score for label_class 1: 0.9089
2024-08-12 13:07:56,474 : INFO : Precision score for label_class 2: 0.8144
2024-08-12 13:07:56,474 : INFO : Recall score for label_class 0: 0.8028
2024-08-12 13:07:56,474 : INFO : Recall score for label_class 1: 0.9000
2024-08-12 13:07:56,474 : INFO : Recall score for label_class 2: 0.8144
2024-08-12 13:07:56,474 : INFO : Average F1 score: 0.8332
2024-08-12 13:07:56,474 : INFO : Validation metric decreased (0.586430 --> 0.370342).  Saving model ...
2024-08-12 13:07:56,574 : INFO : Starting epoch 3
2024-08-12 13:07:57,018 : INFO : Current training batch loss: 0.1929 in epoch 3
2024-08-12 13:07:57,824 : INFO : Current training batch loss: 0.2771 in epoch 3
2024-08-12 13:07:58,630 : INFO : Current training batch loss: 0.3425 in epoch 3
2024-08-12 13:07:59,436 : INFO : Current training batch loss: 0.1834 in epoch 3
2024-08-12 13:07:59,979 : INFO : Epoch finished, average loss over training batches: 0.2463
2024-08-12 13:07:59,979 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:59,979 : INFO : Training metrics:
2024-08-12 13:07:59,979 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:07:59,990 : INFO : Accuracy: 0.9225
2024-08-12 13:07:59,990 : INFO : Precision score for label_class 0: 0.8361
2024-08-12 13:07:59,990 : INFO : Precision score for label_class 1: 0.9484
2024-08-12 13:07:59,990 : INFO : Precision score for label_class 2: 0.9080
2024-08-12 13:07:59,990 : INFO : Recall score for label_class 0: 0.8776
2024-08-12 13:07:59,990 : INFO : Recall score for label_class 1: 0.9538
2024-08-12 13:07:59,990 : INFO : Recall score for label_class 2: 0.8767
2024-08-12 13:07:59,990 : INFO : Average F1 score: 0.8998
2024-08-12 13:08:00,269 : INFO : Average loss over validation batches: 0.3687
2024-08-12 13:08:00,270 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:00,270 : INFO : Validation metrics:
2024-08-12 13:08:00,270 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:00,273 : INFO : Accuracy: 0.8830
2024-08-12 13:08:00,273 : INFO : Precision score for label_class 0: 0.7941
2024-08-12 13:08:00,273 : INFO : Precision score for label_class 1: 0.8894
2024-08-12 13:08:00,273 : INFO : Precision score for label_class 2: 0.9017
2024-08-12 13:08:00,273 : INFO : Recall score for label_class 0: 0.7606
2024-08-12 13:08:00,273 : INFO : Recall score for label_class 1: 0.9415
2024-08-12 13:08:00,273 : INFO : Recall score for label_class 2: 0.8041
2024-08-12 13:08:00,273 : INFO : Average F1 score: 0.8473
2024-08-12 13:08:00,273 : INFO : Validation metric decreased (0.370342 --> 0.368681).  Saving model ...
2024-08-12 13:08:00,375 : INFO : Starting epoch 4
2024-08-12 13:08:00,618 : INFO : Current training batch loss: 0.3263 in epoch 4
2024-08-12 13:08:01,424 : INFO : Current training batch loss: 0.1367 in epoch 4
2024-08-12 13:08:02,230 : INFO : Current training batch loss: 0.1921 in epoch 4
2024-08-12 13:08:03,036 : INFO : Current training batch loss: 0.1948 in epoch 4
2024-08-12 13:08:03,780 : INFO : Epoch finished, average loss over training batches: 0.1572
2024-08-12 13:08:03,780 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:03,780 : INFO : Training metrics:
2024-08-12 13:08:03,780 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:03,788 : INFO : Accuracy: 0.9552
2024-08-12 13:08:03,788 : INFO : Precision score for label_class 0: 0.8989
2024-08-12 13:08:03,788 : INFO : Precision score for label_class 1: 0.9738
2024-08-12 13:08:03,789 : INFO : Precision score for label_class 2: 0.9420
2024-08-12 13:08:03,789 : INFO : Recall score for label_class 0: 0.9329
2024-08-12 13:08:03,789 : INFO : Recall score for label_class 1: 0.9731
2024-08-12 13:08:03,789 : INFO : Recall score for label_class 2: 0.9271
2024-08-12 13:08:03,789 : INFO : Average F1 score: 0.9412
2024-08-12 13:08:04,068 : INFO : Average loss over validation batches: 0.3918
2024-08-12 13:08:04,069 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:04,069 : INFO : Validation metrics:
2024-08-12 13:08:04,069 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:04,072 : INFO : Accuracy: 0.8652
2024-08-12 13:08:04,072 : INFO : Precision score for label_class 0: 0.7910
2024-08-12 13:08:04,072 : INFO : Precision score for label_class 1: 0.8947
2024-08-12 13:08:04,072 : INFO : Precision score for label_class 2: 0.8263
2024-08-12 13:08:04,072 : INFO : Recall score for label_class 0: 0.7465
2024-08-12 13:08:04,072 : INFO : Recall score for label_class 1: 0.9122
2024-08-12 13:08:04,072 : INFO : Recall score for label_class 2: 0.8093
2024-08-12 13:08:04,072 : INFO : Average F1 score: 0.8297
2024-08-12 13:08:04,072 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 13:08:04,072 : INFO : Starting epoch 5
2024-08-12 13:08:04,113 : INFO : Current training batch loss: 0.0590 in epoch 5
2024-08-12 13:08:04,918 : INFO : Current training batch loss: 0.1859 in epoch 5
2024-08-12 13:08:05,724 : INFO : Current training batch loss: 0.0281 in epoch 5
2024-08-12 13:08:06,530 : INFO : Current training batch loss: 0.0506 in epoch 5
2024-08-12 13:08:07,337 : INFO : Current training batch loss: 0.3356 in epoch 5
2024-08-12 13:08:07,478 : INFO : Epoch finished, average loss over training batches: 0.1031
2024-08-12 13:08:07,478 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:07,478 : INFO : Training metrics:
2024-08-12 13:08:07,478 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:07,485 : INFO : Accuracy: 0.9707
2024-08-12 13:08:07,485 : INFO : Precision score for label_class 0: 0.9185
2024-08-12 13:08:07,485 : INFO : Precision score for label_class 1: 0.9825
2024-08-12 13:08:07,485 : INFO : Precision score for label_class 2: 0.9703
2024-08-12 13:08:07,485 : INFO : Recall score for label_class 0: 0.9534
2024-08-12 13:08:07,485 : INFO : Recall score for label_class 1: 0.9831
2024-08-12 13:08:07,485 : INFO : Recall score for label_class 2: 0.9523
2024-08-12 13:08:07,485 : INFO : Average F1 score: 0.9599
2024-08-12 13:08:07,766 : INFO : Average loss over validation batches: 0.4453
2024-08-12 13:08:07,766 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:07,766 : INFO : Validation metrics:
2024-08-12 13:08:07,766 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:07,769 : INFO : Accuracy: 0.8607
2024-08-12 13:08:07,769 : INFO : Precision score for label_class 0: 0.7625
2024-08-12 13:08:07,769 : INFO : Precision score for label_class 1: 0.9245
2024-08-12 13:08:07,769 : INFO : Precision score for label_class 2: 0.7820
2024-08-12 13:08:07,769 : INFO : Recall score for label_class 0: 0.8592
2024-08-12 13:08:07,769 : INFO : Recall score for label_class 1: 0.8659
2024-08-12 13:08:07,769 : INFO : Recall score for label_class 2: 0.8505
2024-08-12 13:08:07,769 : INFO : Average F1 score: 0.8390
2024-08-12 13:08:07,769 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 13:08:07,769 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:08:07,807 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 13:08:08,122 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:08,122 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 13:08:08,122 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:08,125 : INFO : Accuracy: 0.8830
2024-08-12 13:08:08,125 : INFO : Precision score for label_class 0: 0.7941
2024-08-12 13:08:08,125 : INFO : Precision score for label_class 1: 0.8894
2024-08-12 13:08:08,125 : INFO : Precision score for label_class 2: 0.9017
2024-08-12 13:08:08,125 : INFO : Recall score for label_class 0: 0.7606
2024-08-12 13:08:08,125 : INFO : Recall score for label_class 1: 0.9415
2024-08-12 13:08:08,125 : INFO : Recall score for label_class 2: 0.8041
2024-08-12 13:08:08,125 : INFO : Average F1 score: 0.8473
2024-08-12 13:08:08,125 : INFO : Determined score from best model, ending training.
2024-08-12 13:08:08,127 : INFO : Split 2 is finished, the score is: 0.8473
2024-08-12 13:08:08,127 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:08,127 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:08,127 : INFO : Starting training for split 3
2024-08-12 13:08:08,138 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 328, 1611,  759]))
2024-08-12 13:08:08,140 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 86, 400, 189]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:08:08,180 : INFO : Starting epoch 1
2024-08-12 13:08:08,222 : INFO : Current training batch loss: 1.1055 in epoch 1
2024-08-12 13:08:09,032 : INFO : Current training batch loss: 1.0143 in epoch 1
2024-08-12 13:08:09,838 : INFO : Current training batch loss: 0.7573 in epoch 1
2024-08-12 13:08:10,644 : INFO : Current training batch loss: 0.6757 in epoch 1
2024-08-12 13:08:11,449 : INFO : Current training batch loss: 0.6312 in epoch 1
2024-08-12 13:08:11,590 : INFO : Epoch finished, average loss over training batches: 0.8296
2024-08-12 13:08:11,591 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:11,591 : INFO : Training metrics:
2024-08-12 13:08:11,591 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:11,598 : INFO : Accuracy: 0.6331
2024-08-12 13:08:11,598 : INFO : Precision score for label_class 0: 0.1971
2024-08-12 13:08:11,598 : INFO : Precision score for label_class 1: 0.6917
2024-08-12 13:08:11,598 : INFO : Precision score for label_class 2: 0.5572
2024-08-12 13:08:11,598 : INFO : Recall score for label_class 0: 0.1250
2024-08-12 13:08:11,598 : INFO : Recall score for label_class 1: 0.8926
2024-08-12 13:08:11,598 : INFO : Recall score for label_class 2: 0.3017
2024-08-12 13:08:11,598 : INFO : Average F1 score: 0.4413
2024-08-12 13:08:11,878 : INFO : Average loss over validation batches: 0.5733
2024-08-12 13:08:11,878 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:11,878 : INFO : Validation metrics:
2024-08-12 13:08:11,878 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:11,881 : INFO : Accuracy: 0.7615
2024-08-12 13:08:11,881 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:08:11,881 : INFO : Precision score for label_class 1: 0.8568
2024-08-12 13:08:11,881 : INFO : Precision score for label_class 2: 0.5909
2024-08-12 13:08:11,881 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:08:11,881 : INFO : Recall score for label_class 1: 0.9275
2024-08-12 13:08:11,881 : INFO : Recall score for label_class 2: 0.7566
2024-08-12 13:08:11,881 : INFO : Average F1 score: 0.5181
2024-08-12 13:08:11,881 : INFO : Validation metric decreased (inf --> 0.573315).  Saving model ...
2024-08-12 13:08:11,988 : INFO : Starting epoch 2
2024-08-12 13:08:12,632 : INFO : Current training batch loss: 0.6172 in epoch 2
2024-08-12 13:08:13,437 : INFO : Current training batch loss: 0.3644 in epoch 2
2024-08-12 13:08:14,243 : INFO : Current training batch loss: 0.4780 in epoch 2
2024-08-12 13:08:15,048 : INFO : Current training batch loss: 0.2993 in epoch 2
2024-08-12 13:08:15,390 : INFO : Epoch finished, average loss over training batches: 0.4394
2024-08-12 13:08:15,390 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:15,390 : INFO : Training metrics:
2024-08-12 13:08:15,390 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:15,398 : INFO : Accuracy: 0.8477
2024-08-12 13:08:15,398 : INFO : Precision score for label_class 0: 0.7804
2024-08-12 13:08:15,398 : INFO : Precision score for label_class 1: 0.8892
2024-08-12 13:08:15,398 : INFO : Precision score for label_class 2: 0.7778
2024-08-12 13:08:15,398 : INFO : Recall score for label_class 0: 0.6067
2024-08-12 13:08:15,398 : INFO : Recall score for label_class 1: 0.9311
2024-08-12 13:08:15,398 : INFO : Recall score for label_class 2: 0.7747
2024-08-12 13:08:15,398 : INFO : Average F1 score: 0.7895
2024-08-12 13:08:15,678 : INFO : Average loss over validation batches: 0.3860
2024-08-12 13:08:15,678 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:15,678 : INFO : Validation metrics:
2024-08-12 13:08:15,678 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:15,680 : INFO : Accuracy: 0.8548
2024-08-12 13:08:15,680 : INFO : Precision score for label_class 0: 0.7949
2024-08-12 13:08:15,680 : INFO : Precision score for label_class 1: 0.8923
2024-08-12 13:08:15,680 : INFO : Precision score for label_class 2: 0.7933
2024-08-12 13:08:15,680 : INFO : Recall score for label_class 0: 0.7209
2024-08-12 13:08:15,680 : INFO : Recall score for label_class 1: 0.9325
2024-08-12 13:08:15,680 : INFO : Recall score for label_class 2: 0.7513
2024-08-12 13:08:15,680 : INFO : Average F1 score: 0.8133
2024-08-12 13:08:15,680 : INFO : Validation metric decreased (0.573315 --> 0.386049).  Saving model ...
2024-08-12 13:08:15,782 : INFO : Starting epoch 3
2024-08-12 13:08:16,225 : INFO : Current training batch loss: 0.1778 in epoch 3
2024-08-12 13:08:17,031 : INFO : Current training batch loss: 0.2382 in epoch 3
2024-08-12 13:08:17,837 : INFO : Current training batch loss: 0.1466 in epoch 3
2024-08-12 13:08:18,642 : INFO : Current training batch loss: 0.1427 in epoch 3
2024-08-12 13:08:19,185 : INFO : Epoch finished, average loss over training batches: 0.2421
2024-08-12 13:08:19,185 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:19,185 : INFO : Training metrics:
2024-08-12 13:08:19,186 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:19,189 : INFO : Accuracy: 0.9244
2024-08-12 13:08:19,189 : INFO : Precision score for label_class 0: 0.8358
2024-08-12 13:08:19,189 : INFO : Precision score for label_class 1: 0.9511
2024-08-12 13:08:19,189 : INFO : Precision score for label_class 2: 0.9071
2024-08-12 13:08:19,189 : INFO : Recall score for label_class 0: 0.8689
2024-08-12 13:08:19,189 : INFO : Recall score for label_class 1: 0.9528
2024-08-12 13:08:19,189 : INFO : Recall score for label_class 2: 0.8880
2024-08-12 13:08:19,189 : INFO : Average F1 score: 0.9005
2024-08-12 13:08:19,470 : INFO : Average loss over validation batches: 0.3668
2024-08-12 13:08:19,470 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:19,470 : INFO : Validation metrics:
2024-08-12 13:08:19,470 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:19,472 : INFO : Accuracy: 0.8711
2024-08-12 13:08:19,472 : INFO : Precision score for label_class 0: 0.8333
2024-08-12 13:08:19,472 : INFO : Precision score for label_class 1: 0.8889
2024-08-12 13:08:19,472 : INFO : Precision score for label_class 2: 0.8457
2024-08-12 13:08:19,472 : INFO : Recall score for label_class 0: 0.8721
2024-08-12 13:08:19,472 : INFO : Recall score for label_class 1: 0.9400
2024-08-12 13:08:19,472 : INFO : Recall score for label_class 2: 0.7249
2024-08-12 13:08:19,472 : INFO : Average F1 score: 0.8489
2024-08-12 13:08:19,472 : INFO : Validation metric decreased (0.386049 --> 0.366838).  Saving model ...
2024-08-12 13:08:19,574 : INFO : Starting epoch 4
2024-08-12 13:08:19,817 : INFO : Current training batch loss: 0.3546 in epoch 4
2024-08-12 13:08:20,623 : INFO : Current training batch loss: 0.2951 in epoch 4
2024-08-12 13:08:21,429 : INFO : Current training batch loss: 0.1675 in epoch 4
2024-08-12 13:08:22,235 : INFO : Current training batch loss: 0.0479 in epoch 4
2024-08-12 13:08:22,979 : INFO : Epoch finished, average loss over training batches: 0.1521
2024-08-12 13:08:22,979 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:22,979 : INFO : Training metrics:
2024-08-12 13:08:22,979 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:22,986 : INFO : Accuracy: 0.9544
2024-08-12 13:08:22,986 : INFO : Precision score for label_class 0: 0.8818
2024-08-12 13:08:22,986 : INFO : Precision score for label_class 1: 0.9709
2024-08-12 13:08:22,986 : INFO : Precision score for label_class 2: 0.9526
2024-08-12 13:08:22,986 : INFO : Recall score for label_class 0: 0.9329
2024-08-12 13:08:22,986 : INFO : Recall score for label_class 1: 0.9721
2024-08-12 13:08:22,986 : INFO : Recall score for label_class 2: 0.9262
2024-08-12 13:08:22,986 : INFO : Average F1 score: 0.9391
2024-08-12 13:08:23,267 : INFO : Average loss over validation batches: 0.4177
2024-08-12 13:08:23,267 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:23,267 : INFO : Validation metrics:
2024-08-12 13:08:23,267 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:23,270 : INFO : Accuracy: 0.8652
2024-08-12 13:08:23,270 : INFO : Precision score for label_class 0: 0.7789
2024-08-12 13:08:23,270 : INFO : Precision score for label_class 1: 0.9271
2024-08-12 13:08:23,270 : INFO : Precision score for label_class 2: 0.7857
2024-08-12 13:08:23,270 : INFO : Recall score for label_class 0: 0.8605
2024-08-12 13:08:23,270 : INFO : Recall score for label_class 1: 0.8900
2024-08-12 13:08:23,270 : INFO : Recall score for label_class 2: 0.8148
2024-08-12 13:08:23,270 : INFO : Average F1 score: 0.8419
2024-08-12 13:08:23,270 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 13:08:23,270 : INFO : Starting epoch 5
2024-08-12 13:08:23,311 : INFO : Current training batch loss: 0.0400 in epoch 5
2024-08-12 13:08:24,116 : INFO : Current training batch loss: 0.2518 in epoch 5
2024-08-12 13:08:24,922 : INFO : Current training batch loss: 0.0246 in epoch 5
2024-08-12 13:08:25,729 : INFO : Current training batch loss: 0.3074 in epoch 5
2024-08-12 13:08:26,535 : INFO : Current training batch loss: 0.0759 in epoch 5
2024-08-12 13:08:26,676 : INFO : Epoch finished, average loss over training batches: 0.0957
2024-08-12 13:08:26,677 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:26,677 : INFO : Training metrics:
2024-08-12 13:08:26,677 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:26,684 : INFO : Accuracy: 0.9752
2024-08-12 13:08:26,684 : INFO : Precision score for label_class 0: 0.9145
2024-08-12 13:08:26,684 : INFO : Precision score for label_class 1: 0.9863
2024-08-12 13:08:26,684 : INFO : Precision score for label_class 2: 0.9797
2024-08-12 13:08:26,684 : INFO : Recall score for label_class 0: 0.9787
2024-08-12 13:08:26,684 : INFO : Recall score for label_class 1: 0.9845
2024-08-12 13:08:26,684 : INFO : Recall score for label_class 2: 0.9539
2024-08-12 13:08:26,684 : INFO : Average F1 score: 0.9658
2024-08-12 13:08:26,965 : INFO : Average loss over validation batches: 0.4366
2024-08-12 13:08:26,965 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:26,965 : INFO : Validation metrics:
2024-08-12 13:08:26,965 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:26,968 : INFO : Accuracy: 0.8756
2024-08-12 13:08:26,968 : INFO : Precision score for label_class 0: 0.7789
2024-08-12 13:08:26,968 : INFO : Precision score for label_class 1: 0.9219
2024-08-12 13:08:26,968 : INFO : Precision score for label_class 2: 0.8251
2024-08-12 13:08:26,968 : INFO : Recall score for label_class 0: 0.8605
2024-08-12 13:08:26,968 : INFO : Recall score for label_class 1: 0.9150
2024-08-12 13:08:26,968 : INFO : Recall score for label_class 2: 0.7989
2024-08-12 13:08:26,968 : INFO : Average F1 score: 0.8493
2024-08-12 13:08:26,968 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 13:08:26,968 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:08:27,005 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 13:08:27,319 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:27,319 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 13:08:27,319 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:27,321 : INFO : Accuracy: 0.8711
2024-08-12 13:08:27,321 : INFO : Precision score for label_class 0: 0.8333
2024-08-12 13:08:27,321 : INFO : Precision score for label_class 1: 0.8889
2024-08-12 13:08:27,321 : INFO : Precision score for label_class 2: 0.8457
2024-08-12 13:08:27,321 : INFO : Recall score for label_class 0: 0.8721
2024-08-12 13:08:27,321 : INFO : Recall score for label_class 1: 0.9400
2024-08-12 13:08:27,321 : INFO : Recall score for label_class 2: 0.7249
2024-08-12 13:08:27,321 : INFO : Average F1 score: 0.8489
2024-08-12 13:08:27,321 : INFO : Determined score from best model, ending training.
2024-08-12 13:08:27,323 : INFO : Split 3 is finished, the score is: 0.8489
2024-08-12 13:08:27,323 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:27,323 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:27,323 : INFO : Starting training for split 4
2024-08-12 13:08:27,340 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 327, 1621,  751]))
2024-08-12 13:08:27,342 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 87, 390, 197]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:08:27,394 : INFO : Starting epoch 1
2024-08-12 13:08:27,436 : INFO : Current training batch loss: 1.1032 in epoch 1
2024-08-12 13:08:28,242 : INFO : Current training batch loss: 1.0123 in epoch 1
2024-08-12 13:08:29,047 : INFO : Current training batch loss: 0.7645 in epoch 1
2024-08-12 13:08:29,854 : INFO : Current training batch loss: 0.6439 in epoch 1
2024-08-12 13:08:30,661 : INFO : Current training batch loss: 0.6350 in epoch 1
2024-08-12 13:08:30,803 : INFO : Epoch finished, average loss over training batches: 0.8235
2024-08-12 13:08:30,804 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:30,804 : INFO : Training metrics:
2024-08-12 13:08:30,804 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:30,808 : INFO : Accuracy: 0.6506
2024-08-12 13:08:30,808 : INFO : Precision score for label_class 0: 0.2000
2024-08-12 13:08:30,808 : INFO : Precision score for label_class 1: 0.7147
2024-08-12 13:08:30,808 : INFO : Precision score for label_class 2: 0.4718
2024-08-12 13:08:30,808 : INFO : Recall score for label_class 0: 0.0061
2024-08-12 13:08:30,808 : INFO : Recall score for label_class 1: 0.8809
2024-08-12 13:08:30,808 : INFO : Recall score for label_class 2: 0.4341
2024-08-12 13:08:30,808 : INFO : Average F1 score: 0.4177
2024-08-12 13:08:31,089 : INFO : Average loss over validation batches: 0.5875
2024-08-12 13:08:31,089 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:31,089 : INFO : Validation metrics:
2024-08-12 13:08:31,089 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:31,092 : INFO : Accuracy: 0.7507
2024-08-12 13:08:31,092 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:08:31,092 : INFO : Precision score for label_class 1: 0.8514
2024-08-12 13:08:31,092 : INFO : Precision score for label_class 2: 0.5800
2024-08-12 13:08:31,092 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:08:31,092 : INFO : Recall score for label_class 1: 0.9256
2024-08-12 13:08:31,092 : INFO : Recall score for label_class 2: 0.7360
2024-08-12 13:08:31,092 : INFO : Average F1 score: 0.5119
2024-08-12 13:08:31,093 : INFO : Validation metric decreased (inf --> 0.587542).  Saving model ...
2024-08-12 13:08:31,202 : INFO : Starting epoch 2
2024-08-12 13:08:31,847 : INFO : Current training batch loss: 0.5498 in epoch 2
2024-08-12 13:08:32,653 : INFO : Current training batch loss: 0.4212 in epoch 2
2024-08-12 13:08:33,459 : INFO : Current training batch loss: 0.2849 in epoch 2
2024-08-12 13:08:34,264 : INFO : Current training batch loss: 0.3906 in epoch 2
2024-08-12 13:08:34,606 : INFO : Epoch finished, average loss over training batches: 0.4379
2024-08-12 13:08:34,607 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:34,607 : INFO : Training metrics:
2024-08-12 13:08:34,607 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:34,612 : INFO : Accuracy: 0.8429
2024-08-12 13:08:34,612 : INFO : Precision score for label_class 0: 0.7508
2024-08-12 13:08:34,612 : INFO : Precision score for label_class 1: 0.8871
2024-08-12 13:08:34,612 : INFO : Precision score for label_class 2: 0.7792
2024-08-12 13:08:34,612 : INFO : Recall score for label_class 0: 0.7003
2024-08-12 13:08:34,612 : INFO : Recall score for label_class 1: 0.9161
2024-08-12 13:08:34,612 : INFO : Recall score for label_class 2: 0.7470
2024-08-12 13:08:34,612 : INFO : Average F1 score: 0.7963
2024-08-12 13:08:34,891 : INFO : Average loss over validation batches: 0.4277
2024-08-12 13:08:34,891 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:34,892 : INFO : Validation metrics:
2024-08-12 13:08:34,892 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:34,895 : INFO : Accuracy: 0.8576
2024-08-12 13:08:34,895 : INFO : Precision score for label_class 0: 0.8644
2024-08-12 13:08:34,895 : INFO : Precision score for label_class 1: 0.8500
2024-08-12 13:08:34,896 : INFO : Precision score for label_class 2: 0.8743
2024-08-12 13:08:34,896 : INFO : Recall score for label_class 0: 0.5862
2024-08-12 13:08:34,896 : INFO : Recall score for label_class 1: 0.9590
2024-08-12 13:08:34,896 : INFO : Recall score for label_class 2: 0.7766
2024-08-12 13:08:34,896 : INFO : Average F1 score: 0.8075
2024-08-12 13:08:34,896 : INFO : Validation metric decreased (0.587542 --> 0.427675).  Saving model ...
2024-08-12 13:08:34,995 : INFO : Starting epoch 3
2024-08-12 13:08:35,439 : INFO : Current training batch loss: 0.2959 in epoch 3
2024-08-12 13:08:36,244 : INFO : Current training batch loss: 0.2141 in epoch 3
2024-08-12 13:08:37,050 : INFO : Current training batch loss: 0.1874 in epoch 3
2024-08-12 13:08:37,856 : INFO : Current training batch loss: 0.0713 in epoch 3
2024-08-12 13:08:38,399 : INFO : Epoch finished, average loss over training batches: 0.2208
2024-08-12 13:08:38,399 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:38,399 : INFO : Training metrics:
2024-08-12 13:08:38,399 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:38,407 : INFO : Accuracy: 0.9315
2024-08-12 13:08:38,407 : INFO : Precision score for label_class 0: 0.8609
2024-08-12 13:08:38,407 : INFO : Precision score for label_class 1: 0.9541
2024-08-12 13:08:38,407 : INFO : Precision score for label_class 2: 0.9135
2024-08-12 13:08:38,407 : INFO : Recall score for label_class 0: 0.8899
2024-08-12 13:08:38,407 : INFO : Recall score for label_class 1: 0.9611
2024-08-12 13:08:38,407 : INFO : Recall score for label_class 2: 0.8855
2024-08-12 13:08:38,407 : INFO : Average F1 score: 0.9107
2024-08-12 13:08:38,687 : INFO : Average loss over validation batches: 0.3896
2024-08-12 13:08:38,687 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:38,687 : INFO : Validation metrics:
2024-08-12 13:08:38,687 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:38,691 : INFO : Accuracy: 0.8576
2024-08-12 13:08:38,691 : INFO : Precision score for label_class 0: 0.8356
2024-08-12 13:08:38,691 : INFO : Precision score for label_class 1: 0.8744
2024-08-12 13:08:38,691 : INFO : Precision score for label_class 2: 0.8289
2024-08-12 13:08:38,691 : INFO : Recall score for label_class 0: 0.7011
2024-08-12 13:08:38,691 : INFO : Recall score for label_class 1: 0.9282
2024-08-12 13:08:38,691 : INFO : Recall score for label_class 2: 0.7868
2024-08-12 13:08:38,691 : INFO : Average F1 score: 0.8234
2024-08-12 13:08:38,691 : INFO : Validation metric decreased (0.427675 --> 0.389618).  Saving model ...
2024-08-12 13:08:38,792 : INFO : Starting epoch 4
2024-08-12 13:08:39,034 : INFO : Current training batch loss: 0.3851 in epoch 4
2024-08-12 13:08:39,840 : INFO : Current training batch loss: 0.1941 in epoch 4
2024-08-12 13:08:40,645 : INFO : Current training batch loss: 0.0628 in epoch 4
2024-08-12 13:08:41,452 : INFO : Current training batch loss: 0.1551 in epoch 4
2024-08-12 13:08:42,196 : INFO : Epoch finished, average loss over training batches: 0.1170
2024-08-12 13:08:42,196 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:42,196 : INFO : Training metrics:
2024-08-12 13:08:42,196 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:42,202 : INFO : Accuracy: 0.9667
2024-08-12 13:08:42,202 : INFO : Precision score for label_class 0: 0.9107
2024-08-12 13:08:42,202 : INFO : Precision score for label_class 1: 0.9797
2024-08-12 13:08:42,202 : INFO : Precision score for label_class 2: 0.9634
2024-08-12 13:08:42,202 : INFO : Recall score for label_class 0: 0.9358
2024-08-12 13:08:42,202 : INFO : Recall score for label_class 1: 0.9821
2024-08-12 13:08:42,202 : INFO : Recall score for label_class 2: 0.9467
2024-08-12 13:08:42,202 : INFO : Average F1 score: 0.9530
2024-08-12 13:08:42,482 : INFO : Average loss over validation batches: 0.4474
2024-08-12 13:08:42,482 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:42,482 : INFO : Validation metrics:
2024-08-12 13:08:42,482 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:42,485 : INFO : Accuracy: 0.8576
2024-08-12 13:08:42,485 : INFO : Precision score for label_class 0: 0.8049
2024-08-12 13:08:42,485 : INFO : Precision score for label_class 1: 0.9337
2024-08-12 13:08:42,485 : INFO : Precision score for label_class 2: 0.7565
2024-08-12 13:08:42,485 : INFO : Recall score for label_class 0: 0.7586
2024-08-12 13:08:42,485 : INFO : Recall score for label_class 1: 0.8667
2024-08-12 13:08:42,485 : INFO : Recall score for label_class 2: 0.8832
2024-08-12 13:08:42,485 : INFO : Average F1 score: 0.8317
2024-08-12 13:08:42,485 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 13:08:42,485 : INFO : Starting epoch 5
2024-08-12 13:08:42,527 : INFO : Current training batch loss: 0.0803 in epoch 5
2024-08-12 13:08:43,332 : INFO : Current training batch loss: 0.1747 in epoch 5
2024-08-12 13:08:44,137 : INFO : Current training batch loss: 0.0164 in epoch 5
2024-08-12 13:08:44,943 : INFO : Current training batch loss: 0.0245 in epoch 5
2024-08-12 13:08:45,749 : INFO : Current training batch loss: 0.0835 in epoch 5
2024-08-12 13:08:45,890 : INFO : Epoch finished, average loss over training batches: 0.0665
2024-08-12 13:08:45,890 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:45,890 : INFO : Training metrics:
2024-08-12 13:08:45,890 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:45,894 : INFO : Accuracy: 0.9859
2024-08-12 13:08:45,894 : INFO : Precision score for label_class 0: 0.9724
2024-08-12 13:08:45,894 : INFO : Precision score for label_class 1: 0.9908
2024-08-12 13:08:45,894 : INFO : Precision score for label_class 2: 0.9812
2024-08-12 13:08:45,894 : INFO : Recall score for label_class 0: 0.9694
2024-08-12 13:08:45,894 : INFO : Recall score for label_class 1: 0.9944
2024-08-12 13:08:45,894 : INFO : Recall score for label_class 2: 0.9747
2024-08-12 13:08:45,894 : INFO : Average F1 score: 0.9805
2024-08-12 13:08:46,174 : INFO : Average loss over validation batches: 0.4252
2024-08-12 13:08:46,174 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:46,174 : INFO : Validation metrics:
2024-08-12 13:08:46,174 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:46,177 : INFO : Accuracy: 0.8739
2024-08-12 13:08:46,177 : INFO : Precision score for label_class 0: 0.7692
2024-08-12 13:08:46,177 : INFO : Precision score for label_class 1: 0.9193
2024-08-12 13:08:46,177 : INFO : Precision score for label_class 2: 0.8342
2024-08-12 13:08:46,177 : INFO : Recall score for label_class 0: 0.8046
2024-08-12 13:08:46,177 : INFO : Recall score for label_class 1: 0.9051
2024-08-12 13:08:46,177 : INFO : Recall score for label_class 2: 0.8426
2024-08-12 13:08:46,177 : INFO : Average F1 score: 0.8457
2024-08-12 13:08:46,177 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 13:08:46,177 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:08:46,216 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 13:08:46,531 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:46,531 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 13:08:46,531 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:46,534 : INFO : Accuracy: 0.8576
2024-08-12 13:08:46,534 : INFO : Precision score for label_class 0: 0.8356
2024-08-12 13:08:46,534 : INFO : Precision score for label_class 1: 0.8744
2024-08-12 13:08:46,534 : INFO : Precision score for label_class 2: 0.8289
2024-08-12 13:08:46,534 : INFO : Recall score for label_class 0: 0.7011
2024-08-12 13:08:46,534 : INFO : Recall score for label_class 1: 0.9282
2024-08-12 13:08:46,534 : INFO : Recall score for label_class 2: 0.7868
2024-08-12 13:08:46,534 : INFO : Average F1 score: 0.8234
2024-08-12 13:08:46,534 : INFO : Determined score from best model, ending training.
2024-08-12 13:08:46,536 : INFO : Split 4 is finished, the score is: 0.8234
2024-08-12 13:08:46,536 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:46,536 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:46,536 : INFO : Starting training for split 5
2024-08-12 13:08:46,552 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 330, 1615,  754]))
2024-08-12 13:08:46,554 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 84, 396, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:08:46,691 : INFO : Starting epoch 1
2024-08-12 13:08:46,733 : INFO : Current training batch loss: 1.1017 in epoch 1
2024-08-12 13:08:47,538 : INFO : Current training batch loss: 1.0061 in epoch 1
2024-08-12 13:08:48,344 : INFO : Current training batch loss: 0.7325 in epoch 1
2024-08-12 13:08:49,150 : INFO : Current training batch loss: 0.6275 in epoch 1
2024-08-12 13:08:49,955 : INFO : Current training batch loss: 0.6007 in epoch 1
2024-08-12 13:08:50,096 : INFO : Epoch finished, average loss over training batches: 0.7937
2024-08-12 13:08:50,096 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:50,096 : INFO : Training metrics:
2024-08-12 13:08:50,096 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:50,107 : INFO : Accuracy: 0.6539
2024-08-12 13:08:50,107 : INFO : Precision score for label_class 0: 0.7895
2024-08-12 13:08:50,107 : INFO : Precision score for label_class 1: 0.7174
2024-08-12 13:08:50,107 : INFO : Precision score for label_class 2: 0.4808
2024-08-12 13:08:50,107 : INFO : Recall score for label_class 0: 0.0455
2024-08-12 13:08:50,107 : INFO : Recall score for label_class 1: 0.8663
2024-08-12 13:08:50,107 : INFO : Recall score for label_class 2: 0.4655
2024-08-12 13:08:50,107 : INFO : Average F1 score: 0.4480
2024-08-12 13:08:50,388 : INFO : Average loss over validation batches: 0.5232
2024-08-12 13:08:50,388 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:50,388 : INFO : Validation metrics:
2024-08-12 13:08:50,388 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:50,392 : INFO : Accuracy: 0.8309
2024-08-12 13:08:50,392 : INFO : Precision score for label_class 0: 0.6977
2024-08-12 13:08:50,392 : INFO : Precision score for label_class 1: 0.8818
2024-08-12 13:08:50,392 : INFO : Precision score for label_class 2: 0.7802
2024-08-12 13:08:50,392 : INFO : Recall score for label_class 0: 0.7143
2024-08-12 13:08:50,392 : INFO : Recall score for label_class 1: 0.9040
2024-08-12 13:08:50,392 : INFO : Recall score for label_class 2: 0.7320
2024-08-12 13:08:50,392 : INFO : Average F1 score: 0.7847
2024-08-12 13:08:50,392 : INFO : Validation metric decreased (inf --> 0.523219).  Saving model ...
2024-08-12 13:08:50,502 : INFO : Starting epoch 2
2024-08-12 13:08:51,146 : INFO : Current training batch loss: 0.4316 in epoch 2
2024-08-12 13:08:51,951 : INFO : Current training batch loss: 0.3818 in epoch 2
2024-08-12 13:08:52,756 : INFO : Current training batch loss: 0.2339 in epoch 2
2024-08-12 13:08:53,562 : INFO : Current training batch loss: 0.4347 in epoch 2
2024-08-12 13:08:53,904 : INFO : Epoch finished, average loss over training batches: 0.3778
2024-08-12 13:08:53,904 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:53,904 : INFO : Training metrics:
2024-08-12 13:08:53,904 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:53,915 : INFO : Accuracy: 0.8763
2024-08-12 13:08:53,915 : INFO : Precision score for label_class 0: 0.8117
2024-08-12 13:08:53,915 : INFO : Precision score for label_class 1: 0.9032
2024-08-12 13:08:53,915 : INFO : Precision score for label_class 2: 0.8427
2024-08-12 13:08:53,915 : INFO : Recall score for label_class 0: 0.7970
2024-08-12 13:08:53,915 : INFO : Recall score for label_class 1: 0.9300
2024-08-12 13:08:53,915 : INFO : Recall score for label_class 2: 0.7958
2024-08-12 13:08:53,915 : INFO : Average F1 score: 0.8464
2024-08-12 13:08:54,195 : INFO : Average loss over validation batches: 0.4343
2024-08-12 13:08:54,195 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:54,195 : INFO : Validation metrics:
2024-08-12 13:08:54,195 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:54,199 : INFO : Accuracy: 0.8368
2024-08-12 13:08:54,199 : INFO : Precision score for label_class 0: 0.8235
2024-08-12 13:08:54,199 : INFO : Precision score for label_class 1: 0.8415
2024-08-12 13:08:54,199 : INFO : Precision score for label_class 2: 0.8291
2024-08-12 13:08:54,199 : INFO : Recall score for label_class 0: 0.6667
2024-08-12 13:08:54,199 : INFO : Recall score for label_class 1: 0.9520
2024-08-12 13:08:54,199 : INFO : Recall score for label_class 2: 0.6753
2024-08-12 13:08:54,199 : INFO : Average F1 score: 0.7915
2024-08-12 13:08:54,199 : INFO : Validation metric decreased (0.523219 --> 0.434319).  Saving model ...
2024-08-12 13:08:54,299 : INFO : Starting epoch 3
2024-08-12 13:08:54,743 : INFO : Current training batch loss: 0.2520 in epoch 3
2024-08-12 13:08:55,548 : INFO : Current training batch loss: 0.2362 in epoch 3
2024-08-12 13:08:56,353 : INFO : Current training batch loss: 0.1827 in epoch 3
2024-08-12 13:08:57,158 : INFO : Current training batch loss: 0.0769 in epoch 3
2024-08-12 13:08:57,702 : INFO : Epoch finished, average loss over training batches: 0.2168
2024-08-12 13:08:57,702 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:57,702 : INFO : Training metrics:
2024-08-12 13:08:57,702 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:57,709 : INFO : Accuracy: 0.9315
2024-08-12 13:08:57,709 : INFO : Precision score for label_class 0: 0.8735
2024-08-12 13:08:57,709 : INFO : Precision score for label_class 1: 0.9509
2024-08-12 13:08:57,709 : INFO : Precision score for label_class 2: 0.9151
2024-08-12 13:08:57,709 : INFO : Recall score for label_class 0: 0.9000
2024-08-12 13:08:57,709 : INFO : Recall score for label_class 1: 0.9591
2024-08-12 13:08:57,709 : INFO : Recall score for label_class 2: 0.8859
2024-08-12 13:08:57,709 : INFO : Average F1 score: 0.9139
2024-08-12 13:08:57,990 : INFO : Average loss over validation batches: 0.4208
2024-08-12 13:08:57,990 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:57,990 : INFO : Validation metrics:
2024-08-12 13:08:57,990 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:08:57,994 : INFO : Accuracy: 0.8650
2024-08-12 13:08:57,994 : INFO : Precision score for label_class 0: 0.8000
2024-08-12 13:08:57,994 : INFO : Precision score for label_class 1: 0.8927
2024-08-12 13:08:57,994 : INFO : Precision score for label_class 2: 0.8324
2024-08-12 13:08:57,994 : INFO : Recall score for label_class 0: 0.8095
2024-08-12 13:08:57,994 : INFO : Recall score for label_class 1: 0.9242
2024-08-12 13:08:57,994 : INFO : Recall score for label_class 2: 0.7680
2024-08-12 13:08:57,994 : INFO : Average F1 score: 0.8373
2024-08-12 13:08:57,994 : INFO : Validation metric decreased (0.434319 --> 0.420798).  Saving model ...
2024-08-12 13:08:58,092 : INFO : Starting epoch 4
2024-08-12 13:08:58,335 : INFO : Current training batch loss: 0.2809 in epoch 4
2024-08-12 13:08:59,140 : INFO : Current training batch loss: 0.0989 in epoch 4
2024-08-12 13:08:59,946 : INFO : Current training batch loss: 0.0704 in epoch 4
2024-08-12 13:09:00,751 : INFO : Current training batch loss: 0.0696 in epoch 4
2024-08-12 13:09:01,495 : INFO : Epoch finished, average loss over training batches: 0.1312
2024-08-12 13:09:01,495 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:01,495 : INFO : Training metrics:
2024-08-12 13:09:01,495 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:01,503 : INFO : Accuracy: 0.9604
2024-08-12 13:09:01,503 : INFO : Precision score for label_class 0: 0.9211
2024-08-12 13:09:01,503 : INFO : Precision score for label_class 1: 0.9728
2024-08-12 13:09:01,503 : INFO : Precision score for label_class 2: 0.9514
2024-08-12 13:09:01,503 : INFO : Recall score for label_class 0: 0.9545
2024-08-12 13:09:01,503 : INFO : Recall score for label_class 1: 0.9740
2024-08-12 13:09:01,503 : INFO : Recall score for label_class 2: 0.9337
2024-08-12 13:09:01,503 : INFO : Average F1 score: 0.9511
2024-08-12 13:09:01,783 : INFO : Average loss over validation batches: 0.4235
2024-08-12 13:09:01,783 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:01,783 : INFO : Validation metrics:
2024-08-12 13:09:01,783 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:01,786 : INFO : Accuracy: 0.8635
2024-08-12 13:09:01,786 : INFO : Precision score for label_class 0: 0.8378
2024-08-12 13:09:01,786 : INFO : Precision score for label_class 1: 0.9077
2024-08-12 13:09:01,786 : INFO : Precision score for label_class 2: 0.7839
2024-08-12 13:09:01,786 : INFO : Recall score for label_class 0: 0.7381
2024-08-12 13:09:01,786 : INFO : Recall score for label_class 1: 0.9192
2024-08-12 13:09:01,786 : INFO : Recall score for label_class 2: 0.8041
2024-08-12 13:09:01,786 : INFO : Average F1 score: 0.8307
2024-08-12 13:09:01,786 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 13:09:01,786 : INFO : Starting epoch 5
2024-08-12 13:09:01,828 : INFO : Current training batch loss: 0.0261 in epoch 5
2024-08-12 13:09:02,633 : INFO : Current training batch loss: 0.0902 in epoch 5
2024-08-12 13:09:03,439 : INFO : Current training batch loss: 0.0294 in epoch 5
2024-08-12 13:09:04,245 : INFO : Current training batch loss: 0.0546 in epoch 5
2024-08-12 13:09:05,051 : INFO : Current training batch loss: 0.0153 in epoch 5
2024-08-12 13:09:05,193 : INFO : Epoch finished, average loss over training batches: 0.0710
2024-08-12 13:09:05,193 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:05,193 : INFO : Training metrics:
2024-08-12 13:09:05,193 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:05,201 : INFO : Accuracy: 0.9811
2024-08-12 13:09:05,201 : INFO : Precision score for label_class 0: 0.9413
2024-08-12 13:09:05,201 : INFO : Precision score for label_class 1: 0.9876
2024-08-12 13:09:05,201 : INFO : Precision score for label_class 2: 0.9852
2024-08-12 13:09:05,201 : INFO : Recall score for label_class 0: 0.9727
2024-08-12 13:09:05,201 : INFO : Recall score for label_class 1: 0.9876
2024-08-12 13:09:05,201 : INFO : Recall score for label_class 2: 0.9708
2024-08-12 13:09:05,201 : INFO : Average F1 score: 0.9741
2024-08-12 13:09:05,481 : INFO : Average loss over validation batches: 0.5167
2024-08-12 13:09:05,481 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:05,481 : INFO : Validation metrics:
2024-08-12 13:09:05,481 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:05,484 : INFO : Accuracy: 0.8516
2024-08-12 13:09:05,484 : INFO : Precision score for label_class 0: 0.6863
2024-08-12 13:09:05,484 : INFO : Precision score for label_class 1: 0.9249
2024-08-12 13:09:05,484 : INFO : Precision score for label_class 2: 0.7990
2024-08-12 13:09:05,484 : INFO : Recall score for label_class 0: 0.8333
2024-08-12 13:09:05,484 : INFO : Recall score for label_class 1: 0.8712
2024-08-12 13:09:05,484 : INFO : Recall score for label_class 2: 0.8196
2024-08-12 13:09:05,484 : INFO : Average F1 score: 0.8197
2024-08-12 13:09:05,484 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 13:09:05,484 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:09:05,521 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 13:09:05,836 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:05,836 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 13:09:05,836 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:05,839 : INFO : Accuracy: 0.8650
2024-08-12 13:09:05,839 : INFO : Precision score for label_class 0: 0.8000
2024-08-12 13:09:05,839 : INFO : Precision score for label_class 1: 0.8927
2024-08-12 13:09:05,839 : INFO : Precision score for label_class 2: 0.8324
2024-08-12 13:09:05,839 : INFO : Recall score for label_class 0: 0.8095
2024-08-12 13:09:05,839 : INFO : Recall score for label_class 1: 0.9242
2024-08-12 13:09:05,839 : INFO : Recall score for label_class 2: 0.7680
2024-08-12 13:09:05,839 : INFO : Average F1 score: 0.8373
2024-08-12 13:09:05,839 : INFO : Determined score from best model, ending training.
2024-08-12 13:09:05,841 : INFO : Split 5 is finished, the score is: 0.8373
2024-08-12 13:09:05,841 : INFO : ----------------------------------------------------------------------------------------------------
[I 2024-08-12 13:09:05,841] Trial 13 finished with value: 0.845151673471549 and parameters: {'n_epochs': 8, 'learning_rate': 7.177166136079422e-05, 'classifier_dropout': 0.5785162698773775, 'warmup_step_fraction': 0.05173304204272415, 'use_gradient_clipping': False}. Best is trial 13 with value: 0.845151673471549.
2024-08-12 13:09:05,849 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:05,849 : INFO : Starting training for split 1
2024-08-12 13:09:05,860 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 328, 1596,  774]))
2024-08-12 13:09:05,862 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 86, 415, 174]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:09:05,902 : INFO : Starting epoch 1
2024-08-12 13:09:05,944 : INFO : Current training batch loss: 1.0927 in epoch 1
2024-08-12 13:09:06,749 : INFO : Current training batch loss: 0.9710 in epoch 1
2024-08-12 13:09:07,555 : INFO : Current training batch loss: 0.9340 in epoch 1
2024-08-12 13:09:08,360 : INFO : Current training batch loss: 0.6458 in epoch 1
2024-08-12 13:09:09,166 : INFO : Current training batch loss: 0.7433 in epoch 1
2024-08-12 13:09:09,307 : INFO : Epoch finished, average loss over training batches: 0.8595
2024-08-12 13:09:09,307 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:09,307 : INFO : Training metrics:
2024-08-12 13:09:09,307 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:09,316 : INFO : Accuracy: 0.6119
2024-08-12 13:09:09,316 : INFO : Precision score for label_class 0: 0.5294
2024-08-12 13:09:09,316 : INFO : Precision score for label_class 1: 0.6890
2024-08-12 13:09:09,316 : INFO : Precision score for label_class 2: 0.4250
2024-08-12 13:09:09,316 : INFO : Recall score for label_class 0: 0.0549
2024-08-12 13:09:09,316 : INFO : Recall score for label_class 1: 0.8189
2024-08-12 13:09:09,316 : INFO : Recall score for label_class 2: 0.4212
2024-08-12 13:09:09,316 : INFO : Average F1 score: 0.4236
2024-08-12 13:09:09,595 : INFO : Average loss over validation batches: 0.6592
2024-08-12 13:09:09,595 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:09,595 : INFO : Validation metrics:
2024-08-12 13:09:09,595 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:09,598 : INFO : Accuracy: 0.7215
2024-08-12 13:09:09,598 : INFO : Precision score for label_class 0: 0.7692
2024-08-12 13:09:09,598 : INFO : Precision score for label_class 1: 0.8937
2024-08-12 13:09:09,598 : INFO : Precision score for label_class 2: 0.5051
2024-08-12 13:09:09,598 : INFO : Recall score for label_class 0: 0.1163
2024-08-12 13:09:09,598 : INFO : Recall score for label_class 1: 0.7904
2024-08-12 13:09:09,598 : INFO : Recall score for label_class 2: 0.8563
2024-08-12 13:09:09,598 : INFO : Average F1 score: 0.5588
2024-08-12 13:09:09,598 : INFO : Validation metric decreased (inf --> 0.659170).  Saving model ...
2024-08-12 13:09:09,695 : INFO : Starting epoch 2
2024-08-12 13:09:10,339 : INFO : Current training batch loss: 0.2797 in epoch 2
2024-08-12 13:09:11,144 : INFO : Current training batch loss: 0.5177 in epoch 2
2024-08-12 13:09:11,949 : INFO : Current training batch loss: 0.3204 in epoch 2
2024-08-12 13:09:12,754 : INFO : Current training batch loss: 0.3454 in epoch 2
2024-08-12 13:09:13,096 : INFO : Epoch finished, average loss over training batches: 0.4201
2024-08-12 13:09:13,097 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:13,097 : INFO : Training metrics:
2024-08-12 13:09:13,097 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:13,102 : INFO : Accuracy: 0.8551
2024-08-12 13:09:13,102 : INFO : Precision score for label_class 0: 0.7708
2024-08-12 13:09:13,102 : INFO : Precision score for label_class 1: 0.8871
2024-08-12 13:09:13,102 : INFO : Precision score for label_class 2: 0.8176
2024-08-12 13:09:13,102 : INFO : Recall score for label_class 0: 0.7073
2024-08-12 13:09:13,102 : INFO : Recall score for label_class 1: 0.9211
2024-08-12 13:09:13,102 : INFO : Recall score for label_class 2: 0.7817
2024-08-12 13:09:13,102 : INFO : Average F1 score: 0.8136
2024-08-12 13:09:13,382 : INFO : Average loss over validation batches: 0.3447
2024-08-12 13:09:13,382 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:13,382 : INFO : Validation metrics:
2024-08-12 13:09:13,382 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:13,385 : INFO : Accuracy: 0.8770
2024-08-12 13:09:13,385 : INFO : Precision score for label_class 0: 0.7429
2024-08-12 13:09:13,385 : INFO : Precision score for label_class 1: 0.9353
2024-08-12 13:09:13,385 : INFO : Precision score for label_class 2: 0.8214
2024-08-12 13:09:13,385 : INFO : Recall score for label_class 0: 0.9070
2024-08-12 13:09:13,385 : INFO : Recall score for label_class 1: 0.9060
2024-08-12 13:09:13,385 : INFO : Recall score for label_class 2: 0.7931
2024-08-12 13:09:13,385 : INFO : Average F1 score: 0.8481
2024-08-12 13:09:13,385 : INFO : Validation metric decreased (0.659170 --> 0.344654).  Saving model ...
2024-08-12 13:09:13,485 : INFO : Starting epoch 3
2024-08-12 13:09:13,929 : INFO : Current training batch loss: 0.3223 in epoch 3
2024-08-12 13:09:14,734 : INFO : Current training batch loss: 0.3764 in epoch 3
2024-08-12 13:09:15,540 : INFO : Current training batch loss: 0.2695 in epoch 3
2024-08-12 13:09:16,345 : INFO : Current training batch loss: 0.1734 in epoch 3
2024-08-12 13:09:16,888 : INFO : Epoch finished, average loss over training batches: 0.2432
2024-08-12 13:09:16,889 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:16,889 : INFO : Training metrics:
2024-08-12 13:09:16,889 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:16,894 : INFO : Accuracy: 0.9166
2024-08-12 13:09:16,894 : INFO : Precision score for label_class 0: 0.8406
2024-08-12 13:09:16,894 : INFO : Precision score for label_class 1: 0.9444
2024-08-12 13:09:16,894 : INFO : Precision score for label_class 2: 0.8924
2024-08-12 13:09:16,894 : INFO : Recall score for label_class 0: 0.8841
2024-08-12 13:09:16,894 : INFO : Recall score for label_class 1: 0.9467
2024-08-12 13:09:16,894 : INFO : Recall score for label_class 2: 0.8682
2024-08-12 13:09:16,894 : INFO : Average F1 score: 0.8958
2024-08-12 13:09:17,174 : INFO : Average loss over validation batches: 0.3464
2024-08-12 13:09:17,174 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:17,174 : INFO : Validation metrics:
2024-08-12 13:09:17,174 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:17,176 : INFO : Accuracy: 0.8800
2024-08-12 13:09:17,177 : INFO : Precision score for label_class 0: 0.8442
2024-08-12 13:09:17,177 : INFO : Precision score for label_class 1: 0.9087
2024-08-12 13:09:17,177 : INFO : Precision score for label_class 2: 0.8246
2024-08-12 13:09:17,177 : INFO : Recall score for label_class 0: 0.7558
2024-08-12 13:09:17,177 : INFO : Recall score for label_class 1: 0.9349
2024-08-12 13:09:17,177 : INFO : Recall score for label_class 2: 0.8103
2024-08-12 13:09:17,177 : INFO : Average F1 score: 0.8455
2024-08-12 13:09:17,177 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 13:09:17,177 : INFO : Starting epoch 4
2024-08-12 13:09:17,419 : INFO : Current training batch loss: 0.4511 in epoch 4
2024-08-12 13:09:18,224 : INFO : Current training batch loss: 0.1198 in epoch 4
2024-08-12 13:09:19,030 : INFO : Current training batch loss: 0.2295 in epoch 4
2024-08-12 13:09:19,836 : INFO : Current training batch loss: 0.0866 in epoch 4
2024-08-12 13:09:20,580 : INFO : Epoch finished, average loss over training batches: 0.1450
2024-08-12 13:09:20,581 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:20,581 : INFO : Training metrics:
2024-08-12 13:09:20,581 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:20,589 : INFO : Accuracy: 0.9559
2024-08-12 13:09:20,589 : INFO : Precision score for label_class 0: 0.8866
2024-08-12 13:09:20,589 : INFO : Precision score for label_class 1: 0.9749
2024-08-12 13:09:20,589 : INFO : Precision score for label_class 2: 0.9474
2024-08-12 13:09:20,589 : INFO : Recall score for label_class 0: 0.9299
2024-08-12 13:09:20,589 : INFO : Recall score for label_class 1: 0.9737
2024-08-12 13:09:20,589 : INFO : Recall score for label_class 2: 0.9302
2024-08-12 13:09:20,589 : INFO : Average F1 score: 0.9403
2024-08-12 13:09:20,869 : INFO : Average loss over validation batches: 0.4295
2024-08-12 13:09:20,869 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:20,869 : INFO : Validation metrics:
2024-08-12 13:09:20,869 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:20,872 : INFO : Accuracy: 0.8504
2024-08-12 13:09:20,872 : INFO : Precision score for label_class 0: 0.8043
2024-08-12 13:09:20,872 : INFO : Precision score for label_class 1: 0.9431
2024-08-12 13:09:20,872 : INFO : Precision score for label_class 2: 0.7103
2024-08-12 13:09:20,872 : INFO : Recall score for label_class 0: 0.8605
2024-08-12 13:09:20,872 : INFO : Recall score for label_class 1: 0.8386
2024-08-12 13:09:20,872 : INFO : Recall score for label_class 2: 0.8736
2024-08-12 13:09:20,872 : INFO : Average F1 score: 0.8342
2024-08-12 13:09:20,872 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 13:09:20,872 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:09:20,904 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 13:09:21,214 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:21,214 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 13:09:21,214 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:21,216 : INFO : Accuracy: 0.8770
2024-08-12 13:09:21,216 : INFO : Precision score for label_class 0: 0.7429
2024-08-12 13:09:21,216 : INFO : Precision score for label_class 1: 0.9353
2024-08-12 13:09:21,216 : INFO : Precision score for label_class 2: 0.8214
2024-08-12 13:09:21,216 : INFO : Recall score for label_class 0: 0.9070
2024-08-12 13:09:21,217 : INFO : Recall score for label_class 1: 0.9060
2024-08-12 13:09:21,217 : INFO : Recall score for label_class 2: 0.7931
2024-08-12 13:09:21,217 : INFO : Average F1 score: 0.8481
2024-08-12 13:09:21,217 : INFO : Determined score from best model, ending training.
2024-08-12 13:09:21,218 : INFO : Split 1 is finished, the score is: 0.8481
2024-08-12 13:09:21,218 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:21,218 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:21,218 : INFO : Starting training for split 2
2024-08-12 13:09:21,235 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 343, 1601,  754]))
2024-08-12 13:09:21,237 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 71, 410, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:09:21,288 : INFO : Starting epoch 1
2024-08-12 13:09:21,330 : INFO : Current training batch loss: 1.0740 in epoch 1
2024-08-12 13:09:22,135 : INFO : Current training batch loss: 1.0170 in epoch 1
2024-08-12 13:09:22,941 : INFO : Current training batch loss: 0.8602 in epoch 1
2024-08-12 13:09:23,746 : INFO : Current training batch loss: 0.7143 in epoch 1
2024-08-12 13:09:24,552 : INFO : Current training batch loss: 0.5412 in epoch 1
2024-08-12 13:09:24,693 : INFO : Epoch finished, average loss over training batches: 0.8082
2024-08-12 13:09:24,693 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:24,693 : INFO : Training metrics:
2024-08-12 13:09:24,693 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:24,704 : INFO : Accuracy: 0.6890
2024-08-12 13:09:24,704 : INFO : Precision score for label_class 0: 0.7593
2024-08-12 13:09:24,704 : INFO : Precision score for label_class 1: 0.6959
2024-08-12 13:09:24,704 : INFO : Precision score for label_class 2: 0.6439
2024-08-12 13:09:24,704 : INFO : Recall score for label_class 0: 0.1195
2024-08-12 13:09:24,704 : INFO : Recall score for label_class 1: 0.9650
2024-08-12 13:09:24,704 : INFO : Recall score for label_class 2: 0.3621
2024-08-12 13:09:24,704 : INFO : Average F1 score: 0.4929
2024-08-12 13:09:24,984 : INFO : Average loss over validation batches: 0.4996
2024-08-12 13:09:24,984 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:24,984 : INFO : Validation metrics:
2024-08-12 13:09:24,984 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:24,987 : INFO : Accuracy: 0.8222
2024-08-12 13:09:24,987 : INFO : Precision score for label_class 0: 0.7200
2024-08-12 13:09:24,987 : INFO : Precision score for label_class 1: 0.8918
2024-08-12 13:09:24,987 : INFO : Precision score for label_class 2: 0.7311
2024-08-12 13:09:24,987 : INFO : Recall score for label_class 0: 0.7606
2024-08-12 13:09:24,987 : INFO : Recall score for label_class 1: 0.8439
2024-08-12 13:09:24,988 : INFO : Recall score for label_class 2: 0.7990
2024-08-12 13:09:24,988 : INFO : Average F1 score: 0.7901
2024-08-12 13:09:24,988 : INFO : Validation metric decreased (inf --> 0.499557).  Saving model ...
2024-08-12 13:09:25,097 : INFO : Starting epoch 2
2024-08-12 13:09:25,741 : INFO : Current training batch loss: 0.4454 in epoch 2
2024-08-12 13:09:26,547 : INFO : Current training batch loss: 0.4145 in epoch 2
2024-08-12 13:09:27,352 : INFO : Current training batch loss: 0.2322 in epoch 2
2024-08-12 13:09:28,158 : INFO : Current training batch loss: 0.3259 in epoch 2
2024-08-12 13:09:28,500 : INFO : Epoch finished, average loss over training batches: 0.3580
2024-08-12 13:09:28,500 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:28,500 : INFO : Training metrics:
2024-08-12 13:09:28,500 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:28,511 : INFO : Accuracy: 0.8784
2024-08-12 13:09:28,511 : INFO : Precision score for label_class 0: 0.8070
2024-08-12 13:09:28,511 : INFO : Precision score for label_class 1: 0.9099
2024-08-12 13:09:28,511 : INFO : Precision score for label_class 2: 0.8414
2024-08-12 13:09:28,511 : INFO : Recall score for label_class 0: 0.8047
2024-08-12 13:09:28,511 : INFO : Recall score for label_class 1: 0.9269
2024-08-12 13:09:28,511 : INFO : Recall score for label_class 2: 0.8090
2024-08-12 13:09:28,511 : INFO : Average F1 score: 0.8497
2024-08-12 13:09:28,791 : INFO : Average loss over validation batches: 0.3709
2024-08-12 13:09:28,791 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:28,791 : INFO : Validation metrics:
2024-08-12 13:09:28,791 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:28,794 : INFO : Accuracy: 0.8726
2024-08-12 13:09:28,794 : INFO : Precision score for label_class 0: 0.7500
2024-08-12 13:09:28,794 : INFO : Precision score for label_class 1: 0.8912
2024-08-12 13:09:28,795 : INFO : Precision score for label_class 2: 0.8802
2024-08-12 13:09:28,795 : INFO : Recall score for label_class 0: 0.8028
2024-08-12 13:09:28,795 : INFO : Recall score for label_class 1: 0.9390
2024-08-12 13:09:28,795 : INFO : Recall score for label_class 2: 0.7577
2024-08-12 13:09:28,795 : INFO : Average F1 score: 0.8348
2024-08-12 13:09:28,795 : INFO : Validation metric decreased (0.499557 --> 0.370910).  Saving model ...
2024-08-12 13:09:28,894 : INFO : Starting epoch 3
2024-08-12 13:09:29,338 : INFO : Current training batch loss: 0.1817 in epoch 3
2024-08-12 13:09:30,143 : INFO : Current training batch loss: 0.1668 in epoch 3
2024-08-12 13:09:30,949 : INFO : Current training batch loss: 0.2855 in epoch 3
2024-08-12 13:09:31,756 : INFO : Current training batch loss: 0.0907 in epoch 3
2024-08-12 13:09:32,299 : INFO : Epoch finished, average loss over training batches: 0.1938
2024-08-12 13:09:32,299 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:32,299 : INFO : Training metrics:
2024-08-12 13:09:32,299 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:32,306 : INFO : Accuracy: 0.9422
2024-08-12 13:09:32,306 : INFO : Precision score for label_class 0: 0.8796
2024-08-12 13:09:32,306 : INFO : Precision score for label_class 1: 0.9620
2024-08-12 13:09:32,306 : INFO : Precision score for label_class 2: 0.9293
2024-08-12 13:09:32,306 : INFO : Recall score for label_class 0: 0.9155
2024-08-12 13:09:32,306 : INFO : Recall score for label_class 1: 0.9644
2024-08-12 13:09:32,306 : INFO : Recall score for label_class 2: 0.9072
2024-08-12 13:09:32,306 : INFO : Average F1 score: 0.9262
2024-08-12 13:09:32,586 : INFO : Average loss over validation batches: 0.4066
2024-08-12 13:09:32,586 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:32,586 : INFO : Validation metrics:
2024-08-12 13:09:32,586 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:32,590 : INFO : Accuracy: 0.8622
2024-08-12 13:09:32,590 : INFO : Precision score for label_class 0: 0.7937
2024-08-12 13:09:32,590 : INFO : Precision score for label_class 1: 0.8727
2024-08-12 13:09:32,590 : INFO : Precision score for label_class 2: 0.8605
2024-08-12 13:09:32,590 : INFO : Recall score for label_class 0: 0.7042
2024-08-12 13:09:32,590 : INFO : Recall score for label_class 1: 0.9366
2024-08-12 13:09:32,590 : INFO : Recall score for label_class 2: 0.7629
2024-08-12 13:09:32,590 : INFO : Average F1 score: 0.8195
2024-08-12 13:09:32,590 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 13:09:32,590 : INFO : Starting epoch 4
2024-08-12 13:09:32,832 : INFO : Current training batch loss: 0.2537 in epoch 4
2024-08-12 13:09:33,639 : INFO : Current training batch loss: 0.0718 in epoch 4
2024-08-12 13:09:34,445 : INFO : Current training batch loss: 0.1594 in epoch 4
2024-08-12 13:09:35,250 : INFO : Current training batch loss: 0.0897 in epoch 4
2024-08-12 13:09:35,994 : INFO : Epoch finished, average loss over training batches: 0.1217
2024-08-12 13:09:35,995 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:35,995 : INFO : Training metrics:
2024-08-12 13:09:35,995 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:36,005 : INFO : Accuracy: 0.9626
2024-08-12 13:09:36,005 : INFO : Precision score for label_class 0: 0.9124
2024-08-12 13:09:36,005 : INFO : Precision score for label_class 1: 0.9758
2024-08-12 13:09:36,005 : INFO : Precision score for label_class 2: 0.9578
2024-08-12 13:09:36,005 : INFO : Recall score for label_class 0: 0.9417
2024-08-12 13:09:36,005 : INFO : Recall score for label_class 1: 0.9806
2024-08-12 13:09:36,005 : INFO : Recall score for label_class 2: 0.9337
2024-08-12 13:09:36,005 : INFO : Average F1 score: 0.9502
2024-08-12 13:09:36,285 : INFO : Average loss over validation batches: 0.4847
2024-08-12 13:09:36,285 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:36,285 : INFO : Validation metrics:
2024-08-12 13:09:36,285 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:36,289 : INFO : Accuracy: 0.8430
2024-08-12 13:09:36,289 : INFO : Precision score for label_class 0: 0.7821
2024-08-12 13:09:36,289 : INFO : Precision score for label_class 1: 0.9067
2024-08-12 13:09:36,289 : INFO : Precision score for label_class 2: 0.7488
2024-08-12 13:09:36,289 : INFO : Recall score for label_class 0: 0.8592
2024-08-12 13:09:36,289 : INFO : Recall score for label_class 1: 0.8537
2024-08-12 13:09:36,289 : INFO : Recall score for label_class 2: 0.8144
2024-08-12 13:09:36,289 : INFO : Average F1 score: 0.8261
2024-08-12 13:09:36,289 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 13:09:36,289 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:09:36,327 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 13:09:36,643 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:36,643 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 13:09:36,643 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:36,646 : INFO : Accuracy: 0.8726
2024-08-12 13:09:36,646 : INFO : Precision score for label_class 0: 0.7500
2024-08-12 13:09:36,646 : INFO : Precision score for label_class 1: 0.8912
2024-08-12 13:09:36,646 : INFO : Precision score for label_class 2: 0.8802
2024-08-12 13:09:36,646 : INFO : Recall score for label_class 0: 0.8028
2024-08-12 13:09:36,646 : INFO : Recall score for label_class 1: 0.9390
2024-08-12 13:09:36,646 : INFO : Recall score for label_class 2: 0.7577
2024-08-12 13:09:36,646 : INFO : Average F1 score: 0.8348
2024-08-12 13:09:36,646 : INFO : Determined score from best model, ending training.
2024-08-12 13:09:36,653 : INFO : Split 2 is finished, the score is: 0.8348
2024-08-12 13:09:36,653 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:36,653 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:36,653 : INFO : Starting training for split 3
2024-08-12 13:09:36,665 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 328, 1611,  759]))
2024-08-12 13:09:36,667 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 86, 400, 189]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:09:36,718 : INFO : Starting epoch 1
2024-08-12 13:09:36,759 : INFO : Current training batch loss: 1.1094 in epoch 1
2024-08-12 13:09:37,565 : INFO : Current training batch loss: 1.0328 in epoch 1
2024-08-12 13:09:38,371 : INFO : Current training batch loss: 0.8306 in epoch 1
2024-08-12 13:09:39,176 : INFO : Current training batch loss: 0.5949 in epoch 1
2024-08-12 13:09:39,982 : INFO : Current training batch loss: 0.7259 in epoch 1
2024-08-12 13:09:40,122 : INFO : Epoch finished, average loss over training batches: 0.8656
2024-08-12 13:09:40,123 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:40,123 : INFO : Training metrics:
2024-08-12 13:09:40,123 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:40,127 : INFO : Accuracy: 0.6108
2024-08-12 13:09:40,127 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:09:40,127 : INFO : Precision score for label_class 1: 0.6863
2024-08-12 13:09:40,127 : INFO : Precision score for label_class 2: 0.4077
2024-08-12 13:09:40,127 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:09:40,127 : INFO : Recall score for label_class 1: 0.8380
2024-08-12 13:09:40,127 : INFO : Recall score for label_class 2: 0.3926
2024-08-12 13:09:40,127 : INFO : Average F1 score: 0.3849
2024-08-12 13:09:40,407 : INFO : Average loss over validation batches: 0.6308
2024-08-12 13:09:40,407 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:40,407 : INFO : Validation metrics:
2024-08-12 13:09:40,407 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:40,410 : INFO : Accuracy: 0.7348
2024-08-12 13:09:40,410 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:09:40,410 : INFO : Precision score for label_class 1: 0.8281
2024-08-12 13:09:40,410 : INFO : Precision score for label_class 2: 0.5579
2024-08-12 13:09:40,410 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:09:40,410 : INFO : Recall score for label_class 1: 0.9150
2024-08-12 13:09:40,410 : INFO : Recall score for label_class 2: 0.6878
2024-08-12 13:09:40,410 : INFO : Average F1 score: 0.4952
2024-08-12 13:09:40,410 : INFO : Validation metric decreased (inf --> 0.630798).  Saving model ...
2024-08-12 13:09:40,520 : INFO : Starting epoch 2
2024-08-12 13:09:41,164 : INFO : Current training batch loss: 0.6487 in epoch 2
2024-08-12 13:09:41,969 : INFO : Current training batch loss: 0.4259 in epoch 2
2024-08-12 13:09:42,774 : INFO : Current training batch loss: 0.4298 in epoch 2
2024-08-12 13:09:43,579 : INFO : Current training batch loss: 0.4182 in epoch 2
2024-08-12 13:09:43,921 : INFO : Epoch finished, average loss over training batches: 0.4811
2024-08-12 13:09:43,921 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:43,921 : INFO : Training metrics:
2024-08-12 13:09:43,921 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:43,928 : INFO : Accuracy: 0.8195
2024-08-12 13:09:43,929 : INFO : Precision score for label_class 0: 0.7427
2024-08-12 13:09:43,929 : INFO : Precision score for label_class 1: 0.8639
2024-08-12 13:09:43,929 : INFO : Precision score for label_class 2: 0.7412
2024-08-12 13:09:43,929 : INFO : Recall score for label_class 0: 0.5457
2024-08-12 13:09:43,929 : INFO : Recall score for label_class 1: 0.9218
2024-08-12 13:09:43,929 : INFO : Recall score for label_class 2: 0.7207
2024-08-12 13:09:43,929 : INFO : Average F1 score: 0.7506
2024-08-12 13:09:44,209 : INFO : Average loss over validation batches: 0.3910
2024-08-12 13:09:44,209 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:44,209 : INFO : Validation metrics:
2024-08-12 13:09:44,209 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:44,212 : INFO : Accuracy: 0.8504
2024-08-12 13:09:44,212 : INFO : Precision score for label_class 0: 0.8140
2024-08-12 13:09:44,212 : INFO : Precision score for label_class 1: 0.9184
2024-08-12 13:09:44,212 : INFO : Precision score for label_class 2: 0.7416
2024-08-12 13:09:44,212 : INFO : Recall score for label_class 0: 0.8140
2024-08-12 13:09:44,212 : INFO : Recall score for label_class 1: 0.8725
2024-08-12 13:09:44,212 : INFO : Recall score for label_class 2: 0.8201
2024-08-12 13:09:44,212 : INFO : Average F1 score: 0.8292
2024-08-12 13:09:44,212 : INFO : Validation metric decreased (0.630798 --> 0.391041).  Saving model ...
2024-08-12 13:09:44,312 : INFO : Starting epoch 3
2024-08-12 13:09:44,755 : INFO : Current training batch loss: 0.2402 in epoch 3
2024-08-12 13:09:45,561 : INFO : Current training batch loss: 0.2677 in epoch 3
2024-08-12 13:09:46,366 : INFO : Current training batch loss: 0.1706 in epoch 3
2024-08-12 13:09:47,172 : INFO : Current training batch loss: 0.0710 in epoch 3
2024-08-12 13:09:47,715 : INFO : Epoch finished, average loss over training batches: 0.2489
2024-08-12 13:09:47,715 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:47,715 : INFO : Training metrics:
2024-08-12 13:09:47,715 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:47,722 : INFO : Accuracy: 0.9251
2024-08-12 13:09:47,722 : INFO : Precision score for label_class 0: 0.8473
2024-08-12 13:09:47,722 : INFO : Precision score for label_class 1: 0.9503
2024-08-12 13:09:47,722 : INFO : Precision score for label_class 2: 0.9068
2024-08-12 13:09:47,722 : INFO : Recall score for label_class 0: 0.8963
2024-08-12 13:09:47,722 : INFO : Recall score for label_class 1: 0.9503
2024-08-12 13:09:47,723 : INFO : Recall score for label_class 2: 0.8841
2024-08-12 13:09:47,723 : INFO : Average F1 score: 0.9056
2024-08-12 13:09:48,002 : INFO : Average loss over validation batches: 0.3914
2024-08-12 13:09:48,002 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:48,002 : INFO : Validation metrics:
2024-08-12 13:09:48,002 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:48,005 : INFO : Accuracy: 0.8607
2024-08-12 13:09:48,005 : INFO : Precision score for label_class 0: 0.9219
2024-08-12 13:09:48,005 : INFO : Precision score for label_class 1: 0.9318
2024-08-12 13:09:48,005 : INFO : Precision score for label_class 2: 0.7261
2024-08-12 13:09:48,005 : INFO : Recall score for label_class 0: 0.6860
2024-08-12 13:09:48,005 : INFO : Recall score for label_class 1: 0.8875
2024-08-12 13:09:48,005 : INFO : Recall score for label_class 2: 0.8836
2024-08-12 13:09:48,005 : INFO : Average F1 score: 0.8310
2024-08-12 13:09:48,005 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 13:09:48,005 : INFO : Starting epoch 4
2024-08-12 13:09:48,247 : INFO : Current training batch loss: 0.3087 in epoch 4
2024-08-12 13:09:49,052 : INFO : Current training batch loss: 0.2350 in epoch 4
2024-08-12 13:09:49,858 : INFO : Current training batch loss: 0.1986 in epoch 4
2024-08-12 13:09:50,663 : INFO : Current training batch loss: 0.1434 in epoch 4
2024-08-12 13:09:51,407 : INFO : Epoch finished, average loss over training batches: 0.1527
2024-08-12 13:09:51,408 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:51,408 : INFO : Training metrics:
2024-08-12 13:09:51,408 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:51,413 : INFO : Accuracy: 0.9574
2024-08-12 13:09:51,414 : INFO : Precision score for label_class 0: 0.8812
2024-08-12 13:09:51,414 : INFO : Precision score for label_class 1: 0.9751
2024-08-12 13:09:51,414 : INFO : Precision score for label_class 2: 0.9544
2024-08-12 13:09:51,414 : INFO : Recall score for label_class 0: 0.9268
2024-08-12 13:09:51,414 : INFO : Recall score for label_class 1: 0.9733
2024-08-12 13:09:51,414 : INFO : Recall score for label_class 2: 0.9368
2024-08-12 13:09:51,414 : INFO : Average F1 score: 0.9410
2024-08-12 13:09:51,694 : INFO : Average loss over validation batches: 0.4095
2024-08-12 13:09:51,694 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:51,694 : INFO : Validation metrics:
2024-08-12 13:09:51,694 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:51,697 : INFO : Accuracy: 0.8652
2024-08-12 13:09:51,697 : INFO : Precision score for label_class 0: 0.7547
2024-08-12 13:09:51,697 : INFO : Precision score for label_class 1: 0.9360
2024-08-12 13:09:51,697 : INFO : Precision score for label_class 2: 0.7887
2024-08-12 13:09:51,697 : INFO : Recall score for label_class 0: 0.9302
2024-08-12 13:09:51,697 : INFO : Recall score for label_class 1: 0.8775
2024-08-12 13:09:51,697 : INFO : Recall score for label_class 2: 0.8095
2024-08-12 13:09:51,697 : INFO : Average F1 score: 0.8460
2024-08-12 13:09:51,697 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 13:09:51,697 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:09:51,735 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 13:09:52,051 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:52,051 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 13:09:52,051 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:52,053 : INFO : Accuracy: 0.8504
2024-08-12 13:09:52,053 : INFO : Precision score for label_class 0: 0.8140
2024-08-12 13:09:52,054 : INFO : Precision score for label_class 1: 0.9184
2024-08-12 13:09:52,054 : INFO : Precision score for label_class 2: 0.7416
2024-08-12 13:09:52,054 : INFO : Recall score for label_class 0: 0.8140
2024-08-12 13:09:52,054 : INFO : Recall score for label_class 1: 0.8725
2024-08-12 13:09:52,054 : INFO : Recall score for label_class 2: 0.8201
2024-08-12 13:09:52,054 : INFO : Average F1 score: 0.8292
2024-08-12 13:09:52,054 : INFO : Determined score from best model, ending training.
2024-08-12 13:09:52,060 : INFO : Split 3 is finished, the score is: 0.8292
2024-08-12 13:09:52,060 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:52,060 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:52,061 : INFO : Starting training for split 4
2024-08-12 13:09:52,072 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 327, 1621,  751]))
2024-08-12 13:09:52,074 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 87, 390, 197]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:09:52,125 : INFO : Starting epoch 1
2024-08-12 13:09:52,167 : INFO : Current training batch loss: 1.0977 in epoch 1
2024-08-12 13:09:52,972 : INFO : Current training batch loss: 1.0220 in epoch 1
2024-08-12 13:09:53,777 : INFO : Current training batch loss: 0.8028 in epoch 1
2024-08-12 13:09:54,583 : INFO : Current training batch loss: 0.6584 in epoch 1
2024-08-12 13:09:55,389 : INFO : Current training batch loss: 0.6342 in epoch 1
2024-08-12 13:09:55,530 : INFO : Epoch finished, average loss over training batches: 0.8373
2024-08-12 13:09:55,531 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:55,531 : INFO : Training metrics:
2024-08-12 13:09:55,531 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:55,538 : INFO : Accuracy: 0.6217
2024-08-12 13:09:55,538 : INFO : Precision score for label_class 0: 0.5000
2024-08-12 13:09:55,538 : INFO : Precision score for label_class 1: 0.6898
2024-08-12 13:09:55,538 : INFO : Precision score for label_class 2: 0.4167
2024-08-12 13:09:55,538 : INFO : Recall score for label_class 0: 0.0275
2024-08-12 13:09:55,538 : INFO : Recall score for label_class 1: 0.8600
2024-08-12 13:09:55,538 : INFO : Recall score for label_class 2: 0.3662
2024-08-12 13:09:55,538 : INFO : Average F1 score: 0.4025
2024-08-12 13:09:55,819 : INFO : Average loss over validation batches: 0.5722
2024-08-12 13:09:55,819 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:55,819 : INFO : Validation metrics:
2024-08-12 13:09:55,819 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:55,822 : INFO : Accuracy: 0.7552
2024-08-12 13:09:55,822 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:09:55,822 : INFO : Precision score for label_class 1: 0.8602
2024-08-12 13:09:55,822 : INFO : Precision score for label_class 2: 0.5869
2024-08-12 13:09:55,822 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:09:55,822 : INFO : Recall score for label_class 1: 0.9154
2024-08-12 13:09:55,822 : INFO : Recall score for label_class 2: 0.7716
2024-08-12 13:09:55,822 : INFO : Average F1 score: 0.5179
2024-08-12 13:09:55,822 : INFO : Validation metric decreased (inf --> 0.572212).  Saving model ...
2024-08-12 13:09:55,932 : INFO : Starting epoch 2
2024-08-12 13:09:56,576 : INFO : Current training batch loss: 0.5988 in epoch 2
2024-08-12 13:09:57,382 : INFO : Current training batch loss: 0.3809 in epoch 2
2024-08-12 13:09:58,188 : INFO : Current training batch loss: 0.2808 in epoch 2
2024-08-12 13:09:58,993 : INFO : Current training batch loss: 0.4608 in epoch 2
2024-08-12 13:09:59,336 : INFO : Epoch finished, average loss over training batches: 0.4267
2024-08-12 13:09:59,336 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:59,336 : INFO : Training metrics:
2024-08-12 13:09:59,336 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:59,340 : INFO : Accuracy: 0.8514
2024-08-12 13:09:59,340 : INFO : Precision score for label_class 0: 0.7581
2024-08-12 13:09:59,340 : INFO : Precision score for label_class 1: 0.8935
2024-08-12 13:09:59,340 : INFO : Precision score for label_class 2: 0.7936
2024-08-12 13:09:59,340 : INFO : Recall score for label_class 0: 0.7187
2024-08-12 13:09:59,340 : INFO : Recall score for label_class 1: 0.9217
2024-08-12 13:09:59,340 : INFO : Recall score for label_class 2: 0.7577
2024-08-12 13:09:59,340 : INFO : Average F1 score: 0.8068
2024-08-12 13:09:59,620 : INFO : Average loss over validation batches: 0.3812
2024-08-12 13:09:59,620 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:59,620 : INFO : Validation metrics:
2024-08-12 13:09:59,620 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:09:59,623 : INFO : Accuracy: 0.8576
2024-08-12 13:09:59,623 : INFO : Precision score for label_class 0: 0.8250
2024-08-12 13:09:59,623 : INFO : Precision score for label_class 1: 0.8793
2024-08-12 13:09:59,623 : INFO : Precision score for label_class 2: 0.8245
2024-08-12 13:09:59,623 : INFO : Recall score for label_class 0: 0.7586
2024-08-12 13:09:59,623 : INFO : Recall score for label_class 1: 0.9154
2024-08-12 13:09:59,623 : INFO : Recall score for label_class 2: 0.7868
2024-08-12 13:09:59,623 : INFO : Average F1 score: 0.8309
2024-08-12 13:09:59,623 : INFO : Validation metric decreased (0.572212 --> 0.381192).  Saving model ...
2024-08-12 13:09:59,723 : INFO : Starting epoch 3
2024-08-12 13:10:00,166 : INFO : Current training batch loss: 0.2308 in epoch 3
2024-08-12 13:10:00,972 : INFO : Current training batch loss: 0.2482 in epoch 3
2024-08-12 13:10:01,777 : INFO : Current training batch loss: 0.1802 in epoch 3
2024-08-12 13:10:02,583 : INFO : Current training batch loss: 0.0872 in epoch 3
2024-08-12 13:10:03,126 : INFO : Epoch finished, average loss over training batches: 0.2289
2024-08-12 13:10:03,127 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:03,127 : INFO : Training metrics:
2024-08-12 13:10:03,127 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:03,130 : INFO : Accuracy: 0.9270
2024-08-12 13:10:03,131 : INFO : Precision score for label_class 0: 0.8494
2024-08-12 13:10:03,131 : INFO : Precision score for label_class 1: 0.9536
2024-08-12 13:10:03,131 : INFO : Precision score for label_class 2: 0.9055
2024-08-12 13:10:03,131 : INFO : Recall score for label_class 0: 0.9144
2024-08-12 13:10:03,131 : INFO : Recall score for label_class 1: 0.9513
2024-08-12 13:10:03,131 : INFO : Recall score for label_class 2: 0.8802
2024-08-12 13:10:03,131 : INFO : Average F1 score: 0.9086
2024-08-12 13:10:03,411 : INFO : Average loss over validation batches: 0.3793
2024-08-12 13:10:03,411 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:03,411 : INFO : Validation metrics:
2024-08-12 13:10:03,411 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:03,414 : INFO : Accuracy: 0.8576
2024-08-12 13:10:03,414 : INFO : Precision score for label_class 0: 0.8442
2024-08-12 13:10:03,414 : INFO : Precision score for label_class 1: 0.8917
2024-08-12 13:10:03,414 : INFO : Precision score for label_class 2: 0.7950
2024-08-12 13:10:03,414 : INFO : Recall score for label_class 0: 0.7471
2024-08-12 13:10:03,414 : INFO : Recall score for label_class 1: 0.9077
2024-08-12 13:10:03,414 : INFO : Recall score for label_class 2: 0.8071
2024-08-12 13:10:03,414 : INFO : Average F1 score: 0.8311
2024-08-12 13:10:03,414 : INFO : Validation metric decreased (0.381192 --> 0.379265).  Saving model ...
2024-08-12 13:10:03,517 : INFO : Starting epoch 4
2024-08-12 13:10:03,759 : INFO : Current training batch loss: 0.3094 in epoch 4
2024-08-12 13:10:04,565 : INFO : Current training batch loss: 0.1973 in epoch 4
2024-08-12 13:10:05,370 : INFO : Current training batch loss: 0.1634 in epoch 4
2024-08-12 13:10:06,176 : INFO : Current training batch loss: 0.1429 in epoch 4
2024-08-12 13:10:06,920 : INFO : Epoch finished, average loss over training batches: 0.1396
2024-08-12 13:10:06,920 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:06,920 : INFO : Training metrics:
2024-08-12 13:10:06,920 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:06,927 : INFO : Accuracy: 0.9570
2024-08-12 13:10:06,928 : INFO : Precision score for label_class 0: 0.8889
2024-08-12 13:10:06,928 : INFO : Precision score for label_class 1: 0.9746
2024-08-12 13:10:06,928 : INFO : Precision score for label_class 2: 0.9501
2024-08-12 13:10:06,928 : INFO : Recall score for label_class 0: 0.9297
2024-08-12 13:10:06,928 : INFO : Recall score for label_class 1: 0.9716
2024-08-12 13:10:06,928 : INFO : Recall score for label_class 2: 0.9374
2024-08-12 13:10:06,928 : INFO : Average F1 score: 0.9419
2024-08-12 13:10:07,208 : INFO : Average loss over validation batches: 0.3983
2024-08-12 13:10:07,208 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:07,208 : INFO : Validation metrics:
2024-08-12 13:10:07,208 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:07,211 : INFO : Accuracy: 0.8620
2024-08-12 13:10:07,211 : INFO : Precision score for label_class 0: 0.7802
2024-08-12 13:10:07,211 : INFO : Precision score for label_class 1: 0.9049
2024-08-12 13:10:07,211 : INFO : Precision score for label_class 2: 0.8144
2024-08-12 13:10:07,211 : INFO : Recall score for label_class 0: 0.8161
2024-08-12 13:10:07,211 : INFO : Recall score for label_class 1: 0.9026
2024-08-12 13:10:07,211 : INFO : Recall score for label_class 2: 0.8020
2024-08-12 13:10:07,211 : INFO : Average F1 score: 0.8366
2024-08-12 13:10:07,211 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 13:10:07,211 : INFO : Starting epoch 5
2024-08-12 13:10:07,253 : INFO : Current training batch loss: 0.0583 in epoch 5
2024-08-12 13:10:08,057 : INFO : Current training batch loss: 0.0682 in epoch 5
2024-08-12 13:10:08,863 : INFO : Current training batch loss: 0.0255 in epoch 5
2024-08-12 13:10:09,669 : INFO : Current training batch loss: 0.0446 in epoch 5
2024-08-12 13:10:10,475 : INFO : Current training batch loss: 0.0312 in epoch 5
2024-08-12 13:10:10,616 : INFO : Epoch finished, average loss over training batches: 0.0828
2024-08-12 13:10:10,616 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:10,616 : INFO : Training metrics:
2024-08-12 13:10:10,616 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:10,623 : INFO : Accuracy: 0.9789
2024-08-12 13:10:10,623 : INFO : Precision score for label_class 0: 0.9263
2024-08-12 13:10:10,623 : INFO : Precision score for label_class 1: 0.9913
2024-08-12 13:10:10,623 : INFO : Precision score for label_class 2: 0.9760
2024-08-12 13:10:10,623 : INFO : Recall score for label_class 0: 0.9602
2024-08-12 13:10:10,623 : INFO : Recall score for label_class 1: 0.9846
2024-08-12 13:10:10,623 : INFO : Recall score for label_class 2: 0.9747
2024-08-12 13:10:10,623 : INFO : Average F1 score: 0.9687
2024-08-12 13:10:10,903 : INFO : Average loss over validation batches: 0.4376
2024-08-12 13:10:10,903 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:10,903 : INFO : Validation metrics:
2024-08-12 13:10:10,903 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:10,907 : INFO : Accuracy: 0.8635
2024-08-12 13:10:10,907 : INFO : Precision score for label_class 0: 0.7238
2024-08-12 13:10:10,907 : INFO : Precision score for label_class 1: 0.8892
2024-08-12 13:10:10,907 : INFO : Precision score for label_class 2: 0.8896
2024-08-12 13:10:10,907 : INFO : Recall score for label_class 0: 0.8736
2024-08-12 13:10:10,907 : INFO : Recall score for label_class 1: 0.9256
2024-08-12 13:10:10,907 : INFO : Recall score for label_class 2: 0.7360
2024-08-12 13:10:10,907 : INFO : Average F1 score: 0.8348
2024-08-12 13:10:10,907 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 13:10:10,907 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:10:10,945 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 13:10:11,261 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:11,261 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 13:10:11,261 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:11,264 : INFO : Accuracy: 0.8576
2024-08-12 13:10:11,264 : INFO : Precision score for label_class 0: 0.8442
2024-08-12 13:10:11,264 : INFO : Precision score for label_class 1: 0.8917
2024-08-12 13:10:11,264 : INFO : Precision score for label_class 2: 0.7950
2024-08-12 13:10:11,264 : INFO : Recall score for label_class 0: 0.7471
2024-08-12 13:10:11,264 : INFO : Recall score for label_class 1: 0.9077
2024-08-12 13:10:11,264 : INFO : Recall score for label_class 2: 0.8071
2024-08-12 13:10:11,264 : INFO : Average F1 score: 0.8311
2024-08-12 13:10:11,264 : INFO : Determined score from best model, ending training.
2024-08-12 13:10:11,271 : INFO : Split 4 is finished, the score is: 0.8311
2024-08-12 13:10:11,271 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:11,271 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:11,271 : INFO : Starting training for split 5
2024-08-12 13:10:11,282 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 330, 1615,  754]))
2024-08-12 13:10:11,284 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 84, 396, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:10:11,335 : INFO : Starting epoch 1
2024-08-12 13:10:11,377 : INFO : Current training batch loss: 1.0782 in epoch 1
2024-08-12 13:10:12,183 : INFO : Current training batch loss: 1.0133 in epoch 1
2024-08-12 13:10:12,988 : INFO : Current training batch loss: 0.7694 in epoch 1
2024-08-12 13:10:13,794 : INFO : Current training batch loss: 0.6376 in epoch 1
2024-08-12 13:10:14,600 : INFO : Current training batch loss: 0.6898 in epoch 1
2024-08-12 13:10:14,741 : INFO : Epoch finished, average loss over training batches: 0.8219
2024-08-12 13:10:14,741 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:14,741 : INFO : Training metrics:
2024-08-12 13:10:14,741 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:14,752 : INFO : Accuracy: 0.6747
2024-08-12 13:10:14,752 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:10:14,752 : INFO : Precision score for label_class 1: 0.6998
2024-08-12 13:10:14,752 : INFO : Precision score for label_class 2: 0.5570
2024-08-12 13:10:14,752 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:10:14,752 : INFO : Recall score for label_class 1: 0.9641
2024-08-12 13:10:14,752 : INFO : Recall score for label_class 2: 0.3501
2024-08-12 13:10:14,752 : INFO : Average F1 score: 0.4136
2024-08-12 13:10:15,032 : INFO : Average loss over validation batches: 0.5740
2024-08-12 13:10:15,033 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:15,033 : INFO : Validation metrics:
2024-08-12 13:10:15,033 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:15,036 : INFO : Accuracy: 0.7463
2024-08-12 13:10:15,036 : INFO : Precision score for label_class 0: 1.0000
2024-08-12 13:10:15,036 : INFO : Precision score for label_class 1: 0.8281
2024-08-12 13:10:15,036 : INFO : Precision score for label_class 2: 0.5815
2024-08-12 13:10:15,036 : INFO : Recall score for label_class 0: 0.0595
2024-08-12 13:10:15,036 : INFO : Recall score for label_class 1: 0.9242
2024-08-12 13:10:15,036 : INFO : Recall score for label_class 2: 0.6804
2024-08-12 13:10:15,036 : INFO : Average F1 score: 0.5376
2024-08-12 13:10:15,036 : INFO : Validation metric decreased (inf --> 0.573977).  Saving model ...
2024-08-12 13:10:15,141 : INFO : Starting epoch 2
2024-08-12 13:10:15,786 : INFO : Current training batch loss: 0.5190 in epoch 2
2024-08-12 13:10:16,591 : INFO : Current training batch loss: 0.3827 in epoch 2
2024-08-12 13:10:17,396 : INFO : Current training batch loss: 0.2779 in epoch 2
2024-08-12 13:10:18,201 : INFO : Current training batch loss: 0.3351 in epoch 2
2024-08-12 13:10:18,544 : INFO : Epoch finished, average loss over training batches: 0.4323
2024-08-12 13:10:18,544 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:18,544 : INFO : Training metrics:
2024-08-12 13:10:18,544 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:18,554 : INFO : Accuracy: 0.8485
2024-08-12 13:10:18,555 : INFO : Precision score for label_class 0: 0.7588
2024-08-12 13:10:18,555 : INFO : Precision score for label_class 1: 0.8855
2024-08-12 13:10:18,555 : INFO : Precision score for label_class 2: 0.7994
2024-08-12 13:10:18,555 : INFO : Recall score for label_class 0: 0.7152
2024-08-12 13:10:18,555 : INFO : Recall score for label_class 1: 0.9238
2024-08-12 13:10:18,555 : INFO : Recall score for label_class 2: 0.7454
2024-08-12 13:10:18,555 : INFO : Average F1 score: 0.8040
2024-08-12 13:10:18,834 : INFO : Average loss over validation batches: 0.4038
2024-08-12 13:10:18,835 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:18,835 : INFO : Validation metrics:
2024-08-12 13:10:18,835 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:18,838 : INFO : Accuracy: 0.8457
2024-08-12 13:10:18,838 : INFO : Precision score for label_class 0: 0.8000
2024-08-12 13:10:18,838 : INFO : Precision score for label_class 1: 0.8642
2024-08-12 13:10:18,838 : INFO : Precision score for label_class 2: 0.8192
2024-08-12 13:10:18,838 : INFO : Recall score for label_class 0: 0.6667
2024-08-12 13:10:18,838 : INFO : Recall score for label_class 1: 0.9318
2024-08-12 13:10:18,838 : INFO : Recall score for label_class 2: 0.7474
2024-08-12 13:10:18,838 : INFO : Average F1 score: 0.8019
2024-08-12 13:10:18,838 : INFO : Validation metric decreased (0.573977 --> 0.403758).  Saving model ...
2024-08-12 13:10:18,938 : INFO : Starting epoch 3
2024-08-12 13:10:19,381 : INFO : Current training batch loss: 0.2121 in epoch 3
2024-08-12 13:10:20,186 : INFO : Current training batch loss: 0.3538 in epoch 3
2024-08-12 13:10:20,991 : INFO : Current training batch loss: 0.2249 in epoch 3
2024-08-12 13:10:21,795 : INFO : Current training batch loss: 0.1654 in epoch 3
2024-08-12 13:10:22,338 : INFO : Epoch finished, average loss over training batches: 0.2369
2024-08-12 13:10:22,339 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:22,339 : INFO : Training metrics:
2024-08-12 13:10:22,339 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:22,346 : INFO : Accuracy: 0.9222
2024-08-12 13:10:22,346 : INFO : Precision score for label_class 0: 0.8509
2024-08-12 13:10:22,346 : INFO : Precision score for label_class 1: 0.9489
2024-08-12 13:10:22,346 : INFO : Precision score for label_class 2: 0.8963
2024-08-12 13:10:22,346 : INFO : Recall score for label_class 0: 0.8818
2024-08-12 13:10:22,346 : INFO : Recall score for label_class 1: 0.9542
2024-08-12 13:10:22,346 : INFO : Recall score for label_class 2: 0.8714
2024-08-12 13:10:22,346 : INFO : Average F1 score: 0.9004
2024-08-12 13:10:22,626 : INFO : Average loss over validation batches: 0.3984
2024-08-12 13:10:22,626 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:22,626 : INFO : Validation metrics:
2024-08-12 13:10:22,626 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:22,630 : INFO : Accuracy: 0.8591
2024-08-12 13:10:22,630 : INFO : Precision score for label_class 0: 0.8133
2024-08-12 13:10:22,630 : INFO : Precision score for label_class 1: 0.8843
2024-08-12 13:10:22,630 : INFO : Precision score for label_class 2: 0.8207
2024-08-12 13:10:22,630 : INFO : Recall score for label_class 0: 0.7262
2024-08-12 13:10:22,630 : INFO : Recall score for label_class 1: 0.9268
2024-08-12 13:10:22,630 : INFO : Recall score for label_class 2: 0.7784
2024-08-12 13:10:22,630 : INFO : Average F1 score: 0.8238
2024-08-12 13:10:22,630 : INFO : Validation metric decreased (0.403758 --> 0.398362).  Saving model ...
2024-08-12 13:10:22,729 : INFO : Starting epoch 4
2024-08-12 13:10:22,972 : INFO : Current training batch loss: 0.3364 in epoch 4
2024-08-12 13:10:23,777 : INFO : Current training batch loss: 0.2200 in epoch 4
2024-08-12 13:10:24,581 : INFO : Current training batch loss: 0.1164 in epoch 4
2024-08-12 13:10:25,386 : INFO : Current training batch loss: 0.0567 in epoch 4
2024-08-12 13:10:26,129 : INFO : Epoch finished, average loss over training batches: 0.1319
2024-08-12 13:10:26,129 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:26,129 : INFO : Training metrics:
2024-08-12 13:10:26,129 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:26,137 : INFO : Accuracy: 0.9622
2024-08-12 13:10:26,137 : INFO : Precision score for label_class 0: 0.9072
2024-08-12 13:10:26,137 : INFO : Precision score for label_class 1: 0.9777
2024-08-12 13:10:26,137 : INFO : Precision score for label_class 2: 0.9539
2024-08-12 13:10:26,137 : INFO : Recall score for label_class 0: 0.9485
2024-08-12 13:10:26,137 : INFO : Recall score for label_class 1: 0.9783
2024-08-12 13:10:26,137 : INFO : Recall score for label_class 2: 0.9337
2024-08-12 13:10:26,137 : INFO : Average F1 score: 0.9497
2024-08-12 13:10:26,416 : INFO : Average loss over validation batches: 0.4321
2024-08-12 13:10:26,417 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:26,417 : INFO : Validation metrics:
2024-08-12 13:10:26,417 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:26,420 : INFO : Accuracy: 0.8591
2024-08-12 13:10:26,420 : INFO : Precision score for label_class 0: 0.7692
2024-08-12 13:10:26,420 : INFO : Precision score for label_class 1: 0.8992
2024-08-12 13:10:26,420 : INFO : Precision score for label_class 2: 0.8172
2024-08-12 13:10:26,420 : INFO : Recall score for label_class 0: 0.8333
2024-08-12 13:10:26,420 : INFO : Recall score for label_class 1: 0.9015
2024-08-12 13:10:26,420 : INFO : Recall score for label_class 2: 0.7835
2024-08-12 13:10:26,420 : INFO : Average F1 score: 0.8335
2024-08-12 13:10:26,420 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 13:10:26,420 : INFO : Starting epoch 5
2024-08-12 13:10:26,462 : INFO : Current training batch loss: 0.0270 in epoch 5
2024-08-12 13:10:27,265 : INFO : Current training batch loss: 0.0374 in epoch 5
2024-08-12 13:10:28,070 : INFO : Current training batch loss: 0.0185 in epoch 5
2024-08-12 13:10:28,875 : INFO : Current training batch loss: 0.0849 in epoch 5
2024-08-12 13:10:29,679 : INFO : Current training batch loss: 0.0218 in epoch 5
2024-08-12 13:10:29,820 : INFO : Epoch finished, average loss over training batches: 0.0884
2024-08-12 13:10:29,821 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:29,821 : INFO : Training metrics:
2024-08-12 13:10:29,821 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:29,831 : INFO : Accuracy: 0.9752
2024-08-12 13:10:29,831 : INFO : Precision score for label_class 0: 0.9215
2024-08-12 13:10:29,831 : INFO : Precision score for label_class 1: 0.9882
2024-08-12 13:10:29,831 : INFO : Precision score for label_class 2: 0.9717
2024-08-12 13:10:29,831 : INFO : Recall score for label_class 0: 0.9606
2024-08-12 13:10:29,831 : INFO : Recall score for label_class 1: 0.9876
2024-08-12 13:10:29,831 : INFO : Recall score for label_class 2: 0.9549
2024-08-12 13:10:29,831 : INFO : Average F1 score: 0.9639
2024-08-12 13:10:30,112 : INFO : Average loss over validation batches: 0.5262
2024-08-12 13:10:30,112 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:30,112 : INFO : Validation metrics:
2024-08-12 13:10:30,112 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:30,115 : INFO : Accuracy: 0.8487
2024-08-12 13:10:30,115 : INFO : Precision score for label_class 0: 0.6698
2024-08-12 13:10:30,115 : INFO : Precision score for label_class 1: 0.9270
2024-08-12 13:10:30,115 : INFO : Precision score for label_class 2: 0.7980
2024-08-12 13:10:30,115 : INFO : Recall score for label_class 0: 0.8452
2024-08-12 13:10:30,115 : INFO : Recall score for label_class 1: 0.8662
2024-08-12 13:10:30,115 : INFO : Recall score for label_class 2: 0.8144
2024-08-12 13:10:30,115 : INFO : Average F1 score: 0.8164
2024-08-12 13:10:30,115 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 13:10:30,115 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:10:30,154 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 13:10:30,469 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:30,469 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 13:10:30,469 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:30,473 : INFO : Accuracy: 0.8591
2024-08-12 13:10:30,473 : INFO : Precision score for label_class 0: 0.8133
2024-08-12 13:10:30,473 : INFO : Precision score for label_class 1: 0.8843
2024-08-12 13:10:30,473 : INFO : Precision score for label_class 2: 0.8207
2024-08-12 13:10:30,473 : INFO : Recall score for label_class 0: 0.7262
2024-08-12 13:10:30,473 : INFO : Recall score for label_class 1: 0.9268
2024-08-12 13:10:30,473 : INFO : Recall score for label_class 2: 0.7784
2024-08-12 13:10:30,473 : INFO : Average F1 score: 0.8238
2024-08-12 13:10:30,473 : INFO : Determined score from best model, ending training.
2024-08-12 13:10:30,475 : INFO : Split 5 is finished, the score is: 0.8238
2024-08-12 13:10:30,475 : INFO : ----------------------------------------------------------------------------------------------------
[I 2024-08-12 13:10:30,475] Trial 14 finished with value: 0.8333958655063064 and parameters: {'n_epochs': 9, 'learning_rate': 6.72730331549222e-05, 'classifier_dropout': 0.5963156628721296, 'warmup_step_fraction': 0.05956491213814927, 'use_gradient_clipping': False}. Best is trial 13 with value: 0.845151673471549.
2024-08-12 13:10:30,489 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:30,489 : INFO : Starting training for split 1
2024-08-12 13:10:30,499 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 328, 1596,  774]))
2024-08-12 13:10:30,502 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 86, 415, 174]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:10:30,552 : INFO : Starting epoch 1
2024-08-12 13:10:30,594 : INFO : Current training batch loss: 1.1011 in epoch 1
2024-08-12 13:10:31,398 : INFO : Current training batch loss: 0.8554 in epoch 1
2024-08-12 13:10:32,203 : INFO : Current training batch loss: 0.8471 in epoch 1
2024-08-12 13:10:33,007 : INFO : Current training batch loss: 0.6838 in epoch 1
2024-08-12 13:10:33,812 : INFO : Current training batch loss: 0.7085 in epoch 1
2024-08-12 13:10:33,953 : INFO : Epoch finished, average loss over training batches: 0.8280
2024-08-12 13:10:33,953 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:33,953 : INFO : Training metrics:
2024-08-12 13:10:33,953 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:33,962 : INFO : Accuracy: 0.6512
2024-08-12 13:10:33,962 : INFO : Precision score for label_class 0: 0.2812
2024-08-12 13:10:33,962 : INFO : Precision score for label_class 1: 0.7003
2024-08-12 13:10:33,962 : INFO : Precision score for label_class 2: 0.5064
2024-08-12 13:10:33,962 : INFO : Recall score for label_class 0: 0.0549
2024-08-12 13:10:33,962 : INFO : Recall score for label_class 1: 0.9167
2024-08-12 13:10:33,962 : INFO : Recall score for label_class 2: 0.3566
2024-08-12 13:10:33,962 : INFO : Average F1 score: 0.4348
2024-08-12 13:10:34,241 : INFO : Average loss over validation batches: 0.6198
2024-08-12 13:10:34,242 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:34,242 : INFO : Validation metrics:
2024-08-12 13:10:34,242 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:34,244 : INFO : Accuracy: 0.7467
2024-08-12 13:10:34,244 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:10:34,244 : INFO : Precision score for label_class 1: 0.8453
2024-08-12 13:10:34,244 : INFO : Precision score for label_class 2: 0.5370
2024-08-12 13:10:34,244 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:10:34,244 : INFO : Recall score for label_class 1: 0.9349
2024-08-12 13:10:34,244 : INFO : Recall score for label_class 2: 0.6667
2024-08-12 13:10:34,244 : INFO : Average F1 score: 0.4942
2024-08-12 13:10:34,244 : INFO : Validation metric decreased (inf --> 0.619822).  Saving model ...
2024-08-12 13:10:34,355 : INFO : Starting epoch 2
2024-08-12 13:10:34,998 : INFO : Current training batch loss: 0.3474 in epoch 2
2024-08-12 13:10:35,802 : INFO : Current training batch loss: 0.5395 in epoch 2
2024-08-12 13:10:36,607 : INFO : Current training batch loss: 0.3583 in epoch 2
2024-08-12 13:10:37,412 : INFO : Current training batch loss: 0.3502 in epoch 2
2024-08-12 13:10:37,753 : INFO : Epoch finished, average loss over training batches: 0.4637
2024-08-12 13:10:37,754 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:37,754 : INFO : Training metrics:
2024-08-12 13:10:37,754 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:37,762 : INFO : Accuracy: 0.8421
2024-08-12 13:10:37,762 : INFO : Precision score for label_class 0: 0.7860
2024-08-12 13:10:37,762 : INFO : Precision score for label_class 1: 0.8822
2024-08-12 13:10:37,762 : INFO : Precision score for label_class 2: 0.7712
2024-08-12 13:10:37,762 : INFO : Recall score for label_class 0: 0.5823
2024-08-12 13:10:37,762 : INFO : Recall score for label_class 1: 0.9342
2024-08-12 13:10:37,762 : INFO : Recall score for label_class 2: 0.7623
2024-08-12 13:10:37,762 : INFO : Average F1 score: 0.7811
2024-08-12 13:10:38,041 : INFO : Average loss over validation batches: 0.3680
2024-08-12 13:10:38,041 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:38,041 : INFO : Validation metrics:
2024-08-12 13:10:38,041 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:38,045 : INFO : Accuracy: 0.8667
2024-08-12 13:10:38,045 : INFO : Precision score for label_class 0: 0.7604
2024-08-12 13:10:38,045 : INFO : Precision score for label_class 1: 0.9050
2024-08-12 13:10:38,045 : INFO : Precision score for label_class 2: 0.8291
2024-08-12 13:10:38,045 : INFO : Recall score for label_class 0: 0.8488
2024-08-12 13:10:38,045 : INFO : Recall score for label_class 1: 0.9181
2024-08-12 13:10:38,045 : INFO : Recall score for label_class 2: 0.7529
2024-08-12 13:10:38,045 : INFO : Average F1 score: 0.8343
2024-08-12 13:10:38,045 : INFO : Validation metric decreased (0.619822 --> 0.368033).  Saving model ...
2024-08-12 13:10:38,145 : INFO : Starting epoch 3
2024-08-12 13:10:38,589 : INFO : Current training batch loss: 0.3872 in epoch 3
2024-08-12 13:10:39,394 : INFO : Current training batch loss: 0.2608 in epoch 3
2024-08-12 13:10:40,199 : INFO : Current training batch loss: 0.2532 in epoch 3
2024-08-12 13:10:41,004 : INFO : Current training batch loss: 0.1695 in epoch 3
2024-08-12 13:10:41,546 : INFO : Epoch finished, average loss over training batches: 0.2742
2024-08-12 13:10:41,547 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:41,547 : INFO : Training metrics:
2024-08-12 13:10:41,547 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:41,552 : INFO : Accuracy: 0.9140
2024-08-12 13:10:41,552 : INFO : Precision score for label_class 0: 0.8270
2024-08-12 13:10:41,552 : INFO : Precision score for label_class 1: 0.9441
2024-08-12 13:10:41,552 : INFO : Precision score for label_class 2: 0.8890
2024-08-12 13:10:41,552 : INFO : Recall score for label_class 0: 0.8598
2024-08-12 13:10:41,552 : INFO : Recall score for label_class 1: 0.9518
2024-08-12 13:10:41,552 : INFO : Recall score for label_class 2: 0.8592
2024-08-12 13:10:41,552 : INFO : Average F1 score: 0.8883
2024-08-12 13:10:41,831 : INFO : Average loss over validation batches: 0.3273
2024-08-12 13:10:41,831 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:41,831 : INFO : Validation metrics:
2024-08-12 13:10:41,831 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:41,834 : INFO : Accuracy: 0.8859
2024-08-12 13:10:41,834 : INFO : Precision score for label_class 0: 0.7938
2024-08-12 13:10:41,834 : INFO : Precision score for label_class 1: 0.9330
2024-08-12 13:10:41,834 : INFO : Precision score for label_class 2: 0.8286
2024-08-12 13:10:41,834 : INFO : Recall score for label_class 0: 0.8953
2024-08-12 13:10:41,834 : INFO : Recall score for label_class 1: 0.9060
2024-08-12 13:10:41,834 : INFO : Recall score for label_class 2: 0.8333
2024-08-12 13:10:41,834 : INFO : Average F1 score: 0.8639
2024-08-12 13:10:41,834 : INFO : Validation metric decreased (0.368033 --> 0.327347).  Saving model ...
2024-08-12 13:10:41,937 : INFO : Starting epoch 4
2024-08-12 13:10:42,179 : INFO : Current training batch loss: 0.5328 in epoch 4
2024-08-12 13:10:42,984 : INFO : Current training batch loss: 0.1967 in epoch 4
2024-08-12 13:10:43,789 : INFO : Current training batch loss: 0.2847 in epoch 4
2024-08-12 13:10:44,593 : INFO : Current training batch loss: 0.1401 in epoch 4
2024-08-12 13:10:45,336 : INFO : Epoch finished, average loss over training batches: 0.1725
2024-08-12 13:10:45,336 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:45,336 : INFO : Training metrics:
2024-08-12 13:10:45,336 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:45,341 : INFO : Accuracy: 0.9522
2024-08-12 13:10:45,341 : INFO : Precision score for label_class 0: 0.8725
2024-08-12 13:10:45,341 : INFO : Precision score for label_class 1: 0.9677
2024-08-12 13:10:45,341 : INFO : Precision score for label_class 2: 0.9565
2024-08-12 13:10:45,341 : INFO : Recall score for label_class 0: 0.9390
2024-08-12 13:10:45,341 : INFO : Recall score for label_class 1: 0.9756
2024-08-12 13:10:45,341 : INFO : Recall score for label_class 2: 0.9096
2024-08-12 13:10:45,341 : INFO : Average F1 score: 0.9362
2024-08-12 13:10:45,621 : INFO : Average loss over validation batches: 0.5060
2024-08-12 13:10:45,621 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:45,621 : INFO : Validation metrics:
2024-08-12 13:10:45,621 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:45,624 : INFO : Accuracy: 0.8015
2024-08-12 13:10:45,624 : INFO : Precision score for label_class 0: 0.7431
2024-08-12 13:10:45,624 : INFO : Precision score for label_class 1: 0.9619
2024-08-12 13:10:45,624 : INFO : Precision score for label_class 2: 0.6255
2024-08-12 13:10:45,624 : INFO : Recall score for label_class 0: 0.9419
2024-08-12 13:10:45,624 : INFO : Recall score for label_class 1: 0.7301
2024-08-12 13:10:45,624 : INFO : Recall score for label_class 2: 0.9023
2024-08-12 13:10:45,624 : INFO : Average F1 score: 0.7999
2024-08-12 13:10:45,624 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 13:10:45,624 : INFO : Starting epoch 5
2024-08-12 13:10:45,665 : INFO : Current training batch loss: 0.1690 in epoch 5
2024-08-12 13:10:46,470 : INFO : Current training batch loss: 0.2942 in epoch 5
2024-08-12 13:10:47,275 : INFO : Current training batch loss: 0.1175 in epoch 5
2024-08-12 13:10:48,080 : INFO : Current training batch loss: 0.0676 in epoch 5
2024-08-12 13:10:48,886 : INFO : Current training batch loss: 0.0677 in epoch 5
2024-08-12 13:10:49,027 : INFO : Epoch finished, average loss over training batches: 0.1250
2024-08-12 13:10:49,027 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:49,027 : INFO : Training metrics:
2024-08-12 13:10:49,027 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:49,031 : INFO : Accuracy: 0.9696
2024-08-12 13:10:49,032 : INFO : Precision score for label_class 0: 0.9112
2024-08-12 13:10:49,032 : INFO : Precision score for label_class 1: 0.9806
2024-08-12 13:10:49,032 : INFO : Precision score for label_class 2: 0.9734
2024-08-12 13:10:49,032 : INFO : Recall score for label_class 0: 0.9695
2024-08-12 13:10:49,032 : INFO : Recall score for label_class 1: 0.9818
2024-08-12 13:10:49,032 : INFO : Recall score for label_class 2: 0.9444
2024-08-12 13:10:49,032 : INFO : Average F1 score: 0.9598
2024-08-12 13:10:49,311 : INFO : Average loss over validation batches: 0.3231
2024-08-12 13:10:49,312 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:49,312 : INFO : Validation metrics:
2024-08-12 13:10:49,312 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:49,315 : INFO : Accuracy: 0.9022
2024-08-12 13:10:49,315 : INFO : Precision score for label_class 0: 0.8280
2024-08-12 13:10:49,315 : INFO : Precision score for label_class 1: 0.9264
2024-08-12 13:10:49,315 : INFO : Precision score for label_class 2: 0.8820
2024-08-12 13:10:49,315 : INFO : Recall score for label_class 0: 0.8953
2024-08-12 13:10:49,315 : INFO : Recall score for label_class 1: 0.9398
2024-08-12 13:10:49,315 : INFO : Recall score for label_class 2: 0.8161
2024-08-12 13:10:49,315 : INFO : Average F1 score: 0.8804
2024-08-12 13:10:49,315 : INFO : Validation metric decreased (0.327347 --> 0.323144).  Saving model ...
2024-08-12 13:10:49,417 : INFO : Starting epoch 6
2024-08-12 13:10:50,062 : INFO : Current training batch loss: 0.0552 in epoch 6
2024-08-12 13:10:50,867 : INFO : Current training batch loss: 0.0541 in epoch 6
2024-08-12 13:10:51,671 : INFO : Current training batch loss: 0.0304 in epoch 6
2024-08-12 13:10:52,475 : INFO : Current training batch loss: 0.0307 in epoch 6
2024-08-12 13:10:52,817 : INFO : Epoch finished, average loss over training batches: 0.0847
2024-08-12 13:10:52,817 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:52,817 : INFO : Training metrics:
2024-08-12 13:10:52,817 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:52,822 : INFO : Accuracy: 0.9833
2024-08-12 13:10:52,822 : INFO : Precision score for label_class 0: 0.9417
2024-08-12 13:10:52,822 : INFO : Precision score for label_class 1: 0.9906
2024-08-12 13:10:52,822 : INFO : Precision score for label_class 2: 0.9868
2024-08-12 13:10:52,822 : INFO : Recall score for label_class 0: 0.9848
2024-08-12 13:10:52,822 : INFO : Recall score for label_class 1: 0.9906
2024-08-12 13:10:52,822 : INFO : Recall score for label_class 2: 0.9677
2024-08-12 13:10:52,823 : INFO : Average F1 score: 0.9768
2024-08-12 13:10:53,102 : INFO : Average loss over validation batches: 0.3351
2024-08-12 13:10:53,102 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:53,102 : INFO : Validation metrics:
2024-08-12 13:10:53,102 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:53,106 : INFO : Accuracy: 0.8948
2024-08-12 13:10:53,106 : INFO : Precision score for label_class 0: 0.8041
2024-08-12 13:10:53,106 : INFO : Precision score for label_class 1: 0.9315
2024-08-12 13:10:53,106 : INFO : Precision score for label_class 2: 0.8580
2024-08-12 13:10:53,106 : INFO : Recall score for label_class 0: 0.9070
2024-08-12 13:10:53,106 : INFO : Recall score for label_class 1: 0.9181
2024-08-12 13:10:53,106 : INFO : Recall score for label_class 2: 0.8333
2024-08-12 13:10:53,106 : INFO : Average F1 score: 0.8742
2024-08-12 13:10:53,106 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 13:10:53,106 : INFO : Starting epoch 7
2024-08-12 13:10:53,548 : INFO : Current training batch loss: 0.1173 in epoch 7
2024-08-12 13:10:54,353 : INFO : Current training batch loss: 0.0332 in epoch 7
2024-08-12 13:10:55,158 : INFO : Current training batch loss: 0.0402 in epoch 7
2024-08-12 13:10:55,963 : INFO : Current training batch loss: 0.0239 in epoch 7
2024-08-12 13:10:56,506 : INFO : Epoch finished, average loss over training batches: 0.0685
2024-08-12 13:10:56,506 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:56,506 : INFO : Training metrics:
2024-08-12 13:10:56,507 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:56,512 : INFO : Accuracy: 0.9870
2024-08-12 13:10:56,512 : INFO : Precision score for label_class 0: 0.9446
2024-08-12 13:10:56,512 : INFO : Precision score for label_class 1: 0.9937
2024-08-12 13:10:56,512 : INFO : Precision score for label_class 2: 0.9921
2024-08-12 13:10:56,512 : INFO : Recall score for label_class 0: 0.9878
2024-08-12 13:10:56,512 : INFO : Recall score for label_class 1: 0.9931
2024-08-12 13:10:56,512 : INFO : Recall score for label_class 2: 0.9742
2024-08-12 13:10:56,512 : INFO : Average F1 score: 0.9807
2024-08-12 13:10:56,792 : INFO : Average loss over validation batches: 0.3375
2024-08-12 13:10:56,792 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:56,792 : INFO : Validation metrics:
2024-08-12 13:10:56,792 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:56,795 : INFO : Accuracy: 0.8889
2024-08-12 13:10:56,795 : INFO : Precision score for label_class 0: 0.8242
2024-08-12 13:10:56,795 : INFO : Precision score for label_class 1: 0.9289
2024-08-12 13:10:56,795 : INFO : Precision score for label_class 2: 0.8295
2024-08-12 13:10:56,795 : INFO : Recall score for label_class 0: 0.8721
2024-08-12 13:10:56,795 : INFO : Recall score for label_class 1: 0.9133
2024-08-12 13:10:56,795 : INFO : Recall score for label_class 2: 0.8391
2024-08-12 13:10:56,795 : INFO : Average F1 score: 0.8676
2024-08-12 13:10:56,795 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 13:10:56,795 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:10:56,836 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 13:10:57,155 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:57,155 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 13:10:57,155 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:57,159 : INFO : Accuracy: 0.9022
2024-08-12 13:10:57,159 : INFO : Precision score for label_class 0: 0.8280
2024-08-12 13:10:57,159 : INFO : Precision score for label_class 1: 0.9264
2024-08-12 13:10:57,159 : INFO : Precision score for label_class 2: 0.8820
2024-08-12 13:10:57,159 : INFO : Recall score for label_class 0: 0.8953
2024-08-12 13:10:57,159 : INFO : Recall score for label_class 1: 0.9398
2024-08-12 13:10:57,159 : INFO : Recall score for label_class 2: 0.8161
2024-08-12 13:10:57,159 : INFO : Average F1 score: 0.8804
2024-08-12 13:10:57,159 : INFO : Determined score from best model, ending training.
2024-08-12 13:10:57,166 : INFO : Split 1 is finished, the score is: 0.8804
2024-08-12 13:10:57,166 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:57,166 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:10:57,166 : INFO : Starting training for split 2
2024-08-12 13:10:57,177 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 343, 1601,  754]))
2024-08-12 13:10:57,179 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 71, 410, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:10:57,232 : INFO : Starting epoch 1
2024-08-12 13:10:57,274 : INFO : Current training batch loss: 1.1065 in epoch 1
2024-08-12 13:10:58,079 : INFO : Current training batch loss: 0.9908 in epoch 1
2024-08-12 13:10:58,884 : INFO : Current training batch loss: 0.8415 in epoch 1
2024-08-12 13:10:59,689 : INFO : Current training batch loss: 0.7253 in epoch 1
2024-08-12 13:11:00,494 : INFO : Current training batch loss: 0.7772 in epoch 1
2024-08-12 13:11:00,635 : INFO : Epoch finished, average loss over training batches: 0.8296
2024-08-12 13:11:00,635 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:00,635 : INFO : Training metrics:
2024-08-12 13:11:00,635 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:00,646 : INFO : Accuracy: 0.6460
2024-08-12 13:11:00,646 : INFO : Precision score for label_class 0: 0.2823
2024-08-12 13:11:00,646 : INFO : Precision score for label_class 1: 0.6935
2024-08-12 13:11:00,646 : INFO : Precision score for label_class 2: 0.5213
2024-08-12 13:11:00,646 : INFO : Recall score for label_class 0: 0.1020
2024-08-12 13:11:00,646 : INFO : Recall score for label_class 1: 0.9213
2024-08-12 13:11:00,646 : INFO : Recall score for label_class 2: 0.3090
2024-08-12 13:11:00,646 : INFO : Average F1 score: 0.4431
2024-08-12 13:11:00,925 : INFO : Average loss over validation batches: 0.6192
2024-08-12 13:11:00,925 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:00,925 : INFO : Validation metrics:
2024-08-12 13:11:00,925 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:00,929 : INFO : Accuracy: 0.7630
2024-08-12 13:11:00,929 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:11:00,929 : INFO : Precision score for label_class 1: 0.8578
2024-08-12 13:11:00,929 : INFO : Precision score for label_class 2: 0.5976
2024-08-12 13:11:00,929 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:11:00,929 : INFO : Recall score for label_class 1: 0.8976
2024-08-12 13:11:00,929 : INFO : Recall score for label_class 2: 0.7577
2024-08-12 13:11:00,929 : INFO : Average F1 score: 0.5151
2024-08-12 13:11:00,929 : INFO : Validation metric decreased (inf --> 0.619193).  Saving model ...
2024-08-12 13:11:01,039 : INFO : Starting epoch 2
2024-08-12 13:11:01,684 : INFO : Current training batch loss: 0.5857 in epoch 2
2024-08-12 13:11:02,489 : INFO : Current training batch loss: 0.6143 in epoch 2
2024-08-12 13:11:03,293 : INFO : Current training batch loss: 0.4206 in epoch 2
2024-08-12 13:11:04,098 : INFO : Current training batch loss: 0.3913 in epoch 2
2024-08-12 13:11:04,440 : INFO : Epoch finished, average loss over training batches: 0.4946
2024-08-12 13:11:04,441 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:04,441 : INFO : Training metrics:
2024-08-12 13:11:04,441 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:04,448 : INFO : Accuracy: 0.8306
2024-08-12 13:11:04,448 : INFO : Precision score for label_class 0: 0.7390
2024-08-12 13:11:04,448 : INFO : Precision score for label_class 1: 0.8713
2024-08-12 13:11:04,448 : INFO : Precision score for label_class 2: 0.7660
2024-08-12 13:11:04,448 : INFO : Recall score for label_class 0: 0.5860
2024-08-12 13:11:04,448 : INFO : Recall score for label_class 1: 0.9388
2024-08-12 13:11:04,448 : INFO : Recall score for label_class 2: 0.7122
2024-08-12 13:11:04,448 : INFO : Average F1 score: 0.7652
2024-08-12 13:11:04,728 : INFO : Average loss over validation batches: 0.4141
2024-08-12 13:11:04,728 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:04,728 : INFO : Validation metrics:
2024-08-12 13:11:04,728 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:04,732 : INFO : Accuracy: 0.8593
2024-08-12 13:11:04,732 : INFO : Precision score for label_class 0: 0.7297
2024-08-12 13:11:04,732 : INFO : Precision score for label_class 1: 0.8808
2024-08-12 13:11:04,732 : INFO : Precision score for label_class 2: 0.8613
2024-08-12 13:11:04,732 : INFO : Recall score for label_class 0: 0.7606
2024-08-12 13:11:04,732 : INFO : Recall score for label_class 1: 0.9195
2024-08-12 13:11:04,732 : INFO : Recall score for label_class 2: 0.7680
2024-08-12 13:11:04,732 : INFO : Average F1 score: 0.8189
2024-08-12 13:11:04,732 : INFO : Validation metric decreased (0.619193 --> 0.414090).  Saving model ...
2024-08-12 13:11:04,833 : INFO : Starting epoch 3
2024-08-12 13:11:05,276 : INFO : Current training batch loss: 0.3565 in epoch 3
2024-08-12 13:11:06,158 : INFO : Current training batch loss: 0.3392 in epoch 3
2024-08-12 13:11:06,964 : INFO : Current training batch loss: 0.3300 in epoch 3
2024-08-12 13:11:07,770 : INFO : Current training batch loss: 0.1580 in epoch 3
2024-08-12 13:11:08,312 : INFO : Epoch finished, average loss over training batches: 0.2939
2024-08-12 13:11:08,313 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:08,313 : INFO : Training metrics:
2024-08-12 13:11:08,313 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:08,323 : INFO : Accuracy: 0.9073
2024-08-12 13:11:08,323 : INFO : Precision score for label_class 0: 0.8258
2024-08-12 13:11:08,323 : INFO : Precision score for label_class 1: 0.9409
2024-08-12 13:11:08,323 : INFO : Precision score for label_class 2: 0.8735
2024-08-12 13:11:08,323 : INFO : Recall score for label_class 0: 0.8571
2024-08-12 13:11:08,323 : INFO : Recall score for label_class 1: 0.9444
2024-08-12 13:11:08,323 : INFO : Recall score for label_class 2: 0.8515
2024-08-12 13:11:08,323 : INFO : Average F1 score: 0.8821
2024-08-12 13:11:08,603 : INFO : Average loss over validation batches: 0.4180
2024-08-12 13:11:08,603 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:08,603 : INFO : Validation metrics:
2024-08-12 13:11:08,603 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:08,607 : INFO : Accuracy: 0.8578
2024-08-12 13:11:08,607 : INFO : Precision score for label_class 0: 0.7568
2024-08-12 13:11:08,607 : INFO : Precision score for label_class 1: 0.8515
2024-08-12 13:11:08,607 : INFO : Precision score for label_class 2: 0.9301
2024-08-12 13:11:08,607 : INFO : Recall score for label_class 0: 0.7887
2024-08-12 13:11:08,607 : INFO : Recall score for label_class 1: 0.9512
2024-08-12 13:11:08,607 : INFO : Recall score for label_class 2: 0.6856
2024-08-12 13:11:08,607 : INFO : Average F1 score: 0.8201
2024-08-12 13:11:08,607 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 13:11:08,607 : INFO : Starting epoch 4
2024-08-12 13:11:08,849 : INFO : Current training batch loss: 0.3191 in epoch 4
2024-08-12 13:11:09,654 : INFO : Current training batch loss: 0.1243 in epoch 4
2024-08-12 13:11:10,460 : INFO : Current training batch loss: 0.2657 in epoch 4
2024-08-12 13:11:11,265 : INFO : Current training batch loss: 0.1328 in epoch 4
2024-08-12 13:11:12,009 : INFO : Epoch finished, average loss over training batches: 0.1813
2024-08-12 13:11:12,009 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:12,009 : INFO : Training metrics:
2024-08-12 13:11:12,009 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:12,019 : INFO : Accuracy: 0.9481
2024-08-12 13:11:12,020 : INFO : Precision score for label_class 0: 0.8889
2024-08-12 13:11:12,020 : INFO : Precision score for label_class 1: 0.9676
2024-08-12 13:11:12,020 : INFO : Precision score for label_class 2: 0.9346
2024-08-12 13:11:12,020 : INFO : Recall score for label_class 0: 0.9329
2024-08-12 13:11:12,020 : INFO : Recall score for label_class 1: 0.9694
2024-08-12 13:11:12,020 : INFO : Recall score for label_class 2: 0.9098
2024-08-12 13:11:12,020 : INFO : Average F1 score: 0.9336
2024-08-12 13:11:12,300 : INFO : Average loss over validation batches: 0.4401
2024-08-12 13:11:12,300 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:12,300 : INFO : Validation metrics:
2024-08-12 13:11:12,300 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:12,303 : INFO : Accuracy: 0.8415
2024-08-12 13:11:12,303 : INFO : Precision score for label_class 0: 0.7176
2024-08-12 13:11:12,303 : INFO : Precision score for label_class 1: 0.9196
2024-08-12 13:11:12,303 : INFO : Precision score for label_class 2: 0.7558
2024-08-12 13:11:12,303 : INFO : Recall score for label_class 0: 0.8592
2024-08-12 13:11:12,303 : INFO : Recall score for label_class 1: 0.8366
2024-08-12 13:11:12,303 : INFO : Recall score for label_class 2: 0.8454
2024-08-12 13:11:12,303 : INFO : Average F1 score: 0.8187
2024-08-12 13:11:12,303 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 13:11:12,303 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:11:12,342 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 13:11:12,658 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:12,658 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 13:11:12,658 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:12,662 : INFO : Accuracy: 0.8593
2024-08-12 13:11:12,662 : INFO : Precision score for label_class 0: 0.7297
2024-08-12 13:11:12,662 : INFO : Precision score for label_class 1: 0.8808
2024-08-12 13:11:12,662 : INFO : Precision score for label_class 2: 0.8613
2024-08-12 13:11:12,662 : INFO : Recall score for label_class 0: 0.7606
2024-08-12 13:11:12,662 : INFO : Recall score for label_class 1: 0.9195
2024-08-12 13:11:12,662 : INFO : Recall score for label_class 2: 0.7680
2024-08-12 13:11:12,662 : INFO : Average F1 score: 0.8189
2024-08-12 13:11:12,662 : INFO : Determined score from best model, ending training.
2024-08-12 13:11:12,663 : INFO : Split 2 is finished, the score is: 0.8189
2024-08-12 13:11:12,664 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:12,664 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:12,664 : INFO : Starting training for split 3
2024-08-12 13:11:12,675 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 328, 1611,  759]))
2024-08-12 13:11:12,677 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 86, 400, 189]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:11:12,718 : INFO : Starting epoch 1
2024-08-12 13:11:12,760 : INFO : Current training batch loss: 1.0894 in epoch 1
2024-08-12 13:11:13,566 : INFO : Current training batch loss: 0.9907 in epoch 1
2024-08-12 13:11:14,371 : INFO : Current training batch loss: 0.7914 in epoch 1
2024-08-12 13:11:15,176 : INFO : Current training batch loss: 0.7149 in epoch 1
2024-08-12 13:11:15,982 : INFO : Current training batch loss: 0.7081 in epoch 1
2024-08-12 13:11:16,116 : INFO : Epoch finished, average loss over training batches: 0.8218
2024-08-12 13:11:16,116 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:16,116 : INFO : Training metrics:
2024-08-12 13:11:16,116 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:16,125 : INFO : Accuracy: 0.6709
2024-08-12 13:11:16,125 : INFO : Precision score for label_class 0: 0.2632
2024-08-12 13:11:16,125 : INFO : Precision score for label_class 1: 0.6995
2024-08-12 13:11:16,125 : INFO : Precision score for label_class 2: 0.5508
2024-08-12 13:11:16,125 : INFO : Recall score for label_class 0: 0.0152
2024-08-12 13:11:16,125 : INFO : Recall score for label_class 1: 0.9621
2024-08-12 13:11:16,125 : INFO : Recall score for label_class 2: 0.3360
2024-08-12 13:11:16,125 : INFO : Average F1 score: 0.4187
2024-08-12 13:11:16,406 : INFO : Average loss over validation batches: 0.6235
2024-08-12 13:11:16,406 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:16,406 : INFO : Validation metrics:
2024-08-12 13:11:16,406 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:16,408 : INFO : Accuracy: 0.7363
2024-08-12 13:11:16,408 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:11:16,408 : INFO : Precision score for label_class 1: 0.8971
2024-08-12 13:11:16,408 : INFO : Precision score for label_class 2: 0.5304
2024-08-12 13:11:16,408 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:11:16,408 : INFO : Recall score for label_class 1: 0.8500
2024-08-12 13:11:16,408 : INFO : Recall score for label_class 2: 0.8307
2024-08-12 13:11:16,408 : INFO : Average F1 score: 0.5068
2024-08-12 13:11:16,408 : INFO : Validation metric decreased (inf --> 0.623529).  Saving model ...
2024-08-12 13:11:16,507 : INFO : Starting epoch 2
2024-08-12 13:11:17,147 : INFO : Current training batch loss: 0.6118 in epoch 2
2024-08-12 13:11:17,947 : INFO : Current training batch loss: 0.4626 in epoch 2
2024-08-12 13:11:18,747 : INFO : Current training batch loss: 0.3711 in epoch 2
2024-08-12 13:11:19,548 : INFO : Current training batch loss: 0.4502 in epoch 2
2024-08-12 13:11:19,881 : INFO : Epoch finished, average loss over training batches: 0.4881
2024-08-12 13:11:19,881 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:19,881 : INFO : Training metrics:
2024-08-12 13:11:19,881 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:19,890 : INFO : Accuracy: 0.8277
2024-08-12 13:11:19,890 : INFO : Precision score for label_class 0: 0.7533
2024-08-12 13:11:19,890 : INFO : Precision score for label_class 1: 0.8805
2024-08-12 13:11:19,890 : INFO : Precision score for label_class 2: 0.7332
2024-08-12 13:11:19,890 : INFO : Recall score for label_class 0: 0.5213
2024-08-12 13:11:19,890 : INFO : Recall score for label_class 1: 0.9286
2024-08-12 13:11:19,890 : INFO : Recall score for label_class 2: 0.7457
2024-08-12 13:11:19,890 : INFO : Average F1 score: 0.7532
2024-08-12 13:11:20,171 : INFO : Average loss over validation batches: 0.4036
2024-08-12 13:11:20,171 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:20,171 : INFO : Validation metrics:
2024-08-12 13:11:20,171 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:20,173 : INFO : Accuracy: 0.8548
2024-08-12 13:11:20,173 : INFO : Precision score for label_class 0: 0.7426
2024-08-12 13:11:20,173 : INFO : Precision score for label_class 1: 0.8897
2024-08-12 13:11:20,173 : INFO : Precision score for label_class 2: 0.8344
2024-08-12 13:11:20,173 : INFO : Recall score for label_class 0: 0.8721
2024-08-12 13:11:20,173 : INFO : Recall score for label_class 1: 0.9275
2024-08-12 13:11:20,173 : INFO : Recall score for label_class 2: 0.6931
2024-08-12 13:11:20,174 : INFO : Average F1 score: 0.8225
2024-08-12 13:11:20,174 : INFO : Validation metric decreased (0.623529 --> 0.403630).  Saving model ...
2024-08-12 13:11:20,276 : INFO : Starting epoch 3
2024-08-12 13:11:20,717 : INFO : Current training batch loss: 0.2912 in epoch 3
2024-08-12 13:11:21,522 : INFO : Current training batch loss: 0.2974 in epoch 3
2024-08-12 13:11:22,328 : INFO : Current training batch loss: 0.2982 in epoch 3
2024-08-12 13:11:23,134 : INFO : Current training batch loss: 0.1560 in epoch 3
2024-08-12 13:11:23,677 : INFO : Epoch finished, average loss over training batches: 0.2708
2024-08-12 13:11:23,677 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:23,677 : INFO : Training metrics:
2024-08-12 13:11:23,677 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:23,683 : INFO : Accuracy: 0.9225
2024-08-12 13:11:23,683 : INFO : Precision score for label_class 0: 0.8338
2024-08-12 13:11:23,684 : INFO : Precision score for label_class 1: 0.9494
2024-08-12 13:11:23,684 : INFO : Precision score for label_class 2: 0.9046
2024-08-12 13:11:23,684 : INFO : Recall score for label_class 0: 0.8720
2024-08-12 13:11:23,684 : INFO : Recall score for label_class 1: 0.9553
2024-08-12 13:11:23,684 : INFO : Recall score for label_class 2: 0.8748
2024-08-12 13:11:23,684 : INFO : Average F1 score: 0.8981
2024-08-12 13:11:23,964 : INFO : Average loss over validation batches: 0.3562
2024-08-12 13:11:23,964 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:23,964 : INFO : Validation metrics:
2024-08-12 13:11:23,964 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:23,966 : INFO : Accuracy: 0.8726
2024-08-12 13:11:23,967 : INFO : Precision score for label_class 0: 0.8471
2024-08-12 13:11:23,967 : INFO : Precision score for label_class 1: 0.9215
2024-08-12 13:11:23,967 : INFO : Precision score for label_class 2: 0.7846
2024-08-12 13:11:23,967 : INFO : Recall score for label_class 0: 0.8372
2024-08-12 13:11:23,967 : INFO : Recall score for label_class 1: 0.9100
2024-08-12 13:11:23,967 : INFO : Recall score for label_class 2: 0.8095
2024-08-12 13:11:23,967 : INFO : Average F1 score: 0.8516
2024-08-12 13:11:23,967 : INFO : Validation metric decreased (0.403630 --> 0.356155).  Saving model ...
2024-08-12 13:11:24,069 : INFO : Starting epoch 4
2024-08-12 13:11:24,312 : INFO : Current training batch loss: 0.3607 in epoch 4
2024-08-12 13:11:25,118 : INFO : Current training batch loss: 0.2410 in epoch 4
2024-08-12 13:11:25,924 : INFO : Current training batch loss: 0.2595 in epoch 4
2024-08-12 13:11:26,730 : INFO : Current training batch loss: 0.0864 in epoch 4
2024-08-12 13:11:27,473 : INFO : Epoch finished, average loss over training batches: 0.1774
2024-08-12 13:11:27,473 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:27,473 : INFO : Training metrics:
2024-08-12 13:11:27,473 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:27,481 : INFO : Accuracy: 0.9533
2024-08-12 13:11:27,481 : INFO : Precision score for label_class 0: 0.8790
2024-08-12 13:11:27,481 : INFO : Precision score for label_class 1: 0.9703
2024-08-12 13:11:27,481 : INFO : Precision score for label_class 2: 0.9512
2024-08-12 13:11:27,481 : INFO : Recall score for label_class 0: 0.9299
2024-08-12 13:11:27,481 : INFO : Recall score for label_class 1: 0.9721
2024-08-12 13:11:27,481 : INFO : Recall score for label_class 2: 0.9236
2024-08-12 13:11:27,481 : INFO : Average F1 score: 0.9373
2024-08-12 13:11:27,761 : INFO : Average loss over validation batches: 0.3901
2024-08-12 13:11:27,761 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:27,761 : INFO : Validation metrics:
2024-08-12 13:11:27,761 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:27,764 : INFO : Accuracy: 0.8622
2024-08-12 13:11:27,764 : INFO : Precision score for label_class 0: 0.7429
2024-08-12 13:11:27,764 : INFO : Precision score for label_class 1: 0.9382
2024-08-12 13:11:27,764 : INFO : Precision score for label_class 2: 0.7828
2024-08-12 13:11:27,764 : INFO : Recall score for label_class 0: 0.9070
2024-08-12 13:11:27,764 : INFO : Recall score for label_class 1: 0.8725
2024-08-12 13:11:27,764 : INFO : Recall score for label_class 2: 0.8201
2024-08-12 13:11:27,764 : INFO : Average F1 score: 0.8406
2024-08-12 13:11:27,764 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 13:11:27,764 : INFO : Starting epoch 5
2024-08-12 13:11:27,805 : INFO : Current training batch loss: 0.1160 in epoch 5
2024-08-12 13:11:28,610 : INFO : Current training batch loss: 0.2744 in epoch 5
2024-08-12 13:11:29,416 : INFO : Current training batch loss: 0.0604 in epoch 5
2024-08-12 13:11:30,222 : INFO : Current training batch loss: 0.1796 in epoch 5
2024-08-12 13:11:31,028 : INFO : Current training batch loss: 0.1625 in epoch 5
2024-08-12 13:11:31,169 : INFO : Epoch finished, average loss over training batches: 0.1318
2024-08-12 13:11:31,169 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:31,169 : INFO : Training metrics:
2024-08-12 13:11:31,169 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:31,175 : INFO : Accuracy: 0.9663
2024-08-12 13:11:31,175 : INFO : Precision score for label_class 0: 0.8892
2024-08-12 13:11:31,175 : INFO : Precision score for label_class 1: 0.9778
2024-08-12 13:11:31,175 : INFO : Precision score for label_class 2: 0.9780
2024-08-12 13:11:31,175 : INFO : Recall score for label_class 0: 0.9543
2024-08-12 13:11:31,175 : INFO : Recall score for label_class 1: 0.9820
2024-08-12 13:11:31,175 : INFO : Recall score for label_class 2: 0.9381
2024-08-12 13:11:31,175 : INFO : Average F1 score: 0.9527
2024-08-12 13:11:31,455 : INFO : Average loss over validation batches: 0.4402
2024-08-12 13:11:31,455 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:31,455 : INFO : Validation metrics:
2024-08-12 13:11:31,455 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:31,458 : INFO : Accuracy: 0.8400
2024-08-12 13:11:31,458 : INFO : Precision score for label_class 0: 0.7429
2024-08-12 13:11:31,458 : INFO : Precision score for label_class 1: 0.9425
2024-08-12 13:11:31,458 : INFO : Precision score for label_class 2: 0.7252
2024-08-12 13:11:31,458 : INFO : Recall score for label_class 0: 0.9070
2024-08-12 13:11:31,458 : INFO : Recall score for label_class 1: 0.8200
2024-08-12 13:11:31,458 : INFO : Recall score for label_class 2: 0.8519
2024-08-12 13:11:31,458 : INFO : Average F1 score: 0.8257
2024-08-12 13:11:31,458 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 13:11:31,458 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:11:31,490 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 13:11:31,796 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:31,796 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 13:11:31,796 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:31,799 : INFO : Accuracy: 0.8726
2024-08-12 13:11:31,799 : INFO : Precision score for label_class 0: 0.8471
2024-08-12 13:11:31,799 : INFO : Precision score for label_class 1: 0.9215
2024-08-12 13:11:31,799 : INFO : Precision score for label_class 2: 0.7846
2024-08-12 13:11:31,799 : INFO : Recall score for label_class 0: 0.8372
2024-08-12 13:11:31,799 : INFO : Recall score for label_class 1: 0.9100
2024-08-12 13:11:31,799 : INFO : Recall score for label_class 2: 0.8095
2024-08-12 13:11:31,799 : INFO : Average F1 score: 0.8516
2024-08-12 13:11:31,799 : INFO : Determined score from best model, ending training.
2024-08-12 13:11:31,800 : INFO : Split 3 is finished, the score is: 0.8516
2024-08-12 13:11:31,800 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:31,800 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:31,800 : INFO : Starting training for split 4
2024-08-12 13:11:31,812 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 327, 1621,  751]))
2024-08-12 13:11:31,814 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 87, 390, 197]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:11:31,853 : INFO : Starting epoch 1
2024-08-12 13:11:31,895 : INFO : Current training batch loss: 1.1174 in epoch 1
2024-08-12 13:11:32,699 : INFO : Current training batch loss: 0.9957 in epoch 1
2024-08-12 13:11:33,505 : INFO : Current training batch loss: 0.7570 in epoch 1
2024-08-12 13:11:34,310 : INFO : Current training batch loss: 0.6884 in epoch 1
2024-08-12 13:11:35,116 : INFO : Current training batch loss: 0.7090 in epoch 1
2024-08-12 13:11:35,257 : INFO : Epoch finished, average loss over training batches: 0.8348
2024-08-12 13:11:35,257 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:35,258 : INFO : Training metrics:
2024-08-12 13:11:35,258 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:35,265 : INFO : Accuracy: 0.6310
2024-08-12 13:11:35,265 : INFO : Precision score for label_class 0: 0.1466
2024-08-12 13:11:35,265 : INFO : Precision score for label_class 1: 0.6959
2024-08-12 13:11:35,265 : INFO : Precision score for label_class 2: 0.5344
2024-08-12 13:11:35,265 : INFO : Recall score for label_class 0: 0.0856
2024-08-12 13:11:35,265 : INFO : Recall score for label_class 1: 0.8896
2024-08-12 13:11:35,265 : INFO : Recall score for label_class 2: 0.3103
2024-08-12 13:11:35,265 : INFO : Average F1 score: 0.4272
2024-08-12 13:11:35,545 : INFO : Average loss over validation batches: 0.6749
2024-08-12 13:11:35,546 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:35,546 : INFO : Validation metrics:
2024-08-12 13:11:35,546 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:35,549 : INFO : Accuracy: 0.7285
2024-08-12 13:11:35,549 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:11:35,549 : INFO : Precision score for label_class 1: 0.7927
2024-08-12 13:11:35,549 : INFO : Precision score for label_class 2: 0.5825
2024-08-12 13:11:35,549 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:11:35,549 : INFO : Recall score for label_class 1: 0.9513
2024-08-12 13:11:35,549 : INFO : Recall score for label_class 2: 0.6091
2024-08-12 13:11:35,549 : INFO : Average F1 score: 0.4868
2024-08-12 13:11:35,549 : INFO : Validation metric decreased (inf --> 0.674873).  Saving model ...
2024-08-12 13:11:35,659 : INFO : Starting epoch 2
2024-08-12 13:11:36,303 : INFO : Current training batch loss: 0.6693 in epoch 2
2024-08-12 13:11:37,108 : INFO : Current training batch loss: 0.4944 in epoch 2
2024-08-12 13:11:37,914 : INFO : Current training batch loss: 0.3668 in epoch 2
2024-08-12 13:11:38,719 : INFO : Current training batch loss: 0.4215 in epoch 2
2024-08-12 13:11:39,061 : INFO : Epoch finished, average loss over training batches: 0.5339
2024-08-12 13:11:39,062 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:39,062 : INFO : Training metrics:
2024-08-12 13:11:39,062 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:39,068 : INFO : Accuracy: 0.8051
2024-08-12 13:11:39,068 : INFO : Precision score for label_class 0: 0.7385
2024-08-12 13:11:39,068 : INFO : Precision score for label_class 1: 0.8674
2024-08-12 13:11:39,068 : INFO : Precision score for label_class 2: 0.6814
2024-08-12 13:11:39,068 : INFO : Recall score for label_class 0: 0.4404
2024-08-12 13:11:39,068 : INFO : Recall score for label_class 1: 0.9284
2024-08-12 13:11:39,068 : INFO : Recall score for label_class 2: 0.6977
2024-08-12 13:11:39,068 : INFO : Average F1 score: 0.7127
2024-08-12 13:11:39,347 : INFO : Average loss over validation batches: 0.4328
2024-08-12 13:11:39,347 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:39,347 : INFO : Validation metrics:
2024-08-12 13:11:39,347 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:39,350 : INFO : Accuracy: 0.8561
2024-08-12 13:11:39,350 : INFO : Precision score for label_class 0: 0.7975
2024-08-12 13:11:39,350 : INFO : Precision score for label_class 1: 0.9072
2024-08-12 13:11:39,350 : INFO : Precision score for label_class 2: 0.7826
2024-08-12 13:11:39,350 : INFO : Recall score for label_class 0: 0.7241
2024-08-12 13:11:39,350 : INFO : Recall score for label_class 1: 0.9026
2024-08-12 13:11:39,350 : INFO : Recall score for label_class 2: 0.8223
2024-08-12 13:11:39,350 : INFO : Average F1 score: 0.8220
2024-08-12 13:11:39,350 : INFO : Validation metric decreased (0.674873 --> 0.432827).  Saving model ...
2024-08-12 13:11:39,450 : INFO : Starting epoch 3
2024-08-12 13:11:39,894 : INFO : Current training batch loss: 0.3778 in epoch 3
2024-08-12 13:11:40,699 : INFO : Current training batch loss: 0.3853 in epoch 3
2024-08-12 13:11:41,505 : INFO : Current training batch loss: 0.3808 in epoch 3
2024-08-12 13:11:42,310 : INFO : Current training batch loss: 0.1567 in epoch 3
2024-08-12 13:11:42,854 : INFO : Epoch finished, average loss over training batches: 0.3191
2024-08-12 13:11:42,854 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:42,854 : INFO : Training metrics:
2024-08-12 13:11:42,854 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:42,859 : INFO : Accuracy: 0.8977
2024-08-12 13:11:42,859 : INFO : Precision score for label_class 0: 0.8274
2024-08-12 13:11:42,859 : INFO : Precision score for label_class 1: 0.9345
2024-08-12 13:11:42,859 : INFO : Precision score for label_class 2: 0.8495
2024-08-12 13:11:42,859 : INFO : Recall score for label_class 0: 0.8502
2024-08-12 13:11:42,859 : INFO : Recall score for label_class 1: 0.9334
2024-08-12 13:11:42,859 : INFO : Recall score for label_class 2: 0.8415
2024-08-12 13:11:42,859 : INFO : Average F1 score: 0.8727
2024-08-12 13:11:43,139 : INFO : Average loss over validation batches: 0.3759
2024-08-12 13:11:43,139 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:43,139 : INFO : Validation metrics:
2024-08-12 13:11:43,139 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:43,142 : INFO : Accuracy: 0.8739
2024-08-12 13:11:43,142 : INFO : Precision score for label_class 0: 0.8608
2024-08-12 13:11:43,142 : INFO : Precision score for label_class 1: 0.9043
2024-08-12 13:11:43,142 : INFO : Precision score for label_class 2: 0.8182
2024-08-12 13:11:43,142 : INFO : Recall score for label_class 0: 0.7816
2024-08-12 13:11:43,142 : INFO : Recall score for label_class 1: 0.9205
2024-08-12 13:11:43,143 : INFO : Recall score for label_class 2: 0.8223
2024-08-12 13:11:43,143 : INFO : Average F1 score: 0.8506
2024-08-12 13:11:43,143 : INFO : Validation metric decreased (0.432827 --> 0.375930).  Saving model ...
2024-08-12 13:11:43,245 : INFO : Starting epoch 4
2024-08-12 13:11:43,488 : INFO : Current training batch loss: 0.4026 in epoch 4
2024-08-12 13:11:44,293 : INFO : Current training batch loss: 0.2331 in epoch 4
2024-08-12 13:11:45,099 : INFO : Current training batch loss: 0.2429 in epoch 4
2024-08-12 13:11:45,904 : INFO : Current training batch loss: 0.1599 in epoch 4
2024-08-12 13:11:46,648 : INFO : Epoch finished, average loss over training batches: 0.1930
2024-08-12 13:11:46,648 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:46,648 : INFO : Training metrics:
2024-08-12 13:11:46,648 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:46,653 : INFO : Accuracy: 0.9459
2024-08-12 13:11:46,653 : INFO : Precision score for label_class 0: 0.8798
2024-08-12 13:11:46,653 : INFO : Precision score for label_class 1: 0.9667
2024-08-12 13:11:46,653 : INFO : Precision score for label_class 2: 0.9308
2024-08-12 13:11:46,653 : INFO : Recall score for label_class 0: 0.9174
2024-08-12 13:11:46,653 : INFO : Recall score for label_class 1: 0.9667
2024-08-12 13:11:46,653 : INFO : Recall score for label_class 2: 0.9134
2024-08-12 13:11:46,653 : INFO : Average F1 score: 0.9290
2024-08-12 13:11:46,933 : INFO : Average loss over validation batches: 0.3567
2024-08-12 13:11:46,933 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:46,933 : INFO : Validation metrics:
2024-08-12 13:11:46,933 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:46,937 : INFO : Accuracy: 0.8709
2024-08-12 13:11:46,937 : INFO : Precision score for label_class 0: 0.7400
2024-08-12 13:11:46,937 : INFO : Precision score for label_class 1: 0.9219
2024-08-12 13:11:46,937 : INFO : Precision score for label_class 2: 0.8368
2024-08-12 13:11:46,937 : INFO : Recall score for label_class 0: 0.8506
2024-08-12 13:11:46,937 : INFO : Recall score for label_class 1: 0.9077
2024-08-12 13:11:46,937 : INFO : Recall score for label_class 2: 0.8071
2024-08-12 13:11:46,937 : INFO : Average F1 score: 0.8426
2024-08-12 13:11:46,937 : INFO : Validation metric decreased (0.375930 --> 0.356719).  Saving model ...
2024-08-12 13:11:47,038 : INFO : Starting epoch 5
2024-08-12 13:11:47,080 : INFO : Current training batch loss: 0.0957 in epoch 5
2024-08-12 13:11:47,885 : INFO : Current training batch loss: 0.1368 in epoch 5
2024-08-12 13:11:48,691 : INFO : Current training batch loss: 0.0524 in epoch 5
2024-08-12 13:11:49,496 : INFO : Current training batch loss: 0.1256 in epoch 5
2024-08-12 13:11:50,303 : INFO : Current training batch loss: 0.2139 in epoch 5
2024-08-12 13:11:50,444 : INFO : Epoch finished, average loss over training batches: 0.1243
2024-08-12 13:11:50,444 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:50,444 : INFO : Training metrics:
2024-08-12 13:11:50,444 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:50,448 : INFO : Accuracy: 0.9700
2024-08-12 13:11:50,448 : INFO : Precision score for label_class 0: 0.9094
2024-08-12 13:11:50,448 : INFO : Precision score for label_class 1: 0.9845
2024-08-12 13:11:50,448 : INFO : Precision score for label_class 2: 0.9664
2024-08-12 13:11:50,448 : INFO : Recall score for label_class 0: 0.9511
2024-08-12 13:11:50,448 : INFO : Recall score for label_class 1: 0.9796
2024-08-12 13:11:50,448 : INFO : Recall score for label_class 2: 0.9574
2024-08-12 13:11:50,448 : INFO : Average F1 score: 0.9579
2024-08-12 13:11:50,728 : INFO : Average loss over validation batches: 0.3638
2024-08-12 13:11:50,728 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:50,728 : INFO : Validation metrics:
2024-08-12 13:11:50,728 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:50,732 : INFO : Accuracy: 0.8798
2024-08-12 13:11:50,732 : INFO : Precision score for label_class 0: 0.7931
2024-08-12 13:11:50,732 : INFO : Precision score for label_class 1: 0.9135
2024-08-12 13:11:50,732 : INFO : Precision score for label_class 2: 0.8505
2024-08-12 13:11:50,732 : INFO : Recall score for label_class 0: 0.7931
2024-08-12 13:11:50,732 : INFO : Recall score for label_class 1: 0.9205
2024-08-12 13:11:50,732 : INFO : Recall score for label_class 2: 0.8376
2024-08-12 13:11:50,732 : INFO : Average F1 score: 0.8514
2024-08-12 13:11:50,732 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 13:11:50,732 : INFO : Starting epoch 6
2024-08-12 13:11:51,376 : INFO : Current training batch loss: 0.1076 in epoch 6
2024-08-12 13:11:52,182 : INFO : Current training batch loss: 0.1185 in epoch 6
2024-08-12 13:11:52,988 : INFO : Current training batch loss: 0.0388 in epoch 6
2024-08-12 13:11:53,795 : INFO : Current training batch loss: 0.0326 in epoch 6
2024-08-12 13:11:54,137 : INFO : Epoch finished, average loss over training batches: 0.0827
2024-08-12 13:11:54,137 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:54,137 : INFO : Training metrics:
2024-08-12 13:11:54,137 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:54,141 : INFO : Accuracy: 0.9818
2024-08-12 13:11:54,141 : INFO : Precision score for label_class 0: 0.9269
2024-08-12 13:11:54,141 : INFO : Precision score for label_class 1: 0.9926
2024-08-12 13:11:54,141 : INFO : Precision score for label_class 2: 0.9839
2024-08-12 13:11:54,141 : INFO : Recall score for label_class 0: 0.9694
2024-08-12 13:11:54,141 : INFO : Recall score for label_class 1: 0.9877
2024-08-12 13:11:54,141 : INFO : Recall score for label_class 2: 0.9747
2024-08-12 13:11:54,141 : INFO : Average F1 score: 0.9724
2024-08-12 13:11:54,421 : INFO : Average loss over validation batches: 0.3893
2024-08-12 13:11:54,421 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:54,421 : INFO : Validation metrics:
2024-08-12 13:11:54,421 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:54,425 : INFO : Accuracy: 0.8798
2024-08-12 13:11:54,425 : INFO : Precision score for label_class 0: 0.8046
2024-08-12 13:11:54,425 : INFO : Precision score for label_class 1: 0.8892
2024-08-12 13:11:54,425 : INFO : Precision score for label_class 2: 0.8953
2024-08-12 13:11:54,425 : INFO : Recall score for label_class 0: 0.8046
2024-08-12 13:11:54,425 : INFO : Recall score for label_class 1: 0.9462
2024-08-12 13:11:54,425 : INFO : Recall score for label_class 2: 0.7817
2024-08-12 13:11:54,425 : INFO : Average F1 score: 0.8520
2024-08-12 13:11:54,425 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 13:11:54,425 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:11:54,464 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 13:11:54,776 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:54,776 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 13:11:54,776 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:54,780 : INFO : Accuracy: 0.8709
2024-08-12 13:11:54,780 : INFO : Precision score for label_class 0: 0.7400
2024-08-12 13:11:54,780 : INFO : Precision score for label_class 1: 0.9219
2024-08-12 13:11:54,780 : INFO : Precision score for label_class 2: 0.8368
2024-08-12 13:11:54,780 : INFO : Recall score for label_class 0: 0.8506
2024-08-12 13:11:54,780 : INFO : Recall score for label_class 1: 0.9077
2024-08-12 13:11:54,780 : INFO : Recall score for label_class 2: 0.8071
2024-08-12 13:11:54,780 : INFO : Average F1 score: 0.8426
2024-08-12 13:11:54,780 : INFO : Determined score from best model, ending training.
2024-08-12 13:11:54,781 : INFO : Split 4 is finished, the score is: 0.8426
2024-08-12 13:11:54,781 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:54,781 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:54,781 : INFO : Starting training for split 5
2024-08-12 13:11:54,792 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 330, 1615,  754]))
2024-08-12 13:11:54,794 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 84, 396, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:11:54,835 : INFO : Starting epoch 1
2024-08-12 13:11:54,877 : INFO : Current training batch loss: 1.0892 in epoch 1
2024-08-12 13:11:55,682 : INFO : Current training batch loss: 0.9886 in epoch 1
2024-08-12 13:11:56,488 : INFO : Current training batch loss: 0.7689 in epoch 1
2024-08-12 13:11:57,293 : INFO : Current training batch loss: 0.6657 in epoch 1
2024-08-12 13:11:58,099 : INFO : Current training batch loss: 0.7684 in epoch 1
2024-08-12 13:11:58,240 : INFO : Epoch finished, average loss over training batches: 0.8086
2024-08-12 13:11:58,240 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:58,240 : INFO : Training metrics:
2024-08-12 13:11:58,240 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:58,251 : INFO : Accuracy: 0.6714
2024-08-12 13:11:58,251 : INFO : Precision score for label_class 0: 0.5926
2024-08-12 13:11:58,251 : INFO : Precision score for label_class 1: 0.6972
2024-08-12 13:11:58,251 : INFO : Precision score for label_class 2: 0.5512
2024-08-12 13:11:58,251 : INFO : Recall score for label_class 0: 0.0485
2024-08-12 13:11:58,252 : INFO : Recall score for label_class 1: 0.9554
2024-08-12 13:11:58,252 : INFO : Recall score for label_class 2: 0.3355
2024-08-12 13:11:58,252 : INFO : Average F1 score: 0.4376
2024-08-12 13:11:58,532 : INFO : Average loss over validation batches: 0.5887
2024-08-12 13:11:58,532 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:58,532 : INFO : Validation metrics:
2024-08-12 13:11:58,533 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:11:58,536 : INFO : Accuracy: 0.7359
2024-08-12 13:11:58,536 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:11:58,536 : INFO : Precision score for label_class 1: 0.8043
2024-08-12 13:11:58,536 : INFO : Precision score for label_class 2: 0.5784
2024-08-12 13:11:58,536 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:11:58,536 : INFO : Recall score for label_class 1: 0.9545
2024-08-12 13:11:58,536 : INFO : Recall score for label_class 2: 0.6082
2024-08-12 13:11:58,536 : INFO : Average F1 score: 0.4886
2024-08-12 13:11:58,536 : INFO : Validation metric decreased (inf --> 0.588680).  Saving model ...
2024-08-12 13:11:58,647 : INFO : Starting epoch 2
2024-08-12 13:11:59,291 : INFO : Current training batch loss: 0.5587 in epoch 2
2024-08-12 13:12:00,096 : INFO : Current training batch loss: 0.4199 in epoch 2
2024-08-12 13:12:00,901 : INFO : Current training batch loss: 0.2644 in epoch 2
2024-08-12 13:12:01,707 : INFO : Current training batch loss: 0.4120 in epoch 2
2024-08-12 13:12:02,050 : INFO : Epoch finished, average loss over training batches: 0.4392
2024-08-12 13:12:02,050 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:02,050 : INFO : Training metrics:
2024-08-12 13:12:02,050 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:02,061 : INFO : Accuracy: 0.8562
2024-08-12 13:12:02,061 : INFO : Precision score for label_class 0: 0.8077
2024-08-12 13:12:02,061 : INFO : Precision score for label_class 1: 0.8854
2024-08-12 13:12:02,061 : INFO : Precision score for label_class 2: 0.8059
2024-08-12 13:12:02,061 : INFO : Recall score for label_class 0: 0.7000
2024-08-12 13:12:02,061 : INFO : Recall score for label_class 1: 0.9331
2024-08-12 13:12:02,061 : INFO : Recall score for label_class 2: 0.7599
2024-08-12 13:12:02,061 : INFO : Average F1 score: 0.8136
2024-08-12 13:12:02,340 : INFO : Average loss over validation batches: 0.4284
2024-08-12 13:12:02,340 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:02,340 : INFO : Validation metrics:
2024-08-12 13:12:02,340 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:02,343 : INFO : Accuracy: 0.8294
2024-08-12 13:12:02,343 : INFO : Precision score for label_class 0: 0.7910
2024-08-12 13:12:02,343 : INFO : Precision score for label_class 1: 0.8532
2024-08-12 13:12:02,343 : INFO : Precision score for label_class 2: 0.7836
2024-08-12 13:12:02,343 : INFO : Recall score for label_class 0: 0.6310
2024-08-12 13:12:02,343 : INFO : Recall score for label_class 1: 0.9394
2024-08-12 13:12:02,343 : INFO : Recall score for label_class 2: 0.6907
2024-08-12 13:12:02,343 : INFO : Average F1 score: 0.7768
2024-08-12 13:12:02,344 : INFO : Validation metric decreased (0.588680 --> 0.428442).  Saving model ...
2024-08-12 13:12:02,443 : INFO : Starting epoch 3
2024-08-12 13:12:02,887 : INFO : Current training batch loss: 0.2046 in epoch 3
2024-08-12 13:12:03,692 : INFO : Current training batch loss: 0.3648 in epoch 3
2024-08-12 13:12:04,498 : INFO : Current training batch loss: 0.3260 in epoch 3
2024-08-12 13:12:05,304 : INFO : Current training batch loss: 0.1622 in epoch 3
2024-08-12 13:12:05,847 : INFO : Epoch finished, average loss over training batches: 0.2464
2024-08-12 13:12:05,847 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:05,847 : INFO : Training metrics:
2024-08-12 13:12:05,847 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:05,858 : INFO : Accuracy: 0.9263
2024-08-12 13:12:05,858 : INFO : Precision score for label_class 0: 0.8643
2024-08-12 13:12:05,858 : INFO : Precision score for label_class 1: 0.9519
2024-08-12 13:12:05,858 : INFO : Precision score for label_class 2: 0.8986
2024-08-12 13:12:05,858 : INFO : Recall score for label_class 0: 0.8879
2024-08-12 13:12:05,858 : INFO : Recall score for label_class 1: 0.9548
2024-08-12 13:12:05,858 : INFO : Recall score for label_class 2: 0.8820
2024-08-12 13:12:05,858 : INFO : Average F1 score: 0.9065
2024-08-12 13:12:06,138 : INFO : Average loss over validation batches: 0.4084
2024-08-12 13:12:06,138 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:06,138 : INFO : Validation metrics:
2024-08-12 13:12:06,138 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:06,142 : INFO : Accuracy: 0.8472
2024-08-12 13:12:06,142 : INFO : Precision score for label_class 0: 0.8028
2024-08-12 13:12:06,142 : INFO : Precision score for label_class 1: 0.8886
2024-08-12 13:12:06,142 : INFO : Precision score for label_class 2: 0.7737
2024-08-12 13:12:06,142 : INFO : Recall score for label_class 0: 0.6786
2024-08-12 13:12:06,142 : INFO : Recall score for label_class 1: 0.9268
2024-08-12 13:12:06,142 : INFO : Recall score for label_class 2: 0.7577
2024-08-12 13:12:06,142 : INFO : Average F1 score: 0.8028
2024-08-12 13:12:06,142 : INFO : Validation metric decreased (0.428442 --> 0.408420).  Saving model ...
2024-08-12 13:12:06,244 : INFO : Starting epoch 4
2024-08-12 13:12:06,485 : INFO : Current training batch loss: 0.3067 in epoch 4
2024-08-12 13:12:07,285 : INFO : Current training batch loss: 0.2224 in epoch 4
2024-08-12 13:12:08,086 : INFO : Current training batch loss: 0.0976 in epoch 4
2024-08-12 13:12:08,886 : INFO : Current training batch loss: 0.0627 in epoch 4
2024-08-12 13:12:09,619 : INFO : Epoch finished, average loss over training batches: 0.1445
2024-08-12 13:12:09,619 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:09,619 : INFO : Training metrics:
2024-08-12 13:12:09,619 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:09,628 : INFO : Accuracy: 0.9596
2024-08-12 13:12:09,628 : INFO : Precision score for label_class 0: 0.9167
2024-08-12 13:12:09,628 : INFO : Precision score for label_class 1: 0.9752
2024-08-12 13:12:09,628 : INFO : Precision score for label_class 2: 0.9451
2024-08-12 13:12:09,628 : INFO : Recall score for label_class 0: 0.9333
2024-08-12 13:12:09,628 : INFO : Recall score for label_class 1: 0.9759
2024-08-12 13:12:09,628 : INFO : Recall score for label_class 2: 0.9363
2024-08-12 13:12:09,628 : INFO : Average F1 score: 0.9471
2024-08-12 13:12:09,908 : INFO : Average loss over validation batches: 0.4143
2024-08-12 13:12:09,908 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:09,908 : INFO : Validation metrics:
2024-08-12 13:12:09,908 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:09,912 : INFO : Accuracy: 0.8457
2024-08-12 13:12:09,912 : INFO : Precision score for label_class 0: 0.7234
2024-08-12 13:12:09,912 : INFO : Precision score for label_class 1: 0.9003
2024-08-12 13:12:09,912 : INFO : Precision score for label_class 2: 0.7937
2024-08-12 13:12:09,912 : INFO : Recall score for label_class 0: 0.8095
2024-08-12 13:12:09,912 : INFO : Recall score for label_class 1: 0.8889
2024-08-12 13:12:09,912 : INFO : Recall score for label_class 2: 0.7732
2024-08-12 13:12:09,912 : INFO : Average F1 score: 0.8140
2024-08-12 13:12:09,912 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 13:12:09,912 : INFO : Starting epoch 5
2024-08-12 13:12:09,953 : INFO : Current training batch loss: 0.0708 in epoch 5
2024-08-12 13:12:10,752 : INFO : Current training batch loss: 0.1839 in epoch 5
2024-08-12 13:12:11,552 : INFO : Current training batch loss: 0.0995 in epoch 5
2024-08-12 13:12:12,352 : INFO : Current training batch loss: 0.0943 in epoch 5
2024-08-12 13:12:13,153 : INFO : Current training batch loss: 0.0330 in epoch 5
2024-08-12 13:12:13,286 : INFO : Epoch finished, average loss over training batches: 0.0897
2024-08-12 13:12:13,287 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:13,287 : INFO : Training metrics:
2024-08-12 13:12:13,287 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:13,296 : INFO : Accuracy: 0.9785
2024-08-12 13:12:13,296 : INFO : Precision score for label_class 0: 0.9435
2024-08-12 13:12:13,296 : INFO : Precision score for label_class 1: 0.9876
2024-08-12 13:12:13,296 : INFO : Precision score for label_class 2: 0.9746
2024-08-12 13:12:13,296 : INFO : Recall score for label_class 0: 0.9606
2024-08-12 13:12:13,296 : INFO : Recall score for label_class 1: 0.9876
2024-08-12 13:12:13,296 : INFO : Recall score for label_class 2: 0.9668
2024-08-12 13:12:13,296 : INFO : Average F1 score: 0.9701
2024-08-12 13:12:13,575 : INFO : Average loss over validation batches: 0.4265
2024-08-12 13:12:13,576 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:13,576 : INFO : Validation metrics:
2024-08-12 13:12:13,576 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:13,579 : INFO : Accuracy: 0.8531
2024-08-12 13:12:13,579 : INFO : Precision score for label_class 0: 0.7586
2024-08-12 13:12:13,579 : INFO : Precision score for label_class 1: 0.9054
2024-08-12 13:12:13,579 : INFO : Precision score for label_class 2: 0.7908
2024-08-12 13:12:13,579 : INFO : Recall score for label_class 0: 0.7857
2024-08-12 13:12:13,579 : INFO : Recall score for label_class 1: 0.8939
2024-08-12 13:12:13,579 : INFO : Recall score for label_class 2: 0.7990
2024-08-12 13:12:13,579 : INFO : Average F1 score: 0.8221
2024-08-12 13:12:13,579 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 13:12:13,579 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:12:13,613 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 13:12:13,928 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:13,928 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 13:12:13,928 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:13,931 : INFO : Accuracy: 0.8472
2024-08-12 13:12:13,931 : INFO : Precision score for label_class 0: 0.8028
2024-08-12 13:12:13,931 : INFO : Precision score for label_class 1: 0.8886
2024-08-12 13:12:13,931 : INFO : Precision score for label_class 2: 0.7737
2024-08-12 13:12:13,931 : INFO : Recall score for label_class 0: 0.6786
2024-08-12 13:12:13,931 : INFO : Recall score for label_class 1: 0.9268
2024-08-12 13:12:13,931 : INFO : Recall score for label_class 2: 0.7577
2024-08-12 13:12:13,932 : INFO : Average F1 score: 0.8028
2024-08-12 13:12:13,932 : INFO : Determined score from best model, ending training.
2024-08-12 13:12:13,933 : INFO : Split 5 is finished, the score is: 0.8028
2024-08-12 13:12:13,933 : INFO : ----------------------------------------------------------------------------------------------------
[I 2024-08-12 13:12:13,933] Trial 15 finished with value: 0.8392448056528223 and parameters: {'n_epochs': 7, 'learning_rate': 4.648920528590328e-05, 'classifier_dropout': 0.8995971579411239, 'warmup_step_fraction': 0.014707551917070372, 'use_gradient_clipping': False}. Best is trial 13 with value: 0.845151673471549.
2024-08-12 13:12:13,947 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:13,947 : INFO : Starting training for split 1
2024-08-12 13:12:13,958 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 328, 1596,  774]))
2024-08-12 13:12:13,960 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 86, 415, 174]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:12:14,010 : INFO : Starting epoch 1
2024-08-12 13:12:14,052 : INFO : Current training batch loss: 1.0989 in epoch 1
2024-08-12 13:12:14,852 : INFO : Current training batch loss: 1.0090 in epoch 1
2024-08-12 13:12:15,652 : INFO : Current training batch loss: 1.0029 in epoch 1
2024-08-12 13:12:16,453 : INFO : Current training batch loss: 0.8203 in epoch 1
2024-08-12 13:12:17,253 : INFO : Current training batch loss: 0.7989 in epoch 1
2024-08-12 13:12:17,387 : INFO : Epoch finished, average loss over training batches: 0.9214
2024-08-12 13:12:17,387 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:17,387 : INFO : Training metrics:
2024-08-12 13:12:17,387 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:17,397 : INFO : Accuracy: 0.6286
2024-08-12 13:12:17,397 : INFO : Precision score for label_class 0: 0.1279
2024-08-12 13:12:17,397 : INFO : Precision score for label_class 1: 0.6573
2024-08-12 13:12:17,397 : INFO : Precision score for label_class 2: 0.5526
2024-08-12 13:12:17,397 : INFO : Recall score for label_class 0: 0.0335
2024-08-12 13:12:17,397 : INFO : Recall score for label_class 1: 0.9505
2024-08-12 13:12:17,397 : INFO : Recall score for label_class 2: 0.2171
2024-08-12 13:12:17,397 : INFO : Average F1 score: 0.3807
2024-08-12 13:12:17,677 : INFO : Average loss over validation batches: 0.7303
2024-08-12 13:12:17,677 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:17,677 : INFO : Validation metrics:
2024-08-12 13:12:17,677 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:17,679 : INFO : Accuracy: 0.7126
2024-08-12 13:12:17,679 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:12:17,679 : INFO : Precision score for label_class 1: 0.8259
2024-08-12 13:12:17,679 : INFO : Precision score for label_class 2: 0.4890
2024-08-12 13:12:17,679 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:12:17,679 : INFO : Recall score for label_class 1: 0.8916
2024-08-12 13:12:17,679 : INFO : Recall score for label_class 2: 0.6379
2024-08-12 13:12:17,679 : INFO : Average F1 score: 0.4704
2024-08-12 13:12:17,679 : INFO : Validation metric decreased (inf --> 0.730291).  Saving model ...
2024-08-12 13:12:17,787 : INFO : Starting epoch 2
2024-08-12 13:12:18,427 : INFO : Current training batch loss: 0.5101 in epoch 2
2024-08-12 13:12:19,226 : INFO : Current training batch loss: 0.6384 in epoch 2
2024-08-12 13:12:20,026 : INFO : Current training batch loss: 0.5782 in epoch 2
2024-08-12 13:12:20,826 : INFO : Current training batch loss: 0.5070 in epoch 2
2024-08-12 13:12:21,159 : INFO : Epoch finished, average loss over training batches: 0.5897
2024-08-12 13:12:21,159 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:21,159 : INFO : Training metrics:
2024-08-12 13:12:21,159 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:21,169 : INFO : Accuracy: 0.7872
2024-08-12 13:12:21,169 : INFO : Precision score for label_class 0: 0.7619
2024-08-12 13:12:21,169 : INFO : Precision score for label_class 1: 0.8509
2024-08-12 13:12:21,169 : INFO : Precision score for label_class 2: 0.6602
2024-08-12 13:12:21,169 : INFO : Recall score for label_class 0: 0.1463
2024-08-12 13:12:21,169 : INFO : Recall score for label_class 1: 0.9405
2024-08-12 13:12:21,169 : INFO : Recall score for label_class 2: 0.7429
2024-08-12 13:12:21,169 : INFO : Average F1 score: 0.6127
2024-08-12 13:12:21,449 : INFO : Average loss over validation batches: 0.4888
2024-08-12 13:12:21,449 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:21,449 : INFO : Validation metrics:
2024-08-12 13:12:21,449 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:21,452 : INFO : Accuracy: 0.8444
2024-08-12 13:12:21,452 : INFO : Precision score for label_class 0: 0.8305
2024-08-12 13:12:21,452 : INFO : Precision score for label_class 1: 0.8810
2024-08-12 13:12:21,452 : INFO : Precision score for label_class 2: 0.7598
2024-08-12 13:12:21,452 : INFO : Recall score for label_class 0: 0.5698
2024-08-12 13:12:21,452 : INFO : Recall score for label_class 1: 0.9277
2024-08-12 13:12:21,452 : INFO : Recall score for label_class 2: 0.7816
2024-08-12 13:12:21,452 : INFO : Average F1 score: 0.7834
2024-08-12 13:12:21,452 : INFO : Validation metric decreased (0.730291 --> 0.488797).  Saving model ...
2024-08-12 13:12:21,554 : INFO : Starting epoch 3
2024-08-12 13:12:21,995 : INFO : Current training batch loss: 0.4511 in epoch 3
2024-08-12 13:12:22,795 : INFO : Current training batch loss: 0.4055 in epoch 3
2024-08-12 13:12:23,595 : INFO : Current training batch loss: 0.3851 in epoch 3
2024-08-12 13:12:24,396 : INFO : Current training batch loss: 0.3073 in epoch 3
2024-08-12 13:12:24,929 : INFO : Epoch finished, average loss over training batches: 0.3885
2024-08-12 13:12:24,929 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:24,929 : INFO : Training metrics:
2024-08-12 13:12:24,929 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:24,936 : INFO : Accuracy: 0.8884
2024-08-12 13:12:24,936 : INFO : Precision score for label_class 0: 0.7917
2024-08-12 13:12:24,936 : INFO : Precision score for label_class 1: 0.9118
2024-08-12 13:12:24,936 : INFO : Precision score for label_class 2: 0.8764
2024-08-12 13:12:24,936 : INFO : Recall score for label_class 0: 0.7530
2024-08-12 13:12:24,936 : INFO : Recall score for label_class 1: 0.9518
2024-08-12 13:12:24,936 : INFO : Recall score for label_class 2: 0.8152
2024-08-12 13:12:24,936 : INFO : Average F1 score: 0.8493
2024-08-12 13:12:25,216 : INFO : Average loss over validation batches: 0.3613
2024-08-12 13:12:25,216 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:25,216 : INFO : Validation metrics:
2024-08-12 13:12:25,216 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:25,219 : INFO : Accuracy: 0.8889
2024-08-12 13:12:25,219 : INFO : Precision score for label_class 0: 0.8261
2024-08-12 13:12:25,219 : INFO : Precision score for label_class 1: 0.9106
2024-08-12 13:12:25,219 : INFO : Precision score for label_class 2: 0.8671
2024-08-12 13:12:25,219 : INFO : Recall score for label_class 0: 0.8837
2024-08-12 13:12:25,219 : INFO : Recall score for label_class 1: 0.9325
2024-08-12 13:12:25,219 : INFO : Recall score for label_class 2: 0.7874
2024-08-12 13:12:25,219 : INFO : Average F1 score: 0.8669
2024-08-12 13:12:25,219 : INFO : Validation metric decreased (0.488797 --> 0.361333).  Saving model ...
2024-08-12 13:12:25,320 : INFO : Starting epoch 4
2024-08-12 13:12:25,561 : INFO : Current training batch loss: 0.7209 in epoch 4
2024-08-12 13:12:26,361 : INFO : Current training batch loss: 0.3195 in epoch 4
2024-08-12 13:12:27,161 : INFO : Current training batch loss: 0.3592 in epoch 4
2024-08-12 13:12:27,962 : INFO : Current training batch loss: 0.2115 in epoch 4
2024-08-12 13:12:28,694 : INFO : Epoch finished, average loss over training batches: 0.2667
2024-08-12 13:12:28,694 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:28,694 : INFO : Training metrics:
2024-08-12 13:12:28,694 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:28,701 : INFO : Accuracy: 0.9325
2024-08-12 13:12:28,701 : INFO : Precision score for label_class 0: 0.8592
2024-08-12 13:12:28,701 : INFO : Precision score for label_class 1: 0.9473
2024-08-12 13:12:28,701 : INFO : Precision score for label_class 2: 0.9338
2024-08-12 13:12:28,701 : INFO : Recall score for label_class 0: 0.8933
2024-08-12 13:12:28,701 : INFO : Recall score for label_class 1: 0.9687
2024-08-12 13:12:28,701 : INFO : Recall score for label_class 2: 0.8747
2024-08-12 13:12:28,701 : INFO : Average F1 score: 0.9124
2024-08-12 13:12:28,980 : INFO : Average loss over validation batches: 0.3836
2024-08-12 13:12:28,981 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:28,981 : INFO : Validation metrics:
2024-08-12 13:12:28,981 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:28,983 : INFO : Accuracy: 0.8593
2024-08-12 13:12:28,983 : INFO : Precision score for label_class 0: 0.7596
2024-08-12 13:12:28,983 : INFO : Precision score for label_class 1: 0.9558
2024-08-12 13:12:28,983 : INFO : Precision score for label_class 2: 0.7416
2024-08-12 13:12:28,983 : INFO : Recall score for label_class 0: 0.9186
2024-08-12 13:12:28,983 : INFO : Recall score for label_class 1: 0.8337
2024-08-12 13:12:28,983 : INFO : Recall score for label_class 2: 0.8908
2024-08-12 13:12:28,983 : INFO : Average F1 score: 0.8439
2024-08-12 13:12:28,983 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 13:12:28,983 : INFO : Starting epoch 5
2024-08-12 13:12:29,024 : INFO : Current training batch loss: 0.2260 in epoch 5
2024-08-12 13:12:29,824 : INFO : Current training batch loss: 0.3216 in epoch 5
2024-08-12 13:12:30,625 : INFO : Current training batch loss: 0.1731 in epoch 5
2024-08-12 13:12:31,425 : INFO : Current training batch loss: 0.2051 in epoch 5
2024-08-12 13:12:32,226 : INFO : Current training batch loss: 0.2534 in epoch 5
2024-08-12 13:12:32,359 : INFO : Epoch finished, average loss over training batches: 0.1949
2024-08-12 13:12:32,359 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:32,360 : INFO : Training metrics:
2024-08-12 13:12:32,360 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:32,366 : INFO : Accuracy: 0.9518
2024-08-12 13:12:32,366 : INFO : Precision score for label_class 0: 0.8786
2024-08-12 13:12:32,366 : INFO : Precision score for label_class 1: 0.9653
2024-08-12 13:12:32,366 : INFO : Precision score for label_class 2: 0.9565
2024-08-12 13:12:32,366 : INFO : Recall score for label_class 0: 0.9268
2024-08-12 13:12:32,366 : INFO : Recall score for label_class 1: 0.9774
2024-08-12 13:12:32,366 : INFO : Recall score for label_class 2: 0.9096
2024-08-12 13:12:32,366 : INFO : Average F1 score: 0.9353
2024-08-12 13:12:32,646 : INFO : Average loss over validation batches: 0.4135
2024-08-12 13:12:32,646 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:32,646 : INFO : Validation metrics:
2024-08-12 13:12:32,646 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:32,649 : INFO : Accuracy: 0.8519
2024-08-12 13:12:32,649 : INFO : Precision score for label_class 0: 0.7407
2024-08-12 13:12:32,649 : INFO : Precision score for label_class 1: 0.9656
2024-08-12 13:12:32,649 : INFO : Precision score for label_class 2: 0.7248
2024-08-12 13:12:32,649 : INFO : Recall score for label_class 0: 0.9302
2024-08-12 13:12:32,649 : INFO : Recall score for label_class 1: 0.8120
2024-08-12 13:12:32,649 : INFO : Recall score for label_class 2: 0.9080
2024-08-12 13:12:32,649 : INFO : Average F1 score: 0.8377
2024-08-12 13:12:32,649 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 13:12:32,649 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:12:32,686 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 13:12:33,000 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:33,000 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 13:12:33,000 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:33,003 : INFO : Accuracy: 0.8889
2024-08-12 13:12:33,003 : INFO : Precision score for label_class 0: 0.8261
2024-08-12 13:12:33,003 : INFO : Precision score for label_class 1: 0.9106
2024-08-12 13:12:33,003 : INFO : Precision score for label_class 2: 0.8671
2024-08-12 13:12:33,003 : INFO : Recall score for label_class 0: 0.8837
2024-08-12 13:12:33,003 : INFO : Recall score for label_class 1: 0.9325
2024-08-12 13:12:33,003 : INFO : Recall score for label_class 2: 0.7874
2024-08-12 13:12:33,003 : INFO : Average F1 score: 0.8669
2024-08-12 13:12:33,003 : INFO : Determined score from best model, ending training.
2024-08-12 13:12:33,004 : INFO : Split 1 is finished, the score is: 0.8669
2024-08-12 13:12:33,004 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:33,004 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:33,004 : INFO : Starting training for split 2
2024-08-12 13:12:33,016 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 343, 1601,  754]))
2024-08-12 13:12:33,018 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 71, 410, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:12:33,057 : INFO : Starting epoch 1
2024-08-12 13:12:33,098 : INFO : Current training batch loss: 1.1076 in epoch 1
2024-08-12 13:12:33,898 : INFO : Current training batch loss: 1.0538 in epoch 1
2024-08-12 13:12:34,699 : INFO : Current training batch loss: 1.0167 in epoch 1
2024-08-12 13:12:35,500 : INFO : Current training batch loss: 0.8459 in epoch 1
2024-08-12 13:12:36,300 : INFO : Current training batch loss: 0.8597 in epoch 1
2024-08-12 13:12:36,433 : INFO : Epoch finished, average loss over training batches: 0.9377
2024-08-12 13:12:36,433 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:36,434 : INFO : Training metrics:
2024-08-12 13:12:36,434 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:36,446 : INFO : Accuracy: 0.5752
2024-08-12 13:12:36,446 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:12:36,447 : INFO : Precision score for label_class 1: 0.6491
2024-08-12 13:12:36,447 : INFO : Precision score for label_class 2: 0.3572
2024-08-12 13:12:36,447 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:12:36,447 : INFO : Recall score for label_class 1: 0.8170
2024-08-12 13:12:36,447 : INFO : Recall score for label_class 2: 0.3236
2024-08-12 13:12:36,447 : INFO : Average F1 score: 0.3543
2024-08-12 13:12:36,726 : INFO : Average loss over validation batches: 0.7423
2024-08-12 13:12:36,727 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:36,727 : INFO : Validation metrics:
2024-08-12 13:12:36,727 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:36,731 : INFO : Accuracy: 0.7230
2024-08-12 13:12:36,731 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:12:36,731 : INFO : Precision score for label_class 1: 0.7831
2024-08-12 13:12:36,731 : INFO : Precision score for label_class 2: 0.5707
2024-08-12 13:12:36,731 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:12:36,731 : INFO : Recall score for label_class 1: 0.9244
2024-08-12 13:12:36,731 : INFO : Recall score for label_class 2: 0.5619
2024-08-12 13:12:36,731 : INFO : Average F1 score: 0.4714
2024-08-12 13:12:36,731 : INFO : Validation metric decreased (inf --> 0.742316).  Saving model ...
2024-08-12 13:12:36,840 : INFO : Starting epoch 2
2024-08-12 13:12:37,481 : INFO : Current training batch loss: 0.7009 in epoch 2
2024-08-12 13:12:38,280 : INFO : Current training batch loss: 0.6573 in epoch 2
2024-08-12 13:12:39,080 : INFO : Current training batch loss: 0.5774 in epoch 2
2024-08-12 13:12:39,880 : INFO : Current training batch loss: 0.5522 in epoch 2
2024-08-12 13:12:40,213 : INFO : Epoch finished, average loss over training batches: 0.6344
2024-08-12 13:12:40,213 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:40,213 : INFO : Training metrics:
2024-08-12 13:12:40,213 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:40,223 : INFO : Accuracy: 0.7487
2024-08-12 13:12:40,223 : INFO : Precision score for label_class 0: 1.0000
2024-08-12 13:12:40,223 : INFO : Precision score for label_class 1: 0.8328
2024-08-12 13:12:40,223 : INFO : Precision score for label_class 2: 0.5745
2024-08-12 13:12:40,223 : INFO : Recall score for label_class 0: 0.0029
2024-08-12 13:12:40,223 : INFO : Recall score for label_class 1: 0.9457
2024-08-12 13:12:40,223 : INFO : Recall score for label_class 2: 0.6698
2024-08-12 13:12:40,223 : INFO : Average F1 score: 0.5033
2024-08-12 13:12:40,503 : INFO : Average loss over validation batches: 0.5559
2024-08-12 13:12:40,503 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:40,503 : INFO : Validation metrics:
2024-08-12 13:12:40,503 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:40,507 : INFO : Accuracy: 0.7852
2024-08-12 13:12:40,507 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:12:40,507 : INFO : Precision score for label_class 1: 0.8556
2024-08-12 13:12:40,507 : INFO : Precision score for label_class 2: 0.6444
2024-08-12 13:12:40,507 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:12:40,507 : INFO : Recall score for label_class 1: 0.9390
2024-08-12 13:12:40,507 : INFO : Recall score for label_class 2: 0.7474
2024-08-12 13:12:40,507 : INFO : Average F1 score: 0.5292
2024-08-12 13:12:40,507 : INFO : Validation metric decreased (0.742316 --> 0.555856).  Saving model ...
2024-08-12 13:12:40,608 : INFO : Starting epoch 3
2024-08-12 13:12:41,049 : INFO : Current training batch loss: 0.4743 in epoch 3
2024-08-12 13:12:41,850 : INFO : Current training batch loss: 0.4810 in epoch 3
2024-08-12 13:12:42,652 : INFO : Current training batch loss: 0.4286 in epoch 3
2024-08-12 13:12:43,454 : INFO : Current training batch loss: 0.2812 in epoch 3
2024-08-12 13:12:43,987 : INFO : Epoch finished, average loss over training batches: 0.4354
2024-08-12 13:12:43,988 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:43,988 : INFO : Training metrics:
2024-08-12 13:12:43,988 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:44,000 : INFO : Accuracy: 0.8699
2024-08-12 13:12:44,000 : INFO : Precision score for label_class 0: 0.8000
2024-08-12 13:12:44,000 : INFO : Precision score for label_class 1: 0.9128
2024-08-12 13:12:44,000 : INFO : Precision score for label_class 2: 0.7995
2024-08-12 13:12:44,000 : INFO : Recall score for label_class 0: 0.5948
2024-08-12 13:12:44,000 : INFO : Recall score for label_class 1: 0.9550
2024-08-12 13:12:44,000 : INFO : Recall score for label_class 2: 0.8143
2024-08-12 13:12:44,000 : INFO : Average F1 score: 0.8075
2024-08-12 13:12:44,280 : INFO : Average loss over validation batches: 0.4285
2024-08-12 13:12:44,280 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:44,280 : INFO : Validation metrics:
2024-08-12 13:12:44,280 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:44,283 : INFO : Accuracy: 0.8681
2024-08-12 13:12:44,283 : INFO : Precision score for label_class 0: 0.7179
2024-08-12 13:12:44,283 : INFO : Precision score for label_class 1: 0.8742
2024-08-12 13:12:44,283 : INFO : Precision score for label_class 2: 0.9276
2024-08-12 13:12:44,283 : INFO : Recall score for label_class 0: 0.7887
2024-08-12 13:12:44,283 : INFO : Recall score for label_class 1: 0.9488
2024-08-12 13:12:44,283 : INFO : Recall score for label_class 2: 0.7268
2024-08-12 13:12:44,283 : INFO : Average F1 score: 0.8255
2024-08-12 13:12:44,283 : INFO : Validation metric decreased (0.555856 --> 0.428513).  Saving model ...
2024-08-12 13:12:44,385 : INFO : Starting epoch 4
2024-08-12 13:12:44,627 : INFO : Current training batch loss: 0.5259 in epoch 4
2024-08-12 13:12:45,432 : INFO : Current training batch loss: 0.2914 in epoch 4
2024-08-12 13:12:46,238 : INFO : Current training batch loss: 0.3968 in epoch 4
2024-08-12 13:12:47,043 : INFO : Current training batch loss: 0.1985 in epoch 4
2024-08-12 13:12:47,787 : INFO : Epoch finished, average loss over training batches: 0.2836
2024-08-12 13:12:47,787 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:47,787 : INFO : Training metrics:
2024-08-12 13:12:47,787 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:47,798 : INFO : Accuracy: 0.9266
2024-08-12 13:12:47,798 : INFO : Precision score for label_class 0: 0.8497
2024-08-12 13:12:47,798 : INFO : Precision score for label_class 1: 0.9469
2024-08-12 13:12:47,798 : INFO : Precision score for label_class 2: 0.9174
2024-08-12 13:12:47,798 : INFO : Recall score for label_class 0: 0.8571
2024-08-12 13:12:47,798 : INFO : Recall score for label_class 1: 0.9688
2024-08-12 13:12:47,798 : INFO : Recall score for label_class 2: 0.8687
2024-08-12 13:12:47,798 : INFO : Average F1 score: 0.9012
2024-08-12 13:12:48,077 : INFO : Average loss over validation batches: 0.3863
2024-08-12 13:12:48,078 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:48,078 : INFO : Validation metrics:
2024-08-12 13:12:48,078 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:48,081 : INFO : Accuracy: 0.8652
2024-08-12 13:12:48,081 : INFO : Precision score for label_class 0: 0.7342
2024-08-12 13:12:48,081 : INFO : Precision score for label_class 1: 0.9082
2024-08-12 13:12:48,081 : INFO : Precision score for label_class 2: 0.8290
2024-08-12 13:12:48,081 : INFO : Recall score for label_class 0: 0.8169
2024-08-12 13:12:48,081 : INFO : Recall score for label_class 1: 0.8927
2024-08-12 13:12:48,081 : INFO : Recall score for label_class 2: 0.8247
2024-08-12 13:12:48,081 : INFO : Average F1 score: 0.8335
2024-08-12 13:12:48,081 : INFO : Validation metric decreased (0.428513 --> 0.386261).  Saving model ...
2024-08-12 13:12:48,182 : INFO : Starting epoch 5
2024-08-12 13:12:48,224 : INFO : Current training batch loss: 0.1805 in epoch 5
2024-08-12 13:12:49,029 : INFO : Current training batch loss: 0.3044 in epoch 5
2024-08-12 13:12:49,836 : INFO : Current training batch loss: 0.2120 in epoch 5
2024-08-12 13:12:50,641 : INFO : Current training batch loss: 0.1951 in epoch 5
2024-08-12 13:12:51,448 : INFO : Current training batch loss: 0.2606 in epoch 5
2024-08-12 13:12:51,589 : INFO : Epoch finished, average loss over training batches: 0.2014
2024-08-12 13:12:51,589 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:51,589 : INFO : Training metrics:
2024-08-12 13:12:51,589 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:51,597 : INFO : Accuracy: 0.9518
2024-08-12 13:12:51,597 : INFO : Precision score for label_class 0: 0.8855
2024-08-12 13:12:51,597 : INFO : Precision score for label_class 1: 0.9701
2024-08-12 13:12:51,597 : INFO : Precision score for label_class 2: 0.9442
2024-08-12 13:12:51,597 : INFO : Recall score for label_class 0: 0.9242
2024-08-12 13:12:51,597 : INFO : Recall score for label_class 1: 0.9725
2024-08-12 13:12:51,597 : INFO : Recall score for label_class 2: 0.9204
2024-08-12 13:12:51,597 : INFO : Average F1 score: 0.9360
2024-08-12 13:12:51,877 : INFO : Average loss over validation batches: 0.4272
2024-08-12 13:12:51,877 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:51,877 : INFO : Validation metrics:
2024-08-12 13:12:51,877 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:51,880 : INFO : Accuracy: 0.8563
2024-08-12 13:12:51,880 : INFO : Precision score for label_class 0: 0.7303
2024-08-12 13:12:51,880 : INFO : Precision score for label_class 1: 0.9330
2024-08-12 13:12:51,880 : INFO : Precision score for label_class 2: 0.7746
2024-08-12 13:12:51,880 : INFO : Recall score for label_class 0: 0.9155
2024-08-12 13:12:51,880 : INFO : Recall score for label_class 1: 0.8488
2024-08-12 13:12:51,880 : INFO : Recall score for label_class 2: 0.8505
2024-08-12 13:12:51,880 : INFO : Average F1 score: 0.8374
2024-08-12 13:12:51,880 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 13:12:51,880 : INFO : Starting epoch 6
2024-08-12 13:12:52,525 : INFO : Current training batch loss: 0.2390 in epoch 6
2024-08-12 13:12:53,330 : INFO : Current training batch loss: 0.1954 in epoch 6
2024-08-12 13:12:54,136 : INFO : Current training batch loss: 0.0774 in epoch 6
2024-08-12 13:12:54,942 : INFO : Current training batch loss: 0.0976 in epoch 6
2024-08-12 13:12:55,284 : INFO : Epoch finished, average loss over training batches: 0.1639
2024-08-12 13:12:55,284 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:55,284 : INFO : Training metrics:
2024-08-12 13:12:55,284 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:55,291 : INFO : Accuracy: 0.9615
2024-08-12 13:12:55,292 : INFO : Precision score for label_class 0: 0.9124
2024-08-12 13:12:55,292 : INFO : Precision score for label_class 1: 0.9739
2024-08-12 13:12:55,292 : INFO : Precision score for label_class 2: 0.9579
2024-08-12 13:12:55,292 : INFO : Recall score for label_class 0: 0.9417
2024-08-12 13:12:55,292 : INFO : Recall score for label_class 1: 0.9781
2024-08-12 13:12:55,292 : INFO : Recall score for label_class 2: 0.9350
2024-08-12 13:12:55,292 : INFO : Average F1 score: 0.9497
2024-08-12 13:12:55,571 : INFO : Average loss over validation batches: 0.4215
2024-08-12 13:12:55,571 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:55,572 : INFO : Validation metrics:
2024-08-12 13:12:55,572 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:55,575 : INFO : Accuracy: 0.8563
2024-08-12 13:12:55,575 : INFO : Precision score for label_class 0: 0.7143
2024-08-12 13:12:55,575 : INFO : Precision score for label_class 1: 0.9330
2024-08-12 13:12:55,575 : INFO : Precision score for label_class 2: 0.7820
2024-08-12 13:12:55,575 : INFO : Recall score for label_class 0: 0.9155
2024-08-12 13:12:55,575 : INFO : Recall score for label_class 1: 0.8488
2024-08-12 13:12:55,575 : INFO : Recall score for label_class 2: 0.8505
2024-08-12 13:12:55,575 : INFO : Average F1 score: 0.8354
2024-08-12 13:12:55,575 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 13:12:55,575 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:12:55,612 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 13:12:55,922 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:55,922 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 13:12:55,922 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:55,925 : INFO : Accuracy: 0.8652
2024-08-12 13:12:55,925 : INFO : Precision score for label_class 0: 0.7342
2024-08-12 13:12:55,925 : INFO : Precision score for label_class 1: 0.9082
2024-08-12 13:12:55,925 : INFO : Precision score for label_class 2: 0.8290
2024-08-12 13:12:55,925 : INFO : Recall score for label_class 0: 0.8169
2024-08-12 13:12:55,925 : INFO : Recall score for label_class 1: 0.8927
2024-08-12 13:12:55,925 : INFO : Recall score for label_class 2: 0.8247
2024-08-12 13:12:55,925 : INFO : Average F1 score: 0.8335
2024-08-12 13:12:55,925 : INFO : Determined score from best model, ending training.
2024-08-12 13:12:55,932 : INFO : Split 2 is finished, the score is: 0.8335
2024-08-12 13:12:55,932 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:55,932 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:55,932 : INFO : Starting training for split 3
2024-08-12 13:12:55,944 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 328, 1611,  759]))
2024-08-12 13:12:55,946 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 86, 400, 189]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:12:55,995 : INFO : Starting epoch 1
2024-08-12 13:12:56,038 : INFO : Current training batch loss: 1.0914 in epoch 1
2024-08-12 13:12:56,843 : INFO : Current training batch loss: 1.0672 in epoch 1
2024-08-12 13:12:57,649 : INFO : Current training batch loss: 0.9484 in epoch 1
2024-08-12 13:12:58,455 : INFO : Current training batch loss: 0.8648 in epoch 1
2024-08-12 13:12:59,260 : INFO : Current training batch loss: 0.8621 in epoch 1
2024-08-12 13:12:59,401 : INFO : Epoch finished, average loss over training batches: 0.9418
2024-08-12 13:12:59,401 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:59,401 : INFO : Training metrics:
2024-08-12 13:12:59,401 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:59,408 : INFO : Accuracy: 0.6027
2024-08-12 13:12:59,409 : INFO : Precision score for label_class 0: 0.1443
2024-08-12 13:12:59,409 : INFO : Precision score for label_class 1: 0.6514
2024-08-12 13:12:59,409 : INFO : Precision score for label_class 2: 0.5339
2024-08-12 13:12:59,409 : INFO : Recall score for label_class 0: 0.0884
2024-08-12 13:12:59,409 : INFO : Recall score for label_class 1: 0.9081
2024-08-12 13:12:59,409 : INFO : Recall score for label_class 2: 0.1765
2024-08-12 13:12:59,409 : INFO : Average F1 score: 0.3779
2024-08-12 13:12:59,688 : INFO : Average loss over validation batches: 0.7558
2024-08-12 13:12:59,688 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:59,688 : INFO : Validation metrics:
2024-08-12 13:12:59,688 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:12:59,691 : INFO : Accuracy: 0.7022
2024-08-12 13:12:59,691 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:12:59,691 : INFO : Precision score for label_class 1: 0.7764
2024-08-12 13:12:59,691 : INFO : Precision score for label_class 2: 0.5156
2024-08-12 13:12:59,691 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:12:59,691 : INFO : Recall score for label_class 1: 0.9375
2024-08-12 13:12:59,691 : INFO : Recall score for label_class 2: 0.5238
2024-08-12 13:12:59,691 : INFO : Average F1 score: 0.4564
2024-08-12 13:12:59,691 : INFO : Validation metric decreased (inf --> 0.755757).  Saving model ...
2024-08-12 13:12:59,802 : INFO : Starting epoch 2
2024-08-12 13:13:00,447 : INFO : Current training batch loss: 0.7073 in epoch 2
2024-08-12 13:13:01,252 : INFO : Current training batch loss: 0.6355 in epoch 2
2024-08-12 13:13:02,057 : INFO : Current training batch loss: 0.5976 in epoch 2
2024-08-12 13:13:02,861 : INFO : Current training batch loss: 0.4829 in epoch 2
2024-08-12 13:13:03,203 : INFO : Epoch finished, average loss over training batches: 0.6274
2024-08-12 13:13:03,203 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:13:03,204 : INFO : Training metrics:
2024-08-12 13:13:03,204 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:13:03,211 : INFO : Accuracy: 0.7669
2024-08-12 13:13:03,211 : INFO : Precision score for label_class 0: 0.8148
2024-08-12 13:13:03,211 : INFO : Precision score for label_class 1: 0.8358
2024-08-12 13:13:03,211 : INFO : Precision score for label_class 2: 0.6144
2024-08-12 13:13:03,211 : INFO : Recall score for label_class 0: 0.1341
2024-08-12 13:13:03,211 : INFO : Recall score for label_class 1: 0.9385
2024-08-12 13:13:03,211 : INFO : Recall score for label_class 2: 0.6759
2024-08-12 13:13:03,211 : INFO : Average F1 score: 0.5861
2024-08-12 13:13:03,492 : INFO : Average loss over validation batches: 0.5196
2024-08-12 13:13:03,492 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:13:03,492 : INFO : Validation metrics:
2024-08-12 13:13:03,492 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:13:03,494 : INFO : Accuracy: 0.8311
2024-08-12 13:13:03,494 : INFO : Precision score for label_class 0: 0.9750
2024-08-12 13:13:03,494 : INFO : Precision score for label_class 1: 0.8575
2024-08-12 13:13:03,494 : INFO : Precision score for label_class 2: 0.7409
2024-08-12 13:13:03,494 : INFO : Recall score for label_class 0: 0.4535
2024-08-12 13:13:03,494 : INFO : Recall score for label_class 1: 0.9475
2024-08-12 13:13:03,494 : INFO : Recall score for label_class 2: 0.7566
2024-08-12 13:13:03,494 : INFO : Average F1 score: 0.7560
2024-08-12 13:13:03,494 : INFO : Validation metric decreased (0.755757 --> 0.519592).  Saving model ...
2024-08-12 13:13:03,596 : INFO : Starting epoch 3
2024-08-12 13:13:04,039 : INFO : Current training batch loss: 0.4607 in epoch 3
2024-08-12 13:13:04,845 : INFO : Current training batch loss: 0.4379 in epoch 3
2024-08-12 13:13:05,651 : INFO : Current training batch loss: 0.4002 in epoch 3
2024-08-12 13:13:06,456 : INFO : Current training batch loss: 0.2822 in epoch 3
2024-08-12 13:13:06,999 : INFO : Epoch finished, average loss over training batches: 0.4084
2024-08-12 13:13:07,000 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:13:07,000 : INFO : Training metrics:
2024-08-12 13:13:07,000 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:13:07,003 : INFO : Accuracy: 0.8847
2024-08-12 13:13:07,003 : INFO : Precision score for label_class 0: 0.8007
2024-08-12 13:13:07,003 : INFO : Precision score for label_class 1: 0.9102
2024-08-12 13:13:07,003 : INFO : Precision score for label_class 2: 0.8606
2024-08-12 13:13:07,003 : INFO : Recall score for label_class 0: 0.7470
2024-08-12 13:13:07,003 : INFO : Recall score for label_class 1: 0.9503
2024-08-12 13:13:07,003 : INFO : Recall score for label_class 2: 0.8050
2024-08-12 13:13:07,003 : INFO : Average F1 score: 0.8449
2024-08-12 13:13:07,284 : INFO : Average loss over validation batches: 0.3834
2024-08-12 13:13:07,284 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:13:07,284 : INFO : Validation metrics:
2024-08-12 13:13:07,284 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:13:07,286 : INFO : Accuracy: 0.8770
2024-08-12 13:13:07,286 : INFO : Precision score for label_class 0: 0.8333
2024-08-12 13:13:07,286 : INFO : Precision score for label_class 1: 0.9115
2024-08-12 13:13:07,286 : INFO : Precision score for label_class 2: 0.8207
2024-08-12 13:13:07,286 : INFO : Recall score for label_class 0: 0.8140
2024-08-12 13:13:07,286 : INFO : Recall score for label_class 1: 0.9275
2024-08-12 13:13:07,286 : INFO : Recall score for label_class 2: 0.7989
2024-08-12 13:13:07,286 : INFO : Average F1 score: 0.8509
2024-08-12 13:13:07,286 : INFO : Validation metric decreased (0.519592 --> 0.383449).  Saving model ...
2024-08-12 13:13:07,390 : INFO : Starting epoch 4
2024-08-12 13:13:07,632 : INFO : Current training batch loss: 0.4424 in epoch 4
2024-08-12 13:13:08,438 : INFO : Current training batch loss: 0.3755 in epoch 4
2024-08-12 13:13:09,244 : INFO : Current training batch loss: 0.3641 in epoch 4
2024-08-12 13:13:10,050 : INFO : Current training batch loss: 0.1884 in epoch 4
2024-08-12 13:13:10,793 : INFO : Epoch finished, average loss over training batches: 0.2801
2024-08-12 13:13:10,794 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:13:10,794 : INFO : Training metrics:
2024-08-12 13:13:10,794 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:13:10,799 : INFO : Accuracy: 0.9277
2024-08-12 13:13:10,799 : INFO : Precision score for label_class 0: 0.8614
2024-08-12 13:13:10,799 : INFO : Precision score for label_class 1: 0.9500
2024-08-12 13:13:10,799 : INFO : Precision score for label_class 2: 0.9093
2024-08-12 13:13:10,799 : INFO : Recall score for label_class 0: 0.8902
2024-08-12 13:13:10,799 : INFO : Recall score for label_class 1: 0.9553
2024-08-12 13:13:10,799 : INFO : Recall score for label_class 2: 0.8854
2024-08-12 13:13:10,799 : INFO : Average F1 score: 0.9085
2024-08-12 13:13:11,079 : INFO : Average loss over validation batches: 0.3593
2024-08-12 13:13:11,079 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:13:11,079 : INFO : Validation metrics:
2024-08-12 13:13:11,079 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:13:11,082 : INFO : Accuracy: 0.8711
2024-08-12 13:13:11,082 : INFO : Precision score for label_class 0: 0.7426
2024-08-12 13:13:11,082 : INFO : Precision score for label_class 1: 0.9373
2024-08-12 13:13:11,082 : INFO : Precision score for label_class 2: 0.8063
2024-08-12 13:13:11,082 : INFO : Recall score for label_class 0: 0.8721
2024-08-12 13:13:11,082 : INFO : Recall score for label_class 1: 0.8975
2024-08-12 13:13:11,082 : INFO : Recall score for label_class 2: 0.8148
2024-08-12 13:13:11,082 : INFO : Average F1 score: 0.8432
2024-08-12 13:13:11,082 : INFO : Validation metric decreased (0.383449 --> 0.359261).  Saving model ...
2024-08-12 13:13:11,183 : INFO : Starting epoch 5
2024-08-12 13:13:11,225 : INFO : Current training batch loss: 0.1886 in epoch 5
2024-08-12 13:13:12,030 : INFO : Current training batch loss: 0.3825 in epoch 5
2024-08-12 13:13:12,836 : INFO : Current training batch loss: 0.2690 in epoch 5
2024-08-12 13:13:13,643 : INFO : Current training batch loss: 0.3089 in epoch 5
2024-08-12 13:13:14,449 : INFO : Current training batch loss: 0.2274 in epoch 5
2024-08-12 13:13:14,590 : INFO : Epoch finished, average loss over training batches: 0.2059
2024-08-12 13:13:14,590 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:13:14,590 : INFO : Training metrics:
2024-08-12 13:13:14,590 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:13:14,596 : INFO : Accuracy: 0.9529
2024-08-12 13:13:14,596 : INFO : Precision score for label_class 0: 0.8870
2024-08-12 13:13:14,596 : INFO : Precision score for label_class 1: 0.9679
2024-08-12 13:13:14,596 : INFO : Precision score for label_class 2: 0.9510
2024-08-12 13:13:14,596 : INFO : Recall score for label_class 0: 0.9329
2024-08-12 13:13:14,596 : INFO : Recall score for label_class 1: 0.9727
2024-08-12 13:13:14,596 : INFO : Recall score for label_class 2: 0.9196
2024-08-12 13:13:14,596 : INFO : Average F1 score: 0.9382
2024-08-12 13:13:14,876 : INFO : Average loss over validation batches: 0.3983
2024-08-12 13:13:14,876 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:13:14,876 : INFO : Validation metrics:
2024-08-12 13:13:14,876 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:13:14,879 : INFO : Accuracy: 0.8430
2024-08-12 13:13:14,879 : INFO : Precision score for label_class 0: 0.7353
2024-08-12 13:13:14,879 : INFO : Precision score for label_class 1: 0.9511
2024-08-12 13:13:14,879 : INFO : Precision score for label_class 2: 0.7244
2024-08-12 13:13:14,879 : INFO : Recall score for label_class 0: 0.8721
2024-08-12 13:13:14,879 : INFO : Recall score for label_class 1: 0.8275
2024-08-12 13:13:14,879 : INFO : Recall score for label_class 2: 0.8624
2024-08-12 13:13:14,879 : INFO : Average F1 score: 0.8234
2024-08-12 13:13:14,879 : INFO : EarlyStopping counter: 1 out of 2
2024-08-12 13:13:14,879 : INFO : Starting epoch 6
2024-08-12 13:13:15,524 : INFO : Current training batch loss: 0.3079 in epoch 6
2024-08-12 13:13:16,329 : INFO : Current training batch loss: 0.1514 in epoch 6
2024-08-12 13:13:17,135 : INFO : Current training batch loss: 0.0822 in epoch 6
2024-08-12 13:13:17,940 : INFO : Current training batch loss: 0.0723 in epoch 6
2024-08-12 13:13:18,283 : INFO : Epoch finished, average loss over training batches: 0.1699
2024-08-12 13:13:18,283 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:13:18,283 : INFO : Training metrics:
2024-08-12 13:13:18,283 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:13:18,290 : INFO : Accuracy: 0.9615
2024-08-12 13:13:18,290 : INFO : Precision score for label_class 0: 0.9035
2024-08-12 13:13:18,290 : INFO : Precision score for label_class 1: 0.9723
2024-08-12 13:13:18,290 : INFO : Precision score for label_class 2: 0.9645
2024-08-12 13:13:18,290 : INFO : Recall score for label_class 0: 0.9421
2024-08-12 13:13:18,290 : INFO : Recall score for label_class 1: 0.9795
2024-08-12 13:13:18,290 : INFO : Recall score for label_class 2: 0.9315
2024-08-12 13:13:18,290 : INFO : Average F1 score: 0.9487
2024-08-12 13:13:18,570 : INFO : Average loss over validation batches: 0.3695
2024-08-12 13:13:18,570 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:13:18,570 : INFO : Validation metrics:
2024-08-12 13:13:18,570 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:13:18,572 : INFO : Accuracy: 0.8667
2024-08-12 13:13:18,572 : INFO : Precision score for label_class 0: 0.7979
2024-08-12 13:13:18,572 : INFO : Precision score for label_class 1: 0.9479
2024-08-12 13:13:18,572 : INFO : Precision score for label_class 2: 0.7593
2024-08-12 13:13:18,572 : INFO : Recall score for label_class 0: 0.8721
2024-08-12 13:13:18,572 : INFO : Recall score for label_class 1: 0.8650
2024-08-12 13:13:18,572 : INFO : Recall score for label_class 2: 0.8677
2024-08-12 13:13:18,572 : INFO : Average F1 score: 0.8493
2024-08-12 13:13:18,573 : INFO : EarlyStopping counter: 2 out of 2
2024-08-12 13:13:18,573 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:13:18,606 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_01/current_split_model/checkpoint.pth
2024-08-12 13:13:18,916 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:13:18,916 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-12 13:13:18,916 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:13:18,918 : INFO : Accuracy: 0.8711
2024-08-12 13:13:18,918 : INFO : Precision score for label_class 0: 0.7426
2024-08-12 13:13:18,918 : INFO : Precision score for label_class 1: 0.9373
2024-08-12 13:13:18,918 : INFO : Precision score for label_class 2: 0.8063
2024-08-12 13:13:18,918 : INFO : Recall score for label_class 0: 0.8721
2024-08-12 13:13:18,918 : INFO : Recall score for label_class 1: 0.8975
2024-08-12 13:13:18,918 : INFO : Recall score for label_class 2: 0.8148
2024-08-12 13:13:18,918 : INFO : Average F1 score: 0.8432
2024-08-12 13:13:18,918 : INFO : Determined score from best model, ending training.
2024-08-12 13:13:18,920 : INFO : Split 3 is finished, the score is: 0.8432
2024-08-12 13:13:18,920 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:13:18,920 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:13:18,920 : INFO : Starting training for split 4
2024-08-12 13:13:18,931 : INFO : Occurence of labels for training split: (array([0, 1, 2]), array([ 327, 1621,  751]))
2024-08-12 13:13:18,933 : INFO : Occurence of labels for validation split: (array([0, 1, 2]), array([ 87, 390, 197]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-12 13:13:18,973 : INFO : Starting epoch 1
2024-08-12 13:13:19,015 : INFO : Current training batch loss: 1.0617 in epoch 1
2024-08-12 13:13:19,820 : INFO : Current training batch loss: 1.0358 in epoch 1
2024-08-12 13:13:20,625 : INFO : Current training batch loss: 0.9163 in epoch 1
2024-08-12 13:13:21,430 : INFO : Current training batch loss: 0.8291 in epoch 1
2024-08-12 13:13:22,236 : INFO : Current training batch loss: 0.7659 in epoch 1
2024-08-12 13:13:22,377 : INFO : Epoch finished, average loss over training batches: 0.9043
2024-08-12 13:13:22,377 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:13:22,377 : INFO : Training metrics:
2024-08-12 13:13:22,377 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:13:22,385 : INFO : Accuracy: 0.6462
2024-08-12 13:13:22,385 : INFO : Precision score for label_class 0: 1.0000
2024-08-12 13:13:22,385 : INFO : Precision score for label_class 1: 0.6552
2024-08-12 13:13:22,385 : INFO : Precision score for label_class 2: 0.5623
2024-08-12 13:13:22,385 : INFO : Recall score for label_class 0: 0.0031
2024-08-12 13:13:22,385 : INFO : Recall score for label_class 1: 0.9833
2024-08-12 13:13:22,385 : INFO : Recall score for label_class 2: 0.1984
2024-08-12 13:13:22,385 : INFO : Average F1 score: 0.3619
2024-08-12 13:13:22,666 : INFO : Average loss over validation batches: 0.7268
2024-08-12 13:13:22,666 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:13:22,666 : INFO : Validation metrics:
2024-08-12 13:13:22,666 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:13:22,669 : INFO : Accuracy: 0.7240
2024-08-12 13:13:22,670 : INFO : Precision score for label_class 0: 0.0000
2024-08-12 13:13:22,670 : INFO : Precision score for label_class 1: 0.7808
2024-08-12 13:13:22,670 : INFO : Precision score for label_class 2: 0.5846
2024-08-12 13:13:22,670 : INFO : Recall score for label_class 0: 0.0000
2024-08-12 13:13:22,670 : INFO : Recall score for label_class 1: 0.9590
2024-08-12 13:13:22,670 : INFO : Recall score for label_class 2: 0.5787
2024-08-12 13:13:22,670 : INFO : Average F1 score: 0.4808
2024-08-12 13:13:22,670 : INFO : Validation metric decreased (inf --> 0.726777).  Saving model ...
2024-08-12 13:13:22,770 : INFO : Starting epoch 2
2024-08-12 13:13:23,414 : INFO : Current training batch loss: 0.6781 in epoch 2
2024-08-12 13:13:24,219 : INFO : Current training batch loss: 0.5671 in epoch 2
2024-08-12 13:13:25,024 : INFO : Current training batch loss: 0.4187 in epoch 2
2024-08-12 13:13:25,829 : INFO : Current training batch loss: 0.4857 in epoch 2
2024-08-12 13:13:26,172 : INFO : Epoch finished, average loss over training batches: 0.5705
2024-08-12 13:13:26,172 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:13:26,172 : INFO : Training metrics:
2024-08-12 13:13:26,172 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:13:26,176 : INFO : Accuracy: 0.8166
2024-08-12 13:13:26,176 : INFO : Precision score for label_class 0: 0.7980
2024-08-12 13:13:26,176 : INFO : Precision score for label_class 1: 0.8500
2024-08-12 13:13:26,176 : INFO : Precision score for label_class 2: 0.7377
2024-08-12 13:13:26,176 : INFO : Recall score for label_class 0: 0.4954
2024-08-12 13:13:26,176 : INFO : Recall score for label_class 1: 0.9371
2024-08-12 13:13:26,176 : INFO : Recall score for label_class 2: 0.6964
2024-08-12 13:13:26,176 : INFO : Average F1 score: 0.7397
2024-08-12 13:13:26,456 : INFO : Average loss over validation batches: 0.4737
2024-08-12 13:13:26,456 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:13:26,456 : INFO : Validation metrics:
2024-08-12 13:13:26,456 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:13:26,460 : INFO : Accuracy: 0.8383
2024-08-12 13:13:26,460 : INFO : Precision score for label_class 0: 0.7065
2024-08-12 13:13:26,460 : INFO : Precision score for label_class 1: 0.8629
2024-08-12 13:13:26,460 : INFO : Precision score for label_class 2: 0.8491
2024-08-12 13:13:26,460 : INFO : Recall score for label_class 0: 0.7471
2024-08-12 13:13:26,460 : INFO : Recall score for label_class 1: 0.9359
2024-08-12 13:13:26,460 : INFO : Recall score for label_class 2: 0.6853
2024-08-12 13:13:26,460 : INFO : Average F1 score: 0.7942
2024-08-12 13:13:26,460 : INFO : Validation metric decreased (0.726777 --> 0.473650).  Saving model ...
2024-08-12 13:13:26,561 : INFO : Starting epoch 3
2024-08-12 13:13:27,005 : INFO : Current training batch loss: 0.3682 in epoch 3
2024-08-12 13:13:27,887 : INFO : Current training batch loss: 0.4305 in epoch 3
2024-08-12 13:13:28,693 : INFO : Current training batch loss: 0.3627 in epoch 3
2024-08-12 13:13:29,498 : INFO : Current training batch loss: 0.2250 in epoch 3
2024-08-12 13:13:30,041 : INFO : Epoch finished, average loss over training batches: 0.3682
2024-08-12 13:13:30,041 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:13:30,041 : INFO : Training metrics:
2024-08-12 13:13:30,041 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:13:30,049 : INFO : Accuracy: 0.8914
2024-08-12 13:13:30,049 : INFO : Precision score for label_class 0: 0.8104
2024-08-12 13:13:30,049 : INFO : Precision score for label_class 1: 0.9195
2024-08-12 13:13:30,049 : INFO : Precision score for label_class 2: 0.8637
2024-08-12 13:13:30,049 : INFO : Recall score for label_class 0: 0.8104
2024-08-12 13:13:30,049 : INFO : Recall score for label_class 1: 0.9377
2024-08-12 13:13:30,049 : INFO : Recall score for label_class 2: 0.8269
2024-08-12 13:13:30,049 : INFO : Average F1 score: 0.8613
2024-08-12 13:13:30,329 : INFO : Average loss over validation batches: 0.3839
2024-08-12 13:13:30,329 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:13:30,329 : INFO : Validation metrics:
2024-08-12 13:13:30,329 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:13:30,333 : INFO : Accuracy: 0.8769
2024-08-12 13:13:30,333 : INFO : Precision score for label_class 0: 0.8140
2024-08-12 13:13:30,333 : INFO : Precision score for label_class 1: 0.9175
2024-08-12 13:13:30,333 : INFO : Precision score for label_class 2: 0.8250
2024-08-12 13:13:30,333 : INFO : Recall score for label_class 0: 0.8046
2024-08-12 13:13:30,333 : INFO : Recall score for label_class 1: 0.9128
2024-08-12 13:13:30,333 : INFO : Recall score for label_class 2: 0.8376
2024-08-12 13:13:30,333 : INFO : Average F1 score: 0.8519
2024-08-12 13:13:30,333 : INFO : Validation metric decreased (0.473650 --> 0.383921).  Saving model ...
2024-08-12 13:13:30,435 : INFO : Starting epoch 4
2024-08-12 13:13:30,678 : INFO : Current training batch loss: 0.4150 in epoch 4
2024-08-12 13:13:31,484 : INFO : Current training batch loss: 0.3235 in epoch 4
2024-08-12 13:13:32,289 : INFO : Current training batch loss: 0.2525 in epoch 4
2024-08-12 13:13:33,095 : INFO : Current training batch loss: 0.1689 in epoch 4
2024-08-12 13:13:33,839 : INFO : Epoch finished, average loss over training batches: 0.2392
2024-08-12 13:13:33,839 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:13:33,839 : INFO : Training metrics:
2024-08-12 13:13:33,839 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:13:33,846 : INFO : Accuracy: 0.9426
2024-08-12 13:13:33,846 : INFO : Precision score for label_class 0: 0.8806
2024-08-12 13:13:33,846 : INFO : Precision score for label_class 1: 0.9567
2024-08-12 13:13:33,846 : INFO : Precision score for label_class 2: 0.9391
2024-08-12 13:13:33,846 : INFO : Recall score for label_class 0: 0.9021
2024-08-12 13:13:33,846 : INFO : Recall score for label_class 1: 0.9685
2024-08-12 13:13:33,846 : INFO : Recall score for label_class 2: 0.9041
2024-08-12 13:13:33,846 : INFO : Average F1 score: 0.9250
2024-08-12 13:13:34,126 : INFO : Average loss over validation batches: 0.3782
2024-08-12 13:13:34,126 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:13:34,126 : INFO : Validation metrics:
2024-08-12 13:13:34,126 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:13:34,129 : INFO : Accuracy: 0.8724
2024-08-12 13:13:34,129 : INFO : Precision score for label_class 0: 0.8046
2024-08-12 13:13:34,129 : INFO : Precision score for label_class 1: 0.9186
2024-08-12 13:13:34,129 : INFO : Precision score for label_class 2: 0.8155
2024-08-12 13:13:34,129 : INFO : Recall score for label_class 0: 0.8046
2024-08-12 13:13:34,129 : INFO : Recall score for label_class 1: 0.8974
2024-08-12 13:13:34,129 : INFO : Recall score for label_class 2: 0.8528
2024-08-12 13:13:34,129 : INFO : Average F1 score: 0.8488
2024-08-12 13:13:34,129 : INFO : Validation metric decreased (0.383921 --> 0.378196).  Saving model ...
2024-08-12 13:13:34,230 : INFO : Starting epoch 5
2024-08-12 13:13:34,272 : INFO : Current training batch loss: 0.1660 in epoch 5
2024-08-12 13:13:35,078 : INFO : Current training batch loss: 0.2486 in epoch 5
2024-08-12 13:13:35,884 : INFO : Current training batch loss: 0.2346 in epoch 5
2024-08-12 13:13:36,689 : INFO : Current training batch loss: 0.1992 in epoch 5
2024-08-12 13:13:37,495 : INFO : Current training batch loss: 0.2906 in epoch 5
2024-08-12 13:13:37,636 : INFO : Epoch finished, average loss over training batches: 0.1855
2024-08-12 13:13:37,636 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:13:37,636 : INFO : Training metrics:
2024-08-12 13:13:37,636 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:13:37,640 : INFO : Accuracy: 0.9559
2024-08-12 13:13:37,640 : INFO : Precision score for label_class 0: 0.8974
2024-08-12 13:13:37,640 : INFO : Precision score for label_class 1: 0.9722
2024-08-12 13:13:37,640 : INFO : Precision score for label_class 2: 0.9474
2024-08-12 13:13:37,640 : INFO : Recall score for label_class 0: 0.9358
2024-08-12 13:13:37,640 : INFO : Recall score for label_class 1: 0.9698
2024-08-12 13:13:37,640 : INFO : Recall score for label_class 2: 0.9348
2024-08-12 13:13:37,640 : INFO : Average F1 score: 0.9427
2024-08-12 13:13:37,920 : INFO : Average loss over validation batches: 0.3639
2024-08-12 13:13:37,920 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:13:37,920 : INFO : Validation metrics:
2024-08-12 13:13:37,920 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-12 13:13:37,924 : INFO : Accuracy: 0.8798
2024-08-12 13:13:37,924 : INFO : Precision score for label_class 0: 0.7912
2024-08-12 13:13:37,924 : INFO : Precision score for label_class 1: 0.9109
2024-08-12 13:13:37,924 : INFO : Precision score for label_class 2: 0.8579
2024-08-12 13:13:37,924 : INFO : Recall score for label_class 0: 0.8276
2024-08-12 13:13:37,924 : INFO : Recall score for label_class 1: 0.9179
2024-08-12 13:13:37,924 : INFO : Recall score for label_class 2: 0.8274
2024-08-12 13:13:37,924 : INFO : Average F1 score: 0.8553
2024-08-12 13:13:37,924 : INFO : Validation metric decreased (0.378196 --> 0.363938).  Saving model ...
2024-08-12 13:13:38,026 : INFO : Starting epoch 6
2024-08-12 13:13:38,671 : INFO : Current training batch loss: 0.2550 in epoch 6
2024-08-12 13:13:39,478 : INFO : Current training batch loss: 0.1629 in epoch 6
2024-08-12 13:13:40,285 : INFO : Current training batch loss: 0.0645 in epoch 6
2024-08-12 13:13:41,091 : INFO : Current training batch loss: 0.0902 in epoch 6
