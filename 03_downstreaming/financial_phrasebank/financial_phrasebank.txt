2024-08-15 17:07:14,815 : INFO : Starting to tokenize the sequences.
2024-08-15 17:07:14,821 : INFO : Tokenization is finished.
2024-08-15 17:07:14,834 : INFO : Starting to tokenize the sequences.
2024-08-15 17:07:14,839 : INFO : Tokenization is finished.
2024-08-15 17:07:14,851 : INFO : Starting to tokenize the sequences.
2024-08-15 17:07:14,856 : INFO : Tokenization is finished.
2024-08-15 17:07:14,856 : INFO : Counting occurences of labels...
2024-08-15 17:07:14,876 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 414, 2011,  948]))
2024-08-15 17:07:14,876 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([100, 524, 220]))
[I 2024-08-15 17:07:14,876] A new study created in memory with name: no-name-51a42965-a427-44d5-80a8-6c91b97039bb
2024-08-15 17:07:14,877 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:07:14,877 : INFO : Starting training for split 1
2024-08-15 17:07:14,889 : INFO : Starting to tokenize the sequences.
2024-08-15 17:07:14,894 : INFO : Tokenization is finished.
2024-08-15 17:07:14,906 : INFO : Starting to tokenize the sequences.
2024-08-15 17:07:14,911 : INFO : Tokenization is finished.
2024-08-15 17:07:14,911 : INFO : Counting occurences of labels...
2024-08-15 17:07:14,912 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1596,  774]))
2024-08-15 17:07:14,913 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 415, 174]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:07:15,254 : INFO : Starting epoch 1
2024-08-15 17:07:15,635 : INFO : Current training batch loss: 1.1273 in epoch 1
2024-08-15 17:07:16,446 : INFO : Current training batch loss: 0.9713 in epoch 1
2024-08-15 17:07:17,254 : INFO : Current training batch loss: 0.9559 in epoch 1
2024-08-15 17:07:18,065 : INFO : Current training batch loss: 0.7030 in epoch 1
2024-08-15 17:07:18,875 : INFO : Current training batch loss: 0.6718 in epoch 1
2024-08-15 17:07:19,029 : INFO : Epoch finished, average loss over training batches: 0.8740
2024-08-15 17:07:19,032 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:07:19,032 : INFO : Training metrics:
2024-08-15 17:07:19,032 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:07:19,037 : INFO : Accuracy: 0.5979
2024-08-15 17:07:19,037 : INFO : Precision score for label_class 0: 0.0578
2024-08-15 17:07:19,037 : INFO : Precision score for label_class 1: 0.6913
2024-08-15 17:07:19,037 : INFO : Precision score for label_class 2: 0.4641
2024-08-15 17:07:19,037 : INFO : Recall score for label_class 0: 0.0305
2024-08-15 17:07:19,037 : INFO : Recall score for label_class 1: 0.8221
2024-08-15 17:07:19,037 : INFO : Recall score for label_class 2: 0.3760
2024-08-15 17:07:19,037 : INFO : Average F1 score: 0.4021
2024-08-15 17:07:19,502 : INFO : Average loss over validation batches: 0.6359
2024-08-15 17:07:19,502 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:07:19,502 : INFO : Validation metrics:
2024-08-15 17:07:19,502 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:07:19,504 : INFO : Accuracy: 0.7526
2024-08-15 17:07:19,504 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:07:19,504 : INFO : Precision score for label_class 1: 0.8774
2024-08-15 17:07:19,504 : INFO : Precision score for label_class 2: 0.5418
2024-08-15 17:07:19,504 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:07:19,505 : INFO : Recall score for label_class 1: 0.8964
2024-08-15 17:07:19,505 : INFO : Recall score for label_class 2: 0.7816
2024-08-15 17:07:19,505 : INFO : Average F1 score: 0.5089
2024-08-15 17:07:19,505 : INFO : Validation metric decreased (inf --> 0.635872).  Saving model ...
2024-08-15 17:07:19,585 : INFO : Starting epoch 2
2024-08-15 17:07:20,236 : INFO : Current training batch loss: 0.3716 in epoch 2
2024-08-15 17:07:21,046 : INFO : Current training batch loss: 0.5899 in epoch 2
2024-08-15 17:07:21,942 : INFO : Current training batch loss: 0.3547 in epoch 2
2024-08-15 17:07:22,753 : INFO : Current training batch loss: 0.3387 in epoch 2
2024-08-15 17:07:23,104 : INFO : Epoch finished, average loss over training batches: 0.4690
2024-08-15 17:07:23,104 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:07:23,105 : INFO : Training metrics:
2024-08-15 17:07:23,105 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:07:23,113 : INFO : Accuracy: 0.8391
2024-08-15 17:07:23,113 : INFO : Precision score for label_class 0: 0.7577
2024-08-15 17:07:23,113 : INFO : Precision score for label_class 1: 0.8795
2024-08-15 17:07:23,113 : INFO : Precision score for label_class 2: 0.7730
2024-08-15 17:07:23,113 : INFO : Recall score for label_class 0: 0.5244
2024-08-15 17:07:23,113 : INFO : Recall score for label_class 1: 0.9417
2024-08-15 17:07:23,113 : INFO : Recall score for label_class 2: 0.7610
2024-08-15 17:07:23,113 : INFO : Average F1 score: 0.7654
2024-08-15 17:07:23,578 : INFO : Average loss over validation batches: 0.3953
2024-08-15 17:07:23,578 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:07:23,578 : INFO : Validation metrics:
2024-08-15 17:07:23,578 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:07:23,582 : INFO : Accuracy: 0.8519
2024-08-15 17:07:23,582 : INFO : Precision score for label_class 0: 0.7629
2024-08-15 17:07:23,582 : INFO : Precision score for label_class 1: 0.9319
2024-08-15 17:07:23,582 : INFO : Precision score for label_class 2: 0.7398
2024-08-15 17:07:23,582 : INFO : Recall score for label_class 0: 0.8605
2024-08-15 17:07:23,582 : INFO : Recall score for label_class 1: 0.8578
2024-08-15 17:07:23,582 : INFO : Recall score for label_class 2: 0.8333
2024-08-15 17:07:23,582 : INFO : Average F1 score: 0.8286
2024-08-15 17:07:23,582 : INFO : Validation metric decreased (0.635872 --> 0.395338).  Saving model ...
2024-08-15 17:07:23,729 : INFO : Starting epoch 3
2024-08-15 17:07:24,179 : INFO : Current training batch loss: 0.3172 in epoch 3
2024-08-15 17:07:24,989 : INFO : Current training batch loss: 0.3782 in epoch 3
2024-08-15 17:07:25,798 : INFO : Current training batch loss: 0.2270 in epoch 3
2024-08-15 17:07:26,608 : INFO : Current training batch loss: 0.0976 in epoch 3
2024-08-15 17:07:27,159 : INFO : Epoch finished, average loss over training batches: 0.2794
2024-08-15 17:07:27,159 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:07:27,159 : INFO : Training metrics:
2024-08-15 17:07:27,159 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:07:27,164 : INFO : Accuracy: 0.9110
2024-08-15 17:07:27,164 : INFO : Precision score for label_class 0: 0.8348
2024-08-15 17:07:27,164 : INFO : Precision score for label_class 1: 0.9391
2024-08-15 17:07:27,164 : INFO : Precision score for label_class 2: 0.8853
2024-08-15 17:07:27,164 : INFO : Recall score for label_class 0: 0.8628
2024-08-15 17:07:27,164 : INFO : Recall score for label_class 1: 0.9467
2024-08-15 17:07:27,164 : INFO : Recall score for label_class 2: 0.8579
2024-08-15 17:07:27,164 : INFO : Average F1 score: 0.8876
2024-08-15 17:07:27,629 : INFO : Average loss over validation batches: 0.3475
2024-08-15 17:07:27,630 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:07:27,630 : INFO : Validation metrics:
2024-08-15 17:07:27,630 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:07:27,633 : INFO : Accuracy: 0.8770
2024-08-15 17:07:27,633 : INFO : Precision score for label_class 0: 0.8333
2024-08-15 17:07:27,633 : INFO : Precision score for label_class 1: 0.9157
2024-08-15 17:07:27,633 : INFO : Precision score for label_class 2: 0.8068
2024-08-15 17:07:27,633 : INFO : Recall score for label_class 0: 0.8140
2024-08-15 17:07:27,633 : INFO : Recall score for label_class 1: 0.9157
2024-08-15 17:07:27,633 : INFO : Recall score for label_class 2: 0.8161
2024-08-15 17:07:27,633 : INFO : Average F1 score: 0.8502
2024-08-15 17:07:27,633 : INFO : Validation metric decreased (0.395338 --> 0.347517).  Saving model ...
2024-08-15 17:07:27,733 : INFO : Starting epoch 4
2024-08-15 17:07:27,983 : INFO : Current training batch loss: 0.4806 in epoch 4
2024-08-15 17:07:28,803 : INFO : Current training batch loss: 0.2189 in epoch 4
2024-08-15 17:07:29,635 : INFO : Current training batch loss: 0.2795 in epoch 4
2024-08-15 17:07:30,462 : INFO : Current training batch loss: 0.1717 in epoch 4
2024-08-15 17:07:31,218 : INFO : Epoch finished, average loss over training batches: 0.1842
2024-08-15 17:07:31,218 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:07:31,218 : INFO : Training metrics:
2024-08-15 17:07:31,218 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:07:31,225 : INFO : Accuracy: 0.9444
2024-08-15 17:07:31,225 : INFO : Precision score for label_class 0: 0.8661
2024-08-15 17:07:31,225 : INFO : Precision score for label_class 1: 0.9620
2024-08-15 17:07:31,225 : INFO : Precision score for label_class 2: 0.9432
2024-08-15 17:07:31,225 : INFO : Recall score for label_class 0: 0.9268
2024-08-15 17:07:31,225 : INFO : Recall score for label_class 1: 0.9687
2024-08-15 17:07:31,225 : INFO : Recall score for label_class 2: 0.9018
2024-08-15 17:07:31,225 : INFO : Average F1 score: 0.9276
2024-08-15 17:07:31,689 : INFO : Average loss over validation batches: 0.3226
2024-08-15 17:07:31,689 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:07:31,689 : INFO : Validation metrics:
2024-08-15 17:07:31,689 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:07:31,693 : INFO : Accuracy: 0.8919
2024-08-15 17:07:31,693 : INFO : Precision score for label_class 0: 0.8125
2024-08-15 17:07:31,693 : INFO : Precision score for label_class 1: 0.9398
2024-08-15 17:07:31,693 : INFO : Precision score for label_class 2: 0.8278
2024-08-15 17:07:31,693 : INFO : Recall score for label_class 0: 0.9070
2024-08-15 17:07:31,693 : INFO : Recall score for label_class 1: 0.9036
2024-08-15 17:07:31,693 : INFO : Recall score for label_class 2: 0.8563
2024-08-15 17:07:31,693 : INFO : Average F1 score: 0.8734
2024-08-15 17:07:31,693 : INFO : Validation metric decreased (0.347517 --> 0.322602).  Saving model ...
2024-08-15 17:07:31,792 : INFO : Starting epoch 5
2024-08-15 17:07:31,843 : INFO : Current training batch loss: 0.0582 in epoch 5
2024-08-15 17:07:32,676 : INFO : Current training batch loss: 0.2884 in epoch 5
2024-08-15 17:07:33,505 : INFO : Current training batch loss: 0.0980 in epoch 5
2024-08-15 17:07:34,317 : INFO : Current training batch loss: 0.2062 in epoch 5
2024-08-15 17:07:35,138 : INFO : Current training batch loss: 0.2366 in epoch 5
2024-08-15 17:07:35,289 : INFO : Epoch finished, average loss over training batches: 0.1163
2024-08-15 17:07:35,290 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:07:35,290 : INFO : Training metrics:
2024-08-15 17:07:35,290 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:07:35,294 : INFO : Accuracy: 0.9715
2024-08-15 17:07:35,294 : INFO : Precision score for label_class 0: 0.9292
2024-08-15 17:07:35,294 : INFO : Precision score for label_class 1: 0.9831
2024-08-15 17:07:35,294 : INFO : Precision score for label_class 2: 0.9658
2024-08-15 17:07:35,294 : INFO : Recall score for label_class 0: 0.9604
2024-08-15 17:07:35,294 : INFO : Recall score for label_class 1: 0.9850
2024-08-15 17:07:35,294 : INFO : Recall score for label_class 2: 0.9483
2024-08-15 17:07:35,294 : INFO : Average F1 score: 0.9618
2024-08-15 17:07:35,759 : INFO : Average loss over validation batches: 0.3443
2024-08-15 17:07:35,759 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:07:35,759 : INFO : Validation metrics:
2024-08-15 17:07:35,759 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:07:35,762 : INFO : Accuracy: 0.8919
2024-08-15 17:07:35,762 : INFO : Precision score for label_class 0: 0.8061
2024-08-15 17:07:35,762 : INFO : Precision score for label_class 1: 0.9131
2024-08-15 17:07:35,762 : INFO : Precision score for label_class 2: 0.8874
2024-08-15 17:07:35,762 : INFO : Recall score for label_class 0: 0.9186
2024-08-15 17:07:35,762 : INFO : Recall score for label_class 1: 0.9373
2024-08-15 17:07:35,762 : INFO : Recall score for label_class 2: 0.7701
2024-08-15 17:07:35,762 : INFO : Average F1 score: 0.8695
2024-08-15 17:07:35,763 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:07:35,763 : INFO : Starting epoch 6
2024-08-15 17:07:36,411 : INFO : Current training batch loss: 0.0859 in epoch 6
2024-08-15 17:07:37,219 : INFO : Current training batch loss: 0.0432 in epoch 6
2024-08-15 17:07:38,029 : INFO : Current training batch loss: 0.0314 in epoch 6
2024-08-15 17:07:38,837 : INFO : Current training batch loss: 0.0338 in epoch 6
2024-08-15 17:07:39,186 : INFO : Epoch finished, average loss over training batches: 0.0779
2024-08-15 17:07:39,186 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:07:39,186 : INFO : Training metrics:
2024-08-15 17:07:39,186 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:07:39,194 : INFO : Accuracy: 0.9844
2024-08-15 17:07:39,194 : INFO : Precision score for label_class 0: 0.9444
2024-08-15 17:07:39,194 : INFO : Precision score for label_class 1: 0.9919
2024-08-15 17:07:39,194 : INFO : Precision score for label_class 2: 0.9868
2024-08-15 17:07:39,194 : INFO : Recall score for label_class 0: 0.9848
2024-08-15 17:07:39,194 : INFO : Recall score for label_class 1: 0.9925
2024-08-15 17:07:39,194 : INFO : Recall score for label_class 2: 0.9677
2024-08-15 17:07:39,194 : INFO : Average F1 score: 0.9778
2024-08-15 17:07:39,657 : INFO : Average loss over validation batches: 0.3419
2024-08-15 17:07:39,658 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:07:39,658 : INFO : Validation metrics:
2024-08-15 17:07:39,658 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:07:39,661 : INFO : Accuracy: 0.8844
2024-08-15 17:07:39,661 : INFO : Precision score for label_class 0: 0.8105
2024-08-15 17:07:39,661 : INFO : Precision score for label_class 1: 0.9183
2024-08-15 17:07:39,661 : INFO : Precision score for label_class 2: 0.8415
2024-08-15 17:07:39,661 : INFO : Recall score for label_class 0: 0.8953
2024-08-15 17:07:39,661 : INFO : Recall score for label_class 1: 0.9205
2024-08-15 17:07:39,661 : INFO : Recall score for label_class 2: 0.7931
2024-08-15 17:07:39,661 : INFO : Average F1 score: 0.8623
2024-08-15 17:07:39,661 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:07:39,661 : INFO : Starting epoch 7
2024-08-15 17:07:40,110 : INFO : Current training batch loss: 0.0286 in epoch 7
2024-08-15 17:07:40,918 : INFO : Current training batch loss: 0.0253 in epoch 7
2024-08-15 17:07:41,727 : INFO : Current training batch loss: 0.0331 in epoch 7
2024-08-15 17:07:42,535 : INFO : Current training batch loss: 0.0230 in epoch 7
2024-08-15 17:07:43,084 : INFO : Epoch finished, average loss over training batches: 0.0602
2024-08-15 17:07:43,084 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:07:43,084 : INFO : Training metrics:
2024-08-15 17:07:43,084 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:07:43,092 : INFO : Accuracy: 0.9889
2024-08-15 17:07:43,092 : INFO : Precision score for label_class 0: 0.9500
2024-08-15 17:07:43,092 : INFO : Precision score for label_class 1: 0.9956
2024-08-15 17:07:43,092 : INFO : Precision score for label_class 2: 0.9921
2024-08-15 17:07:43,092 : INFO : Recall score for label_class 0: 0.9848
2024-08-15 17:07:43,092 : INFO : Recall score for label_class 1: 0.9950
2024-08-15 17:07:43,092 : INFO : Recall score for label_class 2: 0.9780
2024-08-15 17:07:43,092 : INFO : Average F1 score: 0.9825
2024-08-15 17:07:43,555 : INFO : Average loss over validation batches: 0.3462
2024-08-15 17:07:43,556 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:07:43,556 : INFO : Validation metrics:
2024-08-15 17:07:43,556 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:07:43,558 : INFO : Accuracy: 0.8874
2024-08-15 17:07:43,558 : INFO : Precision score for label_class 0: 0.8242
2024-08-15 17:07:43,558 : INFO : Precision score for label_class 1: 0.9287
2024-08-15 17:07:43,558 : INFO : Precision score for label_class 2: 0.8249
2024-08-15 17:07:43,558 : INFO : Recall score for label_class 0: 0.8721
2024-08-15 17:07:43,559 : INFO : Recall score for label_class 1: 0.9108
2024-08-15 17:07:43,559 : INFO : Recall score for label_class 2: 0.8391
2024-08-15 17:07:43,559 : INFO : Average F1 score: 0.8664
2024-08-15 17:07:43,559 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:07:43,559 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:07:43,594 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:07:44,093 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:07:44,093 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:07:44,093 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:07:44,096 : INFO : Accuracy: 0.8919
2024-08-15 17:07:44,096 : INFO : Precision score for label_class 0: 0.8125
2024-08-15 17:07:44,096 : INFO : Precision score for label_class 1: 0.9398
2024-08-15 17:07:44,096 : INFO : Precision score for label_class 2: 0.8278
2024-08-15 17:07:44,096 : INFO : Recall score for label_class 0: 0.9070
2024-08-15 17:07:44,096 : INFO : Recall score for label_class 1: 0.9036
2024-08-15 17:07:44,096 : INFO : Recall score for label_class 2: 0.8563
2024-08-15 17:07:44,096 : INFO : Average F1 score: 0.8734
2024-08-15 17:07:44,096 : INFO : Determined score from best model, ending training.
2024-08-15 17:07:44,098 : INFO : Split 1 is finished, the score is: 0.8734
2024-08-15 17:07:44,098 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:07:44,098 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:07:44,098 : INFO : Starting training for split 2
2024-08-15 17:07:44,113 : INFO : Starting to tokenize the sequences.
2024-08-15 17:07:44,979 : INFO : Tokenization is finished.
2024-08-15 17:07:44,996 : INFO : Starting to tokenize the sequences.
2024-08-15 17:07:45,199 : INFO : Tokenization is finished.
2024-08-15 17:07:45,203 : INFO : Counting occurences of labels...
2024-08-15 17:07:45,204 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 343, 1601,  754]))
2024-08-15 17:07:45,205 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 71, 410, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:07:45,243 : INFO : Starting epoch 1
2024-08-15 17:07:45,293 : INFO : Current training batch loss: 1.1174 in epoch 1
2024-08-15 17:07:46,103 : INFO : Current training batch loss: 1.0250 in epoch 1
2024-08-15 17:07:46,913 : INFO : Current training batch loss: 0.9485 in epoch 1
2024-08-15 17:07:47,723 : INFO : Current training batch loss: 0.7007 in epoch 1
2024-08-15 17:07:48,534 : INFO : Current training batch loss: 0.6856 in epoch 1
2024-08-15 17:07:48,683 : INFO : Epoch finished, average loss over training batches: 0.8681
2024-08-15 17:07:48,684 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:07:48,684 : INFO : Training metrics:
2024-08-15 17:07:48,684 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:07:48,695 : INFO : Accuracy: 0.6049
2024-08-15 17:07:48,695 : INFO : Precision score for label_class 0: 0.6667
2024-08-15 17:07:48,695 : INFO : Precision score for label_class 1: 0.6782
2024-08-15 17:07:48,695 : INFO : Precision score for label_class 2: 0.4066
2024-08-15 17:07:48,695 : INFO : Recall score for label_class 0: 0.0117
2024-08-15 17:07:48,695 : INFO : Recall score for label_class 1: 0.8320
2024-08-15 17:07:48,695 : INFO : Recall score for label_class 2: 0.3926
2024-08-15 17:07:48,695 : INFO : Average F1 score: 0.3899
2024-08-15 17:07:49,161 : INFO : Average loss over validation batches: 0.5961
2024-08-15 17:07:49,162 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:07:49,162 : INFO : Validation metrics:
2024-08-15 17:07:49,162 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:07:49,165 : INFO : Accuracy: 0.7719
2024-08-15 17:07:49,165 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:07:49,165 : INFO : Precision score for label_class 1: 0.8418
2024-08-15 17:07:49,165 : INFO : Precision score for label_class 2: 0.6273
2024-08-15 17:07:49,165 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:07:49,165 : INFO : Recall score for label_class 1: 0.9341
2024-08-15 17:07:49,165 : INFO : Recall score for label_class 2: 0.7113
2024-08-15 17:07:49,165 : INFO : Average F1 score: 0.5174
2024-08-15 17:07:49,165 : INFO : Validation metric decreased (inf --> 0.596070).  Saving model ...
2024-08-15 17:07:49,263 : INFO : Starting epoch 2
2024-08-15 17:07:49,913 : INFO : Current training batch loss: 0.5837 in epoch 2
2024-08-15 17:07:50,723 : INFO : Current training batch loss: 0.4844 in epoch 2
2024-08-15 17:07:51,534 : INFO : Current training batch loss: 0.3161 in epoch 2
2024-08-15 17:07:52,345 : INFO : Current training batch loss: 0.2841 in epoch 2
2024-08-15 17:07:52,695 : INFO : Epoch finished, average loss over training batches: 0.4396
2024-08-15 17:07:52,695 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:07:52,695 : INFO : Training metrics:
2024-08-15 17:07:52,695 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:07:52,704 : INFO : Accuracy: 0.8521
2024-08-15 17:07:52,704 : INFO : Precision score for label_class 0: 0.7869
2024-08-15 17:07:52,704 : INFO : Precision score for label_class 1: 0.8853
2024-08-15 17:07:52,704 : INFO : Precision score for label_class 2: 0.8000
2024-08-15 17:07:52,704 : INFO : Recall score for label_class 0: 0.6676
2024-08-15 17:07:52,704 : INFO : Recall score for label_class 1: 0.9357
2024-08-15 17:07:52,704 : INFO : Recall score for label_class 2: 0.7586
2024-08-15 17:07:52,704 : INFO : Average F1 score: 0.8037
2024-08-15 17:07:53,170 : INFO : Average loss over validation batches: 0.3875
2024-08-15 17:07:53,170 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:07:53,170 : INFO : Validation metrics:
2024-08-15 17:07:53,170 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:07:53,174 : INFO : Accuracy: 0.8578
2024-08-15 17:07:53,174 : INFO : Precision score for label_class 0: 0.7333
2024-08-15 17:07:53,174 : INFO : Precision score for label_class 1: 0.8993
2024-08-15 17:07:53,174 : INFO : Precision score for label_class 2: 0.8187
2024-08-15 17:07:53,174 : INFO : Recall score for label_class 0: 0.7746
2024-08-15 17:07:53,174 : INFO : Recall score for label_class 1: 0.8927
2024-08-15 17:07:53,174 : INFO : Recall score for label_class 2: 0.8144
2024-08-15 17:07:53,174 : INFO : Average F1 score: 0.8220
2024-08-15 17:07:53,174 : INFO : Validation metric decreased (0.596070 --> 0.387523).  Saving model ...
2024-08-15 17:07:53,274 : INFO : Starting epoch 3
2024-08-15 17:07:53,723 : INFO : Current training batch loss: 0.2178 in epoch 3
2024-08-15 17:07:54,529 : INFO : Current training batch loss: 0.2569 in epoch 3
2024-08-15 17:07:55,335 : INFO : Current training batch loss: 0.3309 in epoch 3
2024-08-15 17:07:56,142 : INFO : Current training batch loss: 0.0609 in epoch 3
2024-08-15 17:07:56,682 : INFO : Epoch finished, average loss over training batches: 0.2345
2024-08-15 17:07:56,682 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:07:56,682 : INFO : Training metrics:
2024-08-15 17:07:56,682 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:07:56,695 : INFO : Accuracy: 0.9288
2024-08-15 17:07:56,695 : INFO : Precision score for label_class 0: 0.8640
2024-08-15 17:07:56,695 : INFO : Precision score for label_class 1: 0.9533
2024-08-15 17:07:56,695 : INFO : Precision score for label_class 2: 0.9065
2024-08-15 17:07:56,695 : INFO : Recall score for label_class 0: 0.8892
2024-08-15 17:07:56,695 : INFO : Recall score for label_class 1: 0.9569
2024-08-15 17:07:56,695 : INFO : Recall score for label_class 2: 0.8873
2024-08-15 17:07:56,695 : INFO : Average F1 score: 0.9094
2024-08-15 17:07:57,161 : INFO : Average loss over validation batches: 0.3669
2024-08-15 17:07:57,161 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:07:57,161 : INFO : Validation metrics:
2024-08-15 17:07:57,161 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:07:57,165 : INFO : Accuracy: 0.8785
2024-08-15 17:07:57,165 : INFO : Precision score for label_class 0: 0.7568
2024-08-15 17:07:57,165 : INFO : Precision score for label_class 1: 0.8986
2024-08-15 17:07:57,165 : INFO : Precision score for label_class 2: 0.8814
2024-08-15 17:07:57,165 : INFO : Recall score for label_class 0: 0.7887
2024-08-15 17:07:57,165 : INFO : Recall score for label_class 1: 0.9293
2024-08-15 17:07:57,165 : INFO : Recall score for label_class 2: 0.8041
2024-08-15 17:07:57,165 : INFO : Average F1 score: 0.8424
2024-08-15 17:07:57,165 : INFO : Validation metric decreased (0.387523 --> 0.366880).  Saving model ...
2024-08-15 17:07:57,263 : INFO : Starting epoch 4
2024-08-15 17:07:57,512 : INFO : Current training batch loss: 0.2702 in epoch 4
2024-08-15 17:07:58,319 : INFO : Current training batch loss: 0.1142 in epoch 4
2024-08-15 17:07:59,126 : INFO : Current training batch loss: 0.2728 in epoch 4
2024-08-15 17:07:59,933 : INFO : Current training batch loss: 0.1337 in epoch 4
2024-08-15 17:08:00,672 : INFO : Epoch finished, average loss over training batches: 0.1508
2024-08-15 17:08:00,672 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:00,672 : INFO : Training metrics:
2024-08-15 17:08:00,672 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:00,681 : INFO : Accuracy: 0.9585
2024-08-15 17:08:00,681 : INFO : Precision score for label_class 0: 0.9048
2024-08-15 17:08:00,681 : INFO : Precision score for label_class 1: 0.9756
2024-08-15 17:08:00,681 : INFO : Precision score for label_class 2: 0.9475
2024-08-15 17:08:00,682 : INFO : Recall score for label_class 0: 0.9417
2024-08-15 17:08:00,682 : INFO : Recall score for label_class 1: 0.9738
2024-08-15 17:08:00,682 : INFO : Recall score for label_class 2: 0.9337
2024-08-15 17:08:00,682 : INFO : Average F1 score: 0.9460
2024-08-15 17:08:01,148 : INFO : Average loss over validation batches: 0.4437
2024-08-15 17:08:01,148 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:01,148 : INFO : Validation metrics:
2024-08-15 17:08:01,148 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:01,152 : INFO : Accuracy: 0.8430
2024-08-15 17:08:01,152 : INFO : Precision score for label_class 0: 0.7895
2024-08-15 17:08:01,152 : INFO : Precision score for label_class 1: 0.9313
2024-08-15 17:08:01,152 : INFO : Precision score for label_class 2: 0.7234
2024-08-15 17:08:01,152 : INFO : Recall score for label_class 0: 0.8451
2024-08-15 17:08:01,152 : INFO : Recall score for label_class 1: 0.8268
2024-08-15 17:08:01,152 : INFO : Recall score for label_class 2: 0.8763
2024-08-15 17:08:01,152 : INFO : Average F1 score: 0.8283
2024-08-15 17:08:01,152 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:08:01,152 : INFO : Starting epoch 5
2024-08-15 17:08:01,202 : INFO : Current training batch loss: 0.0604 in epoch 5
2024-08-15 17:08:02,008 : INFO : Current training batch loss: 0.1591 in epoch 5
2024-08-15 17:08:02,816 : INFO : Current training batch loss: 0.0410 in epoch 5
2024-08-15 17:08:03,623 : INFO : Current training batch loss: 0.1391 in epoch 5
2024-08-15 17:08:04,431 : INFO : Current training batch loss: 0.2769 in epoch 5
2024-08-15 17:08:04,573 : INFO : Epoch finished, average loss over training batches: 0.0976
2024-08-15 17:08:04,574 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:04,574 : INFO : Training metrics:
2024-08-15 17:08:04,574 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:04,583 : INFO : Accuracy: 0.9748
2024-08-15 17:08:04,583 : INFO : Precision score for label_class 0: 0.9371
2024-08-15 17:08:04,583 : INFO : Precision score for label_class 1: 0.9838
2024-08-15 17:08:04,583 : INFO : Precision score for label_class 2: 0.9730
2024-08-15 17:08:04,583 : INFO : Recall score for label_class 0: 0.9563
2024-08-15 17:08:04,583 : INFO : Recall score for label_class 1: 0.9881
2024-08-15 17:08:04,583 : INFO : Recall score for label_class 2: 0.9549
2024-08-15 17:08:04,583 : INFO : Average F1 score: 0.9655
2024-08-15 17:08:05,048 : INFO : Average loss over validation batches: 0.4355
2024-08-15 17:08:05,048 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:05,048 : INFO : Validation metrics:
2024-08-15 17:08:05,048 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:05,052 : INFO : Accuracy: 0.8622
2024-08-15 17:08:05,052 : INFO : Precision score for label_class 0: 0.7632
2024-08-15 17:08:05,052 : INFO : Precision score for label_class 1: 0.8811
2024-08-15 17:08:05,052 : INFO : Precision score for label_class 2: 0.8588
2024-08-15 17:08:05,052 : INFO : Recall score for label_class 0: 0.8169
2024-08-15 17:08:05,052 : INFO : Recall score for label_class 1: 0.9220
2024-08-15 17:08:05,052 : INFO : Recall score for label_class 2: 0.7526
2024-08-15 17:08:05,052 : INFO : Average F1 score: 0.8308
2024-08-15 17:08:05,052 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:08:05,052 : INFO : Starting epoch 6
2024-08-15 17:08:05,700 : INFO : Current training batch loss: 0.0354 in epoch 6
2024-08-15 17:08:06,507 : INFO : Current training batch loss: 0.0871 in epoch 6
2024-08-15 17:08:07,315 : INFO : Current training batch loss: 0.0227 in epoch 6
2024-08-15 17:08:08,122 : INFO : Current training batch loss: 0.0345 in epoch 6
2024-08-15 17:08:08,464 : INFO : Epoch finished, average loss over training batches: 0.0654
2024-08-15 17:08:08,464 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:08,464 : INFO : Training metrics:
2024-08-15 17:08:08,464 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:08,476 : INFO : Accuracy: 0.9874
2024-08-15 17:08:08,476 : INFO : Precision score for label_class 0: 0.9545
2024-08-15 17:08:08,476 : INFO : Precision score for label_class 1: 0.9950
2024-08-15 17:08:08,476 : INFO : Precision score for label_class 2: 0.9866
2024-08-15 17:08:08,476 : INFO : Recall score for label_class 0: 0.9796
2024-08-15 17:08:08,476 : INFO : Recall score for label_class 1: 0.9938
2024-08-15 17:08:08,476 : INFO : Recall score for label_class 2: 0.9775
2024-08-15 17:08:08,476 : INFO : Average F1 score: 0.9811
2024-08-15 17:08:08,941 : INFO : Average loss over validation batches: 0.4404
2024-08-15 17:08:08,941 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:08,941 : INFO : Validation metrics:
2024-08-15 17:08:08,941 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:08,945 : INFO : Accuracy: 0.8652
2024-08-15 17:08:08,945 : INFO : Precision score for label_class 0: 0.7792
2024-08-15 17:08:08,945 : INFO : Precision score for label_class 1: 0.8871
2024-08-15 17:08:08,945 : INFO : Precision score for label_class 2: 0.8497
2024-08-15 17:08:08,945 : INFO : Recall score for label_class 0: 0.8451
2024-08-15 17:08:08,945 : INFO : Recall score for label_class 1: 0.9195
2024-08-15 17:08:08,945 : INFO : Recall score for label_class 2: 0.7577
2024-08-15 17:08:08,945 : INFO : Average F1 score: 0.8383
2024-08-15 17:08:08,945 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:08:08,945 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:08:08,978 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:08:09,473 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:09,473 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:08:09,473 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:09,477 : INFO : Accuracy: 0.8785
2024-08-15 17:08:09,477 : INFO : Precision score for label_class 0: 0.7568
2024-08-15 17:08:09,477 : INFO : Precision score for label_class 1: 0.8986
2024-08-15 17:08:09,477 : INFO : Precision score for label_class 2: 0.8814
2024-08-15 17:08:09,477 : INFO : Recall score for label_class 0: 0.7887
2024-08-15 17:08:09,477 : INFO : Recall score for label_class 1: 0.9293
2024-08-15 17:08:09,477 : INFO : Recall score for label_class 2: 0.8041
2024-08-15 17:08:09,477 : INFO : Average F1 score: 0.8424
2024-08-15 17:08:09,477 : INFO : Determined score from best model, ending training.
2024-08-15 17:08:09,478 : INFO : Split 2 is finished, the score is: 0.8424
2024-08-15 17:08:09,478 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:09,478 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:09,478 : INFO : Starting training for split 3
2024-08-15 17:08:09,493 : INFO : Starting to tokenize the sequences.
2024-08-15 17:08:10,449 : INFO : Tokenization is finished.
2024-08-15 17:08:10,468 : INFO : Starting to tokenize the sequences.
2024-08-15 17:08:10,671 : INFO : Tokenization is finished.
2024-08-15 17:08:10,676 : INFO : Counting occurences of labels...
2024-08-15 17:08:10,677 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1611,  759]))
2024-08-15 17:08:10,677 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 400, 189]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:08:10,718 : INFO : Starting epoch 1
2024-08-15 17:08:10,769 : INFO : Current training batch loss: 1.1231 in epoch 1
2024-08-15 17:08:11,576 : INFO : Current training batch loss: 1.0218 in epoch 1
2024-08-15 17:08:12,383 : INFO : Current training batch loss: 0.8038 in epoch 1
2024-08-15 17:08:13,192 : INFO : Current training batch loss: 0.7476 in epoch 1
2024-08-15 17:08:14,000 : INFO : Current training batch loss: 0.7115 in epoch 1
2024-08-15 17:08:14,142 : INFO : Epoch finished, average loss over training batches: 0.8562
2024-08-15 17:08:14,143 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:14,143 : INFO : Training metrics:
2024-08-15 17:08:14,143 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:14,152 : INFO : Accuracy: 0.6134
2024-08-15 17:08:14,152 : INFO : Precision score for label_class 0: 0.1288
2024-08-15 17:08:14,152 : INFO : Precision score for label_class 1: 0.6935
2024-08-15 17:08:14,152 : INFO : Precision score for label_class 2: 0.5707
2024-08-15 17:08:14,152 : INFO : Recall score for label_class 0: 0.1159
2024-08-15 17:08:14,152 : INFO : Recall score for label_class 1: 0.8610
2024-08-15 17:08:14,152 : INFO : Recall score for label_class 2: 0.3030
2024-08-15 17:08:14,152 : INFO : Average F1 score: 0.4287
2024-08-15 17:08:14,618 : INFO : Average loss over validation batches: 0.6461
2024-08-15 17:08:14,618 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:14,618 : INFO : Validation metrics:
2024-08-15 17:08:14,618 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:14,621 : INFO : Accuracy: 0.7156
2024-08-15 17:08:14,621 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:08:14,621 : INFO : Precision score for label_class 1: 0.8106
2024-08-15 17:08:14,621 : INFO : Precision score for label_class 2: 0.5204
2024-08-15 17:08:14,621 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:08:14,621 : INFO : Recall score for label_class 1: 0.9200
2024-08-15 17:08:14,621 : INFO : Recall score for label_class 2: 0.6085
2024-08-15 17:08:14,621 : INFO : Average F1 score: 0.4743
2024-08-15 17:08:14,621 : INFO : Validation metric decreased (inf --> 0.646074).  Saving model ...
2024-08-15 17:08:14,719 : INFO : Starting epoch 2
2024-08-15 17:08:15,367 : INFO : Current training batch loss: 0.6195 in epoch 2
2024-08-15 17:08:16,175 : INFO : Current training batch loss: 0.5270 in epoch 2
2024-08-15 17:08:16,982 : INFO : Current training batch loss: 0.4439 in epoch 2
2024-08-15 17:08:17,791 : INFO : Current training batch loss: 0.4161 in epoch 2
2024-08-15 17:08:18,133 : INFO : Epoch finished, average loss over training batches: 0.5108
2024-08-15 17:08:18,133 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:18,133 : INFO : Training metrics:
2024-08-15 17:08:18,133 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:18,142 : INFO : Accuracy: 0.8176
2024-08-15 17:08:18,142 : INFO : Precision score for label_class 0: 0.7467
2024-08-15 17:08:18,142 : INFO : Precision score for label_class 1: 0.8601
2024-08-15 17:08:18,142 : INFO : Precision score for label_class 2: 0.7380
2024-08-15 17:08:18,142 : INFO : Recall score for label_class 0: 0.5122
2024-08-15 17:08:18,142 : INFO : Recall score for label_class 1: 0.9311
2024-08-15 17:08:18,142 : INFO : Recall score for label_class 2: 0.7088
2024-08-15 17:08:18,142 : INFO : Average F1 score: 0.7416
2024-08-15 17:08:18,608 : INFO : Average loss over validation batches: 0.4255
2024-08-15 17:08:18,608 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:18,608 : INFO : Validation metrics:
2024-08-15 17:08:18,608 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:18,610 : INFO : Accuracy: 0.8563
2024-08-15 17:08:18,610 : INFO : Precision score for label_class 0: 0.7975
2024-08-15 17:08:18,610 : INFO : Precision score for label_class 1: 0.8978
2024-08-15 17:08:18,610 : INFO : Precision score for label_class 2: 0.7892
2024-08-15 17:08:18,610 : INFO : Recall score for label_class 0: 0.7326
2024-08-15 17:08:18,610 : INFO : Recall score for label_class 1: 0.9225
2024-08-15 17:08:18,610 : INFO : Recall score for label_class 2: 0.7725
2024-08-15 17:08:18,610 : INFO : Average F1 score: 0.8181
2024-08-15 17:08:18,610 : INFO : Validation metric decreased (0.646074 --> 0.425488).  Saving model ...
2024-08-15 17:08:18,708 : INFO : Starting epoch 3
2024-08-15 17:08:19,157 : INFO : Current training batch loss: 0.4479 in epoch 3
2024-08-15 17:08:19,965 : INFO : Current training batch loss: 0.2880 in epoch 3
2024-08-15 17:08:20,774 : INFO : Current training batch loss: 0.3004 in epoch 3
2024-08-15 17:08:21,582 : INFO : Current training batch loss: 0.1695 in epoch 3
2024-08-15 17:08:22,123 : INFO : Epoch finished, average loss over training batches: 0.2904
2024-08-15 17:08:22,123 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:22,123 : INFO : Training metrics:
2024-08-15 17:08:22,123 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:22,130 : INFO : Accuracy: 0.9114
2024-08-15 17:08:22,130 : INFO : Precision score for label_class 0: 0.8270
2024-08-15 17:08:22,130 : INFO : Precision score for label_class 1: 0.9385
2024-08-15 17:08:22,130 : INFO : Precision score for label_class 2: 0.8906
2024-08-15 17:08:22,130 : INFO : Recall score for label_class 0: 0.8598
2024-08-15 17:08:22,130 : INFO : Recall score for label_class 1: 0.9472
2024-08-15 17:08:22,130 : INFO : Recall score for label_class 2: 0.8577
2024-08-15 17:08:22,130 : INFO : Average F1 score: 0.8866
2024-08-15 17:08:22,595 : INFO : Average loss over validation batches: 0.3511
2024-08-15 17:08:22,595 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:22,595 : INFO : Validation metrics:
2024-08-15 17:08:22,595 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:22,597 : INFO : Accuracy: 0.8741
2024-08-15 17:08:22,598 : INFO : Precision score for label_class 0: 0.8353
2024-08-15 17:08:22,598 : INFO : Precision score for label_class 1: 0.9154
2024-08-15 17:08:22,598 : INFO : Precision score for label_class 2: 0.8032
2024-08-15 17:08:22,598 : INFO : Recall score for label_class 0: 0.8256
2024-08-15 17:08:22,598 : INFO : Recall score for label_class 1: 0.9200
2024-08-15 17:08:22,598 : INFO : Recall score for label_class 2: 0.7989
2024-08-15 17:08:22,598 : INFO : Average F1 score: 0.8497
2024-08-15 17:08:22,598 : INFO : Validation metric decreased (0.425488 --> 0.351070).  Saving model ...
2024-08-15 17:08:22,699 : INFO : Starting epoch 4
2024-08-15 17:08:22,951 : INFO : Current training batch loss: 0.3654 in epoch 4
2024-08-15 17:08:23,764 : INFO : Current training batch loss: 0.3440 in epoch 4
2024-08-15 17:08:24,578 : INFO : Current training batch loss: 0.1863 in epoch 4
2024-08-15 17:08:25,392 : INFO : Current training batch loss: 0.1029 in epoch 4
2024-08-15 17:08:26,145 : INFO : Epoch finished, average loss over training batches: 0.1810
2024-08-15 17:08:26,145 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:26,145 : INFO : Training metrics:
2024-08-15 17:08:26,145 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:26,153 : INFO : Accuracy: 0.9466
2024-08-15 17:08:26,153 : INFO : Precision score for label_class 0: 0.8772
2024-08-15 17:08:26,153 : INFO : Precision score for label_class 1: 0.9625
2024-08-15 17:08:26,153 : INFO : Precision score for label_class 2: 0.9439
2024-08-15 17:08:26,153 : INFO : Recall score for label_class 0: 0.9146
2024-08-15 17:08:26,153 : INFO : Recall score for label_class 1: 0.9708
2024-08-15 17:08:26,153 : INFO : Recall score for label_class 2: 0.9091
2024-08-15 17:08:26,153 : INFO : Average F1 score: 0.9294
2024-08-15 17:08:26,618 : INFO : Average loss over validation batches: 0.4070
2024-08-15 17:08:26,618 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:26,618 : INFO : Validation metrics:
2024-08-15 17:08:26,618 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:26,620 : INFO : Accuracy: 0.8519
2024-08-15 17:08:26,620 : INFO : Precision score for label_class 0: 0.7091
2024-08-15 17:08:26,620 : INFO : Precision score for label_class 1: 0.9444
2024-08-15 17:08:26,620 : INFO : Precision score for label_class 2: 0.7659
2024-08-15 17:08:26,620 : INFO : Recall score for label_class 0: 0.9070
2024-08-15 17:08:26,620 : INFO : Recall score for label_class 1: 0.8500
2024-08-15 17:08:26,620 : INFO : Recall score for label_class 2: 0.8307
2024-08-15 17:08:26,620 : INFO : Average F1 score: 0.8292
2024-08-15 17:08:26,620 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:08:26,621 : INFO : Starting epoch 5
2024-08-15 17:08:26,671 : INFO : Current training batch loss: 0.1427 in epoch 5
2024-08-15 17:08:27,484 : INFO : Current training batch loss: 0.1827 in epoch 5
2024-08-15 17:08:28,298 : INFO : Current training batch loss: 0.0422 in epoch 5
2024-08-15 17:08:29,113 : INFO : Current training batch loss: 0.1464 in epoch 5
2024-08-15 17:08:29,927 : INFO : Current training batch loss: 0.2746 in epoch 5
2024-08-15 17:08:30,078 : INFO : Epoch finished, average loss over training batches: 0.1308
2024-08-15 17:08:30,078 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:30,078 : INFO : Training metrics:
2024-08-15 17:08:30,078 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:30,082 : INFO : Accuracy: 0.9666
2024-08-15 17:08:30,082 : INFO : Precision score for label_class 0: 0.9008
2024-08-15 17:08:30,082 : INFO : Precision score for label_class 1: 0.9801
2024-08-15 17:08:30,082 : INFO : Precision score for label_class 2: 0.9688
2024-08-15 17:08:30,082 : INFO : Recall score for label_class 0: 0.9695
2024-08-15 17:08:30,082 : INFO : Recall score for label_class 1: 0.9777
2024-08-15 17:08:30,082 : INFO : Recall score for label_class 2: 0.9420
2024-08-15 17:08:30,082 : INFO : Average F1 score: 0.9560
2024-08-15 17:08:30,547 : INFO : Average loss over validation batches: 0.4150
2024-08-15 17:08:30,547 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:30,547 : INFO : Validation metrics:
2024-08-15 17:08:30,547 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:30,549 : INFO : Accuracy: 0.8800
2024-08-15 17:08:30,549 : INFO : Precision score for label_class 0: 0.8152
2024-08-15 17:08:30,549 : INFO : Precision score for label_class 1: 0.8860
2024-08-15 17:08:30,549 : INFO : Precision score for label_class 2: 0.9020
2024-08-15 17:08:30,549 : INFO : Recall score for label_class 0: 0.8721
2024-08-15 17:08:30,549 : INFO : Recall score for label_class 1: 0.9525
2024-08-15 17:08:30,549 : INFO : Recall score for label_class 2: 0.7302
2024-08-15 17:08:30,549 : INFO : Average F1 score: 0.8559
2024-08-15 17:08:30,549 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:08:30,549 : INFO : Starting epoch 6
2024-08-15 17:08:31,202 : INFO : Current training batch loss: 0.1233 in epoch 6
2024-08-15 17:08:32,016 : INFO : Current training batch loss: 0.0930 in epoch 6
2024-08-15 17:08:32,831 : INFO : Current training batch loss: 0.0331 in epoch 6
2024-08-15 17:08:33,645 : INFO : Current training batch loss: 0.0266 in epoch 6
2024-08-15 17:08:33,996 : INFO : Epoch finished, average loss over training batches: 0.0896
2024-08-15 17:08:33,996 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:33,996 : INFO : Training metrics:
2024-08-15 17:08:33,996 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:34,000 : INFO : Accuracy: 0.9800
2024-08-15 17:08:34,000 : INFO : Precision score for label_class 0: 0.9145
2024-08-15 17:08:34,000 : INFO : Precision score for label_class 1: 0.9901
2024-08-15 17:08:34,000 : INFO : Precision score for label_class 2: 0.9892
2024-08-15 17:08:34,000 : INFO : Recall score for label_class 0: 0.9787
2024-08-15 17:08:34,000 : INFO : Recall score for label_class 1: 0.9888
2024-08-15 17:08:34,000 : INFO : Recall score for label_class 2: 0.9618
2024-08-15 17:08:34,000 : INFO : Average F1 score: 0.9701
2024-08-15 17:08:34,465 : INFO : Average loss over validation batches: 0.4052
2024-08-15 17:08:34,465 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:34,465 : INFO : Validation metrics:
2024-08-15 17:08:34,465 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:34,467 : INFO : Accuracy: 0.8800
2024-08-15 17:08:34,467 : INFO : Precision score for label_class 0: 0.8211
2024-08-15 17:08:34,467 : INFO : Precision score for label_class 1: 0.9029
2024-08-15 17:08:34,467 : INFO : Precision score for label_class 2: 0.8571
2024-08-15 17:08:34,468 : INFO : Recall score for label_class 0: 0.9070
2024-08-15 17:08:34,468 : INFO : Recall score for label_class 1: 0.9300
2024-08-15 17:08:34,468 : INFO : Recall score for label_class 2: 0.7619
2024-08-15 17:08:34,468 : INFO : Average F1 score: 0.8616
2024-08-15 17:08:34,468 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:08:34,468 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:08:34,499 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:08:34,989 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:34,989 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:08:34,989 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:34,991 : INFO : Accuracy: 0.8741
2024-08-15 17:08:34,991 : INFO : Precision score for label_class 0: 0.8353
2024-08-15 17:08:34,991 : INFO : Precision score for label_class 1: 0.9154
2024-08-15 17:08:34,991 : INFO : Precision score for label_class 2: 0.8032
2024-08-15 17:08:34,991 : INFO : Recall score for label_class 0: 0.8256
2024-08-15 17:08:34,991 : INFO : Recall score for label_class 1: 0.9200
2024-08-15 17:08:34,991 : INFO : Recall score for label_class 2: 0.7989
2024-08-15 17:08:34,991 : INFO : Average F1 score: 0.8497
2024-08-15 17:08:34,991 : INFO : Determined score from best model, ending training.
2024-08-15 17:08:34,993 : INFO : Split 3 is finished, the score is: 0.8497
2024-08-15 17:08:34,993 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:34,993 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:34,993 : INFO : Starting training for split 4
2024-08-15 17:08:35,006 : INFO : Starting to tokenize the sequences.
2024-08-15 17:08:35,871 : INFO : Tokenization is finished.
2024-08-15 17:08:35,891 : INFO : Starting to tokenize the sequences.
2024-08-15 17:08:36,094 : INFO : Tokenization is finished.
2024-08-15 17:08:36,099 : INFO : Counting occurences of labels...
2024-08-15 17:08:36,100 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 327, 1621,  751]))
2024-08-15 17:08:36,100 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 87, 390, 197]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:08:36,141 : INFO : Starting epoch 1
2024-08-15 17:08:36,192 : INFO : Current training batch loss: 1.0638 in epoch 1
2024-08-15 17:08:37,005 : INFO : Current training batch loss: 1.0188 in epoch 1
2024-08-15 17:08:37,820 : INFO : Current training batch loss: 0.7925 in epoch 1
2024-08-15 17:08:38,634 : INFO : Current training batch loss: 0.6963 in epoch 1
2024-08-15 17:08:39,449 : INFO : Current training batch loss: 0.7072 in epoch 1
2024-08-15 17:08:39,600 : INFO : Epoch finished, average loss over training batches: 0.8436
2024-08-15 17:08:39,601 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:39,601 : INFO : Training metrics:
2024-08-15 17:08:39,601 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:39,608 : INFO : Accuracy: 0.6688
2024-08-15 17:08:39,608 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:08:39,608 : INFO : Precision score for label_class 1: 0.6884
2024-08-15 17:08:39,608 : INFO : Precision score for label_class 2: 0.5596
2024-08-15 17:08:39,608 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:08:39,608 : INFO : Recall score for label_class 1: 0.9716
2024-08-15 17:08:39,608 : INFO : Recall score for label_class 2: 0.3063
2024-08-15 17:08:39,608 : INFO : Average F1 score: 0.4006
2024-08-15 17:08:40,076 : INFO : Average loss over validation batches: 0.7140
2024-08-15 17:08:40,076 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:40,076 : INFO : Validation metrics:
2024-08-15 17:08:40,076 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:40,080 : INFO : Accuracy: 0.7211
2024-08-15 17:08:40,080 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:08:40,080 : INFO : Precision score for label_class 1: 0.7707
2024-08-15 17:08:40,080 : INFO : Precision score for label_class 2: 0.5947
2024-08-15 17:08:40,080 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:08:40,080 : INFO : Recall score for label_class 1: 0.9564
2024-08-15 17:08:40,080 : INFO : Recall score for label_class 2: 0.5736
2024-08-15 17:08:40,080 : INFO : Average F1 score: 0.4792
2024-08-15 17:08:40,080 : INFO : Validation metric decreased (inf --> 0.714005).  Saving model ...
2024-08-15 17:08:40,178 : INFO : Starting epoch 2
2024-08-15 17:08:40,832 : INFO : Current training batch loss: 0.6752 in epoch 2
2024-08-15 17:08:41,646 : INFO : Current training batch loss: 0.4975 in epoch 2
2024-08-15 17:08:42,460 : INFO : Current training batch loss: 0.3728 in epoch 2
2024-08-15 17:08:43,274 : INFO : Current training batch loss: 0.4594 in epoch 2
2024-08-15 17:08:43,626 : INFO : Epoch finished, average loss over training batches: 0.5448
2024-08-15 17:08:43,626 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:43,626 : INFO : Training metrics:
2024-08-15 17:08:43,627 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:43,632 : INFO : Accuracy: 0.7866
2024-08-15 17:08:43,632 : INFO : Precision score for label_class 0: 0.7200
2024-08-15 17:08:43,632 : INFO : Precision score for label_class 1: 0.8569
2024-08-15 17:08:43,632 : INFO : Precision score for label_class 2: 0.6463
2024-08-15 17:08:43,632 : INFO : Recall score for label_class 0: 0.2752
2024-08-15 17:08:43,632 : INFO : Recall score for label_class 1: 0.9272
2024-08-15 17:08:43,632 : INFO : Recall score for label_class 2: 0.7057
2024-08-15 17:08:43,632 : INFO : Average F1 score: 0.6545
2024-08-15 17:08:44,100 : INFO : Average loss over validation batches: 0.4271
2024-08-15 17:08:44,100 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:44,100 : INFO : Validation metrics:
2024-08-15 17:08:44,100 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:44,103 : INFO : Accuracy: 0.8487
2024-08-15 17:08:44,103 : INFO : Precision score for label_class 0: 0.6698
2024-08-15 17:08:44,103 : INFO : Precision score for label_class 1: 0.8862
2024-08-15 17:08:44,103 : INFO : Precision score for label_class 2: 0.8710
2024-08-15 17:08:44,103 : INFO : Recall score for label_class 0: 0.8161
2024-08-15 17:08:44,103 : INFO : Recall score for label_class 1: 0.9385
2024-08-15 17:08:44,103 : INFO : Recall score for label_class 2: 0.6853
2024-08-15 17:08:44,103 : INFO : Average F1 score: 0.8048
2024-08-15 17:08:44,103 : INFO : Validation metric decreased (0.714005 --> 0.427139).  Saving model ...
2024-08-15 17:08:44,204 : INFO : Starting epoch 3
2024-08-15 17:08:44,654 : INFO : Current training batch loss: 0.3746 in epoch 3
2024-08-15 17:08:45,469 : INFO : Current training batch loss: 0.3552 in epoch 3
2024-08-15 17:08:46,283 : INFO : Current training batch loss: 0.2942 in epoch 3
2024-08-15 17:08:47,098 : INFO : Current training batch loss: 0.1480 in epoch 3
2024-08-15 17:08:47,651 : INFO : Epoch finished, average loss over training batches: 0.3034
2024-08-15 17:08:47,651 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:47,651 : INFO : Training metrics:
2024-08-15 17:08:47,651 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:47,655 : INFO : Accuracy: 0.8981
2024-08-15 17:08:47,655 : INFO : Precision score for label_class 0: 0.7953
2024-08-15 17:08:47,655 : INFO : Precision score for label_class 1: 0.9350
2024-08-15 17:08:47,655 : INFO : Precision score for label_class 2: 0.8638
2024-08-15 17:08:47,655 : INFO : Recall score for label_class 0: 0.8318
2024-08-15 17:08:47,655 : INFO : Recall score for label_class 1: 0.9402
2024-08-15 17:08:47,655 : INFO : Recall score for label_class 2: 0.8362
2024-08-15 17:08:47,655 : INFO : Average F1 score: 0.8668
2024-08-15 17:08:48,122 : INFO : Average loss over validation batches: 0.3853
2024-08-15 17:08:48,122 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:48,122 : INFO : Validation metrics:
2024-08-15 17:08:48,122 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:48,126 : INFO : Accuracy: 0.8680
2024-08-15 17:08:48,126 : INFO : Precision score for label_class 0: 0.8272
2024-08-15 17:08:48,126 : INFO : Precision score for label_class 1: 0.8936
2024-08-15 17:08:48,126 : INFO : Precision score for label_class 2: 0.8307
2024-08-15 17:08:48,126 : INFO : Recall score for label_class 0: 0.7701
2024-08-15 17:08:48,126 : INFO : Recall score for label_class 1: 0.9256
2024-08-15 17:08:48,126 : INFO : Recall score for label_class 2: 0.7970
2024-08-15 17:08:48,126 : INFO : Average F1 score: 0.8401
2024-08-15 17:08:48,126 : INFO : Validation metric decreased (0.427139 --> 0.385330).  Saving model ...
2024-08-15 17:08:48,224 : INFO : Starting epoch 4
2024-08-15 17:08:48,476 : INFO : Current training batch loss: 0.3591 in epoch 4
2024-08-15 17:08:49,290 : INFO : Current training batch loss: 0.2114 in epoch 4
2024-08-15 17:08:50,190 : INFO : Current training batch loss: 0.2672 in epoch 4
2024-08-15 17:08:51,006 : INFO : Current training batch loss: 0.1495 in epoch 4
2024-08-15 17:08:51,760 : INFO : Epoch finished, average loss over training batches: 0.1798
2024-08-15 17:08:51,760 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:51,760 : INFO : Training metrics:
2024-08-15 17:08:51,760 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:51,764 : INFO : Accuracy: 0.9478
2024-08-15 17:08:51,764 : INFO : Precision score for label_class 0: 0.8824
2024-08-15 17:08:51,764 : INFO : Precision score for label_class 1: 0.9702
2024-08-15 17:08:51,764 : INFO : Precision score for label_class 2: 0.9290
2024-08-15 17:08:51,764 : INFO : Recall score for label_class 0: 0.9174
2024-08-15 17:08:51,764 : INFO : Recall score for label_class 1: 0.9655
2024-08-15 17:08:51,764 : INFO : Recall score for label_class 2: 0.9228
2024-08-15 17:08:51,764 : INFO : Average F1 score: 0.9311
2024-08-15 17:08:52,229 : INFO : Average loss over validation batches: 0.4000
2024-08-15 17:08:52,229 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:52,229 : INFO : Validation metrics:
2024-08-15 17:08:52,229 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:52,233 : INFO : Accuracy: 0.8665
2024-08-15 17:08:52,233 : INFO : Precision score for label_class 0: 0.7600
2024-08-15 17:08:52,233 : INFO : Precision score for label_class 1: 0.9138
2024-08-15 17:08:52,233 : INFO : Precision score for label_class 2: 0.8272
2024-08-15 17:08:52,233 : INFO : Recall score for label_class 0: 0.8736
2024-08-15 17:08:52,233 : INFO : Recall score for label_class 1: 0.8974
2024-08-15 17:08:52,233 : INFO : Recall score for label_class 2: 0.8020
2024-08-15 17:08:52,233 : INFO : Average F1 score: 0.8443
2024-08-15 17:08:52,233 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:08:52,234 : INFO : Starting epoch 5
2024-08-15 17:08:52,284 : INFO : Current training batch loss: 0.0660 in epoch 5
2024-08-15 17:08:53,099 : INFO : Current training batch loss: 0.1303 in epoch 5
2024-08-15 17:08:53,913 : INFO : Current training batch loss: 0.0470 in epoch 5
2024-08-15 17:08:54,728 : INFO : Current training batch loss: 0.2008 in epoch 5
2024-08-15 17:08:55,543 : INFO : Current training batch loss: 0.1900 in epoch 5
2024-08-15 17:08:55,694 : INFO : Epoch finished, average loss over training batches: 0.1144
2024-08-15 17:08:55,694 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:55,694 : INFO : Training metrics:
2024-08-15 17:08:55,694 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:55,701 : INFO : Accuracy: 0.9692
2024-08-15 17:08:55,701 : INFO : Precision score for label_class 0: 0.9118
2024-08-15 17:08:55,701 : INFO : Precision score for label_class 1: 0.9851
2024-08-15 17:08:55,701 : INFO : Precision score for label_class 2: 0.9613
2024-08-15 17:08:55,701 : INFO : Recall score for label_class 0: 0.9480
2024-08-15 17:08:55,701 : INFO : Recall score for label_class 1: 0.9784
2024-08-15 17:08:55,701 : INFO : Recall score for label_class 2: 0.9587
2024-08-15 17:08:55,701 : INFO : Average F1 score: 0.9571
2024-08-15 17:08:56,166 : INFO : Average loss over validation batches: 0.4006
2024-08-15 17:08:56,167 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:56,167 : INFO : Validation metrics:
2024-08-15 17:08:56,167 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:56,170 : INFO : Accuracy: 0.8739
2024-08-15 17:08:56,170 : INFO : Precision score for label_class 0: 0.7732
2024-08-15 17:08:56,170 : INFO : Precision score for label_class 1: 0.9043
2024-08-15 17:08:56,170 : INFO : Precision score for label_class 2: 0.8611
2024-08-15 17:08:56,170 : INFO : Recall score for label_class 0: 0.8621
2024-08-15 17:08:56,170 : INFO : Recall score for label_class 1: 0.9205
2024-08-15 17:08:56,170 : INFO : Recall score for label_class 2: 0.7868
2024-08-15 17:08:56,170 : INFO : Average F1 score: 0.8499
2024-08-15 17:08:56,170 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:08:56,170 : INFO : Starting epoch 6
2024-08-15 17:08:56,825 : INFO : Current training batch loss: 0.0380 in epoch 6
2024-08-15 17:08:57,640 : INFO : Current training batch loss: 0.1155 in epoch 6
2024-08-15 17:08:58,455 : INFO : Current training batch loss: 0.0371 in epoch 6
2024-08-15 17:08:59,270 : INFO : Current training batch loss: 0.0317 in epoch 6
2024-08-15 17:08:59,622 : INFO : Epoch finished, average loss over training batches: 0.0724
2024-08-15 17:08:59,622 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:59,622 : INFO : Training metrics:
2024-08-15 17:08:59,622 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:08:59,626 : INFO : Accuracy: 0.9830
2024-08-15 17:08:59,626 : INFO : Precision score for label_class 0: 0.9298
2024-08-15 17:08:59,626 : INFO : Precision score for label_class 1: 0.9938
2024-08-15 17:08:59,626 : INFO : Precision score for label_class 2: 0.9839
2024-08-15 17:08:59,626 : INFO : Recall score for label_class 0: 0.9725
2024-08-15 17:08:59,626 : INFO : Recall score for label_class 1: 0.9877
2024-08-15 17:08:59,626 : INFO : Recall score for label_class 2: 0.9774
2024-08-15 17:08:59,626 : INFO : Average F1 score: 0.9740
2024-08-15 17:09:00,093 : INFO : Average loss over validation batches: 0.4317
2024-08-15 17:09:00,093 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:00,093 : INFO : Validation metrics:
2024-08-15 17:09:00,093 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:00,097 : INFO : Accuracy: 0.8709
2024-08-15 17:09:00,097 : INFO : Precision score for label_class 0: 0.7935
2024-08-15 17:09:00,097 : INFO : Precision score for label_class 1: 0.8841
2024-08-15 17:09:00,097 : INFO : Precision score for label_class 2: 0.8810
2024-08-15 17:09:00,097 : INFO : Recall score for label_class 0: 0.8391
2024-08-15 17:09:00,097 : INFO : Recall score for label_class 1: 0.9385
2024-08-15 17:09:00,097 : INFO : Recall score for label_class 2: 0.7513
2024-08-15 17:09:00,097 : INFO : Average F1 score: 0.8457
2024-08-15 17:09:00,097 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:09:00,097 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:09:00,131 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:09:00,622 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:00,622 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:09:00,622 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:00,626 : INFO : Accuracy: 0.8680
2024-08-15 17:09:00,626 : INFO : Precision score for label_class 0: 0.8272
2024-08-15 17:09:00,626 : INFO : Precision score for label_class 1: 0.8936
2024-08-15 17:09:00,626 : INFO : Precision score for label_class 2: 0.8307
2024-08-15 17:09:00,626 : INFO : Recall score for label_class 0: 0.7701
2024-08-15 17:09:00,626 : INFO : Recall score for label_class 1: 0.9256
2024-08-15 17:09:00,626 : INFO : Recall score for label_class 2: 0.7970
2024-08-15 17:09:00,626 : INFO : Average F1 score: 0.8401
2024-08-15 17:09:00,626 : INFO : Determined score from best model, ending training.
2024-08-15 17:09:00,628 : INFO : Split 4 is finished, the score is: 0.8401
2024-08-15 17:09:00,628 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:00,628 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:00,628 : INFO : Starting training for split 5
2024-08-15 17:09:00,640 : INFO : Starting to tokenize the sequences.
2024-08-15 17:09:01,435 : INFO : Tokenization is finished.
2024-08-15 17:09:01,451 : INFO : Starting to tokenize the sequences.
2024-08-15 17:09:01,655 : INFO : Tokenization is finished.
2024-08-15 17:09:01,660 : INFO : Counting occurences of labels...
2024-08-15 17:09:01,661 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 330, 1615,  754]))
2024-08-15 17:09:01,661 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 84, 396, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:09:01,703 : INFO : Starting epoch 1
2024-08-15 17:09:01,754 : INFO : Current training batch loss: 1.0985 in epoch 1
2024-08-15 17:09:02,569 : INFO : Current training batch loss: 1.0227 in epoch 1
2024-08-15 17:09:03,383 : INFO : Current training batch loss: 0.7899 in epoch 1
2024-08-15 17:09:04,197 : INFO : Current training batch loss: 0.6709 in epoch 1
2024-08-15 17:09:05,012 : INFO : Current training batch loss: 0.7560 in epoch 1
2024-08-15 17:09:05,162 : INFO : Epoch finished, average loss over training batches: 0.8460
2024-08-15 17:09:05,163 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:05,163 : INFO : Training metrics:
2024-08-15 17:09:05,163 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:05,173 : INFO : Accuracy: 0.6413
2024-08-15 17:09:05,173 : INFO : Precision score for label_class 0: 0.1104
2024-08-15 17:09:05,173 : INFO : Precision score for label_class 1: 0.6943
2024-08-15 17:09:05,174 : INFO : Precision score for label_class 2: 0.5718
2024-08-15 17:09:05,174 : INFO : Recall score for label_class 0: 0.0515
2024-08-15 17:09:05,174 : INFO : Recall score for label_class 1: 0.9084
2024-08-15 17:09:05,174 : INFO : Recall score for label_class 2: 0.3276
2024-08-15 17:09:05,174 : INFO : Average F1 score: 0.4246
2024-08-15 17:09:05,638 : INFO : Average loss over validation batches: 0.6200
2024-08-15 17:09:05,638 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:05,638 : INFO : Validation metrics:
2024-08-15 17:09:05,638 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:05,641 : INFO : Accuracy: 0.7418
2024-08-15 17:09:05,641 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:09:05,641 : INFO : Precision score for label_class 1: 0.8314
2024-08-15 17:09:05,641 : INFO : Precision score for label_class 2: 0.5745
2024-08-15 17:09:05,641 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:09:05,641 : INFO : Recall score for label_class 1: 0.9217
2024-08-15 17:09:05,641 : INFO : Recall score for label_class 2: 0.6959
2024-08-15 17:09:05,641 : INFO : Average F1 score: 0.5012
2024-08-15 17:09:05,641 : INFO : Validation metric decreased (inf --> 0.619973).  Saving model ...
2024-08-15 17:09:05,739 : INFO : Starting epoch 2
2024-08-15 17:09:06,393 : INFO : Current training batch loss: 0.6086 in epoch 2
2024-08-15 17:09:07,206 : INFO : Current training batch loss: 0.4626 in epoch 2
2024-08-15 17:09:08,021 : INFO : Current training batch loss: 0.3041 in epoch 2
2024-08-15 17:09:08,836 : INFO : Current training batch loss: 0.3827 in epoch 2
2024-08-15 17:09:09,188 : INFO : Epoch finished, average loss over training batches: 0.5005
2024-08-15 17:09:09,188 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:09,188 : INFO : Training metrics:
2024-08-15 17:09:09,188 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:09,199 : INFO : Accuracy: 0.8244
2024-08-15 17:09:09,199 : INFO : Precision score for label_class 0: 0.7979
2024-08-15 17:09:09,199 : INFO : Precision score for label_class 1: 0.8667
2024-08-15 17:09:09,199 : INFO : Precision score for label_class 2: 0.7324
2024-08-15 17:09:09,199 : INFO : Recall score for label_class 0: 0.4667
2024-08-15 17:09:09,199 : INFO : Recall score for label_class 1: 0.9418
2024-08-15 17:09:09,199 : INFO : Recall score for label_class 2: 0.7294
2024-08-15 17:09:09,199 : INFO : Average F1 score: 0.7408
2024-08-15 17:09:09,664 : INFO : Average loss over validation batches: 0.4429
2024-08-15 17:09:09,664 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:09,664 : INFO : Validation metrics:
2024-08-15 17:09:09,664 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:09,668 : INFO : Accuracy: 0.8279
2024-08-15 17:09:09,668 : INFO : Precision score for label_class 0: 0.8281
2024-08-15 17:09:09,668 : INFO : Precision score for label_class 1: 0.8367
2024-08-15 17:09:09,668 : INFO : Precision score for label_class 2: 0.8037
2024-08-15 17:09:09,668 : INFO : Recall score for label_class 0: 0.6310
2024-08-15 17:09:09,668 : INFO : Recall score for label_class 1: 0.9444
2024-08-15 17:09:09,668 : INFO : Recall score for label_class 2: 0.6753
2024-08-15 17:09:09,668 : INFO : Average F1 score: 0.7791
2024-08-15 17:09:09,668 : INFO : Validation metric decreased (0.619973 --> 0.442918).  Saving model ...
2024-08-15 17:09:09,771 : INFO : Starting epoch 3
2024-08-15 17:09:10,224 : INFO : Current training batch loss: 0.2686 in epoch 3
2024-08-15 17:09:11,039 : INFO : Current training batch loss: 0.3460 in epoch 3
2024-08-15 17:09:11,853 : INFO : Current training batch loss: 0.2232 in epoch 3
2024-08-15 17:09:12,668 : INFO : Current training batch loss: 0.1891 in epoch 3
2024-08-15 17:09:13,220 : INFO : Epoch finished, average loss over training batches: 0.2781
2024-08-15 17:09:13,221 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:13,221 : INFO : Training metrics:
2024-08-15 17:09:13,221 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:13,231 : INFO : Accuracy: 0.9133
2024-08-15 17:09:13,231 : INFO : Precision score for label_class 0: 0.8468
2024-08-15 17:09:13,231 : INFO : Precision score for label_class 1: 0.9361
2024-08-15 17:09:13,231 : INFO : Precision score for label_class 2: 0.8923
2024-08-15 17:09:13,231 : INFO : Recall score for label_class 0: 0.8545
2024-08-15 17:09:13,231 : INFO : Recall score for label_class 1: 0.9517
2024-08-15 17:09:13,231 : INFO : Recall score for label_class 2: 0.8568
2024-08-15 17:09:13,231 : INFO : Average F1 score: 0.8895
2024-08-15 17:09:13,696 : INFO : Average loss over validation batches: 0.4190
2024-08-15 17:09:13,697 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:13,697 : INFO : Validation metrics:
2024-08-15 17:09:13,697 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:13,700 : INFO : Accuracy: 0.8457
2024-08-15 17:09:13,700 : INFO : Precision score for label_class 0: 0.7654
2024-08-15 17:09:13,700 : INFO : Precision score for label_class 1: 0.8738
2024-08-15 17:09:13,700 : INFO : Precision score for label_class 2: 0.8150
2024-08-15 17:09:13,700 : INFO : Recall score for label_class 0: 0.7381
2024-08-15 17:09:13,700 : INFO : Recall score for label_class 1: 0.9268
2024-08-15 17:09:13,700 : INFO : Recall score for label_class 2: 0.7268
2024-08-15 17:09:13,700 : INFO : Average F1 score: 0.8065
2024-08-15 17:09:13,700 : INFO : Validation metric decreased (0.442918 --> 0.418964).  Saving model ...
2024-08-15 17:09:13,799 : INFO : Starting epoch 4
2024-08-15 17:09:14,051 : INFO : Current training batch loss: 0.3270 in epoch 4
2024-08-15 17:09:14,865 : INFO : Current training batch loss: 0.1909 in epoch 4
2024-08-15 17:09:15,679 : INFO : Current training batch loss: 0.2386 in epoch 4
2024-08-15 17:09:16,490 : INFO : Current training batch loss: 0.0697 in epoch 4
2024-08-15 17:09:17,234 : INFO : Epoch finished, average loss over training batches: 0.1745
2024-08-15 17:09:17,234 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:17,234 : INFO : Training metrics:
2024-08-15 17:09:17,234 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:17,243 : INFO : Accuracy: 0.9507
2024-08-15 17:09:17,243 : INFO : Precision score for label_class 0: 0.8991
2024-08-15 17:09:17,244 : INFO : Precision score for label_class 1: 0.9655
2024-08-15 17:09:17,244 : INFO : Precision score for label_class 2: 0.9417
2024-08-15 17:09:17,244 : INFO : Recall score for label_class 0: 0.9182
2024-08-15 17:09:17,244 : INFO : Recall score for label_class 1: 0.9709
2024-08-15 17:09:17,244 : INFO : Recall score for label_class 2: 0.9218
2024-08-15 17:09:17,244 : INFO : Average F1 score: 0.9361
2024-08-15 17:09:17,711 : INFO : Average loss over validation batches: 0.4156
2024-08-15 17:09:17,712 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:17,712 : INFO : Validation metrics:
2024-08-15 17:09:17,712 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:17,715 : INFO : Accuracy: 0.8457
2024-08-15 17:09:17,715 : INFO : Precision score for label_class 0: 0.7234
2024-08-15 17:09:17,715 : INFO : Precision score for label_class 1: 0.9016
2024-08-15 17:09:17,715 : INFO : Precision score for label_class 2: 0.7938
2024-08-15 17:09:17,715 : INFO : Recall score for label_class 0: 0.8095
2024-08-15 17:09:17,715 : INFO : Recall score for label_class 1: 0.8788
2024-08-15 17:09:17,715 : INFO : Recall score for label_class 2: 0.7938
2024-08-15 17:09:17,715 : INFO : Average F1 score: 0.8160
2024-08-15 17:09:17,715 : INFO : Validation metric decreased (0.418964 --> 0.415628).  Saving model ...
2024-08-15 17:09:17,815 : INFO : Starting epoch 5
2024-08-15 17:09:17,876 : INFO : Current training batch loss: 0.0726 in epoch 5
2024-08-15 17:09:18,697 : INFO : Current training batch loss: 0.1444 in epoch 5
2024-08-15 17:09:19,524 : INFO : Current training batch loss: 0.0393 in epoch 5
2024-08-15 17:09:20,356 : INFO : Current training batch loss: 0.0724 in epoch 5
2024-08-15 17:09:21,203 : INFO : Current training batch loss: 0.0320 in epoch 5
2024-08-15 17:09:21,357 : INFO : Epoch finished, average loss over training batches: 0.1067
2024-08-15 17:09:21,357 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:21,357 : INFO : Training metrics:
2024-08-15 17:09:21,357 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:21,364 : INFO : Accuracy: 0.9733
2024-08-15 17:09:21,364 : INFO : Precision score for label_class 0: 0.9228
2024-08-15 17:09:21,365 : INFO : Precision score for label_class 1: 0.9839
2024-08-15 17:09:21,365 : INFO : Precision score for label_class 2: 0.9732
2024-08-15 17:09:21,365 : INFO : Recall score for label_class 0: 0.9424
2024-08-15 17:09:21,365 : INFO : Recall score for label_class 1: 0.9851
2024-08-15 17:09:21,365 : INFO : Recall score for label_class 2: 0.9615
2024-08-15 17:09:21,365 : INFO : Average F1 score: 0.9615
2024-08-15 17:09:21,829 : INFO : Average loss over validation batches: 0.4329
2024-08-15 17:09:21,829 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:21,829 : INFO : Validation metrics:
2024-08-15 17:09:21,829 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:21,833 : INFO : Accuracy: 0.8412
2024-08-15 17:09:21,833 : INFO : Precision score for label_class 0: 0.6900
2024-08-15 17:09:21,833 : INFO : Precision score for label_class 1: 0.9144
2024-08-15 17:09:21,833 : INFO : Precision score for label_class 2: 0.7800
2024-08-15 17:09:21,833 : INFO : Recall score for label_class 0: 0.8214
2024-08-15 17:09:21,833 : INFO : Recall score for label_class 1: 0.8636
2024-08-15 17:09:21,833 : INFO : Recall score for label_class 2: 0.8041
2024-08-15 17:09:21,833 : INFO : Average F1 score: 0.8101
2024-08-15 17:09:21,833 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:09:21,833 : INFO : Starting epoch 6
2024-08-15 17:09:22,483 : INFO : Current training batch loss: 0.0314 in epoch 6
2024-08-15 17:09:23,296 : INFO : Current training batch loss: 0.1008 in epoch 6
2024-08-15 17:09:24,107 : INFO : Current training batch loss: 0.0375 in epoch 6
2024-08-15 17:09:24,920 : INFO : Current training batch loss: 0.1117 in epoch 6
2024-08-15 17:09:25,272 : INFO : Epoch finished, average loss over training batches: 0.0738
2024-08-15 17:09:25,272 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:25,272 : INFO : Training metrics:
2024-08-15 17:09:25,272 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:25,281 : INFO : Accuracy: 0.9848
2024-08-15 17:09:25,281 : INFO : Precision score for label_class 0: 0.9415
2024-08-15 17:09:25,281 : INFO : Precision score for label_class 1: 0.9944
2024-08-15 17:09:25,281 : INFO : Precision score for label_class 2: 0.9840
2024-08-15 17:09:25,281 : INFO : Recall score for label_class 0: 0.9758
2024-08-15 17:09:25,281 : INFO : Recall score for label_class 1: 0.9907
2024-08-15 17:09:25,281 : INFO : Recall score for label_class 2: 0.9761
2024-08-15 17:09:25,281 : INFO : Average F1 score: 0.9770
2024-08-15 17:09:25,746 : INFO : Average loss over validation batches: 0.4213
2024-08-15 17:09:25,746 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:25,746 : INFO : Validation metrics:
2024-08-15 17:09:25,746 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:25,750 : INFO : Accuracy: 0.8605
2024-08-15 17:09:25,750 : INFO : Precision score for label_class 0: 0.7931
2024-08-15 17:09:25,750 : INFO : Precision score for label_class 1: 0.9015
2024-08-15 17:09:25,750 : INFO : Precision score for label_class 2: 0.8063
2024-08-15 17:09:25,750 : INFO : Recall score for label_class 0: 0.8214
2024-08-15 17:09:25,750 : INFO : Recall score for label_class 1: 0.9015
2024-08-15 17:09:25,750 : INFO : Recall score for label_class 2: 0.7938
2024-08-15 17:09:25,750 : INFO : Average F1 score: 0.8362
2024-08-15 17:09:25,750 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:09:25,750 : INFO : Starting epoch 7
2024-08-15 17:09:26,200 : INFO : Current training batch loss: 0.0221 in epoch 7
2024-08-15 17:09:27,015 : INFO : Current training batch loss: 0.0292 in epoch 7
2024-08-15 17:09:27,826 : INFO : Current training batch loss: 0.0268 in epoch 7
2024-08-15 17:09:28,639 : INFO : Current training batch loss: 0.0194 in epoch 7
2024-08-15 17:09:29,192 : INFO : Epoch finished, average loss over training batches: 0.0563
2024-08-15 17:09:29,192 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:29,192 : INFO : Training metrics:
2024-08-15 17:09:29,192 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:29,199 : INFO : Accuracy: 0.9900
2024-08-15 17:09:29,199 : INFO : Precision score for label_class 0: 0.9560
2024-08-15 17:09:29,199 : INFO : Precision score for label_class 1: 0.9969
2024-08-15 17:09:29,199 : INFO : Precision score for label_class 2: 0.9906
2024-08-15 17:09:29,199 : INFO : Recall score for label_class 0: 0.9879
2024-08-15 17:09:29,199 : INFO : Recall score for label_class 1: 0.9938
2024-08-15 17:09:29,199 : INFO : Recall score for label_class 2: 0.9828
2024-08-15 17:09:29,199 : INFO : Average F1 score: 0.9846
2024-08-15 17:09:29,663 : INFO : Average loss over validation batches: 0.4312
2024-08-15 17:09:29,663 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:29,663 : INFO : Validation metrics:
2024-08-15 17:09:29,663 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:29,667 : INFO : Accuracy: 0.8635
2024-08-15 17:09:29,667 : INFO : Precision score for label_class 0: 0.8228
2024-08-15 17:09:29,667 : INFO : Precision score for label_class 1: 0.8933
2024-08-15 17:09:29,667 : INFO : Precision score for label_class 2: 0.8177
2024-08-15 17:09:29,667 : INFO : Recall score for label_class 0: 0.7738
2024-08-15 17:09:29,667 : INFO : Recall score for label_class 1: 0.9091
2024-08-15 17:09:29,667 : INFO : Recall score for label_class 2: 0.8093
2024-08-15 17:09:29,667 : INFO : Average F1 score: 0.8374
2024-08-15 17:09:29,667 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:09:29,667 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:09:29,701 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:09:30,198 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:30,198 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:09:30,198 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:30,201 : INFO : Accuracy: 0.8457
2024-08-15 17:09:30,201 : INFO : Precision score for label_class 0: 0.7234
2024-08-15 17:09:30,201 : INFO : Precision score for label_class 1: 0.9016
2024-08-15 17:09:30,201 : INFO : Precision score for label_class 2: 0.7938
2024-08-15 17:09:30,201 : INFO : Recall score for label_class 0: 0.8095
2024-08-15 17:09:30,201 : INFO : Recall score for label_class 1: 0.8788
2024-08-15 17:09:30,201 : INFO : Recall score for label_class 2: 0.7938
2024-08-15 17:09:30,201 : INFO : Average F1 score: 0.8160
2024-08-15 17:09:30,201 : INFO : Determined score from best model, ending training.
2024-08-15 17:09:30,202 : INFO : Split 5 is finished, the score is: 0.8160
2024-08-15 17:09:30,203 : INFO : ----------------------------------------------------------------------------------------------------
[I 2024-08-15 17:09:30,212] Trial 0 finished with value: 0.8443234265622902 and parameters: {}. Best is trial 0 with value: 0.8443234265622902.
2024-08-15 17:09:30,213 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:30,213 : INFO : Starting training for split 1
2024-08-15 17:09:30,226 : INFO : Starting to tokenize the sequences.
2024-08-15 17:09:30,231 : INFO : Tokenization is finished.
2024-08-15 17:09:30,243 : INFO : Starting to tokenize the sequences.
2024-08-15 17:09:30,249 : INFO : Tokenization is finished.
2024-08-15 17:09:30,249 : INFO : Counting occurences of labels...
2024-08-15 17:09:30,250 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1596,  774]))
2024-08-15 17:09:30,250 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 415, 174]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:09:30,289 : INFO : Starting epoch 1
2024-08-15 17:09:30,341 : INFO : Current training batch loss: 1.0832 in epoch 1
2024-08-15 17:09:31,155 : INFO : Current training batch loss: 0.8145 in epoch 1
2024-08-15 17:09:31,965 : INFO : Current training batch loss: 0.7586 in epoch 1
2024-08-15 17:09:32,775 : INFO : Current training batch loss: 0.6669 in epoch 1
2024-08-15 17:09:33,586 : INFO : Current training batch loss: 0.5789 in epoch 1
2024-08-15 17:09:33,728 : INFO : Epoch finished, average loss over training batches: 0.7633
2024-08-15 17:09:33,729 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:33,729 : INFO : Training metrics:
2024-08-15 17:09:33,729 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:33,739 : INFO : Accuracy: 0.7024
2024-08-15 17:09:33,739 : INFO : Precision score for label_class 0: 0.6667
2024-08-15 17:09:33,739 : INFO : Precision score for label_class 1: 0.7313
2024-08-15 17:09:33,739 : INFO : Precision score for label_class 2: 0.5979
2024-08-15 17:09:33,739 : INFO : Recall score for label_class 0: 0.0549
2024-08-15 17:09:33,739 : INFO : Recall score for label_class 1: 0.9618
2024-08-15 17:09:33,739 : INFO : Recall score for label_class 2: 0.4419
2024-08-15 17:09:33,739 : INFO : Average F1 score: 0.4801
2024-08-15 17:09:34,205 : INFO : Average loss over validation batches: 0.5772
2024-08-15 17:09:34,205 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:34,205 : INFO : Validation metrics:
2024-08-15 17:09:34,205 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:34,207 : INFO : Accuracy: 0.7526
2024-08-15 17:09:34,207 : INFO : Precision score for label_class 0: 1.0000
2024-08-15 17:09:34,207 : INFO : Precision score for label_class 1: 0.8922
2024-08-15 17:09:34,207 : INFO : Precision score for label_class 2: 0.5376
2024-08-15 17:09:34,207 : INFO : Recall score for label_class 0: 0.0116
2024-08-15 17:09:34,208 : INFO : Recall score for label_class 1: 0.8771
2024-08-15 17:09:34,208 : INFO : Recall score for label_class 2: 0.8218
2024-08-15 17:09:34,208 : INFO : Average F1 score: 0.5192
2024-08-15 17:09:34,208 : INFO : Validation metric decreased (inf --> 0.577165).  Saving model ...
2024-08-15 17:09:34,302 : INFO : Starting epoch 2
2024-08-15 17:09:34,953 : INFO : Current training batch loss: 0.2368 in epoch 2
2024-08-15 17:09:35,764 : INFO : Current training batch loss: 0.4818 in epoch 2
2024-08-15 17:09:36,575 : INFO : Current training batch loss: 0.3398 in epoch 2
2024-08-15 17:09:37,388 : INFO : Current training batch loss: 0.3562 in epoch 2
2024-08-15 17:09:37,738 : INFO : Epoch finished, average loss over training batches: 0.4130
2024-08-15 17:09:37,738 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:37,738 : INFO : Training metrics:
2024-08-15 17:09:37,738 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:37,744 : INFO : Accuracy: 0.8647
2024-08-15 17:09:37,744 : INFO : Precision score for label_class 0: 0.7837
2024-08-15 17:09:37,744 : INFO : Precision score for label_class 1: 0.8985
2024-08-15 17:09:37,744 : INFO : Precision score for label_class 2: 0.8202
2024-08-15 17:09:37,744 : INFO : Recall score for label_class 0: 0.6738
2024-08-15 17:09:37,744 : INFO : Recall score for label_class 1: 0.9373
2024-08-15 17:09:37,744 : INFO : Recall score for label_class 2: 0.7959
2024-08-15 17:09:37,744 : INFO : Average F1 score: 0.8167
2024-08-15 17:09:38,210 : INFO : Average loss over validation batches: 0.3677
2024-08-15 17:09:38,210 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:38,210 : INFO : Validation metrics:
2024-08-15 17:09:38,210 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:38,214 : INFO : Accuracy: 0.8696
2024-08-15 17:09:38,214 : INFO : Precision score for label_class 0: 0.7849
2024-08-15 17:09:38,214 : INFO : Precision score for label_class 1: 0.8953
2024-08-15 17:09:38,214 : INFO : Precision score for label_class 2: 0.8487
2024-08-15 17:09:38,214 : INFO : Recall score for label_class 0: 0.8488
2024-08-15 17:09:38,214 : INFO : Recall score for label_class 1: 0.9277
2024-08-15 17:09:38,214 : INFO : Recall score for label_class 2: 0.7414
2024-08-15 17:09:38,214 : INFO : Average F1 score: 0.8394
2024-08-15 17:09:38,214 : INFO : Validation metric decreased (0.577165 --> 0.367669).  Saving model ...
2024-08-15 17:09:38,312 : INFO : Starting epoch 3
2024-08-15 17:09:38,767 : INFO : Current training batch loss: 0.3085 in epoch 3
2024-08-15 17:09:39,582 : INFO : Current training batch loss: 0.3195 in epoch 3
2024-08-15 17:09:40,483 : INFO : Current training batch loss: 0.2761 in epoch 3
2024-08-15 17:09:41,302 : INFO : Current training batch loss: 0.1504 in epoch 3
2024-08-15 17:09:41,871 : INFO : Epoch finished, average loss over training batches: 0.2520
2024-08-15 17:09:41,871 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:41,871 : INFO : Training metrics:
2024-08-15 17:09:41,871 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:41,877 : INFO : Accuracy: 0.9236
2024-08-15 17:09:41,877 : INFO : Precision score for label_class 0: 0.8382
2024-08-15 17:09:41,877 : INFO : Precision score for label_class 1: 0.9465
2024-08-15 17:09:41,877 : INFO : Precision score for label_class 2: 0.9140
2024-08-15 17:09:41,877 : INFO : Recall score for label_class 0: 0.8841
2024-08-15 17:09:41,877 : INFO : Recall score for label_class 1: 0.9536
2024-08-15 17:09:41,877 : INFO : Recall score for label_class 2: 0.8786
2024-08-15 17:09:41,877 : INFO : Average F1 score: 0.9022
2024-08-15 17:09:42,344 : INFO : Average loss over validation batches: 0.3571
2024-08-15 17:09:42,344 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:42,344 : INFO : Validation metrics:
2024-08-15 17:09:42,344 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:42,347 : INFO : Accuracy: 0.8681
2024-08-15 17:09:42,347 : INFO : Precision score for label_class 0: 0.7745
2024-08-15 17:09:42,347 : INFO : Precision score for label_class 1: 0.9515
2024-08-15 17:09:42,347 : INFO : Precision score for label_class 2: 0.7624
2024-08-15 17:09:42,347 : INFO : Recall score for label_class 0: 0.9186
2024-08-15 17:09:42,347 : INFO : Recall score for label_class 1: 0.8506
2024-08-15 17:09:42,347 : INFO : Recall score for label_class 2: 0.8851
2024-08-15 17:09:42,347 : INFO : Average F1 score: 0.8526
2024-08-15 17:09:42,347 : INFO : Validation metric decreased (0.367669 --> 0.357061).  Saving model ...
2024-08-15 17:09:42,444 : INFO : Starting epoch 4
2024-08-15 17:09:42,703 : INFO : Current training batch loss: 0.4363 in epoch 4
2024-08-15 17:09:43,562 : INFO : Current training batch loss: 0.0909 in epoch 4
2024-08-15 17:09:44,438 : INFO : Current training batch loss: 0.2652 in epoch 4
2024-08-15 17:09:45,267 : INFO : Current training batch loss: 0.1480 in epoch 4
2024-08-15 17:09:46,069 : INFO : Epoch finished, average loss over training batches: 0.1734
2024-08-15 17:09:46,069 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:46,069 : INFO : Training metrics:
2024-08-15 17:09:46,069 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:46,077 : INFO : Accuracy: 0.9589
2024-08-15 17:09:46,077 : INFO : Precision score for label_class 0: 0.8921
2024-08-15 17:09:46,077 : INFO : Precision score for label_class 1: 0.9732
2024-08-15 17:09:46,077 : INFO : Precision score for label_class 2: 0.9587
2024-08-15 17:09:46,077 : INFO : Recall score for label_class 0: 0.9329
2024-08-15 17:09:46,077 : INFO : Recall score for label_class 1: 0.9781
2024-08-15 17:09:46,077 : INFO : Recall score for label_class 2: 0.9302
2024-08-15 17:09:46,077 : INFO : Average F1 score: 0.9440
2024-08-15 17:09:46,543 : INFO : Average loss over validation batches: 0.3266
2024-08-15 17:09:46,543 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:46,543 : INFO : Validation metrics:
2024-08-15 17:09:46,543 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:46,546 : INFO : Accuracy: 0.8904
2024-08-15 17:09:46,546 : INFO : Precision score for label_class 0: 0.8021
2024-08-15 17:09:46,546 : INFO : Precision score for label_class 1: 0.9091
2024-08-15 17:09:46,546 : INFO : Precision score for label_class 2: 0.8933
2024-08-15 17:09:46,546 : INFO : Recall score for label_class 0: 0.8953
2024-08-15 17:09:46,546 : INFO : Recall score for label_class 1: 0.9398
2024-08-15 17:09:46,546 : INFO : Recall score for label_class 2: 0.7701
2024-08-15 17:09:46,546 : INFO : Average F1 score: 0.8658
2024-08-15 17:09:46,546 : INFO : Validation metric decreased (0.357061 --> 0.326589).  Saving model ...
2024-08-15 17:09:46,647 : INFO : Split 1 is finished, the score is: 0.8658
2024-08-15 17:09:46,647 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:46,647 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:46,647 : INFO : Starting training for split 2
2024-08-15 17:09:46,663 : INFO : Starting to tokenize the sequences.
2024-08-15 17:09:46,669 : INFO : Tokenization is finished.
2024-08-15 17:09:46,687 : INFO : Starting to tokenize the sequences.
2024-08-15 17:09:46,692 : INFO : Tokenization is finished.
2024-08-15 17:09:46,697 : INFO : Counting occurences of labels...
2024-08-15 17:09:46,698 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 343, 1601,  754]))
2024-08-15 17:09:46,698 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 71, 410, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:09:46,744 : INFO : Starting epoch 1
2024-08-15 17:09:46,795 : INFO : Current training batch loss: 1.0992 in epoch 1
2024-08-15 17:09:47,645 : INFO : Current training batch loss: 0.9882 in epoch 1
2024-08-15 17:09:48,477 : INFO : Current training batch loss: 0.8666 in epoch 1
2024-08-15 17:09:49,314 : INFO : Current training batch loss: 0.7155 in epoch 1
2024-08-15 17:09:50,146 : INFO : Current training batch loss: 0.7498 in epoch 1
2024-08-15 17:09:50,297 : INFO : Epoch finished, average loss over training batches: 0.8282
2024-08-15 17:09:50,297 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:50,297 : INFO : Training metrics:
2024-08-15 17:09:50,297 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:50,308 : INFO : Accuracy: 0.6542
2024-08-15 17:09:50,308 : INFO : Precision score for label_class 0: 0.0625
2024-08-15 17:09:50,308 : INFO : Precision score for label_class 1: 0.6854
2024-08-15 17:09:50,308 : INFO : Precision score for label_class 2: 0.5285
2024-08-15 17:09:50,308 : INFO : Recall score for label_class 0: 0.0029
2024-08-15 17:09:50,308 : INFO : Recall score for label_class 1: 0.9457
2024-08-15 17:09:50,308 : INFO : Recall score for label_class 2: 0.3316
2024-08-15 17:09:50,308 : INFO : Average F1 score: 0.4026
2024-08-15 17:09:50,776 : INFO : Average loss over validation batches: 0.6051
2024-08-15 17:09:50,776 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:50,776 : INFO : Validation metrics:
2024-08-15 17:09:50,776 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:50,780 : INFO : Accuracy: 0.7659
2024-08-15 17:09:50,780 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:09:50,780 : INFO : Precision score for label_class 1: 0.8214
2024-08-15 17:09:50,780 : INFO : Precision score for label_class 2: 0.6332
2024-08-15 17:09:50,780 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:09:50,780 : INFO : Recall score for label_class 1: 0.9537
2024-08-15 17:09:50,780 : INFO : Recall score for label_class 2: 0.6495
2024-08-15 17:09:50,780 : INFO : Average F1 score: 0.5079
2024-08-15 17:09:50,780 : INFO : Validation metric decreased (inf --> 0.605068).  Saving model ...
2024-08-15 17:09:50,876 : INFO : Starting epoch 2
2024-08-15 17:09:51,529 : INFO : Current training batch loss: 0.5658 in epoch 2
2024-08-15 17:09:52,344 : INFO : Current training batch loss: 0.5576 in epoch 2
2024-08-15 17:09:53,159 : INFO : Current training batch loss: 0.3943 in epoch 2
2024-08-15 17:09:53,973 : INFO : Current training batch loss: 0.3323 in epoch 2
2024-08-15 17:09:54,325 : INFO : Epoch finished, average loss over training batches: 0.4744
2024-08-15 17:09:54,325 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:54,325 : INFO : Training metrics:
2024-08-15 17:09:54,325 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:54,333 : INFO : Accuracy: 0.8414
2024-08-15 17:09:54,333 : INFO : Precision score for label_class 0: 0.7340
2024-08-15 17:09:54,333 : INFO : Precision score for label_class 1: 0.8796
2024-08-15 17:09:54,333 : INFO : Precision score for label_class 2: 0.7953
2024-08-15 17:09:54,333 : INFO : Recall score for label_class 0: 0.6676
2024-08-15 17:09:54,333 : INFO : Recall score for label_class 1: 0.9350
2024-08-15 17:09:54,333 : INFO : Recall score for label_class 2: 0.7215
2024-08-15 17:09:54,333 : INFO : Average F1 score: 0.7874
2024-08-15 17:09:54,800 : INFO : Average loss over validation batches: 0.3901
2024-08-15 17:09:54,800 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:54,800 : INFO : Validation metrics:
2024-08-15 17:09:54,800 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:54,804 : INFO : Accuracy: 0.8667
2024-08-15 17:09:54,804 : INFO : Precision score for label_class 0: 0.7746
2024-08-15 17:09:54,804 : INFO : Precision score for label_class 1: 0.8799
2024-08-15 17:09:54,804 : INFO : Precision score for label_class 2: 0.8713
2024-08-15 17:09:54,804 : INFO : Recall score for label_class 0: 0.7746
2024-08-15 17:09:54,804 : INFO : Recall score for label_class 1: 0.9293
2024-08-15 17:09:54,804 : INFO : Recall score for label_class 2: 0.7680
2024-08-15 17:09:54,804 : INFO : Average F1 score: 0.8317
2024-08-15 17:09:54,804 : INFO : Validation metric decreased (0.605068 --> 0.390059).  Saving model ...
2024-08-15 17:09:54,903 : INFO : Starting epoch 3
2024-08-15 17:09:55,356 : INFO : Current training batch loss: 0.2603 in epoch 3
2024-08-15 17:09:56,171 : INFO : Current training batch loss: 0.2726 in epoch 3
2024-08-15 17:09:56,989 : INFO : Current training batch loss: 0.3211 in epoch 3
2024-08-15 17:09:57,808 : INFO : Current training batch loss: 0.1047 in epoch 3
2024-08-15 17:09:58,366 : INFO : Epoch finished, average loss over training batches: 0.2628
2024-08-15 17:09:58,367 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:58,367 : INFO : Training metrics:
2024-08-15 17:09:58,367 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:58,377 : INFO : Accuracy: 0.9233
2024-08-15 17:09:58,377 : INFO : Precision score for label_class 0: 0.8490
2024-08-15 17:09:58,377 : INFO : Precision score for label_class 1: 0.9440
2024-08-15 17:09:58,377 : INFO : Precision score for label_class 2: 0.9127
2024-08-15 17:09:58,377 : INFO : Recall score for label_class 0: 0.8688
2024-08-15 17:09:58,377 : INFO : Recall score for label_class 1: 0.9582
2024-08-15 17:09:58,377 : INFO : Recall score for label_class 2: 0.8740
2024-08-15 17:09:58,377 : INFO : Average F1 score: 0.9009
2024-08-15 17:09:58,847 : INFO : Average loss over validation batches: 0.3623
2024-08-15 17:09:58,847 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:58,847 : INFO : Validation metrics:
2024-08-15 17:09:58,847 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:09:58,851 : INFO : Accuracy: 0.8696
2024-08-15 17:09:58,851 : INFO : Precision score for label_class 0: 0.7867
2024-08-15 17:09:58,851 : INFO : Precision score for label_class 1: 0.9024
2024-08-15 17:09:58,851 : INFO : Precision score for label_class 2: 0.8316
2024-08-15 17:09:58,851 : INFO : Recall score for label_class 0: 0.8310
2024-08-15 17:09:58,851 : INFO : Recall score for label_class 1: 0.9024
2024-08-15 17:09:58,851 : INFO : Recall score for label_class 2: 0.8144
2024-08-15 17:09:58,851 : INFO : Average F1 score: 0.8445
2024-08-15 17:09:58,851 : INFO : Validation metric decreased (0.390059 --> 0.362341).  Saving model ...
2024-08-15 17:09:58,948 : INFO : Starting epoch 4
2024-08-15 17:09:59,201 : INFO : Current training batch loss: 0.3147 in epoch 4
2024-08-15 17:10:00,019 : INFO : Current training batch loss: 0.1731 in epoch 4
2024-08-15 17:10:00,837 : INFO : Current training batch loss: 0.3225 in epoch 4
2024-08-15 17:10:01,656 : INFO : Current training batch loss: 0.1686 in epoch 4
2024-08-15 17:10:02,414 : INFO : Epoch finished, average loss over training batches: 0.1779
2024-08-15 17:10:02,415 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:02,415 : INFO : Training metrics:
2024-08-15 17:10:02,415 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:02,422 : INFO : Accuracy: 0.9581
2024-08-15 17:10:02,422 : INFO : Precision score for label_class 0: 0.8923
2024-08-15 17:10:02,422 : INFO : Precision score for label_class 1: 0.9738
2024-08-15 17:10:02,422 : INFO : Precision score for label_class 2: 0.9562
2024-08-15 17:10:02,422 : INFO : Recall score for label_class 0: 0.9417
2024-08-15 17:10:02,422 : INFO : Recall score for label_class 1: 0.9769
2024-08-15 17:10:02,422 : INFO : Recall score for label_class 2: 0.9257
2024-08-15 17:10:02,422 : INFO : Average F1 score: 0.9441
2024-08-15 17:10:02,888 : INFO : Average loss over validation batches: 0.3677
2024-08-15 17:10:02,889 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:02,889 : INFO : Validation metrics:
2024-08-15 17:10:02,889 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:02,892 : INFO : Accuracy: 0.8681
2024-08-15 17:10:02,892 : INFO : Precision score for label_class 0: 0.8028
2024-08-15 17:10:02,892 : INFO : Precision score for label_class 1: 0.8796
2024-08-15 17:10:02,892 : INFO : Precision score for label_class 2: 0.8663
2024-08-15 17:10:02,892 : INFO : Recall score for label_class 0: 0.8028
2024-08-15 17:10:02,892 : INFO : Recall score for label_class 1: 0.9268
2024-08-15 17:10:02,892 : INFO : Recall score for label_class 2: 0.7680
2024-08-15 17:10:02,892 : INFO : Average F1 score: 0.8399
2024-08-15 17:10:02,892 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:10:02,892 : INFO : Last epoch reached, validation loss was better before, loading best model during training.
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:10:02,926 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:10:03,434 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:03,434 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:10:03,434 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:03,438 : INFO : Accuracy: 0.8696
2024-08-15 17:10:03,438 : INFO : Precision score for label_class 0: 0.7867
2024-08-15 17:10:03,438 : INFO : Precision score for label_class 1: 0.9024
2024-08-15 17:10:03,438 : INFO : Precision score for label_class 2: 0.8316
2024-08-15 17:10:03,438 : INFO : Recall score for label_class 0: 0.8310
2024-08-15 17:10:03,438 : INFO : Recall score for label_class 1: 0.9024
2024-08-15 17:10:03,438 : INFO : Recall score for label_class 2: 0.8144
2024-08-15 17:10:03,438 : INFO : Average F1 score: 0.8445
2024-08-15 17:10:03,438 : INFO : Determined score from best model, ending training.
2024-08-15 17:10:03,439 : INFO : Split 2 is finished, the score is: 0.8445
2024-08-15 17:10:03,439 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:03,439 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:03,439 : INFO : Starting training for split 3
2024-08-15 17:10:03,453 : INFO : Starting to tokenize the sequences.
2024-08-15 17:10:03,459 : INFO : Tokenization is finished.
2024-08-15 17:10:03,476 : INFO : Starting to tokenize the sequences.
2024-08-15 17:10:03,481 : INFO : Tokenization is finished.
2024-08-15 17:10:03,486 : INFO : Counting occurences of labels...
2024-08-15 17:10:03,487 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1611,  759]))
2024-08-15 17:10:03,487 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 400, 189]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:10:03,533 : INFO : Starting epoch 1
2024-08-15 17:10:03,585 : INFO : Current training batch loss: 1.1217 in epoch 1
2024-08-15 17:10:04,403 : INFO : Current training batch loss: 0.9894 in epoch 1
2024-08-15 17:10:05,222 : INFO : Current training batch loss: 0.7691 in epoch 1
2024-08-15 17:10:06,041 : INFO : Current training batch loss: 0.7002 in epoch 1
2024-08-15 17:10:06,860 : INFO : Current training batch loss: 0.6550 in epoch 1
2024-08-15 17:10:07,013 : INFO : Epoch finished, average loss over training batches: 0.8105
2024-08-15 17:10:07,013 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:07,013 : INFO : Training metrics:
2024-08-15 17:10:07,013 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:07,020 : INFO : Accuracy: 0.6546
2024-08-15 17:10:07,020 : INFO : Precision score for label_class 0: 0.2222
2024-08-15 17:10:07,020 : INFO : Precision score for label_class 1: 0.7071
2024-08-15 17:10:07,020 : INFO : Precision score for label_class 2: 0.5534
2024-08-15 17:10:07,020 : INFO : Recall score for label_class 0: 0.0976
2024-08-15 17:10:07,020 : INFO : Recall score for label_class 1: 0.9156
2024-08-15 17:10:07,020 : INFO : Recall score for label_class 2: 0.3412
2024-08-15 17:10:07,020 : INFO : Average F1 score: 0.4519
2024-08-15 17:10:07,488 : INFO : Average loss over validation batches: 0.5900
2024-08-15 17:10:07,488 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:07,488 : INFO : Validation metrics:
2024-08-15 17:10:07,488 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:07,491 : INFO : Accuracy: 0.7570
2024-08-15 17:10:07,491 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:10:07,491 : INFO : Precision score for label_class 1: 0.8741
2024-08-15 17:10:07,491 : INFO : Precision score for label_class 2: 0.5725
2024-08-15 17:10:07,491 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:10:07,491 : INFO : Recall score for label_class 1: 0.9025
2024-08-15 17:10:07,491 : INFO : Recall score for label_class 2: 0.7937
2024-08-15 17:10:07,491 : INFO : Average F1 score: 0.5178
2024-08-15 17:10:07,491 : INFO : Validation metric decreased (inf --> 0.590008).  Saving model ...
2024-08-15 17:10:07,598 : INFO : Starting epoch 2
2024-08-15 17:10:08,255 : INFO : Current training batch loss: 0.5433 in epoch 2
2024-08-15 17:10:09,073 : INFO : Current training batch loss: 0.4059 in epoch 2
2024-08-15 17:10:09,891 : INFO : Current training batch loss: 0.3598 in epoch 2
2024-08-15 17:10:10,710 : INFO : Current training batch loss: 0.3243 in epoch 2
2024-08-15 17:10:11,065 : INFO : Epoch finished, average loss over training batches: 0.4430
2024-08-15 17:10:11,065 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:11,065 : INFO : Training metrics:
2024-08-15 17:10:11,065 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:11,070 : INFO : Accuracy: 0.8577
2024-08-15 17:10:11,070 : INFO : Precision score for label_class 0: 0.7549
2024-08-15 17:10:11,070 : INFO : Precision score for label_class 1: 0.8888
2024-08-15 17:10:11,070 : INFO : Precision score for label_class 2: 0.8276
2024-08-15 17:10:11,070 : INFO : Recall score for label_class 0: 0.7043
2024-08-15 17:10:11,070 : INFO : Recall score for label_class 1: 0.9323
2024-08-15 17:10:11,070 : INFO : Recall score for label_class 2: 0.7655
2024-08-15 17:10:11,070 : INFO : Average F1 score: 0.8114
2024-08-15 17:10:11,536 : INFO : Average loss over validation batches: 0.3791
2024-08-15 17:10:11,536 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:11,536 : INFO : Validation metrics:
2024-08-15 17:10:11,536 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:11,539 : INFO : Accuracy: 0.8667
2024-08-15 17:10:11,539 : INFO : Precision score for label_class 0: 0.7931
2024-08-15 17:10:11,539 : INFO : Precision score for label_class 1: 0.8986
2024-08-15 17:10:11,539 : INFO : Precision score for label_class 2: 0.8276
2024-08-15 17:10:11,539 : INFO : Recall score for label_class 0: 0.8023
2024-08-15 17:10:11,539 : INFO : Recall score for label_class 1: 0.9300
2024-08-15 17:10:11,539 : INFO : Recall score for label_class 2: 0.7619
2024-08-15 17:10:11,539 : INFO : Average F1 score: 0.8350
2024-08-15 17:10:11,539 : INFO : Validation metric decreased (0.590008 --> 0.379062).  Saving model ...
2024-08-15 17:10:11,637 : INFO : Starting epoch 3
2024-08-15 17:10:12,092 : INFO : Current training batch loss: 0.2243 in epoch 3
2024-08-15 17:10:12,911 : INFO : Current training batch loss: 0.3322 in epoch 3
2024-08-15 17:10:13,729 : INFO : Current training batch loss: 0.2697 in epoch 3
2024-08-15 17:10:14,549 : INFO : Current training batch loss: 0.1023 in epoch 3
2024-08-15 17:10:15,105 : INFO : Epoch finished, average loss over training batches: 0.2588
2024-08-15 17:10:15,105 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:15,105 : INFO : Training metrics:
2024-08-15 17:10:15,105 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:15,110 : INFO : Accuracy: 0.9251
2024-08-15 17:10:15,110 : INFO : Precision score for label_class 0: 0.8400
2024-08-15 17:10:15,110 : INFO : Precision score for label_class 1: 0.9486
2024-08-15 17:10:15,110 : INFO : Precision score for label_class 2: 0.9142
2024-08-15 17:10:15,110 : INFO : Recall score for label_class 0: 0.8963
2024-08-15 17:10:15,110 : INFO : Recall score for label_class 1: 0.9503
2024-08-15 17:10:15,110 : INFO : Recall score for label_class 2: 0.8841
2024-08-15 17:10:15,110 : INFO : Average F1 score: 0.9052
2024-08-15 17:10:15,575 : INFO : Average loss over validation batches: 0.3650
2024-08-15 17:10:15,575 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:15,575 : INFO : Validation metrics:
2024-08-15 17:10:15,575 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:15,578 : INFO : Accuracy: 0.8667
2024-08-15 17:10:15,578 : INFO : Precision score for label_class 0: 0.7700
2024-08-15 17:10:15,578 : INFO : Precision score for label_class 1: 0.9342
2024-08-15 17:10:15,578 : INFO : Precision score for label_class 2: 0.7846
2024-08-15 17:10:15,578 : INFO : Recall score for label_class 0: 0.8953
2024-08-15 17:10:15,578 : INFO : Recall score for label_class 1: 0.8875
2024-08-15 17:10:15,578 : INFO : Recall score for label_class 2: 0.8095
2024-08-15 17:10:15,578 : INFO : Average F1 score: 0.8450
2024-08-15 17:10:15,578 : INFO : Validation metric decreased (0.379062 --> 0.364979).  Saving model ...
2024-08-15 17:10:15,677 : INFO : Starting epoch 4
2024-08-15 17:10:15,930 : INFO : Current training batch loss: 0.3187 in epoch 4
2024-08-15 17:10:16,748 : INFO : Current training batch loss: 0.3038 in epoch 4
2024-08-15 17:10:17,567 : INFO : Current training batch loss: 0.2482 in epoch 4
2024-08-15 17:10:18,385 : INFO : Current training batch loss: 0.1724 in epoch 4
2024-08-15 17:10:19,145 : INFO : Epoch finished, average loss over training batches: 0.1809
2024-08-15 17:10:19,145 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:19,145 : INFO : Training metrics:
2024-08-15 17:10:19,145 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:19,149 : INFO : Accuracy: 0.9548
2024-08-15 17:10:19,149 : INFO : Precision score for label_class 0: 0.8746
2024-08-15 17:10:19,149 : INFO : Precision score for label_class 1: 0.9720
2024-08-15 17:10:19,149 : INFO : Precision score for label_class 2: 0.9553
2024-08-15 17:10:19,149 : INFO : Recall score for label_class 0: 0.9360
2024-08-15 17:10:19,149 : INFO : Recall score for label_class 1: 0.9708
2024-08-15 17:10:19,149 : INFO : Recall score for label_class 2: 0.9289
2024-08-15 17:10:19,149 : INFO : Average F1 score: 0.9392
2024-08-15 17:10:19,615 : INFO : Average loss over validation batches: 0.3356
2024-08-15 17:10:19,615 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:19,615 : INFO : Validation metrics:
2024-08-15 17:10:19,615 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:19,618 : INFO : Accuracy: 0.8904
2024-08-15 17:10:19,618 : INFO : Precision score for label_class 0: 0.8352
2024-08-15 17:10:19,618 : INFO : Precision score for label_class 1: 0.9108
2024-08-15 17:10:19,618 : INFO : Precision score for label_class 2: 0.8698
2024-08-15 17:10:19,618 : INFO : Recall score for label_class 0: 0.8837
2024-08-15 17:10:19,618 : INFO : Recall score for label_class 1: 0.9450
2024-08-15 17:10:19,618 : INFO : Recall score for label_class 2: 0.7778
2024-08-15 17:10:19,618 : INFO : Average F1 score: 0.8692
2024-08-15 17:10:19,618 : INFO : Validation metric decreased (0.364979 --> 0.335597).  Saving model ...
2024-08-15 17:10:19,716 : INFO : Split 3 is finished, the score is: 0.8692
2024-08-15 17:10:19,716 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:19,716 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:19,717 : INFO : Starting training for split 4
2024-08-15 17:10:19,731 : INFO : Starting to tokenize the sequences.
2024-08-15 17:10:19,737 : INFO : Tokenization is finished.
2024-08-15 17:10:19,753 : INFO : Starting to tokenize the sequences.
2024-08-15 17:10:19,758 : INFO : Tokenization is finished.
2024-08-15 17:10:19,763 : INFO : Counting occurences of labels...
2024-08-15 17:10:19,764 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 327, 1621,  751]))
2024-08-15 17:10:19,764 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 87, 390, 197]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:10:19,809 : INFO : Starting epoch 1
2024-08-15 17:10:19,860 : INFO : Current training batch loss: 1.1248 in epoch 1
2024-08-15 17:10:20,681 : INFO : Current training batch loss: 0.9897 in epoch 1
2024-08-15 17:10:21,498 : INFO : Current training batch loss: 0.7880 in epoch 1
2024-08-15 17:10:22,316 : INFO : Current training batch loss: 0.6388 in epoch 1
2024-08-15 17:10:23,134 : INFO : Current training batch loss: 0.6678 in epoch 1
2024-08-15 17:10:23,287 : INFO : Epoch finished, average loss over training batches: 0.8162
2024-08-15 17:10:23,287 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:23,287 : INFO : Training metrics:
2024-08-15 17:10:23,287 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:23,295 : INFO : Accuracy: 0.6551
2024-08-15 17:10:23,295 : INFO : Precision score for label_class 0: 0.1875
2024-08-15 17:10:23,295 : INFO : Precision score for label_class 1: 0.7035
2024-08-15 17:10:23,295 : INFO : Precision score for label_class 2: 0.5018
2024-08-15 17:10:23,295 : INFO : Recall score for label_class 0: 0.0183
2024-08-15 17:10:23,295 : INFO : Recall score for label_class 1: 0.9118
2024-08-15 17:10:23,295 : INFO : Recall score for label_class 2: 0.3782
2024-08-15 17:10:23,295 : INFO : Average F1 score: 0.4196
2024-08-15 17:10:23,762 : INFO : Average loss over validation batches: 0.6268
2024-08-15 17:10:23,762 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:23,762 : INFO : Validation metrics:
2024-08-15 17:10:23,762 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:23,766 : INFO : Accuracy: 0.7433
2024-08-15 17:10:23,766 : INFO : Precision score for label_class 0: 1.0000
2024-08-15 17:10:23,766 : INFO : Precision score for label_class 1: 0.8079
2024-08-15 17:10:23,766 : INFO : Precision score for label_class 2: 0.6073
2024-08-15 17:10:23,766 : INFO : Recall score for label_class 0: 0.0230
2024-08-15 17:10:23,766 : INFO : Recall score for label_class 1: 0.9385
2024-08-15 17:10:23,766 : INFO : Recall score for label_class 2: 0.6751
2024-08-15 17:10:23,766 : INFO : Average F1 score: 0.5176
2024-08-15 17:10:23,766 : INFO : Validation metric decreased (inf --> 0.626829).  Saving model ...
2024-08-15 17:10:23,876 : INFO : Starting epoch 2
2024-08-15 17:10:24,533 : INFO : Current training batch loss: 0.5865 in epoch 2
2024-08-15 17:10:25,351 : INFO : Current training batch loss: 0.3813 in epoch 2
2024-08-15 17:10:26,169 : INFO : Current training batch loss: 0.2742 in epoch 2
2024-08-15 17:10:26,986 : INFO : Current training batch loss: 0.4233 in epoch 2
2024-08-15 17:10:27,338 : INFO : Epoch finished, average loss over training batches: 0.4494
2024-08-15 17:10:27,338 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:27,338 : INFO : Training metrics:
2024-08-15 17:10:27,338 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:27,342 : INFO : Accuracy: 0.8585
2024-08-15 17:10:27,342 : INFO : Precision score for label_class 0: 0.8085
2024-08-15 17:10:27,342 : INFO : Precision score for label_class 1: 0.8852
2024-08-15 17:10:27,342 : INFO : Precision score for label_class 2: 0.8141
2024-08-15 17:10:27,342 : INFO : Recall score for label_class 0: 0.6972
2024-08-15 17:10:27,342 : INFO : Recall score for label_class 1: 0.9321
2024-08-15 17:10:27,342 : INFO : Recall score for label_class 2: 0.7696
2024-08-15 17:10:27,342 : INFO : Average F1 score: 0.8160
2024-08-15 17:10:27,807 : INFO : Average loss over validation batches: 0.4083
2024-08-15 17:10:27,807 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:27,807 : INFO : Validation metrics:
2024-08-15 17:10:27,807 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:27,811 : INFO : Accuracy: 0.8457
2024-08-15 17:10:27,811 : INFO : Precision score for label_class 0: 0.7000
2024-08-15 17:10:27,811 : INFO : Precision score for label_class 1: 0.8625
2024-08-15 17:10:27,811 : INFO : Precision score for label_class 2: 0.8966
2024-08-15 17:10:27,811 : INFO : Recall score for label_class 0: 0.8046
2024-08-15 17:10:27,811 : INFO : Recall score for label_class 1: 0.9487
2024-08-15 17:10:27,811 : INFO : Recall score for label_class 2: 0.6599
2024-08-15 17:10:27,811 : INFO : Average F1 score: 0.8041
2024-08-15 17:10:27,811 : INFO : Validation metric decreased (0.626829 --> 0.408319).  Saving model ...
2024-08-15 17:10:27,912 : INFO : Starting epoch 3
2024-08-15 17:10:28,365 : INFO : Current training batch loss: 0.2590 in epoch 3
2024-08-15 17:10:29,180 : INFO : Current training batch loss: 0.2485 in epoch 3
2024-08-15 17:10:29,995 : INFO : Current training batch loss: 0.3054 in epoch 3
2024-08-15 17:10:30,809 : INFO : Current training batch loss: 0.1338 in epoch 3
2024-08-15 17:10:31,363 : INFO : Epoch finished, average loss over training batches: 0.2658
2024-08-15 17:10:31,363 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:31,363 : INFO : Training metrics:
2024-08-15 17:10:31,363 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:31,367 : INFO : Accuracy: 0.9207
2024-08-15 17:10:31,367 : INFO : Precision score for label_class 0: 0.8477
2024-08-15 17:10:31,367 : INFO : Precision score for label_class 1: 0.9427
2024-08-15 17:10:31,367 : INFO : Precision score for label_class 2: 0.9056
2024-08-15 17:10:31,367 : INFO : Recall score for label_class 0: 0.9021
2024-08-15 17:10:31,367 : INFO : Recall score for label_class 1: 0.9543
2024-08-15 17:10:31,367 : INFO : Recall score for label_class 2: 0.8562
2024-08-15 17:10:31,367 : INFO : Average F1 score: 0.9009
2024-08-15 17:10:31,834 : INFO : Average loss over validation batches: 0.3884
2024-08-15 17:10:31,834 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:31,834 : INFO : Validation metrics:
2024-08-15 17:10:31,834 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:31,837 : INFO : Accuracy: 0.8620
2024-08-15 17:10:31,837 : INFO : Precision score for label_class 0: 0.8023
2024-08-15 17:10:31,837 : INFO : Precision score for label_class 1: 0.9198
2024-08-15 17:10:31,837 : INFO : Precision score for label_class 2: 0.7850
2024-08-15 17:10:31,837 : INFO : Recall score for label_class 0: 0.7931
2024-08-15 17:10:31,838 : INFO : Recall score for label_class 1: 0.8821
2024-08-15 17:10:31,838 : INFO : Recall score for label_class 2: 0.8528
2024-08-15 17:10:31,838 : INFO : Average F1 score: 0.8386
2024-08-15 17:10:31,838 : INFO : Validation metric decreased (0.408319 --> 0.388377).  Saving model ...
2024-08-15 17:10:31,935 : INFO : Starting epoch 4
2024-08-15 17:10:32,187 : INFO : Current training batch loss: 0.3398 in epoch 4
2024-08-15 17:10:33,002 : INFO : Current training batch loss: 0.2521 in epoch 4
2024-08-15 17:10:33,817 : INFO : Current training batch loss: 0.1757 in epoch 4
2024-08-15 17:10:34,633 : INFO : Current training batch loss: 0.1904 in epoch 4
2024-08-15 17:10:35,387 : INFO : Epoch finished, average loss over training batches: 0.1838
2024-08-15 17:10:35,387 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:35,387 : INFO : Training metrics:
2024-08-15 17:10:35,387 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:35,394 : INFO : Accuracy: 0.9555
2024-08-15 17:10:35,394 : INFO : Precision score for label_class 0: 0.9053
2024-08-15 17:10:35,394 : INFO : Precision score for label_class 1: 0.9698
2024-08-15 17:10:35,394 : INFO : Precision score for label_class 2: 0.9472
2024-08-15 17:10:35,394 : INFO : Recall score for label_class 0: 0.9358
2024-08-15 17:10:35,394 : INFO : Recall score for label_class 1: 0.9704
2024-08-15 17:10:35,394 : INFO : Recall score for label_class 2: 0.9321
2024-08-15 17:10:35,394 : INFO : Average F1 score: 0.9433
2024-08-15 17:10:35,860 : INFO : Average loss over validation batches: 0.3593
2024-08-15 17:10:35,860 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:35,860 : INFO : Validation metrics:
2024-08-15 17:10:35,860 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:35,863 : INFO : Accuracy: 0.8754
2024-08-15 17:10:35,863 : INFO : Precision score for label_class 0: 0.8140
2024-08-15 17:10:35,863 : INFO : Precision score for label_class 1: 0.9020
2024-08-15 17:10:35,863 : INFO : Precision score for label_class 2: 0.8474
2024-08-15 17:10:35,863 : INFO : Recall score for label_class 0: 0.8046
2024-08-15 17:10:35,863 : INFO : Recall score for label_class 1: 0.9205
2024-08-15 17:10:35,863 : INFO : Recall score for label_class 2: 0.8173
2024-08-15 17:10:35,863 : INFO : Average F1 score: 0.8508
2024-08-15 17:10:35,863 : INFO : Validation metric decreased (0.388377 --> 0.359338).  Saving model ...
2024-08-15 17:10:35,964 : INFO : Split 4 is finished, the score is: 0.8508
2024-08-15 17:10:35,964 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:35,964 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:35,964 : INFO : Starting training for split 5
2024-08-15 17:10:35,979 : INFO : Starting to tokenize the sequences.
2024-08-15 17:10:35,984 : INFO : Tokenization is finished.
2024-08-15 17:10:36,001 : INFO : Starting to tokenize the sequences.
2024-08-15 17:10:36,006 : INFO : Tokenization is finished.
2024-08-15 17:10:36,010 : INFO : Counting occurences of labels...
2024-08-15 17:10:36,012 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 330, 1615,  754]))
2024-08-15 17:10:36,012 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 84, 396, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:10:36,057 : INFO : Starting epoch 1
2024-08-15 17:10:36,108 : INFO : Current training batch loss: 1.1160 in epoch 1
2024-08-15 17:10:36,922 : INFO : Current training batch loss: 0.9808 in epoch 1
2024-08-15 17:10:37,738 : INFO : Current training batch loss: 0.7617 in epoch 1
2024-08-15 17:10:38,552 : INFO : Current training batch loss: 0.6169 in epoch 1
2024-08-15 17:10:39,367 : INFO : Current training batch loss: 0.7037 in epoch 1
2024-08-15 17:10:39,517 : INFO : Epoch finished, average loss over training batches: 0.7945
2024-08-15 17:10:39,518 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:39,518 : INFO : Training metrics:
2024-08-15 17:10:39,518 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:39,526 : INFO : Accuracy: 0.6654
2024-08-15 17:10:39,526 : INFO : Precision score for label_class 0: 0.1026
2024-08-15 17:10:39,526 : INFO : Precision score for label_class 1: 0.7135
2024-08-15 17:10:39,526 : INFO : Precision score for label_class 2: 0.5558
2024-08-15 17:10:39,526 : INFO : Recall score for label_class 0: 0.0242
2024-08-15 17:10:39,526 : INFO : Recall score for label_class 1: 0.9282
2024-08-15 17:10:39,526 : INFO : Recall score for label_class 2: 0.3833
2024-08-15 17:10:39,526 : INFO : Average F1 score: 0.4332
2024-08-15 17:10:39,993 : INFO : Average loss over validation batches: 0.5772
2024-08-15 17:10:39,993 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:39,993 : INFO : Validation metrics:
2024-08-15 17:10:39,993 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:39,997 : INFO : Accuracy: 0.7493
2024-08-15 17:10:39,997 : INFO : Precision score for label_class 0: 0.9000
2024-08-15 17:10:39,997 : INFO : Precision score for label_class 1: 0.8000
2024-08-15 17:10:39,997 : INFO : Precision score for label_class 2: 0.6186
2024-08-15 17:10:39,997 : INFO : Recall score for label_class 0: 0.1071
2024-08-15 17:10:39,997 : INFO : Recall score for label_class 1: 0.9495
2024-08-15 17:10:39,997 : INFO : Recall score for label_class 2: 0.6186
2024-08-15 17:10:39,997 : INFO : Average F1 score: 0.5595
2024-08-15 17:10:39,997 : INFO : Validation metric decreased (inf --> 0.577226).  Saving model ...
2024-08-15 17:10:40,099 : INFO : Starting epoch 2
2024-08-15 17:10:40,753 : INFO : Current training batch loss: 0.5622 in epoch 2
2024-08-15 17:10:41,567 : INFO : Current training batch loss: 0.3796 in epoch 2
2024-08-15 17:10:42,381 : INFO : Current training batch loss: 0.2597 in epoch 2
2024-08-15 17:10:43,195 : INFO : Current training batch loss: 0.4224 in epoch 2
2024-08-15 17:10:43,549 : INFO : Epoch finished, average loss over training batches: 0.4196
2024-08-15 17:10:43,549 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:43,549 : INFO : Training metrics:
2024-08-15 17:10:43,549 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:43,557 : INFO : Accuracy: 0.8648
2024-08-15 17:10:43,557 : INFO : Precision score for label_class 0: 0.8103
2024-08-15 17:10:43,557 : INFO : Precision score for label_class 1: 0.8923
2024-08-15 17:10:43,557 : INFO : Precision score for label_class 2: 0.8228
2024-08-15 17:10:43,557 : INFO : Recall score for label_class 0: 0.7121
2024-08-15 17:10:43,557 : INFO : Recall score for label_class 1: 0.9288
2024-08-15 17:10:43,557 : INFO : Recall score for label_class 2: 0.7944
2024-08-15 17:10:43,557 : INFO : Average F1 score: 0.8255
2024-08-15 17:10:44,033 : INFO : Average loss over validation batches: 0.4022
2024-08-15 17:10:44,033 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:44,033 : INFO : Validation metrics:
2024-08-15 17:10:44,033 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:44,037 : INFO : Accuracy: 0.8412
2024-08-15 17:10:44,037 : INFO : Precision score for label_class 0: 0.7342
2024-08-15 17:10:44,037 : INFO : Precision score for label_class 1: 0.8714
2024-08-15 17:10:44,037 : INFO : Precision score for label_class 2: 0.8171
2024-08-15 17:10:44,037 : INFO : Recall score for label_class 0: 0.6905
2024-08-15 17:10:44,037 : INFO : Recall score for label_class 1: 0.9242
2024-08-15 17:10:44,037 : INFO : Recall score for label_class 2: 0.7371
2024-08-15 17:10:44,037 : INFO : Average F1 score: 0.7946
2024-08-15 17:10:44,037 : INFO : Validation metric decreased (0.577226 --> 0.402181).  Saving model ...
2024-08-15 17:10:44,137 : INFO : Starting epoch 3
2024-08-15 17:10:44,674 : INFO : Current training batch loss: 0.2176 in epoch 3
2024-08-15 17:10:45,490 : INFO : Current training batch loss: 0.3072 in epoch 3
2024-08-15 17:10:46,304 : INFO : Current training batch loss: 0.1964 in epoch 3
2024-08-15 17:10:47,119 : INFO : Current training batch loss: 0.2361 in epoch 3
2024-08-15 17:10:47,686 : INFO : Epoch finished, average loss over training batches: 0.2486
2024-08-15 17:10:47,686 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:47,686 : INFO : Training metrics:
2024-08-15 17:10:47,686 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:47,697 : INFO : Accuracy: 0.9270
2024-08-15 17:10:47,697 : INFO : Precision score for label_class 0: 0.8596
2024-08-15 17:10:47,697 : INFO : Precision score for label_class 1: 0.9450
2024-08-15 17:10:47,697 : INFO : Precision score for label_class 2: 0.9182
2024-08-15 17:10:47,697 : INFO : Recall score for label_class 0: 0.8909
2024-08-15 17:10:47,697 : INFO : Recall score for label_class 1: 0.9573
2024-08-15 17:10:47,697 : INFO : Recall score for label_class 2: 0.8780
2024-08-15 17:10:47,697 : INFO : Average F1 score: 0.9079
2024-08-15 17:10:48,165 : INFO : Average loss over validation batches: 0.3735
2024-08-15 17:10:48,165 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:48,165 : INFO : Validation metrics:
2024-08-15 17:10:48,165 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:48,169 : INFO : Accuracy: 0.8531
2024-08-15 17:10:48,169 : INFO : Precision score for label_class 0: 0.7262
2024-08-15 17:10:48,169 : INFO : Precision score for label_class 1: 0.9107
2024-08-15 17:10:48,169 : INFO : Precision score for label_class 2: 0.7929
2024-08-15 17:10:48,169 : INFO : Recall score for label_class 0: 0.7262
2024-08-15 17:10:48,169 : INFO : Recall score for label_class 1: 0.9015
2024-08-15 17:10:48,169 : INFO : Recall score for label_class 2: 0.8093
2024-08-15 17:10:48,169 : INFO : Average F1 score: 0.8111
2024-08-15 17:10:48,169 : INFO : Validation metric decreased (0.402181 --> 0.373478).  Saving model ...
2024-08-15 17:10:48,272 : INFO : Starting epoch 4
2024-08-15 17:10:48,526 : INFO : Current training batch loss: 0.3344 in epoch 4
2024-08-15 17:10:49,341 : INFO : Current training batch loss: 0.2908 in epoch 4
2024-08-15 17:10:50,156 : INFO : Current training batch loss: 0.1927 in epoch 4
2024-08-15 17:10:50,970 : INFO : Current training batch loss: 0.1061 in epoch 4
2024-08-15 17:10:51,735 : INFO : Epoch finished, average loss over training batches: 0.1717
2024-08-15 17:10:51,736 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:51,736 : INFO : Training metrics:
2024-08-15 17:10:51,736 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:51,746 : INFO : Accuracy: 0.9555
2024-08-15 17:10:51,746 : INFO : Precision score for label_class 0: 0.9029
2024-08-15 17:10:51,746 : INFO : Precision score for label_class 1: 0.9681
2024-08-15 17:10:51,746 : INFO : Precision score for label_class 2: 0.9521
2024-08-15 17:10:51,746 : INFO : Recall score for label_class 0: 0.9303
2024-08-15 17:10:51,747 : INFO : Recall score for label_class 1: 0.9759
2024-08-15 17:10:51,747 : INFO : Recall score for label_class 2: 0.9231
2024-08-15 17:10:51,747 : INFO : Average F1 score: 0.9419
2024-08-15 17:10:52,215 : INFO : Average loss over validation batches: 0.3624
2024-08-15 17:10:52,215 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:52,215 : INFO : Validation metrics:
2024-08-15 17:10:52,215 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:52,219 : INFO : Accuracy: 0.8591
2024-08-15 17:10:52,219 : INFO : Precision score for label_class 0: 0.7647
2024-08-15 17:10:52,219 : INFO : Precision score for label_class 1: 0.9107
2024-08-15 17:10:52,219 : INFO : Precision score for label_class 2: 0.7970
2024-08-15 17:10:52,219 : INFO : Recall score for label_class 0: 0.7738
2024-08-15 17:10:52,219 : INFO : Recall score for label_class 1: 0.9015
2024-08-15 17:10:52,219 : INFO : Recall score for label_class 2: 0.8093
2024-08-15 17:10:52,219 : INFO : Average F1 score: 0.8261
2024-08-15 17:10:52,219 : INFO : Validation metric decreased (0.373478 --> 0.362411).  Saving model ...
2024-08-15 17:10:52,320 : INFO : Split 5 is finished, the score is: 0.8261
2024-08-15 17:10:52,320 : INFO : ----------------------------------------------------------------------------------------------------
[I 2024-08-15 17:10:52,330] Trial 1 finished with value: 0.8513001269595835 and parameters: {'n_epochs': 4, 'learning_rate': 5.0086804630232046e-05, 'classifier_dropout': 0.7855798922552321, 'warmup_step_fraction': 0.011590124119455958, 'use_gradient_clipping': False}. Best is trial 1 with value: 0.8513001269595835.
2024-08-15 17:10:52,330 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:52,330 : INFO : Starting training for split 1
2024-08-15 17:10:52,342 : INFO : Starting to tokenize the sequences.
2024-08-15 17:10:52,347 : INFO : Tokenization is finished.
2024-08-15 17:10:52,359 : INFO : Starting to tokenize the sequences.
2024-08-15 17:10:52,364 : INFO : Tokenization is finished.
2024-08-15 17:10:52,364 : INFO : Counting occurences of labels...
2024-08-15 17:10:52,365 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1596,  774]))
2024-08-15 17:10:52,365 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 415, 174]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:10:52,407 : INFO : Starting epoch 1
2024-08-15 17:10:52,459 : INFO : Current training batch loss: 1.1053 in epoch 1
2024-08-15 17:10:53,278 : INFO : Current training batch loss: 1.0328 in epoch 1
2024-08-15 17:10:54,116 : INFO : Current training batch loss: 1.0177 in epoch 1
2024-08-15 17:10:54,955 : INFO : Current training batch loss: 0.8033 in epoch 1
2024-08-15 17:10:55,792 : INFO : Current training batch loss: 0.8047 in epoch 1
2024-08-15 17:10:55,948 : INFO : Epoch finished, average loss over training batches: 0.9223
2024-08-15 17:10:55,949 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:55,949 : INFO : Training metrics:
2024-08-15 17:10:55,949 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:55,954 : INFO : Accuracy: 0.5745
2024-08-15 17:10:55,954 : INFO : Precision score for label_class 0: 0.3889
2024-08-15 17:10:55,954 : INFO : Precision score for label_class 1: 0.6663
2024-08-15 17:10:55,954 : INFO : Precision score for label_class 2: 0.3784
2024-08-15 17:10:55,954 : INFO : Recall score for label_class 0: 0.0213
2024-08-15 17:10:55,954 : INFO : Recall score for label_class 1: 0.7669
2024-08-15 17:10:55,954 : INFO : Recall score for label_class 2: 0.4121
2024-08-15 17:10:55,954 : INFO : Average F1 score: 0.3827
2024-08-15 17:10:56,422 : INFO : Average loss over validation batches: 0.7098
2024-08-15 17:10:56,422 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:56,422 : INFO : Validation metrics:
2024-08-15 17:10:56,422 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:10:56,425 : INFO : Accuracy: 0.7170
2024-08-15 17:10:56,425 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:10:56,425 : INFO : Precision score for label_class 1: 0.8162
2024-08-15 17:10:56,425 : INFO : Precision score for label_class 2: 0.4928
2024-08-15 17:10:56,425 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:10:56,425 : INFO : Recall score for label_class 1: 0.9205
2024-08-15 17:10:56,425 : INFO : Recall score for label_class 2: 0.5862
2024-08-15 17:10:56,425 : INFO : Average F1 score: 0.4669
2024-08-15 17:10:56,425 : INFO : Validation metric decreased (inf --> 0.709789).  Saving model ...
2024-08-15 17:10:56,529 : INFO : Starting epoch 2
2024-08-15 17:10:57,202 : INFO : Current training batch loss: 0.4893 in epoch 2
2024-08-15 17:10:58,036 : INFO : Current training batch loss: 0.6205 in epoch 2
2024-08-15 17:10:58,875 : INFO : Current training batch loss: 0.5189 in epoch 2
2024-08-15 17:10:59,694 : INFO : Current training batch loss: 0.3606 in epoch 2
2024-08-15 17:11:00,045 : INFO : Epoch finished, average loss over training batches: 0.5617
2024-08-15 17:11:00,046 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:00,046 : INFO : Training metrics:
2024-08-15 17:11:00,046 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:00,050 : INFO : Accuracy: 0.7958
2024-08-15 17:11:00,050 : INFO : Precision score for label_class 0: 0.7760
2024-08-15 17:11:00,050 : INFO : Precision score for label_class 1: 0.8548
2024-08-15 17:11:00,050 : INFO : Precision score for label_class 2: 0.6751
2024-08-15 17:11:00,050 : INFO : Recall score for label_class 0: 0.2957
2024-08-15 17:11:00,050 : INFO : Recall score for label_class 1: 0.9330
2024-08-15 17:11:00,050 : INFO : Recall score for label_class 2: 0.7248
2024-08-15 17:11:00,050 : INFO : Average F1 score: 0.6732
2024-08-15 17:11:00,518 : INFO : Average loss over validation batches: 0.4599
2024-08-15 17:11:00,518 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:00,518 : INFO : Validation metrics:
2024-08-15 17:11:00,518 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:00,521 : INFO : Accuracy: 0.8370
2024-08-15 17:11:00,521 : INFO : Precision score for label_class 0: 0.8095
2024-08-15 17:11:00,521 : INFO : Precision score for label_class 1: 0.9259
2024-08-15 17:11:00,521 : INFO : Precision score for label_class 2: 0.6901
2024-08-15 17:11:00,521 : INFO : Recall score for label_class 0: 0.7907
2024-08-15 17:11:00,521 : INFO : Recall score for label_class 1: 0.8434
2024-08-15 17:11:00,521 : INFO : Recall score for label_class 2: 0.8448
2024-08-15 17:11:00,521 : INFO : Average F1 score: 0.8141
2024-08-15 17:11:00,521 : INFO : Validation metric decreased (0.709789 --> 0.459884).  Saving model ...
2024-08-15 17:11:00,622 : INFO : Starting epoch 3
2024-08-15 17:11:01,075 : INFO : Current training batch loss: 0.4425 in epoch 3
2024-08-15 17:11:01,889 : INFO : Current training batch loss: 0.4037 in epoch 3
2024-08-15 17:11:02,704 : INFO : Current training batch loss: 0.3323 in epoch 3
2024-08-15 17:11:03,519 : INFO : Current training batch loss: 0.2418 in epoch 3
2024-08-15 17:11:04,072 : INFO : Epoch finished, average loss over training batches: 0.3419
2024-08-15 17:11:04,072 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:04,072 : INFO : Training metrics:
2024-08-15 17:11:04,072 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:04,080 : INFO : Accuracy: 0.8892
2024-08-15 17:11:04,080 : INFO : Precision score for label_class 0: 0.7752
2024-08-15 17:11:04,080 : INFO : Precision score for label_class 1: 0.9244
2024-08-15 17:11:04,080 : INFO : Precision score for label_class 2: 0.8648
2024-08-15 17:11:04,080 : INFO : Recall score for label_class 0: 0.8201
2024-08-15 17:11:04,080 : INFO : Recall score for label_class 1: 0.9417
2024-08-15 17:11:04,080 : INFO : Recall score for label_class 2: 0.8101
2024-08-15 17:11:04,080 : INFO : Average F1 score: 0.8555
2024-08-15 17:11:04,547 : INFO : Average loss over validation batches: 0.3591
2024-08-15 17:11:04,547 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:04,547 : INFO : Validation metrics:
2024-08-15 17:11:04,547 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:04,550 : INFO : Accuracy: 0.8800
2024-08-15 17:11:04,550 : INFO : Precision score for label_class 0: 0.8049
2024-08-15 17:11:04,550 : INFO : Precision score for label_class 1: 0.8998
2024-08-15 17:11:04,550 : INFO : Precision score for label_class 2: 0.8636
2024-08-15 17:11:04,550 : INFO : Recall score for label_class 0: 0.7674
2024-08-15 17:11:04,550 : INFO : Recall score for label_class 1: 0.9518
2024-08-15 17:11:04,550 : INFO : Recall score for label_class 2: 0.7644
2024-08-15 17:11:04,550 : INFO : Average F1 score: 0.8406
2024-08-15 17:11:04,550 : INFO : Validation metric decreased (0.459884 --> 0.359126).  Saving model ...
2024-08-15 17:11:04,652 : INFO : Starting epoch 4
2024-08-15 17:11:04,904 : INFO : Current training batch loss: 0.5874 in epoch 4
2024-08-15 17:11:05,719 : INFO : Current training batch loss: 0.2761 in epoch 4
2024-08-15 17:11:06,534 : INFO : Current training batch loss: 0.3758 in epoch 4
2024-08-15 17:11:07,348 : INFO : Current training batch loss: 0.1953 in epoch 4
2024-08-15 17:11:08,102 : INFO : Epoch finished, average loss over training batches: 0.2219
2024-08-15 17:11:08,102 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:08,102 : INFO : Training metrics:
2024-08-15 17:11:08,102 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:08,107 : INFO : Accuracy: 0.9362
2024-08-15 17:11:08,107 : INFO : Precision score for label_class 0: 0.8466
2024-08-15 17:11:08,107 : INFO : Precision score for label_class 1: 0.9600
2024-08-15 17:11:08,107 : INFO : Precision score for label_class 2: 0.9274
2024-08-15 17:11:08,107 : INFO : Recall score for label_class 0: 0.9085
2024-08-15 17:11:08,107 : INFO : Recall score for label_class 1: 0.9637
2024-08-15 17:11:08,107 : INFO : Recall score for label_class 2: 0.8915
2024-08-15 17:11:08,107 : INFO : Average F1 score: 0.9158
2024-08-15 17:11:08,575 : INFO : Average loss over validation batches: 0.3819
2024-08-15 17:11:08,575 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:08,575 : INFO : Validation metrics:
2024-08-15 17:11:08,575 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:08,578 : INFO : Accuracy: 0.8563
2024-08-15 17:11:08,578 : INFO : Precision score for label_class 0: 0.7476
2024-08-15 17:11:08,578 : INFO : Precision score for label_class 1: 0.9484
2024-08-15 17:11:08,578 : INFO : Precision score for label_class 2: 0.7451
2024-08-15 17:11:08,578 : INFO : Recall score for label_class 0: 0.8953
2024-08-15 17:11:08,578 : INFO : Recall score for label_class 1: 0.8410
2024-08-15 17:11:08,578 : INFO : Recall score for label_class 2: 0.8736
2024-08-15 17:11:08,578 : INFO : Average F1 score: 0.8368
2024-08-15 17:11:08,578 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:11:08,578 : INFO : Starting epoch 5
2024-08-15 17:11:08,629 : INFO : Current training batch loss: 0.1937 in epoch 5
2024-08-15 17:11:09,444 : INFO : Current training batch loss: 0.2294 in epoch 5
2024-08-15 17:11:10,259 : INFO : Current training batch loss: 0.1146 in epoch 5
2024-08-15 17:11:11,074 : INFO : Current training batch loss: 0.2219 in epoch 5
2024-08-15 17:11:11,890 : INFO : Current training batch loss: 0.1905 in epoch 5
2024-08-15 17:11:12,041 : INFO : Epoch finished, average loss over training batches: 0.1454
2024-08-15 17:11:12,041 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:12,041 : INFO : Training metrics:
2024-08-15 17:11:12,041 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:12,046 : INFO : Accuracy: 0.9633
2024-08-15 17:11:12,046 : INFO : Precision score for label_class 0: 0.8957
2024-08-15 17:11:12,046 : INFO : Precision score for label_class 1: 0.9745
2024-08-15 17:11:12,046 : INFO : Precision score for label_class 2: 0.9704
2024-08-15 17:11:12,046 : INFO : Recall score for label_class 0: 0.9421
2024-08-15 17:11:12,046 : INFO : Recall score for label_class 1: 0.9831
2024-08-15 17:11:12,046 : INFO : Recall score for label_class 2: 0.9315
2024-08-15 17:11:12,046 : INFO : Average F1 score: 0.9492
2024-08-15 17:11:12,511 : INFO : Average loss over validation batches: 0.4202
2024-08-15 17:11:12,511 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:12,511 : INFO : Validation metrics:
2024-08-15 17:11:12,511 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:12,514 : INFO : Accuracy: 0.8652
2024-08-15 17:11:12,514 : INFO : Precision score for label_class 0: 0.7105
2024-08-15 17:11:12,514 : INFO : Precision score for label_class 1: 0.9592
2024-08-15 17:11:12,514 : INFO : Precision score for label_class 2: 0.7772
2024-08-15 17:11:12,514 : INFO : Recall score for label_class 0: 0.9419
2024-08-15 17:11:12,514 : INFO : Recall score for label_class 1: 0.8506
2024-08-15 17:11:12,514 : INFO : Recall score for label_class 2: 0.8621
2024-08-15 17:11:12,514 : INFO : Average F1 score: 0.8430
2024-08-15 17:11:12,514 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:11:12,514 : INFO : Starting epoch 6
2024-08-15 17:11:13,168 : INFO : Current training batch loss: 0.0256 in epoch 6
2024-08-15 17:11:13,983 : INFO : Current training batch loss: 0.1006 in epoch 6
2024-08-15 17:11:14,797 : INFO : Current training batch loss: 0.0311 in epoch 6
2024-08-15 17:11:15,612 : INFO : Current training batch loss: 0.0283 in epoch 6
2024-08-15 17:11:15,964 : INFO : Epoch finished, average loss over training batches: 0.1100
2024-08-15 17:11:15,964 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:15,964 : INFO : Training metrics:
2024-08-15 17:11:15,964 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:15,972 : INFO : Accuracy: 0.9741
2024-08-15 17:11:15,972 : INFO : Precision score for label_class 0: 0.9186
2024-08-15 17:11:15,972 : INFO : Precision score for label_class 1: 0.9850
2024-08-15 17:11:15,972 : INFO : Precision score for label_class 2: 0.9763
2024-08-15 17:11:15,972 : INFO : Recall score for label_class 0: 0.9634
2024-08-15 17:11:15,972 : INFO : Recall score for label_class 1: 0.9843
2024-08-15 17:11:15,972 : INFO : Recall score for label_class 2: 0.9574
2024-08-15 17:11:15,972 : INFO : Average F1 score: 0.9640
2024-08-15 17:11:16,438 : INFO : Average loss over validation batches: 0.3622
2024-08-15 17:11:16,438 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:16,438 : INFO : Validation metrics:
2024-08-15 17:11:16,438 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:16,441 : INFO : Accuracy: 0.8919
2024-08-15 17:11:16,441 : INFO : Precision score for label_class 0: 0.7647
2024-08-15 17:11:16,441 : INFO : Precision score for label_class 1: 0.9240
2024-08-15 17:11:16,441 : INFO : Precision score for label_class 2: 0.8882
2024-08-15 17:11:16,441 : INFO : Recall score for label_class 0: 0.9070
2024-08-15 17:11:16,441 : INFO : Recall score for label_class 1: 0.9373
2024-08-15 17:11:16,441 : INFO : Recall score for label_class 2: 0.7759
2024-08-15 17:11:16,441 : INFO : Average F1 score: 0.8629
2024-08-15 17:11:16,441 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:11:16,441 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:11:16,476 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:11:16,965 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:16,965 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:11:16,965 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:16,969 : INFO : Accuracy: 0.8800
2024-08-15 17:11:16,969 : INFO : Precision score for label_class 0: 0.8049
2024-08-15 17:11:16,969 : INFO : Precision score for label_class 1: 0.8998
2024-08-15 17:11:16,969 : INFO : Precision score for label_class 2: 0.8636
2024-08-15 17:11:16,969 : INFO : Recall score for label_class 0: 0.7674
2024-08-15 17:11:16,969 : INFO : Recall score for label_class 1: 0.9518
2024-08-15 17:11:16,969 : INFO : Recall score for label_class 2: 0.7644
2024-08-15 17:11:16,969 : INFO : Average F1 score: 0.8406
2024-08-15 17:11:16,969 : INFO : Determined score from best model, ending training.
2024-08-15 17:11:16,970 : INFO : Split 1 is finished, the score is: 0.8406
2024-08-15 17:11:16,970 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:16,970 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:16,970 : INFO : Starting training for split 2
2024-08-15 17:11:16,985 : INFO : Starting to tokenize the sequences.
2024-08-15 17:11:16,991 : INFO : Tokenization is finished.
2024-08-15 17:11:17,014 : INFO : Starting to tokenize the sequences.
2024-08-15 17:11:17,019 : INFO : Tokenization is finished.
2024-08-15 17:11:17,024 : INFO : Counting occurences of labels...
2024-08-15 17:11:17,025 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 343, 1601,  754]))
2024-08-15 17:11:17,025 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 71, 410, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:11:17,072 : INFO : Starting epoch 1
2024-08-15 17:11:17,123 : INFO : Current training batch loss: 1.1087 in epoch 1
2024-08-15 17:11:17,938 : INFO : Current training batch loss: 1.0573 in epoch 1
2024-08-15 17:11:18,753 : INFO : Current training batch loss: 1.0027 in epoch 1
2024-08-15 17:11:19,567 : INFO : Current training batch loss: 0.7551 in epoch 1
2024-08-15 17:11:20,382 : INFO : Current training batch loss: 0.7538 in epoch 1
2024-08-15 17:11:20,532 : INFO : Epoch finished, average loss over training batches: 0.9011
2024-08-15 17:11:20,533 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:20,533 : INFO : Training metrics:
2024-08-15 17:11:20,533 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:20,543 : INFO : Accuracy: 0.5745
2024-08-15 17:11:20,543 : INFO : Precision score for label_class 0: 0.1240
2024-08-15 17:11:20,543 : INFO : Precision score for label_class 1: 0.6594
2024-08-15 17:11:20,543 : INFO : Precision score for label_class 2: 0.5481
2024-08-15 17:11:20,543 : INFO : Recall score for label_class 0: 0.1312
2024-08-15 17:11:20,543 : INFO : Recall score for label_class 1: 0.8332
2024-08-15 17:11:20,543 : INFO : Recall score for label_class 2: 0.2268
2024-08-15 17:11:20,543 : INFO : Average F1 score: 0.3948
2024-08-15 17:11:21,008 : INFO : Average loss over validation batches: 0.6298
2024-08-15 17:11:21,009 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:21,009 : INFO : Validation metrics:
2024-08-15 17:11:21,009 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:21,013 : INFO : Accuracy: 0.7526
2024-08-15 17:11:21,013 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:11:21,013 : INFO : Precision score for label_class 1: 0.8170
2024-08-15 17:11:21,013 : INFO : Precision score for label_class 2: 0.6049
2024-08-15 17:11:21,013 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:11:21,013 : INFO : Recall score for label_class 1: 0.9366
2024-08-15 17:11:21,013 : INFO : Recall score for label_class 2: 0.6392
2024-08-15 17:11:21,013 : INFO : Average F1 score: 0.4981
2024-08-15 17:11:21,013 : INFO : Validation metric decreased (inf --> 0.629778).  Saving model ...
2024-08-15 17:11:21,121 : INFO : Starting epoch 2
2024-08-15 17:11:21,774 : INFO : Current training batch loss: 0.6244 in epoch 2
2024-08-15 17:11:22,588 : INFO : Current training batch loss: 0.5509 in epoch 2
2024-08-15 17:11:23,402 : INFO : Current training batch loss: 0.3440 in epoch 2
2024-08-15 17:11:24,217 : INFO : Current training batch loss: 0.3313 in epoch 2
2024-08-15 17:11:24,568 : INFO : Epoch finished, average loss over training batches: 0.4852
2024-08-15 17:11:24,568 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:24,568 : INFO : Training metrics:
2024-08-15 17:11:24,568 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:24,579 : INFO : Accuracy: 0.8280
2024-08-15 17:11:24,579 : INFO : Precision score for label_class 0: 0.7612
2024-08-15 17:11:24,579 : INFO : Precision score for label_class 1: 0.8669
2024-08-15 17:11:24,579 : INFO : Precision score for label_class 2: 0.7592
2024-08-15 17:11:24,579 : INFO : Recall score for label_class 0: 0.5948
2024-08-15 17:11:24,579 : INFO : Recall score for label_class 1: 0.9313
2024-08-15 17:11:24,579 : INFO : Recall score for label_class 2: 0.7149
2024-08-15 17:11:24,579 : INFO : Average F1 score: 0.7673
2024-08-15 17:11:25,045 : INFO : Average loss over validation batches: 0.3977
2024-08-15 17:11:25,045 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:25,045 : INFO : Validation metrics:
2024-08-15 17:11:25,045 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:25,048 : INFO : Accuracy: 0.8607
2024-08-15 17:11:25,048 : INFO : Precision score for label_class 0: 0.7403
2024-08-15 17:11:25,048 : INFO : Precision score for label_class 1: 0.8865
2024-08-15 17:11:25,048 : INFO : Precision score for label_class 2: 0.8514
2024-08-15 17:11:25,048 : INFO : Recall score for label_class 0: 0.8028
2024-08-15 17:11:25,048 : INFO : Recall score for label_class 1: 0.9146
2024-08-15 17:11:25,048 : INFO : Recall score for label_class 2: 0.7680
2024-08-15 17:11:25,048 : INFO : Average F1 score: 0.8261
2024-08-15 17:11:25,048 : INFO : Validation metric decreased (0.629778 --> 0.397707).  Saving model ...
2024-08-15 17:11:25,147 : INFO : Starting epoch 3
2024-08-15 17:11:25,600 : INFO : Current training batch loss: 0.2648 in epoch 3
2024-08-15 17:11:26,414 : INFO : Current training batch loss: 0.2669 in epoch 3
2024-08-15 17:11:27,229 : INFO : Current training batch loss: 0.3160 in epoch 3
2024-08-15 17:11:28,044 : INFO : Current training batch loss: 0.1495 in epoch 3
2024-08-15 17:11:28,597 : INFO : Epoch finished, average loss over training batches: 0.2619
2024-08-15 17:11:28,597 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:28,597 : INFO : Training metrics:
2024-08-15 17:11:28,597 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:28,605 : INFO : Accuracy: 0.9266
2024-08-15 17:11:28,605 : INFO : Precision score for label_class 0: 0.8621
2024-08-15 17:11:28,605 : INFO : Precision score for label_class 1: 0.9511
2024-08-15 17:11:28,605 : INFO : Precision score for label_class 2: 0.9035
2024-08-15 17:11:28,605 : INFO : Recall score for label_class 0: 0.8746
2024-08-15 17:11:28,605 : INFO : Recall score for label_class 1: 0.9588
2024-08-15 17:11:28,605 : INFO : Recall score for label_class 2: 0.8820
2024-08-15 17:11:28,605 : INFO : Average F1 score: 0.9053
2024-08-15 17:11:29,072 : INFO : Average loss over validation batches: 0.4017
2024-08-15 17:11:29,072 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:29,072 : INFO : Validation metrics:
2024-08-15 17:11:29,073 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:29,076 : INFO : Accuracy: 0.8607
2024-08-15 17:11:29,076 : INFO : Precision score for label_class 0: 0.7879
2024-08-15 17:11:29,076 : INFO : Precision score for label_class 1: 0.9000
2024-08-15 17:11:29,076 : INFO : Precision score for label_class 2: 0.8040
2024-08-15 17:11:29,076 : INFO : Recall score for label_class 0: 0.7324
2024-08-15 17:11:29,076 : INFO : Recall score for label_class 1: 0.9000
2024-08-15 17:11:29,076 : INFO : Recall score for label_class 2: 0.8247
2024-08-15 17:11:29,076 : INFO : Average F1 score: 0.8245
2024-08-15 17:11:29,076 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:11:29,076 : INFO : Starting epoch 4
2024-08-15 17:11:29,328 : INFO : Current training batch loss: 0.3334 in epoch 4
2024-08-15 17:11:30,142 : INFO : Current training batch loss: 0.2053 in epoch 4
2024-08-15 17:11:30,957 : INFO : Current training batch loss: 0.2519 in epoch 4
2024-08-15 17:11:31,772 : INFO : Current training batch loss: 0.1666 in epoch 4
2024-08-15 17:11:32,525 : INFO : Epoch finished, average loss over training batches: 0.1768
2024-08-15 17:11:32,525 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:32,525 : INFO : Training metrics:
2024-08-15 17:11:32,525 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:32,533 : INFO : Accuracy: 0.9500
2024-08-15 17:11:32,533 : INFO : Precision score for label_class 0: 0.8974
2024-08-15 17:11:32,533 : INFO : Precision score for label_class 1: 0.9694
2024-08-15 17:11:32,533 : INFO : Precision score for label_class 2: 0.9328
2024-08-15 17:11:32,533 : INFO : Recall score for label_class 0: 0.9184
2024-08-15 17:11:32,533 : INFO : Recall score for label_class 1: 0.9706
2024-08-15 17:11:32,533 : INFO : Recall score for label_class 2: 0.9204
2024-08-15 17:11:32,533 : INFO : Average F1 score: 0.9348
2024-08-15 17:11:33,000 : INFO : Average loss over validation batches: 0.4101
2024-08-15 17:11:33,000 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:33,000 : INFO : Validation metrics:
2024-08-15 17:11:33,000 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:33,004 : INFO : Accuracy: 0.8652
2024-08-15 17:11:33,004 : INFO : Precision score for label_class 0: 0.7532
2024-08-15 17:11:33,004 : INFO : Precision score for label_class 1: 0.8850
2024-08-15 17:11:33,004 : INFO : Precision score for label_class 2: 0.8663
2024-08-15 17:11:33,004 : INFO : Recall score for label_class 0: 0.8169
2024-08-15 17:11:33,004 : INFO : Recall score for label_class 1: 0.9195
2024-08-15 17:11:33,004 : INFO : Recall score for label_class 2: 0.7680
2024-08-15 17:11:33,004 : INFO : Average F1 score: 0.8333
2024-08-15 17:11:33,004 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:11:33,004 : INFO : Starting epoch 5
2024-08-15 17:11:33,054 : INFO : Current training batch loss: 0.1180 in epoch 5
2024-08-15 17:11:33,869 : INFO : Current training batch loss: 0.3134 in epoch 5
2024-08-15 17:11:34,688 : INFO : Current training batch loss: 0.0449 in epoch 5
2024-08-15 17:11:35,499 : INFO : Current training batch loss: 0.0759 in epoch 5
2024-08-15 17:11:36,309 : INFO : Current training batch loss: 0.2488 in epoch 5
2024-08-15 17:11:36,452 : INFO : Epoch finished, average loss over training batches: 0.1217
2024-08-15 17:11:36,452 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:36,452 : INFO : Training metrics:
2024-08-15 17:11:36,452 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:36,465 : INFO : Accuracy: 0.9718
2024-08-15 17:11:36,465 : INFO : Precision score for label_class 0: 0.9266
2024-08-15 17:11:36,465 : INFO : Precision score for label_class 1: 0.9813
2024-08-15 17:11:36,465 : INFO : Precision score for label_class 2: 0.9728
2024-08-15 17:11:36,465 : INFO : Recall score for label_class 0: 0.9563
2024-08-15 17:11:36,465 : INFO : Recall score for label_class 1: 0.9856
2024-08-15 17:11:36,465 : INFO : Recall score for label_class 2: 0.9496
2024-08-15 17:11:36,465 : INFO : Average F1 score: 0.9619
2024-08-15 17:11:36,933 : INFO : Average loss over validation batches: 0.5086
2024-08-15 17:11:36,933 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:36,933 : INFO : Validation metrics:
2024-08-15 17:11:36,933 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:36,936 : INFO : Accuracy: 0.8267
2024-08-15 17:11:36,936 : INFO : Precision score for label_class 0: 0.7342
2024-08-15 17:11:36,936 : INFO : Precision score for label_class 1: 0.9174
2024-08-15 17:11:36,936 : INFO : Precision score for label_class 2: 0.7167
2024-08-15 17:11:36,936 : INFO : Recall score for label_class 0: 0.8169
2024-08-15 17:11:36,936 : INFO : Recall score for label_class 1: 0.8122
2024-08-15 17:11:36,936 : INFO : Recall score for label_class 2: 0.8608
2024-08-15 17:11:36,936 : INFO : Average F1 score: 0.8057
2024-08-15 17:11:36,936 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:11:36,936 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:11:36,969 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:11:37,469 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:37,469 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:11:37,469 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:37,473 : INFO : Accuracy: 0.8607
2024-08-15 17:11:37,473 : INFO : Precision score for label_class 0: 0.7403
2024-08-15 17:11:37,473 : INFO : Precision score for label_class 1: 0.8865
2024-08-15 17:11:37,473 : INFO : Precision score for label_class 2: 0.8514
2024-08-15 17:11:37,473 : INFO : Recall score for label_class 0: 0.8028
2024-08-15 17:11:37,473 : INFO : Recall score for label_class 1: 0.9146
2024-08-15 17:11:37,473 : INFO : Recall score for label_class 2: 0.7680
2024-08-15 17:11:37,473 : INFO : Average F1 score: 0.8261
2024-08-15 17:11:37,473 : INFO : Determined score from best model, ending training.
2024-08-15 17:11:37,478 : INFO : Split 2 is finished, the score is: 0.8261
2024-08-15 17:11:37,478 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:37,478 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:37,478 : INFO : Starting training for split 3
2024-08-15 17:11:37,491 : INFO : Starting to tokenize the sequences.
2024-08-15 17:11:37,497 : INFO : Tokenization is finished.
2024-08-15 17:11:37,515 : INFO : Starting to tokenize the sequences.
2024-08-15 17:11:37,520 : INFO : Tokenization is finished.
2024-08-15 17:11:37,525 : INFO : Counting occurences of labels...
2024-08-15 17:11:37,526 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1611,  759]))
2024-08-15 17:11:37,526 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 400, 189]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:11:37,569 : INFO : Starting epoch 1
2024-08-15 17:11:37,620 : INFO : Current training batch loss: 1.1036 in epoch 1
2024-08-15 17:11:38,430 : INFO : Current training batch loss: 1.0608 in epoch 1
2024-08-15 17:11:39,246 : INFO : Current training batch loss: 0.9245 in epoch 1
2024-08-15 17:11:40,061 : INFO : Current training batch loss: 0.8094 in epoch 1
2024-08-15 17:11:40,876 : INFO : Current training batch loss: 0.7963 in epoch 1
2024-08-15 17:11:41,026 : INFO : Epoch finished, average loss over training batches: 0.9156
2024-08-15 17:11:41,026 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:41,026 : INFO : Training metrics:
2024-08-15 17:11:41,027 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:41,034 : INFO : Accuracy: 0.5945
2024-08-15 17:11:41,034 : INFO : Precision score for label_class 0: 0.1325
2024-08-15 17:11:41,034 : INFO : Precision score for label_class 1: 0.6535
2024-08-15 17:11:41,034 : INFO : Precision score for label_class 2: 0.5272
2024-08-15 17:11:41,034 : INFO : Recall score for label_class 0: 0.0945
2024-08-15 17:11:41,034 : INFO : Recall score for label_class 1: 0.8802
2024-08-15 17:11:41,034 : INFO : Recall score for label_class 2: 0.2042
2024-08-15 17:11:41,034 : INFO : Average F1 score: 0.3849
2024-08-15 17:11:41,499 : INFO : Average loss over validation batches: 0.6960
2024-08-15 17:11:41,499 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:41,499 : INFO : Validation metrics:
2024-08-15 17:11:41,499 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:41,502 : INFO : Accuracy: 0.7170
2024-08-15 17:11:41,502 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:11:41,502 : INFO : Precision score for label_class 1: 0.8052
2024-08-15 17:11:41,502 : INFO : Precision score for label_class 2: 0.5258
2024-08-15 17:11:41,502 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:11:41,502 : INFO : Recall score for label_class 1: 0.9300
2024-08-15 17:11:41,502 : INFO : Recall score for label_class 2: 0.5926
2024-08-15 17:11:41,502 : INFO : Average F1 score: 0.4734
2024-08-15 17:11:41,502 : INFO : Validation metric decreased (inf --> 0.695958).  Saving model ...
2024-08-15 17:11:41,598 : INFO : Starting epoch 2
2024-08-15 17:11:42,252 : INFO : Current training batch loss: 0.6680 in epoch 2
2024-08-15 17:11:43,066 : INFO : Current training batch loss: 0.6032 in epoch 2
2024-08-15 17:11:43,881 : INFO : Current training batch loss: 0.5788 in epoch 2
2024-08-15 17:11:44,696 : INFO : Current training batch loss: 0.4226 in epoch 2
2024-08-15 17:11:45,048 : INFO : Epoch finished, average loss over training batches: 0.5689
2024-08-15 17:11:45,048 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:45,048 : INFO : Training metrics:
2024-08-15 17:11:45,048 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:45,052 : INFO : Accuracy: 0.7865
2024-08-15 17:11:45,052 : INFO : Precision score for label_class 0: 0.7785
2024-08-15 17:11:45,052 : INFO : Precision score for label_class 1: 0.8444
2024-08-15 17:11:45,052 : INFO : Precision score for label_class 2: 0.6586
2024-08-15 17:11:45,052 : INFO : Recall score for label_class 0: 0.3537
2024-08-15 17:11:45,052 : INFO : Recall score for label_class 1: 0.9230
2024-08-15 17:11:45,052 : INFO : Recall score for label_class 2: 0.6838
2024-08-15 17:11:45,052 : INFO : Average F1 score: 0.6798
2024-08-15 17:11:45,517 : INFO : Average loss over validation batches: 0.4332
2024-08-15 17:11:45,518 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:45,518 : INFO : Validation metrics:
2024-08-15 17:11:45,518 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:45,521 : INFO : Accuracy: 0.8533
2024-08-15 17:11:45,521 : INFO : Precision score for label_class 0: 0.7333
2024-08-15 17:11:45,521 : INFO : Precision score for label_class 1: 0.8842
2024-08-15 17:11:45,521 : INFO : Precision score for label_class 2: 0.8395
2024-08-15 17:11:45,521 : INFO : Recall score for label_class 0: 0.7674
2024-08-15 17:11:45,521 : INFO : Recall score for label_class 1: 0.9350
2024-08-15 17:11:45,521 : INFO : Recall score for label_class 2: 0.7196
2024-08-15 17:11:45,521 : INFO : Average F1 score: 0.8113
2024-08-15 17:11:45,521 : INFO : Validation metric decreased (0.695958 --> 0.433153).  Saving model ...
2024-08-15 17:11:45,619 : INFO : Starting epoch 3
2024-08-15 17:11:46,073 : INFO : Current training batch loss: 0.3162 in epoch 3
2024-08-15 17:11:46,887 : INFO : Current training batch loss: 0.4281 in epoch 3
2024-08-15 17:11:47,702 : INFO : Current training batch loss: 0.2692 in epoch 3
2024-08-15 17:11:48,518 : INFO : Current training batch loss: 0.2003 in epoch 3
2024-08-15 17:11:49,071 : INFO : Epoch finished, average loss over training batches: 0.3313
2024-08-15 17:11:49,071 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:49,071 : INFO : Training metrics:
2024-08-15 17:11:49,071 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:49,075 : INFO : Accuracy: 0.8984
2024-08-15 17:11:49,075 : INFO : Precision score for label_class 0: 0.8134
2024-08-15 17:11:49,075 : INFO : Precision score for label_class 1: 0.9271
2024-08-15 17:11:49,075 : INFO : Precision score for label_class 2: 0.8741
2024-08-15 17:11:49,075 : INFO : Recall score for label_class 0: 0.8506
2024-08-15 17:11:49,075 : INFO : Recall score for label_class 1: 0.9392
2024-08-15 17:11:49,075 : INFO : Recall score for label_class 2: 0.8327
2024-08-15 17:11:49,075 : INFO : Average F1 score: 0.8725
2024-08-15 17:11:49,540 : INFO : Average loss over validation batches: 0.3656
2024-08-15 17:11:49,540 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:49,540 : INFO : Validation metrics:
2024-08-15 17:11:49,540 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:49,543 : INFO : Accuracy: 0.8667
2024-08-15 17:11:49,543 : INFO : Precision score for label_class 0: 0.8590
2024-08-15 17:11:49,543 : INFO : Precision score for label_class 1: 0.8952
2024-08-15 17:11:49,543 : INFO : Precision score for label_class 2: 0.8023
2024-08-15 17:11:49,543 : INFO : Recall score for label_class 0: 0.7791
2024-08-15 17:11:49,543 : INFO : Recall score for label_class 1: 0.9400
2024-08-15 17:11:49,543 : INFO : Recall score for label_class 2: 0.7513
2024-08-15 17:11:49,543 : INFO : Average F1 score: 0.8367
2024-08-15 17:11:49,543 : INFO : Validation metric decreased (0.433153 --> 0.365601).  Saving model ...
2024-08-15 17:11:49,645 : INFO : Starting epoch 4
2024-08-15 17:11:49,898 : INFO : Current training batch loss: 0.4080 in epoch 4
2024-08-15 17:11:50,713 : INFO : Current training batch loss: 0.3224 in epoch 4
2024-08-15 17:11:51,528 : INFO : Current training batch loss: 0.2526 in epoch 4
2024-08-15 17:11:52,347 : INFO : Current training batch loss: 0.1318 in epoch 4
2024-08-15 17:11:53,204 : INFO : Epoch finished, average loss over training batches: 0.2018
2024-08-15 17:11:53,205 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:53,205 : INFO : Training metrics:
2024-08-15 17:11:53,205 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:53,208 : INFO : Accuracy: 0.9437
2024-08-15 17:11:53,208 : INFO : Precision score for label_class 0: 0.8649
2024-08-15 17:11:53,208 : INFO : Precision score for label_class 1: 0.9617
2024-08-15 17:11:53,208 : INFO : Precision score for label_class 2: 0.9413
2024-08-15 17:11:53,208 : INFO : Recall score for label_class 0: 0.9177
2024-08-15 17:11:53,208 : INFO : Recall score for label_class 1: 0.9659
2024-08-15 17:11:53,208 : INFO : Recall score for label_class 2: 0.9078
2024-08-15 17:11:53,208 : INFO : Average F1 score: 0.9262
2024-08-15 17:11:53,675 : INFO : Average loss over validation batches: 0.3765
2024-08-15 17:11:53,675 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:53,675 : INFO : Validation metrics:
2024-08-15 17:11:53,675 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:53,677 : INFO : Accuracy: 0.8622
2024-08-15 17:11:53,677 : INFO : Precision score for label_class 0: 0.7700
2024-08-15 17:11:53,677 : INFO : Precision score for label_class 1: 0.9375
2024-08-15 17:11:53,677 : INFO : Precision score for label_class 2: 0.7729
2024-08-15 17:11:53,677 : INFO : Recall score for label_class 0: 0.8953
2024-08-15 17:11:53,677 : INFO : Recall score for label_class 1: 0.8625
2024-08-15 17:11:53,677 : INFO : Recall score for label_class 2: 0.8466
2024-08-15 17:11:53,677 : INFO : Average F1 score: 0.8448
2024-08-15 17:11:53,677 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:11:53,678 : INFO : Starting epoch 5
2024-08-15 17:11:53,728 : INFO : Current training batch loss: 0.1193 in epoch 5
2024-08-15 17:11:54,558 : INFO : Current training batch loss: 0.2139 in epoch 5
2024-08-15 17:11:55,396 : INFO : Current training batch loss: 0.0643 in epoch 5
2024-08-15 17:11:56,237 : INFO : Current training batch loss: 0.0998 in epoch 5
2024-08-15 17:11:57,077 : INFO : Current training batch loss: 0.0327 in epoch 5
2024-08-15 17:11:57,234 : INFO : Epoch finished, average loss over training batches: 0.1332
2024-08-15 17:11:57,234 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:57,234 : INFO : Training metrics:
2024-08-15 17:11:57,234 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:57,238 : INFO : Accuracy: 0.9659
2024-08-15 17:11:57,238 : INFO : Precision score for label_class 0: 0.8920
2024-08-15 17:11:57,238 : INFO : Precision score for label_class 1: 0.9807
2024-08-15 17:11:57,238 : INFO : Precision score for label_class 2: 0.9690
2024-08-15 17:11:57,238 : INFO : Recall score for label_class 0: 0.9573
2024-08-15 17:11:57,238 : INFO : Recall score for label_class 1: 0.9758
2024-08-15 17:11:57,238 : INFO : Recall score for label_class 2: 0.9486
2024-08-15 17:11:57,238 : INFO : Average F1 score: 0.9535
2024-08-15 17:11:57,704 : INFO : Average loss over validation batches: 0.3732
2024-08-15 17:11:57,704 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:57,704 : INFO : Validation metrics:
2024-08-15 17:11:57,704 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:11:57,707 : INFO : Accuracy: 0.8741
2024-08-15 17:11:57,707 : INFO : Precision score for label_class 0: 0.8211
2024-08-15 17:11:57,707 : INFO : Precision score for label_class 1: 0.9144
2024-08-15 17:11:57,707 : INFO : Precision score for label_class 2: 0.8142
2024-08-15 17:11:57,707 : INFO : Recall score for label_class 0: 0.9070
2024-08-15 17:11:57,707 : INFO : Recall score for label_class 1: 0.9075
2024-08-15 17:11:57,707 : INFO : Recall score for label_class 2: 0.7884
2024-08-15 17:11:57,707 : INFO : Average F1 score: 0.8580
2024-08-15 17:11:57,707 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:11:57,707 : INFO : Starting epoch 6
2024-08-15 17:11:58,372 : INFO : Current training batch loss: 0.1631 in epoch 6
2024-08-15 17:11:59,212 : INFO : Current training batch loss: 0.0776 in epoch 6
2024-08-15 17:12:00,052 : INFO : Current training batch loss: 0.0314 in epoch 6
2024-08-15 17:12:00,885 : INFO : Current training batch loss: 0.0200 in epoch 6
2024-08-15 17:12:01,245 : INFO : Epoch finished, average loss over training batches: 0.0945
2024-08-15 17:12:01,245 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:01,245 : INFO : Training metrics:
2024-08-15 17:12:01,245 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:01,252 : INFO : Accuracy: 0.9755
2024-08-15 17:12:01,252 : INFO : Precision score for label_class 0: 0.9195
2024-08-15 17:12:01,252 : INFO : Precision score for label_class 1: 0.9882
2024-08-15 17:12:01,252 : INFO : Precision score for label_class 2: 0.9745
2024-08-15 17:12:01,252 : INFO : Recall score for label_class 0: 0.9756
2024-08-15 17:12:01,252 : INFO : Recall score for label_class 1: 0.9839
2024-08-15 17:12:01,252 : INFO : Recall score for label_class 2: 0.9578
2024-08-15 17:12:01,252 : INFO : Average F1 score: 0.9663
2024-08-15 17:12:01,718 : INFO : Average loss over validation batches: 0.4425
2024-08-15 17:12:01,718 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:01,718 : INFO : Validation metrics:
2024-08-15 17:12:01,718 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:01,721 : INFO : Accuracy: 0.8504
2024-08-15 17:12:01,721 : INFO : Precision score for label_class 0: 0.7778
2024-08-15 17:12:01,721 : INFO : Precision score for label_class 1: 0.9356
2024-08-15 17:12:01,721 : INFO : Precision score for label_class 2: 0.7443
2024-08-15 17:12:01,721 : INFO : Recall score for label_class 0: 0.8953
2024-08-15 17:12:01,721 : INFO : Recall score for label_class 1: 0.8350
2024-08-15 17:12:01,721 : INFO : Recall score for label_class 2: 0.8624
2024-08-15 17:12:01,721 : INFO : Average F1 score: 0.8380
2024-08-15 17:12:01,721 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:12:01,721 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:12:01,755 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:12:02,255 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:02,255 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:12:02,255 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:02,258 : INFO : Accuracy: 0.8667
2024-08-15 17:12:02,258 : INFO : Precision score for label_class 0: 0.8590
2024-08-15 17:12:02,258 : INFO : Precision score for label_class 1: 0.8952
2024-08-15 17:12:02,258 : INFO : Precision score for label_class 2: 0.8023
2024-08-15 17:12:02,258 : INFO : Recall score for label_class 0: 0.7791
2024-08-15 17:12:02,258 : INFO : Recall score for label_class 1: 0.9400
2024-08-15 17:12:02,258 : INFO : Recall score for label_class 2: 0.7513
2024-08-15 17:12:02,258 : INFO : Average F1 score: 0.8367
2024-08-15 17:12:02,258 : INFO : Determined score from best model, ending training.
2024-08-15 17:12:02,259 : INFO : Split 3 is finished, the score is: 0.8367
2024-08-15 17:12:02,260 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:02,260 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:02,260 : INFO : Starting training for split 4
2024-08-15 17:12:02,273 : INFO : Starting to tokenize the sequences.
2024-08-15 17:12:02,279 : INFO : Tokenization is finished.
2024-08-15 17:12:02,296 : INFO : Starting to tokenize the sequences.
2024-08-15 17:12:02,301 : INFO : Tokenization is finished.
2024-08-15 17:12:02,306 : INFO : Counting occurences of labels...
2024-08-15 17:12:02,307 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 327, 1621,  751]))
2024-08-15 17:12:02,307 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 87, 390, 197]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:12:02,353 : INFO : Starting epoch 1
2024-08-15 17:12:02,405 : INFO : Current training batch loss: 1.0980 in epoch 1
2024-08-15 17:12:03,243 : INFO : Current training batch loss: 1.0635 in epoch 1
2024-08-15 17:12:04,083 : INFO : Current training batch loss: 0.9285 in epoch 1
2024-08-15 17:12:04,914 : INFO : Current training batch loss: 0.8131 in epoch 1
2024-08-15 17:12:05,753 : INFO : Current training batch loss: 0.7120 in epoch 1
2024-08-15 17:12:05,905 : INFO : Epoch finished, average loss over training batches: 0.9092
2024-08-15 17:12:05,906 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:05,906 : INFO : Training metrics:
2024-08-15 17:12:05,906 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:05,913 : INFO : Accuracy: 0.6169
2024-08-15 17:12:05,913 : INFO : Precision score for label_class 0: 0.1477
2024-08-15 17:12:05,913 : INFO : Precision score for label_class 1: 0.6628
2024-08-15 17:12:05,913 : INFO : Precision score for label_class 2: 0.5470
2024-08-15 17:12:05,913 : INFO : Recall score for label_class 0: 0.0795
2024-08-15 17:12:05,913 : INFO : Recall score for label_class 1: 0.9143
2024-08-15 17:12:05,913 : INFO : Recall score for label_class 2: 0.2091
2024-08-15 17:12:05,913 : INFO : Average F1 score: 0.3915
2024-08-15 17:12:06,379 : INFO : Average loss over validation batches: 0.6876
2024-08-15 17:12:06,379 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:06,379 : INFO : Validation metrics:
2024-08-15 17:12:06,379 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:06,383 : INFO : Accuracy: 0.7448
2024-08-15 17:12:06,383 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:12:06,383 : INFO : Precision score for label_class 1: 0.8314
2024-08-15 17:12:06,383 : INFO : Precision score for label_class 2: 0.5892
2024-08-15 17:12:06,383 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:12:06,383 : INFO : Recall score for label_class 1: 0.9231
2024-08-15 17:12:06,383 : INFO : Recall score for label_class 2: 0.7208
2024-08-15 17:12:06,383 : INFO : Average F1 score: 0.5077
2024-08-15 17:12:06,383 : INFO : Validation metric decreased (inf --> 0.687620).  Saving model ...
2024-08-15 17:12:06,491 : INFO : Starting epoch 2
2024-08-15 17:12:07,165 : INFO : Current training batch loss: 0.6671 in epoch 2
2024-08-15 17:12:08,007 : INFO : Current training batch loss: 0.4899 in epoch 2
2024-08-15 17:12:08,835 : INFO : Current training batch loss: 0.4026 in epoch 2
2024-08-15 17:12:09,669 : INFO : Current training batch loss: 0.3537 in epoch 2
2024-08-15 17:12:10,033 : INFO : Epoch finished, average loss over training batches: 0.5331
2024-08-15 17:12:10,033 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:10,033 : INFO : Training metrics:
2024-08-15 17:12:10,033 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:10,041 : INFO : Accuracy: 0.8059
2024-08-15 17:12:10,041 : INFO : Precision score for label_class 0: 0.8299
2024-08-15 17:12:10,041 : INFO : Precision score for label_class 1: 0.8595
2024-08-15 17:12:10,041 : INFO : Precision score for label_class 2: 0.6826
2024-08-15 17:12:10,041 : INFO : Recall score for label_class 0: 0.3731
2024-08-15 17:12:10,041 : INFO : Recall score for label_class 1: 0.9321
2024-08-15 17:12:10,041 : INFO : Recall score for label_class 2: 0.7217
2024-08-15 17:12:10,041 : INFO : Average F1 score: 0.7036
2024-08-15 17:12:10,508 : INFO : Average loss over validation batches: 0.4183
2024-08-15 17:12:10,508 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:10,509 : INFO : Validation metrics:
2024-08-15 17:12:10,509 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:10,512 : INFO : Accuracy: 0.8501
2024-08-15 17:12:10,512 : INFO : Precision score for label_class 0: 0.6857
2024-08-15 17:12:10,512 : INFO : Precision score for label_class 1: 0.8995
2024-08-15 17:12:10,512 : INFO : Precision score for label_class 2: 0.8363
2024-08-15 17:12:10,512 : INFO : Recall score for label_class 0: 0.8276
2024-08-15 17:12:10,512 : INFO : Recall score for label_class 1: 0.9179
2024-08-15 17:12:10,512 : INFO : Recall score for label_class 2: 0.7259
2024-08-15 17:12:10,513 : INFO : Average F1 score: 0.8119
2024-08-15 17:12:10,513 : INFO : Validation metric decreased (0.687620 --> 0.418327).  Saving model ...
2024-08-15 17:12:10,609 : INFO : Starting epoch 3
2024-08-15 17:12:11,073 : INFO : Current training batch loss: 0.3155 in epoch 3
2024-08-15 17:12:11,885 : INFO : Current training batch loss: 0.4078 in epoch 3
2024-08-15 17:12:12,712 : INFO : Current training batch loss: 0.3138 in epoch 3
2024-08-15 17:12:13,533 : INFO : Current training batch loss: 0.1992 in epoch 3
2024-08-15 17:12:14,087 : INFO : Epoch finished, average loss over training batches: 0.3133
2024-08-15 17:12:14,088 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:14,088 : INFO : Training metrics:
2024-08-15 17:12:14,088 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:14,092 : INFO : Accuracy: 0.8970
2024-08-15 17:12:14,092 : INFO : Precision score for label_class 0: 0.8023
2024-08-15 17:12:14,092 : INFO : Precision score for label_class 1: 0.9319
2024-08-15 17:12:14,092 : INFO : Precision score for label_class 2: 0.8639
2024-08-15 17:12:14,092 : INFO : Recall score for label_class 0: 0.8563
2024-08-15 17:12:14,092 : INFO : Recall score for label_class 1: 0.9371
2024-08-15 17:12:14,092 : INFO : Recall score for label_class 2: 0.8282
2024-08-15 17:12:14,092 : INFO : Average F1 score: 0.8695
2024-08-15 17:12:14,562 : INFO : Average loss over validation batches: 0.3826
2024-08-15 17:12:14,562 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:14,562 : INFO : Validation metrics:
2024-08-15 17:12:14,562 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:14,566 : INFO : Accuracy: 0.8591
2024-08-15 17:12:14,566 : INFO : Precision score for label_class 0: 0.8553
2024-08-15 17:12:14,566 : INFO : Precision score for label_class 1: 0.9110
2024-08-15 17:12:14,566 : INFO : Precision score for label_class 2: 0.7685
2024-08-15 17:12:14,566 : INFO : Recall score for label_class 0: 0.7471
2024-08-15 17:12:14,566 : INFO : Recall score for label_class 1: 0.8923
2024-08-15 17:12:14,566 : INFO : Recall score for label_class 2: 0.8426
2024-08-15 17:12:14,566 : INFO : Average F1 score: 0.8343
2024-08-15 17:12:14,566 : INFO : Validation metric decreased (0.418327 --> 0.382612).  Saving model ...
2024-08-15 17:12:14,675 : INFO : Starting epoch 4
2024-08-15 17:12:14,927 : INFO : Current training batch loss: 0.3794 in epoch 4
2024-08-15 17:12:15,745 : INFO : Current training batch loss: 0.2459 in epoch 4
2024-08-15 17:12:16,574 : INFO : Current training batch loss: 0.2069 in epoch 4
2024-08-15 17:12:17,394 : INFO : Current training batch loss: 0.1403 in epoch 4
2024-08-15 17:12:18,155 : INFO : Epoch finished, average loss over training batches: 0.1833
2024-08-15 17:12:18,156 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:18,156 : INFO : Training metrics:
2024-08-15 17:12:18,156 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:18,160 : INFO : Accuracy: 0.9478
2024-08-15 17:12:18,160 : INFO : Precision score for label_class 0: 0.8794
2024-08-15 17:12:18,160 : INFO : Precision score for label_class 1: 0.9715
2024-08-15 17:12:18,160 : INFO : Precision score for label_class 2: 0.9273
2024-08-15 17:12:18,160 : INFO : Recall score for label_class 0: 0.9144
2024-08-15 17:12:18,160 : INFO : Recall score for label_class 1: 0.9685
2024-08-15 17:12:18,160 : INFO : Recall score for label_class 2: 0.9174
2024-08-15 17:12:18,160 : INFO : Average F1 score: 0.9296
2024-08-15 17:12:18,627 : INFO : Average loss over validation batches: 0.3934
2024-08-15 17:12:18,627 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:18,627 : INFO : Validation metrics:
2024-08-15 17:12:18,627 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:18,630 : INFO : Accuracy: 0.8709
2024-08-15 17:12:18,630 : INFO : Precision score for label_class 0: 0.8293
2024-08-15 17:12:18,630 : INFO : Precision score for label_class 1: 0.9235
2024-08-15 17:12:18,630 : INFO : Precision score for label_class 2: 0.7934
2024-08-15 17:12:18,630 : INFO : Recall score for label_class 0: 0.7816
2024-08-15 17:12:18,630 : INFO : Recall score for label_class 1: 0.8974
2024-08-15 17:12:18,630 : INFO : Recall score for label_class 2: 0.8579
2024-08-15 17:12:18,630 : INFO : Average F1 score: 0.8465
2024-08-15 17:12:18,630 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:12:18,631 : INFO : Starting epoch 5
2024-08-15 17:12:18,682 : INFO : Current training batch loss: 0.1008 in epoch 5
2024-08-15 17:12:19,509 : INFO : Current training batch loss: 0.1695 in epoch 5
2024-08-15 17:12:20,331 : INFO : Current training batch loss: 0.0419 in epoch 5
2024-08-15 17:12:21,149 : INFO : Current training batch loss: 0.0612 in epoch 5
2024-08-15 17:12:21,970 : INFO : Current training batch loss: 0.3132 in epoch 5
2024-08-15 17:12:22,125 : INFO : Epoch finished, average loss over training batches: 0.1210
2024-08-15 17:12:22,125 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:22,125 : INFO : Training metrics:
2024-08-15 17:12:22,125 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:22,129 : INFO : Accuracy: 0.9700
2024-08-15 17:12:22,129 : INFO : Precision score for label_class 0: 0.9142
2024-08-15 17:12:22,129 : INFO : Precision score for label_class 1: 0.9839
2024-08-15 17:12:22,129 : INFO : Precision score for label_class 2: 0.9650
2024-08-15 17:12:22,129 : INFO : Recall score for label_class 0: 0.9450
2024-08-15 17:12:22,129 : INFO : Recall score for label_class 1: 0.9821
2024-08-15 17:12:22,129 : INFO : Recall score for label_class 2: 0.9547
2024-08-15 17:12:22,129 : INFO : Average F1 score: 0.9574
2024-08-15 17:12:22,596 : INFO : Average loss over validation batches: 0.3965
2024-08-15 17:12:22,596 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:22,596 : INFO : Validation metrics:
2024-08-15 17:12:22,597 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:22,600 : INFO : Accuracy: 0.8798
2024-08-15 17:12:22,600 : INFO : Precision score for label_class 0: 0.7872
2024-08-15 17:12:22,600 : INFO : Precision score for label_class 1: 0.9133
2024-08-15 17:12:22,600 : INFO : Precision score for label_class 2: 0.8564
2024-08-15 17:12:22,600 : INFO : Recall score for label_class 0: 0.8506
2024-08-15 17:12:22,600 : INFO : Recall score for label_class 1: 0.9179
2024-08-15 17:12:22,600 : INFO : Recall score for label_class 2: 0.8173
2024-08-15 17:12:22,600 : INFO : Average F1 score: 0.8565
2024-08-15 17:12:22,600 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:12:22,600 : INFO : Starting epoch 6
2024-08-15 17:12:23,269 : INFO : Current training batch loss: 0.1214 in epoch 6
2024-08-15 17:12:24,089 : INFO : Current training batch loss: 0.1232 in epoch 6
2024-08-15 17:12:24,909 : INFO : Current training batch loss: 0.0310 in epoch 6
2024-08-15 17:12:25,729 : INFO : Current training batch loss: 0.0296 in epoch 6
2024-08-15 17:12:26,080 : INFO : Epoch finished, average loss over training batches: 0.0946
2024-08-15 17:12:26,081 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:26,081 : INFO : Training metrics:
2024-08-15 17:12:26,081 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:26,086 : INFO : Accuracy: 0.9763
2024-08-15 17:12:26,086 : INFO : Precision score for label_class 0: 0.9403
2024-08-15 17:12:26,086 : INFO : Precision score for label_class 1: 0.9882
2024-08-15 17:12:26,086 : INFO : Precision score for label_class 2: 0.9666
2024-08-15 17:12:26,086 : INFO : Recall score for label_class 0: 0.9633
2024-08-15 17:12:26,086 : INFO : Recall score for label_class 1: 0.9846
2024-08-15 17:12:26,086 : INFO : Recall score for label_class 2: 0.9640
2024-08-15 17:12:26,086 : INFO : Average F1 score: 0.9678
2024-08-15 17:12:26,556 : INFO : Average loss over validation batches: 0.4280
2024-08-15 17:12:26,556 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:26,556 : INFO : Validation metrics:
2024-08-15 17:12:26,556 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:26,560 : INFO : Accuracy: 0.8724
2024-08-15 17:12:26,560 : INFO : Precision score for label_class 0: 0.7576
2024-08-15 17:12:26,560 : INFO : Precision score for label_class 1: 0.9231
2024-08-15 17:12:26,560 : INFO : Precision score for label_class 2: 0.8333
2024-08-15 17:12:26,560 : INFO : Recall score for label_class 0: 0.8621
2024-08-15 17:12:26,560 : INFO : Recall score for label_class 1: 0.8923
2024-08-15 17:12:26,560 : INFO : Recall score for label_class 2: 0.8376
2024-08-15 17:12:26,560 : INFO : Average F1 score: 0.8498
2024-08-15 17:12:26,560 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:12:26,560 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:12:26,594 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:12:27,099 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:27,099 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:12:27,099 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:27,103 : INFO : Accuracy: 0.8591
2024-08-15 17:12:27,103 : INFO : Precision score for label_class 0: 0.8553
2024-08-15 17:12:27,103 : INFO : Precision score for label_class 1: 0.9110
2024-08-15 17:12:27,103 : INFO : Precision score for label_class 2: 0.7685
2024-08-15 17:12:27,103 : INFO : Recall score for label_class 0: 0.7471
2024-08-15 17:12:27,103 : INFO : Recall score for label_class 1: 0.8923
2024-08-15 17:12:27,103 : INFO : Recall score for label_class 2: 0.8426
2024-08-15 17:12:27,103 : INFO : Average F1 score: 0.8343
2024-08-15 17:12:27,103 : INFO : Determined score from best model, ending training.
2024-08-15 17:12:27,104 : INFO : Split 4 is finished, the score is: 0.8343
2024-08-15 17:12:27,104 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:27,104 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:27,104 : INFO : Starting training for split 5
2024-08-15 17:12:27,119 : INFO : Starting to tokenize the sequences.
2024-08-15 17:12:27,124 : INFO : Tokenization is finished.
2024-08-15 17:12:27,141 : INFO : Starting to tokenize the sequences.
2024-08-15 17:12:27,146 : INFO : Tokenization is finished.
2024-08-15 17:12:27,151 : INFO : Counting occurences of labels...
2024-08-15 17:12:27,152 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 330, 1615,  754]))
2024-08-15 17:12:27,153 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 84, 396, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:12:27,197 : INFO : Starting epoch 1
2024-08-15 17:12:27,249 : INFO : Current training batch loss: 1.0944 in epoch 1
2024-08-15 17:12:28,067 : INFO : Current training batch loss: 1.0486 in epoch 1
2024-08-15 17:12:28,879 : INFO : Current training batch loss: 0.9255 in epoch 1
2024-08-15 17:12:29,693 : INFO : Current training batch loss: 0.8410 in epoch 1
2024-08-15 17:12:30,508 : INFO : Current training batch loss: 0.7765 in epoch 1
2024-08-15 17:12:30,659 : INFO : Epoch finished, average loss over training batches: 0.9126
2024-08-15 17:12:30,659 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:30,659 : INFO : Training metrics:
2024-08-15 17:12:30,659 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:30,670 : INFO : Accuracy: 0.6295
2024-08-15 17:12:30,670 : INFO : Precision score for label_class 0: 0.0769
2024-08-15 17:12:30,670 : INFO : Precision score for label_class 1: 0.6468
2024-08-15 17:12:30,670 : INFO : Precision score for label_class 2: 0.5568
2024-08-15 17:12:30,670 : INFO : Recall score for label_class 0: 0.0091
2024-08-15 17:12:30,670 : INFO : Recall score for label_class 1: 0.9560
2024-08-15 17:12:30,670 : INFO : Recall score for label_class 2: 0.2016
2024-08-15 17:12:30,670 : INFO : Average F1 score: 0.3613
2024-08-15 17:12:31,135 : INFO : Average loss over validation batches: 0.6734
2024-08-15 17:12:31,136 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:31,136 : INFO : Validation metrics:
2024-08-15 17:12:31,136 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:31,139 : INFO : Accuracy: 0.7270
2024-08-15 17:12:31,139 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:12:31,139 : INFO : Precision score for label_class 1: 0.8106
2024-08-15 17:12:31,139 : INFO : Precision score for label_class 2: 0.5545
2024-08-15 17:12:31,139 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:12:31,139 : INFO : Recall score for label_class 1: 0.9293
2024-08-15 17:12:31,139 : INFO : Recall score for label_class 2: 0.6289
2024-08-15 17:12:31,139 : INFO : Average F1 score: 0.4851
2024-08-15 17:12:31,139 : INFO : Validation metric decreased (inf --> 0.673425).  Saving model ...
2024-08-15 17:12:31,239 : INFO : Starting epoch 2
2024-08-15 17:12:31,893 : INFO : Current training batch loss: 0.6263 in epoch 2
2024-08-15 17:12:32,707 : INFO : Current training batch loss: 0.5385 in epoch 2
2024-08-15 17:12:33,521 : INFO : Current training batch loss: 0.3424 in epoch 2
2024-08-15 17:12:34,336 : INFO : Current training batch loss: 0.4402 in epoch 2
2024-08-15 17:12:34,689 : INFO : Epoch finished, average loss over training batches: 0.5315
2024-08-15 17:12:34,689 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:34,689 : INFO : Training metrics:
2024-08-15 17:12:34,689 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:34,696 : INFO : Accuracy: 0.8162
2024-08-15 17:12:34,697 : INFO : Precision score for label_class 0: 0.8040
2024-08-15 17:12:34,697 : INFO : Precision score for label_class 1: 0.8560
2024-08-15 17:12:34,697 : INFO : Precision score for label_class 2: 0.7242
2024-08-15 17:12:34,697 : INFO : Recall score for label_class 0: 0.4848
2024-08-15 17:12:34,697 : INFO : Recall score for label_class 1: 0.9350
2024-08-15 17:12:34,697 : INFO : Recall score for label_class 2: 0.7069
2024-08-15 17:12:34,697 : INFO : Average F1 score: 0.7380
2024-08-15 17:12:35,162 : INFO : Average loss over validation batches: 0.4667
2024-08-15 17:12:35,163 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:35,163 : INFO : Validation metrics:
2024-08-15 17:12:35,163 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:35,166 : INFO : Accuracy: 0.8264
2024-08-15 17:12:35,166 : INFO : Precision score for label_class 0: 0.8000
2024-08-15 17:12:35,166 : INFO : Precision score for label_class 1: 0.8367
2024-08-15 17:12:35,166 : INFO : Precision score for label_class 2: 0.8086
2024-08-15 17:12:35,166 : INFO : Recall score for label_class 0: 0.6190
2024-08-15 17:12:35,166 : INFO : Recall score for label_class 1: 0.9444
2024-08-15 17:12:35,166 : INFO : Recall score for label_class 2: 0.6753
2024-08-15 17:12:35,166 : INFO : Average F1 score: 0.7737
2024-08-15 17:12:35,166 : INFO : Validation metric decreased (0.673425 --> 0.466736).  Saving model ...
2024-08-15 17:12:35,265 : INFO : Starting epoch 3
2024-08-15 17:12:35,718 : INFO : Current training batch loss: 0.3173 in epoch 3
2024-08-15 17:12:36,533 : INFO : Current training batch loss: 0.4452 in epoch 3
2024-08-15 17:12:37,348 : INFO : Current training batch loss: 0.2255 in epoch 3
2024-08-15 17:12:38,162 : INFO : Current training batch loss: 0.2406 in epoch 3
2024-08-15 17:12:38,715 : INFO : Epoch finished, average loss over training batches: 0.3126
2024-08-15 17:12:38,715 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:38,715 : INFO : Training metrics:
2024-08-15 17:12:38,715 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:38,723 : INFO : Accuracy: 0.9007
2024-08-15 17:12:38,723 : INFO : Precision score for label_class 0: 0.8230
2024-08-15 17:12:38,723 : INFO : Precision score for label_class 1: 0.9297
2024-08-15 17:12:38,723 : INFO : Precision score for label_class 2: 0.8715
2024-08-15 17:12:38,723 : INFO : Recall score for label_class 0: 0.8455
2024-08-15 17:12:38,723 : INFO : Recall score for label_class 1: 0.9418
2024-08-15 17:12:38,723 : INFO : Recall score for label_class 2: 0.8369
2024-08-15 17:12:38,723 : INFO : Average F1 score: 0.8745
2024-08-15 17:12:39,190 : INFO : Average loss over validation batches: 0.4008
2024-08-15 17:12:39,190 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:39,190 : INFO : Validation metrics:
2024-08-15 17:12:39,190 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:39,193 : INFO : Accuracy: 0.8531
2024-08-15 17:12:39,193 : INFO : Precision score for label_class 0: 0.8116
2024-08-15 17:12:39,193 : INFO : Precision score for label_class 1: 0.8819
2024-08-15 17:12:39,193 : INFO : Precision score for label_class 2: 0.8053
2024-08-15 17:12:39,193 : INFO : Recall score for label_class 0: 0.6667
2024-08-15 17:12:39,193 : INFO : Recall score for label_class 1: 0.9242
2024-08-15 17:12:39,193 : INFO : Recall score for label_class 2: 0.7887
2024-08-15 17:12:39,193 : INFO : Average F1 score: 0.8105
2024-08-15 17:12:39,193 : INFO : Validation metric decreased (0.466736 --> 0.400824).  Saving model ...
2024-08-15 17:12:39,296 : INFO : Starting epoch 4
2024-08-15 17:12:39,548 : INFO : Current training batch loss: 0.3794 in epoch 4
2024-08-15 17:12:40,367 : INFO : Current training batch loss: 0.2826 in epoch 4
2024-08-15 17:12:41,196 : INFO : Current training batch loss: 0.1830 in epoch 4
2024-08-15 17:12:42,026 : INFO : Current training batch loss: 0.1164 in epoch 4
2024-08-15 17:12:42,788 : INFO : Epoch finished, average loss over training batches: 0.1977
2024-08-15 17:12:42,789 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:42,789 : INFO : Training metrics:
2024-08-15 17:12:42,789 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:42,796 : INFO : Accuracy: 0.9400
2024-08-15 17:12:42,796 : INFO : Precision score for label_class 0: 0.8765
2024-08-15 17:12:42,796 : INFO : Precision score for label_class 1: 0.9611
2024-08-15 17:12:42,796 : INFO : Precision score for label_class 2: 0.9230
2024-08-15 17:12:42,796 : INFO : Recall score for label_class 0: 0.9030
2024-08-15 17:12:42,796 : INFO : Recall score for label_class 1: 0.9635
2024-08-15 17:12:42,796 : INFO : Recall score for label_class 2: 0.9058
2024-08-15 17:12:42,796 : INFO : Average F1 score: 0.9221
2024-08-15 17:12:43,262 : INFO : Average loss over validation batches: 0.4088
2024-08-15 17:12:43,262 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:43,262 : INFO : Validation metrics:
2024-08-15 17:12:43,262 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:43,266 : INFO : Accuracy: 0.8605
2024-08-15 17:12:43,266 : INFO : Precision score for label_class 0: 0.8158
2024-08-15 17:12:43,266 : INFO : Precision score for label_class 1: 0.8825
2024-08-15 17:12:43,266 : INFO : Precision score for label_class 2: 0.8287
2024-08-15 17:12:43,266 : INFO : Recall score for label_class 0: 0.7381
2024-08-15 17:12:43,266 : INFO : Recall score for label_class 1: 0.9293
2024-08-15 17:12:43,266 : INFO : Recall score for label_class 2: 0.7732
2024-08-15 17:12:43,266 : INFO : Average F1 score: 0.8268
2024-08-15 17:12:43,266 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:12:43,266 : INFO : Starting epoch 5
2024-08-15 17:12:43,316 : INFO : Current training batch loss: 0.1231 in epoch 5
2024-08-15 17:12:44,149 : INFO : Current training batch loss: 0.2443 in epoch 5
2024-08-15 17:12:44,966 : INFO : Current training batch loss: 0.0889 in epoch 5
2024-08-15 17:12:45,785 : INFO : Current training batch loss: 0.1227 in epoch 5
2024-08-15 17:12:46,603 : INFO : Current training batch loss: 0.0775 in epoch 5
2024-08-15 17:12:46,758 : INFO : Epoch finished, average loss over training batches: 0.1433
2024-08-15 17:12:46,758 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:46,758 : INFO : Training metrics:
2024-08-15 17:12:46,758 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:46,765 : INFO : Accuracy: 0.9596
2024-08-15 17:12:46,765 : INFO : Precision score for label_class 0: 0.8911
2024-08-15 17:12:46,765 : INFO : Precision score for label_class 1: 0.9752
2024-08-15 17:12:46,765 : INFO : Precision score for label_class 2: 0.9578
2024-08-15 17:12:46,765 : INFO : Recall score for label_class 0: 0.9424
2024-08-15 17:12:46,765 : INFO : Recall score for label_class 1: 0.9752
2024-08-15 17:12:46,765 : INFO : Recall score for label_class 2: 0.9337
2024-08-15 17:12:46,765 : INFO : Average F1 score: 0.9456
2024-08-15 17:12:47,232 : INFO : Average loss over validation batches: 0.5197
2024-08-15 17:12:47,233 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:47,233 : INFO : Validation metrics:
2024-08-15 17:12:47,233 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:47,236 : INFO : Accuracy: 0.8264
2024-08-15 17:12:47,236 : INFO : Precision score for label_class 0: 0.6531
2024-08-15 17:12:47,236 : INFO : Precision score for label_class 1: 0.9224
2024-08-15 17:12:47,236 : INFO : Precision score for label_class 2: 0.7442
2024-08-15 17:12:47,236 : INFO : Recall score for label_class 0: 0.7619
2024-08-15 17:12:47,236 : INFO : Recall score for label_class 1: 0.8409
2024-08-15 17:12:47,236 : INFO : Recall score for label_class 2: 0.8247
2024-08-15 17:12:47,236 : INFO : Average F1 score: 0.7885
2024-08-15 17:12:47,236 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:12:47,236 : INFO : Starting epoch 6
2024-08-15 17:12:47,893 : INFO : Current training batch loss: 0.0952 in epoch 6
2024-08-15 17:12:48,713 : INFO : Current training batch loss: 0.1235 in epoch 6
2024-08-15 17:12:49,538 : INFO : Current training batch loss: 0.0425 in epoch 6
2024-08-15 17:12:50,380 : INFO : Current training batch loss: 0.1146 in epoch 6
2024-08-15 17:12:50,740 : INFO : Epoch finished, average loss over training batches: 0.0920
2024-08-15 17:12:50,741 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:50,741 : INFO : Training metrics:
2024-08-15 17:12:50,741 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:50,748 : INFO : Accuracy: 0.9781
2024-08-15 17:12:50,748 : INFO : Precision score for label_class 0: 0.9326
2024-08-15 17:12:50,748 : INFO : Precision score for label_class 1: 0.9876
2024-08-15 17:12:50,748 : INFO : Precision score for label_class 2: 0.9784
2024-08-15 17:12:50,748 : INFO : Recall score for label_class 0: 0.9636
2024-08-15 17:12:50,748 : INFO : Recall score for label_class 1: 0.9889
2024-08-15 17:12:50,748 : INFO : Recall score for label_class 2: 0.9615
2024-08-15 17:12:50,748 : INFO : Average F1 score: 0.9687
2024-08-15 17:12:51,216 : INFO : Average loss over validation batches: 0.4820
2024-08-15 17:12:51,216 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:51,216 : INFO : Validation metrics:
2024-08-15 17:12:51,216 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:51,220 : INFO : Accuracy: 0.8442
2024-08-15 17:12:51,220 : INFO : Precision score for label_class 0: 0.6893
2024-08-15 17:12:51,220 : INFO : Precision score for label_class 1: 0.9256
2024-08-15 17:12:51,220 : INFO : Precision score for label_class 2: 0.7788
2024-08-15 17:12:51,220 : INFO : Recall score for label_class 0: 0.8452
2024-08-15 17:12:51,220 : INFO : Recall score for label_class 1: 0.8485
2024-08-15 17:12:51,220 : INFO : Recall score for label_class 2: 0.8351
2024-08-15 17:12:51,220 : INFO : Average F1 score: 0.8169
2024-08-15 17:12:51,220 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:12:51,220 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:12:51,252 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:12:51,755 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:51,755 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:12:51,755 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:51,758 : INFO : Accuracy: 0.8531
2024-08-15 17:12:51,758 : INFO : Precision score for label_class 0: 0.8116
2024-08-15 17:12:51,758 : INFO : Precision score for label_class 1: 0.8819
2024-08-15 17:12:51,758 : INFO : Precision score for label_class 2: 0.8053
2024-08-15 17:12:51,758 : INFO : Recall score for label_class 0: 0.6667
2024-08-15 17:12:51,758 : INFO : Recall score for label_class 1: 0.9242
2024-08-15 17:12:51,758 : INFO : Recall score for label_class 2: 0.7887
2024-08-15 17:12:51,758 : INFO : Average F1 score: 0.8105
2024-08-15 17:12:51,758 : INFO : Determined score from best model, ending training.
2024-08-15 17:12:51,760 : INFO : Split 5 is finished, the score is: 0.8105
2024-08-15 17:12:51,760 : INFO : ----------------------------------------------------------------------------------------------------
[I 2024-08-15 17:12:51,769] Trial 2 finished with value: 0.8296356404885348 and parameters: {'n_epochs': 14, 'learning_rate': 3.550493748399559e-05, 'classifier_dropout': 0.15081847146503977, 'warmup_step_fraction': 0.03783327569643663, 'use_gradient_clipping': False}. Best is trial 1 with value: 0.8513001269595835.
2024-08-15 17:12:51,770 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:51,770 : INFO : Starting training for split 1
2024-08-15 17:12:51,783 : INFO : Starting to tokenize the sequences.
2024-08-15 17:12:51,788 : INFO : Tokenization is finished.
2024-08-15 17:12:51,801 : INFO : Starting to tokenize the sequences.
2024-08-15 17:12:51,806 : INFO : Tokenization is finished.
2024-08-15 17:12:51,807 : INFO : Counting occurences of labels...
2024-08-15 17:12:51,807 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1596,  774]))
2024-08-15 17:12:51,808 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 415, 174]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:12:51,850 : INFO : Starting epoch 1
2024-08-15 17:12:51,921 : INFO : Current training batch loss: 1.0944 in epoch 1
2024-08-15 17:12:52,766 : INFO : Current training batch loss: 0.7833 in epoch 1
2024-08-15 17:12:53,590 : INFO : Current training batch loss: 0.7147 in epoch 1
2024-08-15 17:12:54,423 : INFO : Current training batch loss: 0.6459 in epoch 1
2024-08-15 17:12:55,245 : INFO : Current training batch loss: 0.5220 in epoch 1
2024-08-15 17:12:55,397 : INFO : Epoch finished, average loss over training batches: 0.7405
2024-08-15 17:12:55,398 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:55,398 : INFO : Training metrics:
2024-08-15 17:12:55,398 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:55,406 : INFO : Accuracy: 0.7027
2024-08-15 17:12:55,406 : INFO : Precision score for label_class 0: 0.5526
2024-08-15 17:12:55,406 : INFO : Precision score for label_class 1: 0.7373
2024-08-15 17:12:55,406 : INFO : Precision score for label_class 2: 0.6003
2024-08-15 17:12:55,406 : INFO : Recall score for label_class 0: 0.1280
2024-08-15 17:12:55,406 : INFO : Recall score for label_class 1: 0.9442
2024-08-15 17:12:55,406 : INFO : Recall score for label_class 2: 0.4483
2024-08-15 17:12:55,406 : INFO : Average F1 score: 0.5164
2024-08-15 17:12:55,960 : INFO : Average loss over validation batches: 0.5603
2024-08-15 17:12:55,960 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:55,960 : INFO : Validation metrics:
2024-08-15 17:12:55,960 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:55,963 : INFO : Accuracy: 0.7689
2024-08-15 17:12:55,963 : INFO : Precision score for label_class 0: 0.6000
2024-08-15 17:12:55,963 : INFO : Precision score for label_class 1: 0.8782
2024-08-15 17:12:55,963 : INFO : Precision score for label_class 2: 0.5798
2024-08-15 17:12:55,963 : INFO : Recall score for label_class 0: 0.0698
2024-08-15 17:12:55,963 : INFO : Recall score for label_class 1: 0.9036
2024-08-15 17:12:55,963 : INFO : Recall score for label_class 2: 0.7931
2024-08-15 17:12:55,963 : INFO : Average F1 score: 0.5619
2024-08-15 17:12:55,963 : INFO : Validation metric decreased (inf --> 0.560302).  Saving model ...
2024-08-15 17:12:56,071 : INFO : Starting epoch 2
2024-08-15 17:12:56,728 : INFO : Current training batch loss: 0.2479 in epoch 2
2024-08-15 17:12:57,544 : INFO : Current training batch loss: 0.4841 in epoch 2
2024-08-15 17:12:58,361 : INFO : Current training batch loss: 0.3485 in epoch 2
2024-08-15 17:12:59,178 : INFO : Current training batch loss: 0.3114 in epoch 2
2024-08-15 17:12:59,532 : INFO : Epoch finished, average loss over training batches: 0.4128
2024-08-15 17:12:59,532 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:59,532 : INFO : Training metrics:
2024-08-15 17:12:59,532 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:12:59,538 : INFO : Accuracy: 0.8721
2024-08-15 17:12:59,538 : INFO : Precision score for label_class 0: 0.7869
2024-08-15 17:12:59,538 : INFO : Precision score for label_class 1: 0.9023
2024-08-15 17:12:59,538 : INFO : Precision score for label_class 2: 0.8376
2024-08-15 17:12:59,538 : INFO : Recall score for label_class 0: 0.6982
2024-08-15 17:12:59,538 : INFO : Recall score for label_class 1: 0.9430
2024-08-15 17:12:59,538 : INFO : Recall score for label_class 2: 0.7997
2024-08-15 17:12:59,538 : INFO : Average F1 score: 0.8268
2024-08-15 17:13:00,004 : INFO : Average loss over validation batches: 0.4187
2024-08-15 17:13:00,004 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:00,004 : INFO : Validation metrics:
2024-08-15 17:13:00,004 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:00,007 : INFO : Accuracy: 0.8667
2024-08-15 17:13:00,007 : INFO : Precision score for label_class 0: 0.7475
2024-08-15 17:13:00,007 : INFO : Precision score for label_class 1: 0.9084
2024-08-15 17:13:00,007 : INFO : Precision score for label_class 2: 0.8323
2024-08-15 17:13:00,007 : INFO : Recall score for label_class 0: 0.8605
2024-08-15 17:13:00,007 : INFO : Recall score for label_class 1: 0.9084
2024-08-15 17:13:00,007 : INFO : Recall score for label_class 2: 0.7701
2024-08-15 17:13:00,007 : INFO : Average F1 score: 0.8361
2024-08-15 17:13:00,007 : INFO : Validation metric decreased (0.560302 --> 0.418738).  Saving model ...
2024-08-15 17:13:00,105 : INFO : Split 1 is finished, the score is: 0.8361
2024-08-15 17:13:00,106 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:00,106 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:00,106 : INFO : Starting training for split 2
2024-08-15 17:13:00,121 : INFO : Starting to tokenize the sequences.
2024-08-15 17:13:00,127 : INFO : Tokenization is finished.
2024-08-15 17:13:00,145 : INFO : Starting to tokenize the sequences.
2024-08-15 17:13:00,149 : INFO : Tokenization is finished.
2024-08-15 17:13:00,154 : INFO : Counting occurences of labels...
2024-08-15 17:13:00,155 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 343, 1601,  754]))
2024-08-15 17:13:00,156 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 71, 410, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:13:00,202 : INFO : Starting epoch 1
2024-08-15 17:13:00,253 : INFO : Current training batch loss: 1.1120 in epoch 1
2024-08-15 17:13:01,070 : INFO : Current training batch loss: 0.9704 in epoch 1
2024-08-15 17:13:01,887 : INFO : Current training batch loss: 0.7429 in epoch 1
2024-08-15 17:13:02,704 : INFO : Current training batch loss: 0.6170 in epoch 1
2024-08-15 17:13:03,522 : INFO : Current training batch loss: 0.5571 in epoch 1
2024-08-15 17:13:03,673 : INFO : Epoch finished, average loss over training batches: 0.7619
2024-08-15 17:13:03,673 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:03,673 : INFO : Training metrics:
2024-08-15 17:13:03,673 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:03,681 : INFO : Accuracy: 0.6946
2024-08-15 17:13:03,681 : INFO : Precision score for label_class 0: 0.4365
2024-08-15 17:13:03,681 : INFO : Precision score for label_class 1: 0.7342
2024-08-15 17:13:03,681 : INFO : Precision score for label_class 2: 0.6362
2024-08-15 17:13:03,681 : INFO : Recall score for label_class 0: 0.2507
2024-08-15 17:13:03,681 : INFO : Recall score for label_class 1: 0.9213
2024-08-15 17:13:03,681 : INFO : Recall score for label_class 2: 0.4151
2024-08-15 17:13:03,681 : INFO : Average F1 score: 0.5460
2024-08-15 17:13:04,146 : INFO : Average loss over validation batches: 0.5204
2024-08-15 17:13:04,147 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:04,147 : INFO : Validation metrics:
2024-08-15 17:13:04,147 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:04,150 : INFO : Accuracy: 0.8430
2024-08-15 17:13:04,150 : INFO : Precision score for label_class 0: 0.8298
2024-08-15 17:13:04,150 : INFO : Precision score for label_class 1: 0.8591
2024-08-15 17:13:04,150 : INFO : Precision score for label_class 2: 0.8066
2024-08-15 17:13:04,150 : INFO : Recall score for label_class 0: 0.5493
2024-08-15 17:13:04,150 : INFO : Recall score for label_class 1: 0.9366
2024-08-15 17:13:04,150 : INFO : Recall score for label_class 2: 0.7526
2024-08-15 17:13:04,150 : INFO : Average F1 score: 0.7786
2024-08-15 17:13:04,150 : INFO : Validation metric decreased (inf --> 0.520385).  Saving model ...
2024-08-15 17:13:04,252 : INFO : Starting epoch 2
2024-08-15 17:13:04,907 : INFO : Current training batch loss: 0.4923 in epoch 2
2024-08-15 17:13:05,723 : INFO : Current training batch loss: 0.4695 in epoch 2
2024-08-15 17:13:06,540 : INFO : Current training batch loss: 0.3092 in epoch 2
2024-08-15 17:13:07,357 : INFO : Current training batch loss: 0.3277 in epoch 2
2024-08-15 17:13:07,710 : INFO : Epoch finished, average loss over training batches: 0.4063
2024-08-15 17:13:07,711 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:07,711 : INFO : Training metrics:
2024-08-15 17:13:07,711 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:07,721 : INFO : Accuracy: 0.8840
2024-08-15 17:13:07,721 : INFO : Precision score for label_class 0: 0.8219
2024-08-15 17:13:07,721 : INFO : Precision score for label_class 1: 0.9052
2024-08-15 17:13:07,721 : INFO : Precision score for label_class 2: 0.8616
2024-08-15 17:13:07,721 : INFO : Recall score for label_class 0: 0.7668
2024-08-15 17:13:07,721 : INFO : Recall score for label_class 1: 0.9482
2024-08-15 17:13:07,721 : INFO : Recall score for label_class 2: 0.8011
2024-08-15 17:13:07,721 : INFO : Average F1 score: 0.8499
2024-08-15 17:13:08,186 : INFO : Average loss over validation batches: 0.4141
2024-08-15 17:13:08,186 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:08,186 : INFO : Validation metrics:
2024-08-15 17:13:08,186 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:08,190 : INFO : Accuracy: 0.8711
2024-08-15 17:13:08,190 : INFO : Precision score for label_class 0: 0.7568
2024-08-15 17:13:08,190 : INFO : Precision score for label_class 1: 0.8815
2024-08-15 17:13:08,190 : INFO : Precision score for label_class 2: 0.8951
2024-08-15 17:13:08,190 : INFO : Recall score for label_class 0: 0.7887
2024-08-15 17:13:08,190 : INFO : Recall score for label_class 1: 0.9439
2024-08-15 17:13:08,190 : INFO : Recall score for label_class 2: 0.7474
2024-08-15 17:13:08,190 : INFO : Average F1 score: 0.8329
2024-08-15 17:13:08,190 : INFO : Validation metric decreased (0.520385 --> 0.414141).  Saving model ...
2024-08-15 17:13:08,293 : INFO : Split 2 is finished, the score is: 0.8329
2024-08-15 17:13:08,293 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:08,293 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:08,293 : INFO : Starting training for split 3
2024-08-15 17:13:08,306 : INFO : Starting to tokenize the sequences.
2024-08-15 17:13:08,312 : INFO : Tokenization is finished.
2024-08-15 17:13:08,333 : INFO : Starting to tokenize the sequences.
2024-08-15 17:13:08,338 : INFO : Tokenization is finished.
2024-08-15 17:13:08,343 : INFO : Counting occurences of labels...
2024-08-15 17:13:08,343 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1611,  759]))
2024-08-15 17:13:08,344 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 400, 189]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:13:08,387 : INFO : Starting epoch 1
2024-08-15 17:13:08,439 : INFO : Current training batch loss: 1.0899 in epoch 1
2024-08-15 17:13:09,257 : INFO : Current training batch loss: 0.9300 in epoch 1
2024-08-15 17:13:10,074 : INFO : Current training batch loss: 0.7346 in epoch 1
2024-08-15 17:13:10,891 : INFO : Current training batch loss: 0.6251 in epoch 1
2024-08-15 17:13:11,708 : INFO : Current training batch loss: 0.5598 in epoch 1
2024-08-15 17:13:11,860 : INFO : Epoch finished, average loss over training batches: 0.7516
2024-08-15 17:13:11,860 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:11,860 : INFO : Training metrics:
2024-08-15 17:13:11,860 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:11,864 : INFO : Accuracy: 0.6994
2024-08-15 17:13:11,864 : INFO : Precision score for label_class 0: 0.5385
2024-08-15 17:13:11,864 : INFO : Precision score for label_class 1: 0.7419
2024-08-15 17:13:11,864 : INFO : Precision score for label_class 2: 0.5723
2024-08-15 17:13:11,864 : INFO : Recall score for label_class 0: 0.0640
2024-08-15 17:13:11,864 : INFO : Recall score for label_class 1: 0.9348
2024-08-15 17:13:11,864 : INFO : Recall score for label_class 2: 0.4743
2024-08-15 17:13:11,864 : INFO : Average F1 score: 0.4868
2024-08-15 17:13:12,329 : INFO : Average loss over validation batches: 0.5493
2024-08-15 17:13:12,329 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:12,329 : INFO : Validation metrics:
2024-08-15 17:13:12,329 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:12,331 : INFO : Accuracy: 0.7911
2024-08-15 17:13:12,331 : INFO : Precision score for label_class 0: 1.0000
2024-08-15 17:13:12,331 : INFO : Precision score for label_class 1: 0.8723
2024-08-15 17:13:12,331 : INFO : Precision score for label_class 2: 0.6329
2024-08-15 17:13:12,331 : INFO : Recall score for label_class 0: 0.1744
2024-08-15 17:13:12,331 : INFO : Recall score for label_class 1: 0.9225
2024-08-15 17:13:12,331 : INFO : Recall score for label_class 2: 0.7937
2024-08-15 17:13:12,331 : INFO : Average F1 score: 0.6327
2024-08-15 17:13:12,331 : INFO : Validation metric decreased (inf --> 0.549335).  Saving model ...
2024-08-15 17:13:12,434 : INFO : Starting epoch 2
2024-08-15 17:13:13,090 : INFO : Current training batch loss: 0.5506 in epoch 2
2024-08-15 17:13:13,907 : INFO : Current training batch loss: 0.3868 in epoch 2
2024-08-15 17:13:14,723 : INFO : Current training batch loss: 0.3702 in epoch 2
2024-08-15 17:13:15,540 : INFO : Current training batch loss: 0.3395 in epoch 2
2024-08-15 17:13:15,894 : INFO : Epoch finished, average loss over training batches: 0.4424
2024-08-15 17:13:15,894 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:15,894 : INFO : Training metrics:
2024-08-15 17:13:15,894 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:15,901 : INFO : Accuracy: 0.8599
2024-08-15 17:13:15,901 : INFO : Precision score for label_class 0: 0.7690
2024-08-15 17:13:15,901 : INFO : Precision score for label_class 1: 0.8886
2024-08-15 17:13:15,901 : INFO : Precision score for label_class 2: 0.8258
2024-08-15 17:13:15,901 : INFO : Recall score for label_class 0: 0.6494
2024-08-15 17:13:15,901 : INFO : Recall score for label_class 1: 0.9460
2024-08-15 17:13:15,901 : INFO : Recall score for label_class 2: 0.7681
2024-08-15 17:13:15,901 : INFO : Average F1 score: 0.8055
2024-08-15 17:13:16,365 : INFO : Average loss over validation batches: 0.4208
2024-08-15 17:13:16,365 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:16,365 : INFO : Validation metrics:
2024-08-15 17:13:16,365 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:16,369 : INFO : Accuracy: 0.8681
2024-08-15 17:13:16,369 : INFO : Precision score for label_class 0: 0.7320
2024-08-15 17:13:16,369 : INFO : Precision score for label_class 1: 0.9056
2024-08-15 17:13:16,369 : INFO : Precision score for label_class 2: 0.8545
2024-08-15 17:13:16,369 : INFO : Recall score for label_class 0: 0.8256
2024-08-15 17:13:16,369 : INFO : Recall score for label_class 1: 0.9350
2024-08-15 17:13:16,369 : INFO : Recall score for label_class 2: 0.7460
2024-08-15 17:13:16,369 : INFO : Average F1 score: 0.8309
2024-08-15 17:13:16,369 : INFO : Validation metric decreased (0.549335 --> 0.420827).  Saving model ...
2024-08-15 17:13:16,473 : INFO : Split 3 is finished, the score is: 0.8309
2024-08-15 17:13:16,473 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:16,473 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:16,473 : INFO : Starting training for split 4
2024-08-15 17:13:16,489 : INFO : Starting to tokenize the sequences.
2024-08-15 17:13:16,495 : INFO : Tokenization is finished.
2024-08-15 17:13:16,512 : INFO : Starting to tokenize the sequences.
2024-08-15 17:13:16,517 : INFO : Tokenization is finished.
2024-08-15 17:13:16,525 : INFO : Counting occurences of labels...
2024-08-15 17:13:16,526 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 327, 1621,  751]))
2024-08-15 17:13:16,526 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 87, 390, 197]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:13:16,577 : INFO : Starting epoch 1
2024-08-15 17:13:16,629 : INFO : Current training batch loss: 1.1060 in epoch 1
2024-08-15 17:13:17,446 : INFO : Current training batch loss: 0.9565 in epoch 1
2024-08-15 17:13:18,263 : INFO : Current training batch loss: 0.7089 in epoch 1
2024-08-15 17:13:19,080 : INFO : Current training batch loss: 0.6058 in epoch 1
2024-08-15 17:13:19,898 : INFO : Current training batch loss: 0.5183 in epoch 1
2024-08-15 17:13:20,050 : INFO : Epoch finished, average loss over training batches: 0.7518
2024-08-15 17:13:20,050 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:20,050 : INFO : Training metrics:
2024-08-15 17:13:20,050 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:20,058 : INFO : Accuracy: 0.6817
2024-08-15 17:13:20,058 : INFO : Precision score for label_class 0: 0.2222
2024-08-15 17:13:20,058 : INFO : Precision score for label_class 1: 0.7392
2024-08-15 17:13:20,058 : INFO : Precision score for label_class 2: 0.5470
2024-08-15 17:13:20,058 : INFO : Recall score for label_class 0: 0.0428
2024-08-15 17:13:20,058 : INFO : Recall score for label_class 1: 0.9112
2024-08-15 17:13:20,058 : INFO : Recall score for label_class 2: 0.4647
2024-08-15 17:13:20,058 : INFO : Average F1 score: 0.4635
2024-08-15 17:13:20,524 : INFO : Average loss over validation batches: 0.5525
2024-08-15 17:13:20,524 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:20,524 : INFO : Validation metrics:
2024-08-15 17:13:20,525 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:20,528 : INFO : Accuracy: 0.7730
2024-08-15 17:13:20,528 : INFO : Precision score for label_class 0: 0.5000
2024-08-15 17:13:20,528 : INFO : Precision score for label_class 1: 0.8629
2024-08-15 17:13:20,528 : INFO : Precision score for label_class 2: 0.6225
2024-08-15 17:13:20,528 : INFO : Recall score for label_class 0: 0.0115
2024-08-15 17:13:20,528 : INFO : Recall score for label_class 1: 0.9359
2024-08-15 17:13:20,528 : INFO : Recall score for label_class 2: 0.7868
2024-08-15 17:13:20,528 : INFO : Average F1 score: 0.5385
2024-08-15 17:13:20,528 : INFO : Validation metric decreased (inf --> 0.552492).  Saving model ...
2024-08-15 17:13:20,641 : INFO : Starting epoch 2
2024-08-15 17:13:21,297 : INFO : Current training batch loss: 0.6134 in epoch 2
2024-08-15 17:13:22,113 : INFO : Current training batch loss: 0.3505 in epoch 2
2024-08-15 17:13:22,930 : INFO : Current training batch loss: 0.3152 in epoch 2
2024-08-15 17:13:23,747 : INFO : Current training batch loss: 0.3492 in epoch 2
2024-08-15 17:13:24,101 : INFO : Epoch finished, average loss over training batches: 0.4380
2024-08-15 17:13:24,101 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:24,101 : INFO : Training metrics:
2024-08-15 17:13:24,101 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:24,105 : INFO : Accuracy: 0.8685
2024-08-15 17:13:24,105 : INFO : Precision score for label_class 0: 0.8195
2024-08-15 17:13:24,105 : INFO : Precision score for label_class 1: 0.8974
2024-08-15 17:13:24,105 : INFO : Precision score for label_class 2: 0.8184
2024-08-15 17:13:24,105 : INFO : Recall score for label_class 0: 0.6667
2024-08-15 17:13:24,105 : INFO : Recall score for label_class 1: 0.9445
2024-08-15 17:13:24,105 : INFO : Recall score for label_class 2: 0.7923
2024-08-15 17:13:24,105 : INFO : Average F1 score: 0.8202
2024-08-15 17:13:24,568 : INFO : Average loss over validation batches: 0.4346
2024-08-15 17:13:24,568 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:24,568 : INFO : Validation metrics:
2024-08-15 17:13:24,568 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:24,572 : INFO : Accuracy: 0.8546
2024-08-15 17:13:24,572 : INFO : Precision score for label_class 0: 0.7386
2024-08-15 17:13:24,572 : INFO : Precision score for label_class 1: 0.8873
2024-08-15 17:13:24,572 : INFO : Precision score for label_class 2: 0.8371
2024-08-15 17:13:24,572 : INFO : Recall score for label_class 0: 0.7471
2024-08-15 17:13:24,572 : INFO : Recall score for label_class 1: 0.9282
2024-08-15 17:13:24,572 : INFO : Recall score for label_class 2: 0.7563
2024-08-15 17:13:24,572 : INFO : Average F1 score: 0.8149
2024-08-15 17:13:24,572 : INFO : Validation metric decreased (0.552492 --> 0.434627).  Saving model ...
2024-08-15 17:13:24,677 : INFO : Split 4 is finished, the score is: 0.8149
2024-08-15 17:13:24,677 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:24,677 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:24,677 : INFO : Starting training for split 5
2024-08-15 17:13:24,692 : INFO : Starting to tokenize the sequences.
2024-08-15 17:13:24,697 : INFO : Tokenization is finished.
2024-08-15 17:13:24,713 : INFO : Starting to tokenize the sequences.
2024-08-15 17:13:24,718 : INFO : Tokenization is finished.
2024-08-15 17:13:24,723 : INFO : Counting occurences of labels...
2024-08-15 17:13:24,724 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 330, 1615,  754]))
2024-08-15 17:13:24,724 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 84, 396, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:13:24,767 : INFO : Starting epoch 1
2024-08-15 17:13:24,819 : INFO : Current training batch loss: 1.0859 in epoch 1
2024-08-15 17:13:25,636 : INFO : Current training batch loss: 0.9465 in epoch 1
2024-08-15 17:13:26,453 : INFO : Current training batch loss: 0.7067 in epoch 1
2024-08-15 17:13:27,270 : INFO : Current training batch loss: 0.6355 in epoch 1
2024-08-15 17:13:28,088 : INFO : Current training batch loss: 0.6678 in epoch 1
2024-08-15 17:13:28,240 : INFO : Epoch finished, average loss over training batches: 0.7578
2024-08-15 17:13:28,240 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:28,240 : INFO : Training metrics:
2024-08-15 17:13:28,240 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:28,251 : INFO : Accuracy: 0.6917
2024-08-15 17:13:28,251 : INFO : Precision score for label_class 0: 1.0000
2024-08-15 17:13:28,251 : INFO : Precision score for label_class 1: 0.7287
2024-08-15 17:13:28,251 : INFO : Precision score for label_class 2: 0.5600
2024-08-15 17:13:28,251 : INFO : Recall score for label_class 0: 0.0152
2024-08-15 17:13:28,251 : INFO : Recall score for label_class 1: 0.9449
2024-08-15 17:13:28,251 : INFO : Recall score for label_class 2: 0.4456
2024-08-15 17:13:28,251 : INFO : Average F1 score: 0.4497
2024-08-15 17:13:28,717 : INFO : Average loss over validation batches: 0.5749
2024-08-15 17:13:28,718 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:28,718 : INFO : Validation metrics:
2024-08-15 17:13:28,718 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:28,722 : INFO : Accuracy: 0.7329
2024-08-15 17:13:28,722 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:13:28,722 : INFO : Precision score for label_class 1: 0.7897
2024-08-15 17:13:28,722 : INFO : Precision score for label_class 2: 0.5873
2024-08-15 17:13:28,722 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:13:28,722 : INFO : Recall score for label_class 1: 0.9672
2024-08-15 17:13:28,722 : INFO : Recall score for label_class 2: 0.5722
2024-08-15 17:13:28,722 : INFO : Average F1 score: 0.4830
2024-08-15 17:13:28,722 : INFO : Validation metric decreased (inf --> 0.574900).  Saving model ...
2024-08-15 17:13:28,826 : INFO : Starting epoch 2
2024-08-15 17:13:29,482 : INFO : Current training batch loss: 0.5455 in epoch 2
2024-08-15 17:13:30,299 : INFO : Current training batch loss: 0.4064 in epoch 2
2024-08-15 17:13:31,116 : INFO : Current training batch loss: 0.3153 in epoch 2
2024-08-15 17:13:31,933 : INFO : Current training batch loss: 0.4152 in epoch 2
2024-08-15 17:13:32,287 : INFO : Epoch finished, average loss over training batches: 0.4446
2024-08-15 17:13:32,288 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:32,288 : INFO : Training metrics:
2024-08-15 17:13:32,288 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:32,298 : INFO : Accuracy: 0.8648
2024-08-15 17:13:32,298 : INFO : Precision score for label_class 0: 0.8021
2024-08-15 17:13:32,298 : INFO : Precision score for label_class 1: 0.8905
2024-08-15 17:13:32,298 : INFO : Precision score for label_class 2: 0.8279
2024-08-15 17:13:32,298 : INFO : Recall score for label_class 0: 0.6879
2024-08-15 17:13:32,298 : INFO : Recall score for label_class 1: 0.9412
2024-08-15 17:13:32,298 : INFO : Recall score for label_class 2: 0.7785
2024-08-15 17:13:32,298 : INFO : Average F1 score: 0.8194
2024-08-15 17:13:32,762 : INFO : Average loss over validation batches: 0.4422
2024-08-15 17:13:32,762 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:32,762 : INFO : Validation metrics:
2024-08-15 17:13:32,762 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:32,766 : INFO : Accuracy: 0.8501
2024-08-15 17:13:32,766 : INFO : Precision score for label_class 0: 0.7436
2024-08-15 17:13:32,766 : INFO : Precision score for label_class 1: 0.8886
2024-08-15 17:13:32,766 : INFO : Precision score for label_class 2: 0.8087
2024-08-15 17:13:32,766 : INFO : Recall score for label_class 0: 0.6905
2024-08-15 17:13:32,766 : INFO : Recall score for label_class 1: 0.9268
2024-08-15 17:13:32,766 : INFO : Recall score for label_class 2: 0.7629
2024-08-15 17:13:32,766 : INFO : Average F1 score: 0.8028
2024-08-15 17:13:32,766 : INFO : Validation metric decreased (0.574900 --> 0.442157).  Saving model ...
2024-08-15 17:13:32,869 : INFO : Split 5 is finished, the score is: 0.8028
2024-08-15 17:13:32,870 : INFO : ----------------------------------------------------------------------------------------------------
[I 2024-08-15 17:13:32,880] Trial 3 finished with value: 0.8235340604441699 and parameters: {'n_epochs': 2, 'learning_rate': 7.347224329062433e-05, 'classifier_dropout': 0.5333073827980783, 'warmup_step_fraction': 0.021998041963261633, 'use_gradient_clipping': True}. Best is trial 1 with value: 0.8513001269595835.
2024-08-15 17:13:32,880 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:32,881 : INFO : Starting training for split 1
2024-08-15 17:13:32,894 : INFO : Starting to tokenize the sequences.
2024-08-15 17:13:32,899 : INFO : Tokenization is finished.
2024-08-15 17:13:32,911 : INFO : Starting to tokenize the sequences.
2024-08-15 17:13:32,916 : INFO : Tokenization is finished.
2024-08-15 17:13:32,917 : INFO : Counting occurences of labels...
2024-08-15 17:13:32,917 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1596,  774]))
2024-08-15 17:13:32,918 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 415, 174]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:13:32,960 : INFO : Starting epoch 1
2024-08-15 17:13:33,012 : INFO : Current training batch loss: 1.1002 in epoch 1
2024-08-15 17:13:33,829 : INFO : Current training batch loss: 0.9008 in epoch 1
2024-08-15 17:13:34,646 : INFO : Current training batch loss: 0.8244 in epoch 1
2024-08-15 17:13:35,463 : INFO : Current training batch loss: 0.7150 in epoch 1
2024-08-15 17:13:36,280 : INFO : Current training batch loss: 0.6314 in epoch 1
2024-08-15 17:13:36,432 : INFO : Epoch finished, average loss over training batches: 0.8280
2024-08-15 17:13:36,432 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:36,432 : INFO : Training metrics:
2024-08-15 17:13:36,433 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:36,441 : INFO : Accuracy: 0.6434
2024-08-15 17:13:36,441 : INFO : Precision score for label_class 0: 0.4032
2024-08-15 17:13:36,441 : INFO : Precision score for label_class 1: 0.7107
2024-08-15 17:13:36,441 : INFO : Precision score for label_class 2: 0.4778
2024-08-15 17:13:36,441 : INFO : Recall score for label_class 0: 0.0762
2024-08-15 17:13:36,441 : INFO : Recall score for label_class 1: 0.8634
2024-08-15 17:13:36,441 : INFO : Recall score for label_class 2: 0.4302
2024-08-15 17:13:36,441 : INFO : Average F1 score: 0.4535
2024-08-15 17:13:36,906 : INFO : Average loss over validation batches: 0.6077
2024-08-15 17:13:36,906 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:36,906 : INFO : Validation metrics:
2024-08-15 17:13:36,906 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:36,908 : INFO : Accuracy: 0.7644
2024-08-15 17:13:36,908 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:13:36,908 : INFO : Precision score for label_class 1: 0.8581
2024-08-15 17:13:36,908 : INFO : Precision score for label_class 2: 0.5668
2024-08-15 17:13:36,908 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:13:36,908 : INFO : Recall score for label_class 1: 0.9470
2024-08-15 17:13:36,908 : INFO : Recall score for label_class 2: 0.7069
2024-08-15 17:13:36,909 : INFO : Average F1 score: 0.5098
2024-08-15 17:13:36,909 : INFO : Validation metric decreased (inf --> 0.607660).  Saving model ...
2024-08-15 17:13:37,013 : INFO : Starting epoch 2
2024-08-15 17:13:37,668 : INFO : Current training batch loss: 0.2583 in epoch 2
2024-08-15 17:13:38,485 : INFO : Current training batch loss: 0.5443 in epoch 2
2024-08-15 17:13:39,301 : INFO : Current training batch loss: 0.3595 in epoch 2
2024-08-15 17:13:40,118 : INFO : Current training batch loss: 0.3944 in epoch 2
2024-08-15 17:13:40,471 : INFO : Epoch finished, average loss over training batches: 0.4549
2024-08-15 17:13:40,472 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:40,472 : INFO : Training metrics:
2024-08-15 17:13:40,472 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:40,480 : INFO : Accuracy: 0.8421
2024-08-15 17:13:40,480 : INFO : Precision score for label_class 0: 0.7800
2024-08-15 17:13:40,480 : INFO : Precision score for label_class 1: 0.8829
2024-08-15 17:13:40,480 : INFO : Precision score for label_class 2: 0.7728
2024-08-15 17:13:40,480 : INFO : Recall score for label_class 0: 0.5945
2024-08-15 17:13:40,480 : INFO : Recall score for label_class 1: 0.9305
2024-08-15 17:13:40,480 : INFO : Recall score for label_class 2: 0.7649
2024-08-15 17:13:40,480 : INFO : Average F1 score: 0.7832
2024-08-15 17:13:40,944 : INFO : Average loss over validation batches: 0.4030
2024-08-15 17:13:40,944 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:40,944 : INFO : Validation metrics:
2024-08-15 17:13:40,944 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:40,948 : INFO : Accuracy: 0.8548
2024-08-15 17:13:40,948 : INFO : Precision score for label_class 0: 0.8000
2024-08-15 17:13:40,948 : INFO : Precision score for label_class 1: 0.9254
2024-08-15 17:13:40,948 : INFO : Precision score for label_class 2: 0.7323
2024-08-15 17:13:40,948 : INFO : Recall score for label_class 0: 0.6977
2024-08-15 17:13:40,948 : INFO : Recall score for label_class 1: 0.8964
2024-08-15 17:13:40,948 : INFO : Recall score for label_class 2: 0.8333
2024-08-15 17:13:40,948 : INFO : Average F1 score: 0.8119
2024-08-15 17:13:40,948 : INFO : Validation metric decreased (0.607660 --> 0.403011).  Saving model ...
2024-08-15 17:13:41,048 : INFO : Starting epoch 3
2024-08-15 17:13:41,502 : INFO : Current training batch loss: 0.2797 in epoch 3
2024-08-15 17:13:42,319 : INFO : Current training batch loss: 0.2296 in epoch 3
2024-08-15 17:13:43,136 : INFO : Current training batch loss: 0.2607 in epoch 3
2024-08-15 17:13:43,953 : INFO : Current training batch loss: 0.1738 in epoch 3
2024-08-15 17:13:44,508 : INFO : Epoch finished, average loss over training batches: 0.2645
2024-08-15 17:13:44,509 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:44,509 : INFO : Training metrics:
2024-08-15 17:13:44,509 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:44,514 : INFO : Accuracy: 0.9192
2024-08-15 17:13:44,514 : INFO : Precision score for label_class 0: 0.8367
2024-08-15 17:13:44,514 : INFO : Precision score for label_class 1: 0.9538
2024-08-15 17:13:44,514 : INFO : Precision score for label_class 2: 0.8852
2024-08-15 17:13:44,514 : INFO : Recall score for label_class 0: 0.8750
2024-08-15 17:13:44,514 : INFO : Recall score for label_class 1: 0.9442
2024-08-15 17:13:44,514 : INFO : Recall score for label_class 2: 0.8863
2024-08-15 17:13:44,514 : INFO : Average F1 score: 0.8967
2024-08-15 17:13:44,980 : INFO : Average loss over validation batches: 0.3909
2024-08-15 17:13:44,980 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:44,980 : INFO : Validation metrics:
2024-08-15 17:13:44,980 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:44,983 : INFO : Accuracy: 0.8711
2024-08-15 17:13:44,983 : INFO : Precision score for label_class 0: 0.7952
2024-08-15 17:13:44,983 : INFO : Precision score for label_class 1: 0.9108
2024-08-15 17:13:44,983 : INFO : Precision score for label_class 2: 0.8136
2024-08-15 17:13:44,983 : INFO : Recall score for label_class 0: 0.7674
2024-08-15 17:13:44,984 : INFO : Recall score for label_class 1: 0.9108
2024-08-15 17:13:44,984 : INFO : Recall score for label_class 2: 0.8276
2024-08-15 17:13:44,984 : INFO : Average F1 score: 0.8375
2024-08-15 17:13:44,984 : INFO : Validation metric decreased (0.403011 --> 0.390891).  Saving model ...
2024-08-15 17:13:45,084 : INFO : Starting epoch 4
2024-08-15 17:13:45,337 : INFO : Current training batch loss: 0.4824 in epoch 4
2024-08-15 17:13:46,153 : INFO : Current training batch loss: 0.1945 in epoch 4
2024-08-15 17:13:46,971 : INFO : Current training batch loss: 0.2951 in epoch 4
2024-08-15 17:13:47,787 : INFO : Current training batch loss: 0.1562 in epoch 4
2024-08-15 17:13:48,544 : INFO : Epoch finished, average loss over training batches: 0.1812
2024-08-15 17:13:48,545 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:48,545 : INFO : Training metrics:
2024-08-15 17:13:48,545 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:48,550 : INFO : Accuracy: 0.9477
2024-08-15 17:13:48,550 : INFO : Precision score for label_class 0: 0.8806
2024-08-15 17:13:48,550 : INFO : Precision score for label_class 1: 0.9712
2024-08-15 17:13:48,550 : INFO : Precision score for label_class 2: 0.9283
2024-08-15 17:13:48,550 : INFO : Recall score for label_class 0: 0.8994
2024-08-15 17:13:48,550 : INFO : Recall score for label_class 1: 0.9712
2024-08-15 17:13:48,550 : INFO : Recall score for label_class 2: 0.9199
2024-08-15 17:13:48,550 : INFO : Average F1 score: 0.9284
2024-08-15 17:13:49,015 : INFO : Average loss over validation batches: 0.4399
2024-08-15 17:13:49,016 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:49,016 : INFO : Validation metrics:
2024-08-15 17:13:49,016 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:49,018 : INFO : Accuracy: 0.8563
2024-08-15 17:13:49,019 : INFO : Precision score for label_class 0: 0.7677
2024-08-15 17:13:49,019 : INFO : Precision score for label_class 1: 0.9416
2024-08-15 17:13:49,019 : INFO : Precision score for label_class 2: 0.7387
2024-08-15 17:13:49,019 : INFO : Recall score for label_class 0: 0.8837
2024-08-15 17:13:49,019 : INFO : Recall score for label_class 1: 0.8554
2024-08-15 17:13:49,019 : INFO : Recall score for label_class 2: 0.8448
2024-08-15 17:13:49,019 : INFO : Average F1 score: 0.8354
2024-08-15 17:13:49,019 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:13:49,019 : INFO : Starting epoch 5
2024-08-15 17:13:49,069 : INFO : Current training batch loss: 0.1412 in epoch 5
2024-08-15 17:13:49,887 : INFO : Current training batch loss: 0.1105 in epoch 5
2024-08-15 17:13:50,704 : INFO : Current training batch loss: 0.0255 in epoch 5
2024-08-15 17:13:51,522 : INFO : Current training batch loss: 0.2282 in epoch 5
2024-08-15 17:13:52,340 : INFO : Current training batch loss: 0.1256 in epoch 5
2024-08-15 17:13:52,491 : INFO : Epoch finished, average loss over training batches: 0.1198
2024-08-15 17:13:52,491 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:52,491 : INFO : Training metrics:
2024-08-15 17:13:52,491 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:52,497 : INFO : Accuracy: 0.9678
2024-08-15 17:13:52,497 : INFO : Precision score for label_class 0: 0.9217
2024-08-15 17:13:52,497 : INFO : Precision score for label_class 1: 0.9800
2024-08-15 17:13:52,497 : INFO : Precision score for label_class 2: 0.9620
2024-08-15 17:13:52,497 : INFO : Recall score for label_class 0: 0.9329
2024-08-15 17:13:52,497 : INFO : Recall score for label_class 1: 0.9837
2024-08-15 17:13:52,497 : INFO : Recall score for label_class 2: 0.9496
2024-08-15 17:13:52,497 : INFO : Average F1 score: 0.9550
2024-08-15 17:13:52,962 : INFO : Average loss over validation batches: 0.5337
2024-08-15 17:13:52,962 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:52,962 : INFO : Validation metrics:
2024-08-15 17:13:52,962 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:52,965 : INFO : Accuracy: 0.8444
2024-08-15 17:13:52,965 : INFO : Precision score for label_class 0: 0.7080
2024-08-15 17:13:52,965 : INFO : Precision score for label_class 1: 0.9579
2024-08-15 17:13:52,965 : INFO : Precision score for label_class 2: 0.7233
2024-08-15 17:13:52,965 : INFO : Recall score for label_class 0: 0.9302
2024-08-15 17:13:52,965 : INFO : Recall score for label_class 1: 0.8217
2024-08-15 17:13:52,965 : INFO : Recall score for label_class 2: 0.8563
2024-08-15 17:13:52,965 : INFO : Average F1 score: 0.8243
2024-08-15 17:13:52,965 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:13:52,965 : INFO : Starting epoch 6
2024-08-15 17:13:53,621 : INFO : Current training batch loss: 0.0097 in epoch 6
2024-08-15 17:13:54,438 : INFO : Current training batch loss: 0.0186 in epoch 6
2024-08-15 17:13:55,255 : INFO : Current training batch loss: 0.0189 in epoch 6
2024-08-15 17:13:56,073 : INFO : Current training batch loss: 0.0132 in epoch 6
2024-08-15 17:13:56,427 : INFO : Epoch finished, average loss over training batches: 0.1140
2024-08-15 17:13:56,427 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:56,427 : INFO : Training metrics:
2024-08-15 17:13:56,427 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:56,435 : INFO : Accuracy: 0.9711
2024-08-15 17:13:56,435 : INFO : Precision score for label_class 0: 0.9026
2024-08-15 17:13:56,435 : INFO : Precision score for label_class 1: 0.9856
2024-08-15 17:13:56,435 : INFO : Precision score for label_class 2: 0.9721
2024-08-15 17:13:56,435 : INFO : Recall score for label_class 0: 0.9604
2024-08-15 17:13:56,435 : INFO : Recall score for label_class 1: 0.9850
2024-08-15 17:13:56,435 : INFO : Recall score for label_class 2: 0.9470
2024-08-15 17:13:56,435 : INFO : Average F1 score: 0.9584
2024-08-15 17:13:56,900 : INFO : Average loss over validation batches: 0.5315
2024-08-15 17:13:56,900 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:56,900 : INFO : Validation metrics:
2024-08-15 17:13:56,900 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:56,903 : INFO : Accuracy: 0.8652
2024-08-15 17:13:56,903 : INFO : Precision score for label_class 0: 0.7684
2024-08-15 17:13:56,903 : INFO : Precision score for label_class 1: 0.8894
2024-08-15 17:13:56,903 : INFO : Precision score for label_class 2: 0.8562
2024-08-15 17:13:56,903 : INFO : Recall score for label_class 0: 0.8488
2024-08-15 17:13:56,903 : INFO : Recall score for label_class 1: 0.9301
2024-08-15 17:13:56,903 : INFO : Recall score for label_class 2: 0.7184
2024-08-15 17:13:56,903 : INFO : Average F1 score: 0.8324
2024-08-15 17:13:56,903 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:13:56,903 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:13:56,936 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:13:57,521 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:57,521 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:13:57,521 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:57,524 : INFO : Accuracy: 0.8711
2024-08-15 17:13:57,524 : INFO : Precision score for label_class 0: 0.7952
2024-08-15 17:13:57,524 : INFO : Precision score for label_class 1: 0.9108
2024-08-15 17:13:57,524 : INFO : Precision score for label_class 2: 0.8136
2024-08-15 17:13:57,524 : INFO : Recall score for label_class 0: 0.7674
2024-08-15 17:13:57,524 : INFO : Recall score for label_class 1: 0.9108
2024-08-15 17:13:57,524 : INFO : Recall score for label_class 2: 0.8276
2024-08-15 17:13:57,524 : INFO : Average F1 score: 0.8375
2024-08-15 17:13:57,524 : INFO : Determined score from best model, ending training.
2024-08-15 17:13:57,526 : INFO : Split 1 is finished, the score is: 0.8375
2024-08-15 17:13:57,526 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:57,526 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:13:57,526 : INFO : Starting training for split 2
2024-08-15 17:13:57,540 : INFO : Starting to tokenize the sequences.
2024-08-15 17:13:57,546 : INFO : Tokenization is finished.
2024-08-15 17:13:57,570 : INFO : Starting to tokenize the sequences.
2024-08-15 17:13:57,575 : INFO : Tokenization is finished.
2024-08-15 17:13:57,580 : INFO : Counting occurences of labels...
2024-08-15 17:13:57,581 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 343, 1601,  754]))
2024-08-15 17:13:57,581 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 71, 410, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:13:57,628 : INFO : Starting epoch 1
2024-08-15 17:13:57,680 : INFO : Current training batch loss: 1.0578 in epoch 1
2024-08-15 17:13:58,497 : INFO : Current training batch loss: 0.9882 in epoch 1
2024-08-15 17:13:59,314 : INFO : Current training batch loss: 0.7787 in epoch 1
2024-08-15 17:14:00,131 : INFO : Current training batch loss: 0.5679 in epoch 1
2024-08-15 17:14:00,948 : INFO : Current training batch loss: 0.5295 in epoch 1
2024-08-15 17:14:01,101 : INFO : Epoch finished, average loss over training batches: 0.7695
2024-08-15 17:14:01,102 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:01,102 : INFO : Training metrics:
2024-08-15 17:14:01,102 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:01,113 : INFO : Accuracy: 0.7061
2024-08-15 17:14:01,113 : INFO : Precision score for label_class 0: 0.8056
2024-08-15 17:14:01,113 : INFO : Precision score for label_class 1: 0.7247
2024-08-15 17:14:01,113 : INFO : Precision score for label_class 2: 0.6257
2024-08-15 17:14:01,113 : INFO : Recall score for label_class 0: 0.0845
2024-08-15 17:14:01,113 : INFO : Recall score for label_class 1: 0.9619
2024-08-15 17:14:01,113 : INFO : Recall score for label_class 2: 0.4456
2024-08-15 17:14:01,113 : INFO : Average F1 score: 0.5001
2024-08-15 17:14:01,580 : INFO : Average loss over validation batches: 0.4961
2024-08-15 17:14:01,580 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:01,580 : INFO : Validation metrics:
2024-08-15 17:14:01,580 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:01,584 : INFO : Accuracy: 0.8489
2024-08-15 17:14:01,584 : INFO : Precision score for label_class 0: 0.7414
2024-08-15 17:14:01,584 : INFO : Precision score for label_class 1: 0.8578
2024-08-15 17:14:01,584 : INFO : Precision score for label_class 2: 0.8623
2024-08-15 17:14:01,584 : INFO : Recall score for label_class 0: 0.6056
2024-08-15 17:14:01,584 : INFO : Recall score for label_class 1: 0.9415
2024-08-15 17:14:01,585 : INFO : Recall score for label_class 2: 0.7423
2024-08-15 17:14:01,585 : INFO : Average F1 score: 0.7874
2024-08-15 17:14:01,585 : INFO : Validation metric decreased (inf --> 0.496146).  Saving model ...
2024-08-15 17:14:01,685 : INFO : Starting epoch 2
2024-08-15 17:14:02,341 : INFO : Current training batch loss: 0.4542 in epoch 2
2024-08-15 17:14:03,158 : INFO : Current training batch loss: 0.3753 in epoch 2
2024-08-15 17:14:03,974 : INFO : Current training batch loss: 0.2857 in epoch 2
2024-08-15 17:14:04,792 : INFO : Current training batch loss: 0.2612 in epoch 2
2024-08-15 17:14:05,145 : INFO : Epoch finished, average loss over training batches: 0.3651
2024-08-15 17:14:05,146 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:05,146 : INFO : Training metrics:
2024-08-15 17:14:05,146 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:05,156 : INFO : Accuracy: 0.8866
2024-08-15 17:14:05,156 : INFO : Precision score for label_class 0: 0.8149
2024-08-15 17:14:05,156 : INFO : Precision score for label_class 1: 0.9060
2024-08-15 17:14:05,156 : INFO : Precision score for label_class 2: 0.8745
2024-08-15 17:14:05,156 : INFO : Recall score for label_class 0: 0.7959
2024-08-15 17:14:05,156 : INFO : Recall score for label_class 1: 0.9450
2024-08-15 17:14:05,156 : INFO : Recall score for label_class 2: 0.8037
2024-08-15 17:14:05,156 : INFO : Average F1 score: 0.8560
2024-08-15 17:14:05,622 : INFO : Average loss over validation batches: 0.3784
2024-08-15 17:14:05,622 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:05,622 : INFO : Validation metrics:
2024-08-15 17:14:05,622 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:05,625 : INFO : Accuracy: 0.8652
2024-08-15 17:14:05,625 : INFO : Precision score for label_class 0: 0.7838
2024-08-15 17:14:05,625 : INFO : Precision score for label_class 1: 0.9146
2024-08-15 17:14:05,625 : INFO : Precision score for label_class 2: 0.7980
2024-08-15 17:14:05,625 : INFO : Recall score for label_class 0: 0.8169
2024-08-15 17:14:05,625 : INFO : Recall score for label_class 1: 0.8878
2024-08-15 17:14:05,625 : INFO : Recall score for label_class 2: 0.8351
2024-08-15 17:14:05,625 : INFO : Average F1 score: 0.8390
2024-08-15 17:14:05,625 : INFO : Validation metric decreased (0.496146 --> 0.378430).  Saving model ...
2024-08-15 17:14:05,728 : INFO : Starting epoch 3
2024-08-15 17:14:06,183 : INFO : Current training batch loss: 0.2029 in epoch 3
2024-08-15 17:14:07,001 : INFO : Current training batch loss: 0.2275 in epoch 3
2024-08-15 17:14:07,819 : INFO : Current training batch loss: 0.3851 in epoch 3
2024-08-15 17:14:08,637 : INFO : Current training batch loss: 0.2190 in epoch 3
2024-08-15 17:14:09,193 : INFO : Epoch finished, average loss over training batches: 0.2102
2024-08-15 17:14:09,193 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:09,193 : INFO : Training metrics:
2024-08-15 17:14:09,193 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:09,204 : INFO : Accuracy: 0.9396
2024-08-15 17:14:09,204 : INFO : Precision score for label_class 0: 0.8792
2024-08-15 17:14:09,204 : INFO : Precision score for label_class 1: 0.9585
2024-08-15 17:14:09,204 : INFO : Precision score for label_class 2: 0.9272
2024-08-15 17:14:09,204 : INFO : Recall score for label_class 0: 0.9125
2024-08-15 17:14:09,204 : INFO : Recall score for label_class 1: 0.9663
2024-08-15 17:14:09,204 : INFO : Recall score for label_class 2: 0.8952
2024-08-15 17:14:09,204 : INFO : Average F1 score: 0.9230
2024-08-15 17:14:09,671 : INFO : Average loss over validation batches: 0.3881
2024-08-15 17:14:09,671 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:09,671 : INFO : Validation metrics:
2024-08-15 17:14:09,671 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:09,675 : INFO : Accuracy: 0.8741
2024-08-15 17:14:09,675 : INFO : Precision score for label_class 0: 0.7763
2024-08-15 17:14:09,675 : INFO : Precision score for label_class 1: 0.9095
2024-08-15 17:14:09,675 : INFO : Precision score for label_class 2: 0.8368
2024-08-15 17:14:09,675 : INFO : Recall score for label_class 0: 0.8310
2024-08-15 17:14:09,675 : INFO : Recall score for label_class 1: 0.9073
2024-08-15 17:14:09,675 : INFO : Recall score for label_class 2: 0.8196
2024-08-15 17:14:09,675 : INFO : Average F1 score: 0.8464
2024-08-15 17:14:09,675 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:14:09,675 : INFO : Starting epoch 4
2024-08-15 17:14:09,927 : INFO : Current training batch loss: 0.2771 in epoch 4
2024-08-15 17:14:10,744 : INFO : Current training batch loss: 0.2020 in epoch 4
2024-08-15 17:14:11,562 : INFO : Current training batch loss: 0.2381 in epoch 4
2024-08-15 17:14:12,379 : INFO : Current training batch loss: 0.1588 in epoch 4
2024-08-15 17:14:13,137 : INFO : Epoch finished, average loss over training batches: 0.1355
2024-08-15 17:14:13,137 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:13,137 : INFO : Training metrics:
2024-08-15 17:14:13,137 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:13,148 : INFO : Accuracy: 0.9629
2024-08-15 17:14:13,148 : INFO : Precision score for label_class 0: 0.9181
2024-08-15 17:14:13,148 : INFO : Precision score for label_class 1: 0.9739
2024-08-15 17:14:13,148 : INFO : Precision score for label_class 2: 0.9604
2024-08-15 17:14:13,148 : INFO : Recall score for label_class 0: 0.9475
2024-08-15 17:14:13,148 : INFO : Recall score for label_class 1: 0.9800
2024-08-15 17:14:13,148 : INFO : Recall score for label_class 2: 0.9337
2024-08-15 17:14:13,148 : INFO : Average F1 score: 0.9521
2024-08-15 17:14:13,613 : INFO : Average loss over validation batches: 0.6413
2024-08-15 17:14:13,613 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:13,613 : INFO : Validation metrics:
2024-08-15 17:14:13,613 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:13,616 : INFO : Accuracy: 0.8074
2024-08-15 17:14:13,616 : INFO : Precision score for label_class 0: 0.8026
2024-08-15 17:14:13,616 : INFO : Precision score for label_class 1: 0.9341
2024-08-15 17:14:13,616 : INFO : Precision score for label_class 2: 0.6491
2024-08-15 17:14:13,616 : INFO : Recall score for label_class 0: 0.8592
2024-08-15 17:14:13,616 : INFO : Recall score for label_class 1: 0.7610
2024-08-15 17:14:13,616 : INFO : Recall score for label_class 2: 0.8866
2024-08-15 17:14:13,616 : INFO : Average F1 score: 0.8060
2024-08-15 17:14:13,616 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:14:13,616 : INFO : Starting epoch 5
2024-08-15 17:14:13,667 : INFO : Current training batch loss: 0.0719 in epoch 5
2024-08-15 17:14:14,484 : INFO : Current training batch loss: 0.2835 in epoch 5
2024-08-15 17:14:15,302 : INFO : Current training batch loss: 0.0217 in epoch 5
2024-08-15 17:14:16,120 : INFO : Current training batch loss: 0.0757 in epoch 5
2024-08-15 17:14:16,938 : INFO : Current training batch loss: 0.0110 in epoch 5
2024-08-15 17:14:17,090 : INFO : Epoch finished, average loss over training batches: 0.0943
2024-08-15 17:14:17,090 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:17,090 : INFO : Training metrics:
2024-08-15 17:14:17,090 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:17,097 : INFO : Accuracy: 0.9744
2024-08-15 17:14:17,097 : INFO : Precision score for label_class 0: 0.9348
2024-08-15 17:14:17,097 : INFO : Precision score for label_class 1: 0.9857
2024-08-15 17:14:17,097 : INFO : Precision score for label_class 2: 0.9690
2024-08-15 17:14:17,097 : INFO : Recall score for label_class 0: 0.9621
2024-08-15 17:14:17,097 : INFO : Recall score for label_class 1: 0.9875
2024-08-15 17:14:17,097 : INFO : Recall score for label_class 2: 0.9523
2024-08-15 17:14:17,097 : INFO : Average F1 score: 0.9651
2024-08-15 17:14:17,562 : INFO : Average loss over validation batches: 0.5346
2024-08-15 17:14:17,562 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:17,562 : INFO : Validation metrics:
2024-08-15 17:14:17,562 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:17,566 : INFO : Accuracy: 0.8622
2024-08-15 17:14:17,566 : INFO : Precision score for label_class 0: 0.7342
2024-08-15 17:14:17,566 : INFO : Precision score for label_class 1: 0.9057
2024-08-15 17:14:17,566 : INFO : Precision score for label_class 2: 0.8238
2024-08-15 17:14:17,566 : INFO : Recall score for label_class 0: 0.8169
2024-08-15 17:14:17,566 : INFO : Recall score for label_class 1: 0.8902
2024-08-15 17:14:17,566 : INFO : Recall score for label_class 2: 0.8196
2024-08-15 17:14:17,566 : INFO : Average F1 score: 0.8310
2024-08-15 17:14:17,566 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:14:17,566 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:14:17,600 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:14:18,110 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:18,110 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:14:18,110 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:18,114 : INFO : Accuracy: 0.8652
2024-08-15 17:14:18,114 : INFO : Precision score for label_class 0: 0.7838
2024-08-15 17:14:18,114 : INFO : Precision score for label_class 1: 0.9146
2024-08-15 17:14:18,114 : INFO : Precision score for label_class 2: 0.7980
2024-08-15 17:14:18,114 : INFO : Recall score for label_class 0: 0.8169
2024-08-15 17:14:18,114 : INFO : Recall score for label_class 1: 0.8878
2024-08-15 17:14:18,115 : INFO : Recall score for label_class 2: 0.8351
2024-08-15 17:14:18,115 : INFO : Average F1 score: 0.8390
2024-08-15 17:14:18,115 : INFO : Determined score from best model, ending training.
2024-08-15 17:14:18,116 : INFO : Split 2 is finished, the score is: 0.8390
2024-08-15 17:14:18,116 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:18,116 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:18,116 : INFO : Starting training for split 3
2024-08-15 17:14:18,136 : INFO : Starting to tokenize the sequences.
2024-08-15 17:14:18,143 : INFO : Tokenization is finished.
2024-08-15 17:14:18,160 : INFO : Starting to tokenize the sequences.
2024-08-15 17:14:18,165 : INFO : Tokenization is finished.
2024-08-15 17:14:18,170 : INFO : Counting occurences of labels...
2024-08-15 17:14:18,171 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1611,  759]))
2024-08-15 17:14:18,171 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 400, 189]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:14:18,224 : INFO : Starting epoch 1
2024-08-15 17:14:18,276 : INFO : Current training batch loss: 1.1148 in epoch 1
2024-08-15 17:14:19,094 : INFO : Current training batch loss: 0.9984 in epoch 1
2024-08-15 17:14:19,912 : INFO : Current training batch loss: 0.7682 in epoch 1
2024-08-15 17:14:20,729 : INFO : Current training batch loss: 0.6406 in epoch 1
2024-08-15 17:14:21,547 : INFO : Current training batch loss: 0.6345 in epoch 1
2024-08-15 17:14:21,699 : INFO : Epoch finished, average loss over training batches: 0.8143
2024-08-15 17:14:21,699 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:21,699 : INFO : Training metrics:
2024-08-15 17:14:21,699 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:21,706 : INFO : Accuracy: 0.6420
2024-08-15 17:14:21,707 : INFO : Precision score for label_class 0: 0.1942
2024-08-15 17:14:21,707 : INFO : Precision score for label_class 1: 0.7151
2024-08-15 17:14:21,707 : INFO : Precision score for label_class 2: 0.5709
2024-08-15 17:14:21,707 : INFO : Recall score for label_class 0: 0.1433
2024-08-15 17:14:21,707 : INFO : Recall score for label_class 1: 0.8709
2024-08-15 17:14:21,707 : INFO : Recall score for label_class 2: 0.3715
2024-08-15 17:14:21,707 : INFO : Average F1 score: 0.4668
2024-08-15 17:14:22,171 : INFO : Average loss over validation batches: 0.5437
2024-08-15 17:14:22,172 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:22,172 : INFO : Validation metrics:
2024-08-15 17:14:22,172 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:22,174 : INFO : Accuracy: 0.8237
2024-08-15 17:14:22,175 : INFO : Precision score for label_class 0: 0.8571
2024-08-15 17:14:22,175 : INFO : Precision score for label_class 1: 0.8814
2024-08-15 17:14:22,175 : INFO : Precision score for label_class 2: 0.6990
2024-08-15 17:14:22,175 : INFO : Recall score for label_class 0: 0.5581
2024-08-15 17:14:22,175 : INFO : Recall score for label_class 1: 0.9100
2024-08-15 17:14:22,175 : INFO : Recall score for label_class 2: 0.7619
2024-08-15 17:14:22,175 : INFO : Average F1 score: 0.7669
2024-08-15 17:14:22,175 : INFO : Validation metric decreased (inf --> 0.543681).  Saving model ...
2024-08-15 17:14:22,286 : INFO : Starting epoch 2
2024-08-15 17:14:22,942 : INFO : Current training batch loss: 0.5281 in epoch 2
2024-08-15 17:14:23,759 : INFO : Current training batch loss: 0.3606 in epoch 2
2024-08-15 17:14:24,576 : INFO : Current training batch loss: 0.3876 in epoch 2
2024-08-15 17:14:25,394 : INFO : Current training batch loss: 0.4419 in epoch 2
2024-08-15 17:14:25,747 : INFO : Epoch finished, average loss over training batches: 0.4182
2024-08-15 17:14:25,748 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:25,748 : INFO : Training metrics:
2024-08-15 17:14:25,748 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:25,751 : INFO : Accuracy: 0.8681
2024-08-15 17:14:25,751 : INFO : Precision score for label_class 0: 0.7848
2024-08-15 17:14:25,751 : INFO : Precision score for label_class 1: 0.8917
2024-08-15 17:14:25,751 : INFO : Precision score for label_class 2: 0.8498
2024-08-15 17:14:25,752 : INFO : Recall score for label_class 0: 0.7896
2024-08-15 17:14:25,752 : INFO : Recall score for label_class 1: 0.9348
2024-08-15 17:14:25,752 : INFO : Recall score for label_class 2: 0.7602
2024-08-15 17:14:25,752 : INFO : Average F1 score: 0.8342
2024-08-15 17:14:26,219 : INFO : Average loss over validation batches: 0.3643
2024-08-15 17:14:26,219 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:26,219 : INFO : Validation metrics:
2024-08-15 17:14:26,219 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:26,221 : INFO : Accuracy: 0.8667
2024-08-15 17:14:26,222 : INFO : Precision score for label_class 0: 0.8293
2024-08-15 17:14:26,222 : INFO : Precision score for label_class 1: 0.9171
2024-08-15 17:14:26,222 : INFO : Precision score for label_class 2: 0.7795
2024-08-15 17:14:26,222 : INFO : Recall score for label_class 0: 0.7907
2024-08-15 17:14:26,222 : INFO : Recall score for label_class 1: 0.9125
2024-08-15 17:14:26,222 : INFO : Recall score for label_class 2: 0.8042
2024-08-15 17:14:26,222 : INFO : Average F1 score: 0.8387
2024-08-15 17:14:26,222 : INFO : Validation metric decreased (0.543681 --> 0.364308).  Saving model ...
2024-08-15 17:14:26,326 : INFO : Starting epoch 3
2024-08-15 17:14:26,797 : INFO : Current training batch loss: 0.1598 in epoch 3
2024-08-15 17:14:27,635 : INFO : Current training batch loss: 0.2028 in epoch 3
2024-08-15 17:14:28,477 : INFO : Current training batch loss: 0.2588 in epoch 3
2024-08-15 17:14:29,337 : INFO : Current training batch loss: 0.0517 in epoch 3
2024-08-15 17:14:29,915 : INFO : Epoch finished, average loss over training batches: 0.2364
2024-08-15 17:14:29,915 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:29,915 : INFO : Training metrics:
2024-08-15 17:14:29,915 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:29,919 : INFO : Accuracy: 0.9307
2024-08-15 17:14:29,919 : INFO : Precision score for label_class 0: 0.8571
2024-08-15 17:14:29,919 : INFO : Precision score for label_class 1: 0.9554
2024-08-15 17:14:29,919 : INFO : Precision score for label_class 2: 0.9103
2024-08-15 17:14:29,919 : INFO : Recall score for label_class 0: 0.8780
2024-08-15 17:14:29,919 : INFO : Recall score for label_class 1: 0.9578
2024-08-15 17:14:29,919 : INFO : Recall score for label_class 2: 0.8959
2024-08-15 17:14:29,919 : INFO : Average F1 score: 0.9090
2024-08-15 17:14:30,387 : INFO : Average loss over validation batches: 0.3751
2024-08-15 17:14:30,387 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:30,387 : INFO : Validation metrics:
2024-08-15 17:14:30,387 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:30,390 : INFO : Accuracy: 0.8681
2024-08-15 17:14:30,390 : INFO : Precision score for label_class 0: 0.7766
2024-08-15 17:14:30,390 : INFO : Precision score for label_class 1: 0.8889
2024-08-15 17:14:30,390 : INFO : Precision score for label_class 2: 0.8671
2024-08-15 17:14:30,390 : INFO : Recall score for label_class 0: 0.8488
2024-08-15 17:14:30,390 : INFO : Recall score for label_class 1: 0.9400
2024-08-15 17:14:30,390 : INFO : Recall score for label_class 2: 0.7249
2024-08-15 17:14:30,390 : INFO : Average F1 score: 0.8382
2024-08-15 17:14:30,390 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:14:30,390 : INFO : Starting epoch 4
2024-08-15 17:14:30,651 : INFO : Current training batch loss: 0.4553 in epoch 4
2024-08-15 17:14:31,469 : INFO : Current training batch loss: 0.1847 in epoch 4
2024-08-15 17:14:32,287 : INFO : Current training batch loss: 0.3402 in epoch 4
2024-08-15 17:14:33,105 : INFO : Current training batch loss: 0.0574 in epoch 4
2024-08-15 17:14:33,866 : INFO : Epoch finished, average loss over training batches: 0.1659
2024-08-15 17:14:33,866 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:33,866 : INFO : Training metrics:
2024-08-15 17:14:33,866 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:33,871 : INFO : Accuracy: 0.9552
2024-08-15 17:14:33,871 : INFO : Precision score for label_class 0: 0.9072
2024-08-15 17:14:33,871 : INFO : Precision score for label_class 1: 0.9726
2024-08-15 17:14:33,871 : INFO : Precision score for label_class 2: 0.9392
2024-08-15 17:14:33,871 : INFO : Recall score for label_class 0: 0.9238
2024-08-15 17:14:33,871 : INFO : Recall score for label_class 1: 0.9708
2024-08-15 17:14:33,871 : INFO : Recall score for label_class 2: 0.9354
2024-08-15 17:14:33,871 : INFO : Average F1 score: 0.9415
2024-08-15 17:14:34,339 : INFO : Average loss over validation batches: 0.4385
2024-08-15 17:14:34,339 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:34,339 : INFO : Validation metrics:
2024-08-15 17:14:34,339 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:34,341 : INFO : Accuracy: 0.8637
2024-08-15 17:14:34,341 : INFO : Precision score for label_class 0: 0.7429
2024-08-15 17:14:34,341 : INFO : Precision score for label_class 1: 0.9169
2024-08-15 17:14:34,341 : INFO : Precision score for label_class 2: 0.8150
2024-08-15 17:14:34,341 : INFO : Recall score for label_class 0: 0.9070
2024-08-15 17:14:34,341 : INFO : Recall score for label_class 1: 0.9100
2024-08-15 17:14:34,341 : INFO : Recall score for label_class 2: 0.7460
2024-08-15 17:14:34,341 : INFO : Average F1 score: 0.8364
2024-08-15 17:14:34,341 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:14:34,341 : INFO : Starting epoch 5
2024-08-15 17:14:34,392 : INFO : Current training batch loss: 0.0516 in epoch 5
2024-08-15 17:14:35,210 : INFO : Current training batch loss: 0.3350 in epoch 5
2024-08-15 17:14:36,029 : INFO : Current training batch loss: 0.0720 in epoch 5
2024-08-15 17:14:36,851 : INFO : Current training batch loss: 0.0521 in epoch 5
2024-08-15 17:14:37,675 : INFO : Current training batch loss: 0.0112 in epoch 5
2024-08-15 17:14:37,836 : INFO : Epoch finished, average loss over training batches: 0.1080
2024-08-15 17:14:37,836 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:37,836 : INFO : Training metrics:
2024-08-15 17:14:37,836 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:37,840 : INFO : Accuracy: 0.9681
2024-08-15 17:14:37,840 : INFO : Precision score for label_class 0: 0.9101
2024-08-15 17:14:37,840 : INFO : Precision score for label_class 1: 0.9814
2024-08-15 17:14:37,840 : INFO : Precision score for label_class 2: 0.9664
2024-08-15 17:14:37,840 : INFO : Recall score for label_class 0: 0.9573
2024-08-15 17:14:37,840 : INFO : Recall score for label_class 1: 0.9808
2024-08-15 17:14:37,840 : INFO : Recall score for label_class 2: 0.9460
2024-08-15 17:14:37,840 : INFO : Average F1 score: 0.9568
2024-08-15 17:14:38,307 : INFO : Average loss over validation batches: 0.4762
2024-08-15 17:14:38,307 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:38,307 : INFO : Validation metrics:
2024-08-15 17:14:38,307 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:38,310 : INFO : Accuracy: 0.8652
2024-08-15 17:14:38,310 : INFO : Precision score for label_class 0: 0.8370
2024-08-15 17:14:38,310 : INFO : Precision score for label_class 1: 0.9309
2024-08-15 17:14:38,310 : INFO : Precision score for label_class 2: 0.7585
2024-08-15 17:14:38,310 : INFO : Recall score for label_class 0: 0.8953
2024-08-15 17:14:38,310 : INFO : Recall score for label_class 1: 0.8750
2024-08-15 17:14:38,310 : INFO : Recall score for label_class 2: 0.8307
2024-08-15 17:14:38,310 : INFO : Average F1 score: 0.8534
2024-08-15 17:14:38,310 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:14:38,310 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:14:38,346 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:14:38,855 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:38,855 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:14:38,855 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:38,858 : INFO : Accuracy: 0.8667
2024-08-15 17:14:38,858 : INFO : Precision score for label_class 0: 0.8293
2024-08-15 17:14:38,858 : INFO : Precision score for label_class 1: 0.9171
2024-08-15 17:14:38,858 : INFO : Precision score for label_class 2: 0.7795
2024-08-15 17:14:38,858 : INFO : Recall score for label_class 0: 0.7907
2024-08-15 17:14:38,858 : INFO : Recall score for label_class 1: 0.9125
2024-08-15 17:14:38,858 : INFO : Recall score for label_class 2: 0.8042
2024-08-15 17:14:38,858 : INFO : Average F1 score: 0.8387
2024-08-15 17:14:38,858 : INFO : Determined score from best model, ending training.
2024-08-15 17:14:38,859 : INFO : Split 3 is finished, the score is: 0.8387
2024-08-15 17:14:38,860 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:38,860 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:38,860 : INFO : Starting training for split 4
2024-08-15 17:14:38,880 : INFO : Starting to tokenize the sequences.
2024-08-15 17:14:38,887 : INFO : Tokenization is finished.
2024-08-15 17:14:38,904 : INFO : Starting to tokenize the sequences.
2024-08-15 17:14:38,909 : INFO : Tokenization is finished.
2024-08-15 17:14:38,913 : INFO : Counting occurences of labels...
2024-08-15 17:14:38,914 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 327, 1621,  751]))
2024-08-15 17:14:38,914 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 87, 390, 197]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:14:38,967 : INFO : Starting epoch 1
2024-08-15 17:14:39,019 : INFO : Current training batch loss: 1.1232 in epoch 1
2024-08-15 17:14:39,835 : INFO : Current training batch loss: 1.0031 in epoch 1
2024-08-15 17:14:40,652 : INFO : Current training batch loss: 0.7687 in epoch 1
2024-08-15 17:14:41,470 : INFO : Current training batch loss: 0.6658 in epoch 1
2024-08-15 17:14:42,293 : INFO : Current training batch loss: 0.7392 in epoch 1
2024-08-15 17:14:42,446 : INFO : Epoch finished, average loss over training batches: 0.8343
2024-08-15 17:14:42,446 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:42,446 : INFO : Training metrics:
2024-08-15 17:14:42,446 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:42,454 : INFO : Accuracy: 0.6365
2024-08-15 17:14:42,454 : INFO : Precision score for label_class 0: 0.3750
2024-08-15 17:14:42,454 : INFO : Precision score for label_class 1: 0.7080
2024-08-15 17:14:42,454 : INFO : Precision score for label_class 2: 0.4363
2024-08-15 17:14:42,454 : INFO : Recall score for label_class 0: 0.0550
2024-08-15 17:14:42,454 : INFO : Recall score for label_class 1: 0.8735
2024-08-15 17:14:42,454 : INFO : Recall score for label_class 2: 0.3782
2024-08-15 17:14:42,454 : INFO : Average F1 score: 0.4277
2024-08-15 17:14:42,922 : INFO : Average loss over validation batches: 0.6809
2024-08-15 17:14:42,922 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:42,922 : INFO : Validation metrics:
2024-08-15 17:14:42,922 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:42,925 : INFO : Accuracy: 0.7181
2024-08-15 17:14:42,926 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:14:42,926 : INFO : Precision score for label_class 1: 0.7811
2024-08-15 17:14:42,926 : INFO : Precision score for label_class 2: 0.5678
2024-08-15 17:14:42,926 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:14:42,926 : INFO : Recall score for label_class 1: 0.9513
2024-08-15 17:14:42,926 : INFO : Recall score for label_class 2: 0.5736
2024-08-15 17:14:42,926 : INFO : Average F1 score: 0.4762
2024-08-15 17:14:42,926 : INFO : Validation metric decreased (inf --> 0.680934).  Saving model ...
2024-08-15 17:14:43,034 : INFO : Starting epoch 2
2024-08-15 17:14:43,691 : INFO : Current training batch loss: 0.6897 in epoch 2
2024-08-15 17:14:44,509 : INFO : Current training batch loss: 0.4334 in epoch 2
2024-08-15 17:14:45,327 : INFO : Current training batch loss: 0.3478 in epoch 2
2024-08-15 17:14:46,144 : INFO : Current training batch loss: 0.3367 in epoch 2
2024-08-15 17:14:46,499 : INFO : Epoch finished, average loss over training batches: 0.5219
2024-08-15 17:14:46,499 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:46,499 : INFO : Training metrics:
2024-08-15 17:14:46,499 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:46,503 : INFO : Accuracy: 0.8088
2024-08-15 17:14:46,503 : INFO : Precision score for label_class 0: 0.7317
2024-08-15 17:14:46,503 : INFO : Precision score for label_class 1: 0.8580
2024-08-15 17:14:46,503 : INFO : Precision score for label_class 2: 0.7157
2024-08-15 17:14:46,503 : INFO : Recall score for label_class 0: 0.5505
2024-08-15 17:14:46,503 : INFO : Recall score for label_class 1: 0.9204
2024-08-15 17:14:46,503 : INFO : Recall score for label_class 2: 0.6804
2024-08-15 17:14:46,503 : INFO : Average F1 score: 0.7380
2024-08-15 17:14:46,974 : INFO : Average loss over validation batches: 0.4187
2024-08-15 17:14:46,974 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:46,974 : INFO : Validation metrics:
2024-08-15 17:14:46,974 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:46,977 : INFO : Accuracy: 0.8546
2024-08-15 17:14:46,977 : INFO : Precision score for label_class 0: 0.7143
2024-08-15 17:14:46,977 : INFO : Precision score for label_class 1: 0.8762
2024-08-15 17:14:46,977 : INFO : Precision score for label_class 2: 0.8773
2024-08-15 17:14:46,977 : INFO : Recall score for label_class 0: 0.7471
2024-08-15 17:14:46,977 : INFO : Recall score for label_class 1: 0.9436
2024-08-15 17:14:46,977 : INFO : Recall score for label_class 2: 0.7259
2024-08-15 17:14:46,977 : INFO : Average F1 score: 0.8111
2024-08-15 17:14:46,977 : INFO : Validation metric decreased (0.680934 --> 0.418715).  Saving model ...
2024-08-15 17:14:47,080 : INFO : Starting epoch 3
2024-08-15 17:14:47,535 : INFO : Current training batch loss: 0.2702 in epoch 3
2024-08-15 17:14:48,352 : INFO : Current training batch loss: 0.2745 in epoch 3
2024-08-15 17:14:49,178 : INFO : Current training batch loss: 0.2476 in epoch 3
2024-08-15 17:14:49,996 : INFO : Current training batch loss: 0.1251 in epoch 3
2024-08-15 17:14:50,555 : INFO : Epoch finished, average loss over training batches: 0.2927
2024-08-15 17:14:50,555 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:50,555 : INFO : Training metrics:
2024-08-15 17:14:50,555 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:50,559 : INFO : Accuracy: 0.9055
2024-08-15 17:14:50,559 : INFO : Precision score for label_class 0: 0.8369
2024-08-15 17:14:50,559 : INFO : Precision score for label_class 1: 0.9304
2024-08-15 17:14:50,559 : INFO : Precision score for label_class 2: 0.8793
2024-08-15 17:14:50,559 : INFO : Recall score for label_class 0: 0.8318
2024-08-15 17:14:50,559 : INFO : Recall score for label_class 1: 0.9488
2024-08-15 17:14:50,559 : INFO : Recall score for label_class 2: 0.8442
2024-08-15 17:14:50,559 : INFO : Average F1 score: 0.8784
2024-08-15 17:14:51,025 : INFO : Average loss over validation batches: 0.3875
2024-08-15 17:14:51,025 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:51,025 : INFO : Validation metrics:
2024-08-15 17:14:51,025 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:51,029 : INFO : Accuracy: 0.8739
2024-08-15 17:14:51,029 : INFO : Precision score for label_class 0: 0.8537
2024-08-15 17:14:51,029 : INFO : Precision score for label_class 1: 0.9061
2024-08-15 17:14:51,029 : INFO : Precision score for label_class 2: 0.8182
2024-08-15 17:14:51,029 : INFO : Recall score for label_class 0: 0.8046
2024-08-15 17:14:51,029 : INFO : Recall score for label_class 1: 0.9154
2024-08-15 17:14:51,029 : INFO : Recall score for label_class 2: 0.8223
2024-08-15 17:14:51,029 : INFO : Average F1 score: 0.8531
2024-08-15 17:14:51,029 : INFO : Validation metric decreased (0.418715 --> 0.387451).  Saving model ...
2024-08-15 17:14:51,131 : INFO : Starting epoch 4
2024-08-15 17:14:51,397 : INFO : Current training batch loss: 0.4368 in epoch 4
2024-08-15 17:14:52,474 : INFO : Current training batch loss: 0.2724 in epoch 4
2024-08-15 17:14:53,402 : INFO : Current training batch loss: 0.3991 in epoch 4
2024-08-15 17:14:54,234 : INFO : Current training batch loss: 0.1463 in epoch 4
2024-08-15 17:14:55,027 : INFO : Epoch finished, average loss over training batches: 0.1824
2024-08-15 17:14:55,027 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:55,027 : INFO : Training metrics:
2024-08-15 17:14:55,027 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:55,031 : INFO : Accuracy: 0.9478
2024-08-15 17:14:55,031 : INFO : Precision score for label_class 0: 0.8791
2024-08-15 17:14:55,031 : INFO : Precision score for label_class 1: 0.9703
2024-08-15 17:14:55,031 : INFO : Precision score for label_class 2: 0.9300
2024-08-15 17:14:55,031 : INFO : Recall score for label_class 0: 0.9113
2024-08-15 17:14:55,031 : INFO : Recall score for label_class 1: 0.9679
2024-08-15 17:14:55,031 : INFO : Recall score for label_class 2: 0.9201
2024-08-15 17:14:55,031 : INFO : Average F1 score: 0.9297
2024-08-15 17:14:55,500 : INFO : Average loss over validation batches: 0.5213
2024-08-15 17:14:55,501 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:55,501 : INFO : Validation metrics:
2024-08-15 17:14:55,501 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:55,504 : INFO : Accuracy: 0.8323
2024-08-15 17:14:55,504 : INFO : Precision score for label_class 0: 0.8022
2024-08-15 17:14:55,504 : INFO : Precision score for label_class 1: 0.9407
2024-08-15 17:14:55,504 : INFO : Precision score for label_class 2: 0.6951
2024-08-15 17:14:55,504 : INFO : Recall score for label_class 0: 0.8391
2024-08-15 17:14:55,504 : INFO : Recall score for label_class 1: 0.8128
2024-08-15 17:14:55,504 : INFO : Recall score for label_class 2: 0.8680
2024-08-15 17:14:55,504 : INFO : Average F1 score: 0.8214
2024-08-15 17:14:55,504 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:14:55,504 : INFO : Starting epoch 5
2024-08-15 17:14:55,554 : INFO : Current training batch loss: 0.0737 in epoch 5
2024-08-15 17:14:56,372 : INFO : Current training batch loss: 0.0721 in epoch 5
2024-08-15 17:14:57,189 : INFO : Current training batch loss: 0.0677 in epoch 5
2024-08-15 17:14:58,007 : INFO : Current training batch loss: 0.1180 in epoch 5
2024-08-15 17:14:58,825 : INFO : Current training batch loss: 0.1188 in epoch 5
2024-08-15 17:14:58,977 : INFO : Epoch finished, average loss over training batches: 0.1422
2024-08-15 17:14:58,977 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:58,977 : INFO : Training metrics:
2024-08-15 17:14:58,977 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:58,984 : INFO : Accuracy: 0.9585
2024-08-15 17:14:58,984 : INFO : Precision score for label_class 0: 0.9139
2024-08-15 17:14:58,984 : INFO : Precision score for label_class 1: 0.9717
2024-08-15 17:14:58,984 : INFO : Precision score for label_class 2: 0.9499
2024-08-15 17:14:58,984 : INFO : Recall score for label_class 0: 0.9419
2024-08-15 17:14:58,984 : INFO : Recall score for label_class 1: 0.9735
2024-08-15 17:14:58,984 : INFO : Recall score for label_class 2: 0.9334
2024-08-15 17:14:58,984 : INFO : Average F1 score: 0.9473
2024-08-15 17:14:59,450 : INFO : Average loss over validation batches: 0.4976
2024-08-15 17:14:59,451 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:59,451 : INFO : Validation metrics:
2024-08-15 17:14:59,451 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:14:59,454 : INFO : Accuracy: 0.8561
2024-08-15 17:14:59,454 : INFO : Precision score for label_class 0: 0.7228
2024-08-15 17:14:59,454 : INFO : Precision score for label_class 1: 0.9178
2024-08-15 17:14:59,454 : INFO : Precision score for label_class 2: 0.8061
2024-08-15 17:14:59,454 : INFO : Recall score for label_class 0: 0.8391
2024-08-15 17:14:59,454 : INFO : Recall score for label_class 1: 0.8872
2024-08-15 17:14:59,454 : INFO : Recall score for label_class 2: 0.8020
2024-08-15 17:14:59,454 : INFO : Average F1 score: 0.8276
2024-08-15 17:14:59,454 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:14:59,454 : INFO : Starting epoch 6
2024-08-15 17:15:00,110 : INFO : Current training batch loss: 0.0316 in epoch 6
2024-08-15 17:15:00,927 : INFO : Current training batch loss: 0.1760 in epoch 6
2024-08-15 17:15:01,744 : INFO : Current training batch loss: 0.0219 in epoch 6
2024-08-15 17:15:02,561 : INFO : Current training batch loss: 0.0816 in epoch 6
2024-08-15 17:15:02,915 : INFO : Epoch finished, average loss over training batches: 0.1155
2024-08-15 17:15:02,916 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:02,916 : INFO : Training metrics:
2024-08-15 17:15:02,916 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:02,921 : INFO : Accuracy: 0.9663
2024-08-15 17:15:02,921 : INFO : Precision score for label_class 0: 0.9184
2024-08-15 17:15:02,921 : INFO : Precision score for label_class 1: 0.9778
2024-08-15 17:15:02,921 : INFO : Precision score for label_class 2: 0.9634
2024-08-15 17:15:02,921 : INFO : Recall score for label_class 0: 0.9633
2024-08-15 17:15:02,921 : INFO : Recall score for label_class 1: 0.9766
2024-08-15 17:15:02,921 : INFO : Recall score for label_class 2: 0.9454
2024-08-15 17:15:02,921 : INFO : Average F1 score: 0.9573
2024-08-15 17:15:03,387 : INFO : Average loss over validation batches: 0.5124
2024-08-15 17:15:03,388 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:03,388 : INFO : Validation metrics:
2024-08-15 17:15:03,388 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:03,391 : INFO : Accuracy: 0.8709
2024-08-15 17:15:03,391 : INFO : Precision score for label_class 0: 0.7447
2024-08-15 17:15:03,391 : INFO : Precision score for label_class 1: 0.9030
2024-08-15 17:15:03,391 : INFO : Precision score for label_class 2: 0.8652
2024-08-15 17:15:03,391 : INFO : Recall score for label_class 0: 0.8046
2024-08-15 17:15:03,391 : INFO : Recall score for label_class 1: 0.9308
2024-08-15 17:15:03,391 : INFO : Recall score for label_class 2: 0.7817
2024-08-15 17:15:03,391 : INFO : Average F1 score: 0.8372
2024-08-15 17:15:03,391 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:15:03,391 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:15:03,429 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:15:04,017 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:04,017 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:15:04,017 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:04,020 : INFO : Accuracy: 0.8739
2024-08-15 17:15:04,020 : INFO : Precision score for label_class 0: 0.8537
2024-08-15 17:15:04,020 : INFO : Precision score for label_class 1: 0.9061
2024-08-15 17:15:04,020 : INFO : Precision score for label_class 2: 0.8182
2024-08-15 17:15:04,020 : INFO : Recall score for label_class 0: 0.8046
2024-08-15 17:15:04,020 : INFO : Recall score for label_class 1: 0.9154
2024-08-15 17:15:04,020 : INFO : Recall score for label_class 2: 0.8223
2024-08-15 17:15:04,020 : INFO : Average F1 score: 0.8531
2024-08-15 17:15:04,020 : INFO : Determined score from best model, ending training.
2024-08-15 17:15:04,022 : INFO : Split 4 is finished, the score is: 0.8531
2024-08-15 17:15:04,022 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:04,027 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:04,027 : INFO : Starting training for split 5
2024-08-15 17:15:04,042 : INFO : Starting to tokenize the sequences.
2024-08-15 17:15:04,047 : INFO : Tokenization is finished.
2024-08-15 17:15:04,065 : INFO : Starting to tokenize the sequences.
2024-08-15 17:15:04,070 : INFO : Tokenization is finished.
2024-08-15 17:15:04,074 : INFO : Counting occurences of labels...
2024-08-15 17:15:04,075 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 330, 1615,  754]))
2024-08-15 17:15:04,076 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 84, 396, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:15:04,120 : INFO : Starting epoch 1
2024-08-15 17:15:04,172 : INFO : Current training batch loss: 1.1175 in epoch 1
2024-08-15 17:15:04,989 : INFO : Current training batch loss: 1.0051 in epoch 1
2024-08-15 17:15:05,807 : INFO : Current training batch loss: 0.7272 in epoch 1
2024-08-15 17:15:06,624 : INFO : Current training batch loss: 0.6014 in epoch 1
2024-08-15 17:15:07,442 : INFO : Current training batch loss: 0.5662 in epoch 1
2024-08-15 17:15:07,594 : INFO : Epoch finished, average loss over training batches: 0.7788
2024-08-15 17:15:07,594 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:07,594 : INFO : Training metrics:
2024-08-15 17:15:07,594 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:07,605 : INFO : Accuracy: 0.6814
2024-08-15 17:15:07,605 : INFO : Precision score for label_class 0: 0.7619
2024-08-15 17:15:07,605 : INFO : Precision score for label_class 1: 0.7367
2024-08-15 17:15:07,605 : INFO : Precision score for label_class 2: 0.5238
2024-08-15 17:15:07,605 : INFO : Recall score for label_class 0: 0.2424
2024-08-15 17:15:07,605 : INFO : Recall score for label_class 1: 0.8576
2024-08-15 17:15:07,605 : INFO : Recall score for label_class 2: 0.4960
2024-08-15 17:15:07,605 : INFO : Average F1 score: 0.5566
2024-08-15 17:15:08,074 : INFO : Average loss over validation batches: 0.5111
2024-08-15 17:15:08,075 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:08,075 : INFO : Validation metrics:
2024-08-15 17:15:08,075 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:08,078 : INFO : Accuracy: 0.8190
2024-08-15 17:15:08,079 : INFO : Precision score for label_class 0: 0.8235
2024-08-15 17:15:08,079 : INFO : Precision score for label_class 1: 0.8382
2024-08-15 17:15:08,079 : INFO : Precision score for label_class 2: 0.7697
2024-08-15 17:15:08,079 : INFO : Recall score for label_class 0: 0.5000
2024-08-15 17:15:08,079 : INFO : Recall score for label_class 1: 0.9419
2024-08-15 17:15:08,079 : INFO : Recall score for label_class 2: 0.7062
2024-08-15 17:15:08,079 : INFO : Average F1 score: 0.7486
2024-08-15 17:15:08,079 : INFO : Validation metric decreased (inf --> 0.511128).  Saving model ...
2024-08-15 17:15:08,177 : INFO : Starting epoch 2
2024-08-15 17:15:08,861 : INFO : Current training batch loss: 0.4496 in epoch 2
2024-08-15 17:15:09,708 : INFO : Current training batch loss: 0.3288 in epoch 2
2024-08-15 17:15:10,563 : INFO : Current training batch loss: 0.1994 in epoch 2
2024-08-15 17:15:11,422 : INFO : Current training batch loss: 0.5046 in epoch 2
2024-08-15 17:15:11,794 : INFO : Epoch finished, average loss over training batches: 0.3614
2024-08-15 17:15:11,795 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:11,795 : INFO : Training metrics:
2024-08-15 17:15:11,795 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:11,802 : INFO : Accuracy: 0.8844
2024-08-15 17:15:11,802 : INFO : Precision score for label_class 0: 0.8173
2024-08-15 17:15:11,802 : INFO : Precision score for label_class 1: 0.9081
2024-08-15 17:15:11,802 : INFO : Precision score for label_class 2: 0.8596
2024-08-15 17:15:11,802 : INFO : Recall score for label_class 0: 0.8000
2024-08-15 17:15:11,802 : INFO : Recall score for label_class 1: 0.9356
2024-08-15 17:15:11,802 : INFO : Recall score for label_class 2: 0.8117
2024-08-15 17:15:11,802 : INFO : Average F1 score: 0.8550
2024-08-15 17:15:12,267 : INFO : Average loss over validation batches: 0.4192
2024-08-15 17:15:12,267 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:12,267 : INFO : Validation metrics:
2024-08-15 17:15:12,267 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:12,271 : INFO : Accuracy: 0.8442
2024-08-15 17:15:12,271 : INFO : Precision score for label_class 0: 0.8310
2024-08-15 17:15:12,271 : INFO : Precision score for label_class 1: 0.8506
2024-08-15 17:15:12,271 : INFO : Precision score for label_class 2: 0.8333
2024-08-15 17:15:12,271 : INFO : Recall score for label_class 0: 0.7024
2024-08-15 17:15:12,271 : INFO : Recall score for label_class 1: 0.9343
2024-08-15 17:15:12,271 : INFO : Recall score for label_class 2: 0.7216
2024-08-15 17:15:12,271 : INFO : Average F1 score: 0.8084
2024-08-15 17:15:12,271 : INFO : Validation metric decreased (0.511128 --> 0.419203).  Saving model ...
2024-08-15 17:15:12,374 : INFO : Starting epoch 3
2024-08-15 17:15:12,842 : INFO : Current training batch loss: 0.1871 in epoch 3
2024-08-15 17:15:13,699 : INFO : Current training batch loss: 0.1559 in epoch 3
2024-08-15 17:15:14,557 : INFO : Current training batch loss: 0.0960 in epoch 3
2024-08-15 17:15:15,414 : INFO : Current training batch loss: 0.2630 in epoch 3
2024-08-15 17:15:16,000 : INFO : Epoch finished, average loss over training batches: 0.2197
2024-08-15 17:15:16,001 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:16,001 : INFO : Training metrics:
2024-08-15 17:15:16,001 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:16,008 : INFO : Accuracy: 0.9352
2024-08-15 17:15:16,008 : INFO : Precision score for label_class 0: 0.8806
2024-08-15 17:15:16,008 : INFO : Precision score for label_class 1: 0.9573
2024-08-15 17:15:16,008 : INFO : Precision score for label_class 2: 0.9119
2024-08-15 17:15:16,008 : INFO : Recall score for label_class 0: 0.8939
2024-08-15 17:15:16,008 : INFO : Recall score for label_class 1: 0.9573
2024-08-15 17:15:16,008 : INFO : Recall score for label_class 2: 0.9058
2024-08-15 17:15:16,008 : INFO : Average F1 score: 0.9178
2024-08-15 17:15:16,472 : INFO : Average loss over validation batches: 0.4579
2024-08-15 17:15:16,473 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:16,473 : INFO : Validation metrics:
2024-08-15 17:15:16,473 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:16,477 : INFO : Accuracy: 0.8546
2024-08-15 17:15:16,477 : INFO : Precision score for label_class 0: 0.8267
2024-08-15 17:15:16,477 : INFO : Precision score for label_class 1: 0.8449
2024-08-15 17:15:16,477 : INFO : Precision score for label_class 2: 0.8961
2024-08-15 17:15:16,477 : INFO : Recall score for label_class 0: 0.7381
2024-08-15 17:15:16,477 : INFO : Recall score for label_class 1: 0.9495
2024-08-15 17:15:16,477 : INFO : Recall score for label_class 2: 0.7113
2024-08-15 17:15:16,477 : INFO : Average F1 score: 0.8224
2024-08-15 17:15:16,477 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:15:16,477 : INFO : Starting epoch 4
2024-08-15 17:15:16,741 : INFO : Current training batch loss: 0.5050 in epoch 4
2024-08-15 17:15:17,596 : INFO : Current training batch loss: 0.1725 in epoch 4
2024-08-15 17:15:18,453 : INFO : Current training batch loss: 0.1708 in epoch 4
2024-08-15 17:15:19,299 : INFO : Current training batch loss: 0.0256 in epoch 4
2024-08-15 17:15:20,078 : INFO : Epoch finished, average loss over training batches: 0.1459
2024-08-15 17:15:20,079 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:20,079 : INFO : Training metrics:
2024-08-15 17:15:20,079 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:20,086 : INFO : Accuracy: 0.9589
2024-08-15 17:15:20,086 : INFO : Precision score for label_class 0: 0.9217
2024-08-15 17:15:20,086 : INFO : Precision score for label_class 1: 0.9680
2024-08-15 17:15:20,086 : INFO : Precision score for label_class 2: 0.9555
2024-08-15 17:15:20,086 : INFO : Recall score for label_class 0: 0.9273
2024-08-15 17:15:20,086 : INFO : Recall score for label_class 1: 0.9746
2024-08-15 17:15:20,086 : INFO : Recall score for label_class 2: 0.9390
2024-08-15 17:15:20,086 : INFO : Average F1 score: 0.9476
2024-08-15 17:15:20,550 : INFO : Average loss over validation batches: 0.5190
2024-08-15 17:15:20,550 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:20,550 : INFO : Validation metrics:
2024-08-15 17:15:20,550 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:20,554 : INFO : Accuracy: 0.8457
2024-08-15 17:15:20,554 : INFO : Precision score for label_class 0: 0.7128
2024-08-15 17:15:20,554 : INFO : Precision score for label_class 1: 0.9127
2024-08-15 17:15:20,554 : INFO : Precision score for label_class 2: 0.7822
2024-08-15 17:15:20,554 : INFO : Recall score for label_class 0: 0.7976
2024-08-15 17:15:20,554 : INFO : Recall score for label_class 1: 0.8712
2024-08-15 17:15:20,554 : INFO : Recall score for label_class 2: 0.8144
2024-08-15 17:15:20,554 : INFO : Average F1 score: 0.8141
2024-08-15 17:15:20,554 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:15:20,554 : INFO : Starting epoch 5
2024-08-15 17:15:20,605 : INFO : Current training batch loss: 0.0209 in epoch 5
2024-08-15 17:15:21,444 : INFO : Current training batch loss: 0.4165 in epoch 5
2024-08-15 17:15:22,260 : INFO : Current training batch loss: 0.0186 in epoch 5
2024-08-15 17:15:23,078 : INFO : Current training batch loss: 0.2185 in epoch 5
2024-08-15 17:15:23,896 : INFO : Current training batch loss: 0.0116 in epoch 5
2024-08-15 17:15:24,048 : INFO : Epoch finished, average loss over training batches: 0.0952
2024-08-15 17:15:24,048 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:24,048 : INFO : Training metrics:
2024-08-15 17:15:24,048 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:24,056 : INFO : Accuracy: 0.9759
2024-08-15 17:15:24,056 : INFO : Precision score for label_class 0: 0.9371
2024-08-15 17:15:24,056 : INFO : Precision score for label_class 1: 0.9857
2024-08-15 17:15:24,056 : INFO : Precision score for label_class 2: 0.9721
2024-08-15 17:15:24,056 : INFO : Recall score for label_class 0: 0.9485
2024-08-15 17:15:24,056 : INFO : Recall score for label_class 1: 0.9845
2024-08-15 17:15:24,056 : INFO : Recall score for label_class 2: 0.9695
2024-08-15 17:15:24,056 : INFO : Average F1 score: 0.9662
2024-08-15 17:15:24,523 : INFO : Average loss over validation batches: 0.5705
2024-08-15 17:15:24,523 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:24,524 : INFO : Validation metrics:
2024-08-15 17:15:24,524 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:24,527 : INFO : Accuracy: 0.8516
2024-08-15 17:15:24,527 : INFO : Precision score for label_class 0: 0.7234
2024-08-15 17:15:24,527 : INFO : Precision score for label_class 1: 0.9051
2024-08-15 17:15:24,527 : INFO : Precision score for label_class 2: 0.8053
2024-08-15 17:15:24,527 : INFO : Recall score for label_class 0: 0.8095
2024-08-15 17:15:24,527 : INFO : Recall score for label_class 1: 0.8914
2024-08-15 17:15:24,527 : INFO : Recall score for label_class 2: 0.7887
2024-08-15 17:15:24,527 : INFO : Average F1 score: 0.8197
2024-08-15 17:15:24,527 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:15:24,527 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:15:24,561 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:15:25,068 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:25,068 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:15:25,068 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:25,072 : INFO : Accuracy: 0.8442
2024-08-15 17:15:25,072 : INFO : Precision score for label_class 0: 0.8310
2024-08-15 17:15:25,072 : INFO : Precision score for label_class 1: 0.8506
2024-08-15 17:15:25,072 : INFO : Precision score for label_class 2: 0.8333
2024-08-15 17:15:25,072 : INFO : Recall score for label_class 0: 0.7024
2024-08-15 17:15:25,072 : INFO : Recall score for label_class 1: 0.9343
2024-08-15 17:15:25,072 : INFO : Recall score for label_class 2: 0.7216
2024-08-15 17:15:25,072 : INFO : Average F1 score: 0.8084
2024-08-15 17:15:25,072 : INFO : Determined score from best model, ending training.
2024-08-15 17:15:25,073 : INFO : Split 5 is finished, the score is: 0.8084
2024-08-15 17:15:25,074 : INFO : ----------------------------------------------------------------------------------------------------
[I 2024-08-15 17:15:25,083] Trial 4 finished with value: 0.8353429277567639 and parameters: {'n_epochs': 15, 'learning_rate': 6.222623556860938e-05, 'classifier_dropout': 0.6417908632269425, 'warmup_step_fraction': 0.017087347339829924, 'use_gradient_clipping': True}. Best is trial 1 with value: 0.8513001269595835.
2024-08-15 17:15:25,084 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:25,084 : INFO : Starting training for split 1
2024-08-15 17:15:25,096 : INFO : Starting to tokenize the sequences.
2024-08-15 17:15:25,101 : INFO : Tokenization is finished.
2024-08-15 17:15:25,113 : INFO : Starting to tokenize the sequences.
2024-08-15 17:15:25,118 : INFO : Tokenization is finished.
2024-08-15 17:15:25,118 : INFO : Counting occurences of labels...
2024-08-15 17:15:25,119 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1596,  774]))
2024-08-15 17:15:25,120 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 415, 174]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:15:25,174 : INFO : Starting epoch 1
2024-08-15 17:15:25,225 : INFO : Current training batch loss: 1.0760 in epoch 1
2024-08-15 17:15:26,041 : INFO : Current training batch loss: 0.7935 in epoch 1
2024-08-15 17:15:26,865 : INFO : Current training batch loss: 0.7091 in epoch 1
2024-08-15 17:15:27,703 : INFO : Current training batch loss: 0.6852 in epoch 1
2024-08-15 17:15:28,532 : INFO : Current training batch loss: 0.5308 in epoch 1
2024-08-15 17:15:28,685 : INFO : Epoch finished, average loss over training batches: 0.7138
2024-08-15 17:15:28,686 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:28,686 : INFO : Training metrics:
2024-08-15 17:15:28,686 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:28,694 : INFO : Accuracy: 0.7239
2024-08-15 17:15:28,694 : INFO : Precision score for label_class 0: 0.7927
2024-08-15 17:15:28,694 : INFO : Precision score for label_class 1: 0.7489
2024-08-15 17:15:28,694 : INFO : Precision score for label_class 2: 0.6330
2024-08-15 17:15:28,694 : INFO : Recall score for label_class 0: 0.1982
2024-08-15 17:15:28,694 : INFO : Recall score for label_class 1: 0.9398
2024-08-15 17:15:28,694 : INFO : Recall score for label_class 2: 0.5013
2024-08-15 17:15:28,694 : INFO : Average F1 score: 0.5700
2024-08-15 17:15:29,159 : INFO : Average loss over validation batches: 0.4392
2024-08-15 17:15:29,160 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:29,160 : INFO : Validation metrics:
2024-08-15 17:15:29,160 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:29,163 : INFO : Accuracy: 0.8385
2024-08-15 17:15:29,163 : INFO : Precision score for label_class 0: 0.7556
2024-08-15 17:15:29,163 : INFO : Precision score for label_class 1: 0.9154
2024-08-15 17:15:29,163 : INFO : Precision score for label_class 2: 0.7231
2024-08-15 17:15:29,163 : INFO : Recall score for label_class 0: 0.7907
2024-08-15 17:15:29,163 : INFO : Recall score for label_class 1: 0.8602
2024-08-15 17:15:29,163 : INFO : Recall score for label_class 2: 0.8103
2024-08-15 17:15:29,163 : INFO : Average F1 score: 0.8080
2024-08-15 17:15:29,163 : INFO : Validation metric decreased (inf --> 0.439159).  Saving model ...
2024-08-15 17:15:29,272 : INFO : Starting epoch 2
2024-08-15 17:15:29,933 : INFO : Current training batch loss: 0.1611 in epoch 2
2024-08-15 17:15:30,754 : INFO : Current training batch loss: 0.4019 in epoch 2
2024-08-15 17:15:31,571 : INFO : Current training batch loss: 0.2391 in epoch 2
2024-08-15 17:15:32,389 : INFO : Current training batch loss: 0.3082 in epoch 2
2024-08-15 17:15:32,749 : INFO : Epoch finished, average loss over training batches: 0.3281
2024-08-15 17:15:32,749 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:32,749 : INFO : Training metrics:
2024-08-15 17:15:32,749 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:32,756 : INFO : Accuracy: 0.8888
2024-08-15 17:15:32,756 : INFO : Precision score for label_class 0: 0.8066
2024-08-15 17:15:32,757 : INFO : Precision score for label_class 1: 0.9150
2024-08-15 17:15:32,757 : INFO : Precision score for label_class 2: 0.8675
2024-08-15 17:15:32,757 : INFO : Recall score for label_class 0: 0.8140
2024-08-15 17:15:32,757 : INFO : Recall score for label_class 1: 0.9373
2024-08-15 17:15:32,757 : INFO : Recall score for label_class 2: 0.8204
2024-08-15 17:15:32,757 : INFO : Average F1 score: 0.8599
2024-08-15 17:15:33,222 : INFO : Average loss over validation batches: 0.3447
2024-08-15 17:15:33,222 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:33,222 : INFO : Validation metrics:
2024-08-15 17:15:33,222 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:33,225 : INFO : Accuracy: 0.8785
2024-08-15 17:15:33,225 : INFO : Precision score for label_class 0: 0.7660
2024-08-15 17:15:33,226 : INFO : Precision score for label_class 1: 0.9169
2024-08-15 17:15:33,226 : INFO : Precision score for label_class 2: 0.8438
2024-08-15 17:15:33,226 : INFO : Recall score for label_class 0: 0.8372
2024-08-15 17:15:33,226 : INFO : Recall score for label_class 1: 0.9301
2024-08-15 17:15:33,226 : INFO : Recall score for label_class 2: 0.7759
2024-08-15 17:15:33,226 : INFO : Average F1 score: 0.8439
2024-08-15 17:15:33,226 : INFO : Validation metric decreased (0.439159 --> 0.344712).  Saving model ...
2024-08-15 17:15:33,324 : INFO : Starting epoch 3
2024-08-15 17:15:33,781 : INFO : Current training batch loss: 0.1791 in epoch 3
2024-08-15 17:15:34,608 : INFO : Current training batch loss: 0.1316 in epoch 3
2024-08-15 17:15:35,420 : INFO : Current training batch loss: 0.1715 in epoch 3
2024-08-15 17:15:36,235 : INFO : Current training batch loss: 0.0483 in epoch 3
2024-08-15 17:15:36,788 : INFO : Epoch finished, average loss over training batches: 0.1800
2024-08-15 17:15:36,788 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:36,788 : INFO : Training metrics:
2024-08-15 17:15:36,788 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:36,794 : INFO : Accuracy: 0.9500
2024-08-15 17:15:36,794 : INFO : Precision score for label_class 0: 0.8728
2024-08-15 17:15:36,794 : INFO : Precision score for label_class 1: 0.9681
2024-08-15 17:15:36,794 : INFO : Precision score for label_class 2: 0.9468
2024-08-15 17:15:36,794 : INFO : Recall score for label_class 0: 0.9207
2024-08-15 17:15:36,794 : INFO : Recall score for label_class 1: 0.9706
2024-08-15 17:15:36,794 : INFO : Recall score for label_class 2: 0.9199
2024-08-15 17:15:36,794 : INFO : Average F1 score: 0.9329
2024-08-15 17:15:37,258 : INFO : Average loss over validation batches: 0.3430
2024-08-15 17:15:37,258 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:37,258 : INFO : Validation metrics:
2024-08-15 17:15:37,258 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:37,260 : INFO : Accuracy: 0.8770
2024-08-15 17:15:37,260 : INFO : Precision score for label_class 0: 0.7755
2024-08-15 17:15:37,261 : INFO : Precision score for label_class 1: 0.9365
2024-08-15 17:15:37,261 : INFO : Precision score for label_class 2: 0.8033
2024-08-15 17:15:37,261 : INFO : Recall score for label_class 0: 0.8837
2024-08-15 17:15:37,261 : INFO : Recall score for label_class 1: 0.8892
2024-08-15 17:15:37,261 : INFO : Recall score for label_class 2: 0.8448
2024-08-15 17:15:37,261 : INFO : Average F1 score: 0.8540
2024-08-15 17:15:37,261 : INFO : Validation metric decreased (0.344712 --> 0.343022).  Saving model ...
2024-08-15 17:15:37,361 : INFO : Starting epoch 4
2024-08-15 17:15:37,613 : INFO : Current training batch loss: 0.2860 in epoch 4
2024-08-15 17:15:38,429 : INFO : Current training batch loss: 0.0494 in epoch 4
2024-08-15 17:15:39,243 : INFO : Current training batch loss: 0.1916 in epoch 4
2024-08-15 17:15:40,057 : INFO : Current training batch loss: 0.1166 in epoch 4
2024-08-15 17:15:40,810 : INFO : Epoch finished, average loss over training batches: 0.1078
2024-08-15 17:15:40,810 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:40,810 : INFO : Training metrics:
2024-08-15 17:15:40,810 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:40,818 : INFO : Accuracy: 0.9759
2024-08-15 17:15:40,818 : INFO : Precision score for label_class 0: 0.9213
2024-08-15 17:15:40,818 : INFO : Precision score for label_class 1: 0.9844
2024-08-15 17:15:40,818 : INFO : Precision score for label_class 2: 0.9827
2024-08-15 17:15:40,818 : INFO : Recall score for label_class 0: 0.9634
2024-08-15 17:15:40,818 : INFO : Recall score for label_class 1: 0.9881
2024-08-15 17:15:40,818 : INFO : Recall score for label_class 2: 0.9561
2024-08-15 17:15:40,818 : INFO : Average F1 score: 0.9658
2024-08-15 17:15:41,283 : INFO : Average loss over validation batches: 0.3389
2024-08-15 17:15:41,283 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:41,283 : INFO : Validation metrics:
2024-08-15 17:15:41,283 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:41,287 : INFO : Accuracy: 0.8948
2024-08-15 17:15:41,287 : INFO : Precision score for label_class 0: 0.8152
2024-08-15 17:15:41,287 : INFO : Precision score for label_class 1: 0.9194
2024-08-15 17:15:41,287 : INFO : Precision score for label_class 2: 0.8758
2024-08-15 17:15:41,287 : INFO : Recall score for label_class 0: 0.8721
2024-08-15 17:15:41,287 : INFO : Recall score for label_class 1: 0.9349
2024-08-15 17:15:41,287 : INFO : Recall score for label_class 2: 0.8103
2024-08-15 17:15:41,287 : INFO : Average F1 score: 0.8705
2024-08-15 17:15:41,287 : INFO : Validation metric decreased (0.343022 --> 0.338887).  Saving model ...
2024-08-15 17:15:41,391 : INFO : Split 1 is finished, the score is: 0.8705
2024-08-15 17:15:41,392 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:41,392 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:41,392 : INFO : Starting training for split 2
2024-08-15 17:15:41,407 : INFO : Starting to tokenize the sequences.
2024-08-15 17:15:41,413 : INFO : Tokenization is finished.
2024-08-15 17:15:41,430 : INFO : Starting to tokenize the sequences.
2024-08-15 17:15:41,435 : INFO : Tokenization is finished.
2024-08-15 17:15:41,439 : INFO : Counting occurences of labels...
2024-08-15 17:15:41,440 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 343, 1601,  754]))
2024-08-15 17:15:41,441 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 71, 410, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:15:41,486 : INFO : Starting epoch 1
2024-08-15 17:15:41,537 : INFO : Current training batch loss: 1.1112 in epoch 1
2024-08-15 17:15:42,351 : INFO : Current training batch loss: 0.9831 in epoch 1
2024-08-15 17:15:43,166 : INFO : Current training batch loss: 0.7846 in epoch 1
2024-08-15 17:15:43,980 : INFO : Current training batch loss: 0.5311 in epoch 1
2024-08-15 17:15:44,795 : INFO : Current training batch loss: 0.5219 in epoch 1
2024-08-15 17:15:44,946 : INFO : Epoch finished, average loss over training batches: 0.7570
2024-08-15 17:15:44,946 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:44,946 : INFO : Training metrics:
2024-08-15 17:15:44,946 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:44,954 : INFO : Accuracy: 0.6864
2024-08-15 17:15:44,954 : INFO : Precision score for label_class 0: 0.6870
2024-08-15 17:15:44,954 : INFO : Precision score for label_class 1: 0.7341
2024-08-15 17:15:44,954 : INFO : Precision score for label_class 2: 0.5459
2024-08-15 17:15:44,954 : INFO : Recall score for label_class 0: 0.2303
2024-08-15 17:15:44,954 : INFO : Recall score for label_class 1: 0.8844
2024-08-15 17:15:44,954 : INFO : Recall score for label_class 2: 0.4735
2024-08-15 17:15:44,954 : INFO : Average F1 score: 0.5514
2024-08-15 17:15:45,419 : INFO : Average loss over validation batches: 0.4509
2024-08-15 17:15:45,419 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:45,419 : INFO : Validation metrics:
2024-08-15 17:15:45,419 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:45,422 : INFO : Accuracy: 0.8474
2024-08-15 17:15:45,422 : INFO : Precision score for label_class 0: 0.7123
2024-08-15 17:15:45,422 : INFO : Precision score for label_class 1: 0.8831
2024-08-15 17:15:45,423 : INFO : Precision score for label_class 2: 0.8197
2024-08-15 17:15:45,423 : INFO : Recall score for label_class 0: 0.7324
2024-08-15 17:15:45,423 : INFO : Recall score for label_class 1: 0.9024
2024-08-15 17:15:45,423 : INFO : Recall score for label_class 2: 0.7732
2024-08-15 17:15:45,423 : INFO : Average F1 score: 0.8035
2024-08-15 17:15:45,423 : INFO : Validation metric decreased (inf --> 0.450856).  Saving model ...
2024-08-15 17:15:45,522 : INFO : Starting epoch 2
2024-08-15 17:15:46,176 : INFO : Current training batch loss: 0.4232 in epoch 2
2024-08-15 17:15:46,990 : INFO : Current training batch loss: 0.3277 in epoch 2
2024-08-15 17:15:47,805 : INFO : Current training batch loss: 0.2397 in epoch 2
2024-08-15 17:15:48,619 : INFO : Current training batch loss: 0.2711 in epoch 2
2024-08-15 17:15:48,970 : INFO : Epoch finished, average loss over training batches: 0.3415
2024-08-15 17:15:48,971 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:48,971 : INFO : Training metrics:
2024-08-15 17:15:48,971 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:48,978 : INFO : Accuracy: 0.8862
2024-08-15 17:15:48,978 : INFO : Precision score for label_class 0: 0.7938
2024-08-15 17:15:48,978 : INFO : Precision score for label_class 1: 0.9220
2024-08-15 17:15:48,978 : INFO : Precision score for label_class 2: 0.8519
2024-08-15 17:15:48,978 : INFO : Recall score for label_class 0: 0.8192
2024-08-15 17:15:48,978 : INFO : Recall score for label_class 1: 0.9300
2024-08-15 17:15:48,978 : INFO : Recall score for label_class 2: 0.8236
2024-08-15 17:15:48,978 : INFO : Average F1 score: 0.8566
2024-08-15 17:15:49,442 : INFO : Average loss over validation batches: 0.3522
2024-08-15 17:15:49,442 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:49,442 : INFO : Validation metrics:
2024-08-15 17:15:49,442 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:49,446 : INFO : Accuracy: 0.8785
2024-08-15 17:15:49,446 : INFO : Precision score for label_class 0: 0.7867
2024-08-15 17:15:49,446 : INFO : Precision score for label_class 1: 0.8886
2024-08-15 17:15:49,446 : INFO : Precision score for label_class 2: 0.8935
2024-08-15 17:15:49,446 : INFO : Recall score for label_class 0: 0.8310
2024-08-15 17:15:49,446 : INFO : Recall score for label_class 1: 0.9341
2024-08-15 17:15:49,446 : INFO : Recall score for label_class 2: 0.7784
2024-08-15 17:15:49,446 : INFO : Average F1 score: 0.8503
2024-08-15 17:15:49,446 : INFO : Validation metric decreased (0.450856 --> 0.352172).  Saving model ...
2024-08-15 17:15:49,544 : INFO : Starting epoch 3
2024-08-15 17:15:49,997 : INFO : Current training batch loss: 0.1113 in epoch 3
2024-08-15 17:15:50,812 : INFO : Current training batch loss: 0.1803 in epoch 3
2024-08-15 17:15:51,626 : INFO : Current training batch loss: 0.2652 in epoch 3
2024-08-15 17:15:52,442 : INFO : Current training batch loss: 0.0542 in epoch 3
2024-08-15 17:15:52,994 : INFO : Epoch finished, average loss over training batches: 0.1815
2024-08-15 17:15:52,994 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:52,994 : INFO : Training metrics:
2024-08-15 17:15:52,994 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:53,001 : INFO : Accuracy: 0.9485
2024-08-15 17:15:53,001 : INFO : Precision score for label_class 0: 0.8880
2024-08-15 17:15:53,001 : INFO : Precision score for label_class 1: 0.9699
2024-08-15 17:15:53,001 : INFO : Precision score for label_class 2: 0.9315
2024-08-15 17:15:53,001 : INFO : Recall score for label_class 0: 0.9242
2024-08-15 17:15:53,001 : INFO : Recall score for label_class 1: 0.9675
2024-08-15 17:15:53,001 : INFO : Recall score for label_class 2: 0.9191
2024-08-15 17:15:53,001 : INFO : Average F1 score: 0.9332
2024-08-15 17:15:53,467 : INFO : Average loss over validation batches: 0.3766
2024-08-15 17:15:53,468 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:53,468 : INFO : Validation metrics:
2024-08-15 17:15:53,468 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:53,471 : INFO : Accuracy: 0.8711
2024-08-15 17:15:53,471 : INFO : Precision score for label_class 0: 0.7647
2024-08-15 17:15:53,471 : INFO : Precision score for label_class 1: 0.9150
2024-08-15 17:15:53,471 : INFO : Precision score for label_class 2: 0.8263
2024-08-15 17:15:53,471 : INFO : Recall score for label_class 0: 0.9155
2024-08-15 17:15:53,471 : INFO : Recall score for label_class 1: 0.8927
2024-08-15 17:15:53,471 : INFO : Recall score for label_class 2: 0.8093
2024-08-15 17:15:53,471 : INFO : Average F1 score: 0.8516
2024-08-15 17:15:53,471 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:15:53,471 : INFO : Starting epoch 4
2024-08-15 17:15:53,723 : INFO : Current training batch loss: 0.2695 in epoch 4
2024-08-15 17:15:54,537 : INFO : Current training batch loss: 0.0483 in epoch 4
2024-08-15 17:15:55,352 : INFO : Current training batch loss: 0.1824 in epoch 4
2024-08-15 17:15:56,167 : INFO : Current training batch loss: 0.1508 in epoch 4
2024-08-15 17:15:56,921 : INFO : Epoch finished, average loss over training batches: 0.1091
2024-08-15 17:15:56,921 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:56,921 : INFO : Training metrics:
2024-08-15 17:15:56,921 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:56,929 : INFO : Accuracy: 0.9729
2024-08-15 17:15:56,929 : INFO : Precision score for label_class 0: 0.9164
2024-08-15 17:15:56,929 : INFO : Precision score for label_class 1: 0.9856
2024-08-15 17:15:56,929 : INFO : Precision score for label_class 2: 0.9729
2024-08-15 17:15:56,929 : INFO : Recall score for label_class 0: 0.9592
2024-08-15 17:15:56,929 : INFO : Recall score for label_class 1: 0.9850
2024-08-15 17:15:56,929 : INFO : Recall score for label_class 2: 0.9536
2024-08-15 17:15:56,929 : INFO : Average F1 score: 0.9619
2024-08-15 17:15:57,394 : INFO : Average loss over validation batches: 0.3669
2024-08-15 17:15:57,394 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:57,394 : INFO : Validation metrics:
2024-08-15 17:15:57,394 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:57,397 : INFO : Accuracy: 0.8711
2024-08-15 17:15:57,397 : INFO : Precision score for label_class 0: 0.7683
2024-08-15 17:15:57,397 : INFO : Precision score for label_class 1: 0.8979
2024-08-15 17:15:57,398 : INFO : Precision score for label_class 2: 0.8547
2024-08-15 17:15:57,398 : INFO : Recall score for label_class 0: 0.8873
2024-08-15 17:15:57,398 : INFO : Recall score for label_class 1: 0.9220
2024-08-15 17:15:57,398 : INFO : Recall score for label_class 2: 0.7577
2024-08-15 17:15:57,398 : INFO : Average F1 score: 0.8455
2024-08-15 17:15:57,398 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:15:57,398 : INFO : Last epoch reached, validation loss was better before, loading best model during training.
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:15:57,431 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:15:57,934 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:57,934 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:15:57,934 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:57,937 : INFO : Accuracy: 0.8785
2024-08-15 17:15:57,937 : INFO : Precision score for label_class 0: 0.7867
2024-08-15 17:15:57,937 : INFO : Precision score for label_class 1: 0.8886
2024-08-15 17:15:57,937 : INFO : Precision score for label_class 2: 0.8935
2024-08-15 17:15:57,937 : INFO : Recall score for label_class 0: 0.8310
2024-08-15 17:15:57,937 : INFO : Recall score for label_class 1: 0.9341
2024-08-15 17:15:57,937 : INFO : Recall score for label_class 2: 0.7784
2024-08-15 17:15:57,937 : INFO : Average F1 score: 0.8503
2024-08-15 17:15:57,937 : INFO : Determined score from best model, ending training.
2024-08-15 17:15:57,944 : INFO : Split 2 is finished, the score is: 0.8503
2024-08-15 17:15:57,944 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:57,944 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:15:57,944 : INFO : Starting training for split 3
2024-08-15 17:15:57,957 : INFO : Starting to tokenize the sequences.
2024-08-15 17:15:57,963 : INFO : Tokenization is finished.
2024-08-15 17:15:57,981 : INFO : Starting to tokenize the sequences.
2024-08-15 17:15:57,986 : INFO : Tokenization is finished.
2024-08-15 17:15:57,991 : INFO : Counting occurences of labels...
2024-08-15 17:15:57,992 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1611,  759]))
2024-08-15 17:15:57,993 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 400, 189]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:15:58,039 : INFO : Starting epoch 1
2024-08-15 17:15:58,090 : INFO : Current training batch loss: 1.0817 in epoch 1
2024-08-15 17:15:58,905 : INFO : Current training batch loss: 0.9818 in epoch 1
2024-08-15 17:15:59,720 : INFO : Current training batch loss: 0.6788 in epoch 1
2024-08-15 17:16:00,535 : INFO : Current training batch loss: 0.8599 in epoch 1
2024-08-15 17:16:01,350 : INFO : Current training batch loss: 0.6519 in epoch 1
2024-08-15 17:16:01,501 : INFO : Epoch finished, average loss over training batches: 0.7717
2024-08-15 17:16:01,501 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:01,501 : INFO : Training metrics:
2024-08-15 17:16:01,501 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:01,508 : INFO : Accuracy: 0.6861
2024-08-15 17:16:01,508 : INFO : Precision score for label_class 0: 0.4203
2024-08-15 17:16:01,508 : INFO : Precision score for label_class 1: 0.7234
2024-08-15 17:16:01,508 : INFO : Precision score for label_class 2: 0.5714
2024-08-15 17:16:01,509 : INFO : Recall score for label_class 0: 0.0884
2024-08-15 17:16:01,509 : INFO : Recall score for label_class 1: 0.9448
2024-08-15 17:16:01,509 : INFO : Recall score for label_class 2: 0.3953
2024-08-15 17:16:01,509 : INFO : Average F1 score: 0.4776
2024-08-15 17:16:01,973 : INFO : Average loss over validation batches: 0.5399
2024-08-15 17:16:01,974 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:01,974 : INFO : Validation metrics:
2024-08-15 17:16:01,974 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:01,976 : INFO : Accuracy: 0.7615
2024-08-15 17:16:01,976 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:16:01,976 : INFO : Precision score for label_class 1: 0.9270
2024-08-15 17:16:01,976 : INFO : Precision score for label_class 2: 0.5607
2024-08-15 17:16:01,976 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:16:01,976 : INFO : Recall score for label_class 1: 0.8575
2024-08-15 17:16:01,976 : INFO : Recall score for label_class 2: 0.9048
2024-08-15 17:16:01,976 : INFO : Average F1 score: 0.5277
2024-08-15 17:16:01,976 : INFO : Validation metric decreased (inf --> 0.539938).  Saving model ...
2024-08-15 17:16:02,073 : INFO : Starting epoch 2
2024-08-15 17:16:02,726 : INFO : Current training batch loss: 0.4998 in epoch 2
2024-08-15 17:16:03,541 : INFO : Current training batch loss: 0.3656 in epoch 2
2024-08-15 17:16:04,355 : INFO : Current training batch loss: 0.3484 in epoch 2
2024-08-15 17:16:05,170 : INFO : Current training batch loss: 0.2509 in epoch 2
2024-08-15 17:16:05,521 : INFO : Epoch finished, average loss over training batches: 0.3979
2024-08-15 17:16:05,522 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:05,522 : INFO : Training metrics:
2024-08-15 17:16:05,522 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:05,525 : INFO : Accuracy: 0.8610
2024-08-15 17:16:05,525 : INFO : Precision score for label_class 0: 0.7673
2024-08-15 17:16:05,525 : INFO : Precision score for label_class 1: 0.8984
2024-08-15 17:16:05,525 : INFO : Precision score for label_class 2: 0.8171
2024-08-15 17:16:05,525 : INFO : Recall score for label_class 0: 0.7439
2024-08-15 17:16:05,525 : INFO : Recall score for label_class 1: 0.9218
2024-08-15 17:16:05,525 : INFO : Recall score for label_class 2: 0.7826
2024-08-15 17:16:05,525 : INFO : Average F1 score: 0.8216
2024-08-15 17:16:06,075 : INFO : Average loss over validation batches: 0.3620
2024-08-15 17:16:06,076 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:06,076 : INFO : Validation metrics:
2024-08-15 17:16:06,076 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:06,078 : INFO : Accuracy: 0.8667
2024-08-15 17:16:06,078 : INFO : Precision score for label_class 0: 0.8125
2024-08-15 17:16:06,078 : INFO : Precision score for label_class 1: 0.9134
2024-08-15 17:16:06,078 : INFO : Precision score for label_class 2: 0.7906
2024-08-15 17:16:06,078 : INFO : Recall score for label_class 0: 0.7558
2024-08-15 17:16:06,078 : INFO : Recall score for label_class 1: 0.9225
2024-08-15 17:16:06,078 : INFO : Recall score for label_class 2: 0.7989
2024-08-15 17:16:06,078 : INFO : Average F1 score: 0.8319
2024-08-15 17:16:06,078 : INFO : Validation metric decreased (0.539938 --> 0.362013).  Saving model ...
2024-08-15 17:16:06,179 : INFO : Starting epoch 3
2024-08-15 17:16:06,633 : INFO : Current training batch loss: 0.2079 in epoch 3
2024-08-15 17:16:07,447 : INFO : Current training batch loss: 0.2200 in epoch 3
2024-08-15 17:16:08,262 : INFO : Current training batch loss: 0.3173 in epoch 3
2024-08-15 17:16:09,078 : INFO : Current training batch loss: 0.1489 in epoch 3
2024-08-15 17:16:09,632 : INFO : Epoch finished, average loss over training batches: 0.2228
2024-08-15 17:16:09,632 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:09,632 : INFO : Training metrics:
2024-08-15 17:16:09,632 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:09,636 : INFO : Accuracy: 0.9299
2024-08-15 17:16:09,636 : INFO : Precision score for label_class 0: 0.8442
2024-08-15 17:16:09,636 : INFO : Precision score for label_class 1: 0.9553
2024-08-15 17:16:09,636 : INFO : Precision score for label_class 2: 0.9156
2024-08-15 17:16:09,636 : INFO : Recall score for label_class 0: 0.9085
2024-08-15 17:16:09,636 : INFO : Recall score for label_class 1: 0.9547
2024-08-15 17:16:09,636 : INFO : Recall score for label_class 2: 0.8867
2024-08-15 17:16:09,636 : INFO : Average F1 score: 0.9104
2024-08-15 17:16:10,100 : INFO : Average loss over validation batches: 0.3624
2024-08-15 17:16:10,100 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:10,100 : INFO : Validation metrics:
2024-08-15 17:16:10,100 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:10,102 : INFO : Accuracy: 0.8667
2024-08-15 17:16:10,102 : INFO : Precision score for label_class 0: 0.8295
2024-08-15 17:16:10,102 : INFO : Precision score for label_class 1: 0.9405
2024-08-15 17:16:10,102 : INFO : Precision score for label_class 2: 0.7558
2024-08-15 17:16:10,102 : INFO : Recall score for label_class 0: 0.8488
2024-08-15 17:16:10,102 : INFO : Recall score for label_class 1: 0.8700
2024-08-15 17:16:10,102 : INFO : Recall score for label_class 2: 0.8677
2024-08-15 17:16:10,102 : INFO : Average F1 score: 0.8503
2024-08-15 17:16:10,102 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:16:10,102 : INFO : Starting epoch 4
2024-08-15 17:16:10,354 : INFO : Current training batch loss: 0.2937 in epoch 4
2024-08-15 17:16:11,169 : INFO : Current training batch loss: 0.1485 in epoch 4
2024-08-15 17:16:11,984 : INFO : Current training batch loss: 0.1653 in epoch 4
2024-08-15 17:16:12,800 : INFO : Current training batch loss: 0.1172 in epoch 4
2024-08-15 17:16:13,554 : INFO : Epoch finished, average loss over training batches: 0.1388
2024-08-15 17:16:13,555 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:13,555 : INFO : Training metrics:
2024-08-15 17:16:13,555 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:13,558 : INFO : Accuracy: 0.9640
2024-08-15 17:16:13,558 : INFO : Precision score for label_class 0: 0.8883
2024-08-15 17:16:13,558 : INFO : Precision score for label_class 1: 0.9831
2024-08-15 17:16:13,558 : INFO : Precision score for label_class 2: 0.9586
2024-08-15 17:16:13,558 : INFO : Recall score for label_class 0: 0.9451
2024-08-15 17:16:13,558 : INFO : Recall score for label_class 1: 0.9770
2024-08-15 17:16:13,558 : INFO : Recall score for label_class 2: 0.9447
2024-08-15 17:16:13,558 : INFO : Average F1 score: 0.9491
2024-08-15 17:16:14,024 : INFO : Average loss over validation batches: 0.3417
2024-08-15 17:16:14,025 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:14,025 : INFO : Validation metrics:
2024-08-15 17:16:14,025 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:14,027 : INFO : Accuracy: 0.8815
2024-08-15 17:16:14,027 : INFO : Precision score for label_class 0: 0.8111
2024-08-15 17:16:14,027 : INFO : Precision score for label_class 1: 0.9160
2024-08-15 17:16:14,027 : INFO : Precision score for label_class 2: 0.8389
2024-08-15 17:16:14,027 : INFO : Recall score for label_class 0: 0.8488
2024-08-15 17:16:14,027 : INFO : Recall score for label_class 1: 0.9275
2024-08-15 17:16:14,027 : INFO : Recall score for label_class 2: 0.7989
2024-08-15 17:16:14,027 : INFO : Average F1 score: 0.8566
2024-08-15 17:16:14,027 : INFO : Validation metric decreased (0.362013 --> 0.341689).  Saving model ...
2024-08-15 17:16:14,131 : INFO : Split 3 is finished, the score is: 0.8566
2024-08-15 17:16:14,131 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:14,131 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:14,131 : INFO : Starting training for split 4
2024-08-15 17:16:14,145 : INFO : Starting to tokenize the sequences.
2024-08-15 17:16:14,151 : INFO : Tokenization is finished.
2024-08-15 17:16:14,167 : INFO : Starting to tokenize the sequences.
2024-08-15 17:16:14,171 : INFO : Tokenization is finished.
2024-08-15 17:16:14,176 : INFO : Counting occurences of labels...
2024-08-15 17:16:14,177 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 327, 1621,  751]))
2024-08-15 17:16:14,177 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 87, 390, 197]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:16:14,217 : INFO : Starting epoch 1
2024-08-15 17:16:14,268 : INFO : Current training batch loss: 1.1178 in epoch 1
2024-08-15 17:16:15,083 : INFO : Current training batch loss: 0.9876 in epoch 1
2024-08-15 17:16:15,897 : INFO : Current training batch loss: 0.8053 in epoch 1
2024-08-15 17:16:16,714 : INFO : Current training batch loss: 0.6635 in epoch 1
2024-08-15 17:16:17,529 : INFO : Current training batch loss: 0.6038 in epoch 1
2024-08-15 17:16:17,680 : INFO : Epoch finished, average loss over training batches: 0.8106
2024-08-15 17:16:17,680 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:17,680 : INFO : Training metrics:
2024-08-15 17:16:17,680 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:17,688 : INFO : Accuracy: 0.6451
2024-08-15 17:16:17,688 : INFO : Precision score for label_class 0: 0.3000
2024-08-15 17:16:17,688 : INFO : Precision score for label_class 1: 0.7137
2024-08-15 17:16:17,688 : INFO : Precision score for label_class 2: 0.4713
2024-08-15 17:16:17,688 : INFO : Recall score for label_class 0: 0.0459
2024-08-15 17:16:17,688 : INFO : Recall score for label_class 1: 0.8674
2024-08-15 17:16:17,688 : INFO : Recall score for label_class 2: 0.4261
2024-08-15 17:16:17,688 : INFO : Average F1 score: 0.4367
2024-08-15 17:16:18,170 : INFO : Average loss over validation batches: 0.6381
2024-08-15 17:16:18,170 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:18,170 : INFO : Validation metrics:
2024-08-15 17:16:18,170 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:18,173 : INFO : Accuracy: 0.7641
2024-08-15 17:16:18,173 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:16:18,174 : INFO : Precision score for label_class 1: 0.8518
2024-08-15 17:16:18,174 : INFO : Precision score for label_class 2: 0.6145
2024-08-15 17:16:18,174 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:16:18,174 : INFO : Recall score for label_class 1: 0.9282
2024-08-15 17:16:18,174 : INFO : Recall score for label_class 2: 0.7766
2024-08-15 17:16:18,174 : INFO : Average F1 score: 0.5248
2024-08-15 17:16:18,174 : INFO : Validation metric decreased (inf --> 0.638079).  Saving model ...
2024-08-15 17:16:18,287 : INFO : Starting epoch 2
2024-08-15 17:16:18,944 : INFO : Current training batch loss: 0.6382 in epoch 2
2024-08-15 17:16:19,758 : INFO : Current training batch loss: 0.3603 in epoch 2
2024-08-15 17:16:20,573 : INFO : Current training batch loss: 0.2637 in epoch 2
2024-08-15 17:16:21,388 : INFO : Current training batch loss: 0.3394 in epoch 2
2024-08-15 17:16:21,740 : INFO : Epoch finished, average loss over training batches: 0.4514
2024-08-15 17:16:21,740 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:21,740 : INFO : Training metrics:
2024-08-15 17:16:21,740 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:21,745 : INFO : Accuracy: 0.8414
2024-08-15 17:16:21,745 : INFO : Precision score for label_class 0: 0.7611
2024-08-15 17:16:21,745 : INFO : Precision score for label_class 1: 0.8864
2024-08-15 17:16:21,745 : INFO : Precision score for label_class 2: 0.7663
2024-08-15 17:16:21,745 : INFO : Recall score for label_class 0: 0.5749
2024-08-15 17:16:21,745 : INFO : Recall score for label_class 1: 0.9291
2024-08-15 17:16:21,745 : INFO : Recall score for label_class 2: 0.7683
2024-08-15 17:16:21,745 : INFO : Average F1 score: 0.7765
2024-08-15 17:16:22,210 : INFO : Average loss over validation batches: 0.3876
2024-08-15 17:16:22,210 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:22,210 : INFO : Validation metrics:
2024-08-15 17:16:22,210 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:22,213 : INFO : Accuracy: 0.8709
2024-08-15 17:16:22,213 : INFO : Precision score for label_class 0: 0.8000
2024-08-15 17:16:22,213 : INFO : Precision score for label_class 1: 0.8859
2024-08-15 17:16:22,214 : INFO : Precision score for label_class 2: 0.8701
2024-08-15 17:16:22,214 : INFO : Recall score for label_class 0: 0.7816
2024-08-15 17:16:22,214 : INFO : Recall score for label_class 1: 0.9359
2024-08-15 17:16:22,214 : INFO : Recall score for label_class 2: 0.7817
2024-08-15 17:16:22,214 : INFO : Average F1 score: 0.8415
2024-08-15 17:16:22,214 : INFO : Validation metric decreased (0.638079 --> 0.387629).  Saving model ...
2024-08-15 17:16:22,315 : INFO : Starting epoch 3
2024-08-15 17:16:22,767 : INFO : Current training batch loss: 0.2089 in epoch 3
2024-08-15 17:16:23,576 : INFO : Current training batch loss: 0.2187 in epoch 3
2024-08-15 17:16:24,387 : INFO : Current training batch loss: 0.1327 in epoch 3
2024-08-15 17:16:25,197 : INFO : Current training batch loss: 0.1356 in epoch 3
2024-08-15 17:16:25,739 : INFO : Epoch finished, average loss over training batches: 0.2268
2024-08-15 17:16:25,739 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:25,739 : INFO : Training metrics:
2024-08-15 17:16:25,740 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:25,748 : INFO : Accuracy: 0.9315
2024-08-15 17:16:25,748 : INFO : Precision score for label_class 0: 0.8420
2024-08-15 17:16:25,748 : INFO : Precision score for label_class 1: 0.9558
2024-08-15 17:16:25,748 : INFO : Precision score for label_class 2: 0.9196
2024-08-15 17:16:25,749 : INFO : Recall score for label_class 0: 0.8960
2024-08-15 17:16:25,749 : INFO : Recall score for label_class 1: 0.9611
2024-08-15 17:16:25,749 : INFO : Recall score for label_class 2: 0.8828
2024-08-15 17:16:25,749 : INFO : Average F1 score: 0.9091
2024-08-15 17:16:26,217 : INFO : Average loss over validation batches: 0.3807
2024-08-15 17:16:26,217 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:26,217 : INFO : Validation metrics:
2024-08-15 17:16:26,217 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:26,221 : INFO : Accuracy: 0.8620
2024-08-15 17:16:26,221 : INFO : Precision score for label_class 0: 0.7684
2024-08-15 17:16:26,221 : INFO : Precision score for label_class 1: 0.9158
2024-08-15 17:16:26,221 : INFO : Precision score for label_class 2: 0.8040
2024-08-15 17:16:26,221 : INFO : Recall score for label_class 0: 0.8391
2024-08-15 17:16:26,221 : INFO : Recall score for label_class 1: 0.8923
2024-08-15 17:16:26,221 : INFO : Recall score for label_class 2: 0.8122
2024-08-15 17:16:26,221 : INFO : Average F1 score: 0.8381
2024-08-15 17:16:26,221 : INFO : Validation metric decreased (0.387629 --> 0.380653).  Saving model ...
2024-08-15 17:16:26,322 : INFO : Starting epoch 4
2024-08-15 17:16:26,573 : INFO : Current training batch loss: 0.2846 in epoch 4
2024-08-15 17:16:27,382 : INFO : Current training batch loss: 0.1854 in epoch 4
2024-08-15 17:16:28,192 : INFO : Current training batch loss: 0.1294 in epoch 4
2024-08-15 17:16:29,002 : INFO : Current training batch loss: 0.1612 in epoch 4
2024-08-15 17:16:29,744 : INFO : Epoch finished, average loss over training batches: 0.1345
2024-08-15 17:16:29,744 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:29,745 : INFO : Training metrics:
2024-08-15 17:16:29,745 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:29,753 : INFO : Accuracy: 0.9641
2024-08-15 17:16:29,753 : INFO : Precision score for label_class 0: 0.8908
2024-08-15 17:16:29,754 : INFO : Precision score for label_class 1: 0.9832
2024-08-15 17:16:29,754 : INFO : Precision score for label_class 2: 0.9569
2024-08-15 17:16:29,754 : INFO : Recall score for label_class 0: 0.9480
2024-08-15 17:16:29,754 : INFO : Recall score for label_class 1: 0.9753
2024-08-15 17:16:29,754 : INFO : Recall score for label_class 2: 0.9467
2024-08-15 17:16:29,754 : INFO : Average F1 score: 0.9499
2024-08-15 17:16:30,220 : INFO : Average loss over validation batches: 0.3740
2024-08-15 17:16:30,220 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:30,220 : INFO : Validation metrics:
2024-08-15 17:16:30,220 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:30,223 : INFO : Accuracy: 0.8724
2024-08-15 17:16:30,224 : INFO : Precision score for label_class 0: 0.7955
2024-08-15 17:16:30,224 : INFO : Precision score for label_class 1: 0.8897
2024-08-15 17:16:30,224 : INFO : Precision score for label_class 2: 0.8708
2024-08-15 17:16:30,224 : INFO : Recall score for label_class 0: 0.8046
2024-08-15 17:16:30,224 : INFO : Recall score for label_class 1: 0.9308
2024-08-15 17:16:30,224 : INFO : Recall score for label_class 2: 0.7868
2024-08-15 17:16:30,224 : INFO : Average F1 score: 0.8455
2024-08-15 17:16:30,224 : INFO : Validation metric decreased (0.380653 --> 0.374036).  Saving model ...
2024-08-15 17:16:30,322 : INFO : Split 4 is finished, the score is: 0.8455
2024-08-15 17:16:30,322 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:30,322 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:30,322 : INFO : Starting training for split 5
2024-08-15 17:16:30,338 : INFO : Starting to tokenize the sequences.
2024-08-15 17:16:30,343 : INFO : Tokenization is finished.
2024-08-15 17:16:30,359 : INFO : Starting to tokenize the sequences.
2024-08-15 17:16:30,364 : INFO : Tokenization is finished.
2024-08-15 17:16:30,368 : INFO : Counting occurences of labels...
2024-08-15 17:16:30,369 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 330, 1615,  754]))
2024-08-15 17:16:30,370 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 84, 396, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:16:30,410 : INFO : Starting epoch 1
2024-08-15 17:16:30,461 : INFO : Current training batch loss: 1.0830 in epoch 1
2024-08-15 17:16:31,271 : INFO : Current training batch loss: 0.9853 in epoch 1
2024-08-15 17:16:32,081 : INFO : Current training batch loss: 0.7105 in epoch 1
2024-08-15 17:16:32,891 : INFO : Current training batch loss: 0.6050 in epoch 1
2024-08-15 17:16:33,701 : INFO : Current training batch loss: 0.5535 in epoch 1
2024-08-15 17:16:33,844 : INFO : Epoch finished, average loss over training batches: 0.7613
2024-08-15 17:16:33,844 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:33,844 : INFO : Training metrics:
2024-08-15 17:16:33,844 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:33,857 : INFO : Accuracy: 0.6995
2024-08-15 17:16:33,857 : INFO : Precision score for label_class 0: 0.7500
2024-08-15 17:16:33,857 : INFO : Precision score for label_class 1: 0.7314
2024-08-15 17:16:33,857 : INFO : Precision score for label_class 2: 0.5866
2024-08-15 17:16:33,857 : INFO : Recall score for label_class 0: 0.0182
2024-08-15 17:16:33,857 : INFO : Recall score for label_class 1: 0.9492
2024-08-15 17:16:33,857 : INFO : Recall score for label_class 2: 0.4629
2024-08-15 17:16:33,857 : INFO : Average F1 score: 0.4597
2024-08-15 17:16:34,323 : INFO : Average loss over validation batches: 0.5125
2024-08-15 17:16:34,323 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:34,323 : INFO : Validation metrics:
2024-08-15 17:16:34,323 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:34,327 : INFO : Accuracy: 0.8027
2024-08-15 17:16:34,327 : INFO : Precision score for label_class 0: 0.8235
2024-08-15 17:16:34,327 : INFO : Precision score for label_class 1: 0.8483
2024-08-15 17:16:34,327 : INFO : Precision score for label_class 2: 0.7024
2024-08-15 17:16:34,327 : INFO : Recall score for label_class 0: 0.3333
2024-08-15 17:16:34,327 : INFO : Recall score for label_class 1: 0.9318
2024-08-15 17:16:34,327 : INFO : Recall score for label_class 2: 0.7423
2024-08-15 17:16:34,327 : INFO : Average F1 score: 0.6948
2024-08-15 17:16:34,327 : INFO : Validation metric decreased (inf --> 0.512472).  Saving model ...
2024-08-15 17:16:34,431 : INFO : Starting epoch 2
2024-08-15 17:16:35,081 : INFO : Current training batch loss: 0.4585 in epoch 2
2024-08-15 17:16:35,890 : INFO : Current training batch loss: 0.3146 in epoch 2
2024-08-15 17:16:36,700 : INFO : Current training batch loss: 0.2389 in epoch 2
2024-08-15 17:16:37,511 : INFO : Current training batch loss: 0.3450 in epoch 2
2024-08-15 17:16:37,854 : INFO : Epoch finished, average loss over training batches: 0.3686
2024-08-15 17:16:37,854 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:37,854 : INFO : Training metrics:
2024-08-15 17:16:37,854 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:37,866 : INFO : Accuracy: 0.8788
2024-08-15 17:16:37,866 : INFO : Precision score for label_class 0: 0.7950
2024-08-15 17:16:37,866 : INFO : Precision score for label_class 1: 0.9077
2024-08-15 17:16:37,866 : INFO : Precision score for label_class 2: 0.8485
2024-08-15 17:16:37,866 : INFO : Recall score for label_class 0: 0.7636
2024-08-15 17:16:37,866 : INFO : Recall score for label_class 1: 0.9381
2024-08-15 17:16:37,866 : INFO : Recall score for label_class 2: 0.8024
2024-08-15 17:16:37,866 : INFO : Average F1 score: 0.8421
2024-08-15 17:16:38,332 : INFO : Average loss over validation batches: 0.4208
2024-08-15 17:16:38,332 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:38,332 : INFO : Validation metrics:
2024-08-15 17:16:38,332 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:38,336 : INFO : Accuracy: 0.8368
2024-08-15 17:16:38,336 : INFO : Precision score for label_class 0: 0.8333
2024-08-15 17:16:38,336 : INFO : Precision score for label_class 1: 0.8706
2024-08-15 17:16:38,336 : INFO : Precision score for label_class 2: 0.7641
2024-08-15 17:16:38,336 : INFO : Recall score for label_class 0: 0.5357
2024-08-15 17:16:38,336 : INFO : Recall score for label_class 1: 0.9343
2024-08-15 17:16:38,336 : INFO : Recall score for label_class 2: 0.7680
2024-08-15 17:16:38,336 : INFO : Average F1 score: 0.7732
2024-08-15 17:16:38,336 : INFO : Validation metric decreased (0.512472 --> 0.420813).  Saving model ...
2024-08-15 17:16:38,438 : INFO : Starting epoch 3
2024-08-15 17:16:38,888 : INFO : Current training batch loss: 0.1029 in epoch 3
2024-08-15 17:16:39,697 : INFO : Current training batch loss: 0.3305 in epoch 3
2024-08-15 17:16:40,507 : INFO : Current training batch loss: 0.0948 in epoch 3
2024-08-15 17:16:41,317 : INFO : Current training batch loss: 0.1710 in epoch 3
2024-08-15 17:16:41,868 : INFO : Epoch finished, average loss over training batches: 0.1962
2024-08-15 17:16:41,869 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:41,869 : INFO : Training metrics:
2024-08-15 17:16:41,869 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:41,876 : INFO : Accuracy: 0.9444
2024-08-15 17:16:41,876 : INFO : Precision score for label_class 0: 0.8824
2024-08-15 17:16:41,876 : INFO : Precision score for label_class 1: 0.9607
2024-08-15 17:16:41,876 : INFO : Precision score for label_class 2: 0.9370
2024-08-15 17:16:41,876 : INFO : Recall score for label_class 0: 0.9091
2024-08-15 17:16:41,876 : INFO : Recall score for label_class 1: 0.9690
2024-08-15 17:16:41,876 : INFO : Recall score for label_class 2: 0.9072
2024-08-15 17:16:41,876 : INFO : Average F1 score: 0.9274
2024-08-15 17:16:42,344 : INFO : Average loss over validation batches: 0.4400
2024-08-15 17:16:42,345 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:42,345 : INFO : Validation metrics:
2024-08-15 17:16:42,345 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:42,348 : INFO : Accuracy: 0.8442
2024-08-15 17:16:42,348 : INFO : Precision score for label_class 0: 0.7722
2024-08-15 17:16:42,348 : INFO : Precision score for label_class 1: 0.8947
2024-08-15 17:16:42,348 : INFO : Precision score for label_class 2: 0.7704
2024-08-15 17:16:42,348 : INFO : Recall score for label_class 0: 0.7262
2024-08-15 17:16:42,348 : INFO : Recall score for label_class 1: 0.9015
2024-08-15 17:16:42,348 : INFO : Recall score for label_class 2: 0.7784
2024-08-15 17:16:42,348 : INFO : Average F1 score: 0.8070
2024-08-15 17:16:42,348 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:16:42,348 : INFO : Starting epoch 4
2024-08-15 17:16:42,599 : INFO : Current training batch loss: 0.3079 in epoch 4
2024-08-15 17:16:43,414 : INFO : Current training batch loss: 0.1142 in epoch 4
2024-08-15 17:16:44,229 : INFO : Current training batch loss: 0.1133 in epoch 4
2024-08-15 17:16:45,044 : INFO : Current training batch loss: 0.0628 in epoch 4
2024-08-15 17:16:45,802 : INFO : Epoch finished, average loss over training batches: 0.1212
2024-08-15 17:16:45,803 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:45,803 : INFO : Training metrics:
2024-08-15 17:16:45,803 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:45,810 : INFO : Accuracy: 0.9700
2024-08-15 17:16:45,810 : INFO : Precision score for label_class 0: 0.9120
2024-08-15 17:16:45,810 : INFO : Precision score for label_class 1: 0.9826
2024-08-15 17:16:45,810 : INFO : Precision score for label_class 2: 0.9691
2024-08-15 17:16:45,810 : INFO : Recall score for label_class 0: 0.9424
2024-08-15 17:16:45,810 : INFO : Recall score for label_class 1: 0.9814
2024-08-15 17:16:45,810 : INFO : Recall score for label_class 2: 0.9576
2024-08-15 17:16:45,810 : INFO : Average F1 score: 0.9574
2024-08-15 17:16:46,277 : INFO : Average loss over validation batches: 0.4275
2024-08-15 17:16:46,277 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:46,277 : INFO : Validation metrics:
2024-08-15 17:16:46,277 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:46,281 : INFO : Accuracy: 0.8457
2024-08-15 17:16:46,281 : INFO : Precision score for label_class 0: 0.7529
2024-08-15 17:16:46,281 : INFO : Precision score for label_class 1: 0.8959
2024-08-15 17:16:46,281 : INFO : Precision score for label_class 2: 0.7846
2024-08-15 17:16:46,281 : INFO : Recall score for label_class 0: 0.7619
2024-08-15 17:16:46,281 : INFO : Recall score for label_class 1: 0.8914
2024-08-15 17:16:46,281 : INFO : Recall score for label_class 2: 0.7887
2024-08-15 17:16:46,281 : INFO : Average F1 score: 0.8126
2024-08-15 17:16:46,281 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:16:46,281 : INFO : Last epoch reached, validation loss was better before, loading best model during training.
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:16:46,316 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:16:46,831 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:46,832 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:16:46,832 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:46,835 : INFO : Accuracy: 0.8368
2024-08-15 17:16:46,836 : INFO : Precision score for label_class 0: 0.8333
2024-08-15 17:16:46,836 : INFO : Precision score for label_class 1: 0.8706
2024-08-15 17:16:46,836 : INFO : Precision score for label_class 2: 0.7641
2024-08-15 17:16:46,836 : INFO : Recall score for label_class 0: 0.5357
2024-08-15 17:16:46,836 : INFO : Recall score for label_class 1: 0.9343
2024-08-15 17:16:46,836 : INFO : Recall score for label_class 2: 0.7680
2024-08-15 17:16:46,836 : INFO : Average F1 score: 0.7732
2024-08-15 17:16:46,836 : INFO : Determined score from best model, ending training.
2024-08-15 17:16:46,842 : INFO : Split 5 is finished, the score is: 0.7732
2024-08-15 17:16:46,842 : INFO : ----------------------------------------------------------------------------------------------------
[I 2024-08-15 17:16:46,852] Trial 5 finished with value: 0.8392225565613984 and parameters: {'n_epochs': 4, 'learning_rate': 8.029860127308946e-05, 'classifier_dropout': 0.22352191393496393, 'warmup_step_fraction': 0.05037845880049103, 'use_gradient_clipping': False}. Best is trial 1 with value: 0.8513001269595835.
2024-08-15 17:16:46,852 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:46,852 : INFO : Starting training for split 1
2024-08-15 17:16:46,865 : INFO : Starting to tokenize the sequences.
2024-08-15 17:16:46,870 : INFO : Tokenization is finished.
2024-08-15 17:16:46,882 : INFO : Starting to tokenize the sequences.
2024-08-15 17:16:46,887 : INFO : Tokenization is finished.
2024-08-15 17:16:46,888 : INFO : Counting occurences of labels...
2024-08-15 17:16:46,888 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1596,  774]))
2024-08-15 17:16:46,889 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 415, 174]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:16:46,940 : INFO : Starting epoch 1
2024-08-15 17:16:46,991 : INFO : Current training batch loss: 1.0938 in epoch 1
2024-08-15 17:16:47,816 : INFO : Current training batch loss: 0.8559 in epoch 1
2024-08-15 17:16:48,630 : INFO : Current training batch loss: 0.8450 in epoch 1
2024-08-15 17:16:49,446 : INFO : Current training batch loss: 0.6815 in epoch 1
2024-08-15 17:16:50,261 : INFO : Current training batch loss: 0.6793 in epoch 1
2024-08-15 17:16:50,411 : INFO : Epoch finished, average loss over training batches: 0.8209
2024-08-15 17:16:50,412 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:50,412 : INFO : Training metrics:
2024-08-15 17:16:50,412 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:50,417 : INFO : Accuracy: 0.6686
2024-08-15 17:16:50,417 : INFO : Precision score for label_class 0: 0.1429
2024-08-15 17:16:50,417 : INFO : Precision score for label_class 1: 0.7006
2024-08-15 17:16:50,417 : INFO : Precision score for label_class 2: 0.5568
2024-08-15 17:16:50,417 : INFO : Recall score for label_class 0: 0.0091
2024-08-15 17:16:50,417 : INFO : Recall score for label_class 1: 0.9474
2024-08-15 17:16:50,417 : INFO : Recall score for label_class 2: 0.3734
2024-08-15 17:16:50,417 : INFO : Average F1 score: 0.4233
2024-08-15 17:16:50,882 : INFO : Average loss over validation batches: 0.6138
2024-08-15 17:16:50,883 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:50,883 : INFO : Validation metrics:
2024-08-15 17:16:50,883 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:50,885 : INFO : Accuracy: 0.7467
2024-08-15 17:16:50,885 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:16:50,885 : INFO : Precision score for label_class 1: 0.8607
2024-08-15 17:16:50,885 : INFO : Precision score for label_class 2: 0.5359
2024-08-15 17:16:50,885 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:16:50,885 : INFO : Recall score for label_class 1: 0.9084
2024-08-15 17:16:50,885 : INFO : Recall score for label_class 2: 0.7299
2024-08-15 17:16:50,885 : INFO : Average F1 score: 0.5006
2024-08-15 17:16:50,885 : INFO : Validation metric decreased (inf --> 0.613790).  Saving model ...
2024-08-15 17:16:50,995 : INFO : Starting epoch 2
2024-08-15 17:16:51,649 : INFO : Current training batch loss: 0.3155 in epoch 2
2024-08-15 17:16:52,464 : INFO : Current training batch loss: 0.5665 in epoch 2
2024-08-15 17:16:53,277 : INFO : Current training batch loss: 0.4134 in epoch 2
2024-08-15 17:16:54,092 : INFO : Current training batch loss: 0.3608 in epoch 2
2024-08-15 17:16:54,444 : INFO : Epoch finished, average loss over training batches: 0.4611
2024-08-15 17:16:54,444 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:54,444 : INFO : Training metrics:
2024-08-15 17:16:54,444 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:54,449 : INFO : Accuracy: 0.8451
2024-08-15 17:16:54,449 : INFO : Precision score for label_class 0: 0.7876
2024-08-15 17:16:54,449 : INFO : Precision score for label_class 1: 0.8833
2024-08-15 17:16:54,449 : INFO : Precision score for label_class 2: 0.7781
2024-08-15 17:16:54,449 : INFO : Recall score for label_class 0: 0.5427
2024-08-15 17:16:54,449 : INFO : Recall score for label_class 1: 0.9392
2024-08-15 17:16:54,449 : INFO : Recall score for label_class 2: 0.7791
2024-08-15 17:16:54,449 : INFO : Average F1 score: 0.7772
2024-08-15 17:16:54,913 : INFO : Average loss over validation batches: 0.3643
2024-08-15 17:16:54,914 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:54,914 : INFO : Validation metrics:
2024-08-15 17:16:54,914 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:54,917 : INFO : Accuracy: 0.8785
2024-08-15 17:16:54,917 : INFO : Precision score for label_class 0: 0.7789
2024-08-15 17:16:54,917 : INFO : Precision score for label_class 1: 0.9059
2024-08-15 17:16:54,917 : INFO : Precision score for label_class 2: 0.8645
2024-08-15 17:16:54,917 : INFO : Recall score for label_class 0: 0.8605
2024-08-15 17:16:54,917 : INFO : Recall score for label_class 1: 0.9277
2024-08-15 17:16:54,917 : INFO : Recall score for label_class 2: 0.7701
2024-08-15 17:16:54,917 : INFO : Average F1 score: 0.8496
2024-08-15 17:16:54,917 : INFO : Validation metric decreased (0.613790 --> 0.364268).  Saving model ...
2024-08-15 17:16:55,017 : INFO : Starting epoch 3
2024-08-15 17:16:55,470 : INFO : Current training batch loss: 0.2976 in epoch 3
2024-08-15 17:16:56,285 : INFO : Current training batch loss: 0.2706 in epoch 3
2024-08-15 17:16:57,099 : INFO : Current training batch loss: 0.2286 in epoch 3
2024-08-15 17:16:57,913 : INFO : Current training batch loss: 0.1769 in epoch 3
2024-08-15 17:16:58,465 : INFO : Epoch finished, average loss over training batches: 0.2766
2024-08-15 17:16:58,466 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:58,466 : INFO : Training metrics:
2024-08-15 17:16:58,466 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:58,471 : INFO : Accuracy: 0.9155
2024-08-15 17:16:58,471 : INFO : Precision score for label_class 0: 0.8363
2024-08-15 17:16:58,471 : INFO : Precision score for label_class 1: 0.9406
2024-08-15 17:16:58,471 : INFO : Precision score for label_class 2: 0.8969
2024-08-15 17:16:58,471 : INFO : Recall score for label_class 0: 0.8567
2024-08-15 17:16:58,471 : INFO : Recall score for label_class 1: 0.9518
2024-08-15 17:16:58,471 : INFO : Recall score for label_class 2: 0.8656
2024-08-15 17:16:58,471 : INFO : Average F1 score: 0.8912
2024-08-15 17:16:58,936 : INFO : Average loss over validation batches: 0.3165
2024-08-15 17:16:58,937 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:58,937 : INFO : Validation metrics:
2024-08-15 17:16:58,937 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:16:58,940 : INFO : Accuracy: 0.8919
2024-08-15 17:16:58,940 : INFO : Precision score for label_class 0: 0.8061
2024-08-15 17:16:58,940 : INFO : Precision score for label_class 1: 0.9333
2024-08-15 17:16:58,940 : INFO : Precision score for label_class 2: 0.8430
2024-08-15 17:16:58,940 : INFO : Recall score for label_class 0: 0.9186
2024-08-15 17:16:58,940 : INFO : Recall score for label_class 1: 0.9108
2024-08-15 17:16:58,940 : INFO : Recall score for label_class 2: 0.8333
2024-08-15 17:16:58,940 : INFO : Average F1 score: 0.8729
2024-08-15 17:16:58,940 : INFO : Validation metric decreased (0.364268 --> 0.316478).  Saving model ...
2024-08-15 17:16:59,043 : INFO : Starting epoch 4
2024-08-15 17:16:59,295 : INFO : Current training batch loss: 0.5023 in epoch 4
2024-08-15 17:17:00,109 : INFO : Current training batch loss: 0.1186 in epoch 4
2024-08-15 17:17:00,923 : INFO : Current training batch loss: 0.2931 in epoch 4
2024-08-15 17:17:01,738 : INFO : Current training batch loss: 0.1895 in epoch 4
2024-08-15 17:17:02,501 : INFO : Epoch finished, average loss over training batches: 0.1772
2024-08-15 17:17:02,501 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:02,501 : INFO : Training metrics:
2024-08-15 17:17:02,501 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:02,507 : INFO : Accuracy: 0.9537
2024-08-15 17:17:02,507 : INFO : Precision score for label_class 0: 0.8739
2024-08-15 17:17:02,507 : INFO : Precision score for label_class 1: 0.9671
2024-08-15 17:17:02,507 : INFO : Precision score for label_class 2: 0.9621
2024-08-15 17:17:02,507 : INFO : Recall score for label_class 0: 0.9299
2024-08-15 17:17:02,507 : INFO : Recall score for label_class 1: 0.9756
2024-08-15 17:17:02,507 : INFO : Recall score for label_class 2: 0.9186
2024-08-15 17:17:02,507 : INFO : Average F1 score: 0.9374
2024-08-15 17:17:02,980 : INFO : Average loss over validation batches: 0.3165
2024-08-15 17:17:02,980 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:02,980 : INFO : Validation metrics:
2024-08-15 17:17:02,980 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:02,983 : INFO : Accuracy: 0.8844
2024-08-15 17:17:02,983 : INFO : Precision score for label_class 0: 0.8144
2024-08-15 17:17:02,983 : INFO : Precision score for label_class 1: 0.9504
2024-08-15 17:17:02,983 : INFO : Precision score for label_class 2: 0.7897
2024-08-15 17:17:02,983 : INFO : Recall score for label_class 0: 0.9186
2024-08-15 17:17:02,983 : INFO : Recall score for label_class 1: 0.8771
2024-08-15 17:17:02,983 : INFO : Recall score for label_class 2: 0.8851
2024-08-15 17:17:02,983 : INFO : Average F1 score: 0.8701
2024-08-15 17:17:02,983 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:17:02,983 : INFO : Starting epoch 5
2024-08-15 17:17:03,035 : INFO : Current training batch loss: 0.0971 in epoch 5
2024-08-15 17:17:03,922 : INFO : Current training batch loss: 0.2409 in epoch 5
2024-08-15 17:17:04,760 : INFO : Current training batch loss: 0.1351 in epoch 5
2024-08-15 17:17:05,570 : INFO : Current training batch loss: 0.1118 in epoch 5
2024-08-15 17:17:06,381 : INFO : Current training batch loss: 0.2881 in epoch 5
2024-08-15 17:17:06,524 : INFO : Epoch finished, average loss over training batches: 0.1332
2024-08-15 17:17:06,524 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:06,524 : INFO : Training metrics:
2024-08-15 17:17:06,524 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:06,534 : INFO : Accuracy: 0.9703
2024-08-15 17:17:06,534 : INFO : Precision score for label_class 0: 0.9020
2024-08-15 17:17:06,534 : INFO : Precision score for label_class 1: 0.9837
2024-08-15 17:17:06,534 : INFO : Precision score for label_class 2: 0.9736
2024-08-15 17:17:06,534 : INFO : Recall score for label_class 0: 0.9543
2024-08-15 17:17:06,534 : INFO : Recall score for label_class 1: 0.9818
2024-08-15 17:17:06,534 : INFO : Recall score for label_class 2: 0.9535
2024-08-15 17:17:06,534 : INFO : Average F1 score: 0.9579
2024-08-15 17:17:07,000 : INFO : Average loss over validation batches: 0.3066
2024-08-15 17:17:07,000 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:07,000 : INFO : Validation metrics:
2024-08-15 17:17:07,000 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:07,003 : INFO : Accuracy: 0.8978
2024-08-15 17:17:07,003 : INFO : Precision score for label_class 0: 0.8172
2024-08-15 17:17:07,003 : INFO : Precision score for label_class 1: 0.9198
2024-08-15 17:17:07,003 : INFO : Precision score for label_class 2: 0.8861
2024-08-15 17:17:07,003 : INFO : Recall score for label_class 0: 0.8837
2024-08-15 17:17:07,003 : INFO : Recall score for label_class 1: 0.9398
2024-08-15 17:17:07,003 : INFO : Recall score for label_class 2: 0.8046
2024-08-15 17:17:07,003 : INFO : Average F1 score: 0.8741
2024-08-15 17:17:07,003 : INFO : Validation metric decreased (0.316478 --> 0.306647).  Saving model ...
2024-08-15 17:17:07,103 : INFO : Split 1 is finished, the score is: 0.8741
2024-08-15 17:17:07,103 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:07,103 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:07,103 : INFO : Starting training for split 2
2024-08-15 17:17:07,118 : INFO : Starting to tokenize the sequences.
2024-08-15 17:17:07,124 : INFO : Tokenization is finished.
2024-08-15 17:17:07,141 : INFO : Starting to tokenize the sequences.
2024-08-15 17:17:07,146 : INFO : Tokenization is finished.
2024-08-15 17:17:07,150 : INFO : Counting occurences of labels...
2024-08-15 17:17:07,151 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 343, 1601,  754]))
2024-08-15 17:17:07,152 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 71, 410, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:17:07,196 : INFO : Starting epoch 1
2024-08-15 17:17:07,248 : INFO : Current training batch loss: 1.0958 in epoch 1
2024-08-15 17:17:08,064 : INFO : Current training batch loss: 0.9977 in epoch 1
2024-08-15 17:17:08,878 : INFO : Current training batch loss: 0.8701 in epoch 1
2024-08-15 17:17:09,693 : INFO : Current training batch loss: 0.6939 in epoch 1
2024-08-15 17:17:10,508 : INFO : Current training batch loss: 0.6701 in epoch 1
2024-08-15 17:17:10,658 : INFO : Epoch finished, average loss over training batches: 0.8327
2024-08-15 17:17:10,658 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:10,658 : INFO : Training metrics:
2024-08-15 17:17:10,658 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:10,666 : INFO : Accuracy: 0.6660
2024-08-15 17:17:10,666 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:17:10,666 : INFO : Precision score for label_class 1: 0.7011
2024-08-15 17:17:10,666 : INFO : Precision score for label_class 2: 0.5283
2024-08-15 17:17:10,666 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:17:10,666 : INFO : Recall score for label_class 1: 0.9419
2024-08-15 17:17:10,666 : INFO : Recall score for label_class 2: 0.3833
2024-08-15 17:17:10,666 : INFO : Average F1 score: 0.4160
2024-08-15 17:17:11,133 : INFO : Average loss over validation batches: 0.5876
2024-08-15 17:17:11,134 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:11,134 : INFO : Validation metrics:
2024-08-15 17:17:11,134 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:11,138 : INFO : Accuracy: 0.7911
2024-08-15 17:17:11,138 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:17:11,138 : INFO : Precision score for label_class 1: 0.8463
2024-08-15 17:17:11,138 : INFO : Precision score for label_class 2: 0.6714
2024-08-15 17:17:11,138 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:17:11,138 : INFO : Recall score for label_class 1: 0.9537
2024-08-15 17:17:11,138 : INFO : Recall score for label_class 2: 0.7371
2024-08-15 17:17:11,138 : INFO : Average F1 score: 0.5332
2024-08-15 17:17:11,138 : INFO : Validation metric decreased (inf --> 0.587633).  Saving model ...
2024-08-15 17:17:11,239 : INFO : Starting epoch 2
2024-08-15 17:17:11,980 : INFO : Current training batch loss: 0.5983 in epoch 2
2024-08-15 17:17:12,794 : INFO : Current training batch loss: 0.6033 in epoch 2
2024-08-15 17:17:13,609 : INFO : Current training batch loss: 0.4183 in epoch 2
2024-08-15 17:17:14,423 : INFO : Current training batch loss: 0.3319 in epoch 2
2024-08-15 17:17:14,775 : INFO : Epoch finished, average loss over training batches: 0.4877
2024-08-15 17:17:14,775 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:14,775 : INFO : Training metrics:
2024-08-15 17:17:14,775 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:14,786 : INFO : Accuracy: 0.8247
2024-08-15 17:17:14,786 : INFO : Precision score for label_class 0: 0.8228
2024-08-15 17:17:14,786 : INFO : Precision score for label_class 1: 0.8783
2024-08-15 17:17:14,786 : INFO : Precision score for label_class 2: 0.7129
2024-08-15 17:17:14,786 : INFO : Recall score for label_class 0: 0.3790
2024-08-15 17:17:14,786 : INFO : Recall score for label_class 1: 0.9425
2024-08-15 17:17:14,786 : INFO : Recall score for label_class 2: 0.7772
2024-08-15 17:17:14,786 : INFO : Average F1 score: 0.7240
2024-08-15 17:17:15,253 : INFO : Average loss over validation batches: 0.3974
2024-08-15 17:17:15,253 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:15,253 : INFO : Validation metrics:
2024-08-15 17:17:15,253 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:15,257 : INFO : Accuracy: 0.8667
2024-08-15 17:17:15,257 : INFO : Precision score for label_class 0: 0.7067
2024-08-15 17:17:15,257 : INFO : Precision score for label_class 1: 0.8805
2024-08-15 17:17:15,257 : INFO : Precision score for label_class 2: 0.9030
2024-08-15 17:17:15,257 : INFO : Recall score for label_class 0: 0.7465
2024-08-15 17:17:15,257 : INFO : Recall score for label_class 1: 0.9341
2024-08-15 17:17:15,257 : INFO : Recall score for label_class 2: 0.7680
2024-08-15 17:17:15,257 : INFO : Average F1 score: 0.8209
2024-08-15 17:17:15,257 : INFO : Validation metric decreased (0.587633 --> 0.397427).  Saving model ...
2024-08-15 17:17:15,359 : INFO : Starting epoch 3
2024-08-15 17:17:15,812 : INFO : Current training batch loss: 0.2695 in epoch 3
2024-08-15 17:17:16,628 : INFO : Current training batch loss: 0.2669 in epoch 3
2024-08-15 17:17:17,443 : INFO : Current training batch loss: 0.3258 in epoch 3
2024-08-15 17:17:18,268 : INFO : Current training batch loss: 0.1395 in epoch 3
2024-08-15 17:17:18,821 : INFO : Epoch finished, average loss over training batches: 0.2780
2024-08-15 17:17:18,822 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:18,822 : INFO : Training metrics:
2024-08-15 17:17:18,822 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:18,829 : INFO : Accuracy: 0.9162
2024-08-15 17:17:18,829 : INFO : Precision score for label_class 0: 0.8416
2024-08-15 17:17:18,829 : INFO : Precision score for label_class 1: 0.9419
2024-08-15 17:17:18,829 : INFO : Precision score for label_class 2: 0.8945
2024-08-15 17:17:18,829 : INFO : Recall score for label_class 0: 0.8367
2024-08-15 17:17:18,829 : INFO : Recall score for label_class 1: 0.9519
2024-08-15 17:17:18,829 : INFO : Recall score for label_class 2: 0.8767
2024-08-15 17:17:18,829 : INFO : Average F1 score: 0.8905
2024-08-15 17:17:19,296 : INFO : Average loss over validation batches: 0.3574
2024-08-15 17:17:19,297 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:19,297 : INFO : Validation metrics:
2024-08-15 17:17:19,297 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:19,300 : INFO : Accuracy: 0.8756
2024-08-15 17:17:19,300 : INFO : Precision score for label_class 0: 0.7595
2024-08-15 17:17:19,300 : INFO : Precision score for label_class 1: 0.9156
2024-08-15 17:17:19,300 : INFO : Precision score for label_class 2: 0.8394
2024-08-15 17:17:19,300 : INFO : Recall score for label_class 0: 0.8451
2024-08-15 17:17:19,300 : INFO : Recall score for label_class 1: 0.9000
2024-08-15 17:17:19,300 : INFO : Recall score for label_class 2: 0.8351
2024-08-15 17:17:19,300 : INFO : Average F1 score: 0.8483
2024-08-15 17:17:19,300 : INFO : Validation metric decreased (0.397427 --> 0.357389).  Saving model ...
2024-08-15 17:17:19,406 : INFO : Starting epoch 4
2024-08-15 17:17:19,657 : INFO : Current training batch loss: 0.3035 in epoch 4
2024-08-15 17:17:20,472 : INFO : Current training batch loss: 0.1264 in epoch 4
2024-08-15 17:17:21,287 : INFO : Current training batch loss: 0.3491 in epoch 4
2024-08-15 17:17:22,102 : INFO : Current training batch loss: 0.1789 in epoch 4
2024-08-15 17:17:22,855 : INFO : Epoch finished, average loss over training batches: 0.1825
2024-08-15 17:17:22,856 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:22,856 : INFO : Training metrics:
2024-08-15 17:17:22,856 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:22,866 : INFO : Accuracy: 0.9540
2024-08-15 17:17:22,866 : INFO : Precision score for label_class 0: 0.8924
2024-08-15 17:17:22,866 : INFO : Precision score for label_class 1: 0.9661
2024-08-15 17:17:22,866 : INFO : Precision score for label_class 2: 0.9571
2024-08-15 17:17:22,866 : INFO : Recall score for label_class 0: 0.9184
2024-08-15 17:17:22,866 : INFO : Recall score for label_class 1: 0.9788
2024-08-15 17:17:22,866 : INFO : Recall score for label_class 2: 0.9178
2024-08-15 17:17:22,866 : INFO : Average F1 score: 0.9382
2024-08-15 17:17:23,333 : INFO : Average loss over validation batches: 0.3717
2024-08-15 17:17:23,333 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:23,333 : INFO : Validation metrics:
2024-08-15 17:17:23,333 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:23,337 : INFO : Accuracy: 0.8741
2024-08-15 17:17:23,337 : INFO : Precision score for label_class 0: 0.7176
2024-08-15 17:17:23,337 : INFO : Precision score for label_class 1: 0.9156
2024-08-15 17:17:23,337 : INFO : Precision score for label_class 2: 0.8556
2024-08-15 17:17:23,337 : INFO : Recall score for label_class 0: 0.8592
2024-08-15 17:17:23,337 : INFO : Recall score for label_class 1: 0.9000
2024-08-15 17:17:23,337 : INFO : Recall score for label_class 2: 0.8247
2024-08-15 17:17:23,337 : INFO : Average F1 score: 0.8432
2024-08-15 17:17:23,337 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:17:23,337 : INFO : Starting epoch 5
2024-08-15 17:17:23,388 : INFO : Current training batch loss: 0.1429 in epoch 5
2024-08-15 17:17:24,203 : INFO : Current training batch loss: 0.2716 in epoch 5
2024-08-15 17:17:25,018 : INFO : Current training batch loss: 0.0894 in epoch 5
2024-08-15 17:17:25,834 : INFO : Current training batch loss: 0.1312 in epoch 5
2024-08-15 17:17:26,650 : INFO : Current training batch loss: 0.2542 in epoch 5
2024-08-15 17:17:26,800 : INFO : Epoch finished, average loss over training batches: 0.1419
2024-08-15 17:17:26,800 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:26,800 : INFO : Training metrics:
2024-08-15 17:17:26,800 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:26,810 : INFO : Accuracy: 0.9681
2024-08-15 17:17:26,810 : INFO : Precision score for label_class 0: 0.9081
2024-08-15 17:17:26,810 : INFO : Precision score for label_class 1: 0.9819
2024-08-15 17:17:26,810 : INFO : Precision score for label_class 2: 0.9676
2024-08-15 17:17:26,810 : INFO : Recall score for label_class 0: 0.9504
2024-08-15 17:17:26,810 : INFO : Recall score for label_class 1: 0.9806
2024-08-15 17:17:26,810 : INFO : Recall score for label_class 2: 0.9496
2024-08-15 17:17:26,810 : INFO : Average F1 score: 0.9562
2024-08-15 17:17:27,275 : INFO : Average loss over validation batches: 0.3639
2024-08-15 17:17:27,276 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:27,276 : INFO : Validation metrics:
2024-08-15 17:17:27,276 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:27,279 : INFO : Accuracy: 0.8770
2024-08-15 17:17:27,279 : INFO : Precision score for label_class 0: 0.7808
2024-08-15 17:17:27,279 : INFO : Precision score for label_class 1: 0.8946
2024-08-15 17:17:27,279 : INFO : Precision score for label_class 2: 0.8743
2024-08-15 17:17:27,279 : INFO : Recall score for label_class 0: 0.8028
2024-08-15 17:17:27,279 : INFO : Recall score for label_class 1: 0.9317
2024-08-15 17:17:27,279 : INFO : Recall score for label_class 2: 0.7887
2024-08-15 17:17:27,279 : INFO : Average F1 score: 0.8446
2024-08-15 17:17:27,279 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:17:27,279 : INFO : Last epoch reached, validation loss was better before, loading best model during training.
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:17:27,312 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:17:27,814 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:27,814 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:17:27,814 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:27,817 : INFO : Accuracy: 0.8756
2024-08-15 17:17:27,817 : INFO : Precision score for label_class 0: 0.7595
2024-08-15 17:17:27,817 : INFO : Precision score for label_class 1: 0.9156
2024-08-15 17:17:27,817 : INFO : Precision score for label_class 2: 0.8394
2024-08-15 17:17:27,817 : INFO : Recall score for label_class 0: 0.8451
2024-08-15 17:17:27,817 : INFO : Recall score for label_class 1: 0.9000
2024-08-15 17:17:27,817 : INFO : Recall score for label_class 2: 0.8351
2024-08-15 17:17:27,817 : INFO : Average F1 score: 0.8483
2024-08-15 17:17:27,817 : INFO : Determined score from best model, ending training.
2024-08-15 17:17:27,819 : INFO : Split 2 is finished, the score is: 0.8483
2024-08-15 17:17:27,819 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:27,819 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:27,819 : INFO : Starting training for split 3
2024-08-15 17:17:27,832 : INFO : Starting to tokenize the sequences.
2024-08-15 17:17:27,838 : INFO : Tokenization is finished.
2024-08-15 17:17:27,854 : INFO : Starting to tokenize the sequences.
2024-08-15 17:17:27,859 : INFO : Tokenization is finished.
2024-08-15 17:17:27,864 : INFO : Counting occurences of labels...
2024-08-15 17:17:27,865 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1611,  759]))
2024-08-15 17:17:27,865 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 400, 189]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:17:27,905 : INFO : Starting epoch 1
2024-08-15 17:17:27,956 : INFO : Current training batch loss: 1.0988 in epoch 1
2024-08-15 17:17:28,777 : INFO : Current training batch loss: 0.9905 in epoch 1
2024-08-15 17:17:29,623 : INFO : Current training batch loss: 0.7908 in epoch 1
2024-08-15 17:17:30,438 : INFO : Current training batch loss: 0.7175 in epoch 1
2024-08-15 17:17:31,253 : INFO : Current training batch loss: 0.6669 in epoch 1
2024-08-15 17:17:31,403 : INFO : Epoch finished, average loss over training batches: 0.8259
2024-08-15 17:17:31,404 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:31,404 : INFO : Training metrics:
2024-08-15 17:17:31,404 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:31,407 : INFO : Accuracy: 0.6486
2024-08-15 17:17:31,407 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:17:31,407 : INFO : Precision score for label_class 1: 0.6918
2024-08-15 17:17:31,408 : INFO : Precision score for label_class 2: 0.4896
2024-08-15 17:17:31,408 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:17:31,408 : INFO : Recall score for label_class 1: 0.9112
2024-08-15 17:17:31,408 : INFO : Recall score for label_class 2: 0.3715
2024-08-15 17:17:31,408 : INFO : Average F1 score: 0.4030
2024-08-15 17:17:31,873 : INFO : Average loss over validation batches: 0.5993
2024-08-15 17:17:31,873 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:31,873 : INFO : Validation metrics:
2024-08-15 17:17:31,873 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:31,875 : INFO : Accuracy: 0.7496
2024-08-15 17:17:31,876 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:17:31,876 : INFO : Precision score for label_class 1: 0.8825
2024-08-15 17:17:31,876 : INFO : Precision score for label_class 2: 0.5564
2024-08-15 17:17:31,876 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:17:31,876 : INFO : Recall score for label_class 1: 0.8825
2024-08-15 17:17:31,876 : INFO : Recall score for label_class 2: 0.8095
2024-08-15 17:17:31,876 : INFO : Average F1 score: 0.5140
2024-08-15 17:17:31,876 : INFO : Validation metric decreased (inf --> 0.599293).  Saving model ...
2024-08-15 17:17:31,985 : INFO : Starting epoch 2
2024-08-15 17:17:32,638 : INFO : Current training batch loss: 0.5998 in epoch 2
2024-08-15 17:17:33,460 : INFO : Current training batch loss: 0.4772 in epoch 2
2024-08-15 17:17:34,280 : INFO : Current training batch loss: 0.4618 in epoch 2
2024-08-15 17:17:35,095 : INFO : Current training batch loss: 0.3310 in epoch 2
2024-08-15 17:17:35,451 : INFO : Epoch finished, average loss over training batches: 0.5048
2024-08-15 17:17:35,451 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:35,452 : INFO : Training metrics:
2024-08-15 17:17:35,452 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:35,455 : INFO : Accuracy: 0.8143
2024-08-15 17:17:35,456 : INFO : Precision score for label_class 0: 0.7881
2024-08-15 17:17:35,456 : INFO : Precision score for label_class 1: 0.8693
2024-08-15 17:17:35,456 : INFO : Precision score for label_class 2: 0.7029
2024-08-15 17:17:35,456 : INFO : Recall score for label_class 0: 0.3628
2024-08-15 17:17:35,456 : INFO : Recall score for label_class 1: 0.9330
2024-08-15 17:17:35,456 : INFO : Recall score for label_class 2: 0.7576
2024-08-15 17:17:35,456 : INFO : Average F1 score: 0.7087
2024-08-15 17:17:35,921 : INFO : Average loss over validation batches: 0.4069
2024-08-15 17:17:35,921 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:35,921 : INFO : Validation metrics:
2024-08-15 17:17:35,921 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:35,924 : INFO : Accuracy: 0.8667
2024-08-15 17:17:35,924 : INFO : Precision score for label_class 0: 0.7353
2024-08-15 17:17:35,924 : INFO : Precision score for label_class 1: 0.8993
2024-08-15 17:17:35,924 : INFO : Precision score for label_class 2: 0.8654
2024-08-15 17:17:35,924 : INFO : Recall score for label_class 0: 0.8721
2024-08-15 17:17:35,924 : INFO : Recall score for label_class 1: 0.9375
2024-08-15 17:17:35,924 : INFO : Recall score for label_class 2: 0.7143
2024-08-15 17:17:35,924 : INFO : Average F1 score: 0.8328
2024-08-15 17:17:35,924 : INFO : Validation metric decreased (0.599293 --> 0.406934).  Saving model ...
2024-08-15 17:17:36,027 : INFO : Starting epoch 3
2024-08-15 17:17:36,482 : INFO : Current training batch loss: 0.2740 in epoch 3
2024-08-15 17:17:37,299 : INFO : Current training batch loss: 0.2844 in epoch 3
2024-08-15 17:17:38,123 : INFO : Current training batch loss: 0.2835 in epoch 3
2024-08-15 17:17:38,933 : INFO : Current training batch loss: 0.1111 in epoch 3
2024-08-15 17:17:39,476 : INFO : Epoch finished, average loss over training batches: 0.2914
2024-08-15 17:17:39,476 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:39,476 : INFO : Training metrics:
2024-08-15 17:17:39,476 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:39,482 : INFO : Accuracy: 0.9136
2024-08-15 17:17:39,482 : INFO : Precision score for label_class 0: 0.8110
2024-08-15 17:17:39,482 : INFO : Precision score for label_class 1: 0.9399
2024-08-15 17:17:39,482 : INFO : Precision score for label_class 2: 0.9033
2024-08-15 17:17:39,482 : INFO : Recall score for label_class 0: 0.8506
2024-08-15 17:17:39,482 : INFO : Recall score for label_class 1: 0.9510
2024-08-15 17:17:39,482 : INFO : Recall score for label_class 2: 0.8617
2024-08-15 17:17:39,482 : INFO : Average F1 score: 0.8859
2024-08-15 17:17:39,945 : INFO : Average loss over validation batches: 0.3862
2024-08-15 17:17:39,945 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:39,945 : INFO : Validation metrics:
2024-08-15 17:17:39,945 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:39,948 : INFO : Accuracy: 0.8489
2024-08-15 17:17:39,948 : INFO : Precision score for label_class 0: 0.8046
2024-08-15 17:17:39,948 : INFO : Precision score for label_class 1: 0.9389
2024-08-15 17:17:39,948 : INFO : Precision score for label_class 2: 0.7237
2024-08-15 17:17:39,948 : INFO : Recall score for label_class 0: 0.8140
2024-08-15 17:17:39,948 : INFO : Recall score for label_class 1: 0.8450
2024-08-15 17:17:39,948 : INFO : Recall score for label_class 2: 0.8730
2024-08-15 17:17:39,948 : INFO : Average F1 score: 0.8300
2024-08-15 17:17:39,948 : INFO : Validation metric decreased (0.406934 --> 0.386218).  Saving model ...
2024-08-15 17:17:40,050 : INFO : Starting epoch 4
2024-08-15 17:17:40,300 : INFO : Current training batch loss: 0.3553 in epoch 4
2024-08-15 17:17:41,110 : INFO : Current training batch loss: 0.3516 in epoch 4
2024-08-15 17:17:41,921 : INFO : Current training batch loss: 0.2954 in epoch 4
2024-08-15 17:17:42,731 : INFO : Current training batch loss: 0.1670 in epoch 4
2024-08-15 17:17:43,474 : INFO : Epoch finished, average loss over training batches: 0.1929
2024-08-15 17:17:43,474 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:43,474 : INFO : Training metrics:
2024-08-15 17:17:43,474 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:43,480 : INFO : Accuracy: 0.9526
2024-08-15 17:17:43,480 : INFO : Precision score for label_class 0: 0.8689
2024-08-15 17:17:43,480 : INFO : Precision score for label_class 1: 0.9667
2024-08-15 17:17:43,480 : INFO : Precision score for label_class 2: 0.9614
2024-08-15 17:17:43,480 : INFO : Recall score for label_class 0: 0.9299
2024-08-15 17:17:43,480 : INFO : Recall score for label_class 1: 0.9733
2024-08-15 17:17:43,480 : INFO : Recall score for label_class 2: 0.9183
2024-08-15 17:17:43,480 : INFO : Average F1 score: 0.9359
2024-08-15 17:17:43,945 : INFO : Average loss over validation batches: 0.3866
2024-08-15 17:17:43,946 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:43,946 : INFO : Validation metrics:
2024-08-15 17:17:43,946 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:43,948 : INFO : Accuracy: 0.8548
2024-08-15 17:17:43,948 : INFO : Precision score for label_class 0: 0.7453
2024-08-15 17:17:43,948 : INFO : Precision score for label_class 1: 0.9465
2024-08-15 17:17:43,948 : INFO : Precision score for label_class 2: 0.7570
2024-08-15 17:17:43,948 : INFO : Recall score for label_class 0: 0.9186
2024-08-15 17:17:43,948 : INFO : Recall score for label_class 1: 0.8400
2024-08-15 17:17:43,948 : INFO : Recall score for label_class 2: 0.8571
2024-08-15 17:17:43,948 : INFO : Average F1 score: 0.8390
2024-08-15 17:17:43,948 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:17:43,948 : INFO : Starting epoch 5
2024-08-15 17:17:43,998 : INFO : Current training batch loss: 0.1734 in epoch 5
2024-08-15 17:17:44,809 : INFO : Current training batch loss: 0.3642 in epoch 5
2024-08-15 17:17:45,620 : INFO : Current training batch loss: 0.0871 in epoch 5
2024-08-15 17:17:46,431 : INFO : Current training batch loss: 0.1626 in epoch 5
2024-08-15 17:17:47,242 : INFO : Current training batch loss: 0.1169 in epoch 5
2024-08-15 17:17:47,386 : INFO : Epoch finished, average loss over training batches: 0.1558
2024-08-15 17:17:47,386 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:47,386 : INFO : Training metrics:
2024-08-15 17:17:47,386 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:47,392 : INFO : Accuracy: 0.9611
2024-08-15 17:17:47,392 : INFO : Precision score for label_class 0: 0.8785
2024-08-15 17:17:47,392 : INFO : Precision score for label_class 1: 0.9788
2024-08-15 17:17:47,393 : INFO : Precision score for label_class 2: 0.9621
2024-08-15 17:17:47,393 : INFO : Recall score for label_class 0: 0.9482
2024-08-15 17:17:47,393 : INFO : Recall score for label_class 1: 0.9752
2024-08-15 17:17:47,393 : INFO : Recall score for label_class 2: 0.9368
2024-08-15 17:17:47,393 : INFO : Average F1 score: 0.9461
2024-08-15 17:17:47,859 : INFO : Average loss over validation batches: 0.3484
2024-08-15 17:17:47,859 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:47,859 : INFO : Validation metrics:
2024-08-15 17:17:47,859 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:47,862 : INFO : Accuracy: 0.8815
2024-08-15 17:17:47,862 : INFO : Precision score for label_class 0: 0.8085
2024-08-15 17:17:47,862 : INFO : Precision score for label_class 1: 0.9071
2024-08-15 17:17:47,862 : INFO : Precision score for label_class 2: 0.8605
2024-08-15 17:17:47,862 : INFO : Recall score for label_class 0: 0.8837
2024-08-15 17:17:47,862 : INFO : Recall score for label_class 1: 0.9275
2024-08-15 17:17:47,862 : INFO : Recall score for label_class 2: 0.7831
2024-08-15 17:17:47,862 : INFO : Average F1 score: 0.8605
2024-08-15 17:17:47,862 : INFO : Validation metric decreased (0.386218 --> 0.348373).  Saving model ...
2024-08-15 17:17:47,961 : INFO : Split 3 is finished, the score is: 0.8605
2024-08-15 17:17:47,961 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:47,961 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:47,961 : INFO : Starting training for split 4
2024-08-15 17:17:47,976 : INFO : Starting to tokenize the sequences.
2024-08-15 17:17:47,982 : INFO : Tokenization is finished.
2024-08-15 17:17:47,999 : INFO : Starting to tokenize the sequences.
2024-08-15 17:17:48,004 : INFO : Tokenization is finished.
2024-08-15 17:17:48,008 : INFO : Counting occurences of labels...
2024-08-15 17:17:48,009 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 327, 1621,  751]))
2024-08-15 17:17:48,009 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 87, 390, 197]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:17:48,057 : INFO : Starting epoch 1
2024-08-15 17:17:48,108 : INFO : Current training batch loss: 1.0976 in epoch 1
2024-08-15 17:17:48,919 : INFO : Current training batch loss: 0.9868 in epoch 1
2024-08-15 17:17:49,729 : INFO : Current training batch loss: 0.7458 in epoch 1
2024-08-15 17:17:50,539 : INFO : Current training batch loss: 0.6350 in epoch 1
2024-08-15 17:17:51,349 : INFO : Current training batch loss: 0.5942 in epoch 1
2024-08-15 17:17:51,492 : INFO : Epoch finished, average loss over training batches: 0.7988
2024-08-15 17:17:51,493 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:51,493 : INFO : Training metrics:
2024-08-15 17:17:51,493 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:51,502 : INFO : Accuracy: 0.6817
2024-08-15 17:17:51,502 : INFO : Precision score for label_class 0: 0.4490
2024-08-15 17:17:51,502 : INFO : Precision score for label_class 1: 0.7105
2024-08-15 17:17:51,502 : INFO : Precision score for label_class 2: 0.6195
2024-08-15 17:17:51,502 : INFO : Recall score for label_class 0: 0.2018
2024-08-15 17:17:51,502 : INFO : Recall score for label_class 1: 0.9297
2024-08-15 17:17:51,502 : INFO : Recall score for label_class 2: 0.3555
2024-08-15 17:17:51,502 : INFO : Average F1 score: 0.5119
2024-08-15 17:17:52,000 : INFO : Average loss over validation batches: 0.5495
2024-08-15 17:17:52,000 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:52,000 : INFO : Validation metrics:
2024-08-15 17:17:52,000 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:52,005 : INFO : Accuracy: 0.7997
2024-08-15 17:17:52,005 : INFO : Precision score for label_class 0: 0.6813
2024-08-15 17:17:52,005 : INFO : Precision score for label_class 1: 0.8284
2024-08-15 17:17:52,005 : INFO : Precision score for label_class 2: 0.7877
2024-08-15 17:17:52,005 : INFO : Recall score for label_class 0: 0.7126
2024-08-15 17:17:52,005 : INFO : Recall score for label_class 1: 0.9282
2024-08-15 17:17:52,005 : INFO : Recall score for label_class 2: 0.5838
2024-08-15 17:17:52,005 : INFO : Average F1 score: 0.7475
2024-08-15 17:17:52,005 : INFO : Validation metric decreased (inf --> 0.549530).  Saving model ...
2024-08-15 17:17:52,135 : INFO : Starting epoch 2
2024-08-15 17:17:52,786 : INFO : Current training batch loss: 0.4448 in epoch 2
2024-08-15 17:17:53,606 : INFO : Current training batch loss: 0.3518 in epoch 2
2024-08-15 17:17:54,421 : INFO : Current training batch loss: 0.2418 in epoch 2
2024-08-15 17:17:55,235 : INFO : Current training batch loss: 0.4168 in epoch 2
2024-08-15 17:17:55,587 : INFO : Epoch finished, average loss over training batches: 0.4108
2024-08-15 17:17:55,587 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:55,587 : INFO : Training metrics:
2024-08-15 17:17:55,587 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:55,591 : INFO : Accuracy: 0.8640
2024-08-15 17:17:55,591 : INFO : Precision score for label_class 0: 0.7804
2024-08-15 17:17:55,591 : INFO : Precision score for label_class 1: 0.8943
2024-08-15 17:17:55,591 : INFO : Precision score for label_class 2: 0.8314
2024-08-15 17:17:55,591 : INFO : Recall score for label_class 0: 0.8043
2024-08-15 17:17:55,591 : INFO : Recall score for label_class 1: 0.9235
2024-08-15 17:17:55,591 : INFO : Recall score for label_class 2: 0.7617
2024-08-15 17:17:55,591 : INFO : Average F1 score: 0.8319
2024-08-15 17:17:56,056 : INFO : Average loss over validation batches: 0.3675
2024-08-15 17:17:56,056 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:56,056 : INFO : Validation metrics:
2024-08-15 17:17:56,056 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:56,060 : INFO : Accuracy: 0.8650
2024-08-15 17:17:56,060 : INFO : Precision score for label_class 0: 0.8272
2024-08-15 17:17:56,060 : INFO : Precision score for label_class 1: 0.8832
2024-08-15 17:17:56,060 : INFO : Precision score for label_class 2: 0.8407
2024-08-15 17:17:56,060 : INFO : Recall score for label_class 0: 0.7701
2024-08-15 17:17:56,060 : INFO : Recall score for label_class 1: 0.9308
2024-08-15 17:17:56,060 : INFO : Recall score for label_class 2: 0.7766
2024-08-15 17:17:56,060 : INFO : Average F1 score: 0.8371
2024-08-15 17:17:56,060 : INFO : Validation metric decreased (0.549530 --> 0.367514).  Saving model ...
2024-08-15 17:17:56,161 : INFO : Starting epoch 3
2024-08-15 17:17:56,612 : INFO : Current training batch loss: 0.2452 in epoch 3
2024-08-15 17:17:57,433 : INFO : Current training batch loss: 0.2366 in epoch 3
2024-08-15 17:17:58,250 : INFO : Current training batch loss: 0.2455 in epoch 3
2024-08-15 17:17:59,063 : INFO : Current training batch loss: 0.1420 in epoch 3
2024-08-15 17:17:59,615 : INFO : Epoch finished, average loss over training batches: 0.2451
2024-08-15 17:17:59,615 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:59,615 : INFO : Training metrics:
2024-08-15 17:17:59,615 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:17:59,619 : INFO : Accuracy: 0.9285
2024-08-15 17:17:59,619 : INFO : Precision score for label_class 0: 0.8671
2024-08-15 17:17:59,619 : INFO : Precision score for label_class 1: 0.9475
2024-08-15 17:17:59,619 : INFO : Precision score for label_class 2: 0.9146
2024-08-15 17:17:59,619 : INFO : Recall score for label_class 0: 0.9174
2024-08-15 17:17:59,619 : INFO : Recall score for label_class 1: 0.9581
2024-08-15 17:17:59,619 : INFO : Recall score for label_class 2: 0.8695
2024-08-15 17:17:59,619 : INFO : Average F1 score: 0.9119
2024-08-15 17:18:00,086 : INFO : Average loss over validation batches: 0.3720
2024-08-15 17:18:00,086 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:00,086 : INFO : Validation metrics:
2024-08-15 17:18:00,086 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:00,090 : INFO : Accuracy: 0.8650
2024-08-15 17:18:00,090 : INFO : Precision score for label_class 0: 0.7708
2024-08-15 17:18:00,090 : INFO : Precision score for label_class 1: 0.9391
2024-08-15 17:18:00,090 : INFO : Precision score for label_class 2: 0.7834
2024-08-15 17:18:00,090 : INFO : Recall score for label_class 0: 0.8506
2024-08-15 17:18:00,090 : INFO : Recall score for label_class 1: 0.8692
2024-08-15 17:18:00,090 : INFO : Recall score for label_class 2: 0.8629
2024-08-15 17:18:00,090 : INFO : Average F1 score: 0.8443
2024-08-15 17:18:00,090 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:18:00,090 : INFO : Starting epoch 4
2024-08-15 17:18:00,341 : INFO : Current training batch loss: 0.3461 in epoch 4
2024-08-15 17:18:01,155 : INFO : Current training batch loss: 0.2572 in epoch 4
2024-08-15 17:18:01,969 : INFO : Current training batch loss: 0.1423 in epoch 4
2024-08-15 17:18:02,788 : INFO : Current training batch loss: 0.1683 in epoch 4
2024-08-15 17:18:03,554 : INFO : Epoch finished, average loss over training batches: 0.1724
2024-08-15 17:18:03,555 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:03,555 : INFO : Training metrics:
2024-08-15 17:18:03,555 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:03,558 : INFO : Accuracy: 0.9548
2024-08-15 17:18:03,558 : INFO : Precision score for label_class 0: 0.8983
2024-08-15 17:18:03,558 : INFO : Precision score for label_class 1: 0.9669
2024-08-15 17:18:03,558 : INFO : Precision score for label_class 2: 0.9545
2024-08-15 17:18:03,558 : INFO : Recall score for label_class 0: 0.9450
2024-08-15 17:18:03,558 : INFO : Recall score for label_class 1: 0.9716
2024-08-15 17:18:03,558 : INFO : Recall score for label_class 2: 0.9228
2024-08-15 17:18:03,558 : INFO : Average F1 score: 0.9429
2024-08-15 17:18:04,024 : INFO : Average loss over validation batches: 0.3472
2024-08-15 17:18:04,024 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:04,024 : INFO : Validation metrics:
2024-08-15 17:18:04,024 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:04,028 : INFO : Accuracy: 0.8739
2024-08-15 17:18:04,028 : INFO : Precision score for label_class 0: 0.7576
2024-08-15 17:18:04,028 : INFO : Precision score for label_class 1: 0.9000
2024-08-15 17:18:04,028 : INFO : Precision score for label_class 2: 0.8800
2024-08-15 17:18:04,028 : INFO : Recall score for label_class 0: 0.8621
2024-08-15 17:18:04,028 : INFO : Recall score for label_class 1: 0.9231
2024-08-15 17:18:04,028 : INFO : Recall score for label_class 2: 0.7817
2024-08-15 17:18:04,028 : INFO : Average F1 score: 0.8486
2024-08-15 17:18:04,028 : INFO : Validation metric decreased (0.367514 --> 0.347236).  Saving model ...
2024-08-15 17:18:04,130 : INFO : Starting epoch 5
2024-08-15 17:18:04,182 : INFO : Current training batch loss: 0.1155 in epoch 5
2024-08-15 17:18:05,017 : INFO : Current training batch loss: 0.2103 in epoch 5
2024-08-15 17:18:05,845 : INFO : Current training batch loss: 0.0583 in epoch 5
2024-08-15 17:18:06,676 : INFO : Current training batch loss: 0.1382 in epoch 5
2024-08-15 17:18:07,493 : INFO : Current training batch loss: 0.2517 in epoch 5
2024-08-15 17:18:07,645 : INFO : Epoch finished, average loss over training batches: 0.1291
2024-08-15 17:18:07,645 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:07,646 : INFO : Training metrics:
2024-08-15 17:18:07,646 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:07,649 : INFO : Accuracy: 0.9696
2024-08-15 17:18:07,649 : INFO : Precision score for label_class 0: 0.9120
2024-08-15 17:18:07,649 : INFO : Precision score for label_class 1: 0.9827
2024-08-15 17:18:07,649 : INFO : Precision score for label_class 2: 0.9677
2024-08-15 17:18:07,649 : INFO : Recall score for label_class 0: 0.9511
2024-08-15 17:18:07,649 : INFO : Recall score for label_class 1: 0.9796
2024-08-15 17:18:07,649 : INFO : Recall score for label_class 2: 0.9561
2024-08-15 17:18:07,649 : INFO : Average F1 score: 0.9580
2024-08-15 17:18:08,113 : INFO : Average loss over validation batches: 0.3511
2024-08-15 17:18:08,113 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:08,113 : INFO : Validation metrics:
2024-08-15 17:18:08,113 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:08,117 : INFO : Accuracy: 0.8769
2024-08-15 17:18:08,117 : INFO : Precision score for label_class 0: 0.8000
2024-08-15 17:18:08,117 : INFO : Precision score for label_class 1: 0.9023
2024-08-15 17:18:08,117 : INFO : Precision score for label_class 2: 0.8595
2024-08-15 17:18:08,117 : INFO : Recall score for label_class 0: 0.8276
2024-08-15 17:18:08,117 : INFO : Recall score for label_class 1: 0.9231
2024-08-15 17:18:08,117 : INFO : Recall score for label_class 2: 0.8071
2024-08-15 17:18:08,117 : INFO : Average F1 score: 0.8529
2024-08-15 17:18:08,117 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:18:08,117 : INFO : Last epoch reached, validation loss was better before, loading best model during training.
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:18:08,152 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:18:08,656 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:08,656 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:18:08,656 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:08,659 : INFO : Accuracy: 0.8739
2024-08-15 17:18:08,659 : INFO : Precision score for label_class 0: 0.7576
2024-08-15 17:18:08,659 : INFO : Precision score for label_class 1: 0.9000
2024-08-15 17:18:08,659 : INFO : Precision score for label_class 2: 0.8800
2024-08-15 17:18:08,659 : INFO : Recall score for label_class 0: 0.8621
2024-08-15 17:18:08,659 : INFO : Recall score for label_class 1: 0.9231
2024-08-15 17:18:08,659 : INFO : Recall score for label_class 2: 0.7817
2024-08-15 17:18:08,659 : INFO : Average F1 score: 0.8486
2024-08-15 17:18:08,659 : INFO : Determined score from best model, ending training.
2024-08-15 17:18:08,666 : INFO : Split 4 is finished, the score is: 0.8486
2024-08-15 17:18:08,666 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:08,666 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:08,666 : INFO : Starting training for split 5
2024-08-15 17:18:08,679 : INFO : Starting to tokenize the sequences.
2024-08-15 17:18:08,684 : INFO : Tokenization is finished.
2024-08-15 17:18:08,701 : INFO : Starting to tokenize the sequences.
2024-08-15 17:18:08,705 : INFO : Tokenization is finished.
2024-08-15 17:18:08,710 : INFO : Counting occurences of labels...
2024-08-15 17:18:08,711 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 330, 1615,  754]))
2024-08-15 17:18:08,712 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 84, 396, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:18:08,761 : INFO : Starting epoch 1
2024-08-15 17:18:08,813 : INFO : Current training batch loss: 1.0814 in epoch 1
2024-08-15 17:18:09,657 : INFO : Current training batch loss: 0.9912 in epoch 1
2024-08-15 17:18:10,492 : INFO : Current training batch loss: 0.7895 in epoch 1
2024-08-15 17:18:11,313 : INFO : Current training batch loss: 0.6391 in epoch 1
2024-08-15 17:18:12,132 : INFO : Current training batch loss: 0.6498 in epoch 1
2024-08-15 17:18:12,283 : INFO : Epoch finished, average loss over training batches: 0.8145
2024-08-15 17:18:12,283 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:12,283 : INFO : Training metrics:
2024-08-15 17:18:12,283 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:12,294 : INFO : Accuracy: 0.6803
2024-08-15 17:18:12,294 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:18:12,294 : INFO : Precision score for label_class 1: 0.7035
2024-08-15 17:18:12,294 : INFO : Precision score for label_class 2: 0.5735
2024-08-15 17:18:12,294 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:18:12,294 : INFO : Recall score for label_class 1: 0.9653
2024-08-15 17:18:12,294 : INFO : Recall score for label_class 2: 0.3674
2024-08-15 17:18:12,294 : INFO : Average F1 score: 0.4206
2024-08-15 17:18:12,761 : INFO : Average loss over validation batches: 0.6077
2024-08-15 17:18:12,761 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:12,761 : INFO : Validation metrics:
2024-08-15 17:18:12,761 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:12,765 : INFO : Accuracy: 0.7344
2024-08-15 17:18:12,765 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:18:12,765 : INFO : Precision score for label_class 1: 0.7901
2024-08-15 17:18:12,765 : INFO : Precision score for label_class 2: 0.5904
2024-08-15 17:18:12,765 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:18:12,765 : INFO : Recall score for label_class 1: 0.9697
2024-08-15 17:18:12,765 : INFO : Recall score for label_class 2: 0.5722
2024-08-15 17:18:12,765 : INFO : Average F1 score: 0.4840
2024-08-15 17:18:12,765 : INFO : Validation metric decreased (inf --> 0.607658).  Saving model ...
2024-08-15 17:18:12,867 : INFO : Starting epoch 2
2024-08-15 17:18:13,521 : INFO : Current training batch loss: 0.5765 in epoch 2
2024-08-15 17:18:14,334 : INFO : Current training batch loss: 0.4642 in epoch 2
2024-08-15 17:18:15,149 : INFO : Current training batch loss: 0.3141 in epoch 2
2024-08-15 17:18:15,963 : INFO : Current training batch loss: 0.4322 in epoch 2
2024-08-15 17:18:16,315 : INFO : Epoch finished, average loss over training batches: 0.4646
2024-08-15 17:18:16,315 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:16,315 : INFO : Training metrics:
2024-08-15 17:18:16,315 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:16,323 : INFO : Accuracy: 0.8444
2024-08-15 17:18:16,323 : INFO : Precision score for label_class 0: 0.7665
2024-08-15 17:18:16,323 : INFO : Precision score for label_class 1: 0.8815
2024-08-15 17:18:16,323 : INFO : Precision score for label_class 2: 0.7833
2024-08-15 17:18:16,323 : INFO : Recall score for label_class 0: 0.5970
2024-08-15 17:18:16,323 : INFO : Recall score for label_class 1: 0.9399
2024-08-15 17:18:16,323 : INFO : Recall score for label_class 2: 0.7480
2024-08-15 17:18:16,323 : INFO : Average F1 score: 0.7821
2024-08-15 17:18:16,789 : INFO : Average loss over validation batches: 0.4336
2024-08-15 17:18:16,789 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:16,789 : INFO : Validation metrics:
2024-08-15 17:18:16,789 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:16,793 : INFO : Accuracy: 0.8368
2024-08-15 17:18:16,793 : INFO : Precision score for label_class 0: 0.7903
2024-08-15 17:18:16,793 : INFO : Precision score for label_class 1: 0.8689
2024-08-15 17:18:16,793 : INFO : Precision score for label_class 2: 0.7784
2024-08-15 17:18:16,793 : INFO : Recall score for label_class 0: 0.5833
2024-08-15 17:18:16,793 : INFO : Recall score for label_class 1: 0.9369
2024-08-15 17:18:16,793 : INFO : Recall score for label_class 2: 0.7423
2024-08-15 17:18:16,793 : INFO : Average F1 score: 0.7776
2024-08-15 17:18:16,793 : INFO : Validation metric decreased (0.607658 --> 0.433636).  Saving model ...
2024-08-15 17:18:16,895 : INFO : Starting epoch 3
2024-08-15 17:18:17,453 : INFO : Current training batch loss: 0.2168 in epoch 3
2024-08-15 17:18:18,268 : INFO : Current training batch loss: 0.4259 in epoch 3
2024-08-15 17:18:19,083 : INFO : Current training batch loss: 0.1832 in epoch 3
2024-08-15 17:18:19,897 : INFO : Current training batch loss: 0.1992 in epoch 3
2024-08-15 17:18:20,456 : INFO : Epoch finished, average loss over training batches: 0.2697
2024-08-15 17:18:20,456 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:20,456 : INFO : Training metrics:
2024-08-15 17:18:20,456 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:20,463 : INFO : Accuracy: 0.9207
2024-08-15 17:18:20,463 : INFO : Precision score for label_class 0: 0.8464
2024-08-15 17:18:20,463 : INFO : Precision score for label_class 1: 0.9450
2024-08-15 17:18:20,463 : INFO : Precision score for label_class 2: 0.9003
2024-08-15 17:18:20,463 : INFO : Recall score for label_class 0: 0.8515
2024-08-15 17:18:20,463 : INFO : Recall score for label_class 1: 0.9567
2024-08-15 17:18:20,463 : INFO : Recall score for label_class 2: 0.8740
2024-08-15 17:18:20,463 : INFO : Average F1 score: 0.8956
2024-08-15 17:18:20,930 : INFO : Average loss over validation batches: 0.3977
2024-08-15 17:18:20,930 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:20,930 : INFO : Validation metrics:
2024-08-15 17:18:20,930 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:20,933 : INFO : Accuracy: 0.8427
2024-08-15 17:18:20,933 : INFO : Precision score for label_class 0: 0.8116
2024-08-15 17:18:20,933 : INFO : Precision score for label_class 1: 0.8845
2024-08-15 17:18:20,933 : INFO : Precision score for label_class 2: 0.7677
2024-08-15 17:18:20,933 : INFO : Recall score for label_class 0: 0.6667
2024-08-15 17:18:20,933 : INFO : Recall score for label_class 1: 0.9091
2024-08-15 17:18:20,933 : INFO : Recall score for label_class 2: 0.7835
2024-08-15 17:18:20,933 : INFO : Average F1 score: 0.8014
2024-08-15 17:18:20,933 : INFO : Validation metric decreased (0.433636 --> 0.397681).  Saving model ...
2024-08-15 17:18:21,035 : INFO : Starting epoch 4
2024-08-15 17:18:21,288 : INFO : Current training batch loss: 0.3415 in epoch 4
2024-08-15 17:18:22,100 : INFO : Current training batch loss: 0.2197 in epoch 4
2024-08-15 17:18:22,928 : INFO : Current training batch loss: 0.1610 in epoch 4
2024-08-15 17:18:23,756 : INFO : Current training batch loss: 0.0799 in epoch 4
2024-08-15 17:18:24,503 : INFO : Epoch finished, average loss over training batches: 0.1631
2024-08-15 17:18:24,503 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:24,503 : INFO : Training metrics:
2024-08-15 17:18:24,503 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:24,511 : INFO : Accuracy: 0.9578
2024-08-15 17:18:24,511 : INFO : Precision score for label_class 0: 0.9069
2024-08-15 17:18:24,511 : INFO : Precision score for label_class 1: 0.9741
2024-08-15 17:18:24,511 : INFO : Precision score for label_class 2: 0.9450
2024-08-15 17:18:24,511 : INFO : Recall score for label_class 0: 0.9152
2024-08-15 17:18:24,511 : INFO : Recall score for label_class 1: 0.9771
2024-08-15 17:18:24,511 : INFO : Recall score for label_class 2: 0.9350
2024-08-15 17:18:24,511 : INFO : Average F1 score: 0.9422
2024-08-15 17:18:24,977 : INFO : Average loss over validation batches: 0.3874
2024-08-15 17:18:24,977 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:24,977 : INFO : Validation metrics:
2024-08-15 17:18:24,977 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:24,981 : INFO : Accuracy: 0.8561
2024-08-15 17:18:24,981 : INFO : Precision score for label_class 0: 0.7500
2024-08-15 17:18:24,981 : INFO : Precision score for label_class 1: 0.9059
2024-08-15 17:18:24,981 : INFO : Precision score for label_class 2: 0.8031
2024-08-15 17:18:24,981 : INFO : Recall score for label_class 0: 0.7857
2024-08-15 17:18:24,981 : INFO : Recall score for label_class 1: 0.8990
2024-08-15 17:18:24,981 : INFO : Recall score for label_class 2: 0.7990
2024-08-15 17:18:24,981 : INFO : Average F1 score: 0.8236
2024-08-15 17:18:24,981 : INFO : Validation metric decreased (0.397681 --> 0.387433).  Saving model ...
2024-08-15 17:18:25,083 : INFO : Starting epoch 5
2024-08-15 17:18:25,134 : INFO : Current training batch loss: 0.1229 in epoch 5
2024-08-15 17:18:25,979 : INFO : Current training batch loss: 0.1961 in epoch 5
2024-08-15 17:18:26,811 : INFO : Current training batch loss: 0.0630 in epoch 5
2024-08-15 17:18:27,635 : INFO : Current training batch loss: 0.1786 in epoch 5
2024-08-15 17:18:28,455 : INFO : Current training batch loss: 0.0593 in epoch 5
2024-08-15 17:18:28,610 : INFO : Epoch finished, average loss over training batches: 0.1155
2024-08-15 17:18:28,610 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:28,610 : INFO : Training metrics:
2024-08-15 17:18:28,610 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:28,620 : INFO : Accuracy: 0.9755
2024-08-15 17:18:28,620 : INFO : Precision score for label_class 0: 0.9318
2024-08-15 17:18:28,620 : INFO : Precision score for label_class 1: 0.9846
2024-08-15 17:18:28,620 : INFO : Precision score for label_class 2: 0.9757
2024-08-15 17:18:28,620 : INFO : Recall score for label_class 0: 0.9515
2024-08-15 17:18:28,620 : INFO : Recall score for label_class 1: 0.9882
2024-08-15 17:18:28,620 : INFO : Recall score for label_class 2: 0.9589
2024-08-15 17:18:28,620 : INFO : Average F1 score: 0.9651
2024-08-15 17:18:29,086 : INFO : Average loss over validation batches: 0.3917
2024-08-15 17:18:29,086 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:29,086 : INFO : Validation metrics:
2024-08-15 17:18:29,086 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:29,089 : INFO : Accuracy: 0.8576
2024-08-15 17:18:29,089 : INFO : Precision score for label_class 0: 0.7952
2024-08-15 17:18:29,089 : INFO : Precision score for label_class 1: 0.9098
2024-08-15 17:18:29,089 : INFO : Precision score for label_class 2: 0.7833
2024-08-15 17:18:29,089 : INFO : Recall score for label_class 0: 0.7857
2024-08-15 17:18:29,089 : INFO : Recall score for label_class 1: 0.8914
2024-08-15 17:18:29,089 : INFO : Recall score for label_class 2: 0.8196
2024-08-15 17:18:29,089 : INFO : Average F1 score: 0.8306
2024-08-15 17:18:29,089 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:18:29,089 : INFO : Last epoch reached, validation loss was better before, loading best model during training.
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:18:29,124 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:18:29,623 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:29,623 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:18:29,623 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:29,627 : INFO : Accuracy: 0.8561
2024-08-15 17:18:29,627 : INFO : Precision score for label_class 0: 0.7500
2024-08-15 17:18:29,627 : INFO : Precision score for label_class 1: 0.9059
2024-08-15 17:18:29,627 : INFO : Precision score for label_class 2: 0.8031
2024-08-15 17:18:29,627 : INFO : Recall score for label_class 0: 0.7857
2024-08-15 17:18:29,627 : INFO : Recall score for label_class 1: 0.8990
2024-08-15 17:18:29,627 : INFO : Recall score for label_class 2: 0.7990
2024-08-15 17:18:29,627 : INFO : Average F1 score: 0.8236
2024-08-15 17:18:29,627 : INFO : Determined score from best model, ending training.
2024-08-15 17:18:29,628 : INFO : Split 5 is finished, the score is: 0.8236
2024-08-15 17:18:29,628 : INFO : ----------------------------------------------------------------------------------------------------
[I 2024-08-15 17:18:29,643] Trial 6 finished with value: 0.8510284928547138 and parameters: {'n_epochs': 5, 'learning_rate': 4.364367124307824e-05, 'classifier_dropout': 0.15189527539470735, 'warmup_step_fraction': 0.02217206985164031, 'use_gradient_clipping': False}. Best is trial 1 with value: 0.8513001269595835.
2024-08-15 17:18:29,644 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:29,644 : INFO : Starting training for split 1
2024-08-15 17:18:29,656 : INFO : Starting to tokenize the sequences.
2024-08-15 17:18:29,662 : INFO : Tokenization is finished.
2024-08-15 17:18:29,674 : INFO : Starting to tokenize the sequences.
2024-08-15 17:18:29,679 : INFO : Tokenization is finished.
2024-08-15 17:18:29,679 : INFO : Counting occurences of labels...
2024-08-15 17:18:29,680 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1596,  774]))
2024-08-15 17:18:29,680 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 415, 174]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:18:29,734 : INFO : Starting epoch 1
2024-08-15 17:18:29,785 : INFO : Current training batch loss: 1.1506 in epoch 1
2024-08-15 17:18:30,599 : INFO : Current training batch loss: 0.9263 in epoch 1
2024-08-15 17:18:31,412 : INFO : Current training batch loss: 0.8937 in epoch 1
2024-08-15 17:18:32,226 : INFO : Current training batch loss: 0.7030 in epoch 1
2024-08-15 17:18:33,042 : INFO : Current training batch loss: 0.6666 in epoch 1
2024-08-15 17:18:33,198 : INFO : Epoch finished, average loss over training batches: 0.8610
2024-08-15 17:18:33,199 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:33,199 : INFO : Training metrics:
2024-08-15 17:18:33,199 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:33,207 : INFO : Accuracy: 0.5886
2024-08-15 17:18:33,207 : INFO : Precision score for label_class 0: 0.1274
2024-08-15 17:18:33,207 : INFO : Precision score for label_class 1: 0.6876
2024-08-15 17:18:33,207 : INFO : Precision score for label_class 2: 0.5217
2024-08-15 17:18:33,207 : INFO : Recall score for label_class 0: 0.1402
2024-08-15 17:18:33,207 : INFO : Recall score for label_class 1: 0.8383
2024-08-15 17:18:33,207 : INFO : Recall score for label_class 2: 0.2636
2024-08-15 17:18:33,207 : INFO : Average F1 score: 0.4131
2024-08-15 17:18:33,672 : INFO : Average loss over validation batches: 0.6697
2024-08-15 17:18:33,672 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:33,672 : INFO : Validation metrics:
2024-08-15 17:18:33,672 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:33,675 : INFO : Accuracy: 0.7304
2024-08-15 17:18:33,675 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:18:33,675 : INFO : Precision score for label_class 1: 0.8750
2024-08-15 17:18:33,675 : INFO : Precision score for label_class 2: 0.5094
2024-08-15 17:18:33,675 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:18:33,675 : INFO : Recall score for label_class 1: 0.8602
2024-08-15 17:18:33,675 : INFO : Recall score for label_class 2: 0.7816
2024-08-15 17:18:33,675 : INFO : Average F1 score: 0.4948
2024-08-15 17:18:33,675 : INFO : Validation metric decreased (inf --> 0.669737).  Saving model ...
2024-08-15 17:18:33,783 : INFO : Starting epoch 2
2024-08-15 17:18:34,438 : INFO : Current training batch loss: 0.3516 in epoch 2
2024-08-15 17:18:35,250 : INFO : Current training batch loss: 0.6537 in epoch 2
2024-08-15 17:18:36,065 : INFO : Current training batch loss: 0.4377 in epoch 2
2024-08-15 17:18:36,881 : INFO : Current training batch loss: 0.3155 in epoch 2
2024-08-15 17:18:37,233 : INFO : Epoch finished, average loss over training batches: 0.4990
2024-08-15 17:18:37,234 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:37,234 : INFO : Training metrics:
2024-08-15 17:18:37,234 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:37,238 : INFO : Accuracy: 0.8162
2024-08-15 17:18:37,238 : INFO : Precision score for label_class 0: 0.7204
2024-08-15 17:18:37,238 : INFO : Precision score for label_class 1: 0.8785
2024-08-15 17:18:37,238 : INFO : Precision score for label_class 2: 0.7087
2024-08-15 17:18:37,238 : INFO : Recall score for label_class 0: 0.4085
2024-08-15 17:18:37,238 : INFO : Recall score for label_class 1: 0.9330
2024-08-15 17:18:37,238 : INFO : Recall score for label_class 2: 0.7481
2024-08-15 17:18:37,238 : INFO : Average F1 score: 0.7180
2024-08-15 17:18:37,702 : INFO : Average loss over validation batches: 0.4050
2024-08-15 17:18:37,702 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:37,703 : INFO : Validation metrics:
2024-08-15 17:18:37,703 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:37,706 : INFO : Accuracy: 0.8519
2024-08-15 17:18:37,706 : INFO : Precision score for label_class 0: 0.6944
2024-08-15 17:18:37,706 : INFO : Precision score for label_class 1: 0.9156
2024-08-15 17:18:37,706 : INFO : Precision score for label_class 2: 0.7988
2024-08-15 17:18:37,706 : INFO : Recall score for label_class 0: 0.8721
2024-08-15 17:18:37,706 : INFO : Recall score for label_class 1: 0.8892
2024-08-15 17:18:37,706 : INFO : Recall score for label_class 2: 0.7529
2024-08-15 17:18:37,706 : INFO : Average F1 score: 0.8168
2024-08-15 17:18:37,706 : INFO : Validation metric decreased (0.669737 --> 0.405041).  Saving model ...
2024-08-15 17:18:37,805 : INFO : Starting epoch 3
2024-08-15 17:18:38,268 : INFO : Current training batch loss: 0.3942 in epoch 3
2024-08-15 17:18:39,090 : INFO : Current training batch loss: 0.3472 in epoch 3
2024-08-15 17:18:39,911 : INFO : Current training batch loss: 0.2729 in epoch 3
2024-08-15 17:18:40,729 : INFO : Current training batch loss: 0.2353 in epoch 3
2024-08-15 17:18:41,289 : INFO : Epoch finished, average loss over training batches: 0.2985
2024-08-15 17:18:41,289 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:41,289 : INFO : Training metrics:
2024-08-15 17:18:41,289 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:41,295 : INFO : Accuracy: 0.8988
2024-08-15 17:18:41,295 : INFO : Precision score for label_class 0: 0.7797
2024-08-15 17:18:41,295 : INFO : Precision score for label_class 1: 0.9365
2024-08-15 17:18:41,295 : INFO : Precision score for label_class 2: 0.8738
2024-08-15 17:18:41,295 : INFO : Recall score for label_class 0: 0.8415
2024-08-15 17:18:41,295 : INFO : Recall score for label_class 1: 0.9430
2024-08-15 17:18:41,295 : INFO : Recall score for label_class 2: 0.8320
2024-08-15 17:18:41,295 : INFO : Average F1 score: 0.8672
2024-08-15 17:18:41,760 : INFO : Average loss over validation batches: 0.3633
2024-08-15 17:18:41,760 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:41,760 : INFO : Validation metrics:
2024-08-15 17:18:41,760 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:41,763 : INFO : Accuracy: 0.8711
2024-08-15 17:18:41,763 : INFO : Precision score for label_class 0: 0.8611
2024-08-15 17:18:41,763 : INFO : Precision score for label_class 1: 0.9100
2024-08-15 17:18:41,763 : INFO : Precision score for label_class 2: 0.7845
2024-08-15 17:18:41,763 : INFO : Recall score for label_class 0: 0.7209
2024-08-15 17:18:41,763 : INFO : Recall score for label_class 1: 0.9253
2024-08-15 17:18:41,763 : INFO : Recall score for label_class 2: 0.8161
2024-08-15 17:18:41,763 : INFO : Average F1 score: 0.8341
2024-08-15 17:18:41,763 : INFO : Validation metric decreased (0.405041 --> 0.363327).  Saving model ...
2024-08-15 17:18:41,866 : INFO : Starting epoch 4
2024-08-15 17:18:42,121 : INFO : Current training batch loss: 0.4897 in epoch 4
2024-08-15 17:18:42,945 : INFO : Current training batch loss: 0.2308 in epoch 4
2024-08-15 17:18:43,768 : INFO : Current training batch loss: 0.3564 in epoch 4
2024-08-15 17:18:44,589 : INFO : Current training batch loss: 0.1723 in epoch 4
2024-08-15 17:18:45,350 : INFO : Epoch finished, average loss over training batches: 0.1748
2024-08-15 17:18:45,350 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:45,350 : INFO : Training metrics:
2024-08-15 17:18:45,350 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:45,358 : INFO : Accuracy: 0.9477
2024-08-15 17:18:45,358 : INFO : Precision score for label_class 0: 0.8640
2024-08-15 17:18:45,358 : INFO : Precision score for label_class 1: 0.9652
2024-08-15 17:18:45,358 : INFO : Precision score for label_class 2: 0.9499
2024-08-15 17:18:45,358 : INFO : Recall score for label_class 0: 0.9299
2024-08-15 17:18:45,358 : INFO : Recall score for label_class 1: 0.9718
2024-08-15 17:18:45,358 : INFO : Recall score for label_class 2: 0.9057
2024-08-15 17:18:45,358 : INFO : Average F1 score: 0.9305
2024-08-15 17:18:45,824 : INFO : Average loss over validation batches: 0.4441
2024-08-15 17:18:45,824 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:45,824 : INFO : Validation metrics:
2024-08-15 17:18:45,824 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:45,827 : INFO : Accuracy: 0.8430
2024-08-15 17:18:45,827 : INFO : Precision score for label_class 0: 0.7547
2024-08-15 17:18:45,827 : INFO : Precision score for label_class 1: 0.9571
2024-08-15 17:18:45,827 : INFO : Precision score for label_class 2: 0.7032
2024-08-15 17:18:45,827 : INFO : Recall score for label_class 0: 0.9302
2024-08-15 17:18:45,827 : INFO : Recall score for label_class 1: 0.8072
2024-08-15 17:18:45,827 : INFO : Recall score for label_class 2: 0.8851
2024-08-15 17:18:45,827 : INFO : Average F1 score: 0.8310
2024-08-15 17:18:45,827 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:18:45,827 : INFO : Starting epoch 5
2024-08-15 17:18:45,878 : INFO : Current training batch loss: 0.1365 in epoch 5
2024-08-15 17:18:46,703 : INFO : Current training batch loss: 0.2286 in epoch 5
2024-08-15 17:18:47,527 : INFO : Current training batch loss: 0.0436 in epoch 5
2024-08-15 17:18:48,347 : INFO : Current training batch loss: 0.1311 in epoch 5
2024-08-15 17:18:49,168 : INFO : Current training batch loss: 0.0275 in epoch 5
2024-08-15 17:18:49,324 : INFO : Epoch finished, average loss over training batches: 0.1123
2024-08-15 17:18:49,325 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:49,325 : INFO : Training metrics:
2024-08-15 17:18:49,325 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:49,329 : INFO : Accuracy: 0.9722
2024-08-15 17:18:49,329 : INFO : Precision score for label_class 0: 0.9049
2024-08-15 17:18:49,329 : INFO : Precision score for label_class 1: 0.9868
2024-08-15 17:18:49,330 : INFO : Precision score for label_class 2: 0.9723
2024-08-15 17:18:49,330 : INFO : Recall score for label_class 0: 0.9573
2024-08-15 17:18:49,330 : INFO : Recall score for label_class 1: 0.9843
2024-08-15 17:18:49,330 : INFO : Recall score for label_class 2: 0.9535
2024-08-15 17:18:49,330 : INFO : Average F1 score: 0.9596
2024-08-15 17:18:49,794 : INFO : Average loss over validation batches: 0.3611
2024-08-15 17:18:49,794 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:49,794 : INFO : Validation metrics:
2024-08-15 17:18:49,794 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:49,797 : INFO : Accuracy: 0.8859
2024-08-15 17:18:49,797 : INFO : Precision score for label_class 0: 0.7619
2024-08-15 17:18:49,797 : INFO : Precision score for label_class 1: 0.9310
2024-08-15 17:18:49,797 : INFO : Precision score for label_class 2: 0.8537
2024-08-15 17:18:49,797 : INFO : Recall score for label_class 0: 0.9302
2024-08-15 17:18:49,797 : INFO : Recall score for label_class 1: 0.9108
2024-08-15 17:18:49,797 : INFO : Recall score for label_class 2: 0.8046
2024-08-15 17:18:49,797 : INFO : Average F1 score: 0.8623
2024-08-15 17:18:49,797 : INFO : Validation metric decreased (0.363327 --> 0.361113).  Saving model ...
2024-08-15 17:18:49,896 : INFO : Starting epoch 6
2024-08-15 17:18:50,565 : INFO : Current training batch loss: 0.0603 in epoch 6
2024-08-15 17:18:51,386 : INFO : Current training batch loss: 0.0339 in epoch 6
2024-08-15 17:18:52,206 : INFO : Current training batch loss: 0.0260 in epoch 6
2024-08-15 17:18:53,021 : INFO : Current training batch loss: 0.0273 in epoch 6
2024-08-15 17:18:53,385 : INFO : Epoch finished, average loss over training batches: 0.0802
2024-08-15 17:18:53,385 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:53,385 : INFO : Training metrics:
2024-08-15 17:18:53,385 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:53,391 : INFO : Accuracy: 0.9822
2024-08-15 17:18:53,391 : INFO : Precision score for label_class 0: 0.9280
2024-08-15 17:18:53,391 : INFO : Precision score for label_class 1: 0.9925
2024-08-15 17:18:53,391 : INFO : Precision score for label_class 2: 0.9855
2024-08-15 17:18:53,391 : INFO : Recall score for label_class 0: 0.9817
2024-08-15 17:18:53,391 : INFO : Recall score for label_class 1: 0.9893
2024-08-15 17:18:53,391 : INFO : Recall score for label_class 2: 0.9677
2024-08-15 17:18:53,391 : INFO : Average F1 score: 0.9738
2024-08-15 17:18:53,858 : INFO : Average loss over validation batches: 0.3557
2024-08-15 17:18:53,858 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:53,858 : INFO : Validation metrics:
2024-08-15 17:18:53,858 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:53,861 : INFO : Accuracy: 0.8933
2024-08-15 17:18:53,861 : INFO : Precision score for label_class 0: 0.8041
2024-08-15 17:18:53,861 : INFO : Precision score for label_class 1: 0.9315
2024-08-15 17:18:53,861 : INFO : Precision score for label_class 2: 0.8521
2024-08-15 17:18:53,861 : INFO : Recall score for label_class 0: 0.9070
2024-08-15 17:18:53,861 : INFO : Recall score for label_class 1: 0.9181
2024-08-15 17:18:53,861 : INFO : Recall score for label_class 2: 0.8276
2024-08-15 17:18:53,861 : INFO : Average F1 score: 0.8723
2024-08-15 17:18:53,861 : INFO : Validation metric decreased (0.361113 --> 0.355732).  Saving model ...
2024-08-15 17:18:53,963 : INFO : Starting epoch 7
2024-08-15 17:18:54,419 : INFO : Current training batch loss: 0.0222 in epoch 7
2024-08-15 17:18:55,245 : INFO : Current training batch loss: 0.0553 in epoch 7
2024-08-15 17:18:56,066 : INFO : Current training batch loss: 0.0264 in epoch 7
2024-08-15 17:18:56,884 : INFO : Current training batch loss: 0.0185 in epoch 7
2024-08-15 17:18:57,446 : INFO : Epoch finished, average loss over training batches: 0.0670
2024-08-15 17:18:57,446 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:57,446 : INFO : Training metrics:
2024-08-15 17:18:57,446 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:57,451 : INFO : Accuracy: 0.9859
2024-08-15 17:18:57,451 : INFO : Precision score for label_class 0: 0.9333
2024-08-15 17:18:57,451 : INFO : Precision score for label_class 1: 0.9950
2024-08-15 17:18:57,451 : INFO : Precision score for label_class 2: 0.9908
2024-08-15 17:18:57,451 : INFO : Recall score for label_class 0: 0.9817
2024-08-15 17:18:57,451 : INFO : Recall score for label_class 1: 0.9925
2024-08-15 17:18:57,451 : INFO : Recall score for label_class 2: 0.9742
2024-08-15 17:18:57,451 : INFO : Average F1 score: 0.9777
2024-08-15 17:18:57,920 : INFO : Average loss over validation batches: 0.3632
2024-08-15 17:18:57,920 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:57,920 : INFO : Validation metrics:
2024-08-15 17:18:57,920 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:57,923 : INFO : Accuracy: 0.8830
2024-08-15 17:18:57,923 : INFO : Precision score for label_class 0: 0.8022
2024-08-15 17:18:57,923 : INFO : Precision score for label_class 1: 0.9332
2024-08-15 17:18:57,923 : INFO : Precision score for label_class 2: 0.8111
2024-08-15 17:18:57,923 : INFO : Recall score for label_class 0: 0.8488
2024-08-15 17:18:57,923 : INFO : Recall score for label_class 1: 0.9084
2024-08-15 17:18:57,923 : INFO : Recall score for label_class 2: 0.8391
2024-08-15 17:18:57,923 : INFO : Average F1 score: 0.8568
2024-08-15 17:18:57,923 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:18:57,923 : INFO : Last epoch reached, validation loss was better before, loading best model during training.
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:18:57,961 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:18:58,466 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:58,466 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:18:58,466 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:58,470 : INFO : Accuracy: 0.8933
2024-08-15 17:18:58,470 : INFO : Precision score for label_class 0: 0.8041
2024-08-15 17:18:58,470 : INFO : Precision score for label_class 1: 0.9315
2024-08-15 17:18:58,470 : INFO : Precision score for label_class 2: 0.8521
2024-08-15 17:18:58,470 : INFO : Recall score for label_class 0: 0.9070
2024-08-15 17:18:58,470 : INFO : Recall score for label_class 1: 0.9181
2024-08-15 17:18:58,470 : INFO : Recall score for label_class 2: 0.8276
2024-08-15 17:18:58,470 : INFO : Average F1 score: 0.8723
2024-08-15 17:18:58,470 : INFO : Determined score from best model, ending training.
2024-08-15 17:18:58,471 : INFO : Split 1 is finished, the score is: 0.8723
2024-08-15 17:18:58,471 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:58,471 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:18:58,471 : INFO : Starting training for split 2
2024-08-15 17:18:58,490 : INFO : Starting to tokenize the sequences.
2024-08-15 17:18:58,496 : INFO : Tokenization is finished.
2024-08-15 17:18:58,514 : INFO : Starting to tokenize the sequences.
2024-08-15 17:18:58,519 : INFO : Tokenization is finished.
2024-08-15 17:18:58,523 : INFO : Counting occurences of labels...
2024-08-15 17:18:58,524 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 343, 1601,  754]))
2024-08-15 17:18:58,525 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 71, 410, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:18:58,571 : INFO : Starting epoch 1
2024-08-15 17:18:58,622 : INFO : Current training batch loss: 1.0903 in epoch 1
2024-08-15 17:18:59,435 : INFO : Current training batch loss: 1.0029 in epoch 1
2024-08-15 17:19:00,246 : INFO : Current training batch loss: 0.8336 in epoch 1
2024-08-15 17:19:01,058 : INFO : Current training batch loss: 0.6003 in epoch 1
2024-08-15 17:19:01,875 : INFO : Current training batch loss: 0.7037 in epoch 1
2024-08-15 17:19:02,026 : INFO : Epoch finished, average loss over training batches: 0.8352
2024-08-15 17:19:02,027 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:02,027 : INFO : Training metrics:
2024-08-15 17:19:02,027 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:02,037 : INFO : Accuracy: 0.6546
2024-08-15 17:19:02,037 : INFO : Precision score for label_class 0: 0.2222
2024-08-15 17:19:02,038 : INFO : Precision score for label_class 1: 0.6880
2024-08-15 17:19:02,038 : INFO : Precision score for label_class 2: 0.5158
2024-08-15 17:19:02,038 : INFO : Recall score for label_class 0: 0.0117
2024-08-15 17:19:02,038 : INFO : Recall score for label_class 1: 0.9475
2024-08-15 17:19:02,038 : INFO : Recall score for label_class 2: 0.3249
2024-08-15 17:19:02,038 : INFO : Average F1 score: 0.4060
2024-08-15 17:19:02,503 : INFO : Average loss over validation batches: 0.6233
2024-08-15 17:19:02,503 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:02,503 : INFO : Validation metrics:
2024-08-15 17:19:02,503 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:02,507 : INFO : Accuracy: 0.7556
2024-08-15 17:19:02,507 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:19:02,507 : INFO : Precision score for label_class 1: 0.8315
2024-08-15 17:19:02,507 : INFO : Precision score for label_class 2: 0.6027
2024-08-15 17:19:02,507 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:19:02,507 : INFO : Recall score for label_class 1: 0.9146
2024-08-15 17:19:02,507 : INFO : Recall score for label_class 2: 0.6959
2024-08-15 17:19:02,507 : INFO : Average F1 score: 0.5057
2024-08-15 17:19:02,507 : INFO : Validation metric decreased (inf --> 0.623288).  Saving model ...
2024-08-15 17:19:02,607 : INFO : Starting epoch 2
2024-08-15 17:19:03,260 : INFO : Current training batch loss: 0.6091 in epoch 2
2024-08-15 17:19:04,080 : INFO : Current training batch loss: 0.5423 in epoch 2
2024-08-15 17:19:04,899 : INFO : Current training batch loss: 0.2689 in epoch 2
2024-08-15 17:19:05,722 : INFO : Current training batch loss: 0.2516 in epoch 2
2024-08-15 17:19:06,082 : INFO : Epoch finished, average loss over training batches: 0.4567
2024-08-15 17:19:06,083 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:06,083 : INFO : Training metrics:
2024-08-15 17:19:06,083 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:06,090 : INFO : Accuracy: 0.8340
2024-08-15 17:19:06,090 : INFO : Precision score for label_class 0: 0.7312
2024-08-15 17:19:06,090 : INFO : Precision score for label_class 1: 0.8804
2024-08-15 17:19:06,090 : INFO : Precision score for label_class 2: 0.7642
2024-08-15 17:19:06,090 : INFO : Recall score for label_class 0: 0.5948
2024-08-15 17:19:06,090 : INFO : Recall score for label_class 1: 0.9338
2024-08-15 17:19:06,090 : INFO : Recall score for label_class 2: 0.7308
2024-08-15 17:19:06,090 : INFO : Average F1 score: 0.7698
2024-08-15 17:19:06,555 : INFO : Average loss over validation batches: 0.3678
2024-08-15 17:19:06,555 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:06,555 : INFO : Validation metrics:
2024-08-15 17:19:06,555 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:06,559 : INFO : Accuracy: 0.8741
2024-08-15 17:19:06,559 : INFO : Precision score for label_class 0: 0.7895
2024-08-15 17:19:06,559 : INFO : Precision score for label_class 1: 0.8971
2024-08-15 17:19:06,559 : INFO : Precision score for label_class 2: 0.8564
2024-08-15 17:19:06,559 : INFO : Recall score for label_class 0: 0.8451
2024-08-15 17:19:06,559 : INFO : Recall score for label_class 1: 0.9146
2024-08-15 17:19:06,559 : INFO : Recall score for label_class 2: 0.7990
2024-08-15 17:19:06,559 : INFO : Average F1 score: 0.8496
2024-08-15 17:19:06,559 : INFO : Validation metric decreased (0.623288 --> 0.367796).  Saving model ...
2024-08-15 17:19:06,660 : INFO : Starting epoch 3
2024-08-15 17:19:07,120 : INFO : Current training batch loss: 0.2258 in epoch 3
2024-08-15 17:19:07,942 : INFO : Current training batch loss: 0.2545 in epoch 3
2024-08-15 17:19:08,760 : INFO : Current training batch loss: 0.2373 in epoch 3
2024-08-15 17:19:09,581 : INFO : Current training batch loss: 0.0997 in epoch 3
2024-08-15 17:19:10,140 : INFO : Epoch finished, average loss over training batches: 0.2412
2024-08-15 17:19:10,140 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:10,140 : INFO : Training metrics:
2024-08-15 17:19:10,140 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:10,147 : INFO : Accuracy: 0.9270
2024-08-15 17:19:10,147 : INFO : Precision score for label_class 0: 0.8459
2024-08-15 17:19:10,147 : INFO : Precision score for label_class 1: 0.9478
2024-08-15 17:19:10,147 : INFO : Precision score for label_class 2: 0.9202
2024-08-15 17:19:10,147 : INFO : Recall score for label_class 0: 0.8805
2024-08-15 17:19:10,147 : INFO : Recall score for label_class 1: 0.9631
2024-08-15 17:19:10,147 : INFO : Recall score for label_class 2: 0.8714
2024-08-15 17:19:10,147 : INFO : Average F1 score: 0.9044
2024-08-15 17:19:10,614 : INFO : Average loss over validation batches: 0.3546
2024-08-15 17:19:10,614 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:10,614 : INFO : Validation metrics:
2024-08-15 17:19:10,614 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:10,618 : INFO : Accuracy: 0.8741
2024-08-15 17:19:10,618 : INFO : Precision score for label_class 0: 0.7763
2024-08-15 17:19:10,618 : INFO : Precision score for label_class 1: 0.9034
2024-08-15 17:19:10,618 : INFO : Precision score for label_class 2: 0.8486
2024-08-15 17:19:10,618 : INFO : Recall score for label_class 0: 0.8310
2024-08-15 17:19:10,618 : INFO : Recall score for label_class 1: 0.9122
2024-08-15 17:19:10,618 : INFO : Recall score for label_class 2: 0.8093
2024-08-15 17:19:10,618 : INFO : Average F1 score: 0.8463
2024-08-15 17:19:10,618 : INFO : Validation metric decreased (0.367796 --> 0.354626).  Saving model ...
2024-08-15 17:19:10,718 : INFO : Starting epoch 4
2024-08-15 17:19:10,974 : INFO : Current training batch loss: 0.3392 in epoch 4
2024-08-15 17:19:11,796 : INFO : Current training batch loss: 0.1005 in epoch 4
2024-08-15 17:19:12,619 : INFO : Current training batch loss: 0.2056 in epoch 4
2024-08-15 17:19:13,438 : INFO : Current training batch loss: 0.0988 in epoch 4
2024-08-15 17:19:14,192 : INFO : Epoch finished, average loss over training batches: 0.1545
2024-08-15 17:19:14,192 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:14,192 : INFO : Training metrics:
2024-08-15 17:19:14,192 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:14,203 : INFO : Accuracy: 0.9529
2024-08-15 17:19:14,203 : INFO : Precision score for label_class 0: 0.9003
2024-08-15 17:19:14,203 : INFO : Precision score for label_class 1: 0.9694
2024-08-15 17:19:14,203 : INFO : Precision score for label_class 2: 0.9428
2024-08-15 17:19:14,203 : INFO : Recall score for label_class 0: 0.9475
2024-08-15 17:19:14,203 : INFO : Recall score for label_class 1: 0.9706
2024-08-15 17:19:14,203 : INFO : Recall score for label_class 2: 0.9178
2024-08-15 17:19:14,203 : INFO : Average F1 score: 0.9411
2024-08-15 17:19:14,668 : INFO : Average loss over validation batches: 0.4167
2024-08-15 17:19:14,668 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:14,668 : INFO : Validation metrics:
2024-08-15 17:19:14,668 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:14,672 : INFO : Accuracy: 0.8563
2024-08-15 17:19:14,672 : INFO : Precision score for label_class 0: 0.7711
2024-08-15 17:19:14,672 : INFO : Precision score for label_class 1: 0.9191
2024-08-15 17:19:14,672 : INFO : Precision score for label_class 2: 0.7751
2024-08-15 17:19:14,672 : INFO : Recall score for label_class 0: 0.9014
2024-08-15 17:19:14,672 : INFO : Recall score for label_class 1: 0.8585
2024-08-15 17:19:14,672 : INFO : Recall score for label_class 2: 0.8351
2024-08-15 17:19:14,672 : INFO : Average F1 score: 0.8410
2024-08-15 17:19:14,672 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:19:14,672 : INFO : Starting epoch 5
2024-08-15 17:19:14,723 : INFO : Current training batch loss: 0.1365 in epoch 5
2024-08-15 17:19:15,539 : INFO : Current training batch loss: 0.4127 in epoch 5
2024-08-15 17:19:16,354 : INFO : Current training batch loss: 0.0308 in epoch 5
2024-08-15 17:19:17,169 : INFO : Current training batch loss: 0.0445 in epoch 5
2024-08-15 17:19:17,985 : INFO : Current training batch loss: 0.2112 in epoch 5
2024-08-15 17:19:18,135 : INFO : Epoch finished, average loss over training batches: 0.0935
2024-08-15 17:19:18,136 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:18,136 : INFO : Training metrics:
2024-08-15 17:19:18,136 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:18,143 : INFO : Accuracy: 0.9763
2024-08-15 17:19:18,143 : INFO : Precision score for label_class 0: 0.9354
2024-08-15 17:19:18,143 : INFO : Precision score for label_class 1: 0.9844
2024-08-15 17:19:18,143 : INFO : Precision score for label_class 2: 0.9783
2024-08-15 17:19:18,143 : INFO : Recall score for label_class 0: 0.9708
2024-08-15 17:19:18,143 : INFO : Recall score for label_class 1: 0.9856
2024-08-15 17:19:18,143 : INFO : Recall score for label_class 2: 0.9589
2024-08-15 17:19:18,143 : INFO : Average F1 score: 0.9688
2024-08-15 17:19:18,609 : INFO : Average loss over validation batches: 0.4115
2024-08-15 17:19:18,610 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:18,610 : INFO : Validation metrics:
2024-08-15 17:19:18,610 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:18,613 : INFO : Accuracy: 0.8667
2024-08-15 17:19:18,613 : INFO : Precision score for label_class 0: 0.7763
2024-08-15 17:19:18,614 : INFO : Precision score for label_class 1: 0.8871
2024-08-15 17:19:18,614 : INFO : Precision score for label_class 2: 0.8563
2024-08-15 17:19:18,614 : INFO : Recall score for label_class 0: 0.8310
2024-08-15 17:19:18,614 : INFO : Recall score for label_class 1: 0.9195
2024-08-15 17:19:18,614 : INFO : Recall score for label_class 2: 0.7680
2024-08-15 17:19:18,614 : INFO : Average F1 score: 0.8385
2024-08-15 17:19:18,614 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:19:18,614 : INFO : Starting epoch 6
2024-08-15 17:19:19,268 : INFO : Current training batch loss: 0.0710 in epoch 6
2024-08-15 17:19:20,082 : INFO : Current training batch loss: 0.0351 in epoch 6
2024-08-15 17:19:20,898 : INFO : Current training batch loss: 0.0189 in epoch 6
2024-08-15 17:19:21,712 : INFO : Current training batch loss: 0.0478 in epoch 6
2024-08-15 17:19:22,064 : INFO : Epoch finished, average loss over training batches: 0.0548
2024-08-15 17:19:22,064 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:22,064 : INFO : Training metrics:
2024-08-15 17:19:22,064 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:22,075 : INFO : Accuracy: 0.9881
2024-08-15 17:19:22,075 : INFO : Precision score for label_class 0: 0.9520
2024-08-15 17:19:22,075 : INFO : Precision score for label_class 1: 0.9969
2024-08-15 17:19:22,075 : INFO : Precision score for label_class 2: 0.9867
2024-08-15 17:19:22,075 : INFO : Recall score for label_class 0: 0.9825
2024-08-15 17:19:22,075 : INFO : Recall score for label_class 1: 0.9925
2024-08-15 17:19:22,075 : INFO : Recall score for label_class 2: 0.9814
2024-08-15 17:19:22,075 : INFO : Average F1 score: 0.9819
2024-08-15 17:19:22,539 : INFO : Average loss over validation batches: 0.4434
2024-08-15 17:19:22,540 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:22,540 : INFO : Validation metrics:
2024-08-15 17:19:22,540 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:22,544 : INFO : Accuracy: 0.8652
2024-08-15 17:19:22,544 : INFO : Precision score for label_class 0: 0.7654
2024-08-15 17:19:22,544 : INFO : Precision score for label_class 1: 0.8892
2024-08-15 17:19:22,544 : INFO : Precision score for label_class 2: 0.8529
2024-08-15 17:19:22,544 : INFO : Recall score for label_class 0: 0.8732
2024-08-15 17:19:22,544 : INFO : Recall score for label_class 1: 0.9195
2024-08-15 17:19:22,544 : INFO : Recall score for label_class 2: 0.7474
2024-08-15 17:19:22,544 : INFO : Average F1 score: 0.8389
2024-08-15 17:19:22,544 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:19:22,544 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:19:22,578 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:19:23,161 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:23,162 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:19:23,162 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:23,165 : INFO : Accuracy: 0.8741
2024-08-15 17:19:23,165 : INFO : Precision score for label_class 0: 0.7763
2024-08-15 17:19:23,165 : INFO : Precision score for label_class 1: 0.9034
2024-08-15 17:19:23,165 : INFO : Precision score for label_class 2: 0.8486
2024-08-15 17:19:23,165 : INFO : Recall score for label_class 0: 0.8310
2024-08-15 17:19:23,165 : INFO : Recall score for label_class 1: 0.9122
2024-08-15 17:19:23,166 : INFO : Recall score for label_class 2: 0.8093
2024-08-15 17:19:23,166 : INFO : Average F1 score: 0.8463
2024-08-15 17:19:23,166 : INFO : Determined score from best model, ending training.
2024-08-15 17:19:23,167 : INFO : Split 2 is finished, the score is: 0.8463
2024-08-15 17:19:23,167 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:23,167 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:23,167 : INFO : Starting training for split 3
2024-08-15 17:19:23,180 : INFO : Starting to tokenize the sequences.
2024-08-15 17:19:23,186 : INFO : Tokenization is finished.
2024-08-15 17:19:23,202 : INFO : Starting to tokenize the sequences.
2024-08-15 17:19:23,207 : INFO : Tokenization is finished.
2024-08-15 17:19:23,212 : INFO : Counting occurences of labels...
2024-08-15 17:19:23,212 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1611,  759]))
2024-08-15 17:19:23,213 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 400, 189]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:19:23,255 : INFO : Starting epoch 1
2024-08-15 17:19:23,306 : INFO : Current training batch loss: 1.0810 in epoch 1
2024-08-15 17:19:24,128 : INFO : Current training batch loss: 1.0041 in epoch 1
2024-08-15 17:19:24,943 : INFO : Current training batch loss: 0.7250 in epoch 1
2024-08-15 17:19:25,757 : INFO : Current training batch loss: 0.7418 in epoch 1
2024-08-15 17:19:26,573 : INFO : Current training batch loss: 0.6832 in epoch 1
2024-08-15 17:19:26,723 : INFO : Epoch finished, average loss over training batches: 0.8198
2024-08-15 17:19:26,723 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:26,724 : INFO : Training metrics:
2024-08-15 17:19:26,724 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:26,731 : INFO : Accuracy: 0.6638
2024-08-15 17:19:26,731 : INFO : Precision score for label_class 0: 0.3750
2024-08-15 17:19:26,731 : INFO : Precision score for label_class 1: 0.6917
2024-08-15 17:19:26,731 : INFO : Precision score for label_class 2: 0.5504
2024-08-15 17:19:26,731 : INFO : Recall score for label_class 0: 0.0640
2024-08-15 17:19:26,731 : INFO : Recall score for label_class 1: 0.9597
2024-08-15 17:19:26,731 : INFO : Recall score for label_class 2: 0.2951
2024-08-15 17:19:26,731 : INFO : Average F1 score: 0.4325
2024-08-15 17:19:27,195 : INFO : Average loss over validation batches: 0.5827
2024-08-15 17:19:27,195 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:27,195 : INFO : Validation metrics:
2024-08-15 17:19:27,195 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:27,198 : INFO : Accuracy: 0.7556
2024-08-15 17:19:27,198 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:19:27,198 : INFO : Precision score for label_class 1: 0.8780
2024-08-15 17:19:27,198 : INFO : Precision score for label_class 2: 0.5660
2024-08-15 17:19:27,198 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:19:27,198 : INFO : Recall score for label_class 1: 0.9000
2024-08-15 17:19:27,198 : INFO : Recall score for label_class 2: 0.7937
2024-08-15 17:19:27,198 : INFO : Average F1 score: 0.5166
2024-08-15 17:19:27,198 : INFO : Validation metric decreased (inf --> 0.582703).  Saving model ...
2024-08-15 17:19:27,309 : INFO : Starting epoch 2
2024-08-15 17:19:27,964 : INFO : Current training batch loss: 0.6078 in epoch 2
2024-08-15 17:19:28,778 : INFO : Current training batch loss: 0.3872 in epoch 2
2024-08-15 17:19:29,593 : INFO : Current training batch loss: 0.4308 in epoch 2
2024-08-15 17:19:30,407 : INFO : Current training batch loss: 0.2736 in epoch 2
2024-08-15 17:19:30,752 : INFO : Epoch finished, average loss over training batches: 0.4350
2024-08-15 17:19:30,752 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:30,752 : INFO : Training metrics:
2024-08-15 17:19:30,752 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:30,757 : INFO : Accuracy: 0.8458
2024-08-15 17:19:30,757 : INFO : Precision score for label_class 0: 0.7450
2024-08-15 17:19:30,757 : INFO : Precision score for label_class 1: 0.8854
2024-08-15 17:19:30,757 : INFO : Precision score for label_class 2: 0.7935
2024-08-15 17:19:30,757 : INFO : Recall score for label_class 0: 0.6768
2024-08-15 17:19:30,757 : INFO : Recall score for label_class 1: 0.9305
2024-08-15 17:19:30,757 : INFO : Recall score for label_class 2: 0.7391
2024-08-15 17:19:30,757 : INFO : Average F1 score: 0.7940
2024-08-15 17:19:31,222 : INFO : Average loss over validation batches: 0.3906
2024-08-15 17:19:31,222 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:31,222 : INFO : Validation metrics:
2024-08-15 17:19:31,222 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:31,225 : INFO : Accuracy: 0.8607
2024-08-15 17:19:31,225 : INFO : Precision score for label_class 0: 0.7872
2024-08-15 17:19:31,225 : INFO : Precision score for label_class 1: 0.8937
2024-08-15 17:19:31,225 : INFO : Precision score for label_class 2: 0.8204
2024-08-15 17:19:31,225 : INFO : Recall score for label_class 0: 0.8605
2024-08-15 17:19:31,225 : INFO : Recall score for label_class 1: 0.9250
2024-08-15 17:19:31,225 : INFO : Recall score for label_class 2: 0.7249
2024-08-15 17:19:31,225 : INFO : Average F1 score: 0.8337
2024-08-15 17:19:31,225 : INFO : Validation metric decreased (0.582703 --> 0.390586).  Saving model ...
2024-08-15 17:19:31,326 : INFO : Starting epoch 3
2024-08-15 17:19:31,779 : INFO : Current training batch loss: 0.1629 in epoch 3
2024-08-15 17:19:32,594 : INFO : Current training batch loss: 0.2753 in epoch 3
2024-08-15 17:19:33,409 : INFO : Current training batch loss: 0.1839 in epoch 3
2024-08-15 17:19:34,224 : INFO : Current training batch loss: 0.0664 in epoch 3
2024-08-15 17:19:34,777 : INFO : Epoch finished, average loss over training batches: 0.2334
2024-08-15 17:19:34,777 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:34,777 : INFO : Training metrics:
2024-08-15 17:19:34,777 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:34,781 : INFO : Accuracy: 0.9251
2024-08-15 17:19:34,781 : INFO : Precision score for label_class 0: 0.8367
2024-08-15 17:19:34,781 : INFO : Precision score for label_class 1: 0.9562
2024-08-15 17:19:34,781 : INFO : Precision score for label_class 2: 0.9003
2024-08-15 17:19:34,781 : INFO : Recall score for label_class 0: 0.8902
2024-08-15 17:19:34,781 : INFO : Recall score for label_class 1: 0.9479
2024-08-15 17:19:34,781 : INFO : Recall score for label_class 2: 0.8920
2024-08-15 17:19:34,781 : INFO : Average F1 score: 0.9036
2024-08-15 17:19:35,246 : INFO : Average loss over validation batches: 0.4039
2024-08-15 17:19:35,246 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:35,247 : INFO : Validation metrics:
2024-08-15 17:19:35,247 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:35,249 : INFO : Accuracy: 0.8563
2024-08-15 17:19:35,249 : INFO : Precision score for label_class 0: 0.8333
2024-08-15 17:19:35,249 : INFO : Precision score for label_class 1: 0.9305
2024-08-15 17:19:35,249 : INFO : Precision score for label_class 2: 0.7346
2024-08-15 17:19:35,249 : INFO : Recall score for label_class 0: 0.8721
2024-08-15 17:19:35,249 : INFO : Recall score for label_class 1: 0.8700
2024-08-15 17:19:35,249 : INFO : Recall score for label_class 2: 0.8201
2024-08-15 17:19:35,249 : INFO : Average F1 score: 0.8422
2024-08-15 17:19:35,249 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:19:35,249 : INFO : Starting epoch 4
2024-08-15 17:19:35,501 : INFO : Current training batch loss: 0.3127 in epoch 4
2024-08-15 17:19:36,316 : INFO : Current training batch loss: 0.2199 in epoch 4
2024-08-15 17:19:37,131 : INFO : Current training batch loss: 0.2106 in epoch 4
2024-08-15 17:19:37,946 : INFO : Current training batch loss: 0.0729 in epoch 4
2024-08-15 17:19:38,699 : INFO : Epoch finished, average loss over training batches: 0.1339
2024-08-15 17:19:38,700 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:38,700 : INFO : Training metrics:
2024-08-15 17:19:38,700 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:38,704 : INFO : Accuracy: 0.9640
2024-08-15 17:19:38,704 : INFO : Precision score for label_class 0: 0.8920
2024-08-15 17:19:38,704 : INFO : Precision score for label_class 1: 0.9789
2024-08-15 17:19:38,704 : INFO : Precision score for label_class 2: 0.9659
2024-08-15 17:19:38,704 : INFO : Recall score for label_class 0: 0.9573
2024-08-15 17:19:38,704 : INFO : Recall score for label_class 1: 0.9795
2024-08-15 17:19:38,704 : INFO : Recall score for label_class 2: 0.9341
2024-08-15 17:19:38,704 : INFO : Average F1 score: 0.9508
2024-08-15 17:19:39,169 : INFO : Average loss over validation batches: 0.4687
2024-08-15 17:19:39,169 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:39,169 : INFO : Validation metrics:
2024-08-15 17:19:39,169 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:39,171 : INFO : Accuracy: 0.8267
2024-08-15 17:19:39,171 : INFO : Precision score for label_class 0: 0.7379
2024-08-15 17:19:39,171 : INFO : Precision score for label_class 1: 0.9469
2024-08-15 17:19:39,171 : INFO : Precision score for label_class 2: 0.6910
2024-08-15 17:19:39,171 : INFO : Recall score for label_class 0: 0.8837
2024-08-15 17:19:39,171 : INFO : Recall score for label_class 1: 0.8025
2024-08-15 17:19:39,171 : INFO : Recall score for label_class 2: 0.8519
2024-08-15 17:19:39,171 : INFO : Average F1 score: 0.8120
2024-08-15 17:19:39,172 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:19:39,172 : INFO : Starting epoch 5
2024-08-15 17:19:39,222 : INFO : Current training batch loss: 0.0842 in epoch 5
2024-08-15 17:19:40,037 : INFO : Current training batch loss: 0.1550 in epoch 5
2024-08-15 17:19:40,853 : INFO : Current training batch loss: 0.0263 in epoch 5
2024-08-15 17:19:41,668 : INFO : Current training batch loss: 0.4065 in epoch 5
2024-08-15 17:19:42,483 : INFO : Current training batch loss: 0.1389 in epoch 5
2024-08-15 17:19:42,634 : INFO : Epoch finished, average loss over training batches: 0.0992
2024-08-15 17:19:42,634 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:42,634 : INFO : Training metrics:
2024-08-15 17:19:42,634 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:42,639 : INFO : Accuracy: 0.9744
2024-08-15 17:19:42,639 : INFO : Precision score for label_class 0: 0.9153
2024-08-15 17:19:42,639 : INFO : Precision score for label_class 1: 0.9869
2024-08-15 17:19:42,639 : INFO : Precision score for label_class 2: 0.9757
2024-08-15 17:19:42,639 : INFO : Recall score for label_class 0: 0.9878
2024-08-15 17:19:42,639 : INFO : Recall score for label_class 1: 0.9820
2024-08-15 17:19:42,639 : INFO : Recall score for label_class 2: 0.9526
2024-08-15 17:19:42,639 : INFO : Average F1 score: 0.9662
2024-08-15 17:19:43,104 : INFO : Average loss over validation batches: 0.3983
2024-08-15 17:19:43,105 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:43,105 : INFO : Validation metrics:
2024-08-15 17:19:43,105 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:43,107 : INFO : Accuracy: 0.8726
2024-08-15 17:19:43,107 : INFO : Precision score for label_class 0: 0.8090
2024-08-15 17:19:43,107 : INFO : Precision score for label_class 1: 0.9253
2024-08-15 17:19:43,107 : INFO : Precision score for label_class 2: 0.7980
2024-08-15 17:19:43,107 : INFO : Recall score for label_class 0: 0.8372
2024-08-15 17:19:43,107 : INFO : Recall score for label_class 1: 0.8975
2024-08-15 17:19:43,107 : INFO : Recall score for label_class 2: 0.8360
2024-08-15 17:19:43,107 : INFO : Average F1 score: 0.8502
2024-08-15 17:19:43,107 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:19:43,107 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:19:43,147 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:19:43,647 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:43,647 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:19:43,647 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:43,650 : INFO : Accuracy: 0.8607
2024-08-15 17:19:43,650 : INFO : Precision score for label_class 0: 0.7872
2024-08-15 17:19:43,650 : INFO : Precision score for label_class 1: 0.8937
2024-08-15 17:19:43,650 : INFO : Precision score for label_class 2: 0.8204
2024-08-15 17:19:43,650 : INFO : Recall score for label_class 0: 0.8605
2024-08-15 17:19:43,650 : INFO : Recall score for label_class 1: 0.9250
2024-08-15 17:19:43,650 : INFO : Recall score for label_class 2: 0.7249
2024-08-15 17:19:43,650 : INFO : Average F1 score: 0.8337
2024-08-15 17:19:43,650 : INFO : Determined score from best model, ending training.
2024-08-15 17:19:43,652 : INFO : Split 3 is finished, the score is: 0.8337
2024-08-15 17:19:43,652 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:43,652 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:43,652 : INFO : Starting training for split 4
2024-08-15 17:19:43,667 : INFO : Starting to tokenize the sequences.
2024-08-15 17:19:43,672 : INFO : Tokenization is finished.
2024-08-15 17:19:43,689 : INFO : Starting to tokenize the sequences.
2024-08-15 17:19:43,694 : INFO : Tokenization is finished.
2024-08-15 17:19:43,699 : INFO : Counting occurences of labels...
2024-08-15 17:19:43,699 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 327, 1621,  751]))
2024-08-15 17:19:43,700 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 87, 390, 197]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:19:43,743 : INFO : Starting epoch 1
2024-08-15 17:19:43,795 : INFO : Current training batch loss: 1.1174 in epoch 1
2024-08-15 17:19:44,612 : INFO : Current training batch loss: 1.0132 in epoch 1
2024-08-15 17:19:45,427 : INFO : Current training batch loss: 0.7826 in epoch 1
2024-08-15 17:19:46,241 : INFO : Current training batch loss: 0.6776 in epoch 1
2024-08-15 17:19:47,056 : INFO : Current training batch loss: 0.5701 in epoch 1
2024-08-15 17:19:47,206 : INFO : Epoch finished, average loss over training batches: 0.8410
2024-08-15 17:19:47,207 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:47,207 : INFO : Training metrics:
2024-08-15 17:19:47,207 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:47,214 : INFO : Accuracy: 0.6232
2024-08-15 17:19:47,214 : INFO : Precision score for label_class 0: 0.1230
2024-08-15 17:19:47,214 : INFO : Precision score for label_class 1: 0.6982
2024-08-15 17:19:47,214 : INFO : Precision score for label_class 2: 0.5593
2024-08-15 17:19:47,214 : INFO : Recall score for label_class 0: 0.0917
2024-08-15 17:19:47,214 : INFO : Recall score for label_class 1: 0.8649
2024-08-15 17:19:47,214 : INFO : Recall score for label_class 2: 0.3329
2024-08-15 17:19:47,214 : INFO : Average F1 score: 0.4317
2024-08-15 17:19:47,679 : INFO : Average loss over validation batches: 0.6456
2024-08-15 17:19:47,679 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:47,679 : INFO : Validation metrics:
2024-08-15 17:19:47,679 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:47,682 : INFO : Accuracy: 0.7478
2024-08-15 17:19:47,682 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:19:47,682 : INFO : Precision score for label_class 1: 0.8672
2024-08-15 17:19:47,682 : INFO : Precision score for label_class 2: 0.5745
2024-08-15 17:19:47,682 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:19:47,682 : INFO : Recall score for label_class 1: 0.8872
2024-08-15 17:19:47,682 : INFO : Recall score for label_class 2: 0.8020
2024-08-15 17:19:47,682 : INFO : Average F1 score: 0.5155
2024-08-15 17:19:47,682 : INFO : Validation metric decreased (inf --> 0.645604).  Saving model ...
2024-08-15 17:19:47,793 : INFO : Starting epoch 2
2024-08-15 17:19:48,447 : INFO : Current training batch loss: 0.6412 in epoch 2
2024-08-15 17:19:49,260 : INFO : Current training batch loss: 0.4844 in epoch 2
2024-08-15 17:19:50,075 : INFO : Current training batch loss: 0.3060 in epoch 2
2024-08-15 17:19:50,889 : INFO : Current training batch loss: 0.4163 in epoch 2
2024-08-15 17:19:51,246 : INFO : Epoch finished, average loss over training batches: 0.4995
2024-08-15 17:19:51,246 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:51,246 : INFO : Training metrics:
2024-08-15 17:19:51,246 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:51,254 : INFO : Accuracy: 0.8159
2024-08-15 17:19:51,254 : INFO : Precision score for label_class 0: 0.7892
2024-08-15 17:19:51,254 : INFO : Precision score for label_class 1: 0.8670
2024-08-15 17:19:51,254 : INFO : Precision score for label_class 2: 0.7100
2024-08-15 17:19:51,254 : INFO : Recall score for label_class 0: 0.5382
2024-08-15 17:19:51,254 : INFO : Recall score for label_class 1: 0.9130
2024-08-15 17:19:51,254 : INFO : Recall score for label_class 2: 0.7270
2024-08-15 17:19:51,254 : INFO : Average F1 score: 0.7493
2024-08-15 17:19:51,730 : INFO : Average loss over validation batches: 0.4016
2024-08-15 17:19:51,730 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:51,730 : INFO : Validation metrics:
2024-08-15 17:19:51,730 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:51,734 : INFO : Accuracy: 0.8487
2024-08-15 17:19:51,734 : INFO : Precision score for label_class 0: 0.7253
2024-08-15 17:19:51,734 : INFO : Precision score for label_class 1: 0.8670
2024-08-15 17:19:51,734 : INFO : Precision score for label_class 2: 0.8704
2024-08-15 17:19:51,734 : INFO : Recall score for label_class 0: 0.7586
2024-08-15 17:19:51,734 : INFO : Recall score for label_class 1: 0.9359
2024-08-15 17:19:51,734 : INFO : Recall score for label_class 2: 0.7157
2024-08-15 17:19:51,734 : INFO : Average F1 score: 0.8091
2024-08-15 17:19:51,734 : INFO : Validation metric decreased (0.645604 --> 0.401617).  Saving model ...
2024-08-15 17:19:51,838 : INFO : Starting epoch 3
2024-08-15 17:19:52,293 : INFO : Current training batch loss: 0.2752 in epoch 3
2024-08-15 17:19:53,109 : INFO : Current training batch loss: 0.2133 in epoch 3
2024-08-15 17:19:53,927 : INFO : Current training batch loss: 0.1526 in epoch 3
2024-08-15 17:19:54,743 : INFO : Current training batch loss: 0.1936 in epoch 3
2024-08-15 17:19:55,295 : INFO : Epoch finished, average loss over training batches: 0.2601
2024-08-15 17:19:55,296 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:55,296 : INFO : Training metrics:
2024-08-15 17:19:55,296 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:55,299 : INFO : Accuracy: 0.9200
2024-08-15 17:19:55,299 : INFO : Precision score for label_class 0: 0.8537
2024-08-15 17:19:55,299 : INFO : Precision score for label_class 1: 0.9471
2024-08-15 17:19:55,299 : INFO : Precision score for label_class 2: 0.8902
2024-08-15 17:19:55,299 : INFO : Recall score for label_class 0: 0.8746
2024-08-15 17:19:55,299 : INFO : Recall score for label_class 1: 0.9500
2024-08-15 17:19:55,299 : INFO : Recall score for label_class 2: 0.8748
2024-08-15 17:19:55,300 : INFO : Average F1 score: 0.8984
2024-08-15 17:19:55,765 : INFO : Average loss over validation batches: 0.4112
2024-08-15 17:19:55,765 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:55,765 : INFO : Validation metrics:
2024-08-15 17:19:55,765 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:55,768 : INFO : Accuracy: 0.8531
2024-08-15 17:19:55,768 : INFO : Precision score for label_class 0: 0.8214
2024-08-15 17:19:55,768 : INFO : Precision score for label_class 1: 0.9276
2024-08-15 17:19:55,768 : INFO : Precision score for label_class 2: 0.7489
2024-08-15 17:19:55,768 : INFO : Recall score for label_class 0: 0.7931
2024-08-15 17:19:55,768 : INFO : Recall score for label_class 1: 0.8538
2024-08-15 17:19:55,768 : INFO : Recall score for label_class 2: 0.8782
2024-08-15 17:19:55,768 : INFO : Average F1 score: 0.8349
2024-08-15 17:19:55,768 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:19:55,768 : INFO : Starting epoch 4
2024-08-15 17:19:56,020 : INFO : Current training batch loss: 0.2715 in epoch 4
2024-08-15 17:19:56,834 : INFO : Current training batch loss: 0.3500 in epoch 4
2024-08-15 17:19:57,649 : INFO : Current training batch loss: 0.1553 in epoch 4
2024-08-15 17:19:58,463 : INFO : Current training batch loss: 0.1410 in epoch 4
2024-08-15 17:19:59,216 : INFO : Epoch finished, average loss over training batches: 0.1543
2024-08-15 17:19:59,217 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:59,217 : INFO : Training metrics:
2024-08-15 17:19:59,217 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:59,221 : INFO : Accuracy: 0.9544
2024-08-15 17:19:59,221 : INFO : Precision score for label_class 0: 0.8938
2024-08-15 17:19:59,221 : INFO : Precision score for label_class 1: 0.9734
2024-08-15 17:19:59,221 : INFO : Precision score for label_class 2: 0.9409
2024-08-15 17:19:59,221 : INFO : Recall score for label_class 0: 0.9266
2024-08-15 17:19:59,221 : INFO : Recall score for label_class 1: 0.9704
2024-08-15 17:19:59,221 : INFO : Recall score for label_class 2: 0.9321
2024-08-15 17:19:59,221 : INFO : Average F1 score: 0.9394
2024-08-15 17:19:59,686 : INFO : Average loss over validation batches: 0.3903
2024-08-15 17:19:59,686 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:59,686 : INFO : Validation metrics:
2024-08-15 17:19:59,686 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:19:59,690 : INFO : Accuracy: 0.8546
2024-08-15 17:19:59,690 : INFO : Precision score for label_class 0: 0.8025
2024-08-15 17:19:59,690 : INFO : Precision score for label_class 1: 0.8934
2024-08-15 17:19:59,690 : INFO : Precision score for label_class 2: 0.7990
2024-08-15 17:19:59,690 : INFO : Recall score for label_class 0: 0.7471
2024-08-15 17:19:59,690 : INFO : Recall score for label_class 1: 0.9026
2024-08-15 17:19:59,690 : INFO : Recall score for label_class 2: 0.8071
2024-08-15 17:19:59,690 : INFO : Average F1 score: 0.8249
2024-08-15 17:19:59,690 : INFO : Validation metric decreased (0.401617 --> 0.390291).  Saving model ...
2024-08-15 17:19:59,792 : INFO : Starting epoch 5
2024-08-15 17:19:59,843 : INFO : Current training batch loss: 0.0454 in epoch 5
2024-08-15 17:20:00,657 : INFO : Current training batch loss: 0.1199 in epoch 5
2024-08-15 17:20:01,471 : INFO : Current training batch loss: 0.0335 in epoch 5
2024-08-15 17:20:02,286 : INFO : Current training batch loss: 0.1459 in epoch 5
2024-08-15 17:20:03,101 : INFO : Current training batch loss: 0.3218 in epoch 5
2024-08-15 17:20:03,251 : INFO : Epoch finished, average loss over training batches: 0.0972
2024-08-15 17:20:03,251 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:03,251 : INFO : Training metrics:
2024-08-15 17:20:03,251 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:03,258 : INFO : Accuracy: 0.9737
2024-08-15 17:20:03,258 : INFO : Precision score for label_class 0: 0.9339
2024-08-15 17:20:03,258 : INFO : Precision score for label_class 1: 0.9864
2024-08-15 17:20:03,259 : INFO : Precision score for label_class 2: 0.9640
2024-08-15 17:20:03,259 : INFO : Recall score for label_class 0: 0.9511
2024-08-15 17:20:03,259 : INFO : Recall score for label_class 1: 0.9827
2024-08-15 17:20:03,259 : INFO : Recall score for label_class 2: 0.9640
2024-08-15 17:20:03,259 : INFO : Average F1 score: 0.9637
2024-08-15 17:20:03,723 : INFO : Average loss over validation batches: 0.3929
2024-08-15 17:20:03,723 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:03,723 : INFO : Validation metrics:
2024-08-15 17:20:03,723 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:03,726 : INFO : Accuracy: 0.8739
2024-08-15 17:20:03,726 : INFO : Precision score for label_class 0: 0.7475
2024-08-15 17:20:03,726 : INFO : Precision score for label_class 1: 0.9239
2024-08-15 17:20:03,726 : INFO : Precision score for label_class 2: 0.8402
2024-08-15 17:20:03,726 : INFO : Recall score for label_class 0: 0.8506
2024-08-15 17:20:03,726 : INFO : Recall score for label_class 1: 0.9026
2024-08-15 17:20:03,726 : INFO : Recall score for label_class 2: 0.8274
2024-08-15 17:20:03,726 : INFO : Average F1 score: 0.8475
2024-08-15 17:20:03,726 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:20:03,726 : INFO : Starting epoch 6
2024-08-15 17:20:04,380 : INFO : Current training batch loss: 0.0464 in epoch 6
2024-08-15 17:20:05,194 : INFO : Current training batch loss: 0.1316 in epoch 6
2024-08-15 17:20:06,009 : INFO : Current training batch loss: 0.0260 in epoch 6
2024-08-15 17:20:06,827 : INFO : Current training batch loss: 0.0186 in epoch 6
2024-08-15 17:20:07,182 : INFO : Epoch finished, average loss over training batches: 0.0624
2024-08-15 17:20:07,182 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:07,182 : INFO : Training metrics:
2024-08-15 17:20:07,182 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:07,186 : INFO : Accuracy: 0.9859
2024-08-15 17:20:07,186 : INFO : Precision score for label_class 0: 0.9463
2024-08-15 17:20:07,186 : INFO : Precision score for label_class 1: 0.9950
2024-08-15 17:20:07,186 : INFO : Precision score for label_class 2: 0.9840
2024-08-15 17:20:07,186 : INFO : Recall score for label_class 0: 0.9694
2024-08-15 17:20:07,186 : INFO : Recall score for label_class 1: 0.9901
2024-08-15 17:20:07,186 : INFO : Recall score for label_class 2: 0.9840
2024-08-15 17:20:07,186 : INFO : Average F1 score: 0.9781
2024-08-15 17:20:07,650 : INFO : Average loss over validation batches: 0.4375
2024-08-15 17:20:07,650 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:07,650 : INFO : Validation metrics:
2024-08-15 17:20:07,650 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:07,654 : INFO : Accuracy: 0.8724
2024-08-15 17:20:07,654 : INFO : Precision score for label_class 0: 0.7684
2024-08-15 17:20:07,654 : INFO : Precision score for label_class 1: 0.8883
2024-08-15 17:20:07,654 : INFO : Precision score for label_class 2: 0.8922
2024-08-15 17:20:07,654 : INFO : Recall score for label_class 0: 0.8391
2024-08-15 17:20:07,654 : INFO : Recall score for label_class 1: 0.9385
2024-08-15 17:20:07,654 : INFO : Recall score for label_class 2: 0.7563
2024-08-15 17:20:07,654 : INFO : Average F1 score: 0.8445
2024-08-15 17:20:07,654 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:20:07,654 : INFO : Starting epoch 7
2024-08-15 17:20:08,118 : INFO : Current training batch loss: 0.0225 in epoch 7
2024-08-15 17:20:08,950 : INFO : Current training batch loss: 0.0238 in epoch 7
2024-08-15 17:20:09,766 : INFO : Current training batch loss: 0.0238 in epoch 7
2024-08-15 17:20:10,584 : INFO : Current training batch loss: 0.0173 in epoch 7
2024-08-15 17:20:11,141 : INFO : Epoch finished, average loss over training batches: 0.0468
2024-08-15 17:20:11,141 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:11,141 : INFO : Training metrics:
2024-08-15 17:20:11,141 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:11,145 : INFO : Accuracy: 0.9907
2024-08-15 17:20:11,145 : INFO : Precision score for label_class 0: 0.9697
2024-08-15 17:20:11,145 : INFO : Precision score for label_class 1: 0.9963
2024-08-15 17:20:11,145 : INFO : Precision score for label_class 2: 0.9880
2024-08-15 17:20:11,145 : INFO : Recall score for label_class 0: 0.9786
2024-08-15 17:20:11,145 : INFO : Recall score for label_class 1: 0.9944
2024-08-15 17:20:11,145 : INFO : Recall score for label_class 2: 0.9880
2024-08-15 17:20:11,145 : INFO : Average F1 score: 0.9858
2024-08-15 17:20:11,610 : INFO : Average loss over validation batches: 0.4268
2024-08-15 17:20:11,610 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:11,610 : INFO : Validation metrics:
2024-08-15 17:20:11,610 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:11,613 : INFO : Accuracy: 0.8754
2024-08-15 17:20:11,613 : INFO : Precision score for label_class 0: 0.7955
2024-08-15 17:20:11,613 : INFO : Precision score for label_class 1: 0.9093
2024-08-15 17:20:11,613 : INFO : Precision score for label_class 2: 0.8413
2024-08-15 17:20:11,613 : INFO : Recall score for label_class 0: 0.8046
2024-08-15 17:20:11,613 : INFO : Recall score for label_class 1: 0.9256
2024-08-15 17:20:11,613 : INFO : Recall score for label_class 2: 0.8071
2024-08-15 17:20:11,613 : INFO : Average F1 score: 0.8471
2024-08-15 17:20:11,613 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:20:11,613 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:20:11,648 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:20:12,148 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:12,148 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:20:12,148 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:12,152 : INFO : Accuracy: 0.8546
2024-08-15 17:20:12,152 : INFO : Precision score for label_class 0: 0.8025
2024-08-15 17:20:12,152 : INFO : Precision score for label_class 1: 0.8934
2024-08-15 17:20:12,152 : INFO : Precision score for label_class 2: 0.7990
2024-08-15 17:20:12,152 : INFO : Recall score for label_class 0: 0.7471
2024-08-15 17:20:12,152 : INFO : Recall score for label_class 1: 0.9026
2024-08-15 17:20:12,152 : INFO : Recall score for label_class 2: 0.8071
2024-08-15 17:20:12,152 : INFO : Average F1 score: 0.8249
2024-08-15 17:20:12,152 : INFO : Determined score from best model, ending training.
2024-08-15 17:20:12,159 : INFO : Split 4 is finished, the score is: 0.8249
2024-08-15 17:20:12,159 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:12,159 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:12,159 : INFO : Starting training for split 5
2024-08-15 17:20:12,171 : INFO : Starting to tokenize the sequences.
2024-08-15 17:20:12,177 : INFO : Tokenization is finished.
2024-08-15 17:20:12,195 : INFO : Starting to tokenize the sequences.
2024-08-15 17:20:12,200 : INFO : Tokenization is finished.
2024-08-15 17:20:12,205 : INFO : Counting occurences of labels...
2024-08-15 17:20:12,206 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 330, 1615,  754]))
2024-08-15 17:20:12,206 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 84, 396, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:20:12,257 : INFO : Starting epoch 1
2024-08-15 17:20:12,308 : INFO : Current training batch loss: 1.1011 in epoch 1
2024-08-15 17:20:13,125 : INFO : Current training batch loss: 1.0076 in epoch 1
2024-08-15 17:20:13,942 : INFO : Current training batch loss: 0.7480 in epoch 1
2024-08-15 17:20:14,760 : INFO : Current training batch loss: 0.6734 in epoch 1
2024-08-15 17:20:15,580 : INFO : Current training batch loss: 0.6450 in epoch 1
2024-08-15 17:20:15,734 : INFO : Epoch finished, average loss over training batches: 0.8160
2024-08-15 17:20:15,734 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:15,735 : INFO : Training metrics:
2024-08-15 17:20:15,735 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:15,745 : INFO : Accuracy: 0.6565
2024-08-15 17:20:15,745 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:20:15,745 : INFO : Precision score for label_class 1: 0.7045
2024-08-15 17:20:15,745 : INFO : Precision score for label_class 2: 0.4974
2024-08-15 17:20:15,745 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:20:15,745 : INFO : Recall score for label_class 1: 0.9183
2024-08-15 17:20:15,745 : INFO : Recall score for label_class 2: 0.3833
2024-08-15 17:20:15,745 : INFO : Average F1 score: 0.4101
2024-08-15 17:20:16,212 : INFO : Average loss over validation batches: 0.5933
2024-08-15 17:20:16,212 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:16,212 : INFO : Validation metrics:
2024-08-15 17:20:16,212 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:16,216 : INFO : Accuracy: 0.7389
2024-08-15 17:20:16,216 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:20:16,216 : INFO : Precision score for label_class 1: 0.8403
2024-08-15 17:20:16,216 : INFO : Precision score for label_class 2: 0.5579
2024-08-15 17:20:16,216 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:20:16,216 : INFO : Recall score for label_class 1: 0.9167
2024-08-15 17:20:16,216 : INFO : Recall score for label_class 2: 0.6959
2024-08-15 17:20:16,216 : INFO : Average F1 score: 0.4987
2024-08-15 17:20:16,216 : INFO : Validation metric decreased (inf --> 0.593251).  Saving model ...
2024-08-15 17:20:16,327 : INFO : Starting epoch 2
2024-08-15 17:20:17,000 : INFO : Current training batch loss: 0.5808 in epoch 2
2024-08-15 17:20:17,839 : INFO : Current training batch loss: 0.4156 in epoch 2
2024-08-15 17:20:18,657 : INFO : Current training batch loss: 0.2831 in epoch 2
2024-08-15 17:20:19,475 : INFO : Current training batch loss: 0.4277 in epoch 2
2024-08-15 17:20:19,829 : INFO : Epoch finished, average loss over training batches: 0.4488
2024-08-15 17:20:19,830 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:19,830 : INFO : Training metrics:
2024-08-15 17:20:19,830 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:19,836 : INFO : Accuracy: 0.8474
2024-08-15 17:20:19,837 : INFO : Precision score for label_class 0: 0.7559
2024-08-15 17:20:19,837 : INFO : Precision score for label_class 1: 0.8893
2024-08-15 17:20:19,837 : INFO : Precision score for label_class 2: 0.7860
2024-08-15 17:20:19,837 : INFO : Recall score for label_class 0: 0.6758
2024-08-15 17:20:19,837 : INFO : Recall score for label_class 1: 0.9300
2024-08-15 17:20:19,837 : INFO : Recall score for label_class 2: 0.7454
2024-08-15 17:20:19,837 : INFO : Average F1 score: 0.7960
2024-08-15 17:20:20,303 : INFO : Average loss over validation batches: 0.4635
2024-08-15 17:20:20,303 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:20,303 : INFO : Validation metrics:
2024-08-15 17:20:20,303 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:20,307 : INFO : Accuracy: 0.8205
2024-08-15 17:20:20,307 : INFO : Precision score for label_class 0: 0.8235
2024-08-15 17:20:20,307 : INFO : Precision score for label_class 1: 0.8592
2024-08-15 17:20:20,307 : INFO : Precision score for label_class 2: 0.7360
2024-08-15 17:20:20,307 : INFO : Recall score for label_class 0: 0.5000
2024-08-15 17:20:20,307 : INFO : Recall score for label_class 1: 0.9242
2024-08-15 17:20:20,307 : INFO : Recall score for label_class 2: 0.7474
2024-08-15 17:20:20,307 : INFO : Average F1 score: 0.7515
2024-08-15 17:20:20,307 : INFO : Validation metric decreased (0.593251 --> 0.463539).  Saving model ...
2024-08-15 17:20:20,408 : INFO : Starting epoch 3
2024-08-15 17:20:20,863 : INFO : Current training batch loss: 0.2355 in epoch 3
2024-08-15 17:20:21,696 : INFO : Current training batch loss: 0.2717 in epoch 3
2024-08-15 17:20:22,534 : INFO : Current training batch loss: 0.1797 in epoch 3
2024-08-15 17:20:23,370 : INFO : Current training batch loss: 0.1110 in epoch 3
2024-08-15 17:20:23,939 : INFO : Epoch finished, average loss over training batches: 0.2541
2024-08-15 17:20:23,940 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:23,940 : INFO : Training metrics:
2024-08-15 17:20:23,940 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:23,947 : INFO : Accuracy: 0.9166
2024-08-15 17:20:23,947 : INFO : Precision score for label_class 0: 0.8471
2024-08-15 17:20:23,947 : INFO : Precision score for label_class 1: 0.9462
2024-08-15 17:20:23,947 : INFO : Precision score for label_class 2: 0.8841
2024-08-15 17:20:23,947 : INFO : Recall score for label_class 0: 0.8727
2024-08-15 17:20:23,947 : INFO : Recall score for label_class 1: 0.9474
2024-08-15 17:20:23,947 : INFO : Recall score for label_class 2: 0.8700
2024-08-15 17:20:23,947 : INFO : Average F1 score: 0.8945
2024-08-15 17:20:24,413 : INFO : Average loss over validation batches: 0.4336
2024-08-15 17:20:24,414 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:24,414 : INFO : Validation metrics:
2024-08-15 17:20:24,414 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:24,417 : INFO : Accuracy: 0.8442
2024-08-15 17:20:24,417 : INFO : Precision score for label_class 0: 0.7917
2024-08-15 17:20:24,417 : INFO : Precision score for label_class 1: 0.8987
2024-08-15 17:20:24,417 : INFO : Precision score for label_class 2: 0.7585
2024-08-15 17:20:24,417 : INFO : Recall score for label_class 0: 0.6786
2024-08-15 17:20:24,417 : INFO : Recall score for label_class 1: 0.8965
2024-08-15 17:20:24,417 : INFO : Recall score for label_class 2: 0.8093
2024-08-15 17:20:24,417 : INFO : Average F1 score: 0.8038
2024-08-15 17:20:24,417 : INFO : Validation metric decreased (0.463539 --> 0.433633).  Saving model ...
2024-08-15 17:20:24,521 : INFO : Starting epoch 4
2024-08-15 17:20:24,779 : INFO : Current training batch loss: 0.3616 in epoch 4
2024-08-15 17:20:25,615 : INFO : Current training batch loss: 0.2162 in epoch 4
2024-08-15 17:20:26,429 : INFO : Current training batch loss: 0.2046 in epoch 4
2024-08-15 17:20:27,242 : INFO : Current training batch loss: 0.0714 in epoch 4
2024-08-15 17:20:27,988 : INFO : Epoch finished, average loss over training batches: 0.1583
2024-08-15 17:20:27,989 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:27,989 : INFO : Training metrics:
2024-08-15 17:20:27,989 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:27,997 : INFO : Accuracy: 0.9544
2024-08-15 17:20:27,997 : INFO : Precision score for label_class 0: 0.8929
2024-08-15 17:20:27,997 : INFO : Precision score for label_class 1: 0.9734
2024-08-15 17:20:27,997 : INFO : Precision score for label_class 2: 0.9412
2024-08-15 17:20:27,997 : INFO : Recall score for label_class 0: 0.9091
2024-08-15 17:20:27,997 : INFO : Recall score for label_class 1: 0.9734
2024-08-15 17:20:27,997 : INFO : Recall score for label_class 2: 0.9337
2024-08-15 17:20:27,997 : INFO : Average F1 score: 0.9372
2024-08-15 17:20:28,463 : INFO : Average loss over validation batches: 0.4723
2024-08-15 17:20:28,463 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:28,463 : INFO : Validation metrics:
2024-08-15 17:20:28,463 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:28,467 : INFO : Accuracy: 0.8457
2024-08-15 17:20:28,467 : INFO : Precision score for label_class 0: 0.7442
2024-08-15 17:20:28,467 : INFO : Precision score for label_class 1: 0.9180
2024-08-15 17:20:28,467 : INFO : Precision score for label_class 2: 0.7571
2024-08-15 17:20:28,467 : INFO : Recall score for label_class 0: 0.7619
2024-08-15 17:20:28,467 : INFO : Recall score for label_class 1: 0.8763
2024-08-15 17:20:28,467 : INFO : Recall score for label_class 2: 0.8196
2024-08-15 17:20:28,467 : INFO : Average F1 score: 0.8122
2024-08-15 17:20:28,467 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:20:28,467 : INFO : Starting epoch 5
2024-08-15 17:20:28,518 : INFO : Current training batch loss: 0.0622 in epoch 5
2024-08-15 17:20:29,408 : INFO : Current training batch loss: 0.1781 in epoch 5
2024-08-15 17:20:30,220 : INFO : Current training batch loss: 0.0320 in epoch 5
2024-08-15 17:20:31,034 : INFO : Current training batch loss: 0.0897 in epoch 5
2024-08-15 17:20:31,847 : INFO : Current training batch loss: 0.0508 in epoch 5
2024-08-15 17:20:31,992 : INFO : Epoch finished, average loss over training batches: 0.0850
2024-08-15 17:20:31,992 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:31,992 : INFO : Training metrics:
2024-08-15 17:20:31,992 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:32,000 : INFO : Accuracy: 0.9785
2024-08-15 17:20:32,000 : INFO : Precision score for label_class 0: 0.9320
2024-08-15 17:20:32,000 : INFO : Precision score for label_class 1: 0.9901
2024-08-15 17:20:32,000 : INFO : Precision score for label_class 2: 0.9747
2024-08-15 17:20:32,000 : INFO : Recall score for label_class 0: 0.9545
2024-08-15 17:20:32,000 : INFO : Recall score for label_class 1: 0.9876
2024-08-15 17:20:32,000 : INFO : Recall score for label_class 2: 0.9695
2024-08-15 17:20:32,000 : INFO : Average F1 score: 0.9680
2024-08-15 17:20:32,467 : INFO : Average loss over validation batches: 0.4776
2024-08-15 17:20:32,467 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:32,467 : INFO : Validation metrics:
2024-08-15 17:20:32,467 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:32,471 : INFO : Accuracy: 0.8412
2024-08-15 17:20:32,471 : INFO : Precision score for label_class 0: 0.7053
2024-08-15 17:20:32,471 : INFO : Precision score for label_class 1: 0.8990
2024-08-15 17:20:32,471 : INFO : Precision score for label_class 2: 0.7927
2024-08-15 17:20:32,471 : INFO : Recall score for label_class 0: 0.7976
2024-08-15 17:20:32,471 : INFO : Recall score for label_class 1: 0.8763
2024-08-15 17:20:32,471 : INFO : Recall score for label_class 2: 0.7887
2024-08-15 17:20:32,471 : INFO : Average F1 score: 0.8089
2024-08-15 17:20:32,471 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:20:32,471 : INFO : Starting epoch 6
2024-08-15 17:20:33,127 : INFO : Current training batch loss: 0.0261 in epoch 6
2024-08-15 17:20:33,955 : INFO : Current training batch loss: 0.0224 in epoch 6
2024-08-15 17:20:34,795 : INFO : Current training batch loss: 0.0218 in epoch 6
2024-08-15 17:20:35,636 : INFO : Current training batch loss: 0.0711 in epoch 6
2024-08-15 17:20:36,001 : INFO : Epoch finished, average loss over training batches: 0.0521
2024-08-15 17:20:36,002 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:36,002 : INFO : Training metrics:
2024-08-15 17:20:36,002 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:36,010 : INFO : Accuracy: 0.9900
2024-08-15 17:20:36,010 : INFO : Precision score for label_class 0: 0.9587
2024-08-15 17:20:36,010 : INFO : Precision score for label_class 1: 0.9975
2024-08-15 17:20:36,010 : INFO : Precision score for label_class 2: 0.9880
2024-08-15 17:20:36,010 : INFO : Recall score for label_class 0: 0.9848
2024-08-15 17:20:36,010 : INFO : Recall score for label_class 1: 0.9926
2024-08-15 17:20:36,010 : INFO : Recall score for label_class 2: 0.9867
2024-08-15 17:20:36,010 : INFO : Average F1 score: 0.9847
2024-08-15 17:20:36,477 : INFO : Average loss over validation batches: 0.4716
2024-08-15 17:20:36,477 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:36,477 : INFO : Validation metrics:
2024-08-15 17:20:36,477 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:36,481 : INFO : Accuracy: 0.8531
2024-08-15 17:20:36,481 : INFO : Precision score for label_class 0: 0.7738
2024-08-15 17:20:36,481 : INFO : Precision score for label_class 1: 0.9026
2024-08-15 17:20:36,481 : INFO : Precision score for label_class 2: 0.7900
2024-08-15 17:20:36,481 : INFO : Recall score for label_class 0: 0.7738
2024-08-15 17:20:36,481 : INFO : Recall score for label_class 1: 0.8889
2024-08-15 17:20:36,481 : INFO : Recall score for label_class 2: 0.8144
2024-08-15 17:20:36,481 : INFO : Average F1 score: 0.8238
2024-08-15 17:20:36,481 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:20:36,481 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:20:36,516 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:20:37,015 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:37,015 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:20:37,015 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:37,018 : INFO : Accuracy: 0.8442
2024-08-15 17:20:37,018 : INFO : Precision score for label_class 0: 0.7917
2024-08-15 17:20:37,018 : INFO : Precision score for label_class 1: 0.8987
2024-08-15 17:20:37,018 : INFO : Precision score for label_class 2: 0.7585
2024-08-15 17:20:37,018 : INFO : Recall score for label_class 0: 0.6786
2024-08-15 17:20:37,018 : INFO : Recall score for label_class 1: 0.8965
2024-08-15 17:20:37,018 : INFO : Recall score for label_class 2: 0.8093
2024-08-15 17:20:37,018 : INFO : Average F1 score: 0.8038
2024-08-15 17:20:37,018 : INFO : Determined score from best model, ending training.
2024-08-15 17:20:37,025 : INFO : Split 5 is finished, the score is: 0.8038
2024-08-15 17:20:37,025 : INFO : ----------------------------------------------------------------------------------------------------
[I 2024-08-15 17:20:37,035] Trial 7 finished with value: 0.8362023486576906 and parameters: {'n_epochs': 7, 'learning_rate': 6.386071013184054e-05, 'classifier_dropout': 0.8487480845026859, 'warmup_step_fraction': 0.04823547429026722, 'use_gradient_clipping': False}. Best is trial 1 with value: 0.8513001269595835.
2024-08-15 17:20:37,036 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:37,036 : INFO : Starting training for split 1
2024-08-15 17:20:37,048 : INFO : Starting to tokenize the sequences.
2024-08-15 17:20:37,053 : INFO : Tokenization is finished.
2024-08-15 17:20:37,065 : INFO : Starting to tokenize the sequences.
2024-08-15 17:20:37,070 : INFO : Tokenization is finished.
2024-08-15 17:20:37,070 : INFO : Counting occurences of labels...
2024-08-15 17:20:37,071 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1596,  774]))
2024-08-15 17:20:37,071 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 415, 174]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:20:37,122 : INFO : Starting epoch 1
2024-08-15 17:20:37,173 : INFO : Current training batch loss: 1.0926 in epoch 1
2024-08-15 17:20:37,991 : INFO : Current training batch loss: 0.9281 in epoch 1
2024-08-15 17:20:38,809 : INFO : Current training batch loss: 0.9814 in epoch 1
2024-08-15 17:20:39,630 : INFO : Current training batch loss: 0.8162 in epoch 1
2024-08-15 17:20:40,449 : INFO : Current training batch loss: 0.8478 in epoch 1
2024-08-15 17:20:40,604 : INFO : Epoch finished, average loss over training batches: 0.9012
2024-08-15 17:20:40,604 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:40,604 : INFO : Training metrics:
2024-08-15 17:20:40,604 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:40,612 : INFO : Accuracy: 0.6494
2024-08-15 17:20:40,612 : INFO : Precision score for label_class 0: 0.2857
2024-08-15 17:20:40,612 : INFO : Precision score for label_class 1: 0.6627
2024-08-15 17:20:40,612 : INFO : Precision score for label_class 2: 0.5610
2024-08-15 17:20:40,612 : INFO : Recall score for label_class 0: 0.0061
2024-08-15 17:20:40,612 : INFO : Recall score for label_class 1: 0.9812
2024-08-15 17:20:40,612 : INFO : Recall score for label_class 2: 0.2377
2024-08-15 17:20:40,612 : INFO : Average F1 score: 0.3790
2024-08-15 17:20:41,077 : INFO : Average loss over validation batches: 0.7443
2024-08-15 17:20:41,077 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:41,077 : INFO : Validation metrics:
2024-08-15 17:20:41,077 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:41,080 : INFO : Accuracy: 0.7111
2024-08-15 17:20:41,080 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:20:41,080 : INFO : Precision score for label_class 1: 0.7763
2024-08-15 17:20:41,080 : INFO : Precision score for label_class 2: 0.5031
2024-08-15 17:20:41,080 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:20:41,080 : INFO : Recall score for label_class 1: 0.9614
2024-08-15 17:20:41,080 : INFO : Recall score for label_class 2: 0.4655
2024-08-15 17:20:41,080 : INFO : Average F1 score: 0.4475
2024-08-15 17:20:41,080 : INFO : Validation metric decreased (inf --> 0.744274).  Saving model ...
2024-08-15 17:20:41,191 : INFO : Starting epoch 2
2024-08-15 17:20:41,848 : INFO : Current training batch loss: 0.5942 in epoch 2
2024-08-15 17:20:42,665 : INFO : Current training batch loss: 0.6647 in epoch 2
2024-08-15 17:20:43,485 : INFO : Current training batch loss: 0.6707 in epoch 2
2024-08-15 17:20:44,303 : INFO : Current training batch loss: 0.5434 in epoch 2
2024-08-15 17:20:44,657 : INFO : Epoch finished, average loss over training batches: 0.6533
2024-08-15 17:20:44,658 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:44,658 : INFO : Training metrics:
2024-08-15 17:20:44,658 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:44,662 : INFO : Accuracy: 0.7561
2024-08-15 17:20:44,662 : INFO : Precision score for label_class 0: 0.7000
2024-08-15 17:20:44,662 : INFO : Precision score for label_class 1: 0.8212
2024-08-15 17:20:44,662 : INFO : Precision score for label_class 2: 0.6129
2024-08-15 17:20:44,662 : INFO : Recall score for label_class 0: 0.0213
2024-08-15 17:20:44,662 : INFO : Recall score for label_class 1: 0.9524
2024-08-15 17:20:44,662 : INFO : Recall score for label_class 2: 0.6628
2024-08-15 17:20:44,662 : INFO : Average F1 score: 0.5201
2024-08-15 17:20:45,128 : INFO : Average loss over validation batches: 0.6157
2024-08-15 17:20:45,128 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:45,128 : INFO : Validation metrics:
2024-08-15 17:20:45,128 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:45,131 : INFO : Accuracy: 0.7659
2024-08-15 17:20:45,131 : INFO : Precision score for label_class 0: 0.6800
2024-08-15 17:20:45,131 : INFO : Precision score for label_class 1: 0.8598
2024-08-15 17:20:45,131 : INFO : Precision score for label_class 2: 0.5860
2024-08-15 17:20:45,131 : INFO : Recall score for label_class 0: 0.1977
2024-08-15 17:20:45,131 : INFO : Recall score for label_class 1: 0.9012
2024-08-15 17:20:45,131 : INFO : Recall score for label_class 2: 0.7241
2024-08-15 17:20:45,131 : INFO : Average F1 score: 0.6114
2024-08-15 17:20:45,131 : INFO : Validation metric decreased (0.744274 --> 0.615695).  Saving model ...
2024-08-15 17:20:45,232 : INFO : Starting epoch 3
2024-08-15 17:20:45,687 : INFO : Current training batch loss: 0.5146 in epoch 3
2024-08-15 17:20:46,509 : INFO : Current training batch loss: 0.5774 in epoch 3
2024-08-15 17:20:47,328 : INFO : Current training batch loss: 0.4918 in epoch 3
2024-08-15 17:20:48,149 : INFO : Current training batch loss: 0.4186 in epoch 3
2024-08-15 17:20:48,705 : INFO : Epoch finished, average loss over training batches: 0.5307
2024-08-15 17:20:48,705 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:48,705 : INFO : Training metrics:
2024-08-15 17:20:48,705 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:48,713 : INFO : Accuracy: 0.8473
2024-08-15 17:20:48,713 : INFO : Precision score for label_class 0: 0.8392
2024-08-15 17:20:48,713 : INFO : Precision score for label_class 1: 0.8703
2024-08-15 17:20:48,713 : INFO : Precision score for label_class 2: 0.7949
2024-08-15 17:20:48,713 : INFO : Recall score for label_class 0: 0.5091
2024-08-15 17:20:48,713 : INFO : Recall score for label_class 1: 0.9586
2024-08-15 17:20:48,713 : INFO : Recall score for label_class 2: 0.7610
2024-08-15 17:20:48,713 : INFO : Average F1 score: 0.7746
2024-08-15 17:20:49,179 : INFO : Average loss over validation batches: 0.5529
2024-08-15 17:20:49,179 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:49,179 : INFO : Validation metrics:
2024-08-15 17:20:49,179 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:49,182 : INFO : Accuracy: 0.8370
2024-08-15 17:20:49,182 : INFO : Precision score for label_class 0: 0.8154
2024-08-15 17:20:49,182 : INFO : Precision score for label_class 1: 0.8671
2024-08-15 17:20:49,182 : INFO : Precision score for label_class 2: 0.7651
2024-08-15 17:20:49,182 : INFO : Recall score for label_class 0: 0.6163
2024-08-15 17:20:49,182 : INFO : Recall score for label_class 1: 0.9277
2024-08-15 17:20:49,182 : INFO : Recall score for label_class 2: 0.7299
2024-08-15 17:20:49,182 : INFO : Average F1 score: 0.7818
2024-08-15 17:20:49,182 : INFO : Validation metric decreased (0.615695 --> 0.552887).  Saving model ...
2024-08-15 17:20:49,288 : INFO : Split 1 is finished, the score is: 0.7818
2024-08-15 17:20:49,288 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:49,288 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:49,288 : INFO : Starting training for split 2
2024-08-15 17:20:49,303 : INFO : Starting to tokenize the sequences.
2024-08-15 17:20:49,308 : INFO : Tokenization is finished.
2024-08-15 17:20:49,325 : INFO : Starting to tokenize the sequences.
2024-08-15 17:20:49,330 : INFO : Tokenization is finished.
2024-08-15 17:20:49,335 : INFO : Counting occurences of labels...
2024-08-15 17:20:49,336 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 343, 1601,  754]))
2024-08-15 17:20:49,336 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 71, 410, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:20:49,383 : INFO : Starting epoch 1
2024-08-15 17:20:49,435 : INFO : Current training batch loss: 1.1098 in epoch 1
2024-08-15 17:20:50,253 : INFO : Current training batch loss: 1.0145 in epoch 1
2024-08-15 17:20:51,086 : INFO : Current training batch loss: 1.0054 in epoch 1
2024-08-15 17:20:51,914 : INFO : Current training batch loss: 0.8564 in epoch 1
2024-08-15 17:20:52,737 : INFO : Current training batch loss: 0.8801 in epoch 1
2024-08-15 17:20:52,892 : INFO : Epoch finished, average loss over training batches: 0.9287
2024-08-15 17:20:52,892 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:52,892 : INFO : Training metrics:
2024-08-15 17:20:52,892 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:52,903 : INFO : Accuracy: 0.5993
2024-08-15 17:20:52,903 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:20:52,903 : INFO : Precision score for label_class 1: 0.6312
2024-08-15 17:20:52,903 : INFO : Precision score for label_class 2: 0.3922
2024-08-15 17:20:52,903 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:20:52,903 : INFO : Recall score for label_class 1: 0.9225
2024-08-15 17:20:52,903 : INFO : Recall score for label_class 2: 0.1857
2024-08-15 17:20:52,903 : INFO : Average F1 score: 0.3339
2024-08-15 17:20:53,369 : INFO : Average loss over validation batches: 0.7880
2024-08-15 17:20:53,369 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:53,369 : INFO : Validation metrics:
2024-08-15 17:20:53,369 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:53,373 : INFO : Accuracy: 0.7022
2024-08-15 17:20:53,373 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:20:53,373 : INFO : Precision score for label_class 1: 0.7520
2024-08-15 17:20:53,373 : INFO : Precision score for label_class 2: 0.5556
2024-08-15 17:20:53,373 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:20:53,373 : INFO : Recall score for label_class 1: 0.9244
2024-08-15 17:20:53,373 : INFO : Recall score for label_class 2: 0.4897
2024-08-15 17:20:53,373 : INFO : Average F1 score: 0.4500
2024-08-15 17:20:53,373 : INFO : Validation metric decreased (inf --> 0.788040).  Saving model ...
2024-08-15 17:20:53,477 : INFO : Starting epoch 2
2024-08-15 17:20:54,133 : INFO : Current training batch loss: 0.7480 in epoch 2
2024-08-15 17:20:54,950 : INFO : Current training batch loss: 0.7013 in epoch 2
2024-08-15 17:20:55,765 : INFO : Current training batch loss: 0.6996 in epoch 2
2024-08-15 17:20:56,580 : INFO : Current training batch loss: 0.5388 in epoch 2
2024-08-15 17:20:56,931 : INFO : Epoch finished, average loss over training batches: 0.7027
2024-08-15 17:20:56,931 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:56,931 : INFO : Training metrics:
2024-08-15 17:20:56,931 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:56,939 : INFO : Accuracy: 0.7257
2024-08-15 17:20:56,939 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:20:56,939 : INFO : Precision score for label_class 1: 0.7958
2024-08-15 17:20:56,939 : INFO : Precision score for label_class 2: 0.5543
2024-08-15 17:20:56,939 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:20:56,939 : INFO : Recall score for label_class 1: 0.9519
2024-08-15 17:20:56,939 : INFO : Recall score for label_class 2: 0.5756
2024-08-15 17:20:56,939 : INFO : Average F1 score: 0.4772
2024-08-15 17:20:57,404 : INFO : Average loss over validation batches: 0.6397
2024-08-15 17:20:57,404 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:57,404 : INFO : Validation metrics:
2024-08-15 17:20:57,404 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:20:57,408 : INFO : Accuracy: 0.7526
2024-08-15 17:20:57,408 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:20:57,408 : INFO : Precision score for label_class 1: 0.8257
2024-08-15 17:20:57,408 : INFO : Precision score for label_class 2: 0.5972
2024-08-15 17:20:57,408 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:20:57,408 : INFO : Recall score for label_class 1: 0.9244
2024-08-15 17:20:57,408 : INFO : Recall score for label_class 2: 0.6649
2024-08-15 17:20:57,408 : INFO : Average F1 score: 0.5005
2024-08-15 17:20:57,408 : INFO : Validation metric decreased (0.788040 --> 0.639748).  Saving model ...
2024-08-15 17:20:57,511 : INFO : Starting epoch 3
2024-08-15 17:20:57,964 : INFO : Current training batch loss: 0.6364 in epoch 3
2024-08-15 17:20:58,779 : INFO : Current training batch loss: 0.6081 in epoch 3
2024-08-15 17:20:59,593 : INFO : Current training batch loss: 0.5458 in epoch 3
2024-08-15 17:21:00,408 : INFO : Current training batch loss: 0.5257 in epoch 3
2024-08-15 17:21:00,961 : INFO : Epoch finished, average loss over training batches: 0.5851
2024-08-15 17:21:00,961 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:00,961 : INFO : Training metrics:
2024-08-15 17:21:00,961 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:00,969 : INFO : Accuracy: 0.8047
2024-08-15 17:21:00,969 : INFO : Precision score for label_class 0: 0.9747
2024-08-15 17:21:00,969 : INFO : Precision score for label_class 1: 0.8644
2024-08-15 17:21:00,969 : INFO : Precision score for label_class 2: 0.6643
2024-08-15 17:21:00,969 : INFO : Recall score for label_class 0: 0.2245
2024-08-15 17:21:00,969 : INFO : Recall score for label_class 1: 0.9557
2024-08-15 17:21:00,969 : INFO : Recall score for label_class 2: 0.7480
2024-08-15 17:21:00,969 : INFO : Average F1 score: 0.6588
2024-08-15 17:21:01,435 : INFO : Average loss over validation batches: 0.5794
2024-08-15 17:21:01,435 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:01,435 : INFO : Validation metrics:
2024-08-15 17:21:01,435 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:01,438 : INFO : Accuracy: 0.8296
2024-08-15 17:21:01,438 : INFO : Precision score for label_class 0: 0.8947
2024-08-15 17:21:01,438 : INFO : Precision score for label_class 1: 0.8446
2024-08-15 17:21:01,438 : INFO : Precision score for label_class 2: 0.7778
2024-08-15 17:21:01,438 : INFO : Recall score for label_class 0: 0.4789
2024-08-15 17:21:01,438 : INFO : Recall score for label_class 1: 0.9415
2024-08-15 17:21:01,438 : INFO : Recall score for label_class 2: 0.7216
2024-08-15 17:21:01,438 : INFO : Average F1 score: 0.7543
2024-08-15 17:21:01,438 : INFO : Validation metric decreased (0.639748 --> 0.579367).  Saving model ...
2024-08-15 17:21:01,540 : INFO : Split 2 is finished, the score is: 0.7543
2024-08-15 17:21:01,541 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:01,541 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:01,541 : INFO : Starting training for split 3
2024-08-15 17:21:01,555 : INFO : Starting to tokenize the sequences.
2024-08-15 17:21:01,561 : INFO : Tokenization is finished.
2024-08-15 17:21:01,578 : INFO : Starting to tokenize the sequences.
2024-08-15 17:21:01,582 : INFO : Tokenization is finished.
2024-08-15 17:21:01,591 : INFO : Counting occurences of labels...
2024-08-15 17:21:01,592 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1611,  759]))
2024-08-15 17:21:01,592 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 400, 189]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:21:01,645 : INFO : Starting epoch 1
2024-08-15 17:21:01,696 : INFO : Current training batch loss: 1.0840 in epoch 1
2024-08-15 17:21:02,511 : INFO : Current training batch loss: 1.0118 in epoch 1
2024-08-15 17:21:03,325 : INFO : Current training batch loss: 0.9010 in epoch 1
2024-08-15 17:21:04,140 : INFO : Current training batch loss: 0.8489 in epoch 1
2024-08-15 17:21:04,955 : INFO : Current training batch loss: 0.8613 in epoch 1
2024-08-15 17:21:05,106 : INFO : Epoch finished, average loss over training batches: 0.9092
2024-08-15 17:21:05,106 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:05,106 : INFO : Training metrics:
2024-08-15 17:21:05,106 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:05,113 : INFO : Accuracy: 0.6286
2024-08-15 17:21:05,113 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:21:05,113 : INFO : Precision score for label_class 1: 0.6399
2024-08-15 17:21:05,113 : INFO : Precision score for label_class 2: 0.5045
2024-08-15 17:21:05,113 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:21:05,114 : INFO : Recall score for label_class 1: 0.9826
2024-08-15 17:21:05,114 : INFO : Recall score for label_class 2: 0.1489
2024-08-15 17:21:05,114 : INFO : Average F1 score: 0.3350
2024-08-15 17:21:05,578 : INFO : Average loss over validation batches: 0.7767
2024-08-15 17:21:05,578 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:05,578 : INFO : Validation metrics:
2024-08-15 17:21:05,578 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:05,581 : INFO : Accuracy: 0.6859
2024-08-15 17:21:05,581 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:21:05,581 : INFO : Precision score for label_class 1: 0.7485
2024-08-15 17:21:05,581 : INFO : Precision score for label_class 2: 0.5057
2024-08-15 17:21:05,581 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:21:05,581 : INFO : Recall score for label_class 1: 0.9375
2024-08-15 17:21:05,581 : INFO : Recall score for label_class 2: 0.4656
2024-08-15 17:21:05,581 : INFO : Average F1 score: 0.4391
2024-08-15 17:21:05,581 : INFO : Validation metric decreased (inf --> 0.776711).  Saving model ...
2024-08-15 17:21:05,691 : INFO : Starting epoch 2
2024-08-15 17:21:06,346 : INFO : Current training batch loss: 0.7275 in epoch 2
2024-08-15 17:21:07,160 : INFO : Current training batch loss: 0.6755 in epoch 2
2024-08-15 17:21:07,974 : INFO : Current training batch loss: 0.6918 in epoch 2
2024-08-15 17:21:08,793 : INFO : Current training batch loss: 0.5366 in epoch 2
2024-08-15 17:21:09,152 : INFO : Epoch finished, average loss over training batches: 0.6761
2024-08-15 17:21:09,153 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:09,153 : INFO : Training metrics:
2024-08-15 17:21:09,153 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:09,156 : INFO : Accuracy: 0.7398
2024-08-15 17:21:09,156 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:21:09,156 : INFO : Precision score for label_class 1: 0.8076
2024-08-15 17:21:09,156 : INFO : Precision score for label_class 2: 0.5806
2024-08-15 17:21:09,156 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:21:09,156 : INFO : Recall score for label_class 1: 0.9485
2024-08-15 17:21:09,156 : INFO : Recall score for label_class 2: 0.6166
2024-08-15 17:21:09,156 : INFO : Average F1 score: 0.4902
2024-08-15 17:21:09,625 : INFO : Average loss over validation batches: 0.6226
2024-08-15 17:21:09,626 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:09,626 : INFO : Validation metrics:
2024-08-15 17:21:09,626 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:09,628 : INFO : Accuracy: 0.7378
2024-08-15 17:21:09,628 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:21:09,628 : INFO : Precision score for label_class 1: 0.8426
2024-08-15 17:21:09,628 : INFO : Precision score for label_class 2: 0.5514
2024-08-15 17:21:09,628 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:21:09,628 : INFO : Recall score for label_class 1: 0.9100
2024-08-15 17:21:09,628 : INFO : Recall score for label_class 2: 0.7090
2024-08-15 17:21:09,628 : INFO : Average F1 score: 0.4985
2024-08-15 17:21:09,628 : INFO : Validation metric decreased (0.776711 --> 0.622581).  Saving model ...
2024-08-15 17:21:09,730 : INFO : Starting epoch 3
2024-08-15 17:21:10,192 : INFO : Current training batch loss: 0.6387 in epoch 3
2024-08-15 17:21:11,008 : INFO : Current training batch loss: 0.5644 in epoch 3
2024-08-15 17:21:11,823 : INFO : Current training batch loss: 0.5561 in epoch 3
2024-08-15 17:21:12,638 : INFO : Current training batch loss: 0.4830 in epoch 3
2024-08-15 17:21:13,191 : INFO : Epoch finished, average loss over training batches: 0.5742
2024-08-15 17:21:13,191 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:13,191 : INFO : Training metrics:
2024-08-15 17:21:13,191 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:13,195 : INFO : Accuracy: 0.7847
2024-08-15 17:21:13,195 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:21:13,195 : INFO : Precision score for label_class 1: 0.8650
2024-08-15 17:21:13,195 : INFO : Precision score for label_class 2: 0.6293
2024-08-15 17:21:13,195 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:21:13,195 : INFO : Recall score for label_class 1: 0.9547
2024-08-15 17:21:13,195 : INFO : Recall score for label_class 2: 0.7628
2024-08-15 17:21:13,195 : INFO : Average F1 score: 0.5324
2024-08-15 17:21:13,662 : INFO : Average loss over validation batches: 0.5789
2024-08-15 17:21:13,662 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:13,662 : INFO : Validation metrics:
2024-08-15 17:21:13,662 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:13,664 : INFO : Accuracy: 0.7644
2024-08-15 17:21:13,664 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:21:13,664 : INFO : Precision score for label_class 1: 0.8657
2024-08-15 17:21:13,664 : INFO : Precision score for label_class 2: 0.5844
2024-08-15 17:21:13,664 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:21:13,664 : INFO : Recall score for label_class 1: 0.9350
2024-08-15 17:21:13,665 : INFO : Recall score for label_class 2: 0.7513
2024-08-15 17:21:13,665 : INFO : Average F1 score: 0.5188
2024-08-15 17:21:13,665 : INFO : Validation metric decreased (0.622581 --> 0.578875).  Saving model ...
2024-08-15 17:21:13,769 : INFO : Split 3 is finished, the score is: 0.5188
2024-08-15 17:21:13,770 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:13,770 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:13,770 : INFO : Starting training for split 4
2024-08-15 17:21:13,783 : INFO : Starting to tokenize the sequences.
2024-08-15 17:21:13,789 : INFO : Tokenization is finished.
2024-08-15 17:21:13,804 : INFO : Starting to tokenize the sequences.
2024-08-15 17:21:13,809 : INFO : Tokenization is finished.
2024-08-15 17:21:13,814 : INFO : Counting occurences of labels...
2024-08-15 17:21:13,815 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 327, 1621,  751]))
2024-08-15 17:21:13,815 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 87, 390, 197]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:21:13,863 : INFO : Starting epoch 1
2024-08-15 17:21:13,914 : INFO : Current training batch loss: 1.1059 in epoch 1
2024-08-15 17:21:14,730 : INFO : Current training batch loss: 1.0262 in epoch 1
2024-08-15 17:21:15,545 : INFO : Current training batch loss: 0.9220 in epoch 1
2024-08-15 17:21:16,359 : INFO : Current training batch loss: 0.8591 in epoch 1
2024-08-15 17:21:17,174 : INFO : Current training batch loss: 0.8126 in epoch 1
2024-08-15 17:21:17,327 : INFO : Epoch finished, average loss over training batches: 0.9238
2024-08-15 17:21:17,327 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:17,328 : INFO : Training metrics:
2024-08-15 17:21:17,328 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:17,335 : INFO : Accuracy: 0.6143
2024-08-15 17:21:17,335 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:21:17,335 : INFO : Precision score for label_class 1: 0.6480
2024-08-15 17:21:17,335 : INFO : Precision score for label_class 2: 0.4177
2024-08-15 17:21:17,335 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:21:17,335 : INFO : Recall score for label_class 1: 0.9210
2024-08-15 17:21:17,335 : INFO : Recall score for label_class 2: 0.2197
2024-08-15 17:21:17,335 : INFO : Average F1 score: 0.3496
2024-08-15 17:21:17,803 : INFO : Average loss over validation batches: 0.7886
2024-08-15 17:21:17,804 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:17,804 : INFO : Validation metrics:
2024-08-15 17:21:17,804 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:17,807 : INFO : Accuracy: 0.7270
2024-08-15 17:21:17,807 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:21:17,807 : INFO : Precision score for label_class 1: 0.7845
2024-08-15 17:21:17,807 : INFO : Precision score for label_class 2: 0.5867
2024-08-15 17:21:17,807 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:21:17,807 : INFO : Recall score for label_class 1: 0.9615
2024-08-15 17:21:17,807 : INFO : Recall score for label_class 2: 0.5838
2024-08-15 17:21:17,807 : INFO : Average F1 score: 0.4831
2024-08-15 17:21:17,807 : INFO : Validation metric decreased (inf --> 0.788569).  Saving model ...
2024-08-15 17:21:17,909 : INFO : Starting epoch 2
2024-08-15 17:21:18,563 : INFO : Current training batch loss: 0.7474 in epoch 2
2024-08-15 17:21:19,387 : INFO : Current training batch loss: 0.6737 in epoch 2
2024-08-15 17:21:20,250 : INFO : Current training batch loss: 0.6170 in epoch 2
2024-08-15 17:21:21,070 : INFO : Current training batch loss: 0.5980 in epoch 2
2024-08-15 17:21:21,425 : INFO : Epoch finished, average loss over training batches: 0.6845
2024-08-15 17:21:21,425 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:21,425 : INFO : Training metrics:
2024-08-15 17:21:21,425 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:21,429 : INFO : Accuracy: 0.7573
2024-08-15 17:21:21,429 : INFO : Precision score for label_class 0: 0.8421
2024-08-15 17:21:21,429 : INFO : Precision score for label_class 1: 0.8195
2024-08-15 17:21:21,429 : INFO : Precision score for label_class 2: 0.6053
2024-08-15 17:21:21,429 : INFO : Recall score for label_class 0: 0.0979
2024-08-15 17:21:21,429 : INFO : Recall score for label_class 1: 0.9469
2024-08-15 17:21:21,429 : INFO : Recall score for label_class 2: 0.6352
2024-08-15 17:21:21,429 : INFO : Average F1 score: 0.5580
2024-08-15 17:21:21,900 : INFO : Average loss over validation batches: 0.6265
2024-08-15 17:21:21,900 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:21,900 : INFO : Validation metrics:
2024-08-15 17:21:21,900 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:21,903 : INFO : Accuracy: 0.7997
2024-08-15 17:21:21,903 : INFO : Precision score for label_class 0: 0.9167
2024-08-15 17:21:21,903 : INFO : Precision score for label_class 1: 0.8519
2024-08-15 17:21:21,904 : INFO : Precision score for label_class 2: 0.6835
2024-08-15 17:21:21,904 : INFO : Recall score for label_class 0: 0.2529
2024-08-15 17:21:21,904 : INFO : Recall score for label_class 1: 0.9436
2024-08-15 17:21:21,904 : INFO : Recall score for label_class 2: 0.7563
2024-08-15 17:21:21,904 : INFO : Average F1 score: 0.6699
2024-08-15 17:21:21,904 : INFO : Validation metric decreased (0.788569 --> 0.626480).  Saving model ...
2024-08-15 17:21:22,006 : INFO : Starting epoch 3
2024-08-15 17:21:22,465 : INFO : Current training batch loss: 0.6267 in epoch 3
2024-08-15 17:21:23,298 : INFO : Current training batch loss: 0.5487 in epoch 3
2024-08-15 17:21:24,141 : INFO : Current training batch loss: 0.6452 in epoch 3
2024-08-15 17:21:24,986 : INFO : Current training batch loss: 0.4787 in epoch 3
2024-08-15 17:21:25,539 : INFO : Epoch finished, average loss over training batches: 0.5638
2024-08-15 17:21:25,540 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:25,540 : INFO : Training metrics:
2024-08-15 17:21:25,540 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:25,547 : INFO : Accuracy: 0.8448
2024-08-15 17:21:25,547 : INFO : Precision score for label_class 0: 0.8629
2024-08-15 17:21:25,547 : INFO : Precision score for label_class 1: 0.8683
2024-08-15 17:21:25,547 : INFO : Precision score for label_class 2: 0.7813
2024-08-15 17:21:25,547 : INFO : Recall score for label_class 0: 0.5199
2024-08-15 17:21:25,547 : INFO : Recall score for label_class 1: 0.9556
2024-08-15 17:21:25,547 : INFO : Recall score for label_class 2: 0.7470
2024-08-15 17:21:25,547 : INFO : Average F1 score: 0.7742
2024-08-15 17:21:26,014 : INFO : Average loss over validation batches: 0.5733
2024-08-15 17:21:26,015 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:26,015 : INFO : Validation metrics:
2024-08-15 17:21:26,015 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:26,018 : INFO : Accuracy: 0.8368
2024-08-15 17:21:26,018 : INFO : Precision score for label_class 0: 0.7714
2024-08-15 17:21:26,018 : INFO : Precision score for label_class 1: 0.8670
2024-08-15 17:21:26,018 : INFO : Precision score for label_class 2: 0.7923
2024-08-15 17:21:26,018 : INFO : Recall score for label_class 0: 0.6207
2024-08-15 17:21:26,018 : INFO : Recall score for label_class 1: 0.9359
2024-08-15 17:21:26,018 : INFO : Recall score for label_class 2: 0.7360
2024-08-15 17:21:26,018 : INFO : Average F1 score: 0.7837
2024-08-15 17:21:26,018 : INFO : Validation metric decreased (0.626480 --> 0.573284).  Saving model ...
2024-08-15 17:21:26,124 : INFO : Split 4 is finished, the score is: 0.7837
2024-08-15 17:21:26,124 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:26,124 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:26,124 : INFO : Starting training for split 5
2024-08-15 17:21:26,137 : INFO : Starting to tokenize the sequences.
2024-08-15 17:21:26,142 : INFO : Tokenization is finished.
2024-08-15 17:21:26,162 : INFO : Starting to tokenize the sequences.
2024-08-15 17:21:26,167 : INFO : Tokenization is finished.
2024-08-15 17:21:26,173 : INFO : Counting occurences of labels...
2024-08-15 17:21:26,174 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 330, 1615,  754]))
2024-08-15 17:21:26,174 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 84, 396, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:21:26,221 : INFO : Starting epoch 1
2024-08-15 17:21:26,272 : INFO : Current training batch loss: 1.0997 in epoch 1
2024-08-15 17:21:27,178 : INFO : Current training batch loss: 1.0262 in epoch 1
2024-08-15 17:21:27,994 : INFO : Current training batch loss: 0.9211 in epoch 1
2024-08-15 17:21:28,814 : INFO : Current training batch loss: 0.8571 in epoch 1
2024-08-15 17:21:29,630 : INFO : Current training batch loss: 0.8254 in epoch 1
2024-08-15 17:21:29,783 : INFO : Epoch finished, average loss over training batches: 0.9163
2024-08-15 17:21:29,783 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:29,783 : INFO : Training metrics:
2024-08-15 17:21:29,783 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:29,794 : INFO : Accuracy: 0.6284
2024-08-15 17:21:29,794 : INFO : Precision score for label_class 0: 0.1053
2024-08-15 17:21:29,794 : INFO : Precision score for label_class 1: 0.6496
2024-08-15 17:21:29,794 : INFO : Precision score for label_class 2: 0.5823
2024-08-15 17:21:29,794 : INFO : Recall score for label_class 0: 0.0242
2024-08-15 17:21:29,794 : INFO : Recall score for label_class 1: 0.9598
2024-08-15 17:21:29,794 : INFO : Recall score for label_class 2: 0.1830
2024-08-15 17:21:29,794 : INFO : Average F1 score: 0.3642
2024-08-15 17:21:30,266 : INFO : Average loss over validation batches: 0.7162
2024-08-15 17:21:30,266 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:30,266 : INFO : Validation metrics:
2024-08-15 17:21:30,266 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:30,269 : INFO : Accuracy: 0.7344
2024-08-15 17:21:30,269 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:21:30,269 : INFO : Precision score for label_class 1: 0.7954
2024-08-15 17:21:30,269 : INFO : Precision score for label_class 2: 0.5846
2024-08-15 17:21:30,269 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:21:30,269 : INFO : Recall score for label_class 1: 0.9621
2024-08-15 17:21:30,269 : INFO : Recall score for label_class 2: 0.5876
2024-08-15 17:21:30,269 : INFO : Average F1 score: 0.4857
2024-08-15 17:21:30,269 : INFO : Validation metric decreased (inf --> 0.716178).  Saving model ...
2024-08-15 17:21:30,373 : INFO : Starting epoch 2
2024-08-15 17:21:31,038 : INFO : Current training batch loss: 0.6877 in epoch 2
2024-08-15 17:21:31,865 : INFO : Current training batch loss: 0.6303 in epoch 2
2024-08-15 17:21:32,707 : INFO : Current training batch loss: 0.5495 in epoch 2
2024-08-15 17:21:33,550 : INFO : Current training batch loss: 0.6087 in epoch 2
2024-08-15 17:21:33,917 : INFO : Epoch finished, average loss over training batches: 0.6258
2024-08-15 17:21:33,917 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:33,917 : INFO : Training metrics:
2024-08-15 17:21:33,917 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:33,928 : INFO : Accuracy: 0.7766
2024-08-15 17:21:33,928 : INFO : Precision score for label_class 0: 0.9375
2024-08-15 17:21:33,928 : INFO : Precision score for label_class 1: 0.8494
2024-08-15 17:21:33,928 : INFO : Precision score for label_class 2: 0.6251
2024-08-15 17:21:33,928 : INFO : Recall score for label_class 0: 0.0455
2024-08-15 17:21:33,928 : INFO : Recall score for label_class 1: 0.9467
2024-08-15 17:21:33,928 : INFO : Recall score for label_class 2: 0.7321
2024-08-15 17:21:33,928 : INFO : Average F1 score: 0.5522
2024-08-15 17:21:34,402 : INFO : Average loss over validation batches: 0.5649
2024-08-15 17:21:34,402 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:34,402 : INFO : Validation metrics:
2024-08-15 17:21:34,402 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:34,406 : INFO : Accuracy: 0.8086
2024-08-15 17:21:34,406 : INFO : Precision score for label_class 0: 0.8966
2024-08-15 17:21:34,406 : INFO : Precision score for label_class 1: 0.8348
2024-08-15 17:21:34,406 : INFO : Precision score for label_class 2: 0.7330
2024-08-15 17:21:34,406 : INFO : Recall score for label_class 0: 0.3095
2024-08-15 17:21:34,406 : INFO : Recall score for label_class 1: 0.9571
2024-08-15 17:21:34,406 : INFO : Recall score for label_class 2: 0.7216
2024-08-15 17:21:34,406 : INFO : Average F1 score: 0.6931
2024-08-15 17:21:34,406 : INFO : Validation metric decreased (0.716178 --> 0.564921).  Saving model ...
2024-08-15 17:21:34,509 : INFO : Starting epoch 3
2024-08-15 17:21:34,977 : INFO : Current training batch loss: 0.4757 in epoch 3
2024-08-15 17:21:35,820 : INFO : Current training batch loss: 0.4740 in epoch 3
2024-08-15 17:21:36,663 : INFO : Current training batch loss: 0.5439 in epoch 3
2024-08-15 17:21:37,506 : INFO : Current training batch loss: 0.4279 in epoch 3
2024-08-15 17:21:38,080 : INFO : Epoch finished, average loss over training batches: 0.4964
2024-08-15 17:21:38,080 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:38,080 : INFO : Training metrics:
2024-08-15 17:21:38,080 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:38,087 : INFO : Accuracy: 0.8729
2024-08-15 17:21:38,087 : INFO : Precision score for label_class 0: 0.8728
2024-08-15 17:21:38,087 : INFO : Precision score for label_class 1: 0.8948
2024-08-15 17:21:38,087 : INFO : Precision score for label_class 2: 0.8219
2024-08-15 17:21:38,087 : INFO : Recall score for label_class 0: 0.6030
2024-08-15 17:21:38,087 : INFO : Recall score for label_class 1: 0.9585
2024-08-15 17:21:38,087 : INFO : Recall score for label_class 2: 0.8077
2024-08-15 17:21:38,087 : INFO : Average F1 score: 0.8178
2024-08-15 17:21:38,555 : INFO : Average loss over validation batches: 0.5151
2024-08-15 17:21:38,555 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:38,555 : INFO : Validation metrics:
2024-08-15 17:21:38,555 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:38,559 : INFO : Accuracy: 0.8442
2024-08-15 17:21:38,559 : INFO : Precision score for label_class 0: 0.8033
2024-08-15 17:21:38,559 : INFO : Precision score for label_class 1: 0.8819
2024-08-15 17:21:38,559 : INFO : Precision score for label_class 2: 0.7778
2024-08-15 17:21:38,559 : INFO : Recall score for label_class 0: 0.5833
2024-08-15 17:21:38,559 : INFO : Recall score for label_class 1: 0.9242
2024-08-15 17:21:38,559 : INFO : Recall score for label_class 2: 0.7938
2024-08-15 17:21:38,559 : INFO : Average F1 score: 0.7881
2024-08-15 17:21:38,559 : INFO : Validation metric decreased (0.564921 --> 0.515110).  Saving model ...
2024-08-15 17:21:38,664 : INFO : Split 5 is finished, the score is: 0.7881
2024-08-15 17:21:38,664 : INFO : ----------------------------------------------------------------------------------------------------
[I 2024-08-15 17:21:38,674] Trial 8 finished with value: 0.7253447140303956 and parameters: {'n_epochs': 3, 'learning_rate': 2.1014546922294656e-05, 'classifier_dropout': 0.6530709129556753, 'warmup_step_fraction': 0.012841696827828137, 'use_gradient_clipping': False}. Best is trial 1 with value: 0.8513001269595835.
2024-08-15 17:21:38,675 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:38,675 : INFO : Starting training for split 1
2024-08-15 17:21:38,692 : INFO : Starting to tokenize the sequences.
2024-08-15 17:21:38,698 : INFO : Tokenization is finished.
2024-08-15 17:21:38,709 : INFO : Starting to tokenize the sequences.
2024-08-15 17:21:38,714 : INFO : Tokenization is finished.
2024-08-15 17:21:38,714 : INFO : Counting occurences of labels...
2024-08-15 17:21:38,715 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1596,  774]))
2024-08-15 17:21:38,715 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 415, 174]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:21:38,770 : INFO : Starting epoch 1
2024-08-15 17:21:38,822 : INFO : Current training batch loss: 1.0879 in epoch 1
2024-08-15 17:21:39,637 : INFO : Current training batch loss: 0.9695 in epoch 1
2024-08-15 17:21:40,476 : INFO : Current training batch loss: 0.9987 in epoch 1
2024-08-15 17:21:41,314 : INFO : Current training batch loss: 0.7437 in epoch 1
2024-08-15 17:21:42,144 : INFO : Current training batch loss: 0.7034 in epoch 1
2024-08-15 17:21:42,299 : INFO : Epoch finished, average loss over training batches: 0.8820
2024-08-15 17:21:42,300 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:42,300 : INFO : Training metrics:
2024-08-15 17:21:42,300 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:42,308 : INFO : Accuracy: 0.6431
2024-08-15 17:21:42,308 : INFO : Precision score for label_class 0: 0.4194
2024-08-15 17:21:42,308 : INFO : Precision score for label_class 1: 0.6597
2024-08-15 17:21:42,308 : INFO : Precision score for label_class 2: 0.5457
2024-08-15 17:21:42,308 : INFO : Recall score for label_class 0: 0.0396
2024-08-15 17:21:42,308 : INFO : Recall score for label_class 1: 0.9668
2024-08-15 17:21:42,308 : INFO : Recall score for label_class 2: 0.2313
2024-08-15 17:21:42,308 : INFO : Average F1 score: 0.3938
2024-08-15 17:21:42,773 : INFO : Average loss over validation batches: 0.6463
2024-08-15 17:21:42,773 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:42,773 : INFO : Validation metrics:
2024-08-15 17:21:42,773 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:42,776 : INFO : Accuracy: 0.7333
2024-08-15 17:21:42,776 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:21:42,776 : INFO : Precision score for label_class 1: 0.8500
2024-08-15 17:21:42,776 : INFO : Precision score for label_class 2: 0.5149
2024-08-15 17:21:42,776 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:21:42,776 : INFO : Recall score for label_class 1: 0.9012
2024-08-15 17:21:42,776 : INFO : Recall score for label_class 2: 0.6954
2024-08-15 17:21:42,776 : INFO : Average F1 score: 0.4888
2024-08-15 17:21:42,776 : INFO : Validation metric decreased (inf --> 0.646277).  Saving model ...
2024-08-15 17:21:42,887 : INFO : Starting epoch 2
2024-08-15 17:21:43,558 : INFO : Current training batch loss: 0.3507 in epoch 2
2024-08-15 17:21:44,396 : INFO : Current training batch loss: 0.5613 in epoch 2
2024-08-15 17:21:45,233 : INFO : Current training batch loss: 0.3442 in epoch 2
2024-08-15 17:21:46,071 : INFO : Current training batch loss: 0.2810 in epoch 2
2024-08-15 17:21:46,435 : INFO : Epoch finished, average loss over training batches: 0.4747
2024-08-15 17:21:46,436 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:46,436 : INFO : Training metrics:
2024-08-15 17:21:46,436 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:46,440 : INFO : Accuracy: 0.8380
2024-08-15 17:21:46,440 : INFO : Precision score for label_class 0: 0.8028
2024-08-15 17:21:46,440 : INFO : Precision score for label_class 1: 0.8748
2024-08-15 17:21:46,440 : INFO : Precision score for label_class 2: 0.7654
2024-08-15 17:21:46,440 : INFO : Recall score for label_class 0: 0.5335
2024-08-15 17:21:46,440 : INFO : Recall score for label_class 1: 0.9411
2024-08-15 17:21:46,440 : INFO : Recall score for label_class 2: 0.7545
2024-08-15 17:21:46,440 : INFO : Average F1 score: 0.7692
2024-08-15 17:21:46,906 : INFO : Average loss over validation batches: 0.3893
2024-08-15 17:21:46,906 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:46,906 : INFO : Validation metrics:
2024-08-15 17:21:46,906 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:46,908 : INFO : Accuracy: 0.8607
2024-08-15 17:21:46,908 : INFO : Precision score for label_class 0: 0.7959
2024-08-15 17:21:46,908 : INFO : Precision score for label_class 1: 0.9415
2024-08-15 17:21:46,908 : INFO : Precision score for label_class 2: 0.7413
2024-08-15 17:21:46,908 : INFO : Recall score for label_class 0: 0.9070
2024-08-15 17:21:46,908 : INFO : Recall score for label_class 1: 0.8530
2024-08-15 17:21:46,908 : INFO : Recall score for label_class 2: 0.8563
2024-08-15 17:21:46,908 : INFO : Average F1 score: 0.8459
2024-08-15 17:21:46,908 : INFO : Validation metric decreased (0.646277 --> 0.389258).  Saving model ...
2024-08-15 17:21:47,010 : INFO : Starting epoch 3
2024-08-15 17:21:47,472 : INFO : Current training batch loss: 0.3249 in epoch 3
2024-08-15 17:21:48,311 : INFO : Current training batch loss: 0.3505 in epoch 3
2024-08-15 17:21:49,148 : INFO : Current training batch loss: 0.2389 in epoch 3
2024-08-15 17:21:49,974 : INFO : Current training batch loss: 0.1256 in epoch 3
2024-08-15 17:21:50,545 : INFO : Epoch finished, average loss over training batches: 0.2755
2024-08-15 17:21:50,545 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:50,545 : INFO : Training metrics:
2024-08-15 17:21:50,545 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:50,550 : INFO : Accuracy: 0.9133
2024-08-15 17:21:50,550 : INFO : Precision score for label_class 0: 0.8343
2024-08-15 17:21:50,550 : INFO : Precision score for label_class 1: 0.9376
2024-08-15 17:21:50,550 : INFO : Precision score for label_class 2: 0.8966
2024-08-15 17:21:50,550 : INFO : Recall score for label_class 0: 0.8750
2024-08-15 17:21:50,550 : INFO : Recall score for label_class 1: 0.9511
2024-08-15 17:21:50,550 : INFO : Recall score for label_class 2: 0.8514
2024-08-15 17:21:50,550 : INFO : Average F1 score: 0.8906
2024-08-15 17:21:51,016 : INFO : Average loss over validation batches: 0.3079
2024-08-15 17:21:51,017 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:51,017 : INFO : Validation metrics:
2024-08-15 17:21:51,017 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:51,019 : INFO : Accuracy: 0.8948
2024-08-15 17:21:51,019 : INFO : Precision score for label_class 0: 0.8191
2024-08-15 17:21:51,019 : INFO : Precision score for label_class 1: 0.9274
2024-08-15 17:21:51,019 : INFO : Precision score for label_class 2: 0.8571
2024-08-15 17:21:51,019 : INFO : Recall score for label_class 0: 0.8953
2024-08-15 17:21:51,019 : INFO : Recall score for label_class 1: 0.9229
2024-08-15 17:21:51,019 : INFO : Recall score for label_class 2: 0.8276
2024-08-15 17:21:51,019 : INFO : Average F1 score: 0.8743
2024-08-15 17:21:51,019 : INFO : Validation metric decreased (0.389258 --> 0.307946).  Saving model ...
2024-08-15 17:21:51,120 : INFO : Starting epoch 4
2024-08-15 17:21:51,379 : INFO : Current training batch loss: 0.3598 in epoch 4
2024-08-15 17:21:52,211 : INFO : Current training batch loss: 0.1208 in epoch 4
2024-08-15 17:21:53,049 : INFO : Current training batch loss: 0.3514 in epoch 4
2024-08-15 17:21:53,888 : INFO : Current training batch loss: 0.2228 in epoch 4
2024-08-15 17:21:54,667 : INFO : Epoch finished, average loss over training batches: 0.1745
2024-08-15 17:21:54,667 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:54,667 : INFO : Training metrics:
2024-08-15 17:21:54,667 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:54,672 : INFO : Accuracy: 0.9518
2024-08-15 17:21:54,672 : INFO : Precision score for label_class 0: 0.8825
2024-08-15 17:21:54,672 : INFO : Precision score for label_class 1: 0.9682
2024-08-15 17:21:54,672 : INFO : Precision score for label_class 2: 0.9489
2024-08-15 17:21:54,672 : INFO : Recall score for label_class 0: 0.9390
2024-08-15 17:21:54,672 : INFO : Recall score for label_class 1: 0.9737
2024-08-15 17:21:54,672 : INFO : Recall score for label_class 2: 0.9121
2024-08-15 17:21:54,672 : INFO : Average F1 score: 0.9370
2024-08-15 17:21:55,138 : INFO : Average loss over validation batches: 0.3559
2024-08-15 17:21:55,138 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:55,138 : INFO : Validation metrics:
2024-08-15 17:21:55,138 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:55,140 : INFO : Accuracy: 0.8785
2024-08-15 17:21:55,140 : INFO : Precision score for label_class 0: 0.7778
2024-08-15 17:21:55,140 : INFO : Precision score for label_class 1: 0.9600
2024-08-15 17:21:55,141 : INFO : Precision score for label_class 2: 0.7761
2024-08-15 17:21:55,141 : INFO : Recall score for label_class 0: 0.8953
2024-08-15 17:21:55,141 : INFO : Recall score for label_class 1: 0.8675
2024-08-15 17:21:55,141 : INFO : Recall score for label_class 2: 0.8966
2024-08-15 17:21:55,141 : INFO : Average F1 score: 0.8586
2024-08-15 17:21:55,141 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:21:55,141 : INFO : Starting epoch 5
2024-08-15 17:21:55,191 : INFO : Current training batch loss: 0.0502 in epoch 5
2024-08-15 17:21:56,031 : INFO : Current training batch loss: 0.2946 in epoch 5
2024-08-15 17:21:56,872 : INFO : Current training batch loss: 0.0754 in epoch 5
2024-08-15 17:21:57,708 : INFO : Current training batch loss: 0.0560 in epoch 5
2024-08-15 17:21:58,545 : INFO : Current training batch loss: 0.0468 in epoch 5
2024-08-15 17:21:58,702 : INFO : Epoch finished, average loss over training batches: 0.1206
2024-08-15 17:21:58,702 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:58,702 : INFO : Training metrics:
2024-08-15 17:21:58,702 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:58,710 : INFO : Accuracy: 0.9666
2024-08-15 17:21:58,710 : INFO : Precision score for label_class 0: 0.9072
2024-08-15 17:21:58,710 : INFO : Precision score for label_class 1: 0.9800
2024-08-15 17:21:58,710 : INFO : Precision score for label_class 2: 0.9656
2024-08-15 17:21:58,710 : INFO : Recall score for label_class 0: 0.9543
2024-08-15 17:21:58,710 : INFO : Recall score for label_class 1: 0.9806
2024-08-15 17:21:58,710 : INFO : Recall score for label_class 2: 0.9432
2024-08-15 17:21:58,710 : INFO : Average F1 score: 0.9549
2024-08-15 17:21:59,176 : INFO : Average loss over validation batches: 0.4009
2024-08-15 17:21:59,176 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:59,176 : INFO : Validation metrics:
2024-08-15 17:21:59,176 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:21:59,179 : INFO : Accuracy: 0.8667
2024-08-15 17:21:59,179 : INFO : Precision score for label_class 0: 0.7094
2024-08-15 17:21:59,179 : INFO : Precision score for label_class 1: 0.9569
2024-08-15 17:21:59,179 : INFO : Precision score for label_class 2: 0.7861
2024-08-15 17:21:59,179 : INFO : Recall score for label_class 0: 0.9651
2024-08-15 17:21:59,179 : INFO : Recall score for label_class 1: 0.8554
2024-08-15 17:21:59,179 : INFO : Recall score for label_class 2: 0.8448
2024-08-15 17:21:59,179 : INFO : Average F1 score: 0.8451
2024-08-15 17:21:59,179 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:21:59,179 : INFO : Starting epoch 6
2024-08-15 17:21:59,847 : INFO : Current training batch loss: 0.0135 in epoch 6
2024-08-15 17:22:00,678 : INFO : Current training batch loss: 0.0382 in epoch 6
2024-08-15 17:22:01,517 : INFO : Current training batch loss: 0.0821 in epoch 6
2024-08-15 17:22:02,356 : INFO : Current training batch loss: 0.0181 in epoch 6
2024-08-15 17:22:02,720 : INFO : Epoch finished, average loss over training batches: 0.0709
2024-08-15 17:22:02,720 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:02,720 : INFO : Training metrics:
2024-08-15 17:22:02,720 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:02,728 : INFO : Accuracy: 0.9833
2024-08-15 17:22:02,728 : INFO : Precision score for label_class 0: 0.9357
2024-08-15 17:22:02,728 : INFO : Precision score for label_class 1: 0.9894
2024-08-15 17:22:02,728 : INFO : Precision score for label_class 2: 0.9921
2024-08-15 17:22:02,728 : INFO : Recall score for label_class 0: 0.9756
2024-08-15 17:22:02,728 : INFO : Recall score for label_class 1: 0.9919
2024-08-15 17:22:02,728 : INFO : Recall score for label_class 2: 0.9690
2024-08-15 17:22:02,728 : INFO : Average F1 score: 0.9754
2024-08-15 17:22:03,194 : INFO : Average loss over validation batches: 0.3582
2024-08-15 17:22:03,194 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:03,194 : INFO : Validation metrics:
2024-08-15 17:22:03,194 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:03,197 : INFO : Accuracy: 0.8859
2024-08-15 17:22:03,197 : INFO : Precision score for label_class 0: 0.7570
2024-08-15 17:22:03,197 : INFO : Precision score for label_class 1: 0.9268
2024-08-15 17:22:03,197 : INFO : Precision score for label_class 2: 0.8671
2024-08-15 17:22:03,197 : INFO : Recall score for label_class 0: 0.9419
2024-08-15 17:22:03,197 : INFO : Recall score for label_class 1: 0.9157
2024-08-15 17:22:03,197 : INFO : Recall score for label_class 2: 0.7874
2024-08-15 17:22:03,197 : INFO : Average F1 score: 0.8620
2024-08-15 17:22:03,197 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:22:03,197 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:22:03,235 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:22:03,734 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:03,734 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:22:03,734 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:03,736 : INFO : Accuracy: 0.8948
2024-08-15 17:22:03,736 : INFO : Precision score for label_class 0: 0.8191
2024-08-15 17:22:03,737 : INFO : Precision score for label_class 1: 0.9274
2024-08-15 17:22:03,737 : INFO : Precision score for label_class 2: 0.8571
2024-08-15 17:22:03,737 : INFO : Recall score for label_class 0: 0.8953
2024-08-15 17:22:03,737 : INFO : Recall score for label_class 1: 0.9229
2024-08-15 17:22:03,737 : INFO : Recall score for label_class 2: 0.8276
2024-08-15 17:22:03,737 : INFO : Average F1 score: 0.8743
2024-08-15 17:22:03,737 : INFO : Determined score from best model, ending training.
2024-08-15 17:22:03,743 : INFO : Split 1 is finished, the score is: 0.8743
2024-08-15 17:22:03,743 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:03,743 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:03,743 : INFO : Starting training for split 2
2024-08-15 17:22:03,757 : INFO : Starting to tokenize the sequences.
2024-08-15 17:22:03,763 : INFO : Tokenization is finished.
2024-08-15 17:22:03,780 : INFO : Starting to tokenize the sequences.
2024-08-15 17:22:03,785 : INFO : Tokenization is finished.
2024-08-15 17:22:03,789 : INFO : Counting occurences of labels...
2024-08-15 17:22:03,790 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 343, 1601,  754]))
2024-08-15 17:22:03,791 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 71, 410, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:22:03,837 : INFO : Starting epoch 1
2024-08-15 17:22:03,889 : INFO : Current training batch loss: 1.0994 in epoch 1
2024-08-15 17:22:04,728 : INFO : Current training batch loss: 1.0557 in epoch 1
2024-08-15 17:22:05,567 : INFO : Current training batch loss: 1.0174 in epoch 1
2024-08-15 17:22:06,406 : INFO : Current training batch loss: 0.7921 in epoch 1
2024-08-15 17:22:07,243 : INFO : Current training batch loss: 0.8387 in epoch 1
2024-08-15 17:22:07,399 : INFO : Epoch finished, average loss over training batches: 0.9146
2024-08-15 17:22:07,400 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:07,400 : INFO : Training metrics:
2024-08-15 17:22:07,400 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:07,410 : INFO : Accuracy: 0.6038
2024-08-15 17:22:07,410 : INFO : Precision score for label_class 0: 0.1414
2024-08-15 17:22:07,410 : INFO : Precision score for label_class 1: 0.6524
2024-08-15 17:22:07,410 : INFO : Precision score for label_class 2: 0.4514
2024-08-15 17:22:07,410 : INFO : Recall score for label_class 0: 0.0408
2024-08-15 17:22:07,410 : INFO : Recall score for label_class 1: 0.8957
2024-08-15 17:22:07,410 : INFO : Recall score for label_class 2: 0.2401
2024-08-15 17:22:07,410 : INFO : Average F1 score: 0.3772
2024-08-15 17:22:07,877 : INFO : Average loss over validation batches: 0.6594
2024-08-15 17:22:07,877 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:07,877 : INFO : Validation metrics:
2024-08-15 17:22:07,877 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:07,881 : INFO : Accuracy: 0.7437
2024-08-15 17:22:07,881 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:22:07,881 : INFO : Precision score for label_class 1: 0.7907
2024-08-15 17:22:07,881 : INFO : Precision score for label_class 2: 0.6175
2024-08-15 17:22:07,881 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:22:07,881 : INFO : Recall score for label_class 1: 0.9488
2024-08-15 17:22:07,881 : INFO : Recall score for label_class 2: 0.5825
2024-08-15 17:22:07,881 : INFO : Average F1 score: 0.4873
2024-08-15 17:22:07,881 : INFO : Validation metric decreased (inf --> 0.659405).  Saving model ...
2024-08-15 17:22:07,981 : INFO : Starting epoch 2
2024-08-15 17:22:08,653 : INFO : Current training batch loss: 0.6429 in epoch 2
2024-08-15 17:22:09,489 : INFO : Current training batch loss: 0.5656 in epoch 2
2024-08-15 17:22:10,323 : INFO : Current training batch loss: 0.3216 in epoch 2
2024-08-15 17:22:11,160 : INFO : Current training batch loss: 0.3419 in epoch 2
2024-08-15 17:22:11,523 : INFO : Epoch finished, average loss over training batches: 0.5152
2024-08-15 17:22:11,523 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:11,524 : INFO : Training metrics:
2024-08-15 17:22:11,524 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:11,534 : INFO : Accuracy: 0.8173
2024-08-15 17:22:11,534 : INFO : Precision score for label_class 0: 0.7489
2024-08-15 17:22:11,534 : INFO : Precision score for label_class 1: 0.8674
2024-08-15 17:22:11,534 : INFO : Precision score for label_class 2: 0.7232
2024-08-15 17:22:11,534 : INFO : Recall score for label_class 0: 0.4869
2024-08-15 17:22:11,534 : INFO : Recall score for label_class 1: 0.9319
2024-08-15 17:22:11,534 : INFO : Recall score for label_class 2: 0.7241
2024-08-15 17:22:11,534 : INFO : Average F1 score: 0.7374
2024-08-15 17:22:11,999 : INFO : Average loss over validation batches: 0.4287
2024-08-15 17:22:12,000 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:12,000 : INFO : Validation metrics:
2024-08-15 17:22:12,000 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:12,003 : INFO : Accuracy: 0.8444
2024-08-15 17:22:12,003 : INFO : Precision score for label_class 0: 0.7089
2024-08-15 17:22:12,003 : INFO : Precision score for label_class 1: 0.8936
2024-08-15 17:22:12,003 : INFO : Precision score for label_class 2: 0.7969
2024-08-15 17:22:12,003 : INFO : Recall score for label_class 0: 0.7887
2024-08-15 17:22:12,003 : INFO : Recall score for label_class 1: 0.8805
2024-08-15 17:22:12,003 : INFO : Recall score for label_class 2: 0.7887
2024-08-15 17:22:12,003 : INFO : Average F1 score: 0.8088
2024-08-15 17:22:12,003 : INFO : Validation metric decreased (0.659405 --> 0.428750).  Saving model ...
2024-08-15 17:22:12,103 : INFO : Starting epoch 3
2024-08-15 17:22:12,558 : INFO : Current training batch loss: 0.3047 in epoch 3
2024-08-15 17:22:13,388 : INFO : Current training batch loss: 0.2849 in epoch 3
2024-08-15 17:22:14,224 : INFO : Current training batch loss: 0.3609 in epoch 3
2024-08-15 17:22:15,063 : INFO : Current training batch loss: 0.1766 in epoch 3
2024-08-15 17:22:15,634 : INFO : Epoch finished, average loss over training batches: 0.2849
2024-08-15 17:22:15,634 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:15,635 : INFO : Training metrics:
2024-08-15 17:22:15,635 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:15,642 : INFO : Accuracy: 0.9096
2024-08-15 17:22:15,642 : INFO : Precision score for label_class 0: 0.8230
2024-08-15 17:22:15,642 : INFO : Precision score for label_class 1: 0.9433
2024-08-15 17:22:15,642 : INFO : Precision score for label_class 2: 0.8780
2024-08-15 17:22:15,642 : INFO : Recall score for label_class 0: 0.8542
2024-08-15 17:22:15,642 : INFO : Recall score for label_class 1: 0.9450
2024-08-15 17:22:15,642 : INFO : Recall score for label_class 2: 0.8594
2024-08-15 17:22:15,642 : INFO : Average F1 score: 0.8837
2024-08-15 17:22:16,107 : INFO : Average loss over validation batches: 0.3446
2024-08-15 17:22:16,107 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:16,107 : INFO : Validation metrics:
2024-08-15 17:22:16,107 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:16,111 : INFO : Accuracy: 0.8726
2024-08-15 17:22:16,111 : INFO : Precision score for label_class 0: 0.7763
2024-08-15 17:22:16,111 : INFO : Precision score for label_class 1: 0.8918
2024-08-15 17:22:16,111 : INFO : Precision score for label_class 2: 0.8678
2024-08-15 17:22:16,111 : INFO : Recall score for label_class 0: 0.8310
2024-08-15 17:22:16,111 : INFO : Recall score for label_class 1: 0.9244
2024-08-15 17:22:16,111 : INFO : Recall score for label_class 2: 0.7784
2024-08-15 17:22:16,111 : INFO : Average F1 score: 0.8437
2024-08-15 17:22:16,111 : INFO : Validation metric decreased (0.428750 --> 0.344605).  Saving model ...
2024-08-15 17:22:16,215 : INFO : Starting epoch 4
2024-08-15 17:22:16,473 : INFO : Current training batch loss: 0.2933 in epoch 4
2024-08-15 17:22:17,311 : INFO : Current training batch loss: 0.1501 in epoch 4
2024-08-15 17:22:18,143 : INFO : Current training batch loss: 0.2725 in epoch 4
2024-08-15 17:22:18,969 : INFO : Current training batch loss: 0.1479 in epoch 4
2024-08-15 17:22:19,749 : INFO : Epoch finished, average loss over training batches: 0.1734
2024-08-15 17:22:19,749 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:19,749 : INFO : Training metrics:
2024-08-15 17:22:19,749 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:19,759 : INFO : Accuracy: 0.9518
2024-08-15 17:22:19,760 : INFO : Precision score for label_class 0: 0.8914
2024-08-15 17:22:19,760 : INFO : Precision score for label_class 1: 0.9683
2024-08-15 17:22:19,760 : INFO : Precision score for label_class 2: 0.9453
2024-08-15 17:22:19,760 : INFO : Recall score for label_class 0: 0.9329
2024-08-15 17:22:19,760 : INFO : Recall score for label_class 1: 0.9725
2024-08-15 17:22:19,760 : INFO : Recall score for label_class 2: 0.9164
2024-08-15 17:22:19,760 : INFO : Average F1 score: 0.9376
2024-08-15 17:22:20,226 : INFO : Average loss over validation batches: 0.4084
2024-08-15 17:22:20,226 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:20,226 : INFO : Validation metrics:
2024-08-15 17:22:20,226 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:20,230 : INFO : Accuracy: 0.8519
2024-08-15 17:22:20,230 : INFO : Precision score for label_class 0: 0.7532
2024-08-15 17:22:20,230 : INFO : Precision score for label_class 1: 0.8975
2024-08-15 17:22:20,230 : INFO : Precision score for label_class 2: 0.7980
2024-08-15 17:22:20,230 : INFO : Recall score for label_class 0: 0.8169
2024-08-15 17:22:20,230 : INFO : Recall score for label_class 1: 0.8756
2024-08-15 17:22:20,230 : INFO : Recall score for label_class 2: 0.8144
2024-08-15 17:22:20,230 : INFO : Average F1 score: 0.8254
2024-08-15 17:22:20,230 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:22:20,230 : INFO : Starting epoch 5
2024-08-15 17:22:20,281 : INFO : Current training batch loss: 0.0580 in epoch 5
2024-08-15 17:22:21,111 : INFO : Current training batch loss: 0.2405 in epoch 5
2024-08-15 17:22:21,951 : INFO : Current training batch loss: 0.0437 in epoch 5
2024-08-15 17:22:22,792 : INFO : Current training batch loss: 0.0982 in epoch 5
2024-08-15 17:22:23,623 : INFO : Current training batch loss: 0.2197 in epoch 5
2024-08-15 17:22:23,776 : INFO : Epoch finished, average loss over training batches: 0.1135
2024-08-15 17:22:23,776 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:23,776 : INFO : Training metrics:
2024-08-15 17:22:23,776 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:23,783 : INFO : Accuracy: 0.9715
2024-08-15 17:22:23,783 : INFO : Precision score for label_class 0: 0.9244
2024-08-15 17:22:23,783 : INFO : Precision score for label_class 1: 0.9801
2024-08-15 17:22:23,783 : INFO : Precision score for label_class 2: 0.9754
2024-08-15 17:22:23,783 : INFO : Recall score for label_class 0: 0.9621
2024-08-15 17:22:23,783 : INFO : Recall score for label_class 1: 0.9844
2024-08-15 17:22:23,783 : INFO : Recall score for label_class 2: 0.9483
2024-08-15 17:22:23,783 : INFO : Average F1 score: 0.9623
2024-08-15 17:22:24,249 : INFO : Average loss over validation batches: 0.4625
2024-08-15 17:22:24,249 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:24,249 : INFO : Validation metrics:
2024-08-15 17:22:24,249 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:24,253 : INFO : Accuracy: 0.8459
2024-08-15 17:22:24,253 : INFO : Precision score for label_class 0: 0.7412
2024-08-15 17:22:24,253 : INFO : Precision score for label_class 1: 0.9392
2024-08-15 17:22:24,253 : INFO : Precision score for label_class 2: 0.7368
2024-08-15 17:22:24,253 : INFO : Recall score for label_class 0: 0.8873
2024-08-15 17:22:24,253 : INFO : Recall score for label_class 1: 0.8293
2024-08-15 17:22:24,253 : INFO : Recall score for label_class 2: 0.8660
2024-08-15 17:22:24,253 : INFO : Average F1 score: 0.8282
2024-08-15 17:22:24,253 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:22:24,253 : INFO : Starting epoch 6
2024-08-15 17:22:24,927 : INFO : Current training batch loss: 0.1170 in epoch 6
2024-08-15 17:22:25,768 : INFO : Current training batch loss: 0.0419 in epoch 6
2024-08-15 17:22:26,609 : INFO : Current training batch loss: 0.1195 in epoch 6
2024-08-15 17:22:27,444 : INFO : Current training batch loss: 0.0324 in epoch 6
2024-08-15 17:22:27,796 : INFO : Epoch finished, average loss over training batches: 0.0890
2024-08-15 17:22:27,796 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:27,796 : INFO : Training metrics:
2024-08-15 17:22:27,796 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:27,804 : INFO : Accuracy: 0.9770
2024-08-15 17:22:27,805 : INFO : Precision score for label_class 0: 0.9489
2024-08-15 17:22:27,805 : INFO : Precision score for label_class 1: 0.9850
2024-08-15 17:22:27,805 : INFO : Precision score for label_class 2: 0.9732
2024-08-15 17:22:27,805 : INFO : Recall score for label_class 0: 0.9738
2024-08-15 17:22:27,805 : INFO : Recall score for label_class 1: 0.9850
2024-08-15 17:22:27,805 : INFO : Recall score for label_class 2: 0.9615
2024-08-15 17:22:27,805 : INFO : Average F1 score: 0.9712
2024-08-15 17:22:28,270 : INFO : Average loss over validation batches: 0.4305
2024-08-15 17:22:28,270 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:28,270 : INFO : Validation metrics:
2024-08-15 17:22:28,270 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:28,273 : INFO : Accuracy: 0.8607
2024-08-15 17:22:28,273 : INFO : Precision score for label_class 0: 0.7639
2024-08-15 17:22:28,273 : INFO : Precision score for label_class 1: 0.8824
2024-08-15 17:22:28,273 : INFO : Precision score for label_class 2: 0.8483
2024-08-15 17:22:28,273 : INFO : Recall score for label_class 0: 0.7746
2024-08-15 17:22:28,273 : INFO : Recall score for label_class 1: 0.9146
2024-08-15 17:22:28,273 : INFO : Recall score for label_class 2: 0.7784
2024-08-15 17:22:28,274 : INFO : Average F1 score: 0.8264
2024-08-15 17:22:28,274 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:22:28,274 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:22:28,308 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:22:28,802 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:28,803 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:22:28,803 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:28,806 : INFO : Accuracy: 0.8726
2024-08-15 17:22:28,806 : INFO : Precision score for label_class 0: 0.7763
2024-08-15 17:22:28,806 : INFO : Precision score for label_class 1: 0.8918
2024-08-15 17:22:28,807 : INFO : Precision score for label_class 2: 0.8678
2024-08-15 17:22:28,807 : INFO : Recall score for label_class 0: 0.8310
2024-08-15 17:22:28,807 : INFO : Recall score for label_class 1: 0.9244
2024-08-15 17:22:28,807 : INFO : Recall score for label_class 2: 0.7784
2024-08-15 17:22:28,807 : INFO : Average F1 score: 0.8437
2024-08-15 17:22:28,807 : INFO : Determined score from best model, ending training.
2024-08-15 17:22:28,808 : INFO : Split 2 is finished, the score is: 0.8437
2024-08-15 17:22:28,808 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:28,808 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:28,808 : INFO : Starting training for split 3
2024-08-15 17:22:28,827 : INFO : Starting to tokenize the sequences.
2024-08-15 17:22:28,833 : INFO : Tokenization is finished.
2024-08-15 17:22:28,850 : INFO : Starting to tokenize the sequences.
2024-08-15 17:22:28,855 : INFO : Tokenization is finished.
2024-08-15 17:22:28,860 : INFO : Counting occurences of labels...
2024-08-15 17:22:28,861 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1611,  759]))
2024-08-15 17:22:28,861 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 400, 189]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:22:28,910 : INFO : Starting epoch 1
2024-08-15 17:22:28,962 : INFO : Current training batch loss: 1.1163 in epoch 1
2024-08-15 17:22:29,777 : INFO : Current training batch loss: 1.0500 in epoch 1
2024-08-15 17:22:30,592 : INFO : Current training batch loss: 0.8919 in epoch 1
2024-08-15 17:22:31,407 : INFO : Current training batch loss: 0.7978 in epoch 1
2024-08-15 17:22:32,221 : INFO : Current training batch loss: 0.7025 in epoch 1
2024-08-15 17:22:32,372 : INFO : Epoch finished, average loss over training batches: 0.8910
2024-08-15 17:22:32,372 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:32,372 : INFO : Training metrics:
2024-08-15 17:22:32,372 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:32,380 : INFO : Accuracy: 0.5997
2024-08-15 17:22:32,380 : INFO : Precision score for label_class 0: 0.0968
2024-08-15 17:22:32,380 : INFO : Precision score for label_class 1: 0.6784
2024-08-15 17:22:32,380 : INFO : Precision score for label_class 2: 0.4062
2024-08-15 17:22:32,380 : INFO : Recall score for label_class 0: 0.0091
2024-08-15 17:22:32,380 : INFO : Recall score for label_class 1: 0.8225
2024-08-15 17:22:32,380 : INFO : Recall score for label_class 2: 0.3821
2024-08-15 17:22:32,380 : INFO : Average F1 score: 0.3847
2024-08-15 17:22:32,845 : INFO : Average loss over validation batches: 0.6399
2024-08-15 17:22:32,845 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:32,845 : INFO : Validation metrics:
2024-08-15 17:22:32,845 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:32,848 : INFO : Accuracy: 0.7422
2024-08-15 17:22:32,848 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:22:32,848 : INFO : Precision score for label_class 1: 0.8383
2024-08-15 17:22:32,848 : INFO : Precision score for label_class 2: 0.5636
2024-08-15 17:22:32,848 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:22:32,848 : INFO : Recall score for label_class 1: 0.9200
2024-08-15 17:22:32,848 : INFO : Recall score for label_class 2: 0.7037
2024-08-15 17:22:32,848 : INFO : Average F1 score: 0.5010
2024-08-15 17:22:32,848 : INFO : Validation metric decreased (inf --> 0.639896).  Saving model ...
2024-08-15 17:22:32,948 : INFO : Starting epoch 2
2024-08-15 17:22:33,601 : INFO : Current training batch loss: 0.6136 in epoch 2
2024-08-15 17:22:34,415 : INFO : Current training batch loss: 0.5660 in epoch 2
2024-08-15 17:22:35,315 : INFO : Current training batch loss: 0.5251 in epoch 2
2024-08-15 17:22:36,129 : INFO : Current training batch loss: 0.3555 in epoch 2
2024-08-15 17:22:36,481 : INFO : Epoch finished, average loss over training batches: 0.5115
2024-08-15 17:22:36,481 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:36,481 : INFO : Training metrics:
2024-08-15 17:22:36,481 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:36,485 : INFO : Accuracy: 0.8087
2024-08-15 17:22:36,485 : INFO : Precision score for label_class 0: 0.7580
2024-08-15 17:22:36,485 : INFO : Precision score for label_class 1: 0.8644
2024-08-15 17:22:36,485 : INFO : Precision score for label_class 2: 0.6993
2024-08-15 17:22:36,485 : INFO : Recall score for label_class 0: 0.3628
2024-08-15 17:22:36,485 : INFO : Recall score for label_class 1: 0.9299
2024-08-15 17:22:36,485 : INFO : Recall score for label_class 2: 0.7444
2024-08-15 17:22:36,485 : INFO : Average F1 score: 0.7026
2024-08-15 17:22:36,951 : INFO : Average loss over validation batches: 0.3862
2024-08-15 17:22:36,951 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:36,951 : INFO : Validation metrics:
2024-08-15 17:22:36,951 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:36,954 : INFO : Accuracy: 0.8637
2024-08-15 17:22:36,954 : INFO : Precision score for label_class 0: 0.7449
2024-08-15 17:22:36,954 : INFO : Precision score for label_class 1: 0.9066
2024-08-15 17:22:36,954 : INFO : Precision score for label_class 2: 0.8294
2024-08-15 17:22:36,954 : INFO : Recall score for label_class 0: 0.8488
2024-08-15 17:22:36,954 : INFO : Recall score for label_class 1: 0.9225
2024-08-15 17:22:36,954 : INFO : Recall score for label_class 2: 0.7460
2024-08-15 17:22:36,954 : INFO : Average F1 score: 0.8312
2024-08-15 17:22:36,954 : INFO : Validation metric decreased (0.639896 --> 0.386243).  Saving model ...
2024-08-15 17:22:37,057 : INFO : Starting epoch 3
2024-08-15 17:22:37,510 : INFO : Current training batch loss: 0.2711 in epoch 3
2024-08-15 17:22:38,325 : INFO : Current training batch loss: 0.3000 in epoch 3
2024-08-15 17:22:39,140 : INFO : Current training batch loss: 0.2189 in epoch 3
2024-08-15 17:22:39,955 : INFO : Current training batch loss: 0.0897 in epoch 3
2024-08-15 17:22:40,507 : INFO : Epoch finished, average loss over training batches: 0.2741
2024-08-15 17:22:40,508 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:40,508 : INFO : Training metrics:
2024-08-15 17:22:40,508 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:40,512 : INFO : Accuracy: 0.9140
2024-08-15 17:22:40,512 : INFO : Precision score for label_class 0: 0.8092
2024-08-15 17:22:40,512 : INFO : Precision score for label_class 1: 0.9478
2024-08-15 17:22:40,512 : INFO : Precision score for label_class 2: 0.8896
2024-08-15 17:22:40,512 : INFO : Recall score for label_class 0: 0.8537
2024-08-15 17:22:40,512 : INFO : Recall score for label_class 1: 0.9466
2024-08-15 17:22:40,512 : INFO : Recall score for label_class 2: 0.8709
2024-08-15 17:22:40,512 : INFO : Average F1 score: 0.8861
2024-08-15 17:22:40,980 : INFO : Average loss over validation batches: 0.4150
2024-08-15 17:22:40,980 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:40,980 : INFO : Validation metrics:
2024-08-15 17:22:40,980 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:40,982 : INFO : Accuracy: 0.8652
2024-08-15 17:22:40,982 : INFO : Precision score for label_class 0: 0.8462
2024-08-15 17:22:40,982 : INFO : Precision score for label_class 1: 0.8776
2024-08-15 17:22:40,982 : INFO : Precision score for label_class 2: 0.8415
2024-08-15 17:22:40,982 : INFO : Recall score for label_class 0: 0.7674
2024-08-15 17:22:40,982 : INFO : Recall score for label_class 1: 0.9500
2024-08-15 17:22:40,982 : INFO : Recall score for label_class 2: 0.7302
2024-08-15 17:22:40,982 : INFO : Average F1 score: 0.8330
2024-08-15 17:22:40,983 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:22:40,983 : INFO : Starting epoch 4
2024-08-15 17:22:41,234 : INFO : Current training batch loss: 0.3328 in epoch 4
2024-08-15 17:22:42,049 : INFO : Current training batch loss: 0.1951 in epoch 4
2024-08-15 17:22:42,863 : INFO : Current training batch loss: 0.1876 in epoch 4
2024-08-15 17:22:43,678 : INFO : Current training batch loss: 0.1044 in epoch 4
2024-08-15 17:22:44,431 : INFO : Epoch finished, average loss over training batches: 0.1521
2024-08-15 17:22:44,431 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:44,431 : INFO : Training metrics:
2024-08-15 17:22:44,431 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:44,436 : INFO : Accuracy: 0.9592
2024-08-15 17:22:44,436 : INFO : Precision score for label_class 0: 0.8815
2024-08-15 17:22:44,436 : INFO : Precision score for label_class 1: 0.9770
2024-08-15 17:22:44,436 : INFO : Precision score for label_class 2: 0.9570
2024-08-15 17:22:44,436 : INFO : Recall score for label_class 0: 0.9299
2024-08-15 17:22:44,436 : INFO : Recall score for label_class 1: 0.9745
2024-08-15 17:22:44,436 : INFO : Recall score for label_class 2: 0.9394
2024-08-15 17:22:44,436 : INFO : Average F1 score: 0.9430
2024-08-15 17:22:44,903 : INFO : Average loss over validation batches: 0.4452
2024-08-15 17:22:44,903 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:44,903 : INFO : Validation metrics:
2024-08-15 17:22:44,903 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:44,906 : INFO : Accuracy: 0.8637
2024-08-15 17:22:44,906 : INFO : Precision score for label_class 0: 0.7547
2024-08-15 17:22:44,906 : INFO : Precision score for label_class 1: 0.9243
2024-08-15 17:22:44,906 : INFO : Precision score for label_class 2: 0.8011
2024-08-15 17:22:44,906 : INFO : Recall score for label_class 0: 0.9302
2024-08-15 17:22:44,906 : INFO : Recall score for label_class 1: 0.8850
2024-08-15 17:22:44,906 : INFO : Recall score for label_class 2: 0.7884
2024-08-15 17:22:44,906 : INFO : Average F1 score: 0.8441
2024-08-15 17:22:44,906 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:22:44,906 : INFO : Starting epoch 5
2024-08-15 17:22:44,956 : INFO : Current training batch loss: 0.0495 in epoch 5
2024-08-15 17:22:45,771 : INFO : Current training batch loss: 0.0684 in epoch 5
2024-08-15 17:22:46,586 : INFO : Current training batch loss: 0.0632 in epoch 5
2024-08-15 17:22:47,402 : INFO : Current training batch loss: 0.0382 in epoch 5
2024-08-15 17:22:48,217 : INFO : Current training batch loss: 0.0272 in epoch 5
2024-08-15 17:22:48,368 : INFO : Epoch finished, average loss over training batches: 0.0988
2024-08-15 17:22:48,368 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:48,368 : INFO : Training metrics:
2024-08-15 17:22:48,368 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:48,375 : INFO : Accuracy: 0.9759
2024-08-15 17:22:48,375 : INFO : Precision score for label_class 0: 0.9029
2024-08-15 17:22:48,375 : INFO : Precision score for label_class 1: 0.9876
2024-08-15 17:22:48,375 : INFO : Precision score for label_class 2: 0.9851
2024-08-15 17:22:48,375 : INFO : Recall score for label_class 0: 0.9634
2024-08-15 17:22:48,375 : INFO : Recall score for label_class 1: 0.9876
2024-08-15 17:22:48,376 : INFO : Recall score for label_class 2: 0.9565
2024-08-15 17:22:48,376 : INFO : Average F1 score: 0.9634
2024-08-15 17:22:48,843 : INFO : Average loss over validation batches: 0.4481
2024-08-15 17:22:48,843 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:48,843 : INFO : Validation metrics:
2024-08-15 17:22:48,843 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:48,845 : INFO : Accuracy: 0.8756
2024-08-15 17:22:48,845 : INFO : Precision score for label_class 0: 0.8105
2024-08-15 17:22:48,845 : INFO : Precision score for label_class 1: 0.9253
2024-08-15 17:22:48,846 : INFO : Precision score for label_class 2: 0.8073
2024-08-15 17:22:48,846 : INFO : Recall score for label_class 0: 0.8953
2024-08-15 17:22:48,846 : INFO : Recall score for label_class 1: 0.8975
2024-08-15 17:22:48,846 : INFO : Recall score for label_class 2: 0.8201
2024-08-15 17:22:48,846 : INFO : Average F1 score: 0.8585
2024-08-15 17:22:48,846 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:22:48,846 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:22:48,881 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:22:49,381 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:49,381 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:22:49,381 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:49,383 : INFO : Accuracy: 0.8637
2024-08-15 17:22:49,383 : INFO : Precision score for label_class 0: 0.7449
2024-08-15 17:22:49,383 : INFO : Precision score for label_class 1: 0.9066
2024-08-15 17:22:49,383 : INFO : Precision score for label_class 2: 0.8294
2024-08-15 17:22:49,383 : INFO : Recall score for label_class 0: 0.8488
2024-08-15 17:22:49,383 : INFO : Recall score for label_class 1: 0.9225
2024-08-15 17:22:49,383 : INFO : Recall score for label_class 2: 0.7460
2024-08-15 17:22:49,384 : INFO : Average F1 score: 0.8312
2024-08-15 17:22:49,384 : INFO : Determined score from best model, ending training.
2024-08-15 17:22:49,385 : INFO : Split 3 is finished, the score is: 0.8312
2024-08-15 17:22:49,385 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:49,385 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:49,385 : INFO : Starting training for split 4
2024-08-15 17:22:49,400 : INFO : Starting to tokenize the sequences.
2024-08-15 17:22:49,406 : INFO : Tokenization is finished.
2024-08-15 17:22:49,422 : INFO : Starting to tokenize the sequences.
2024-08-15 17:22:49,427 : INFO : Tokenization is finished.
2024-08-15 17:22:49,432 : INFO : Counting occurences of labels...
2024-08-15 17:22:49,433 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 327, 1621,  751]))
2024-08-15 17:22:49,433 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 87, 390, 197]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:22:49,477 : INFO : Starting epoch 1
2024-08-15 17:22:49,529 : INFO : Current training batch loss: 1.1200 in epoch 1
2024-08-15 17:22:50,349 : INFO : Current training batch loss: 1.0609 in epoch 1
2024-08-15 17:22:51,163 : INFO : Current training batch loss: 0.9295 in epoch 1
2024-08-15 17:22:51,978 : INFO : Current training batch loss: 0.8127 in epoch 1
2024-08-15 17:22:52,794 : INFO : Current training batch loss: 0.7197 in epoch 1
2024-08-15 17:22:52,944 : INFO : Epoch finished, average loss over training batches: 0.9111
2024-08-15 17:22:52,944 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:52,945 : INFO : Training metrics:
2024-08-15 17:22:52,945 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:52,952 : INFO : Accuracy: 0.5876
2024-08-15 17:22:52,952 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:22:52,952 : INFO : Precision score for label_class 1: 0.6663
2024-08-15 17:22:52,952 : INFO : Precision score for label_class 2: 0.3667
2024-08-15 17:22:52,952 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:22:52,952 : INFO : Recall score for label_class 1: 0.8180
2024-08-15 17:22:52,952 : INFO : Recall score for label_class 2: 0.3462
2024-08-15 17:22:52,952 : INFO : Average F1 score: 0.3635
2024-08-15 17:22:53,420 : INFO : Average loss over validation batches: 0.6918
2024-08-15 17:22:53,420 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:53,420 : INFO : Validation metrics:
2024-08-15 17:22:53,420 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:53,423 : INFO : Accuracy: 0.7344
2024-08-15 17:22:53,423 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:22:53,423 : INFO : Precision score for label_class 1: 0.8071
2024-08-15 17:22:53,423 : INFO : Precision score for label_class 2: 0.5874
2024-08-15 17:22:53,423 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:22:53,423 : INFO : Recall score for label_class 1: 0.9333
2024-08-15 17:22:53,423 : INFO : Recall score for label_class 2: 0.6650
2024-08-15 17:22:53,423 : INFO : Average F1 score: 0.4965
2024-08-15 17:22:53,423 : INFO : Validation metric decreased (inf --> 0.691769).  Saving model ...
2024-08-15 17:22:53,533 : INFO : Starting epoch 2
2024-08-15 17:22:54,187 : INFO : Current training batch loss: 0.6586 in epoch 2
2024-08-15 17:22:55,000 : INFO : Current training batch loss: 0.5665 in epoch 2
2024-08-15 17:22:55,814 : INFO : Current training batch loss: 0.4603 in epoch 2
2024-08-15 17:22:56,630 : INFO : Current training batch loss: 0.4167 in epoch 2
2024-08-15 17:22:56,981 : INFO : Epoch finished, average loss over training batches: 0.5604
2024-08-15 17:22:56,982 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:56,982 : INFO : Training metrics:
2024-08-15 17:22:56,982 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:56,989 : INFO : Accuracy: 0.7855
2024-08-15 17:22:56,989 : INFO : Precision score for label_class 0: 0.8125
2024-08-15 17:22:56,989 : INFO : Precision score for label_class 1: 0.8542
2024-08-15 17:22:56,989 : INFO : Precision score for label_class 2: 0.6414
2024-08-15 17:22:56,989 : INFO : Recall score for label_class 0: 0.1988
2024-08-15 17:22:56,989 : INFO : Recall score for label_class 1: 0.9291
2024-08-15 17:22:56,989 : INFO : Recall score for label_class 2: 0.7310
2024-08-15 17:22:56,989 : INFO : Average F1 score: 0.6309
2024-08-15 17:22:57,455 : INFO : Average loss over validation batches: 0.4321
2024-08-15 17:22:57,456 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:57,456 : INFO : Validation metrics:
2024-08-15 17:22:57,456 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:22:57,459 : INFO : Accuracy: 0.8472
2024-08-15 17:22:57,459 : INFO : Precision score for label_class 0: 0.7041
2024-08-15 17:22:57,459 : INFO : Precision score for label_class 1: 0.8808
2024-08-15 17:22:57,459 : INFO : Precision score for label_class 2: 0.8485
2024-08-15 17:22:57,459 : INFO : Recall score for label_class 0: 0.7931
2024-08-15 17:22:57,460 : INFO : Recall score for label_class 1: 0.9282
2024-08-15 17:22:57,460 : INFO : Recall score for label_class 2: 0.7107
2024-08-15 17:22:57,460 : INFO : Average F1 score: 0.8078
2024-08-15 17:22:57,460 : INFO : Validation metric decreased (0.691769 --> 0.432114).  Saving model ...
2024-08-15 17:22:57,562 : INFO : Starting epoch 3
2024-08-15 17:22:58,016 : INFO : Current training batch loss: 0.3604 in epoch 3
2024-08-15 17:22:58,831 : INFO : Current training batch loss: 0.3347 in epoch 3
2024-08-15 17:22:59,646 : INFO : Current training batch loss: 0.4277 in epoch 3
2024-08-15 17:23:00,461 : INFO : Current training batch loss: 0.1691 in epoch 3
2024-08-15 17:23:01,013 : INFO : Epoch finished, average loss over training batches: 0.3068
2024-08-15 17:23:01,014 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:01,014 : INFO : Training metrics:
2024-08-15 17:23:01,014 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:01,017 : INFO : Accuracy: 0.8985
2024-08-15 17:23:01,017 : INFO : Precision score for label_class 0: 0.8000
2024-08-15 17:23:01,017 : INFO : Precision score for label_class 1: 0.9344
2024-08-15 17:23:01,018 : INFO : Precision score for label_class 2: 0.8642
2024-08-15 17:23:01,018 : INFO : Recall score for label_class 0: 0.8318
2024-08-15 17:23:01,018 : INFO : Recall score for label_class 1: 0.9395
2024-08-15 17:23:01,018 : INFO : Recall score for label_class 2: 0.8389
2024-08-15 17:23:01,018 : INFO : Average F1 score: 0.8680
2024-08-15 17:23:01,488 : INFO : Average loss over validation batches: 0.3675
2024-08-15 17:23:01,488 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:01,488 : INFO : Validation metrics:
2024-08-15 17:23:01,488 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:01,491 : INFO : Accuracy: 0.8635
2024-08-15 17:23:01,491 : INFO : Precision score for label_class 0: 0.7300
2024-08-15 17:23:01,491 : INFO : Precision score for label_class 1: 0.9023
2024-08-15 17:23:01,491 : INFO : Precision score for label_class 2: 0.8514
2024-08-15 17:23:01,491 : INFO : Recall score for label_class 0: 0.8391
2024-08-15 17:23:01,491 : INFO : Recall score for label_class 1: 0.9231
2024-08-15 17:23:01,491 : INFO : Recall score for label_class 2: 0.7563
2024-08-15 17:23:01,491 : INFO : Average F1 score: 0.8315
2024-08-15 17:23:01,491 : INFO : Validation metric decreased (0.432114 --> 0.367500).  Saving model ...
2024-08-15 17:23:01,594 : INFO : Starting epoch 4
2024-08-15 17:23:01,846 : INFO : Current training batch loss: 0.3764 in epoch 4
2024-08-15 17:23:02,666 : INFO : Current training batch loss: 0.2127 in epoch 4
2024-08-15 17:23:03,480 : INFO : Current training batch loss: 0.1690 in epoch 4
2024-08-15 17:23:04,295 : INFO : Current training batch loss: 0.1494 in epoch 4
2024-08-15 17:23:05,049 : INFO : Epoch finished, average loss over training batches: 0.1812
2024-08-15 17:23:05,049 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:05,049 : INFO : Training metrics:
2024-08-15 17:23:05,049 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:05,056 : INFO : Accuracy: 0.9422
2024-08-15 17:23:05,056 : INFO : Precision score for label_class 0: 0.8649
2024-08-15 17:23:05,056 : INFO : Precision score for label_class 1: 0.9653
2024-08-15 17:23:05,056 : INFO : Precision score for label_class 2: 0.9279
2024-08-15 17:23:05,056 : INFO : Recall score for label_class 0: 0.9205
2024-08-15 17:23:05,056 : INFO : Recall score for label_class 1: 0.9624
2024-08-15 17:23:05,056 : INFO : Recall score for label_class 2: 0.9081
2024-08-15 17:23:05,056 : INFO : Average F1 score: 0.9245
2024-08-15 17:23:05,523 : INFO : Average loss over validation batches: 0.4247
2024-08-15 17:23:05,523 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:05,523 : INFO : Validation metrics:
2024-08-15 17:23:05,523 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:05,526 : INFO : Accuracy: 0.8561
2024-08-15 17:23:05,526 : INFO : Precision score for label_class 0: 0.7865
2024-08-15 17:23:05,526 : INFO : Precision score for label_class 1: 0.9433
2024-08-15 17:23:05,526 : INFO : Precision score for label_class 2: 0.7500
2024-08-15 17:23:05,526 : INFO : Recall score for label_class 0: 0.8046
2024-08-15 17:23:05,526 : INFO : Recall score for label_class 1: 0.8538
2024-08-15 17:23:05,526 : INFO : Recall score for label_class 2: 0.8832
2024-08-15 17:23:05,526 : INFO : Average F1 score: 0.8343
2024-08-15 17:23:05,526 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:23:05,526 : INFO : Starting epoch 5
2024-08-15 17:23:05,577 : INFO : Current training batch loss: 0.1319 in epoch 5
2024-08-15 17:23:06,391 : INFO : Current training batch loss: 0.1316 in epoch 5
2024-08-15 17:23:07,205 : INFO : Current training batch loss: 0.0446 in epoch 5
2024-08-15 17:23:08,020 : INFO : Current training batch loss: 0.1644 in epoch 5
2024-08-15 17:23:08,835 : INFO : Current training batch loss: 0.0494 in epoch 5
2024-08-15 17:23:08,986 : INFO : Epoch finished, average loss over training batches: 0.1082
2024-08-15 17:23:08,986 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:08,986 : INFO : Training metrics:
2024-08-15 17:23:08,986 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:08,993 : INFO : Accuracy: 0.9692
2024-08-15 17:23:08,993 : INFO : Precision score for label_class 0: 0.9147
2024-08-15 17:23:08,993 : INFO : Precision score for label_class 1: 0.9827
2024-08-15 17:23:08,993 : INFO : Precision score for label_class 2: 0.9650
2024-08-15 17:23:08,993 : INFO : Recall score for label_class 0: 0.9511
2024-08-15 17:23:08,993 : INFO : Recall score for label_class 1: 0.9803
2024-08-15 17:23:08,993 : INFO : Recall score for label_class 2: 0.9534
2024-08-15 17:23:08,993 : INFO : Average F1 score: 0.9577
2024-08-15 17:23:09,461 : INFO : Average loss over validation batches: 0.4101
2024-08-15 17:23:09,461 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:09,461 : INFO : Validation metrics:
2024-08-15 17:23:09,461 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:09,464 : INFO : Accuracy: 0.8724
2024-08-15 17:23:09,464 : INFO : Precision score for label_class 0: 0.7978
2024-08-15 17:23:09,464 : INFO : Precision score for label_class 1: 0.9233
2024-08-15 17:23:09,464 : INFO : Precision score for label_class 2: 0.8116
2024-08-15 17:23:09,464 : INFO : Recall score for label_class 0: 0.8161
2024-08-15 17:23:09,464 : INFO : Recall score for label_class 1: 0.8949
2024-08-15 17:23:09,464 : INFO : Recall score for label_class 2: 0.8528
2024-08-15 17:23:09,464 : INFO : Average F1 score: 0.8491
2024-08-15 17:23:09,464 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:23:09,464 : INFO : Starting epoch 6
2024-08-15 17:23:10,117 : INFO : Current training batch loss: 0.0331 in epoch 6
2024-08-15 17:23:10,932 : INFO : Current training batch loss: 0.1127 in epoch 6
2024-08-15 17:23:11,748 : INFO : Current training batch loss: 0.1105 in epoch 6
2024-08-15 17:23:12,563 : INFO : Current training batch loss: 0.0233 in epoch 6
2024-08-15 17:23:12,915 : INFO : Epoch finished, average loss over training batches: 0.0685
2024-08-15 17:23:12,915 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:12,915 : INFO : Training metrics:
2024-08-15 17:23:12,915 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:12,923 : INFO : Accuracy: 0.9830
2024-08-15 17:23:12,923 : INFO : Precision score for label_class 0: 0.9520
2024-08-15 17:23:12,923 : INFO : Precision score for label_class 1: 0.9913
2024-08-15 17:23:12,923 : INFO : Precision score for label_class 2: 0.9787
2024-08-15 17:23:12,923 : INFO : Recall score for label_class 0: 0.9694
2024-08-15 17:23:12,923 : INFO : Recall score for label_class 1: 0.9883
2024-08-15 17:23:12,923 : INFO : Recall score for label_class 2: 0.9774
2024-08-15 17:23:12,923 : INFO : Average F1 score: 0.9761
2024-08-15 17:23:13,389 : INFO : Average loss over validation batches: 0.4368
2024-08-15 17:23:13,390 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:13,390 : INFO : Validation metrics:
2024-08-15 17:23:13,390 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:13,393 : INFO : Accuracy: 0.8798
2024-08-15 17:23:13,393 : INFO : Precision score for label_class 0: 0.7912
2024-08-15 17:23:13,393 : INFO : Precision score for label_class 1: 0.9307
2024-08-15 17:23:13,393 : INFO : Precision score for label_class 2: 0.8269
2024-08-15 17:23:13,393 : INFO : Recall score for label_class 0: 0.8276
2024-08-15 17:23:13,393 : INFO : Recall score for label_class 1: 0.8949
2024-08-15 17:23:13,393 : INFO : Recall score for label_class 2: 0.8731
2024-08-15 17:23:13,393 : INFO : Average F1 score: 0.8569
2024-08-15 17:23:13,393 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:23:13,393 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:23:13,433 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:23:13,931 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:13,931 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:23:13,931 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:13,934 : INFO : Accuracy: 0.8635
2024-08-15 17:23:13,934 : INFO : Precision score for label_class 0: 0.7300
2024-08-15 17:23:13,934 : INFO : Precision score for label_class 1: 0.9023
2024-08-15 17:23:13,934 : INFO : Precision score for label_class 2: 0.8514
2024-08-15 17:23:13,934 : INFO : Recall score for label_class 0: 0.8391
2024-08-15 17:23:13,934 : INFO : Recall score for label_class 1: 0.9231
2024-08-15 17:23:13,934 : INFO : Recall score for label_class 2: 0.7563
2024-08-15 17:23:13,934 : INFO : Average F1 score: 0.8315
2024-08-15 17:23:13,934 : INFO : Determined score from best model, ending training.
2024-08-15 17:23:13,936 : INFO : Split 4 is finished, the score is: 0.8315
2024-08-15 17:23:13,936 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:13,941 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:13,941 : INFO : Starting training for split 5
2024-08-15 17:23:13,954 : INFO : Starting to tokenize the sequences.
2024-08-15 17:23:13,960 : INFO : Tokenization is finished.
2024-08-15 17:23:13,978 : INFO : Starting to tokenize the sequences.
2024-08-15 17:23:13,982 : INFO : Tokenization is finished.
2024-08-15 17:23:13,987 : INFO : Counting occurences of labels...
2024-08-15 17:23:13,988 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 330, 1615,  754]))
2024-08-15 17:23:13,989 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 84, 396, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:23:14,038 : INFO : Starting epoch 1
2024-08-15 17:23:14,090 : INFO : Current training batch loss: 1.1148 in epoch 1
2024-08-15 17:23:14,905 : INFO : Current training batch loss: 1.0563 in epoch 1
2024-08-15 17:23:15,720 : INFO : Current training batch loss: 0.9060 in epoch 1
2024-08-15 17:23:16,535 : INFO : Current training batch loss: 0.8115 in epoch 1
2024-08-15 17:23:17,349 : INFO : Current training batch loss: 0.7299 in epoch 1
2024-08-15 17:23:17,500 : INFO : Epoch finished, average loss over training batches: 0.9015
2024-08-15 17:23:17,500 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:17,500 : INFO : Training metrics:
2024-08-15 17:23:17,500 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:17,511 : INFO : Accuracy: 0.5873
2024-08-15 17:23:17,511 : INFO : Precision score for label_class 0: 0.0874
2024-08-15 17:23:17,511 : INFO : Precision score for label_class 1: 0.6649
2024-08-15 17:23:17,511 : INFO : Precision score for label_class 2: 0.4435
2024-08-15 17:23:17,511 : INFO : Recall score for label_class 0: 0.0485
2024-08-15 17:23:17,511 : INFO : Recall score for label_class 1: 0.8427
2024-08-15 17:23:17,511 : INFO : Recall score for label_class 2: 0.2759
2024-08-15 17:23:17,511 : INFO : Average F1 score: 0.3819
2024-08-15 17:23:17,978 : INFO : Average loss over validation batches: 0.6692
2024-08-15 17:23:17,978 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:17,978 : INFO : Validation metrics:
2024-08-15 17:23:17,978 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:17,982 : INFO : Accuracy: 0.7255
2024-08-15 17:23:17,982 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:23:17,982 : INFO : Precision score for label_class 1: 0.8268
2024-08-15 17:23:17,982 : INFO : Precision score for label_class 2: 0.5436
2024-08-15 17:23:17,982 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:23:17,982 : INFO : Recall score for label_class 1: 0.9040
2024-08-15 17:23:17,982 : INFO : Recall score for label_class 2: 0.6753
2024-08-15 17:23:17,982 : INFO : Average F1 score: 0.4887
2024-08-15 17:23:17,982 : INFO : Validation metric decreased (inf --> 0.669211).  Saving model ...
2024-08-15 17:23:18,080 : INFO : Starting epoch 2
2024-08-15 17:23:18,734 : INFO : Current training batch loss: 0.6298 in epoch 2
2024-08-15 17:23:19,548 : INFO : Current training batch loss: 0.4874 in epoch 2
2024-08-15 17:23:20,362 : INFO : Current training batch loss: 0.3225 in epoch 2
2024-08-15 17:23:21,177 : INFO : Current training batch loss: 0.4327 in epoch 2
2024-08-15 17:23:21,529 : INFO : Epoch finished, average loss over training batches: 0.5153
2024-08-15 17:23:21,529 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:21,529 : INFO : Training metrics:
2024-08-15 17:23:21,529 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:21,536 : INFO : Accuracy: 0.8166
2024-08-15 17:23:21,537 : INFO : Precision score for label_class 0: 0.7558
2024-08-15 17:23:21,537 : INFO : Precision score for label_class 1: 0.8610
2024-08-15 17:23:21,537 : INFO : Precision score for label_class 2: 0.7273
2024-08-15 17:23:21,537 : INFO : Recall score for label_class 0: 0.4970
2024-08-15 17:23:21,537 : INFO : Recall score for label_class 1: 0.9362
2024-08-15 17:23:21,537 : INFO : Recall score for label_class 2: 0.7003
2024-08-15 17:23:21,537 : INFO : Average F1 score: 0.7367
2024-08-15 17:23:22,002 : INFO : Average loss over validation batches: 0.4414
2024-08-15 17:23:22,002 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:22,002 : INFO : Validation metrics:
2024-08-15 17:23:22,002 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:22,006 : INFO : Accuracy: 0.8309
2024-08-15 17:23:22,006 : INFO : Precision score for label_class 0: 0.7432
2024-08-15 17:23:22,006 : INFO : Precision score for label_class 1: 0.8481
2024-08-15 17:23:22,006 : INFO : Precision score for label_class 2: 0.8239
2024-08-15 17:23:22,006 : INFO : Recall score for label_class 0: 0.6548
2024-08-15 17:23:22,006 : INFO : Recall score for label_class 1: 0.9444
2024-08-15 17:23:22,006 : INFO : Recall score for label_class 2: 0.6753
2024-08-15 17:23:22,006 : INFO : Average F1 score: 0.7774
2024-08-15 17:23:22,006 : INFO : Validation metric decreased (0.669211 --> 0.441373).  Saving model ...
2024-08-15 17:23:22,108 : INFO : Starting epoch 3
2024-08-15 17:23:22,561 : INFO : Current training batch loss: 0.3234 in epoch 3
2024-08-15 17:23:23,376 : INFO : Current training batch loss: 0.3840 in epoch 3
2024-08-15 17:23:24,190 : INFO : Current training batch loss: 0.2880 in epoch 3
2024-08-15 17:23:25,005 : INFO : Current training batch loss: 0.2070 in epoch 3
2024-08-15 17:23:25,558 : INFO : Epoch finished, average loss over training batches: 0.2962
2024-08-15 17:23:25,559 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:25,559 : INFO : Training metrics:
2024-08-15 17:23:25,559 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:25,569 : INFO : Accuracy: 0.9040
2024-08-15 17:23:25,569 : INFO : Precision score for label_class 0: 0.8214
2024-08-15 17:23:25,569 : INFO : Precision score for label_class 1: 0.9313
2024-08-15 17:23:25,569 : INFO : Precision score for label_class 2: 0.8804
2024-08-15 17:23:25,569 : INFO : Recall score for label_class 0: 0.8364
2024-08-15 17:23:25,569 : INFO : Recall score for label_class 1: 0.9480
2024-08-15 17:23:25,569 : INFO : Recall score for label_class 2: 0.8395
2024-08-15 17:23:25,569 : INFO : Average F1 score: 0.8760
2024-08-15 17:23:26,037 : INFO : Average loss over validation batches: 0.4243
2024-08-15 17:23:26,037 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:26,037 : INFO : Validation metrics:
2024-08-15 17:23:26,037 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:26,040 : INFO : Accuracy: 0.8427
2024-08-15 17:23:26,040 : INFO : Precision score for label_class 0: 0.8281
2024-08-15 17:23:26,041 : INFO : Precision score for label_class 1: 0.8516
2024-08-15 17:23:26,041 : INFO : Precision score for label_class 2: 0.8256
2024-08-15 17:23:26,041 : INFO : Recall score for label_class 0: 0.6310
2024-08-15 17:23:26,041 : INFO : Recall score for label_class 1: 0.9419
2024-08-15 17:23:26,041 : INFO : Recall score for label_class 2: 0.7320
2024-08-15 17:23:26,041 : INFO : Average F1 score: 0.7956
2024-08-15 17:23:26,041 : INFO : Validation metric decreased (0.441373 --> 0.424256).  Saving model ...
2024-08-15 17:23:26,143 : INFO : Starting epoch 4
2024-08-15 17:23:26,395 : INFO : Current training batch loss: 0.3419 in epoch 4
2024-08-15 17:23:27,209 : INFO : Current training batch loss: 0.2587 in epoch 4
2024-08-15 17:23:28,025 : INFO : Current training batch loss: 0.2128 in epoch 4
2024-08-15 17:23:28,839 : INFO : Current training batch loss: 0.0845 in epoch 4
2024-08-15 17:23:29,593 : INFO : Epoch finished, average loss over training batches: 0.1935
2024-08-15 17:23:29,593 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:29,593 : INFO : Training metrics:
2024-08-15 17:23:29,593 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:29,600 : INFO : Accuracy: 0.9422
2024-08-15 17:23:29,600 : INFO : Precision score for label_class 0: 0.8725
2024-08-15 17:23:29,600 : INFO : Precision score for label_class 1: 0.9607
2024-08-15 17:23:29,600 : INFO : Precision score for label_class 2: 0.9340
2024-08-15 17:23:29,600 : INFO : Recall score for label_class 0: 0.9121
2024-08-15 17:23:29,600 : INFO : Recall score for label_class 1: 0.9678
2024-08-15 17:23:29,600 : INFO : Recall score for label_class 2: 0.9005
2024-08-15 17:23:29,600 : INFO : Average F1 score: 0.9243
2024-08-15 17:23:30,065 : INFO : Average loss over validation batches: 0.3926
2024-08-15 17:23:30,066 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:30,066 : INFO : Validation metrics:
2024-08-15 17:23:30,066 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:30,069 : INFO : Accuracy: 0.8531
2024-08-15 17:23:30,070 : INFO : Precision score for label_class 0: 0.8205
2024-08-15 17:23:30,070 : INFO : Precision score for label_class 1: 0.8662
2024-08-15 17:23:30,070 : INFO : Precision score for label_class 2: 0.8353
2024-08-15 17:23:30,070 : INFO : Recall score for label_class 0: 0.7619
2024-08-15 17:23:30,070 : INFO : Recall score for label_class 1: 0.9318
2024-08-15 17:23:30,070 : INFO : Recall score for label_class 2: 0.7320
2024-08-15 17:23:30,070 : INFO : Average F1 score: 0.8227
2024-08-15 17:23:30,070 : INFO : Validation metric decreased (0.424256 --> 0.392554).  Saving model ...
2024-08-15 17:23:30,173 : INFO : Starting epoch 5
2024-08-15 17:23:30,224 : INFO : Current training batch loss: 0.0566 in epoch 5
2024-08-15 17:23:31,038 : INFO : Current training batch loss: 0.0686 in epoch 5
2024-08-15 17:23:31,853 : INFO : Current training batch loss: 0.0362 in epoch 5
2024-08-15 17:23:32,668 : INFO : Current training batch loss: 0.2254 in epoch 5
2024-08-15 17:23:33,483 : INFO : Current training batch loss: 0.0366 in epoch 5
2024-08-15 17:23:33,633 : INFO : Epoch finished, average loss over training batches: 0.1249
2024-08-15 17:23:33,634 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:33,634 : INFO : Training metrics:
2024-08-15 17:23:33,634 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:33,641 : INFO : Accuracy: 0.9663
2024-08-15 17:23:33,641 : INFO : Precision score for label_class 0: 0.9184
2024-08-15 17:23:33,641 : INFO : Precision score for label_class 1: 0.9796
2024-08-15 17:23:33,641 : INFO : Precision score for label_class 2: 0.9595
2024-08-15 17:23:33,641 : INFO : Recall score for label_class 0: 0.9545
2024-08-15 17:23:33,641 : INFO : Recall score for label_class 1: 0.9796
2024-08-15 17:23:33,641 : INFO : Recall score for label_class 2: 0.9430
2024-08-15 17:23:33,641 : INFO : Average F1 score: 0.9556
2024-08-15 17:23:34,106 : INFO : Average loss over validation batches: 0.4499
2024-08-15 17:23:34,106 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:34,106 : INFO : Validation metrics:
2024-08-15 17:23:34,106 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:34,109 : INFO : Accuracy: 0.8501
2024-08-15 17:23:34,109 : INFO : Precision score for label_class 0: 0.6577
2024-08-15 17:23:34,109 : INFO : Precision score for label_class 1: 0.9322
2024-08-15 17:23:34,109 : INFO : Precision score for label_class 2: 0.8041
2024-08-15 17:23:34,109 : INFO : Recall score for label_class 0: 0.8690
2024-08-15 17:23:34,109 : INFO : Recall score for label_class 1: 0.8687
2024-08-15 17:23:34,109 : INFO : Recall score for label_class 2: 0.8041
2024-08-15 17:23:34,109 : INFO : Average F1 score: 0.8174
2024-08-15 17:23:34,109 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:23:34,109 : INFO : Starting epoch 6
2024-08-15 17:23:34,763 : INFO : Current training batch loss: 0.0919 in epoch 6
2024-08-15 17:23:35,578 : INFO : Current training batch loss: 0.1228 in epoch 6
2024-08-15 17:23:36,393 : INFO : Current training batch loss: 0.0300 in epoch 6
2024-08-15 17:23:37,208 : INFO : Current training batch loss: 0.0356 in epoch 6
2024-08-15 17:23:37,560 : INFO : Epoch finished, average loss over training batches: 0.0747
2024-08-15 17:23:37,560 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:37,560 : INFO : Training metrics:
2024-08-15 17:23:37,560 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:37,567 : INFO : Accuracy: 0.9815
2024-08-15 17:23:37,568 : INFO : Precision score for label_class 0: 0.9555
2024-08-15 17:23:37,568 : INFO : Precision score for label_class 1: 0.9895
2024-08-15 17:23:37,568 : INFO : Precision score for label_class 2: 0.9758
2024-08-15 17:23:37,568 : INFO : Recall score for label_class 0: 0.9758
2024-08-15 17:23:37,568 : INFO : Recall score for label_class 1: 0.9907
2024-08-15 17:23:37,568 : INFO : Recall score for label_class 2: 0.9642
2024-08-15 17:23:37,568 : INFO : Average F1 score: 0.9752
2024-08-15 17:23:38,033 : INFO : Average loss over validation batches: 0.4699
2024-08-15 17:23:38,034 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:38,034 : INFO : Validation metrics:
2024-08-15 17:23:38,034 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:38,037 : INFO : Accuracy: 0.8576
2024-08-15 17:23:38,037 : INFO : Precision score for label_class 0: 0.6893
2024-08-15 17:23:38,037 : INFO : Precision score for label_class 1: 0.9324
2024-08-15 17:23:38,038 : INFO : Precision score for label_class 2: 0.8060
2024-08-15 17:23:38,038 : INFO : Recall score for label_class 0: 0.8452
2024-08-15 17:23:38,038 : INFO : Recall score for label_class 1: 0.8712
2024-08-15 17:23:38,038 : INFO : Recall score for label_class 2: 0.8351
2024-08-15 17:23:38,038 : INFO : Average F1 score: 0.8268
2024-08-15 17:23:38,038 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:23:38,038 : INFO : Starting epoch 7
2024-08-15 17:23:38,490 : INFO : Current training batch loss: 0.0148 in epoch 7
2024-08-15 17:23:39,306 : INFO : Current training batch loss: 0.0198 in epoch 7
2024-08-15 17:23:40,121 : INFO : Current training batch loss: 0.0375 in epoch 7
2024-08-15 17:23:40,937 : INFO : Current training batch loss: 0.0139 in epoch 7
2024-08-15 17:23:41,489 : INFO : Epoch finished, average loss over training batches: 0.0570
2024-08-15 17:23:41,490 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:41,490 : INFO : Training metrics:
2024-08-15 17:23:41,490 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:41,497 : INFO : Accuracy: 0.9859
2024-08-15 17:23:41,497 : INFO : Precision score for label_class 0: 0.9501
2024-08-15 17:23:41,497 : INFO : Precision score for label_class 1: 0.9920
2024-08-15 17:23:41,497 : INFO : Precision score for label_class 2: 0.9892
2024-08-15 17:23:41,497 : INFO : Recall score for label_class 0: 0.9818
2024-08-15 17:23:41,497 : INFO : Recall score for label_class 1: 0.9944
2024-08-15 17:23:41,497 : INFO : Recall score for label_class 2: 0.9695
2024-08-15 17:23:41,497 : INFO : Average F1 score: 0.9794
2024-08-15 17:23:41,963 : INFO : Average loss over validation batches: 0.4740
2024-08-15 17:23:41,963 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:41,963 : INFO : Validation metrics:
2024-08-15 17:23:41,963 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:41,967 : INFO : Accuracy: 0.8635
2024-08-15 17:23:41,967 : INFO : Precision score for label_class 0: 0.7527
2024-08-15 17:23:41,967 : INFO : Precision score for label_class 1: 0.9186
2024-08-15 17:23:41,967 : INFO : Precision score for label_class 2: 0.8100
2024-08-15 17:23:41,967 : INFO : Recall score for label_class 0: 0.8333
2024-08-15 17:23:41,967 : INFO : Recall score for label_class 1: 0.8838
2024-08-15 17:23:41,967 : INFO : Recall score for label_class 2: 0.8351
2024-08-15 17:23:41,967 : INFO : Average F1 score: 0.8381
2024-08-15 17:23:41,967 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:23:41,967 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:23:42,002 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:23:42,503 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:42,503 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:23:42,503 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:42,507 : INFO : Accuracy: 0.8531
2024-08-15 17:23:42,507 : INFO : Precision score for label_class 0: 0.8205
2024-08-15 17:23:42,507 : INFO : Precision score for label_class 1: 0.8662
2024-08-15 17:23:42,507 : INFO : Precision score for label_class 2: 0.8353
2024-08-15 17:23:42,507 : INFO : Recall score for label_class 0: 0.7619
2024-08-15 17:23:42,507 : INFO : Recall score for label_class 1: 0.9318
2024-08-15 17:23:42,507 : INFO : Recall score for label_class 2: 0.7320
2024-08-15 17:23:42,507 : INFO : Average F1 score: 0.8227
2024-08-15 17:23:42,507 : INFO : Determined score from best model, ending training.
2024-08-15 17:23:42,508 : INFO : Split 5 is finished, the score is: 0.8227
2024-08-15 17:23:42,509 : INFO : ----------------------------------------------------------------------------------------------------
[I 2024-08-15 17:23:42,523] Trial 9 finished with value: 0.8406637282692095 and parameters: {'n_epochs': 15, 'learning_rate': 4.3919553128469924e-05, 'classifier_dropout': 0.3984346125541812, 'warmup_step_fraction': 0.03561478529563179, 'use_gradient_clipping': False}. Best is trial 1 with value: 0.8513001269595835.
2024-08-15 17:23:42,531 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:42,531 : INFO : Starting training for split 1
2024-08-15 17:23:42,544 : INFO : Starting to tokenize the sequences.
2024-08-15 17:23:42,549 : INFO : Tokenization is finished.
2024-08-15 17:23:42,561 : INFO : Starting to tokenize the sequences.
2024-08-15 17:23:42,566 : INFO : Tokenization is finished.
2024-08-15 17:23:42,566 : INFO : Counting occurences of labels...
2024-08-15 17:23:42,567 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1596,  774]))
2024-08-15 17:23:42,567 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 415, 174]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:23:42,710 : INFO : Starting epoch 1
2024-08-15 17:23:42,761 : INFO : Current training batch loss: 1.1127 in epoch 1
2024-08-15 17:23:43,595 : INFO : Current training batch loss: 0.9737 in epoch 1
2024-08-15 17:23:44,429 : INFO : Current training batch loss: 0.9552 in epoch 1
2024-08-15 17:23:45,247 : INFO : Current training batch loss: 0.7050 in epoch 1
2024-08-15 17:23:46,081 : INFO : Current training batch loss: 0.6370 in epoch 1
2024-08-15 17:23:46,240 : INFO : Epoch finished, average loss over training batches: 0.8692
2024-08-15 17:23:46,241 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:46,241 : INFO : Training metrics:
2024-08-15 17:23:46,241 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:46,249 : INFO : Accuracy: 0.6149
2024-08-15 17:23:46,249 : INFO : Precision score for label_class 0: 0.1154
2024-08-15 17:23:46,249 : INFO : Precision score for label_class 1: 0.6898
2024-08-15 17:23:46,249 : INFO : Precision score for label_class 2: 0.5344
2024-08-15 17:23:46,249 : INFO : Recall score for label_class 0: 0.0823
2024-08-15 17:23:46,249 : INFO : Recall score for label_class 1: 0.8766
2024-08-15 17:23:46,249 : INFO : Recall score for label_class 2: 0.3010
2024-08-15 17:23:46,249 : INFO : Average F1 score: 0.4178
2024-08-15 17:23:46,716 : INFO : Average loss over validation batches: 0.7474
2024-08-15 17:23:46,716 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:46,716 : INFO : Validation metrics:
2024-08-15 17:23:46,716 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:46,719 : INFO : Accuracy: 0.6652
2024-08-15 17:23:46,719 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:23:46,719 : INFO : Precision score for label_class 1: 0.9102
2024-08-15 17:23:46,719 : INFO : Precision score for label_class 2: 0.4403
2024-08-15 17:23:46,719 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:23:46,719 : INFO : Recall score for label_class 1: 0.7084
2024-08-15 17:23:46,719 : INFO : Recall score for label_class 2: 0.8908
2024-08-15 17:23:46,719 : INFO : Average F1 score: 0.4620
2024-08-15 17:23:46,719 : INFO : Validation metric decreased (inf --> 0.747384).  Saving model ...
2024-08-15 17:23:46,831 : INFO : Starting epoch 2
2024-08-15 17:23:47,504 : INFO : Current training batch loss: 0.4308 in epoch 2
2024-08-15 17:23:48,347 : INFO : Current training batch loss: 0.6631 in epoch 2
2024-08-15 17:23:49,176 : INFO : Current training batch loss: 0.4022 in epoch 2
2024-08-15 17:23:49,999 : INFO : Current training batch loss: 0.7043 in epoch 2
2024-08-15 17:23:50,356 : INFO : Epoch finished, average loss over training batches: 0.4879
2024-08-15 17:23:50,357 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:50,357 : INFO : Training metrics:
2024-08-15 17:23:50,357 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:50,365 : INFO : Accuracy: 0.8310
2024-08-15 17:23:50,365 : INFO : Precision score for label_class 0: 0.7273
2024-08-15 17:23:50,365 : INFO : Precision score for label_class 1: 0.8772
2024-08-15 17:23:50,365 : INFO : Precision score for label_class 2: 0.7666
2024-08-15 17:23:50,365 : INFO : Recall score for label_class 0: 0.6098
2024-08-15 17:23:50,365 : INFO : Recall score for label_class 1: 0.9173
2024-08-15 17:23:50,365 : INFO : Recall score for label_class 2: 0.7468
2024-08-15 17:23:50,365 : INFO : Average F1 score: 0.7722
2024-08-15 17:23:50,837 : INFO : Average loss over validation batches: 0.3856
2024-08-15 17:23:50,838 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:50,838 : INFO : Validation metrics:
2024-08-15 17:23:50,838 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:50,841 : INFO : Accuracy: 0.8681
2024-08-15 17:23:50,841 : INFO : Precision score for label_class 0: 0.8214
2024-08-15 17:23:50,841 : INFO : Precision score for label_class 1: 0.9102
2024-08-15 17:23:50,841 : INFO : Precision score for label_class 2: 0.7933
2024-08-15 17:23:50,841 : INFO : Recall score for label_class 0: 0.8023
2024-08-15 17:23:50,841 : INFO : Recall score for label_class 1: 0.9036
2024-08-15 17:23:50,841 : INFO : Recall score for label_class 2: 0.8161
2024-08-15 17:23:50,841 : INFO : Average F1 score: 0.8411
2024-08-15 17:23:50,841 : INFO : Validation metric decreased (0.747384 --> 0.385583).  Saving model ...
2024-08-15 17:23:50,943 : INFO : Starting epoch 3
2024-08-15 17:23:51,412 : INFO : Current training batch loss: 0.2904 in epoch 3
2024-08-15 17:23:52,240 : INFO : Current training batch loss: 0.4165 in epoch 3
2024-08-15 17:23:53,074 : INFO : Current training batch loss: 0.1746 in epoch 3
2024-08-15 17:23:53,917 : INFO : Current training batch loss: 0.2167 in epoch 3
2024-08-15 17:23:54,478 : INFO : Epoch finished, average loss over training batches: 0.2867
2024-08-15 17:23:54,478 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:54,478 : INFO : Training metrics:
2024-08-15 17:23:54,478 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:54,483 : INFO : Accuracy: 0.9092
2024-08-15 17:23:54,483 : INFO : Precision score for label_class 0: 0.8237
2024-08-15 17:23:54,483 : INFO : Precision score for label_class 1: 0.9404
2024-08-15 17:23:54,483 : INFO : Precision score for label_class 2: 0.8826
2024-08-15 17:23:54,483 : INFO : Recall score for label_class 0: 0.8689
2024-08-15 17:23:54,483 : INFO : Recall score for label_class 1: 0.9392
2024-08-15 17:23:54,483 : INFO : Recall score for label_class 2: 0.8643
2024-08-15 17:23:54,483 : INFO : Average F1 score: 0.8863
2024-08-15 17:23:54,953 : INFO : Average loss over validation batches: 0.3797
2024-08-15 17:23:54,954 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:54,954 : INFO : Validation metrics:
2024-08-15 17:23:54,954 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:54,957 : INFO : Accuracy: 0.8696
2024-08-15 17:23:54,957 : INFO : Precision score for label_class 0: 0.8272
2024-08-15 17:23:54,957 : INFO : Precision score for label_class 1: 0.9150
2024-08-15 17:23:54,957 : INFO : Precision score for label_class 2: 0.7857
2024-08-15 17:23:54,957 : INFO : Recall score for label_class 0: 0.7791
2024-08-15 17:23:54,957 : INFO : Recall score for label_class 1: 0.9084
2024-08-15 17:23:54,957 : INFO : Recall score for label_class 2: 0.8218
2024-08-15 17:23:54,957 : INFO : Average F1 score: 0.8392
2024-08-15 17:23:54,957 : INFO : Validation metric decreased (0.385583 --> 0.379728).  Saving model ...
2024-08-15 17:23:55,062 : INFO : Starting epoch 4
2024-08-15 17:23:55,319 : INFO : Current training batch loss: 0.3725 in epoch 4
2024-08-15 17:23:56,180 : INFO : Current training batch loss: 0.1979 in epoch 4
2024-08-15 17:23:57,042 : INFO : Current training batch loss: 0.2463 in epoch 4
2024-08-15 17:23:57,901 : INFO : Current training batch loss: 0.1825 in epoch 4
2024-08-15 17:23:58,700 : INFO : Epoch finished, average loss over training batches: 0.1767
2024-08-15 17:23:58,701 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:58,701 : INFO : Training metrics:
2024-08-15 17:23:58,701 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:58,706 : INFO : Accuracy: 0.9426
2024-08-15 17:23:58,706 : INFO : Precision score for label_class 0: 0.8703
2024-08-15 17:23:58,706 : INFO : Precision score for label_class 1: 0.9596
2024-08-15 17:23:58,706 : INFO : Precision score for label_class 2: 0.9395
2024-08-15 17:23:58,706 : INFO : Recall score for label_class 0: 0.9207
2024-08-15 17:23:58,706 : INFO : Recall score for label_class 1: 0.9662
2024-08-15 17:23:58,706 : INFO : Recall score for label_class 2: 0.9031
2024-08-15 17:23:58,706 : INFO : Average F1 score: 0.9262
2024-08-15 17:23:59,174 : INFO : Average loss over validation batches: 0.4868
2024-08-15 17:23:59,174 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:59,174 : INFO : Validation metrics:
2024-08-15 17:23:59,175 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:23:59,177 : INFO : Accuracy: 0.8296
2024-08-15 17:23:59,177 : INFO : Precision score for label_class 0: 0.7684
2024-08-15 17:23:59,177 : INFO : Precision score for label_class 1: 0.9564
2024-08-15 17:23:59,177 : INFO : Precision score for label_class 2: 0.6695
2024-08-15 17:23:59,177 : INFO : Recall score for label_class 0: 0.8488
2024-08-15 17:23:59,177 : INFO : Recall score for label_class 1: 0.7928
2024-08-15 17:23:59,177 : INFO : Recall score for label_class 2: 0.9080
2024-08-15 17:23:59,177 : INFO : Average F1 score: 0.8148
2024-08-15 17:23:59,177 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:23:59,177 : INFO : Starting epoch 5
2024-08-15 17:23:59,228 : INFO : Current training batch loss: 0.0553 in epoch 5
2024-08-15 17:24:00,087 : INFO : Current training batch loss: 0.1009 in epoch 5
2024-08-15 17:24:00,947 : INFO : Current training batch loss: 0.0181 in epoch 5
2024-08-15 17:24:01,792 : INFO : Current training batch loss: 0.0632 in epoch 5
2024-08-15 17:24:02,610 : INFO : Current training batch loss: 0.1523 in epoch 5
2024-08-15 17:24:02,762 : INFO : Epoch finished, average loss over training batches: 0.0945
2024-08-15 17:24:02,762 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:02,763 : INFO : Training metrics:
2024-08-15 17:24:02,763 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:02,770 : INFO : Accuracy: 0.9744
2024-08-15 17:24:02,771 : INFO : Precision score for label_class 0: 0.9181
2024-08-15 17:24:02,771 : INFO : Precision score for label_class 1: 0.9881
2024-08-15 17:24:02,771 : INFO : Precision score for label_class 2: 0.9713
2024-08-15 17:24:02,771 : INFO : Recall score for label_class 0: 0.9573
2024-08-15 17:24:02,771 : INFO : Recall score for label_class 1: 0.9843
2024-08-15 17:24:02,771 : INFO : Recall score for label_class 2: 0.9612
2024-08-15 17:24:02,771 : INFO : Average F1 score: 0.9632
2024-08-15 17:24:03,239 : INFO : Average loss over validation batches: 0.4395
2024-08-15 17:24:03,239 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:03,239 : INFO : Validation metrics:
2024-08-15 17:24:03,239 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:03,242 : INFO : Accuracy: 0.8681
2024-08-15 17:24:03,242 : INFO : Precision score for label_class 0: 0.7789
2024-08-15 17:24:03,242 : INFO : Precision score for label_class 1: 0.9338
2024-08-15 17:24:03,242 : INFO : Precision score for label_class 2: 0.7754
2024-08-15 17:24:03,242 : INFO : Recall score for label_class 0: 0.8605
2024-08-15 17:24:03,242 : INFO : Recall score for label_class 1: 0.8843
2024-08-15 17:24:03,242 : INFO : Recall score for label_class 2: 0.8333
2024-08-15 17:24:03,242 : INFO : Average F1 score: 0.8431
2024-08-15 17:24:03,242 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:24:03,242 : INFO : Starting epoch 6
2024-08-15 17:24:03,898 : INFO : Current training batch loss: 0.0111 in epoch 6
2024-08-15 17:24:04,715 : INFO : Current training batch loss: 0.0318 in epoch 6
2024-08-15 17:24:05,532 : INFO : Current training batch loss: 0.0094 in epoch 6
2024-08-15 17:24:06,390 : INFO : Current training batch loss: 0.0059 in epoch 6
2024-08-15 17:24:06,763 : INFO : Epoch finished, average loss over training batches: 0.0577
2024-08-15 17:24:06,763 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:06,763 : INFO : Training metrics:
2024-08-15 17:24:06,763 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:06,771 : INFO : Accuracy: 0.9844
2024-08-15 17:24:06,771 : INFO : Precision score for label_class 0: 0.9466
2024-08-15 17:24:06,771 : INFO : Precision score for label_class 1: 0.9931
2024-08-15 17:24:06,771 : INFO : Precision score for label_class 2: 0.9832
2024-08-15 17:24:06,771 : INFO : Recall score for label_class 0: 0.9726
2024-08-15 17:24:06,771 : INFO : Recall score for label_class 1: 0.9887
2024-08-15 17:24:06,771 : INFO : Recall score for label_class 2: 0.9806
2024-08-15 17:24:06,771 : INFO : Average F1 score: 0.9774
2024-08-15 17:24:07,238 : INFO : Average loss over validation batches: 0.4891
2024-08-15 17:24:07,238 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:07,238 : INFO : Validation metrics:
2024-08-15 17:24:07,238 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:07,241 : INFO : Accuracy: 0.8800
2024-08-15 17:24:07,241 : INFO : Precision score for label_class 0: 0.7812
2024-08-15 17:24:07,241 : INFO : Precision score for label_class 1: 0.8968
2024-08-15 17:24:07,241 : INFO : Precision score for label_class 2: 0.8951
2024-08-15 17:24:07,241 : INFO : Recall score for label_class 0: 0.8721
2024-08-15 17:24:07,241 : INFO : Recall score for label_class 1: 0.9422
2024-08-15 17:24:07,241 : INFO : Recall score for label_class 2: 0.7356
2024-08-15 17:24:07,241 : INFO : Average F1 score: 0.8502
2024-08-15 17:24:07,241 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:24:07,241 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:24:07,283 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:24:07,778 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:07,778 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:24:07,778 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:07,782 : INFO : Accuracy: 0.8696
2024-08-15 17:24:07,782 : INFO : Precision score for label_class 0: 0.8272
2024-08-15 17:24:07,782 : INFO : Precision score for label_class 1: 0.9150
2024-08-15 17:24:07,782 : INFO : Precision score for label_class 2: 0.7857
2024-08-15 17:24:07,782 : INFO : Recall score for label_class 0: 0.7791
2024-08-15 17:24:07,782 : INFO : Recall score for label_class 1: 0.9084
2024-08-15 17:24:07,782 : INFO : Recall score for label_class 2: 0.8218
2024-08-15 17:24:07,782 : INFO : Average F1 score: 0.8392
2024-08-15 17:24:07,782 : INFO : Determined score from best model, ending training.
2024-08-15 17:24:07,789 : INFO : Split 1 is finished, the score is: 0.8392
2024-08-15 17:24:07,789 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:07,789 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:07,789 : INFO : Starting training for split 2
2024-08-15 17:24:07,802 : INFO : Starting to tokenize the sequences.
2024-08-15 17:24:07,808 : INFO : Tokenization is finished.
2024-08-15 17:24:07,825 : INFO : Starting to tokenize the sequences.
2024-08-15 17:24:07,829 : INFO : Tokenization is finished.
2024-08-15 17:24:07,834 : INFO : Counting occurences of labels...
2024-08-15 17:24:07,835 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 343, 1601,  754]))
2024-08-15 17:24:07,835 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 71, 410, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:24:07,883 : INFO : Starting epoch 1
2024-08-15 17:24:07,935 : INFO : Current training batch loss: 1.0806 in epoch 1
2024-08-15 17:24:08,793 : INFO : Current training batch loss: 1.0194 in epoch 1
2024-08-15 17:24:09,646 : INFO : Current training batch loss: 0.9240 in epoch 1
2024-08-15 17:24:10,496 : INFO : Current training batch loss: 0.7314 in epoch 1
2024-08-15 17:24:11,329 : INFO : Current training batch loss: 0.6326 in epoch 1
2024-08-15 17:24:11,483 : INFO : Epoch finished, average loss over training batches: 0.8576
2024-08-15 17:24:11,483 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:11,484 : INFO : Training metrics:
2024-08-15 17:24:11,484 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:11,494 : INFO : Accuracy: 0.6338
2024-08-15 17:24:11,494 : INFO : Precision score for label_class 0: 0.6000
2024-08-15 17:24:11,494 : INFO : Precision score for label_class 1: 0.6770
2024-08-15 17:24:11,495 : INFO : Precision score for label_class 2: 0.4663
2024-08-15 17:24:11,495 : INFO : Recall score for label_class 0: 0.0175
2024-08-15 17:24:11,495 : INFO : Recall score for label_class 1: 0.9044
2024-08-15 17:24:11,495 : INFO : Recall score for label_class 2: 0.3395
2024-08-15 17:24:11,495 : INFO : Average F1 score: 0.4004
2024-08-15 17:24:11,961 : INFO : Average loss over validation batches: 0.5763
2024-08-15 17:24:11,961 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:11,961 : INFO : Validation metrics:
2024-08-15 17:24:11,961 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:11,964 : INFO : Accuracy: 0.7896
2024-08-15 17:24:11,964 : INFO : Precision score for label_class 0: 0.7647
2024-08-15 17:24:11,964 : INFO : Precision score for label_class 1: 0.8444
2024-08-15 17:24:11,965 : INFO : Precision score for label_class 2: 0.6731
2024-08-15 17:24:11,965 : INFO : Recall score for label_class 0: 0.1831
2024-08-15 17:24:11,965 : INFO : Recall score for label_class 1: 0.9268
2024-08-15 17:24:11,965 : INFO : Recall score for label_class 2: 0.7216
2024-08-15 17:24:11,965 : INFO : Average F1 score: 0.6252
2024-08-15 17:24:11,965 : INFO : Validation metric decreased (inf --> 0.576339).  Saving model ...
2024-08-15 17:24:12,064 : INFO : Starting epoch 2
2024-08-15 17:24:12,726 : INFO : Current training batch loss: 0.5325 in epoch 2
2024-08-15 17:24:13,567 : INFO : Current training batch loss: 0.5078 in epoch 2
2024-08-15 17:24:14,395 : INFO : Current training batch loss: 0.3797 in epoch 2
2024-08-15 17:24:15,253 : INFO : Current training batch loss: 0.3094 in epoch 2
2024-08-15 17:24:15,622 : INFO : Epoch finished, average loss over training batches: 0.4446
2024-08-15 17:24:15,622 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:15,622 : INFO : Training metrics:
2024-08-15 17:24:15,622 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:15,632 : INFO : Accuracy: 0.8451
2024-08-15 17:24:15,633 : INFO : Precision score for label_class 0: 0.7621
2024-08-15 17:24:15,633 : INFO : Precision score for label_class 1: 0.8800
2024-08-15 17:24:15,633 : INFO : Precision score for label_class 2: 0.7983
2024-08-15 17:24:15,633 : INFO : Recall score for label_class 0: 0.6910
2024-08-15 17:24:15,633 : INFO : Recall score for label_class 1: 0.9250
2024-08-15 17:24:15,633 : INFO : Recall score for label_class 2: 0.7454
2024-08-15 17:24:15,633 : INFO : Average F1 score: 0.7992
2024-08-15 17:24:16,100 : INFO : Average loss over validation batches: 0.4629
2024-08-15 17:24:16,100 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:16,100 : INFO : Validation metrics:
2024-08-15 17:24:16,100 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:16,103 : INFO : Accuracy: 0.8237
2024-08-15 17:24:16,103 : INFO : Precision score for label_class 0: 0.7833
2024-08-15 17:24:16,103 : INFO : Precision score for label_class 1: 0.9137
2024-08-15 17:24:16,103 : INFO : Precision score for label_class 2: 0.6967
2024-08-15 17:24:16,103 : INFO : Recall score for label_class 0: 0.6620
2024-08-15 17:24:16,103 : INFO : Recall score for label_class 1: 0.8268
2024-08-15 17:24:16,103 : INFO : Recall score for label_class 2: 0.8763
2024-08-15 17:24:16,103 : INFO : Average F1 score: 0.7873
2024-08-15 17:24:16,103 : INFO : Validation metric decreased (0.576339 --> 0.462880).  Saving model ...
2024-08-15 17:24:16,207 : INFO : Starting epoch 3
2024-08-15 17:24:16,684 : INFO : Current training batch loss: 0.1960 in epoch 3
2024-08-15 17:24:17,544 : INFO : Current training batch loss: 0.3190 in epoch 3
2024-08-15 17:24:18,380 : INFO : Current training batch loss: 0.2196 in epoch 3
2024-08-15 17:24:19,228 : INFO : Current training batch loss: 0.1733 in epoch 3
2024-08-15 17:24:19,804 : INFO : Epoch finished, average loss over training batches: 0.2420
2024-08-15 17:24:19,804 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:19,804 : INFO : Training metrics:
2024-08-15 17:24:19,804 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:19,812 : INFO : Accuracy: 0.9222
2024-08-15 17:24:19,812 : INFO : Precision score for label_class 0: 0.8269
2024-08-15 17:24:19,812 : INFO : Precision score for label_class 1: 0.9520
2024-08-15 17:24:19,812 : INFO : Precision score for label_class 2: 0.9042
2024-08-15 17:24:19,812 : INFO : Recall score for label_class 0: 0.8776
2024-08-15 17:24:19,812 : INFO : Recall score for label_class 1: 0.9532
2024-08-15 17:24:19,812 : INFO : Recall score for label_class 2: 0.8767
2024-08-15 17:24:19,812 : INFO : Average F1 score: 0.8981
2024-08-15 17:24:20,304 : INFO : Average loss over validation batches: 0.3921
2024-08-15 17:24:20,304 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:20,304 : INFO : Validation metrics:
2024-08-15 17:24:20,304 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:20,308 : INFO : Accuracy: 0.8578
2024-08-15 17:24:20,308 : INFO : Precision score for label_class 0: 0.7937
2024-08-15 17:24:20,308 : INFO : Precision score for label_class 1: 0.8881
2024-08-15 17:24:20,308 : INFO : Precision score for label_class 2: 0.8125
2024-08-15 17:24:20,308 : INFO : Recall score for label_class 0: 0.7042
2024-08-15 17:24:20,308 : INFO : Recall score for label_class 1: 0.9098
2024-08-15 17:24:20,308 : INFO : Recall score for label_class 2: 0.8041
2024-08-15 17:24:20,308 : INFO : Average F1 score: 0.8178
2024-08-15 17:24:20,308 : INFO : Validation metric decreased (0.462880 --> 0.392099).  Saving model ...
2024-08-15 17:24:20,409 : INFO : Starting epoch 4
2024-08-15 17:24:20,672 : INFO : Current training batch loss: 0.3016 in epoch 4
2024-08-15 17:24:21,536 : INFO : Current training batch loss: 0.0867 in epoch 4
2024-08-15 17:24:22,369 : INFO : Current training batch loss: 0.1210 in epoch 4
2024-08-15 17:24:23,193 : INFO : Current training batch loss: 0.1896 in epoch 4
2024-08-15 17:24:23,989 : INFO : Epoch finished, average loss over training batches: 0.1589
2024-08-15 17:24:23,990 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:23,990 : INFO : Training metrics:
2024-08-15 17:24:23,990 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:23,997 : INFO : Accuracy: 0.9540
2024-08-15 17:24:23,997 : INFO : Precision score for label_class 0: 0.8904
2024-08-15 17:24:23,997 : INFO : Precision score for label_class 1: 0.9772
2024-08-15 17:24:23,997 : INFO : Precision score for label_class 2: 0.9355
2024-08-15 17:24:23,997 : INFO : Recall score for label_class 0: 0.9242
2024-08-15 17:24:23,997 : INFO : Recall score for label_class 1: 0.9656
2024-08-15 17:24:23,997 : INFO : Recall score for label_class 2: 0.9430
2024-08-15 17:24:23,997 : INFO : Average F1 score: 0.9392
2024-08-15 17:24:24,465 : INFO : Average loss over validation batches: 0.4304
2024-08-15 17:24:24,465 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:24,465 : INFO : Validation metrics:
2024-08-15 17:24:24,465 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:24,468 : INFO : Accuracy: 0.8741
2024-08-15 17:24:24,468 : INFO : Precision score for label_class 0: 0.7821
2024-08-15 17:24:24,468 : INFO : Precision score for label_class 1: 0.8993
2024-08-15 17:24:24,468 : INFO : Precision score for label_class 2: 0.8556
2024-08-15 17:24:24,468 : INFO : Recall score for label_class 0: 0.8592
2024-08-15 17:24:24,468 : INFO : Recall score for label_class 1: 0.9146
2024-08-15 17:24:24,468 : INFO : Recall score for label_class 2: 0.7938
2024-08-15 17:24:24,468 : INFO : Average F1 score: 0.8497
2024-08-15 17:24:24,468 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:24:24,468 : INFO : Starting epoch 5
2024-08-15 17:24:24,519 : INFO : Current training batch loss: 0.0322 in epoch 5
2024-08-15 17:24:25,379 : INFO : Current training batch loss: 0.2149 in epoch 5
2024-08-15 17:24:26,213 : INFO : Current training batch loss: 0.0671 in epoch 5
2024-08-15 17:24:27,073 : INFO : Current training batch loss: 0.3326 in epoch 5
2024-08-15 17:24:27,934 : INFO : Current training batch loss: 0.0386 in epoch 5
2024-08-15 17:24:28,094 : INFO : Epoch finished, average loss over training batches: 0.1076
2024-08-15 17:24:28,095 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:28,095 : INFO : Training metrics:
2024-08-15 17:24:28,095 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:28,105 : INFO : Accuracy: 0.9707
2024-08-15 17:24:28,105 : INFO : Precision score for label_class 0: 0.9048
2024-08-15 17:24:28,105 : INFO : Precision score for label_class 1: 0.9875
2024-08-15 17:24:28,105 : INFO : Precision score for label_class 2: 0.9665
2024-08-15 17:24:28,105 : INFO : Recall score for label_class 0: 0.9417
2024-08-15 17:24:28,105 : INFO : Recall score for label_class 1: 0.9838
2024-08-15 17:24:28,105 : INFO : Recall score for label_class 2: 0.9562
2024-08-15 17:24:28,105 : INFO : Average F1 score: 0.9566
2024-08-15 17:24:28,573 : INFO : Average loss over validation batches: 0.5424
2024-08-15 17:24:28,573 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:28,573 : INFO : Validation metrics:
2024-08-15 17:24:28,573 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:28,576 : INFO : Accuracy: 0.8548
2024-08-15 17:24:28,576 : INFO : Precision score for label_class 0: 0.7867
2024-08-15 17:24:28,576 : INFO : Precision score for label_class 1: 0.9452
2024-08-15 17:24:28,576 : INFO : Precision score for label_class 2: 0.7362
2024-08-15 17:24:28,576 : INFO : Recall score for label_class 0: 0.8310
2024-08-15 17:24:28,576 : INFO : Recall score for label_class 1: 0.8415
2024-08-15 17:24:28,576 : INFO : Recall score for label_class 2: 0.8918
2024-08-15 17:24:28,577 : INFO : Average F1 score: 0.8350
2024-08-15 17:24:28,577 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:24:28,577 : INFO : Starting epoch 6
2024-08-15 17:24:29,267 : INFO : Current training batch loss: 0.0231 in epoch 6
2024-08-15 17:24:30,125 : INFO : Current training batch loss: 0.0131 in epoch 6
2024-08-15 17:24:30,985 : INFO : Current training batch loss: 0.0094 in epoch 6
2024-08-15 17:24:31,829 : INFO : Current training batch loss: 0.0110 in epoch 6
2024-08-15 17:24:32,195 : INFO : Epoch finished, average loss over training batches: 0.0761
2024-08-15 17:24:32,196 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:32,196 : INFO : Training metrics:
2024-08-15 17:24:32,196 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:32,203 : INFO : Accuracy: 0.9807
2024-08-15 17:24:32,203 : INFO : Precision score for label_class 0: 0.9322
2024-08-15 17:24:32,203 : INFO : Precision score for label_class 1: 0.9937
2024-08-15 17:24:32,203 : INFO : Precision score for label_class 2: 0.9761
2024-08-15 17:24:32,203 : INFO : Recall score for label_class 0: 0.9621
2024-08-15 17:24:32,203 : INFO : Recall score for label_class 1: 0.9875
2024-08-15 17:24:32,203 : INFO : Recall score for label_class 2: 0.9748
2024-08-15 17:24:32,203 : INFO : Average F1 score: 0.9710
2024-08-15 17:24:32,674 : INFO : Average loss over validation batches: 0.5658
2024-08-15 17:24:32,674 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:32,674 : INFO : Validation metrics:
2024-08-15 17:24:32,674 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:32,678 : INFO : Accuracy: 0.8741
2024-08-15 17:24:32,678 : INFO : Precision score for label_class 0: 0.8028
2024-08-15 17:24:32,678 : INFO : Precision score for label_class 1: 0.8851
2024-08-15 17:24:32,678 : INFO : Precision score for label_class 2: 0.8757
2024-08-15 17:24:32,678 : INFO : Recall score for label_class 0: 0.8028
2024-08-15 17:24:32,678 : INFO : Recall score for label_class 1: 0.9390
2024-08-15 17:24:32,678 : INFO : Recall score for label_class 2: 0.7629
2024-08-15 17:24:32,678 : INFO : Average F1 score: 0.8432
2024-08-15 17:24:32,678 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:24:32,678 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:24:32,712 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:24:33,209 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:33,209 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:24:33,209 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:33,213 : INFO : Accuracy: 0.8578
2024-08-15 17:24:33,213 : INFO : Precision score for label_class 0: 0.7937
2024-08-15 17:24:33,213 : INFO : Precision score for label_class 1: 0.8881
2024-08-15 17:24:33,213 : INFO : Precision score for label_class 2: 0.8125
2024-08-15 17:24:33,213 : INFO : Recall score for label_class 0: 0.7042
2024-08-15 17:24:33,213 : INFO : Recall score for label_class 1: 0.9098
2024-08-15 17:24:33,213 : INFO : Recall score for label_class 2: 0.8041
2024-08-15 17:24:33,213 : INFO : Average F1 score: 0.8178
2024-08-15 17:24:33,213 : INFO : Determined score from best model, ending training.
2024-08-15 17:24:33,215 : INFO : Split 2 is finished, the score is: 0.8178
2024-08-15 17:24:33,215 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:33,215 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:33,215 : INFO : Starting training for split 3
2024-08-15 17:24:33,228 : INFO : Starting to tokenize the sequences.
2024-08-15 17:24:33,234 : INFO : Tokenization is finished.
2024-08-15 17:24:33,250 : INFO : Starting to tokenize the sequences.
2024-08-15 17:24:33,255 : INFO : Tokenization is finished.
2024-08-15 17:24:33,260 : INFO : Counting occurences of labels...
2024-08-15 17:24:33,261 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1611,  759]))
2024-08-15 17:24:33,261 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 400, 189]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:24:33,304 : INFO : Starting epoch 1
2024-08-15 17:24:33,355 : INFO : Current training batch loss: 1.0940 in epoch 1
2024-08-15 17:24:34,178 : INFO : Current training batch loss: 1.0381 in epoch 1
2024-08-15 17:24:34,997 : INFO : Current training batch loss: 0.8578 in epoch 1
2024-08-15 17:24:35,815 : INFO : Current training batch loss: 0.8082 in epoch 1
2024-08-15 17:24:36,641 : INFO : Current training batch loss: 0.6043 in epoch 1
2024-08-15 17:24:36,794 : INFO : Epoch finished, average loss over training batches: 0.8516
2024-08-15 17:24:36,794 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:36,794 : INFO : Training metrics:
2024-08-15 17:24:36,794 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:36,799 : INFO : Accuracy: 0.6431
2024-08-15 17:24:36,799 : INFO : Precision score for label_class 0: 0.1856
2024-08-15 17:24:36,799 : INFO : Precision score for label_class 1: 0.6780
2024-08-15 17:24:36,799 : INFO : Precision score for label_class 2: 0.5684
2024-08-15 17:24:36,799 : INFO : Recall score for label_class 0: 0.0549
2024-08-15 17:24:36,799 : INFO : Recall score for label_class 1: 0.9162
2024-08-15 17:24:36,799 : INFO : Recall score for label_class 2: 0.3175
2024-08-15 17:24:36,799 : INFO : Average F1 score: 0.4238
2024-08-15 17:24:37,265 : INFO : Average loss over validation batches: 0.5709
2024-08-15 17:24:37,266 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:37,266 : INFO : Validation metrics:
2024-08-15 17:24:37,266 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:37,268 : INFO : Accuracy: 0.7941
2024-08-15 17:24:37,268 : INFO : Precision score for label_class 0: 0.7959
2024-08-15 17:24:37,268 : INFO : Precision score for label_class 1: 0.8901
2024-08-15 17:24:37,268 : INFO : Precision score for label_class 2: 0.6434
2024-08-15 17:24:37,268 : INFO : Recall score for label_class 0: 0.4535
2024-08-15 17:24:37,268 : INFO : Recall score for label_class 1: 0.8500
2024-08-15 17:24:37,268 : INFO : Recall score for label_class 2: 0.8307
2024-08-15 17:24:37,268 : INFO : Average F1 score: 0.7242
2024-08-15 17:24:37,268 : INFO : Validation metric decreased (inf --> 0.570868).  Saving model ...
2024-08-15 17:24:37,379 : INFO : Starting epoch 2
2024-08-15 17:24:38,052 : INFO : Current training batch loss: 0.5041 in epoch 2
2024-08-15 17:24:38,880 : INFO : Current training batch loss: 0.4011 in epoch 2
2024-08-15 17:24:39,710 : INFO : Current training batch loss: 0.3175 in epoch 2
2024-08-15 17:24:40,565 : INFO : Current training batch loss: 0.3795 in epoch 2
2024-08-15 17:24:40,934 : INFO : Epoch finished, average loss over training batches: 0.4272
2024-08-15 17:24:40,935 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:40,935 : INFO : Training metrics:
2024-08-15 17:24:40,935 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:40,939 : INFO : Accuracy: 0.8503
2024-08-15 17:24:40,939 : INFO : Precision score for label_class 0: 0.7774
2024-08-15 17:24:40,939 : INFO : Precision score for label_class 1: 0.8879
2024-08-15 17:24:40,939 : INFO : Precision score for label_class 2: 0.7965
2024-08-15 17:24:40,939 : INFO : Recall score for label_class 0: 0.7348
2024-08-15 17:24:40,939 : INFO : Recall score for label_class 1: 0.9100
2024-08-15 17:24:40,939 : INFO : Recall score for label_class 2: 0.7734
2024-08-15 17:24:40,939 : INFO : Average F1 score: 0.8130
2024-08-15 17:24:41,406 : INFO : Average loss over validation batches: 0.3885
2024-08-15 17:24:41,406 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:41,407 : INFO : Validation metrics:
2024-08-15 17:24:41,407 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:41,409 : INFO : Accuracy: 0.8578
2024-08-15 17:24:41,409 : INFO : Precision score for label_class 0: 0.8125
2024-08-15 17:24:41,409 : INFO : Precision score for label_class 1: 0.8959
2024-08-15 17:24:41,409 : INFO : Precision score for label_class 2: 0.7912
2024-08-15 17:24:41,409 : INFO : Recall score for label_class 0: 0.7558
2024-08-15 17:24:41,409 : INFO : Recall score for label_class 1: 0.9250
2024-08-15 17:24:41,409 : INFO : Recall score for label_class 2: 0.7619
2024-08-15 17:24:41,409 : INFO : Average F1 score: 0.8232
2024-08-15 17:24:41,409 : INFO : Validation metric decreased (0.570868 --> 0.388483).  Saving model ...
2024-08-15 17:24:41,511 : INFO : Starting epoch 3
2024-08-15 17:24:41,990 : INFO : Current training batch loss: 0.3292 in epoch 3
2024-08-15 17:24:42,851 : INFO : Current training batch loss: 0.2899 in epoch 3
2024-08-15 17:24:43,708 : INFO : Current training batch loss: 0.3840 in epoch 3
2024-08-15 17:24:44,547 : INFO : Current training batch loss: 0.1144 in epoch 3
2024-08-15 17:24:45,103 : INFO : Epoch finished, average loss over training batches: 0.2429
2024-08-15 17:24:45,103 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:45,103 : INFO : Training metrics:
2024-08-15 17:24:45,103 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:45,108 : INFO : Accuracy: 0.9296
2024-08-15 17:24:45,108 : INFO : Precision score for label_class 0: 0.8683
2024-08-15 17:24:45,108 : INFO : Precision score for label_class 1: 0.9484
2024-08-15 17:24:45,108 : INFO : Precision score for label_class 2: 0.9159
2024-08-15 17:24:45,108 : INFO : Recall score for label_class 0: 0.8841
2024-08-15 17:24:45,108 : INFO : Recall score for label_class 1: 0.9578
2024-08-15 17:24:45,108 : INFO : Recall score for label_class 2: 0.8893
2024-08-15 17:24:45,108 : INFO : Average F1 score: 0.9105
2024-08-15 17:24:45,578 : INFO : Average loss over validation batches: 0.4006
2024-08-15 17:24:45,578 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:45,578 : INFO : Validation metrics:
2024-08-15 17:24:45,578 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:45,581 : INFO : Accuracy: 0.8741
2024-08-15 17:24:45,581 : INFO : Precision score for label_class 0: 0.9028
2024-08-15 17:24:45,581 : INFO : Precision score for label_class 1: 0.9246
2024-08-15 17:24:45,581 : INFO : Precision score for label_class 2: 0.7659
2024-08-15 17:24:45,581 : INFO : Recall score for label_class 0: 0.7558
2024-08-15 17:24:45,581 : INFO : Recall score for label_class 1: 0.9200
2024-08-15 17:24:45,581 : INFO : Recall score for label_class 2: 0.8307
2024-08-15 17:24:45,581 : INFO : Average F1 score: 0.8473
2024-08-15 17:24:45,581 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:24:45,581 : INFO : Starting epoch 4
2024-08-15 17:24:45,836 : INFO : Current training batch loss: 0.2896 in epoch 4
2024-08-15 17:24:46,687 : INFO : Current training batch loss: 0.3525 in epoch 4
2024-08-15 17:24:47,550 : INFO : Current training batch loss: 0.1961 in epoch 4
2024-08-15 17:24:48,416 : INFO : Current training batch loss: 0.1626 in epoch 4
2024-08-15 17:24:49,218 : INFO : Epoch finished, average loss over training batches: 0.1467
2024-08-15 17:24:49,219 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:49,219 : INFO : Training metrics:
2024-08-15 17:24:49,219 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:49,226 : INFO : Accuracy: 0.9615
2024-08-15 17:24:49,226 : INFO : Precision score for label_class 0: 0.8892
2024-08-15 17:24:49,226 : INFO : Precision score for label_class 1: 0.9795
2024-08-15 17:24:49,226 : INFO : Precision score for label_class 2: 0.9558
2024-08-15 17:24:49,226 : INFO : Recall score for label_class 0: 0.9299
2024-08-15 17:24:49,226 : INFO : Recall score for label_class 1: 0.9777
2024-08-15 17:24:49,226 : INFO : Recall score for label_class 2: 0.9407
2024-08-15 17:24:49,226 : INFO : Average F1 score: 0.9453
2024-08-15 17:24:49,780 : INFO : Average loss over validation batches: 0.4747
2024-08-15 17:24:49,780 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:49,780 : INFO : Validation metrics:
2024-08-15 17:24:49,780 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:49,782 : INFO : Accuracy: 0.8459
2024-08-15 17:24:49,782 : INFO : Precision score for label_class 0: 0.7426
2024-08-15 17:24:49,782 : INFO : Precision score for label_class 1: 0.9186
2024-08-15 17:24:49,782 : INFO : Precision score for label_class 2: 0.7565
2024-08-15 17:24:49,782 : INFO : Recall score for label_class 0: 0.8721
2024-08-15 17:24:49,782 : INFO : Recall score for label_class 1: 0.8750
2024-08-15 17:24:49,782 : INFO : Recall score for label_class 2: 0.7725
2024-08-15 17:24:49,782 : INFO : Average F1 score: 0.8209
2024-08-15 17:24:49,782 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:24:49,782 : INFO : Starting epoch 5
2024-08-15 17:24:49,833 : INFO : Current training batch loss: 0.0334 in epoch 5
2024-08-15 17:24:50,697 : INFO : Current training batch loss: 0.2190 in epoch 5
2024-08-15 17:24:51,562 : INFO : Current training batch loss: 0.1137 in epoch 5
2024-08-15 17:24:52,391 : INFO : Current training batch loss: 0.0227 in epoch 5
2024-08-15 17:24:53,210 : INFO : Current training batch loss: 0.0092 in epoch 5
2024-08-15 17:24:53,362 : INFO : Epoch finished, average loss over training batches: 0.0947
2024-08-15 17:24:53,363 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:53,363 : INFO : Training metrics:
2024-08-15 17:24:53,363 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:53,370 : INFO : Accuracy: 0.9741
2024-08-15 17:24:53,370 : INFO : Precision score for label_class 0: 0.9333
2024-08-15 17:24:53,370 : INFO : Precision score for label_class 1: 0.9857
2024-08-15 17:24:53,370 : INFO : Precision score for label_class 2: 0.9669
2024-08-15 17:24:53,370 : INFO : Recall score for label_class 0: 0.9390
2024-08-15 17:24:53,370 : INFO : Recall score for label_class 1: 0.9870
2024-08-15 17:24:53,370 : INFO : Recall score for label_class 2: 0.9618
2024-08-15 17:24:53,370 : INFO : Average F1 score: 0.9623
2024-08-15 17:24:53,837 : INFO : Average loss over validation batches: 0.5305
2024-08-15 17:24:53,837 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:53,837 : INFO : Validation metrics:
2024-08-15 17:24:53,837 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:53,840 : INFO : Accuracy: 0.8711
2024-08-15 17:24:53,840 : INFO : Precision score for label_class 0: 0.8588
2024-08-15 17:24:53,840 : INFO : Precision score for label_class 1: 0.9123
2024-08-15 17:24:53,840 : INFO : Precision score for label_class 2: 0.7906
2024-08-15 17:24:53,840 : INFO : Recall score for label_class 0: 0.8488
2024-08-15 17:24:53,840 : INFO : Recall score for label_class 1: 0.9100
2024-08-15 17:24:53,840 : INFO : Recall score for label_class 2: 0.7989
2024-08-15 17:24:53,840 : INFO : Average F1 score: 0.8532
2024-08-15 17:24:53,840 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:24:53,840 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:24:53,877 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:24:54,377 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:54,377 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:24:54,377 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:54,380 : INFO : Accuracy: 0.8578
2024-08-15 17:24:54,380 : INFO : Precision score for label_class 0: 0.8125
2024-08-15 17:24:54,380 : INFO : Precision score for label_class 1: 0.8959
2024-08-15 17:24:54,380 : INFO : Precision score for label_class 2: 0.7912
2024-08-15 17:24:54,380 : INFO : Recall score for label_class 0: 0.7558
2024-08-15 17:24:54,380 : INFO : Recall score for label_class 1: 0.9250
2024-08-15 17:24:54,380 : INFO : Recall score for label_class 2: 0.7619
2024-08-15 17:24:54,380 : INFO : Average F1 score: 0.8232
2024-08-15 17:24:54,380 : INFO : Determined score from best model, ending training.
2024-08-15 17:24:54,381 : INFO : Split 3 is finished, the score is: 0.8232
2024-08-15 17:24:54,382 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:54,382 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:54,382 : INFO : Starting training for split 4
2024-08-15 17:24:54,401 : INFO : Starting to tokenize the sequences.
2024-08-15 17:24:54,407 : INFO : Tokenization is finished.
2024-08-15 17:24:54,423 : INFO : Starting to tokenize the sequences.
2024-08-15 17:24:54,428 : INFO : Tokenization is finished.
2024-08-15 17:24:54,433 : INFO : Counting occurences of labels...
2024-08-15 17:24:54,434 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 327, 1621,  751]))
2024-08-15 17:24:54,435 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 87, 390, 197]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:24:54,485 : INFO : Starting epoch 1
2024-08-15 17:24:54,537 : INFO : Current training batch loss: 1.0815 in epoch 1
2024-08-15 17:24:55,386 : INFO : Current training batch loss: 1.0378 in epoch 1
2024-08-15 17:24:56,244 : INFO : Current training batch loss: 0.8499 in epoch 1
2024-08-15 17:24:57,102 : INFO : Current training batch loss: 0.6824 in epoch 1
2024-08-15 17:24:57,954 : INFO : Current training batch loss: 0.6717 in epoch 1
2024-08-15 17:24:58,114 : INFO : Epoch finished, average loss over training batches: 0.8611
2024-08-15 17:24:58,114 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:58,114 : INFO : Training metrics:
2024-08-15 17:24:58,114 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:58,122 : INFO : Accuracy: 0.6588
2024-08-15 17:24:58,122 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:24:58,122 : INFO : Precision score for label_class 1: 0.6803
2024-08-15 17:24:58,122 : INFO : Precision score for label_class 2: 0.5383
2024-08-15 17:24:58,122 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:24:58,122 : INFO : Recall score for label_class 1: 0.9624
2024-08-15 17:24:58,122 : INFO : Recall score for label_class 2: 0.2903
2024-08-15 17:24:58,122 : INFO : Average F1 score: 0.3914
2024-08-15 17:24:58,588 : INFO : Average loss over validation batches: 0.7170
2024-08-15 17:24:58,588 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:58,588 : INFO : Validation metrics:
2024-08-15 17:24:58,588 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:24:58,591 : INFO : Accuracy: 0.6899
2024-08-15 17:24:58,591 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:24:58,591 : INFO : Precision score for label_class 1: 0.9279
2024-08-15 17:24:58,591 : INFO : Precision score for label_class 2: 0.4932
2024-08-15 17:24:58,591 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:24:58,591 : INFO : Recall score for label_class 1: 0.7256
2024-08-15 17:24:58,591 : INFO : Recall score for label_class 2: 0.9239
2024-08-15 17:24:58,591 : INFO : Average F1 score: 0.4858
2024-08-15 17:24:58,592 : INFO : Validation metric decreased (inf --> 0.717016).  Saving model ...
2024-08-15 17:24:58,697 : INFO : Starting epoch 2
2024-08-15 17:24:59,388 : INFO : Current training batch loss: 0.6343 in epoch 2
2024-08-15 17:25:00,234 : INFO : Current training batch loss: 0.4042 in epoch 2
2024-08-15 17:25:01,095 : INFO : Current training batch loss: 0.3214 in epoch 2
2024-08-15 17:25:01,955 : INFO : Current training batch loss: 0.3221 in epoch 2
2024-08-15 17:25:02,318 : INFO : Epoch finished, average loss over training batches: 0.4777
2024-08-15 17:25:02,318 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:02,318 : INFO : Training metrics:
2024-08-15 17:25:02,318 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:02,323 : INFO : Accuracy: 0.8214
2024-08-15 17:25:02,324 : INFO : Precision score for label_class 0: 0.7052
2024-08-15 17:25:02,324 : INFO : Precision score for label_class 1: 0.8793
2024-08-15 17:25:02,324 : INFO : Precision score for label_class 2: 0.7330
2024-08-15 17:25:02,324 : INFO : Recall score for label_class 0: 0.5780
2024-08-15 17:25:02,324 : INFO : Recall score for label_class 1: 0.9124
2024-08-15 17:25:02,324 : INFO : Recall score for label_class 2: 0.7310
2024-08-15 17:25:02,324 : INFO : Average F1 score: 0.7543
2024-08-15 17:25:02,789 : INFO : Average loss over validation batches: 0.3962
2024-08-15 17:25:02,789 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:02,789 : INFO : Validation metrics:
2024-08-15 17:25:02,789 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:02,793 : INFO : Accuracy: 0.8516
2024-08-15 17:25:02,793 : INFO : Precision score for label_class 0: 0.6822
2024-08-15 17:25:02,793 : INFO : Precision score for label_class 1: 0.8938
2024-08-15 17:25:02,793 : INFO : Precision score for label_class 2: 0.8580
2024-08-15 17:25:02,793 : INFO : Recall score for label_class 0: 0.8391
2024-08-15 17:25:02,793 : INFO : Recall score for label_class 1: 0.9282
2024-08-15 17:25:02,793 : INFO : Recall score for label_class 2: 0.7056
2024-08-15 17:25:02,793 : INFO : Average F1 score: 0.8125
2024-08-15 17:25:02,793 : INFO : Validation metric decreased (0.717016 --> 0.396215).  Saving model ...
2024-08-15 17:25:02,896 : INFO : Starting epoch 3
2024-08-15 17:25:03,372 : INFO : Current training batch loss: 0.1475 in epoch 3
2024-08-15 17:25:04,233 : INFO : Current training batch loss: 0.3069 in epoch 3
2024-08-15 17:25:05,087 : INFO : Current training batch loss: 0.1606 in epoch 3
2024-08-15 17:25:05,905 : INFO : Current training batch loss: 0.1828 in epoch 3
2024-08-15 17:25:06,460 : INFO : Epoch finished, average loss over training batches: 0.2563
2024-08-15 17:25:06,460 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:06,460 : INFO : Training metrics:
2024-08-15 17:25:06,460 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:06,464 : INFO : Accuracy: 0.9163
2024-08-15 17:25:06,464 : INFO : Precision score for label_class 0: 0.8353
2024-08-15 17:25:06,464 : INFO : Precision score for label_class 1: 0.9505
2024-08-15 17:25:06,464 : INFO : Precision score for label_class 2: 0.8789
2024-08-15 17:25:06,464 : INFO : Recall score for label_class 0: 0.8685
2024-08-15 17:25:06,464 : INFO : Recall score for label_class 1: 0.9476
2024-08-15 17:25:06,464 : INFO : Recall score for label_class 2: 0.8695
2024-08-15 17:25:06,464 : INFO : Average F1 score: 0.8916
2024-08-15 17:25:06,929 : INFO : Average loss over validation batches: 0.4450
2024-08-15 17:25:06,930 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:06,930 : INFO : Validation metrics:
2024-08-15 17:25:06,930 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:06,933 : INFO : Accuracy: 0.8457
2024-08-15 17:25:06,933 : INFO : Precision score for label_class 0: 0.7075
2024-08-15 17:25:06,933 : INFO : Precision score for label_class 1: 0.9074
2024-08-15 17:25:06,933 : INFO : Precision score for label_class 2: 0.8000
2024-08-15 17:25:06,933 : INFO : Recall score for label_class 0: 0.8621
2024-08-15 17:25:06,933 : INFO : Recall score for label_class 1: 0.8795
2024-08-15 17:25:06,933 : INFO : Recall score for label_class 2: 0.7716
2024-08-15 17:25:06,933 : INFO : Average F1 score: 0.8187
2024-08-15 17:25:06,933 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:25:06,933 : INFO : Starting epoch 4
2024-08-15 17:25:07,185 : INFO : Current training batch loss: 0.2857 in epoch 4
2024-08-15 17:25:08,002 : INFO : Current training batch loss: 0.1670 in epoch 4
2024-08-15 17:25:08,820 : INFO : Current training batch loss: 0.2981 in epoch 4
2024-08-15 17:25:09,637 : INFO : Current training batch loss: 0.1501 in epoch 4
2024-08-15 17:25:10,394 : INFO : Epoch finished, average loss over training batches: 0.1410
2024-08-15 17:25:10,394 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:10,394 : INFO : Training metrics:
2024-08-15 17:25:10,394 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:10,398 : INFO : Accuracy: 0.9607
2024-08-15 17:25:10,398 : INFO : Precision score for label_class 0: 0.8754
2024-08-15 17:25:10,398 : INFO : Precision score for label_class 1: 0.9814
2024-08-15 17:25:10,398 : INFO : Precision score for label_class 2: 0.9565
2024-08-15 17:25:10,398 : INFO : Recall score for label_class 0: 0.9450
2024-08-15 17:25:10,398 : INFO : Recall score for label_class 1: 0.9747
2024-08-15 17:25:10,398 : INFO : Recall score for label_class 2: 0.9374
2024-08-15 17:25:10,398 : INFO : Average F1 score: 0.9446
2024-08-15 17:25:10,863 : INFO : Average loss over validation batches: 0.5205
2024-08-15 17:25:10,863 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:10,863 : INFO : Validation metrics:
2024-08-15 17:25:10,863 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:10,866 : INFO : Accuracy: 0.8576
2024-08-15 17:25:10,866 : INFO : Precision score for label_class 0: 0.7212
2024-08-15 17:25:10,866 : INFO : Precision score for label_class 1: 0.9100
2024-08-15 17:25:10,866 : INFO : Precision score for label_class 2: 0.8232
2024-08-15 17:25:10,866 : INFO : Recall score for label_class 0: 0.8621
2024-08-15 17:25:10,866 : INFO : Recall score for label_class 1: 0.9077
2024-08-15 17:25:10,866 : INFO : Recall score for label_class 2: 0.7563
2024-08-15 17:25:10,866 : INFO : Average F1 score: 0.8275
2024-08-15 17:25:10,866 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:25:10,866 : INFO : Starting epoch 5
2024-08-15 17:25:10,917 : INFO : Current training batch loss: 0.0252 in epoch 5
2024-08-15 17:25:11,734 : INFO : Current training batch loss: 0.1133 in epoch 5
2024-08-15 17:25:12,552 : INFO : Current training batch loss: 0.0135 in epoch 5
2024-08-15 17:25:13,369 : INFO : Current training batch loss: 0.1185 in epoch 5
2024-08-15 17:25:14,200 : INFO : Current training batch loss: 0.1225 in epoch 5
2024-08-15 17:25:14,359 : INFO : Epoch finished, average loss over training batches: 0.1015
2024-08-15 17:25:14,360 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:14,360 : INFO : Training metrics:
2024-08-15 17:25:14,360 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:14,365 : INFO : Accuracy: 0.9704
2024-08-15 17:25:14,365 : INFO : Precision score for label_class 0: 0.9041
2024-08-15 17:25:14,365 : INFO : Precision score for label_class 1: 0.9846
2024-08-15 17:25:14,365 : INFO : Precision score for label_class 2: 0.9700
2024-08-15 17:25:14,365 : INFO : Recall score for label_class 0: 0.9511
2024-08-15 17:25:14,365 : INFO : Recall score for label_class 1: 0.9846
2024-08-15 17:25:14,365 : INFO : Recall score for label_class 2: 0.9481
2024-08-15 17:25:14,365 : INFO : Average F1 score: 0.9568
2024-08-15 17:25:14,843 : INFO : Average loss over validation batches: 0.5447
2024-08-15 17:25:14,843 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:14,843 : INFO : Validation metrics:
2024-08-15 17:25:14,843 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:14,847 : INFO : Accuracy: 0.8680
2024-08-15 17:25:14,847 : INFO : Precision score for label_class 0: 0.7400
2024-08-15 17:25:14,847 : INFO : Precision score for label_class 1: 0.9040
2024-08-15 17:25:14,847 : INFO : Precision score for label_class 2: 0.8596
2024-08-15 17:25:14,847 : INFO : Recall score for label_class 0: 0.8506
2024-08-15 17:25:14,847 : INFO : Recall score for label_class 1: 0.9179
2024-08-15 17:25:14,847 : INFO : Recall score for label_class 2: 0.7766
2024-08-15 17:25:14,847 : INFO : Average F1 score: 0.8395
2024-08-15 17:25:14,847 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:25:14,847 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:25:14,886 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:25:15,389 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:15,389 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:25:15,389 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:15,393 : INFO : Accuracy: 0.8516
2024-08-15 17:25:15,393 : INFO : Precision score for label_class 0: 0.6822
2024-08-15 17:25:15,393 : INFO : Precision score for label_class 1: 0.8938
2024-08-15 17:25:15,393 : INFO : Precision score for label_class 2: 0.8580
2024-08-15 17:25:15,393 : INFO : Recall score for label_class 0: 0.8391
2024-08-15 17:25:15,393 : INFO : Recall score for label_class 1: 0.9282
2024-08-15 17:25:15,393 : INFO : Recall score for label_class 2: 0.7056
2024-08-15 17:25:15,393 : INFO : Average F1 score: 0.8125
2024-08-15 17:25:15,393 : INFO : Determined score from best model, ending training.
2024-08-15 17:25:15,400 : INFO : Split 4 is finished, the score is: 0.8125
2024-08-15 17:25:15,400 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:15,400 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:15,400 : INFO : Starting training for split 5
2024-08-15 17:25:15,413 : INFO : Starting to tokenize the sequences.
2024-08-15 17:25:15,419 : INFO : Tokenization is finished.
2024-08-15 17:25:15,437 : INFO : Starting to tokenize the sequences.
2024-08-15 17:25:15,442 : INFO : Tokenization is finished.
2024-08-15 17:25:15,446 : INFO : Counting occurences of labels...
2024-08-15 17:25:15,447 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 330, 1615,  754]))
2024-08-15 17:25:15,447 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 84, 396, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:25:15,492 : INFO : Starting epoch 1
2024-08-15 17:25:15,544 : INFO : Current training batch loss: 1.1034 in epoch 1
2024-08-15 17:25:16,361 : INFO : Current training batch loss: 1.0361 in epoch 1
2024-08-15 17:25:17,179 : INFO : Current training batch loss: 0.8321 in epoch 1
2024-08-15 17:25:17,997 : INFO : Current training batch loss: 0.6709 in epoch 1
2024-08-15 17:25:18,814 : INFO : Current training batch loss: 0.6995 in epoch 1
2024-08-15 17:25:18,966 : INFO : Epoch finished, average loss over training batches: 0.8575
2024-08-15 17:25:18,967 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:18,967 : INFO : Training metrics:
2024-08-15 17:25:18,967 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:18,978 : INFO : Accuracy: 0.6332
2024-08-15 17:25:18,978 : INFO : Precision score for label_class 0: 0.1694
2024-08-15 17:25:18,978 : INFO : Precision score for label_class 1: 0.6930
2024-08-15 17:25:18,978 : INFO : Precision score for label_class 2: 0.5086
2024-08-15 17:25:18,978 : INFO : Recall score for label_class 0: 0.0636
2024-08-15 17:25:18,978 : INFO : Recall score for label_class 1: 0.8805
2024-08-15 17:25:18,978 : INFO : Recall score for label_class 2: 0.3528
2024-08-15 17:25:18,978 : INFO : Average F1 score: 0.4282
2024-08-15 17:25:19,447 : INFO : Average loss over validation batches: 0.5879
2024-08-15 17:25:19,448 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:19,448 : INFO : Validation metrics:
2024-08-15 17:25:19,448 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:19,451 : INFO : Accuracy: 0.7760
2024-08-15 17:25:19,451 : INFO : Precision score for label_class 0: 0.8750
2024-08-15 17:25:19,451 : INFO : Precision score for label_class 1: 0.8307
2024-08-15 17:25:19,451 : INFO : Precision score for label_class 2: 0.6439
2024-08-15 17:25:19,451 : INFO : Recall score for label_class 0: 0.3333
2024-08-15 17:25:19,451 : INFO : Recall score for label_class 1: 0.9167
2024-08-15 17:25:19,451 : INFO : Recall score for label_class 2: 0.6804
2024-08-15 17:25:19,451 : INFO : Average F1 score: 0.6720
2024-08-15 17:25:19,451 : INFO : Validation metric decreased (inf --> 0.587893).  Saving model ...
2024-08-15 17:25:19,551 : INFO : Starting epoch 2
2024-08-15 17:25:20,207 : INFO : Current training batch loss: 0.4765 in epoch 2
2024-08-15 17:25:21,024 : INFO : Current training batch loss: 0.3792 in epoch 2
2024-08-15 17:25:21,842 : INFO : Current training batch loss: 0.2479 in epoch 2
2024-08-15 17:25:22,659 : INFO : Current training batch loss: 0.4588 in epoch 2
2024-08-15 17:25:23,013 : INFO : Epoch finished, average loss over training batches: 0.4255
2024-08-15 17:25:23,013 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:23,013 : INFO : Training metrics:
2024-08-15 17:25:23,013 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:23,021 : INFO : Accuracy: 0.8536
2024-08-15 17:25:23,021 : INFO : Precision score for label_class 0: 0.7904
2024-08-15 17:25:23,021 : INFO : Precision score for label_class 1: 0.8832
2024-08-15 17:25:23,021 : INFO : Precision score for label_class 2: 0.8093
2024-08-15 17:25:23,021 : INFO : Recall score for label_class 0: 0.6970
2024-08-15 17:25:23,021 : INFO : Recall score for label_class 1: 0.9269
2024-08-15 17:25:23,021 : INFO : Recall score for label_class 2: 0.7653
2024-08-15 17:25:23,021 : INFO : Average F1 score: 0.8106
2024-08-15 17:25:23,488 : INFO : Average loss over validation batches: 0.4099
2024-08-15 17:25:23,488 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:23,488 : INFO : Validation metrics:
2024-08-15 17:25:23,488 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:23,491 : INFO : Accuracy: 0.8442
2024-08-15 17:25:23,491 : INFO : Precision score for label_class 0: 0.8615
2024-08-15 17:25:23,491 : INFO : Precision score for label_class 1: 0.8659
2024-08-15 17:25:23,491 : INFO : Precision score for label_class 2: 0.7880
2024-08-15 17:25:23,491 : INFO : Recall score for label_class 0: 0.6667
2024-08-15 17:25:23,491 : INFO : Recall score for label_class 1: 0.9293
2024-08-15 17:25:23,491 : INFO : Recall score for label_class 2: 0.7474
2024-08-15 17:25:23,491 : INFO : Average F1 score: 0.8051
2024-08-15 17:25:23,491 : INFO : Validation metric decreased (0.587893 --> 0.409881).  Saving model ...
2024-08-15 17:25:23,593 : INFO : Starting epoch 3
2024-08-15 17:25:24,048 : INFO : Current training batch loss: 0.1382 in epoch 3
2024-08-15 17:25:24,872 : INFO : Current training batch loss: 0.1294 in epoch 3
2024-08-15 17:25:25,689 : INFO : Current training batch loss: 0.1525 in epoch 3
2024-08-15 17:25:26,508 : INFO : Current training batch loss: 0.2395 in epoch 3
2024-08-15 17:25:27,073 : INFO : Epoch finished, average loss over training batches: 0.2339
2024-08-15 17:25:27,074 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:27,074 : INFO : Training metrics:
2024-08-15 17:25:27,074 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:27,081 : INFO : Accuracy: 0.9266
2024-08-15 17:25:27,081 : INFO : Precision score for label_class 0: 0.8788
2024-08-15 17:25:27,081 : INFO : Precision score for label_class 1: 0.9467
2024-08-15 17:25:27,081 : INFO : Precision score for label_class 2: 0.9035
2024-08-15 17:25:27,081 : INFO : Recall score for label_class 0: 0.8788
2024-08-15 17:25:27,081 : INFO : Recall score for label_class 1: 0.9573
2024-08-15 17:25:27,081 : INFO : Recall score for label_class 2: 0.8820
2024-08-15 17:25:27,081 : INFO : Average F1 score: 0.9078
2024-08-15 17:25:27,553 : INFO : Average loss over validation batches: 0.4188
2024-08-15 17:25:27,553 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:27,553 : INFO : Validation metrics:
2024-08-15 17:25:27,553 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:27,556 : INFO : Accuracy: 0.8561
2024-08-15 17:25:27,556 : INFO : Precision score for label_class 0: 0.7529
2024-08-15 17:25:27,556 : INFO : Precision score for label_class 1: 0.9217
2024-08-15 17:25:27,556 : INFO : Precision score for label_class 2: 0.7767
2024-08-15 17:25:27,556 : INFO : Recall score for label_class 0: 0.7619
2024-08-15 17:25:27,556 : INFO : Recall score for label_class 1: 0.8914
2024-08-15 17:25:27,557 : INFO : Recall score for label_class 2: 0.8247
2024-08-15 17:25:27,557 : INFO : Average F1 score: 0.8212
2024-08-15 17:25:27,557 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:25:27,557 : INFO : Starting epoch 4
2024-08-15 17:25:27,809 : INFO : Current training batch loss: 0.3046 in epoch 4
2024-08-15 17:25:28,632 : INFO : Current training batch loss: 0.3200 in epoch 4
2024-08-15 17:25:29,450 : INFO : Current training batch loss: 0.3156 in epoch 4
2024-08-15 17:25:30,268 : INFO : Current training batch loss: 0.1167 in epoch 4
2024-08-15 17:25:31,031 : INFO : Epoch finished, average loss over training batches: 0.1537
2024-08-15 17:25:31,032 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:31,032 : INFO : Training metrics:
2024-08-15 17:25:31,032 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:31,039 : INFO : Accuracy: 0.9578
2024-08-15 17:25:31,039 : INFO : Precision score for label_class 0: 0.9083
2024-08-15 17:25:31,039 : INFO : Precision score for label_class 1: 0.9676
2024-08-15 17:25:31,039 : INFO : Precision score for label_class 2: 0.9587
2024-08-15 17:25:31,039 : INFO : Recall score for label_class 0: 0.9303
2024-08-15 17:25:31,039 : INFO : Recall score for label_class 1: 0.9789
2024-08-15 17:25:31,039 : INFO : Recall score for label_class 2: 0.9244
2024-08-15 17:25:31,039 : INFO : Average F1 score: 0.9445
2024-08-15 17:25:31,510 : INFO : Average loss over validation batches: 0.4951
2024-08-15 17:25:31,511 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:31,511 : INFO : Validation metrics:
2024-08-15 17:25:31,511 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:31,515 : INFO : Accuracy: 0.8412
2024-08-15 17:25:31,515 : INFO : Precision score for label_class 0: 0.6869
2024-08-15 17:25:31,515 : INFO : Precision score for label_class 1: 0.8856
2024-08-15 17:25:31,515 : INFO : Precision score for label_class 2: 0.8266
2024-08-15 17:25:31,515 : INFO : Recall score for label_class 0: 0.8095
2024-08-15 17:25:31,515 : INFO : Recall score for label_class 1: 0.8990
2024-08-15 17:25:31,515 : INFO : Recall score for label_class 2: 0.7371
2024-08-15 17:25:31,515 : INFO : Average F1 score: 0.8049
2024-08-15 17:25:31,515 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:25:31,515 : INFO : Starting epoch 5
2024-08-15 17:25:31,565 : INFO : Current training batch loss: 0.0286 in epoch 5
2024-08-15 17:25:32,383 : INFO : Current training batch loss: 0.1357 in epoch 5
2024-08-15 17:25:33,201 : INFO : Current training batch loss: 0.0490 in epoch 5
2024-08-15 17:25:34,019 : INFO : Current training batch loss: 0.0739 in epoch 5
2024-08-15 17:25:34,837 : INFO : Current training batch loss: 0.0170 in epoch 5
2024-08-15 17:25:34,990 : INFO : Epoch finished, average loss over training batches: 0.0962
2024-08-15 17:25:34,990 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:34,990 : INFO : Training metrics:
2024-08-15 17:25:34,990 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:34,997 : INFO : Accuracy: 0.9737
2024-08-15 17:25:34,997 : INFO : Precision score for label_class 0: 0.9305
2024-08-15 17:25:34,997 : INFO : Precision score for label_class 1: 0.9852
2024-08-15 17:25:34,997 : INFO : Precision score for label_class 2: 0.9678
2024-08-15 17:25:34,997 : INFO : Recall score for label_class 0: 0.9333
2024-08-15 17:25:34,997 : INFO : Recall score for label_class 1: 0.9895
2024-08-15 17:25:34,997 : INFO : Recall score for label_class 2: 0.9576
2024-08-15 17:25:34,997 : INFO : Average F1 score: 0.9606
2024-08-15 17:25:35,466 : INFO : Average loss over validation batches: 0.5322
2024-08-15 17:25:35,466 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:35,466 : INFO : Validation metrics:
2024-08-15 17:25:35,466 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:35,469 : INFO : Accuracy: 0.8546
2024-08-15 17:25:35,469 : INFO : Precision score for label_class 0: 0.7391
2024-08-15 17:25:35,469 : INFO : Precision score for label_class 1: 0.9184
2024-08-15 17:25:35,469 : INFO : Precision score for label_class 2: 0.7871
2024-08-15 17:25:35,469 : INFO : Recall score for label_class 0: 0.8095
2024-08-15 17:25:35,469 : INFO : Recall score for label_class 1: 0.8813
2024-08-15 17:25:35,469 : INFO : Recall score for label_class 2: 0.8196
2024-08-15 17:25:35,469 : INFO : Average F1 score: 0.8251
2024-08-15 17:25:35,469 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:25:35,469 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:25:35,503 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:25:36,006 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:36,006 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:25:36,006 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:36,009 : INFO : Accuracy: 0.8442
2024-08-15 17:25:36,010 : INFO : Precision score for label_class 0: 0.8615
2024-08-15 17:25:36,010 : INFO : Precision score for label_class 1: 0.8659
2024-08-15 17:25:36,010 : INFO : Precision score for label_class 2: 0.7880
2024-08-15 17:25:36,010 : INFO : Recall score for label_class 0: 0.6667
2024-08-15 17:25:36,010 : INFO : Recall score for label_class 1: 0.9293
2024-08-15 17:25:36,010 : INFO : Recall score for label_class 2: 0.7474
2024-08-15 17:25:36,010 : INFO : Average F1 score: 0.8051
2024-08-15 17:25:36,010 : INFO : Determined score from best model, ending training.
2024-08-15 17:25:36,011 : INFO : Split 5 is finished, the score is: 0.8051
2024-08-15 17:25:36,011 : INFO : ----------------------------------------------------------------------------------------------------
[I 2024-08-15 17:25:36,021] Trial 10 finished with value: 0.8195636553659227 and parameters: {'n_epochs': 10, 'learning_rate': 9.844665295603803e-05, 'classifier_dropout': 0.8605833170132857, 'warmup_step_fraction': 0.0900864980248078, 'use_gradient_clipping': True}. Best is trial 1 with value: 0.8513001269595835.
2024-08-15 17:25:36,029 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:36,029 : INFO : Starting training for split 1
2024-08-15 17:25:36,041 : INFO : Starting to tokenize the sequences.
2024-08-15 17:25:36,046 : INFO : Tokenization is finished.
2024-08-15 17:25:36,059 : INFO : Starting to tokenize the sequences.
2024-08-15 17:25:36,064 : INFO : Tokenization is finished.
2024-08-15 17:25:36,064 : INFO : Counting occurences of labels...
2024-08-15 17:25:36,065 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1596,  774]))
2024-08-15 17:25:36,065 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 415, 174]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:25:36,108 : INFO : Starting epoch 1
2024-08-15 17:25:36,159 : INFO : Current training batch loss: 1.1023 in epoch 1
2024-08-15 17:25:36,979 : INFO : Current training batch loss: 0.9844 in epoch 1
2024-08-15 17:25:37,793 : INFO : Current training batch loss: 1.0045 in epoch 1
2024-08-15 17:25:38,608 : INFO : Current training batch loss: 0.7567 in epoch 1
2024-08-15 17:25:39,436 : INFO : Current training batch loss: 0.7811 in epoch 1
2024-08-15 17:25:39,582 : INFO : Epoch finished, average loss over training batches: 0.8936
2024-08-15 17:25:39,582 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:39,582 : INFO : Training metrics:
2024-08-15 17:25:39,582 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:39,592 : INFO : Accuracy: 0.6242
2024-08-15 17:25:39,592 : INFO : Precision score for label_class 0: 0.1709
2024-08-15 17:25:39,592 : INFO : Precision score for label_class 1: 0.6671
2024-08-15 17:25:39,592 : INFO : Precision score for label_class 2: 0.5478
2024-08-15 17:25:39,592 : INFO : Recall score for label_class 0: 0.0823
2024-08-15 17:25:39,592 : INFO : Recall score for label_class 1: 0.9305
2024-08-15 17:25:39,592 : INFO : Recall score for label_class 2: 0.2222
2024-08-15 17:25:39,592 : INFO : Average F1 score: 0.4015
2024-08-15 17:25:40,089 : INFO : Average loss over validation batches: 0.6837
2024-08-15 17:25:40,089 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:40,090 : INFO : Validation metrics:
2024-08-15 17:25:40,090 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:40,092 : INFO : Accuracy: 0.7185
2024-08-15 17:25:40,092 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:25:40,092 : INFO : Precision score for label_class 1: 0.8225
2024-08-15 17:25:40,092 : INFO : Precision score for label_class 2: 0.4930
2024-08-15 17:25:40,092 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:25:40,092 : INFO : Recall score for label_class 1: 0.9157
2024-08-15 17:25:40,092 : INFO : Recall score for label_class 2: 0.6034
2024-08-15 17:25:40,092 : INFO : Average F1 score: 0.4697
2024-08-15 17:25:40,092 : INFO : Validation metric decreased (inf --> 0.683676).  Saving model ...
2024-08-15 17:25:40,202 : INFO : Starting epoch 2
2024-08-15 17:25:40,853 : INFO : Current training batch loss: 0.4123 in epoch 2
2024-08-15 17:25:41,661 : INFO : Current training batch loss: 0.5982 in epoch 2
2024-08-15 17:25:42,470 : INFO : Current training batch loss: 0.3611 in epoch 2
2024-08-15 17:25:43,280 : INFO : Current training batch loss: 0.3244 in epoch 2
2024-08-15 17:25:43,622 : INFO : Epoch finished, average loss over training batches: 0.5069
2024-08-15 17:25:43,623 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:43,623 : INFO : Training metrics:
2024-08-15 17:25:43,623 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:43,630 : INFO : Accuracy: 0.8262
2024-08-15 17:25:43,630 : INFO : Precision score for label_class 0: 0.8019
2024-08-15 17:25:43,630 : INFO : Precision score for label_class 1: 0.8624
2024-08-15 17:25:43,630 : INFO : Precision score for label_class 2: 0.7490
2024-08-15 17:25:43,630 : INFO : Recall score for label_class 0: 0.5183
2024-08-15 17:25:43,630 : INFO : Recall score for label_class 1: 0.9386
2024-08-15 17:25:43,630 : INFO : Recall score for label_class 2: 0.7248
2024-08-15 17:25:43,630 : INFO : Average F1 score: 0.7551
2024-08-15 17:25:44,096 : INFO : Average loss over validation batches: 0.4067
2024-08-15 17:25:44,096 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:44,096 : INFO : Validation metrics:
2024-08-15 17:25:44,096 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:44,099 : INFO : Accuracy: 0.8578
2024-08-15 17:25:44,099 : INFO : Precision score for label_class 0: 0.7600
2024-08-15 17:25:44,099 : INFO : Precision score for label_class 1: 0.9301
2024-08-15 17:25:44,099 : INFO : Precision score for label_class 2: 0.7619
2024-08-15 17:25:44,099 : INFO : Recall score for label_class 0: 0.8837
2024-08-15 17:25:44,099 : INFO : Recall score for label_class 1: 0.8651
2024-08-15 17:25:44,099 : INFO : Recall score for label_class 2: 0.8276
2024-08-15 17:25:44,099 : INFO : Average F1 score: 0.8357
2024-08-15 17:25:44,099 : INFO : Validation metric decreased (0.683676 --> 0.406663).  Saving model ...
2024-08-15 17:25:44,201 : INFO : Starting epoch 3
2024-08-15 17:25:44,652 : INFO : Current training batch loss: 0.3154 in epoch 3
2024-08-15 17:25:45,461 : INFO : Current training batch loss: 0.3518 in epoch 3
2024-08-15 17:25:46,271 : INFO : Current training batch loss: 0.2452 in epoch 3
2024-08-15 17:25:47,080 : INFO : Current training batch loss: 0.1224 in epoch 3
2024-08-15 17:25:47,623 : INFO : Epoch finished, average loss over training batches: 0.2974
2024-08-15 17:25:47,624 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:47,624 : INFO : Training metrics:
2024-08-15 17:25:47,624 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:47,633 : INFO : Accuracy: 0.9107
2024-08-15 17:25:47,633 : INFO : Precision score for label_class 0: 0.8324
2024-08-15 17:25:47,633 : INFO : Precision score for label_class 1: 0.9358
2024-08-15 17:25:47,634 : INFO : Precision score for label_class 2: 0.8915
2024-08-15 17:25:47,634 : INFO : Recall score for label_class 0: 0.8628
2024-08-15 17:25:47,634 : INFO : Recall score for label_class 1: 0.9505
2024-08-15 17:25:47,634 : INFO : Recall score for label_class 2: 0.8488
2024-08-15 17:25:47,634 : INFO : Average F1 score: 0.8867
2024-08-15 17:25:48,102 : INFO : Average loss over validation batches: 0.3356
2024-08-15 17:25:48,102 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:48,102 : INFO : Validation metrics:
2024-08-15 17:25:48,102 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:48,105 : INFO : Accuracy: 0.8681
2024-08-15 17:25:48,105 : INFO : Precision score for label_class 0: 0.8111
2024-08-15 17:25:48,105 : INFO : Precision score for label_class 1: 0.9160
2024-08-15 17:25:48,105 : INFO : Precision score for label_class 2: 0.7889
2024-08-15 17:25:48,106 : INFO : Recall score for label_class 0: 0.8488
2024-08-15 17:25:48,106 : INFO : Recall score for label_class 1: 0.8940
2024-08-15 17:25:48,106 : INFO : Recall score for label_class 2: 0.8161
2024-08-15 17:25:48,106 : INFO : Average F1 score: 0.8456
2024-08-15 17:25:48,106 : INFO : Validation metric decreased (0.406663 --> 0.335589).  Saving model ...
2024-08-15 17:25:48,204 : INFO : Starting epoch 4
2024-08-15 17:25:48,455 : INFO : Current training batch loss: 0.4952 in epoch 4
2024-08-15 17:25:49,264 : INFO : Current training batch loss: 0.2112 in epoch 4
2024-08-15 17:25:50,073 : INFO : Current training batch loss: 0.3111 in epoch 4
2024-08-15 17:25:50,883 : INFO : Current training batch loss: 0.1588 in epoch 4
2024-08-15 17:25:51,625 : INFO : Epoch finished, average loss over training batches: 0.1921
2024-08-15 17:25:51,625 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:51,625 : INFO : Training metrics:
2024-08-15 17:25:51,625 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:51,632 : INFO : Accuracy: 0.9489
2024-08-15 17:25:51,632 : INFO : Precision score for label_class 0: 0.8873
2024-08-15 17:25:51,632 : INFO : Precision score for label_class 1: 0.9652
2024-08-15 17:25:51,632 : INFO : Precision score for label_class 2: 0.9423
2024-08-15 17:25:51,632 : INFO : Recall score for label_class 0: 0.9360
2024-08-15 17:25:51,632 : INFO : Recall score for label_class 1: 0.9718
2024-08-15 17:25:51,632 : INFO : Recall score for label_class 2: 0.9070
2024-08-15 17:25:51,632 : INFO : Average F1 score: 0.9346
2024-08-15 17:25:52,186 : INFO : Average loss over validation batches: 0.3459
2024-08-15 17:25:52,186 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:52,186 : INFO : Validation metrics:
2024-08-15 17:25:52,186 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:52,189 : INFO : Accuracy: 0.8800
2024-08-15 17:25:52,189 : INFO : Precision score for label_class 0: 0.7431
2024-08-15 17:25:52,189 : INFO : Precision score for label_class 1: 0.9553
2024-08-15 17:25:52,189 : INFO : Precision score for label_class 2: 0.8065
2024-08-15 17:25:52,189 : INFO : Recall score for label_class 0: 0.9419
2024-08-15 17:25:52,189 : INFO : Recall score for label_class 1: 0.8747
2024-08-15 17:25:52,189 : INFO : Recall score for label_class 2: 0.8621
2024-08-15 17:25:52,189 : INFO : Average F1 score: 0.8591
2024-08-15 17:25:52,189 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:25:52,189 : INFO : Starting epoch 5
2024-08-15 17:25:52,240 : INFO : Current training batch loss: 0.0570 in epoch 5
2024-08-15 17:25:53,050 : INFO : Current training batch loss: 0.2999 in epoch 5
2024-08-15 17:25:53,859 : INFO : Current training batch loss: 0.1655 in epoch 5
2024-08-15 17:25:54,669 : INFO : Current training batch loss: 0.1114 in epoch 5
2024-08-15 17:25:55,480 : INFO : Current training batch loss: 0.2744 in epoch 5
2024-08-15 17:25:55,622 : INFO : Epoch finished, average loss over training batches: 0.1374
2024-08-15 17:25:55,623 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:55,623 : INFO : Training metrics:
2024-08-15 17:25:55,623 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:55,629 : INFO : Accuracy: 0.9692
2024-08-15 17:25:55,629 : INFO : Precision score for label_class 0: 0.9157
2024-08-15 17:25:55,629 : INFO : Precision score for label_class 1: 0.9812
2024-08-15 17:25:55,629 : INFO : Precision score for label_class 2: 0.9683
2024-08-15 17:25:55,629 : INFO : Recall score for label_class 0: 0.9604
2024-08-15 17:25:55,629 : INFO : Recall score for label_class 1: 0.9812
2024-08-15 17:25:55,629 : INFO : Recall score for label_class 2: 0.9483
2024-08-15 17:25:55,629 : INFO : Average F1 score: 0.9590
2024-08-15 17:25:56,095 : INFO : Average loss over validation batches: 0.3188
2024-08-15 17:25:56,096 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:56,096 : INFO : Validation metrics:
2024-08-15 17:25:56,096 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:56,099 : INFO : Accuracy: 0.8889
2024-08-15 17:25:56,099 : INFO : Precision score for label_class 0: 0.8043
2024-08-15 17:25:56,099 : INFO : Precision score for label_class 1: 0.9072
2024-08-15 17:25:56,099 : INFO : Precision score for label_class 2: 0.8882
2024-08-15 17:25:56,099 : INFO : Recall score for label_class 0: 0.8605
2024-08-15 17:25:56,099 : INFO : Recall score for label_class 1: 0.9422
2024-08-15 17:25:56,099 : INFO : Recall score for label_class 2: 0.7759
2024-08-15 17:25:56,099 : INFO : Average F1 score: 0.8613
2024-08-15 17:25:56,099 : INFO : Validation metric decreased (0.335589 --> 0.318784).  Saving model ...
2024-08-15 17:25:56,200 : INFO : Starting epoch 6
2024-08-15 17:25:56,851 : INFO : Current training batch loss: 0.0377 in epoch 6
2024-08-15 17:25:57,660 : INFO : Current training batch loss: 0.0627 in epoch 6
2024-08-15 17:25:58,469 : INFO : Current training batch loss: 0.0435 in epoch 6
2024-08-15 17:25:59,279 : INFO : Current training batch loss: 0.0463 in epoch 6
2024-08-15 17:25:59,622 : INFO : Epoch finished, average loss over training batches: 0.1047
2024-08-15 17:25:59,622 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:59,622 : INFO : Training metrics:
2024-08-15 17:25:59,622 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:25:59,632 : INFO : Accuracy: 0.9781
2024-08-15 17:25:59,632 : INFO : Precision score for label_class 0: 0.9331
2024-08-15 17:25:59,632 : INFO : Precision score for label_class 1: 0.9862
2024-08-15 17:25:59,632 : INFO : Precision score for label_class 2: 0.9814
2024-08-15 17:25:59,632 : INFO : Recall score for label_class 0: 0.9787
2024-08-15 17:25:59,632 : INFO : Recall score for label_class 1: 0.9887
2024-08-15 17:25:59,632 : INFO : Recall score for label_class 2: 0.9561
2024-08-15 17:25:59,632 : INFO : Average F1 score: 0.9705
2024-08-15 17:26:00,100 : INFO : Average loss over validation batches: 0.3070
2024-08-15 17:26:00,101 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:00,101 : INFO : Validation metrics:
2024-08-15 17:26:00,101 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:00,104 : INFO : Accuracy: 0.8948
2024-08-15 17:26:00,104 : INFO : Precision score for label_class 0: 0.8065
2024-08-15 17:26:00,104 : INFO : Precision score for label_class 1: 0.9277
2024-08-15 17:26:00,104 : INFO : Precision score for label_class 2: 0.8623
2024-08-15 17:26:00,104 : INFO : Recall score for label_class 0: 0.8721
2024-08-15 17:26:00,104 : INFO : Recall score for label_class 1: 0.9277
2024-08-15 17:26:00,104 : INFO : Recall score for label_class 2: 0.8276
2024-08-15 17:26:00,104 : INFO : Average F1 score: 0.8701
2024-08-15 17:26:00,104 : INFO : Validation metric decreased (0.318784 --> 0.307022).  Saving model ...
2024-08-15 17:26:00,204 : INFO : Split 1 is finished, the score is: 0.8701
2024-08-15 17:26:00,204 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:00,204 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:00,204 : INFO : Starting training for split 2
2024-08-15 17:26:00,220 : INFO : Starting to tokenize the sequences.
2024-08-15 17:26:00,226 : INFO : Tokenization is finished.
2024-08-15 17:26:00,243 : INFO : Starting to tokenize the sequences.
2024-08-15 17:26:00,248 : INFO : Tokenization is finished.
2024-08-15 17:26:00,252 : INFO : Counting occurences of labels...
2024-08-15 17:26:00,253 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 343, 1601,  754]))
2024-08-15 17:26:00,254 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 71, 410, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:26:00,300 : INFO : Starting epoch 1
2024-08-15 17:26:00,351 : INFO : Current training batch loss: 1.0724 in epoch 1
2024-08-15 17:26:01,161 : INFO : Current training batch loss: 1.0286 in epoch 1
2024-08-15 17:26:01,971 : INFO : Current training batch loss: 0.9420 in epoch 1
2024-08-15 17:26:02,781 : INFO : Current training batch loss: 0.6796 in epoch 1
2024-08-15 17:26:03,591 : INFO : Current training batch loss: 0.7606 in epoch 1
2024-08-15 17:26:03,734 : INFO : Epoch finished, average loss over training batches: 0.8684
2024-08-15 17:26:03,734 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:03,734 : INFO : Training metrics:
2024-08-15 17:26:03,734 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:03,747 : INFO : Accuracy: 0.6520
2024-08-15 17:26:03,747 : INFO : Precision score for label_class 0: 0.4000
2024-08-15 17:26:03,747 : INFO : Precision score for label_class 1: 0.6704
2024-08-15 17:26:03,747 : INFO : Precision score for label_class 2: 0.5393
2024-08-15 17:26:03,747 : INFO : Recall score for label_class 0: 0.0058
2024-08-15 17:26:03,747 : INFO : Recall score for label_class 1: 0.9731
2024-08-15 17:26:03,747 : INFO : Recall score for label_class 2: 0.2639
2024-08-15 17:26:03,747 : INFO : Average F1 score: 0.3866
2024-08-15 17:26:04,215 : INFO : Average loss over validation batches: 0.6427
2024-08-15 17:26:04,215 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:04,215 : INFO : Validation metrics:
2024-08-15 17:26:04,215 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:04,218 : INFO : Accuracy: 0.7600
2024-08-15 17:26:04,218 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:26:04,218 : INFO : Precision score for label_class 1: 0.8681
2024-08-15 17:26:04,218 : INFO : Precision score for label_class 2: 0.5853
2024-08-15 17:26:04,218 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:26:04,218 : INFO : Recall score for label_class 1: 0.8829
2024-08-15 17:26:04,218 : INFO : Recall score for label_class 2: 0.7784
2024-08-15 17:26:04,218 : INFO : Average F1 score: 0.5145
2024-08-15 17:26:04,218 : INFO : Validation metric decreased (inf --> 0.642737).  Saving model ...
2024-08-15 17:26:04,320 : INFO : Starting epoch 2
2024-08-15 17:26:04,970 : INFO : Current training batch loss: 0.6532 in epoch 2
2024-08-15 17:26:05,779 : INFO : Current training batch loss: 0.5650 in epoch 2
2024-08-15 17:26:06,588 : INFO : Current training batch loss: 0.3793 in epoch 2
2024-08-15 17:26:07,398 : INFO : Current training batch loss: 0.4091 in epoch 2
2024-08-15 17:26:07,743 : INFO : Epoch finished, average loss over training batches: 0.4929
2024-08-15 17:26:07,743 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:07,743 : INFO : Training metrics:
2024-08-15 17:26:07,743 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:07,755 : INFO : Accuracy: 0.8336
2024-08-15 17:26:07,755 : INFO : Precision score for label_class 0: 0.7574
2024-08-15 17:26:07,755 : INFO : Precision score for label_class 1: 0.8730
2024-08-15 17:26:07,755 : INFO : Precision score for label_class 2: 0.7673
2024-08-15 17:26:07,755 : INFO : Recall score for label_class 0: 0.6006
2024-08-15 17:26:07,755 : INFO : Recall score for label_class 1: 0.9363
2024-08-15 17:26:07,755 : INFO : Recall score for label_class 2: 0.7215
2024-08-15 17:26:07,755 : INFO : Average F1 score: 0.7724
2024-08-15 17:26:08,221 : INFO : Average loss over validation batches: 0.3953
2024-08-15 17:26:08,221 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:08,221 : INFO : Validation metrics:
2024-08-15 17:26:08,221 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:08,225 : INFO : Accuracy: 0.8711
2024-08-15 17:26:08,225 : INFO : Precision score for label_class 0: 0.7397
2024-08-15 17:26:08,225 : INFO : Precision score for label_class 1: 0.8813
2024-08-15 17:26:08,225 : INFO : Precision score for label_class 2: 0.9024
2024-08-15 17:26:08,225 : INFO : Recall score for label_class 0: 0.7606
2024-08-15 17:26:08,225 : INFO : Recall score for label_class 1: 0.9415
2024-08-15 17:26:08,225 : INFO : Recall score for label_class 2: 0.7629
2024-08-15 17:26:08,225 : INFO : Average F1 score: 0.8291
2024-08-15 17:26:08,225 : INFO : Validation metric decreased (0.642737 --> 0.395294).  Saving model ...
2024-08-15 17:26:08,328 : INFO : Starting epoch 3
2024-08-15 17:26:08,781 : INFO : Current training batch loss: 0.3112 in epoch 3
2024-08-15 17:26:09,595 : INFO : Current training batch loss: 0.2944 in epoch 3
2024-08-15 17:26:10,411 : INFO : Current training batch loss: 0.3443 in epoch 3
2024-08-15 17:26:11,245 : INFO : Current training batch loss: 0.1925 in epoch 3
2024-08-15 17:26:11,798 : INFO : Epoch finished, average loss over training batches: 0.2831
2024-08-15 17:26:11,799 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:11,799 : INFO : Training metrics:
2024-08-15 17:26:11,799 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:11,806 : INFO : Accuracy: 0.9110
2024-08-15 17:26:11,806 : INFO : Precision score for label_class 0: 0.8296
2024-08-15 17:26:11,806 : INFO : Precision score for label_class 1: 0.9439
2024-08-15 17:26:11,806 : INFO : Precision score for label_class 2: 0.8791
2024-08-15 17:26:11,806 : INFO : Recall score for label_class 0: 0.8659
2024-08-15 17:26:11,806 : INFO : Recall score for label_class 1: 0.9457
2024-08-15 17:26:11,806 : INFO : Recall score for label_class 2: 0.8581
2024-08-15 17:26:11,806 : INFO : Average F1 score: 0.8869
2024-08-15 17:26:12,275 : INFO : Average loss over validation batches: 0.3684
2024-08-15 17:26:12,275 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:12,275 : INFO : Validation metrics:
2024-08-15 17:26:12,275 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:12,278 : INFO : Accuracy: 0.8622
2024-08-15 17:26:12,278 : INFO : Precision score for label_class 0: 0.7971
2024-08-15 17:26:12,278 : INFO : Precision score for label_class 1: 0.8881
2024-08-15 17:26:12,278 : INFO : Precision score for label_class 2: 0.8280
2024-08-15 17:26:12,278 : INFO : Recall score for label_class 0: 0.7746
2024-08-15 17:26:12,278 : INFO : Recall score for label_class 1: 0.9098
2024-08-15 17:26:12,278 : INFO : Recall score for label_class 2: 0.7938
2024-08-15 17:26:12,278 : INFO : Average F1 score: 0.8317
2024-08-15 17:26:12,278 : INFO : Validation metric decreased (0.395294 --> 0.368424).  Saving model ...
2024-08-15 17:26:12,380 : INFO : Starting epoch 4
2024-08-15 17:26:12,642 : INFO : Current training batch loss: 0.2991 in epoch 4
2024-08-15 17:26:13,457 : INFO : Current training batch loss: 0.1395 in epoch 4
2024-08-15 17:26:14,267 : INFO : Current training batch loss: 0.2516 in epoch 4
2024-08-15 17:26:15,077 : INFO : Current training batch loss: 0.1881 in epoch 4
2024-08-15 17:26:15,819 : INFO : Epoch finished, average loss over training batches: 0.1719
2024-08-15 17:26:15,820 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:15,820 : INFO : Training metrics:
2024-08-15 17:26:15,820 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:15,829 : INFO : Accuracy: 0.9540
2024-08-15 17:26:15,829 : INFO : Precision score for label_class 0: 0.8923
2024-08-15 17:26:15,829 : INFO : Precision score for label_class 1: 0.9694
2024-08-15 17:26:15,829 : INFO : Precision score for label_class 2: 0.9509
2024-08-15 17:26:15,829 : INFO : Recall score for label_class 0: 0.9417
2024-08-15 17:26:15,829 : INFO : Recall score for label_class 1: 0.9706
2024-08-15 17:26:15,829 : INFO : Recall score for label_class 2: 0.9244
2024-08-15 17:26:15,829 : INFO : Average F1 score: 0.9413
2024-08-15 17:26:16,297 : INFO : Average loss over validation batches: 0.4564
2024-08-15 17:26:16,297 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:16,297 : INFO : Validation metrics:
2024-08-15 17:26:16,297 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:16,300 : INFO : Accuracy: 0.8326
2024-08-15 17:26:16,300 : INFO : Precision score for label_class 0: 0.7439
2024-08-15 17:26:16,300 : INFO : Precision score for label_class 1: 0.9229
2024-08-15 17:26:16,300 : INFO : Precision score for label_class 2: 0.7217
2024-08-15 17:26:16,300 : INFO : Recall score for label_class 0: 0.8592
2024-08-15 17:26:16,300 : INFO : Recall score for label_class 1: 0.8171
2024-08-15 17:26:16,300 : INFO : Recall score for label_class 2: 0.8557
2024-08-15 17:26:16,300 : INFO : Average F1 score: 0.8157
2024-08-15 17:26:16,301 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:26:16,301 : INFO : Starting epoch 5
2024-08-15 17:26:16,351 : INFO : Current training batch loss: 0.0665 in epoch 5
2024-08-15 17:26:17,161 : INFO : Current training batch loss: 0.2805 in epoch 5
2024-08-15 17:26:17,971 : INFO : Current training batch loss: 0.1438 in epoch 5
2024-08-15 17:26:18,782 : INFO : Current training batch loss: 0.1196 in epoch 5
2024-08-15 17:26:19,594 : INFO : Current training batch loss: 0.2096 in epoch 5
2024-08-15 17:26:19,736 : INFO : Epoch finished, average loss over training batches: 0.1261
2024-08-15 17:26:19,737 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:19,737 : INFO : Training metrics:
2024-08-15 17:26:19,737 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:19,746 : INFO : Accuracy: 0.9685
2024-08-15 17:26:19,746 : INFO : Precision score for label_class 0: 0.9162
2024-08-15 17:26:19,746 : INFO : Precision score for label_class 1: 0.9819
2024-08-15 17:26:19,746 : INFO : Precision score for label_class 2: 0.9650
2024-08-15 17:26:19,746 : INFO : Recall score for label_class 0: 0.9563
2024-08-15 17:26:19,746 : INFO : Recall score for label_class 1: 0.9800
2024-08-15 17:26:19,746 : INFO : Recall score for label_class 2: 0.9496
2024-08-15 17:26:19,746 : INFO : Average F1 score: 0.9580
2024-08-15 17:26:20,213 : INFO : Average loss over validation batches: 0.4051
2024-08-15 17:26:20,213 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:20,213 : INFO : Validation metrics:
2024-08-15 17:26:20,213 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:20,217 : INFO : Accuracy: 0.8607
2024-08-15 17:26:20,217 : INFO : Precision score for label_class 0: 0.7500
2024-08-15 17:26:20,217 : INFO : Precision score for label_class 1: 0.8773
2024-08-15 17:26:20,217 : INFO : Precision score for label_class 2: 0.8712
2024-08-15 17:26:20,217 : INFO : Recall score for label_class 0: 0.8451
2024-08-15 17:26:20,217 : INFO : Recall score for label_class 1: 0.9244
2024-08-15 17:26:20,217 : INFO : Recall score for label_class 2: 0.7320
2024-08-15 17:26:20,217 : INFO : Average F1 score: 0.8302
2024-08-15 17:26:20,217 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:26:20,217 : INFO : Starting epoch 6
2024-08-15 17:26:20,867 : INFO : Current training batch loss: 0.0429 in epoch 6
2024-08-15 17:26:21,678 : INFO : Current training batch loss: 0.1475 in epoch 6
2024-08-15 17:26:22,487 : INFO : Current training batch loss: 0.0390 in epoch 6
2024-08-15 17:26:23,297 : INFO : Current training batch loss: 0.0440 in epoch 6
2024-08-15 17:26:23,640 : INFO : Epoch finished, average loss over training batches: 0.0906
2024-08-15 17:26:23,640 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:23,640 : INFO : Training metrics:
2024-08-15 17:26:23,640 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:23,649 : INFO : Accuracy: 0.9830
2024-08-15 17:26:23,649 : INFO : Precision score for label_class 0: 0.9412
2024-08-15 17:26:23,649 : INFO : Precision score for label_class 1: 0.9925
2024-08-15 17:26:23,649 : INFO : Precision score for label_class 2: 0.9826
2024-08-15 17:26:23,649 : INFO : Recall score for label_class 0: 0.9796
2024-08-15 17:26:23,649 : INFO : Recall score for label_class 1: 0.9888
2024-08-15 17:26:23,649 : INFO : Recall score for label_class 2: 0.9721
2024-08-15 17:26:23,649 : INFO : Average F1 score: 0.9760
2024-08-15 17:26:24,117 : INFO : Average loss over validation batches: 0.3966
2024-08-15 17:26:24,117 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:24,117 : INFO : Validation metrics:
2024-08-15 17:26:24,117 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:24,120 : INFO : Accuracy: 0.8696
2024-08-15 17:26:24,120 : INFO : Precision score for label_class 0: 0.7763
2024-08-15 17:26:24,120 : INFO : Precision score for label_class 1: 0.8988
2024-08-15 17:26:24,120 : INFO : Precision score for label_class 2: 0.8424
2024-08-15 17:26:24,120 : INFO : Recall score for label_class 0: 0.8310
2024-08-15 17:26:24,120 : INFO : Recall score for label_class 1: 0.9098
2024-08-15 17:26:24,120 : INFO : Recall score for label_class 2: 0.7990
2024-08-15 17:26:24,120 : INFO : Average F1 score: 0.8424
2024-08-15 17:26:24,120 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:26:24,120 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:26:24,152 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:26:24,651 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:24,651 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:26:24,651 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:24,654 : INFO : Accuracy: 0.8622
2024-08-15 17:26:24,654 : INFO : Precision score for label_class 0: 0.7971
2024-08-15 17:26:24,654 : INFO : Precision score for label_class 1: 0.8881
2024-08-15 17:26:24,654 : INFO : Precision score for label_class 2: 0.8280
2024-08-15 17:26:24,654 : INFO : Recall score for label_class 0: 0.7746
2024-08-15 17:26:24,654 : INFO : Recall score for label_class 1: 0.9098
2024-08-15 17:26:24,654 : INFO : Recall score for label_class 2: 0.7938
2024-08-15 17:26:24,654 : INFO : Average F1 score: 0.8317
2024-08-15 17:26:24,654 : INFO : Determined score from best model, ending training.
2024-08-15 17:26:24,656 : INFO : Split 2 is finished, the score is: 0.8317
2024-08-15 17:26:24,656 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:24,656 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:24,656 : INFO : Starting training for split 3
2024-08-15 17:26:24,674 : INFO : Starting to tokenize the sequences.
2024-08-15 17:26:24,680 : INFO : Tokenization is finished.
2024-08-15 17:26:24,698 : INFO : Starting to tokenize the sequences.
2024-08-15 17:26:24,702 : INFO : Tokenization is finished.
2024-08-15 17:26:24,707 : INFO : Counting occurences of labels...
2024-08-15 17:26:24,708 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1611,  759]))
2024-08-15 17:26:24,709 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 400, 189]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:26:24,755 : INFO : Starting epoch 1
2024-08-15 17:26:24,806 : INFO : Current training batch loss: 1.0939 in epoch 1
2024-08-15 17:26:25,617 : INFO : Current training batch loss: 1.0455 in epoch 1
2024-08-15 17:26:26,426 : INFO : Current training batch loss: 0.9003 in epoch 1
2024-08-15 17:26:27,237 : INFO : Current training batch loss: 0.7830 in epoch 1
2024-08-15 17:26:28,047 : INFO : Current training batch loss: 0.7330 in epoch 1
2024-08-15 17:26:28,190 : INFO : Epoch finished, average loss over training batches: 0.8942
2024-08-15 17:26:28,190 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:28,190 : INFO : Training metrics:
2024-08-15 17:26:28,190 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:28,196 : INFO : Accuracy: 0.6301
2024-08-15 17:26:28,196 : INFO : Precision score for label_class 0: 0.1961
2024-08-15 17:26:28,196 : INFO : Precision score for label_class 1: 0.6580
2024-08-15 17:26:28,196 : INFO : Precision score for label_class 2: 0.5059
2024-08-15 17:26:28,196 : INFO : Recall score for label_class 0: 0.0305
2024-08-15 17:26:28,196 : INFO : Recall score for label_class 1: 0.9423
2024-08-15 17:26:28,196 : INFO : Recall score for label_class 2: 0.2266
2024-08-15 17:26:28,196 : INFO : Average F1 score: 0.3802
2024-08-15 17:26:28,664 : INFO : Average loss over validation batches: 0.6473
2024-08-15 17:26:28,664 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:28,664 : INFO : Validation metrics:
2024-08-15 17:26:28,664 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:28,667 : INFO : Accuracy: 0.7319
2024-08-15 17:26:28,667 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:26:28,667 : INFO : Precision score for label_class 1: 0.8152
2024-08-15 17:26:28,667 : INFO : Precision score for label_class 2: 0.5535
2024-08-15 17:26:28,667 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:26:28,667 : INFO : Recall score for label_class 1: 0.9375
2024-08-15 17:26:28,667 : INFO : Recall score for label_class 2: 0.6296
2024-08-15 17:26:28,667 : INFO : Average F1 score: 0.4871
2024-08-15 17:26:28,667 : INFO : Validation metric decreased (inf --> 0.647285).  Saving model ...
2024-08-15 17:26:28,766 : INFO : Starting epoch 2
2024-08-15 17:26:29,417 : INFO : Current training batch loss: 0.6645 in epoch 2
2024-08-15 17:26:30,226 : INFO : Current training batch loss: 0.5493 in epoch 2
2024-08-15 17:26:31,036 : INFO : Current training batch loss: 0.4845 in epoch 2
2024-08-15 17:26:31,845 : INFO : Current training batch loss: 0.3411 in epoch 2
2024-08-15 17:26:32,188 : INFO : Epoch finished, average loss over training batches: 0.5320
2024-08-15 17:26:32,188 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:32,188 : INFO : Training metrics:
2024-08-15 17:26:32,188 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:32,194 : INFO : Accuracy: 0.8013
2024-08-15 17:26:32,194 : INFO : Precision score for label_class 0: 0.8017
2024-08-15 17:26:32,194 : INFO : Precision score for label_class 1: 0.8644
2024-08-15 17:26:32,194 : INFO : Precision score for label_class 2: 0.6699
2024-08-15 17:26:32,194 : INFO : Recall score for label_class 0: 0.2957
2024-08-15 17:26:32,194 : INFO : Recall score for label_class 1: 0.9342
2024-08-15 17:26:32,194 : INFO : Recall score for label_class 2: 0.7378
2024-08-15 17:26:32,194 : INFO : Average F1 score: 0.6774
2024-08-15 17:26:32,661 : INFO : Average loss over validation batches: 0.4134
2024-08-15 17:26:32,662 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:32,662 : INFO : Validation metrics:
2024-08-15 17:26:32,662 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:32,665 : INFO : Accuracy: 0.8593
2024-08-15 17:26:32,665 : INFO : Precision score for label_class 0: 0.7553
2024-08-15 17:26:32,665 : INFO : Precision score for label_class 1: 0.9005
2024-08-15 17:26:32,665 : INFO : Precision score for label_class 2: 0.8166
2024-08-15 17:26:32,665 : INFO : Recall score for label_class 0: 0.8256
2024-08-15 17:26:32,665 : INFO : Recall score for label_class 1: 0.9275
2024-08-15 17:26:32,665 : INFO : Recall score for label_class 2: 0.7302
2024-08-15 17:26:32,665 : INFO : Average F1 score: 0.8245
2024-08-15 17:26:32,665 : INFO : Validation metric decreased (0.647285 --> 0.413370).  Saving model ...
2024-08-15 17:26:32,768 : INFO : Starting epoch 3
2024-08-15 17:26:33,219 : INFO : Current training batch loss: 0.3087 in epoch 3
2024-08-15 17:26:34,029 : INFO : Current training batch loss: 0.4507 in epoch 3
2024-08-15 17:26:34,839 : INFO : Current training batch loss: 0.2462 in epoch 3
2024-08-15 17:26:35,649 : INFO : Current training batch loss: 0.1672 in epoch 3
2024-08-15 17:26:36,192 : INFO : Epoch finished, average loss over training batches: 0.2994
2024-08-15 17:26:36,192 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:36,192 : INFO : Training metrics:
2024-08-15 17:26:36,192 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:36,201 : INFO : Accuracy: 0.9062
2024-08-15 17:26:36,201 : INFO : Precision score for label_class 0: 0.8149
2024-08-15 17:26:36,201 : INFO : Precision score for label_class 1: 0.9394
2024-08-15 17:26:36,201 : INFO : Precision score for label_class 2: 0.8752
2024-08-15 17:26:36,201 : INFO : Recall score for label_class 0: 0.8323
2024-08-15 17:26:36,201 : INFO : Recall score for label_class 1: 0.9435
2024-08-15 17:26:36,201 : INFO : Recall score for label_class 2: 0.8590
2024-08-15 17:26:36,201 : INFO : Average F1 score: 0.8773
2024-08-15 17:26:36,670 : INFO : Average loss over validation batches: 0.3643
2024-08-15 17:26:36,670 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:36,670 : INFO : Validation metrics:
2024-08-15 17:26:36,670 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:36,673 : INFO : Accuracy: 0.8667
2024-08-15 17:26:36,673 : INFO : Precision score for label_class 0: 0.8111
2024-08-15 17:26:36,673 : INFO : Precision score for label_class 1: 0.9245
2024-08-15 17:26:36,673 : INFO : Precision score for label_class 2: 0.7811
2024-08-15 17:26:36,673 : INFO : Recall score for label_class 0: 0.8488
2024-08-15 17:26:36,673 : INFO : Recall score for label_class 1: 0.8875
2024-08-15 17:26:36,673 : INFO : Recall score for label_class 2: 0.8307
2024-08-15 17:26:36,673 : INFO : Average F1 score: 0.8468
2024-08-15 17:26:36,673 : INFO : Validation metric decreased (0.413370 --> 0.364288).  Saving model ...
2024-08-15 17:26:36,777 : INFO : Starting epoch 4
2024-08-15 17:26:37,028 : INFO : Current training batch loss: 0.4027 in epoch 4
2024-08-15 17:26:37,838 : INFO : Current training batch loss: 0.2011 in epoch 4
2024-08-15 17:26:38,648 : INFO : Current training batch loss: 0.2966 in epoch 4
2024-08-15 17:26:39,458 : INFO : Current training batch loss: 0.1186 in epoch 4
2024-08-15 17:26:40,200 : INFO : Epoch finished, average loss over training batches: 0.1676
2024-08-15 17:26:40,200 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:40,200 : INFO : Training metrics:
2024-08-15 17:26:40,200 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:40,206 : INFO : Accuracy: 0.9589
2024-08-15 17:26:40,206 : INFO : Precision score for label_class 0: 0.8847
2024-08-15 17:26:40,206 : INFO : Precision score for label_class 1: 0.9728
2024-08-15 17:26:40,206 : INFO : Precision score for label_class 2: 0.9632
2024-08-15 17:26:40,206 : INFO : Recall score for label_class 0: 0.9360
2024-08-15 17:26:40,206 : INFO : Recall score for label_class 1: 0.9770
2024-08-15 17:26:40,206 : INFO : Recall score for label_class 2: 0.9302
2024-08-15 17:26:40,206 : INFO : Average F1 score: 0.9436
2024-08-15 17:26:40,673 : INFO : Average loss over validation batches: 0.4203
2024-08-15 17:26:40,674 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:40,674 : INFO : Validation metrics:
2024-08-15 17:26:40,674 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:40,676 : INFO : Accuracy: 0.8430
2024-08-15 17:26:40,676 : INFO : Precision score for label_class 0: 0.7476
2024-08-15 17:26:40,676 : INFO : Precision score for label_class 1: 0.9408
2024-08-15 17:26:40,676 : INFO : Precision score for label_class 2: 0.7281
2024-08-15 17:26:40,676 : INFO : Recall score for label_class 0: 0.8953
2024-08-15 17:26:40,676 : INFO : Recall score for label_class 1: 0.8350
2024-08-15 17:26:40,676 : INFO : Recall score for label_class 2: 0.8360
2024-08-15 17:26:40,676 : INFO : Average F1 score: 0.8260
2024-08-15 17:26:40,676 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:26:40,676 : INFO : Starting epoch 5
2024-08-15 17:26:40,726 : INFO : Current training batch loss: 0.0852 in epoch 5
2024-08-15 17:26:41,536 : INFO : Current training batch loss: 0.2442 in epoch 5
2024-08-15 17:26:42,347 : INFO : Current training batch loss: 0.0426 in epoch 5
2024-08-15 17:26:43,158 : INFO : Current training batch loss: 0.1428 in epoch 5
2024-08-15 17:26:43,968 : INFO : Current training batch loss: 0.1731 in epoch 5
2024-08-15 17:26:44,111 : INFO : Epoch finished, average loss over training batches: 0.1270
2024-08-15 17:26:44,111 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:44,112 : INFO : Training metrics:
2024-08-15 17:26:44,112 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:44,120 : INFO : Accuracy: 0.9692
2024-08-15 17:26:44,120 : INFO : Precision score for label_class 0: 0.8997
2024-08-15 17:26:44,120 : INFO : Precision score for label_class 1: 0.9820
2024-08-15 17:26:44,120 : INFO : Precision score for label_class 2: 0.9741
2024-08-15 17:26:44,120 : INFO : Recall score for label_class 0: 0.9573
2024-08-15 17:26:44,120 : INFO : Recall score for label_class 1: 0.9839
2024-08-15 17:26:44,120 : INFO : Recall score for label_class 2: 0.9433
2024-08-15 17:26:44,120 : INFO : Average F1 score: 0.9564
2024-08-15 17:26:44,587 : INFO : Average loss over validation batches: 0.3848
2024-08-15 17:26:44,587 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:44,587 : INFO : Validation metrics:
2024-08-15 17:26:44,587 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:44,590 : INFO : Accuracy: 0.8800
2024-08-15 17:26:44,590 : INFO : Precision score for label_class 0: 0.8132
2024-08-15 17:26:44,590 : INFO : Precision score for label_class 1: 0.9017
2024-08-15 17:26:44,590 : INFO : Precision score for label_class 2: 0.8623
2024-08-15 17:26:44,590 : INFO : Recall score for label_class 0: 0.8605
2024-08-15 17:26:44,590 : INFO : Recall score for label_class 1: 0.9400
2024-08-15 17:26:44,590 : INFO : Recall score for label_class 2: 0.7619
2024-08-15 17:26:44,590 : INFO : Average F1 score: 0.8552
2024-08-15 17:26:44,590 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:26:44,590 : INFO : Starting epoch 6
2024-08-15 17:26:45,240 : INFO : Current training batch loss: 0.1774 in epoch 6
2024-08-15 17:26:46,050 : INFO : Current training batch loss: 0.0468 in epoch 6
2024-08-15 17:26:46,860 : INFO : Current training batch loss: 0.0475 in epoch 6
2024-08-15 17:26:47,671 : INFO : Current training batch loss: 0.0478 in epoch 6
2024-08-15 17:26:48,014 : INFO : Epoch finished, average loss over training batches: 0.0893
2024-08-15 17:26:48,014 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:48,014 : INFO : Training metrics:
2024-08-15 17:26:48,014 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:48,019 : INFO : Accuracy: 0.9815
2024-08-15 17:26:48,019 : INFO : Precision score for label_class 0: 0.9244
2024-08-15 17:26:48,019 : INFO : Precision score for label_class 1: 0.9913
2024-08-15 17:26:48,019 : INFO : Precision score for label_class 2: 0.9866
2024-08-15 17:26:48,019 : INFO : Recall score for label_class 0: 0.9695
2024-08-15 17:26:48,019 : INFO : Recall score for label_class 1: 0.9907
2024-08-15 17:26:48,019 : INFO : Recall score for label_class 2: 0.9671
2024-08-15 17:26:48,019 : INFO : Average F1 score: 0.9714
2024-08-15 17:26:48,485 : INFO : Average loss over validation batches: 0.3850
2024-08-15 17:26:48,486 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:48,486 : INFO : Validation metrics:
2024-08-15 17:26:48,486 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:48,488 : INFO : Accuracy: 0.8800
2024-08-15 17:26:48,488 : INFO : Precision score for label_class 0: 0.8315
2024-08-15 17:26:48,488 : INFO : Precision score for label_class 1: 0.9071
2024-08-15 17:26:48,488 : INFO : Precision score for label_class 2: 0.8418
2024-08-15 17:26:48,488 : INFO : Recall score for label_class 0: 0.8605
2024-08-15 17:26:48,488 : INFO : Recall score for label_class 1: 0.9275
2024-08-15 17:26:48,488 : INFO : Recall score for label_class 2: 0.7884
2024-08-15 17:26:48,488 : INFO : Average F1 score: 0.8590
2024-08-15 17:26:48,488 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:26:48,488 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:26:48,521 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:26:49,020 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:49,020 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:26:49,020 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:49,023 : INFO : Accuracy: 0.8667
2024-08-15 17:26:49,023 : INFO : Precision score for label_class 0: 0.8111
2024-08-15 17:26:49,023 : INFO : Precision score for label_class 1: 0.9245
2024-08-15 17:26:49,023 : INFO : Precision score for label_class 2: 0.7811
2024-08-15 17:26:49,023 : INFO : Recall score for label_class 0: 0.8488
2024-08-15 17:26:49,023 : INFO : Recall score for label_class 1: 0.8875
2024-08-15 17:26:49,023 : INFO : Recall score for label_class 2: 0.8307
2024-08-15 17:26:49,023 : INFO : Average F1 score: 0.8468
2024-08-15 17:26:49,023 : INFO : Determined score from best model, ending training.
2024-08-15 17:26:49,024 : INFO : Split 3 is finished, the score is: 0.8468
2024-08-15 17:26:49,024 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:49,024 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:49,024 : INFO : Starting training for split 4
2024-08-15 17:26:49,045 : INFO : Starting to tokenize the sequences.
2024-08-15 17:26:49,051 : INFO : Tokenization is finished.
2024-08-15 17:26:49,067 : INFO : Starting to tokenize the sequences.
2024-08-15 17:26:49,072 : INFO : Tokenization is finished.
2024-08-15 17:26:49,077 : INFO : Counting occurences of labels...
2024-08-15 17:26:49,078 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 327, 1621,  751]))
2024-08-15 17:26:49,078 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 87, 390, 197]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:26:49,130 : INFO : Starting epoch 1
2024-08-15 17:26:49,181 : INFO : Current training batch loss: 1.1226 in epoch 1
2024-08-15 17:26:49,992 : INFO : Current training batch loss: 1.0541 in epoch 1
2024-08-15 17:26:50,802 : INFO : Current training batch loss: 0.8986 in epoch 1
2024-08-15 17:26:51,611 : INFO : Current training batch loss: 0.7769 in epoch 1
2024-08-15 17:26:52,421 : INFO : Current training batch loss: 0.7530 in epoch 1
2024-08-15 17:26:52,564 : INFO : Epoch finished, average loss over training batches: 0.8959
2024-08-15 17:26:52,564 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:52,564 : INFO : Training metrics:
2024-08-15 17:26:52,564 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:52,573 : INFO : Accuracy: 0.5850
2024-08-15 17:26:52,573 : INFO : Precision score for label_class 0: 0.1420
2024-08-15 17:26:52,573 : INFO : Precision score for label_class 1: 0.6745
2024-08-15 17:26:52,573 : INFO : Precision score for label_class 2: 0.4892
2024-08-15 17:26:52,573 : INFO : Recall score for label_class 0: 0.1407
2024-08-15 17:26:52,573 : INFO : Recall score for label_class 1: 0.8334
2024-08-15 17:26:52,573 : INFO : Recall score for label_class 2: 0.2423
2024-08-15 17:26:52,573 : INFO : Average F1 score: 0.4037
2024-08-15 17:26:53,042 : INFO : Average loss over validation batches: 0.6919
2024-08-15 17:26:53,042 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:53,042 : INFO : Validation metrics:
2024-08-15 17:26:53,042 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:53,046 : INFO : Accuracy: 0.7433
2024-08-15 17:26:53,046 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:26:53,046 : INFO : Precision score for label_class 1: 0.8421
2024-08-15 17:26:53,046 : INFO : Precision score for label_class 2: 0.5820
2024-08-15 17:26:53,046 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:26:53,046 : INFO : Recall score for label_class 1: 0.9026
2024-08-15 17:26:53,046 : INFO : Recall score for label_class 2: 0.7563
2024-08-15 17:26:53,046 : INFO : Average F1 score: 0.5097
2024-08-15 17:26:53,046 : INFO : Validation metric decreased (inf --> 0.691885).  Saving model ...
2024-08-15 17:26:53,156 : INFO : Starting epoch 2
2024-08-15 17:26:53,806 : INFO : Current training batch loss: 0.6652 in epoch 2
2024-08-15 17:26:54,616 : INFO : Current training batch loss: 0.4874 in epoch 2
2024-08-15 17:26:55,426 : INFO : Current training batch loss: 0.3831 in epoch 2
2024-08-15 17:26:56,236 : INFO : Current training batch loss: 0.3709 in epoch 2
2024-08-15 17:26:56,579 : INFO : Epoch finished, average loss over training batches: 0.5221
2024-08-15 17:26:56,579 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:56,579 : INFO : Training metrics:
2024-08-15 17:26:56,579 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:56,586 : INFO : Accuracy: 0.8214
2024-08-15 17:26:56,586 : INFO : Precision score for label_class 0: 0.8057
2024-08-15 17:26:56,586 : INFO : Precision score for label_class 1: 0.8696
2024-08-15 17:26:56,586 : INFO : Precision score for label_class 2: 0.7161
2024-08-15 17:26:56,586 : INFO : Recall score for label_class 0: 0.4312
2024-08-15 17:26:56,586 : INFO : Recall score for label_class 1: 0.9383
2024-08-15 17:26:56,586 : INFO : Recall score for label_class 2: 0.7390
2024-08-15 17:26:56,586 : INFO : Average F1 score: 0.7306
2024-08-15 17:26:57,055 : INFO : Average loss over validation batches: 0.4241
2024-08-15 17:26:57,055 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:57,056 : INFO : Validation metrics:
2024-08-15 17:26:57,056 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:26:57,059 : INFO : Accuracy: 0.8472
2024-08-15 17:26:57,059 : INFO : Precision score for label_class 0: 0.6900
2024-08-15 17:26:57,059 : INFO : Precision score for label_class 1: 0.8706
2024-08-15 17:26:57,059 : INFO : Precision score for label_class 2: 0.8859
2024-08-15 17:26:57,059 : INFO : Recall score for label_class 0: 0.7931
2024-08-15 17:26:57,059 : INFO : Recall score for label_class 1: 0.9487
2024-08-15 17:26:57,059 : INFO : Recall score for label_class 2: 0.6701
2024-08-15 17:26:57,059 : INFO : Average F1 score: 0.8030
2024-08-15 17:26:57,059 : INFO : Validation metric decreased (0.691885 --> 0.424086).  Saving model ...
2024-08-15 17:26:57,163 : INFO : Starting epoch 3
2024-08-15 17:26:57,613 : INFO : Current training batch loss: 0.3249 in epoch 3
2024-08-15 17:26:58,423 : INFO : Current training batch loss: 0.2682 in epoch 3
2024-08-15 17:26:59,310 : INFO : Current training batch loss: 0.2478 in epoch 3
2024-08-15 17:27:00,120 : INFO : Current training batch loss: 0.1942 in epoch 3
2024-08-15 17:27:00,662 : INFO : Epoch finished, average loss over training batches: 0.2893
2024-08-15 17:27:00,662 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:00,662 : INFO : Training metrics:
2024-08-15 17:27:00,662 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:00,671 : INFO : Accuracy: 0.9114
2024-08-15 17:27:00,671 : INFO : Precision score for label_class 0: 0.8299
2024-08-15 17:27:00,671 : INFO : Precision score for label_class 1: 0.9394
2024-08-15 17:27:00,671 : INFO : Precision score for label_class 2: 0.8863
2024-08-15 17:27:00,671 : INFO : Recall score for label_class 0: 0.8502
2024-08-15 17:27:00,671 : INFO : Recall score for label_class 1: 0.9469
2024-08-15 17:27:00,671 : INFO : Recall score for label_class 2: 0.8615
2024-08-15 17:27:00,672 : INFO : Average F1 score: 0.8856
2024-08-15 17:27:01,138 : INFO : Average loss over validation batches: 0.3701
2024-08-15 17:27:01,139 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:01,139 : INFO : Validation metrics:
2024-08-15 17:27:01,139 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:01,142 : INFO : Accuracy: 0.8724
2024-08-15 17:27:01,142 : INFO : Precision score for label_class 0: 0.8182
2024-08-15 17:27:01,142 : INFO : Precision score for label_class 1: 0.9188
2024-08-15 17:27:01,142 : INFO : Precision score for label_class 2: 0.8088
2024-08-15 17:27:01,142 : INFO : Recall score for label_class 0: 0.8276
2024-08-15 17:27:01,143 : INFO : Recall score for label_class 1: 0.9000
2024-08-15 17:27:01,143 : INFO : Recall score for label_class 2: 0.8376
2024-08-15 17:27:01,143 : INFO : Average F1 score: 0.8517
2024-08-15 17:27:01,143 : INFO : Validation metric decreased (0.424086 --> 0.370133).  Saving model ...
2024-08-15 17:27:01,247 : INFO : Starting epoch 4
2024-08-15 17:27:01,497 : INFO : Current training batch loss: 0.3413 in epoch 4
2024-08-15 17:27:02,308 : INFO : Current training batch loss: 0.2724 in epoch 4
2024-08-15 17:27:03,117 : INFO : Current training batch loss: 0.1593 in epoch 4
2024-08-15 17:27:03,927 : INFO : Current training batch loss: 0.1458 in epoch 4
2024-08-15 17:27:04,669 : INFO : Epoch finished, average loss over training batches: 0.1721
2024-08-15 17:27:04,669 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:04,669 : INFO : Training metrics:
2024-08-15 17:27:04,670 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:04,675 : INFO : Accuracy: 0.9548
2024-08-15 17:27:04,675 : INFO : Precision score for label_class 0: 0.8860
2024-08-15 17:27:04,675 : INFO : Precision score for label_class 1: 0.9735
2024-08-15 17:27:04,675 : INFO : Precision score for label_class 2: 0.9457
2024-08-15 17:27:04,675 : INFO : Recall score for label_class 0: 0.9266
2024-08-15 17:27:04,675 : INFO : Recall score for label_class 1: 0.9729
2024-08-15 17:27:04,675 : INFO : Recall score for label_class 2: 0.9281
2024-08-15 17:27:04,675 : INFO : Average F1 score: 0.9386
2024-08-15 17:27:05,143 : INFO : Average loss over validation batches: 0.3660
2024-08-15 17:27:05,144 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:05,144 : INFO : Validation metrics:
2024-08-15 17:27:05,144 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:05,147 : INFO : Accuracy: 0.8694
2024-08-15 17:27:05,147 : INFO : Precision score for label_class 0: 0.7196
2024-08-15 17:27:05,147 : INFO : Precision score for label_class 1: 0.9309
2024-08-15 17:27:05,147 : INFO : Precision score for label_class 2: 0.8325
2024-08-15 17:27:05,147 : INFO : Recall score for label_class 0: 0.8851
2024-08-15 17:27:05,147 : INFO : Recall score for label_class 1: 0.8974
2024-08-15 17:27:05,147 : INFO : Recall score for label_class 2: 0.8071
2024-08-15 17:27:05,147 : INFO : Average F1 score: 0.8424
2024-08-15 17:27:05,147 : INFO : Validation metric decreased (0.370133 --> 0.365992).  Saving model ...
2024-08-15 17:27:05,248 : INFO : Starting epoch 5
2024-08-15 17:27:05,299 : INFO : Current training batch loss: 0.1187 in epoch 5
2024-08-15 17:27:06,109 : INFO : Current training batch loss: 0.1349 in epoch 5
2024-08-15 17:27:06,918 : INFO : Current training batch loss: 0.0462 in epoch 5
2024-08-15 17:27:07,728 : INFO : Current training batch loss: 0.0815 in epoch 5
2024-08-15 17:27:08,538 : INFO : Current training batch loss: 0.3196 in epoch 5
2024-08-15 17:27:08,689 : INFO : Epoch finished, average loss over training batches: 0.1201
2024-08-15 17:27:08,689 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:08,690 : INFO : Training metrics:
2024-08-15 17:27:08,690 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:08,695 : INFO : Accuracy: 0.9700
2024-08-15 17:27:08,695 : INFO : Precision score for label_class 0: 0.9147
2024-08-15 17:27:08,695 : INFO : Precision score for label_class 1: 0.9827
2024-08-15 17:27:08,695 : INFO : Precision score for label_class 2: 0.9676
2024-08-15 17:27:08,695 : INFO : Recall score for label_class 0: 0.9511
2024-08-15 17:27:08,695 : INFO : Recall score for label_class 1: 0.9809
2024-08-15 17:27:08,695 : INFO : Recall score for label_class 2: 0.9547
2024-08-15 17:27:08,695 : INFO : Average F1 score: 0.9585
2024-08-15 17:27:09,163 : INFO : Average loss over validation batches: 0.3959
2024-08-15 17:27:09,163 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:09,163 : INFO : Validation metrics:
2024-08-15 17:27:09,163 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:09,166 : INFO : Accuracy: 0.8709
2024-08-15 17:27:09,166 : INFO : Precision score for label_class 0: 0.7935
2024-08-15 17:27:09,166 : INFO : Precision score for label_class 1: 0.8955
2024-08-15 17:27:09,166 : INFO : Precision score for label_class 2: 0.8556
2024-08-15 17:27:09,166 : INFO : Recall score for label_class 0: 0.8391
2024-08-15 17:27:09,166 : INFO : Recall score for label_class 1: 0.9231
2024-08-15 17:27:09,166 : INFO : Recall score for label_class 2: 0.7817
2024-08-15 17:27:09,166 : INFO : Average F1 score: 0.8472
2024-08-15 17:27:09,166 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:27:09,166 : INFO : Starting epoch 6
2024-08-15 17:27:09,820 : INFO : Current training batch loss: 0.0424 in epoch 6
2024-08-15 17:27:10,635 : INFO : Current training batch loss: 0.1099 in epoch 6
2024-08-15 17:27:11,451 : INFO : Current training batch loss: 0.0472 in epoch 6
2024-08-15 17:27:12,267 : INFO : Current training batch loss: 0.0440 in epoch 6
2024-08-15 17:27:12,619 : INFO : Epoch finished, average loss over training batches: 0.0852
2024-08-15 17:27:12,619 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:12,619 : INFO : Training metrics:
2024-08-15 17:27:12,619 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:12,626 : INFO : Accuracy: 0.9833
2024-08-15 17:27:12,626 : INFO : Precision score for label_class 0: 0.9514
2024-08-15 17:27:12,626 : INFO : Precision score for label_class 1: 0.9914
2024-08-15 17:27:12,626 : INFO : Precision score for label_class 2: 0.9800
2024-08-15 17:27:12,626 : INFO : Recall score for label_class 0: 0.9572
2024-08-15 17:27:12,626 : INFO : Recall score for label_class 1: 0.9914
2024-08-15 17:27:12,626 : INFO : Recall score for label_class 2: 0.9774
2024-08-15 17:27:12,626 : INFO : Average F1 score: 0.9748
2024-08-15 17:27:13,094 : INFO : Average loss over validation batches: 0.3916
2024-08-15 17:27:13,095 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:13,095 : INFO : Validation metrics:
2024-08-15 17:27:13,095 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:13,098 : INFO : Accuracy: 0.8724
2024-08-15 17:27:13,098 : INFO : Precision score for label_class 0: 0.8068
2024-08-15 17:27:13,098 : INFO : Precision score for label_class 1: 0.9040
2024-08-15 17:27:13,098 : INFO : Precision score for label_class 2: 0.8368
2024-08-15 17:27:13,098 : INFO : Recall score for label_class 0: 0.8161
2024-08-15 17:27:13,098 : INFO : Recall score for label_class 1: 0.9179
2024-08-15 17:27:13,098 : INFO : Recall score for label_class 2: 0.8071
2024-08-15 17:27:13,098 : INFO : Average F1 score: 0.8480
2024-08-15 17:27:13,098 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:27:13,098 : INFO : Last epoch reached, validation loss was better before, loading best model during training.
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:27:13,138 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:27:13,640 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:13,640 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:27:13,640 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:13,643 : INFO : Accuracy: 0.8694
2024-08-15 17:27:13,643 : INFO : Precision score for label_class 0: 0.7196
2024-08-15 17:27:13,643 : INFO : Precision score for label_class 1: 0.9309
2024-08-15 17:27:13,643 : INFO : Precision score for label_class 2: 0.8325
2024-08-15 17:27:13,643 : INFO : Recall score for label_class 0: 0.8851
2024-08-15 17:27:13,643 : INFO : Recall score for label_class 1: 0.8974
2024-08-15 17:27:13,643 : INFO : Recall score for label_class 2: 0.8071
2024-08-15 17:27:13,643 : INFO : Average F1 score: 0.8424
2024-08-15 17:27:13,643 : INFO : Determined score from best model, ending training.
2024-08-15 17:27:13,645 : INFO : Split 4 is finished, the score is: 0.8424
2024-08-15 17:27:13,645 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:13,645 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:13,645 : INFO : Starting training for split 5
2024-08-15 17:27:13,659 : INFO : Starting to tokenize the sequences.
2024-08-15 17:27:13,664 : INFO : Tokenization is finished.
2024-08-15 17:27:13,681 : INFO : Starting to tokenize the sequences.
2024-08-15 17:27:13,686 : INFO : Tokenization is finished.
2024-08-15 17:27:13,691 : INFO : Counting occurences of labels...
2024-08-15 17:27:13,692 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 330, 1615,  754]))
2024-08-15 17:27:13,692 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 84, 396, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:27:13,735 : INFO : Starting epoch 1
2024-08-15 17:27:13,787 : INFO : Current training batch loss: 1.1070 in epoch 1
2024-08-15 17:27:14,606 : INFO : Current training batch loss: 1.0429 in epoch 1
2024-08-15 17:27:15,421 : INFO : Current training batch loss: 0.8847 in epoch 1
2024-08-15 17:27:16,236 : INFO : Current training batch loss: 0.7463 in epoch 1
2024-08-15 17:27:17,051 : INFO : Current training batch loss: 0.6386 in epoch 1
2024-08-15 17:27:17,202 : INFO : Epoch finished, average loss over training batches: 0.8798
2024-08-15 17:27:17,202 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:17,203 : INFO : Training metrics:
2024-08-15 17:27:17,203 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:17,214 : INFO : Accuracy: 0.6139
2024-08-15 17:27:17,214 : INFO : Precision score for label_class 0: 0.1964
2024-08-15 17:27:17,214 : INFO : Precision score for label_class 1: 0.6711
2024-08-15 17:27:17,214 : INFO : Precision score for label_class 2: 0.4315
2024-08-15 17:27:17,214 : INFO : Recall score for label_class 0: 0.0333
2024-08-15 17:27:17,214 : INFO : Recall score for label_class 1: 0.8768
2024-08-15 17:27:17,214 : INFO : Recall score for label_class 2: 0.3050
2024-08-15 17:27:17,214 : INFO : Average F1 score: 0.3916
2024-08-15 17:27:17,683 : INFO : Average loss over validation batches: 0.6143
2024-08-15 17:27:17,683 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:17,683 : INFO : Validation metrics:
2024-08-15 17:27:17,683 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:17,686 : INFO : Accuracy: 0.7374
2024-08-15 17:27:17,686 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:27:17,686 : INFO : Precision score for label_class 1: 0.8056
2024-08-15 17:27:17,686 : INFO : Precision score for label_class 2: 0.5825
2024-08-15 17:27:17,686 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:27:17,686 : INFO : Recall score for label_class 1: 0.9520
2024-08-15 17:27:17,686 : INFO : Recall score for label_class 2: 0.6186
2024-08-15 17:27:17,686 : INFO : Average F1 score: 0.4909
2024-08-15 17:27:17,686 : INFO : Validation metric decreased (inf --> 0.614294).  Saving model ...
2024-08-15 17:27:17,798 : INFO : Starting epoch 2
2024-08-15 17:27:18,452 : INFO : Current training batch loss: 0.5972 in epoch 2
2024-08-15 17:27:19,267 : INFO : Current training batch loss: 0.4819 in epoch 2
2024-08-15 17:27:20,082 : INFO : Current training batch loss: 0.3380 in epoch 2
2024-08-15 17:27:20,897 : INFO : Current training batch loss: 0.4319 in epoch 2
2024-08-15 17:27:21,250 : INFO : Epoch finished, average loss over training batches: 0.4967
2024-08-15 17:27:21,250 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:21,250 : INFO : Training metrics:
2024-08-15 17:27:21,250 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:21,257 : INFO : Accuracy: 0.8266
2024-08-15 17:27:21,257 : INFO : Precision score for label_class 0: 0.7907
2024-08-15 17:27:21,257 : INFO : Precision score for label_class 1: 0.8712
2024-08-15 17:27:21,257 : INFO : Precision score for label_class 2: 0.7340
2024-08-15 17:27:21,257 : INFO : Recall score for label_class 0: 0.5152
2024-08-15 17:27:21,257 : INFO : Recall score for label_class 1: 0.9344
2024-08-15 17:27:21,257 : INFO : Recall score for label_class 2: 0.7321
2024-08-15 17:27:21,257 : INFO : Average F1 score: 0.7529
2024-08-15 17:27:21,728 : INFO : Average loss over validation batches: 0.4343
2024-08-15 17:27:21,728 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:21,728 : INFO : Validation metrics:
2024-08-15 17:27:21,728 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:21,732 : INFO : Accuracy: 0.8398
2024-08-15 17:27:21,732 : INFO : Precision score for label_class 0: 0.8154
2024-08-15 17:27:21,732 : INFO : Precision score for label_class 1: 0.8484
2024-08-15 17:27:21,732 : INFO : Precision score for label_class 2: 0.8263
2024-08-15 17:27:21,732 : INFO : Recall score for label_class 0: 0.6310
2024-08-15 17:27:21,732 : INFO : Recall score for label_class 1: 0.9470
2024-08-15 17:27:21,732 : INFO : Recall score for label_class 2: 0.7113
2024-08-15 17:27:21,732 : INFO : Average F1 score: 0.7903
2024-08-15 17:27:21,732 : INFO : Validation metric decreased (0.614294 --> 0.434257).  Saving model ...
2024-08-15 17:27:21,836 : INFO : Starting epoch 3
2024-08-15 17:27:22,289 : INFO : Current training batch loss: 0.2736 in epoch 3
2024-08-15 17:27:23,104 : INFO : Current training batch loss: 0.3197 in epoch 3
2024-08-15 17:27:23,919 : INFO : Current training batch loss: 0.1889 in epoch 3
2024-08-15 17:27:24,734 : INFO : Current training batch loss: 0.1586 in epoch 3
2024-08-15 17:27:25,287 : INFO : Epoch finished, average loss over training batches: 0.2765
2024-08-15 17:27:25,287 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:25,287 : INFO : Training metrics:
2024-08-15 17:27:25,287 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:25,298 : INFO : Accuracy: 0.9192
2024-08-15 17:27:25,298 : INFO : Precision score for label_class 0: 0.8398
2024-08-15 17:27:25,298 : INFO : Precision score for label_class 1: 0.9459
2024-08-15 17:27:25,298 : INFO : Precision score for label_class 2: 0.8966
2024-08-15 17:27:25,298 : INFO : Recall score for label_class 0: 0.8576
2024-08-15 17:27:25,298 : INFO : Recall score for label_class 1: 0.9529
2024-08-15 17:27:25,298 : INFO : Recall score for label_class 2: 0.8740
2024-08-15 17:27:25,298 : INFO : Average F1 score: 0.8944
2024-08-15 17:27:25,767 : INFO : Average loss over validation batches: 0.4062
2024-08-15 17:27:25,767 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:25,767 : INFO : Validation metrics:
2024-08-15 17:27:25,767 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:25,770 : INFO : Accuracy: 0.8561
2024-08-15 17:27:25,770 : INFO : Precision score for label_class 0: 0.8378
2024-08-15 17:27:25,770 : INFO : Precision score for label_class 1: 0.8591
2024-08-15 17:27:25,770 : INFO : Precision score for label_class 2: 0.8563
2024-08-15 17:27:25,770 : INFO : Recall score for label_class 0: 0.7381
2024-08-15 17:27:25,771 : INFO : Recall score for label_class 1: 0.9394
2024-08-15 17:27:25,771 : INFO : Recall score for label_class 2: 0.7371
2024-08-15 17:27:25,771 : INFO : Average F1 score: 0.8248
2024-08-15 17:27:25,771 : INFO : Validation metric decreased (0.434257 --> 0.406164).  Saving model ...
2024-08-15 17:27:25,875 : INFO : Starting epoch 4
2024-08-15 17:27:26,127 : INFO : Current training batch loss: 0.3621 in epoch 4
2024-08-15 17:27:26,941 : INFO : Current training batch loss: 0.2177 in epoch 4
2024-08-15 17:27:27,757 : INFO : Current training batch loss: 0.1137 in epoch 4
2024-08-15 17:27:28,571 : INFO : Current training batch loss: 0.0618 in epoch 4
2024-08-15 17:27:29,332 : INFO : Epoch finished, average loss over training batches: 0.1778
2024-08-15 17:27:29,333 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:29,333 : INFO : Training metrics:
2024-08-15 17:27:29,333 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:29,343 : INFO : Accuracy: 0.9541
2024-08-15 17:27:29,343 : INFO : Precision score for label_class 0: 0.9053
2024-08-15 17:27:29,343 : INFO : Precision score for label_class 1: 0.9633
2024-08-15 17:27:29,343 : INFO : Precision score for label_class 2: 0.9559
2024-08-15 17:27:29,343 : INFO : Recall score for label_class 0: 0.9273
2024-08-15 17:27:29,343 : INFO : Recall score for label_class 1: 0.9752
2024-08-15 17:27:29,343 : INFO : Recall score for label_class 2: 0.9204
2024-08-15 17:27:29,343 : INFO : Average F1 score: 0.9411
2024-08-15 17:27:29,812 : INFO : Average loss over validation batches: 0.3803
2024-08-15 17:27:29,812 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:29,812 : INFO : Validation metrics:
2024-08-15 17:27:29,812 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:29,816 : INFO : Accuracy: 0.8665
2024-08-15 17:27:29,816 : INFO : Precision score for label_class 0: 0.7447
2024-08-15 17:27:29,816 : INFO : Precision score for label_class 1: 0.9177
2024-08-15 17:27:29,816 : INFO : Precision score for label_class 2: 0.8220
2024-08-15 17:27:29,816 : INFO : Recall score for label_class 0: 0.8333
2024-08-15 17:27:29,816 : INFO : Recall score for label_class 1: 0.9015
2024-08-15 17:27:29,816 : INFO : Recall score for label_class 2: 0.8093
2024-08-15 17:27:29,816 : INFO : Average F1 score: 0.8372
2024-08-15 17:27:29,816 : INFO : Validation metric decreased (0.406164 --> 0.380286).  Saving model ...
2024-08-15 17:27:29,919 : INFO : Starting epoch 5
2024-08-15 17:27:29,970 : INFO : Current training batch loss: 0.0568 in epoch 5
2024-08-15 17:27:30,785 : INFO : Current training batch loss: 0.1897 in epoch 5
2024-08-15 17:27:31,600 : INFO : Current training batch loss: 0.0494 in epoch 5
2024-08-15 17:27:32,416 : INFO : Current training batch loss: 0.1628 in epoch 5
2024-08-15 17:27:33,230 : INFO : Current training batch loss: 0.0452 in epoch 5
2024-08-15 17:27:33,381 : INFO : Epoch finished, average loss over training batches: 0.1139
2024-08-15 17:27:33,381 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:33,382 : INFO : Training metrics:
2024-08-15 17:27:33,382 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:33,392 : INFO : Accuracy: 0.9759
2024-08-15 17:27:33,392 : INFO : Precision score for label_class 0: 0.9315
2024-08-15 17:27:33,392 : INFO : Precision score for label_class 1: 0.9834
2024-08-15 17:27:33,392 : INFO : Precision score for label_class 2: 0.9798
2024-08-15 17:27:33,392 : INFO : Recall score for label_class 0: 0.9485
2024-08-15 17:27:33,392 : INFO : Recall score for label_class 1: 0.9876
2024-08-15 17:27:33,392 : INFO : Recall score for label_class 2: 0.9629
2024-08-15 17:27:33,392 : INFO : Average F1 score: 0.9656
2024-08-15 17:27:33,859 : INFO : Average loss over validation batches: 0.3822
2024-08-15 17:27:33,860 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:33,860 : INFO : Validation metrics:
2024-08-15 17:27:33,860 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:33,863 : INFO : Accuracy: 0.8724
2024-08-15 17:27:33,863 : INFO : Precision score for label_class 0: 0.7738
2024-08-15 17:27:33,863 : INFO : Precision score for label_class 1: 0.9280
2024-08-15 17:27:33,863 : INFO : Precision score for label_class 2: 0.8060
2024-08-15 17:27:33,863 : INFO : Recall score for label_class 0: 0.7738
2024-08-15 17:27:33,863 : INFO : Recall score for label_class 1: 0.9116
2024-08-15 17:27:33,863 : INFO : Recall score for label_class 2: 0.8351
2024-08-15 17:27:33,863 : INFO : Average F1 score: 0.8379
2024-08-15 17:27:33,863 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:27:33,863 : INFO : Starting epoch 6
2024-08-15 17:27:34,517 : INFO : Current training batch loss: 0.1435 in epoch 6
2024-08-15 17:27:35,332 : INFO : Current training batch loss: 0.0949 in epoch 6
2024-08-15 17:27:36,147 : INFO : Current training batch loss: 0.0426 in epoch 6
2024-08-15 17:27:36,962 : INFO : Current training batch loss: 0.1066 in epoch 6
2024-08-15 17:27:37,314 : INFO : Epoch finished, average loss over training batches: 0.0834
2024-08-15 17:27:37,314 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:37,314 : INFO : Training metrics:
2024-08-15 17:27:37,314 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:37,322 : INFO : Accuracy: 0.9830
2024-08-15 17:27:37,322 : INFO : Precision score for label_class 0: 0.9517
2024-08-15 17:27:37,322 : INFO : Precision score for label_class 1: 0.9895
2024-08-15 17:27:37,322 : INFO : Precision score for label_class 2: 0.9827
2024-08-15 17:27:37,322 : INFO : Recall score for label_class 0: 0.9545
2024-08-15 17:27:37,322 : INFO : Recall score for label_class 1: 0.9913
2024-08-15 17:27:37,322 : INFO : Recall score for label_class 2: 0.9775
2024-08-15 17:27:37,322 : INFO : Average F1 score: 0.9745
2024-08-15 17:27:37,789 : INFO : Average loss over validation batches: 0.3841
2024-08-15 17:27:37,790 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:37,790 : INFO : Validation metrics:
2024-08-15 17:27:37,790 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:37,793 : INFO : Accuracy: 0.8724
2024-08-15 17:27:37,793 : INFO : Precision score for label_class 0: 0.7727
2024-08-15 17:27:37,794 : INFO : Precision score for label_class 1: 0.9229
2024-08-15 17:27:37,794 : INFO : Precision score for label_class 2: 0.8173
2024-08-15 17:27:37,794 : INFO : Recall score for label_class 0: 0.8095
2024-08-15 17:27:37,794 : INFO : Recall score for label_class 1: 0.9066
2024-08-15 17:27:37,794 : INFO : Recall score for label_class 2: 0.8299
2024-08-15 17:27:37,794 : INFO : Average F1 score: 0.8430
2024-08-15 17:27:37,794 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:27:37,794 : INFO : Last epoch reached, validation loss was better before, loading best model during training.
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:27:37,832 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:27:38,335 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:38,335 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:27:38,335 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:38,339 : INFO : Accuracy: 0.8665
2024-08-15 17:27:38,339 : INFO : Precision score for label_class 0: 0.7447
2024-08-15 17:27:38,339 : INFO : Precision score for label_class 1: 0.9177
2024-08-15 17:27:38,339 : INFO : Precision score for label_class 2: 0.8220
2024-08-15 17:27:38,339 : INFO : Recall score for label_class 0: 0.8333
2024-08-15 17:27:38,339 : INFO : Recall score for label_class 1: 0.9015
2024-08-15 17:27:38,339 : INFO : Recall score for label_class 2: 0.8093
2024-08-15 17:27:38,339 : INFO : Average F1 score: 0.8372
2024-08-15 17:27:38,339 : INFO : Determined score from best model, ending training.
2024-08-15 17:27:38,341 : INFO : Split 5 is finished, the score is: 0.8372
2024-08-15 17:27:38,341 : INFO : ----------------------------------------------------------------------------------------------------
[I 2024-08-15 17:27:38,350] Trial 11 finished with value: 0.845632781910037 and parameters: {'n_epochs': 6, 'learning_rate': 4.254735051821058e-05, 'classifier_dropout': 0.3696559422173197, 'warmup_step_fraction': 0.08011004306168018, 'use_gradient_clipping': False}. Best is trial 1 with value: 0.8513001269595835.
2024-08-15 17:27:38,358 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:38,358 : INFO : Starting training for split 1
2024-08-15 17:27:38,370 : INFO : Starting to tokenize the sequences.
2024-08-15 17:27:38,376 : INFO : Tokenization is finished.
2024-08-15 17:27:38,388 : INFO : Starting to tokenize the sequences.
2024-08-15 17:27:38,393 : INFO : Tokenization is finished.
2024-08-15 17:27:38,393 : INFO : Counting occurences of labels...
2024-08-15 17:27:38,394 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1596,  774]))
2024-08-15 17:27:38,394 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 415, 174]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:27:38,437 : INFO : Starting epoch 1
2024-08-15 17:27:38,488 : INFO : Current training batch loss: 1.1072 in epoch 1
2024-08-15 17:27:39,310 : INFO : Current training batch loss: 1.0117 in epoch 1
2024-08-15 17:27:40,125 : INFO : Current training batch loss: 1.0091 in epoch 1
2024-08-15 17:27:40,941 : INFO : Current training batch loss: 0.8249 in epoch 1
2024-08-15 17:27:41,755 : INFO : Current training batch loss: 0.8335 in epoch 1
2024-08-15 17:27:41,906 : INFO : Epoch finished, average loss over training batches: 0.9203
2024-08-15 17:27:41,906 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:41,906 : INFO : Training metrics:
2024-08-15 17:27:41,906 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:41,914 : INFO : Accuracy: 0.5967
2024-08-15 17:27:41,914 : INFO : Precision score for label_class 0: 0.1155
2024-08-15 17:27:41,914 : INFO : Precision score for label_class 1: 0.6594
2024-08-15 17:27:41,914 : INFO : Precision score for label_class 2: 0.5515
2024-08-15 17:27:41,914 : INFO : Recall score for label_class 0: 0.0884
2024-08-15 17:27:41,915 : INFO : Recall score for label_class 1: 0.8866
2024-08-15 17:27:41,915 : INFO : Recall score for label_class 2: 0.2145
2024-08-15 17:27:41,915 : INFO : Average F1 score: 0.3884
2024-08-15 17:27:42,383 : INFO : Average loss over validation batches: 0.7197
2024-08-15 17:27:42,383 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:42,384 : INFO : Validation metrics:
2024-08-15 17:27:42,384 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:42,386 : INFO : Accuracy: 0.7200
2024-08-15 17:27:42,386 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:27:42,386 : INFO : Precision score for label_class 1: 0.8008
2024-08-15 17:27:42,386 : INFO : Precision score for label_class 2: 0.5106
2024-08-15 17:27:42,386 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:27:42,386 : INFO : Recall score for label_class 1: 0.9398
2024-08-15 17:27:42,386 : INFO : Recall score for label_class 2: 0.5517
2024-08-15 17:27:42,386 : INFO : Average F1 score: 0.4650
2024-08-15 17:27:42,386 : INFO : Validation metric decreased (inf --> 0.719750).  Saving model ...
2024-08-15 17:27:42,497 : INFO : Starting epoch 2
2024-08-15 17:27:43,151 : INFO : Current training batch loss: 0.5335 in epoch 2
2024-08-15 17:27:43,965 : INFO : Current training batch loss: 0.6566 in epoch 2
2024-08-15 17:27:44,781 : INFO : Current training batch loss: 0.5978 in epoch 2
2024-08-15 17:27:45,615 : INFO : Current training batch loss: 0.5650 in epoch 2
2024-08-15 17:27:45,966 : INFO : Epoch finished, average loss over training batches: 0.6016
2024-08-15 17:27:45,967 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:45,967 : INFO : Training metrics:
2024-08-15 17:27:45,967 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:45,971 : INFO : Accuracy: 0.7721
2024-08-15 17:27:45,971 : INFO : Precision score for label_class 0: 0.6875
2024-08-15 17:27:45,971 : INFO : Precision score for label_class 1: 0.8499
2024-08-15 17:27:45,971 : INFO : Precision score for label_class 2: 0.6234
2024-08-15 17:27:45,971 : INFO : Recall score for label_class 0: 0.0335
2024-08-15 17:27:45,971 : INFO : Recall score for label_class 1: 0.9405
2024-08-15 17:27:45,971 : INFO : Recall score for label_class 2: 0.7377
2024-08-15 17:27:45,971 : INFO : Average F1 score: 0.5442
2024-08-15 17:27:46,438 : INFO : Average loss over validation batches: 0.5327
2024-08-15 17:27:46,439 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:46,439 : INFO : Validation metrics:
2024-08-15 17:27:46,439 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:46,441 : INFO : Accuracy: 0.8030
2024-08-15 17:27:46,441 : INFO : Precision score for label_class 0: 0.7692
2024-08-15 17:27:46,441 : INFO : Precision score for label_class 1: 0.8889
2024-08-15 17:27:46,441 : INFO : Precision score for label_class 2: 0.6359
2024-08-15 17:27:46,441 : INFO : Recall score for label_class 0: 0.2326
2024-08-15 17:27:46,441 : INFO : Recall score for label_class 1: 0.9253
2024-08-15 17:27:46,441 : INFO : Recall score for label_class 2: 0.7931
2024-08-15 17:27:46,441 : INFO : Average F1 score: 0.6566
2024-08-15 17:27:46,441 : INFO : Validation metric decreased (0.719750 --> 0.532653).  Saving model ...
2024-08-15 17:27:46,545 : INFO : Starting epoch 3
2024-08-15 17:27:46,998 : INFO : Current training batch loss: 0.4507 in epoch 3
2024-08-15 17:27:47,813 : INFO : Current training batch loss: 0.5112 in epoch 3
2024-08-15 17:27:48,628 : INFO : Current training batch loss: 0.3800 in epoch 3
2024-08-15 17:27:49,442 : INFO : Current training batch loss: 0.3000 in epoch 3
2024-08-15 17:27:49,996 : INFO : Epoch finished, average loss over training batches: 0.4140
2024-08-15 17:27:49,996 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:49,996 : INFO : Training metrics:
2024-08-15 17:27:49,996 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:50,004 : INFO : Accuracy: 0.8758
2024-08-15 17:27:50,004 : INFO : Precision score for label_class 0: 0.7941
2024-08-15 17:27:50,004 : INFO : Precision score for label_class 1: 0.9080
2024-08-15 17:27:50,004 : INFO : Precision score for label_class 2: 0.8338
2024-08-15 17:27:50,004 : INFO : Recall score for label_class 0: 0.6585
2024-08-15 17:27:50,004 : INFO : Recall score for label_class 1: 0.9524
2024-08-15 17:27:50,004 : INFO : Recall score for label_class 2: 0.8101
2024-08-15 17:27:50,004 : INFO : Average F1 score: 0.8238
2024-08-15 17:27:50,472 : INFO : Average loss over validation batches: 0.3884
2024-08-15 17:27:50,472 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:50,472 : INFO : Validation metrics:
2024-08-15 17:27:50,472 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:50,475 : INFO : Accuracy: 0.8844
2024-08-15 17:27:50,475 : INFO : Precision score for label_class 0: 0.7835
2024-08-15 17:27:50,475 : INFO : Precision score for label_class 1: 0.9185
2024-08-15 17:27:50,475 : INFO : Precision score for label_class 2: 0.8571
2024-08-15 17:27:50,475 : INFO : Recall score for label_class 0: 0.8837
2024-08-15 17:27:50,475 : INFO : Recall score for label_class 1: 0.9229
2024-08-15 17:27:50,475 : INFO : Recall score for label_class 2: 0.7931
2024-08-15 17:27:50,475 : INFO : Average F1 score: 0.8584
2024-08-15 17:27:50,475 : INFO : Validation metric decreased (0.532653 --> 0.388361).  Saving model ...
2024-08-15 17:27:50,579 : INFO : Starting epoch 4
2024-08-15 17:27:50,831 : INFO : Current training batch loss: 0.6978 in epoch 4
2024-08-15 17:27:51,645 : INFO : Current training batch loss: 0.3058 in epoch 4
2024-08-15 17:27:52,460 : INFO : Current training batch loss: 0.3965 in epoch 4
2024-08-15 17:27:53,275 : INFO : Current training batch loss: 0.2487 in epoch 4
2024-08-15 17:27:54,028 : INFO : Epoch finished, average loss over training batches: 0.2976
2024-08-15 17:27:54,028 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:54,028 : INFO : Training metrics:
2024-08-15 17:27:54,028 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:54,036 : INFO : Accuracy: 0.9207
2024-08-15 17:27:54,036 : INFO : Precision score for label_class 0: 0.8121
2024-08-15 17:27:54,036 : INFO : Precision score for label_class 1: 0.9391
2024-08-15 17:27:54,036 : INFO : Precision score for label_class 2: 0.9309
2024-08-15 17:27:54,036 : INFO : Recall score for label_class 0: 0.8567
2024-08-15 17:27:54,036 : INFO : Recall score for label_class 1: 0.9668
2024-08-15 17:27:54,036 : INFO : Recall score for label_class 2: 0.8527
2024-08-15 17:27:54,036 : INFO : Average F1 score: 0.8922
2024-08-15 17:27:54,505 : INFO : Average loss over validation batches: 0.4003
2024-08-15 17:27:54,505 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:54,506 : INFO : Validation metrics:
2024-08-15 17:27:54,506 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:54,508 : INFO : Accuracy: 0.8548
2024-08-15 17:27:54,508 : INFO : Precision score for label_class 0: 0.7525
2024-08-15 17:27:54,508 : INFO : Precision score for label_class 1: 0.9385
2024-08-15 17:27:54,508 : INFO : Precision score for label_class 2: 0.7500
2024-08-15 17:27:54,508 : INFO : Recall score for label_class 0: 0.8837
2024-08-15 17:27:54,509 : INFO : Recall score for label_class 1: 0.8458
2024-08-15 17:27:54,509 : INFO : Recall score for label_class 2: 0.8621
2024-08-15 17:27:54,509 : INFO : Average F1 score: 0.8349
2024-08-15 17:27:54,509 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:27:54,509 : INFO : Starting epoch 5
2024-08-15 17:27:54,559 : INFO : Current training batch loss: 0.2337 in epoch 5
2024-08-15 17:27:55,374 : INFO : Current training batch loss: 0.3839 in epoch 5
2024-08-15 17:27:56,189 : INFO : Current training batch loss: 0.2380 in epoch 5
2024-08-15 17:27:57,004 : INFO : Current training batch loss: 0.2414 in epoch 5
2024-08-15 17:27:57,819 : INFO : Current training batch loss: 0.2640 in epoch 5
2024-08-15 17:27:57,970 : INFO : Epoch finished, average loss over training batches: 0.2410
2024-08-15 17:27:57,971 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:57,971 : INFO : Training metrics:
2024-08-15 17:27:57,971 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:57,975 : INFO : Accuracy: 0.9477
2024-08-15 17:27:57,975 : INFO : Precision score for label_class 0: 0.8596
2024-08-15 17:27:57,975 : INFO : Precision score for label_class 1: 0.9669
2024-08-15 17:27:57,975 : INFO : Precision score for label_class 2: 0.9477
2024-08-15 17:27:57,975 : INFO : Recall score for label_class 0: 0.9146
2024-08-15 17:27:57,975 : INFO : Recall score for label_class 1: 0.9712
2024-08-15 17:27:57,975 : INFO : Recall score for label_class 2: 0.9134
2024-08-15 17:27:57,975 : INFO : Average F1 score: 0.9285
2024-08-15 17:27:58,444 : INFO : Average loss over validation batches: 0.3499
2024-08-15 17:27:58,444 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:58,444 : INFO : Validation metrics:
2024-08-15 17:27:58,444 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:58,447 : INFO : Accuracy: 0.8963
2024-08-15 17:27:58,447 : INFO : Precision score for label_class 0: 0.8280
2024-08-15 17:27:58,447 : INFO : Precision score for label_class 1: 0.9153
2024-08-15 17:27:58,447 : INFO : Precision score for label_class 2: 0.8854
2024-08-15 17:27:58,447 : INFO : Recall score for label_class 0: 0.8953
2024-08-15 17:27:58,447 : INFO : Recall score for label_class 1: 0.9373
2024-08-15 17:27:58,447 : INFO : Recall score for label_class 2: 0.7989
2024-08-15 17:27:58,447 : INFO : Average F1 score: 0.8755
2024-08-15 17:27:58,447 : INFO : Validation metric decreased (0.388361 --> 0.349861).  Saving model ...
2024-08-15 17:27:58,549 : INFO : Split 1 is finished, the score is: 0.8755
2024-08-15 17:27:58,549 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:58,549 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:27:58,549 : INFO : Starting training for split 2
2024-08-15 17:27:58,564 : INFO : Starting to tokenize the sequences.
2024-08-15 17:27:58,570 : INFO : Tokenization is finished.
2024-08-15 17:27:58,586 : INFO : Starting to tokenize the sequences.
2024-08-15 17:27:58,590 : INFO : Tokenization is finished.
2024-08-15 17:27:58,595 : INFO : Counting occurences of labels...
2024-08-15 17:27:58,596 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 343, 1601,  754]))
2024-08-15 17:27:58,596 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 71, 410, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:27:58,643 : INFO : Starting epoch 1
2024-08-15 17:27:58,694 : INFO : Current training batch loss: 1.1216 in epoch 1
2024-08-15 17:27:59,509 : INFO : Current training batch loss: 1.0535 in epoch 1
2024-08-15 17:28:00,345 : INFO : Current training batch loss: 1.0035 in epoch 1
2024-08-15 17:28:01,176 : INFO : Current training batch loss: 0.8100 in epoch 1
2024-08-15 17:28:02,008 : INFO : Current training batch loss: 0.8204 in epoch 1
2024-08-15 17:28:02,165 : INFO : Epoch finished, average loss over training batches: 0.9174
2024-08-15 17:28:02,166 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:02,166 : INFO : Training metrics:
2024-08-15 17:28:02,166 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:02,176 : INFO : Accuracy: 0.5797
2024-08-15 17:28:02,176 : INFO : Precision score for label_class 0: 0.2500
2024-08-15 17:28:02,176 : INFO : Precision score for label_class 1: 0.6655
2024-08-15 17:28:02,176 : INFO : Precision score for label_class 2: 0.3686
2024-08-15 17:28:02,176 : INFO : Recall score for label_class 0: 0.0117
2024-08-15 17:28:02,176 : INFO : Recall score for label_class 1: 0.8001
2024-08-15 17:28:02,176 : INFO : Recall score for label_class 2: 0.3700
2024-08-15 17:28:02,176 : INFO : Average F1 score: 0.3727
2024-08-15 17:28:02,643 : INFO : Average loss over validation batches: 0.6929
2024-08-15 17:28:02,643 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:02,643 : INFO : Validation metrics:
2024-08-15 17:28:02,643 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:02,647 : INFO : Accuracy: 0.7437
2024-08-15 17:28:02,647 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:28:02,647 : INFO : Precision score for label_class 1: 0.7931
2024-08-15 17:28:02,647 : INFO : Precision score for label_class 2: 0.6099
2024-08-15 17:28:02,647 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:28:02,647 : INFO : Recall score for label_class 1: 0.9537
2024-08-15 17:28:02,647 : INFO : Recall score for label_class 2: 0.5722
2024-08-15 17:28:02,647 : INFO : Average F1 score: 0.4855
2024-08-15 17:28:02,647 : INFO : Validation metric decreased (inf --> 0.692906).  Saving model ...
2024-08-15 17:28:02,771 : INFO : Starting epoch 2
2024-08-15 17:28:03,427 : INFO : Current training batch loss: 0.6995 in epoch 2
2024-08-15 17:28:04,256 : INFO : Current training batch loss: 0.6291 in epoch 2
2024-08-15 17:28:05,080 : INFO : Current training batch loss: 0.5776 in epoch 2
2024-08-15 17:28:05,912 : INFO : Current training batch loss: 0.5006 in epoch 2
2024-08-15 17:28:06,361 : INFO : Epoch finished, average loss over training batches: 0.6044
2024-08-15 17:28:06,361 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:06,361 : INFO : Training metrics:
2024-08-15 17:28:06,361 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:06,372 : INFO : Accuracy: 0.7732
2024-08-15 17:28:06,372 : INFO : Precision score for label_class 0: 0.7963
2024-08-15 17:28:06,372 : INFO : Precision score for label_class 1: 0.8429
2024-08-15 17:28:06,372 : INFO : Precision score for label_class 2: 0.6208
2024-08-15 17:28:06,372 : INFO : Recall score for label_class 0: 0.1254
2024-08-15 17:28:06,372 : INFO : Recall score for label_class 1: 0.9519
2024-08-15 17:28:06,372 : INFO : Recall score for label_class 2: 0.6883
2024-08-15 17:28:06,372 : INFO : Average F1 score: 0.5879
2024-08-15 17:28:06,839 : INFO : Average loss over validation batches: 0.5171
2024-08-15 17:28:06,839 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:06,839 : INFO : Validation metrics:
2024-08-15 17:28:06,840 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:06,843 : INFO : Accuracy: 0.8222
2024-08-15 17:28:06,843 : INFO : Precision score for label_class 0: 0.7917
2024-08-15 17:28:06,843 : INFO : Precision score for label_class 1: 0.8525
2024-08-15 17:28:06,844 : INFO : Precision score for label_class 2: 0.7526
2024-08-15 17:28:06,844 : INFO : Recall score for label_class 0: 0.2676
2024-08-15 17:28:06,844 : INFO : Recall score for label_class 1: 0.9585
2024-08-15 17:28:06,844 : INFO : Recall score for label_class 2: 0.7371
2024-08-15 17:28:06,844 : INFO : Average F1 score: 0.6824
2024-08-15 17:28:06,844 : INFO : Validation metric decreased (0.692906 --> 0.517102).  Saving model ...
2024-08-15 17:28:06,945 : INFO : Starting epoch 3
2024-08-15 17:28:07,399 : INFO : Current training batch loss: 0.4267 in epoch 3
2024-08-15 17:28:08,214 : INFO : Current training batch loss: 0.4445 in epoch 3
2024-08-15 17:28:09,038 : INFO : Current training batch loss: 0.4676 in epoch 3
2024-08-15 17:28:09,871 : INFO : Current training batch loss: 0.2951 in epoch 3
2024-08-15 17:28:10,433 : INFO : Epoch finished, average loss over training batches: 0.4106
2024-08-15 17:28:10,433 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:10,433 : INFO : Training metrics:
2024-08-15 17:28:10,433 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:10,440 : INFO : Accuracy: 0.8851
2024-08-15 17:28:10,440 : INFO : Precision score for label_class 0: 0.8025
2024-08-15 17:28:10,440 : INFO : Precision score for label_class 1: 0.9158
2024-08-15 17:28:10,440 : INFO : Precision score for label_class 2: 0.8502
2024-08-15 17:28:10,440 : INFO : Recall score for label_class 0: 0.7347
2024-08-15 17:28:10,440 : INFO : Recall score for label_class 1: 0.9513
2024-08-15 17:28:10,440 : INFO : Recall score for label_class 2: 0.8130
2024-08-15 17:28:10,440 : INFO : Average F1 score: 0.8438
2024-08-15 17:28:10,908 : INFO : Average loss over validation batches: 0.4331
2024-08-15 17:28:10,908 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:10,908 : INFO : Validation metrics:
2024-08-15 17:28:10,908 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:10,911 : INFO : Accuracy: 0.8504
2024-08-15 17:28:10,911 : INFO : Precision score for label_class 0: 0.7727
2024-08-15 17:28:10,911 : INFO : Precision score for label_class 1: 0.8932
2024-08-15 17:28:10,911 : INFO : Precision score for label_class 2: 0.7868
2024-08-15 17:28:10,911 : INFO : Recall score for label_class 0: 0.7183
2024-08-15 17:28:10,911 : INFO : Recall score for label_class 1: 0.8976
2024-08-15 17:28:10,911 : INFO : Recall score for label_class 2: 0.7990
2024-08-15 17:28:10,911 : INFO : Average F1 score: 0.8109
2024-08-15 17:28:10,911 : INFO : Validation metric decreased (0.517102 --> 0.433051).  Saving model ...
2024-08-15 17:28:11,015 : INFO : Starting epoch 4
2024-08-15 17:28:11,266 : INFO : Current training batch loss: 0.4447 in epoch 4
2024-08-15 17:28:12,081 : INFO : Current training batch loss: 0.3615 in epoch 4
2024-08-15 17:28:12,896 : INFO : Current training batch loss: 0.3810 in epoch 4
2024-08-15 17:28:13,711 : INFO : Current training batch loss: 0.2118 in epoch 4
2024-08-15 17:28:14,465 : INFO : Epoch finished, average loss over training batches: 0.2975
2024-08-15 17:28:14,465 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:14,465 : INFO : Training metrics:
2024-08-15 17:28:14,465 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:14,473 : INFO : Accuracy: 0.9229
2024-08-15 17:28:14,473 : INFO : Precision score for label_class 0: 0.8268
2024-08-15 17:28:14,473 : INFO : Precision score for label_class 1: 0.9489
2024-08-15 17:28:14,473 : INFO : Precision score for label_class 2: 0.9119
2024-08-15 17:28:14,473 : INFO : Recall score for label_class 0: 0.8630
2024-08-15 17:28:14,473 : INFO : Recall score for label_class 1: 0.9631
2024-08-15 17:28:14,473 : INFO : Recall score for label_class 2: 0.8647
2024-08-15 17:28:14,473 : INFO : Average F1 score: 0.8961
2024-08-15 17:28:14,940 : INFO : Average loss over validation batches: 0.4147
2024-08-15 17:28:14,940 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:14,940 : INFO : Validation metrics:
2024-08-15 17:28:14,940 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:14,943 : INFO : Accuracy: 0.8519
2024-08-15 17:28:14,943 : INFO : Precision score for label_class 0: 0.7403
2024-08-15 17:28:14,943 : INFO : Precision score for label_class 1: 0.9066
2024-08-15 17:28:14,943 : INFO : Precision score for label_class 2: 0.7871
2024-08-15 17:28:14,943 : INFO : Recall score for label_class 0: 0.8028
2024-08-15 17:28:14,943 : INFO : Recall score for label_class 1: 0.8756
2024-08-15 17:28:14,943 : INFO : Recall score for label_class 2: 0.8196
2024-08-15 17:28:14,943 : INFO : Average F1 score: 0.8214
2024-08-15 17:28:14,943 : INFO : Validation metric decreased (0.433051 --> 0.414744).  Saving model ...
2024-08-15 17:28:15,046 : INFO : Starting epoch 5
2024-08-15 17:28:15,097 : INFO : Current training batch loss: 0.2315 in epoch 5
2024-08-15 17:28:15,912 : INFO : Current training batch loss: 0.4122 in epoch 5
2024-08-15 17:28:16,728 : INFO : Current training batch loss: 0.2449 in epoch 5
2024-08-15 17:28:17,543 : INFO : Current training batch loss: 0.2786 in epoch 5
2024-08-15 17:28:18,359 : INFO : Current training batch loss: 0.2542 in epoch 5
2024-08-15 17:28:18,510 : INFO : Epoch finished, average loss over training batches: 0.2424
2024-08-15 17:28:18,510 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:18,510 : INFO : Training metrics:
2024-08-15 17:28:18,510 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:18,517 : INFO : Accuracy: 0.9470
2024-08-15 17:28:18,517 : INFO : Precision score for label_class 0: 0.8732
2024-08-15 17:28:18,517 : INFO : Precision score for label_class 1: 0.9654
2024-08-15 17:28:18,517 : INFO : Precision score for label_class 2: 0.9412
2024-08-15 17:28:18,517 : INFO : Recall score for label_class 0: 0.8834
2024-08-15 17:28:18,517 : INFO : Recall score for label_class 1: 0.9769
2024-08-15 17:28:18,517 : INFO : Recall score for label_class 2: 0.9125
2024-08-15 17:28:18,517 : INFO : Average F1 score: 0.9253
2024-08-15 17:28:18,984 : INFO : Average loss over validation batches: 0.3951
2024-08-15 17:28:18,985 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:18,985 : INFO : Validation metrics:
2024-08-15 17:28:18,985 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:18,989 : INFO : Accuracy: 0.8726
2024-08-15 17:28:18,989 : INFO : Precision score for label_class 0: 0.8182
2024-08-15 17:28:18,989 : INFO : Precision score for label_class 1: 0.8884
2024-08-15 17:28:18,989 : INFO : Precision score for label_class 2: 0.8547
2024-08-15 17:28:18,989 : INFO : Recall score for label_class 0: 0.7606
2024-08-15 17:28:18,989 : INFO : Recall score for label_class 1: 0.9317
2024-08-15 17:28:18,989 : INFO : Recall score for label_class 2: 0.7887
2024-08-15 17:28:18,989 : INFO : Average F1 score: 0.8394
2024-08-15 17:28:18,989 : INFO : Validation metric decreased (0.414744 --> 0.395107).  Saving model ...
2024-08-15 17:28:19,095 : INFO : Split 2 is finished, the score is: 0.8394
2024-08-15 17:28:19,095 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:19,095 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:19,095 : INFO : Starting training for split 3
2024-08-15 17:28:19,108 : INFO : Starting to tokenize the sequences.
2024-08-15 17:28:19,114 : INFO : Tokenization is finished.
2024-08-15 17:28:19,134 : INFO : Starting to tokenize the sequences.
2024-08-15 17:28:19,138 : INFO : Tokenization is finished.
2024-08-15 17:28:19,143 : INFO : Counting occurences of labels...
2024-08-15 17:28:19,144 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1611,  759]))
2024-08-15 17:28:19,144 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 400, 189]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:28:19,194 : INFO : Starting epoch 1
2024-08-15 17:28:19,245 : INFO : Current training batch loss: 1.0736 in epoch 1
2024-08-15 17:28:20,060 : INFO : Current training batch loss: 1.0431 in epoch 1
2024-08-15 17:28:20,876 : INFO : Current training batch loss: 0.9123 in epoch 1
2024-08-15 17:28:21,691 : INFO : Current training batch loss: 0.8350 in epoch 1
2024-08-15 17:28:22,506 : INFO : Current training batch loss: 0.8051 in epoch 1
2024-08-15 17:28:22,656 : INFO : Epoch finished, average loss over training batches: 0.9094
2024-08-15 17:28:22,657 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:22,657 : INFO : Training metrics:
2024-08-15 17:28:22,657 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:22,664 : INFO : Accuracy: 0.6401
2024-08-15 17:28:22,664 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:28:22,664 : INFO : Precision score for label_class 1: 0.6526
2024-08-15 17:28:22,664 : INFO : Precision score for label_class 2: 0.5363
2024-08-15 17:28:22,664 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:28:22,664 : INFO : Recall score for label_class 1: 0.9758
2024-08-15 17:28:22,664 : INFO : Recall score for label_class 2: 0.2042
2024-08-15 17:28:22,664 : INFO : Average F1 score: 0.3593
2024-08-15 17:28:23,130 : INFO : Average loss over validation batches: 0.7224
2024-08-15 17:28:23,130 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:23,130 : INFO : Validation metrics:
2024-08-15 17:28:23,130 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:23,133 : INFO : Accuracy: 0.7052
2024-08-15 17:28:23,133 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:28:23,133 : INFO : Precision score for label_class 1: 0.7822
2024-08-15 17:28:23,133 : INFO : Precision score for label_class 2: 0.5248
2024-08-15 17:28:23,133 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:28:23,133 : INFO : Recall score for label_class 1: 0.9250
2024-08-15 17:28:23,133 : INFO : Recall score for label_class 2: 0.5608
2024-08-15 17:28:23,133 : INFO : Average F1 score: 0.4633
2024-08-15 17:28:23,133 : INFO : Validation metric decreased (inf --> 0.722390).  Saving model ...
2024-08-15 17:28:23,234 : INFO : Starting epoch 2
2024-08-15 17:28:23,888 : INFO : Current training batch loss: 0.6582 in epoch 2
2024-08-15 17:28:24,702 : INFO : Current training batch loss: 0.5923 in epoch 2
2024-08-15 17:28:25,516 : INFO : Current training batch loss: 0.5621 in epoch 2
2024-08-15 17:28:26,331 : INFO : Current training batch loss: 0.4805 in epoch 2
2024-08-15 17:28:26,683 : INFO : Epoch finished, average loss over training batches: 0.6007
2024-08-15 17:28:26,683 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:26,683 : INFO : Training metrics:
2024-08-15 17:28:26,683 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:26,687 : INFO : Accuracy: 0.7650
2024-08-15 17:28:26,687 : INFO : Precision score for label_class 0: 1.0000
2024-08-15 17:28:26,687 : INFO : Precision score for label_class 1: 0.8495
2024-08-15 17:28:26,687 : INFO : Precision score for label_class 2: 0.6007
2024-08-15 17:28:26,687 : INFO : Recall score for label_class 0: 0.0152
2024-08-15 17:28:26,687 : INFO : Recall score for label_class 1: 0.9354
2024-08-15 17:28:26,687 : INFO : Recall score for label_class 2: 0.7273
2024-08-15 17:28:26,687 : INFO : Average F1 score: 0.5261
2024-08-15 17:28:27,154 : INFO : Average loss over validation batches: 0.5244
2024-08-15 17:28:27,154 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:27,154 : INFO : Validation metrics:
2024-08-15 17:28:27,154 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:27,157 : INFO : Accuracy: 0.7807
2024-08-15 17:28:27,157 : INFO : Precision score for label_class 0: 1.0000
2024-08-15 17:28:27,157 : INFO : Precision score for label_class 1: 0.8679
2024-08-15 17:28:27,157 : INFO : Precision score for label_class 2: 0.6154
2024-08-15 17:28:27,157 : INFO : Recall score for label_class 0: 0.0233
2024-08-15 17:28:27,157 : INFO : Recall score for label_class 1: 0.9525
2024-08-15 17:28:27,157 : INFO : Recall score for label_class 2: 0.7619
2024-08-15 17:28:27,157 : INFO : Average F1 score: 0.5448
2024-08-15 17:28:27,157 : INFO : Validation metric decreased (0.722390 --> 0.524411).  Saving model ...
2024-08-15 17:28:27,259 : INFO : Starting epoch 3
2024-08-15 17:28:27,713 : INFO : Current training batch loss: 0.4381 in epoch 3
2024-08-15 17:28:28,528 : INFO : Current training batch loss: 0.4253 in epoch 3
2024-08-15 17:28:29,342 : INFO : Current training batch loss: 0.3909 in epoch 3
2024-08-15 17:28:30,161 : INFO : Current training batch loss: 0.2668 in epoch 3
2024-08-15 17:28:30,714 : INFO : Epoch finished, average loss over training batches: 0.4145
2024-08-15 17:28:30,714 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:30,714 : INFO : Training metrics:
2024-08-15 17:28:30,714 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:30,721 : INFO : Accuracy: 0.8744
2024-08-15 17:28:30,721 : INFO : Precision score for label_class 0: 0.8066
2024-08-15 17:28:30,721 : INFO : Precision score for label_class 1: 0.9133
2024-08-15 17:28:30,721 : INFO : Precision score for label_class 2: 0.8109
2024-08-15 17:28:30,721 : INFO : Recall score for label_class 0: 0.5976
2024-08-15 17:28:30,721 : INFO : Recall score for label_class 1: 0.9541
2024-08-15 17:28:30,721 : INFO : Recall score for label_class 2: 0.8248
2024-08-15 17:28:30,721 : INFO : Average F1 score: 0.8125
2024-08-15 17:28:31,188 : INFO : Average loss over validation batches: 0.4136
2024-08-15 17:28:31,188 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:31,188 : INFO : Validation metrics:
2024-08-15 17:28:31,188 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:31,190 : INFO : Accuracy: 0.8519
2024-08-15 17:28:31,191 : INFO : Precision score for label_class 0: 0.7474
2024-08-15 17:28:31,191 : INFO : Precision score for label_class 1: 0.9156
2024-08-15 17:28:31,191 : INFO : Precision score for label_class 2: 0.7725
2024-08-15 17:28:31,191 : INFO : Recall score for label_class 0: 0.8256
2024-08-15 17:28:31,191 : INFO : Recall score for label_class 1: 0.8950
2024-08-15 17:28:31,191 : INFO : Recall score for label_class 2: 0.7725
2024-08-15 17:28:31,191 : INFO : Average F1 score: 0.8207
2024-08-15 17:28:31,191 : INFO : Validation metric decreased (0.524411 --> 0.413636).  Saving model ...
2024-08-15 17:28:31,295 : INFO : Starting epoch 4
2024-08-15 17:28:31,547 : INFO : Current training batch loss: 0.5278 in epoch 4
2024-08-15 17:28:32,362 : INFO : Current training batch loss: 0.4424 in epoch 4
2024-08-15 17:28:33,177 : INFO : Current training batch loss: 0.3844 in epoch 4
2024-08-15 17:28:33,992 : INFO : Current training batch loss: 0.1952 in epoch 4
2024-08-15 17:28:34,746 : INFO : Epoch finished, average loss over training batches: 0.2922
2024-08-15 17:28:34,746 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:34,746 : INFO : Training metrics:
2024-08-15 17:28:34,747 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:34,754 : INFO : Accuracy: 0.9248
2024-08-15 17:28:34,754 : INFO : Precision score for label_class 0: 0.8349
2024-08-15 17:28:34,754 : INFO : Precision score for label_class 1: 0.9432
2024-08-15 17:28:34,754 : INFO : Precision score for label_class 2: 0.9233
2024-08-15 17:28:34,754 : INFO : Recall score for label_class 0: 0.8323
2024-08-15 17:28:34,754 : INFO : Recall score for label_class 1: 0.9683
2024-08-15 17:28:34,754 : INFO : Recall score for label_class 2: 0.8722
2024-08-15 17:28:34,754 : INFO : Average F1 score: 0.8954
2024-08-15 17:28:35,221 : INFO : Average loss over validation batches: 0.4018
2024-08-15 17:28:35,221 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:35,221 : INFO : Validation metrics:
2024-08-15 17:28:35,221 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:35,224 : INFO : Accuracy: 0.8519
2024-08-15 17:28:35,224 : INFO : Precision score for label_class 0: 0.7500
2024-08-15 17:28:35,224 : INFO : Precision score for label_class 1: 0.9396
2024-08-15 17:28:35,224 : INFO : Precision score for label_class 2: 0.7488
2024-08-15 17:28:35,224 : INFO : Recall score for label_class 0: 0.8372
2024-08-15 17:28:35,224 : INFO : Recall score for label_class 1: 0.8550
2024-08-15 17:28:35,224 : INFO : Recall score for label_class 2: 0.8519
2024-08-15 17:28:35,224 : INFO : Average F1 score: 0.8278
2024-08-15 17:28:35,224 : INFO : Validation metric decreased (0.413636 --> 0.401759).  Saving model ...
2024-08-15 17:28:35,327 : INFO : Starting epoch 5
2024-08-15 17:28:35,379 : INFO : Current training batch loss: 0.1710 in epoch 5
2024-08-15 17:28:36,195 : INFO : Current training batch loss: 0.4713 in epoch 5
2024-08-15 17:28:37,010 : INFO : Current training batch loss: 0.1458 in epoch 5
2024-08-15 17:28:37,826 : INFO : Current training batch loss: 0.2096 in epoch 5
2024-08-15 17:28:38,642 : INFO : Current training batch loss: 0.3158 in epoch 5
2024-08-15 17:28:38,793 : INFO : Epoch finished, average loss over training batches: 0.2427
2024-08-15 17:28:38,793 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:38,793 : INFO : Training metrics:
2024-08-15 17:28:38,793 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:38,797 : INFO : Accuracy: 0.9455
2024-08-15 17:28:38,797 : INFO : Precision score for label_class 0: 0.8720
2024-08-15 17:28:38,797 : INFO : Precision score for label_class 1: 0.9608
2024-08-15 17:28:38,797 : INFO : Precision score for label_class 2: 0.9444
2024-08-15 17:28:38,797 : INFO : Recall score for label_class 0: 0.8720
2024-08-15 17:28:38,797 : INFO : Recall score for label_class 1: 0.9733
2024-08-15 17:28:38,797 : INFO : Recall score for label_class 2: 0.9183
2024-08-15 17:28:38,797 : INFO : Average F1 score: 0.9234
2024-08-15 17:28:39,263 : INFO : Average loss over validation batches: 0.3590
2024-08-15 17:28:39,263 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:39,263 : INFO : Validation metrics:
2024-08-15 17:28:39,263 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:39,266 : INFO : Accuracy: 0.8815
2024-08-15 17:28:39,266 : INFO : Precision score for label_class 0: 0.8068
2024-08-15 17:28:39,266 : INFO : Precision score for label_class 1: 0.9043
2024-08-15 17:28:39,266 : INFO : Precision score for label_class 2: 0.8639
2024-08-15 17:28:39,266 : INFO : Recall score for label_class 0: 0.8256
2024-08-15 17:28:39,266 : INFO : Recall score for label_class 1: 0.9450
2024-08-15 17:28:39,266 : INFO : Recall score for label_class 2: 0.7725
2024-08-15 17:28:39,266 : INFO : Average F1 score: 0.8520
2024-08-15 17:28:39,266 : INFO : Validation metric decreased (0.401759 --> 0.358961).  Saving model ...
2024-08-15 17:28:39,369 : INFO : Split 3 is finished, the score is: 0.8520
2024-08-15 17:28:39,369 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:39,369 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:39,369 : INFO : Starting training for split 4
2024-08-15 17:28:39,384 : INFO : Starting to tokenize the sequences.
2024-08-15 17:28:39,390 : INFO : Tokenization is finished.
2024-08-15 17:28:39,406 : INFO : Starting to tokenize the sequences.
2024-08-15 17:28:39,411 : INFO : Tokenization is finished.
2024-08-15 17:28:39,419 : INFO : Counting occurences of labels...
2024-08-15 17:28:39,420 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 327, 1621,  751]))
2024-08-15 17:28:39,420 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 87, 390, 197]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:28:39,473 : INFO : Starting epoch 1
2024-08-15 17:28:39,525 : INFO : Current training batch loss: 1.1235 in epoch 1
2024-08-15 17:28:40,340 : INFO : Current training batch loss: 1.0625 in epoch 1
2024-08-15 17:28:41,154 : INFO : Current training batch loss: 0.9285 in epoch 1
2024-08-15 17:28:41,969 : INFO : Current training batch loss: 0.8658 in epoch 1
2024-08-15 17:28:42,784 : INFO : Current training batch loss: 0.8087 in epoch 1
2024-08-15 17:28:42,934 : INFO : Epoch finished, average loss over training batches: 0.9340
2024-08-15 17:28:42,935 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:42,935 : INFO : Training metrics:
2024-08-15 17:28:42,935 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:42,942 : INFO : Accuracy: 0.5628
2024-08-15 17:28:42,942 : INFO : Precision score for label_class 0: 0.1473
2024-08-15 17:28:42,942 : INFO : Precision score for label_class 1: 0.6512
2024-08-15 17:28:42,942 : INFO : Precision score for label_class 2: 0.4847
2024-08-15 17:28:42,942 : INFO : Recall score for label_class 0: 0.1743
2024-08-15 17:28:42,942 : INFO : Recall score for label_class 1: 0.8236
2024-08-15 17:28:42,942 : INFO : Recall score for label_class 2: 0.1691
2024-08-15 17:28:42,942 : INFO : Average F1 score: 0.3792
2024-08-15 17:28:43,411 : INFO : Average loss over validation batches: 0.7398
2024-08-15 17:28:43,411 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:43,411 : INFO : Validation metrics:
2024-08-15 17:28:43,411 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:43,415 : INFO : Accuracy: 0.7047
2024-08-15 17:28:43,415 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:28:43,415 : INFO : Precision score for label_class 1: 0.7731
2024-08-15 17:28:43,415 : INFO : Precision score for label_class 2: 0.5404
2024-08-15 17:28:43,415 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:28:43,415 : INFO : Recall score for label_class 1: 0.9436
2024-08-15 17:28:43,415 : INFO : Recall score for label_class 2: 0.5431
2024-08-15 17:28:43,415 : INFO : Average F1 score: 0.4639
2024-08-15 17:28:43,415 : INFO : Validation metric decreased (inf --> 0.739774).  Saving model ...
2024-08-15 17:28:43,527 : INFO : Starting epoch 2
2024-08-15 17:28:44,181 : INFO : Current training batch loss: 0.6786 in epoch 2
2024-08-15 17:28:44,996 : INFO : Current training batch loss: 0.6160 in epoch 2
2024-08-15 17:28:45,809 : INFO : Current training batch loss: 0.4756 in epoch 2
2024-08-15 17:28:46,624 : INFO : Current training batch loss: 0.5104 in epoch 2
2024-08-15 17:28:46,976 : INFO : Epoch finished, average loss over training batches: 0.6027
2024-08-15 17:28:46,976 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:46,976 : INFO : Training metrics:
2024-08-15 17:28:46,976 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:46,984 : INFO : Accuracy: 0.7833
2024-08-15 17:28:46,984 : INFO : Precision score for label_class 0: 0.8136
2024-08-15 17:28:46,984 : INFO : Precision score for label_class 1: 0.8356
2024-08-15 17:28:46,984 : INFO : Precision score for label_class 2: 0.6535
2024-08-15 17:28:46,984 : INFO : Recall score for label_class 0: 0.2936
2024-08-15 17:28:46,984 : INFO : Recall score for label_class 1: 0.9377
2024-08-15 17:28:46,984 : INFO : Recall score for label_class 2: 0.6631
2024-08-15 17:28:46,984 : INFO : Average F1 score: 0.6578
2024-08-15 17:28:47,450 : INFO : Average loss over validation batches: 0.4828
2024-08-15 17:28:47,450 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:47,450 : INFO : Validation metrics:
2024-08-15 17:28:47,450 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:47,453 : INFO : Accuracy: 0.8487
2024-08-15 17:28:47,453 : INFO : Precision score for label_class 0: 0.7564
2024-08-15 17:28:47,453 : INFO : Precision score for label_class 1: 0.8795
2024-08-15 17:28:47,453 : INFO : Precision score for label_class 2: 0.8177
2024-08-15 17:28:47,453 : INFO : Recall score for label_class 0: 0.6782
2024-08-15 17:28:47,453 : INFO : Recall score for label_class 1: 0.9359
2024-08-15 17:28:47,453 : INFO : Recall score for label_class 2: 0.7513
2024-08-15 17:28:47,453 : INFO : Average F1 score: 0.8017
2024-08-15 17:28:47,453 : INFO : Validation metric decreased (0.739774 --> 0.482818).  Saving model ...
2024-08-15 17:28:47,555 : INFO : Starting epoch 3
2024-08-15 17:28:48,009 : INFO : Current training batch loss: 0.3944 in epoch 3
2024-08-15 17:28:48,823 : INFO : Current training batch loss: 0.3950 in epoch 3
2024-08-15 17:28:49,638 : INFO : Current training batch loss: 0.3921 in epoch 3
2024-08-15 17:28:50,453 : INFO : Current training batch loss: 0.2757 in epoch 3
2024-08-15 17:28:51,006 : INFO : Epoch finished, average loss over training batches: 0.3805
2024-08-15 17:28:51,006 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:51,006 : INFO : Training metrics:
2024-08-15 17:28:51,006 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:51,013 : INFO : Accuracy: 0.8940
2024-08-15 17:28:51,013 : INFO : Precision score for label_class 0: 0.8213
2024-08-15 17:28:51,013 : INFO : Precision score for label_class 1: 0.9191
2024-08-15 17:28:51,013 : INFO : Precision score for label_class 2: 0.8680
2024-08-15 17:28:51,013 : INFO : Recall score for label_class 0: 0.8012
2024-08-15 17:28:51,013 : INFO : Recall score for label_class 1: 0.9457
2024-08-15 17:28:51,013 : INFO : Recall score for label_class 2: 0.8229
2024-08-15 17:28:51,013 : INFO : Average F1 score: 0.8627
2024-08-15 17:28:51,485 : INFO : Average loss over validation batches: 0.3969
2024-08-15 17:28:51,485 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:51,485 : INFO : Validation metrics:
2024-08-15 17:28:51,485 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:51,488 : INFO : Accuracy: 0.8694
2024-08-15 17:28:51,488 : INFO : Precision score for label_class 0: 0.7553
2024-08-15 17:28:51,488 : INFO : Precision score for label_class 1: 0.9171
2024-08-15 17:28:51,488 : INFO : Precision score for label_class 2: 0.8299
2024-08-15 17:28:51,488 : INFO : Recall score for label_class 0: 0.8161
2024-08-15 17:28:51,488 : INFO : Recall score for label_class 1: 0.9077
2024-08-15 17:28:51,488 : INFO : Recall score for label_class 2: 0.8173
2024-08-15 17:28:51,488 : INFO : Average F1 score: 0.8401
2024-08-15 17:28:51,488 : INFO : Validation metric decreased (0.482818 --> 0.396861).  Saving model ...
2024-08-15 17:28:51,591 : INFO : Starting epoch 4
2024-08-15 17:28:51,857 : INFO : Current training batch loss: 0.4264 in epoch 4
2024-08-15 17:28:52,671 : INFO : Current training batch loss: 0.3345 in epoch 4
2024-08-15 17:28:53,485 : INFO : Current training batch loss: 0.2609 in epoch 4
2024-08-15 17:28:54,299 : INFO : Current training batch loss: 0.2047 in epoch 4
2024-08-15 17:28:55,054 : INFO : Epoch finished, average loss over training batches: 0.2696
2024-08-15 17:28:55,054 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:55,054 : INFO : Training metrics:
2024-08-15 17:28:55,054 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:55,061 : INFO : Accuracy: 0.9329
2024-08-15 17:28:55,061 : INFO : Precision score for label_class 0: 0.8657
2024-08-15 17:28:55,061 : INFO : Precision score for label_class 1: 0.9490
2024-08-15 17:28:55,061 : INFO : Precision score for label_class 2: 0.9274
2024-08-15 17:28:55,061 : INFO : Recall score for label_class 0: 0.8869
2024-08-15 17:28:55,061 : INFO : Recall score for label_class 1: 0.9648
2024-08-15 17:28:55,061 : INFO : Recall score for label_class 2: 0.8842
2024-08-15 17:28:55,061 : INFO : Average F1 score: 0.9127
2024-08-15 17:28:55,529 : INFO : Average loss over validation batches: 0.3772
2024-08-15 17:28:55,529 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:55,529 : INFO : Validation metrics:
2024-08-15 17:28:55,529 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:55,533 : INFO : Accuracy: 0.8754
2024-08-15 17:28:55,533 : INFO : Precision score for label_class 0: 0.7660
2024-08-15 17:28:55,533 : INFO : Precision score for label_class 1: 0.9219
2024-08-15 17:28:55,533 : INFO : Precision score for label_class 2: 0.8367
2024-08-15 17:28:55,533 : INFO : Recall score for label_class 0: 0.8276
2024-08-15 17:28:55,533 : INFO : Recall score for label_class 1: 0.9077
2024-08-15 17:28:55,533 : INFO : Recall score for label_class 2: 0.8325
2024-08-15 17:28:55,533 : INFO : Average F1 score: 0.8483
2024-08-15 17:28:55,533 : INFO : Validation metric decreased (0.396861 --> 0.377243).  Saving model ...
2024-08-15 17:28:55,635 : INFO : Starting epoch 5
2024-08-15 17:28:55,686 : INFO : Current training batch loss: 0.1867 in epoch 5
2024-08-15 17:28:56,499 : INFO : Current training batch loss: 0.4138 in epoch 5
2024-08-15 17:28:57,316 : INFO : Current training batch loss: 0.1459 in epoch 5
2024-08-15 17:28:58,495 : INFO : Current training batch loss: 0.2655 in epoch 5
2024-08-15 17:28:59,339 : INFO : Current training batch loss: 0.2882 in epoch 5
2024-08-15 17:28:59,497 : INFO : Epoch finished, average loss over training batches: 0.2203
2024-08-15 17:28:59,497 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:59,498 : INFO : Training metrics:
2024-08-15 17:28:59,498 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:28:59,505 : INFO : Accuracy: 0.9507
2024-08-15 17:28:59,505 : INFO : Precision score for label_class 0: 0.8850
2024-08-15 17:28:59,505 : INFO : Precision score for label_class 1: 0.9686
2024-08-15 17:28:59,505 : INFO : Precision score for label_class 2: 0.9417
2024-08-15 17:28:59,505 : INFO : Recall score for label_class 0: 0.9174
2024-08-15 17:28:59,505 : INFO : Recall score for label_class 1: 0.9698
2024-08-15 17:28:59,505 : INFO : Recall score for label_class 2: 0.9241
2024-08-15 17:28:59,505 : INFO : Average F1 score: 0.9343
2024-08-15 17:29:00,006 : INFO : Average loss over validation batches: 0.3679
2024-08-15 17:29:00,007 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:00,007 : INFO : Validation metrics:
2024-08-15 17:29:00,007 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:00,011 : INFO : Accuracy: 0.8783
2024-08-15 17:29:00,011 : INFO : Precision score for label_class 0: 0.8023
2024-08-15 17:29:00,011 : INFO : Precision score for label_class 1: 0.9050
2024-08-15 17:29:00,011 : INFO : Precision score for label_class 2: 0.8564
2024-08-15 17:29:00,011 : INFO : Recall score for label_class 0: 0.7931
2024-08-15 17:29:00,011 : INFO : Recall score for label_class 1: 0.9282
2024-08-15 17:29:00,011 : INFO : Recall score for label_class 2: 0.8173
2024-08-15 17:29:00,011 : INFO : Average F1 score: 0.8502
2024-08-15 17:29:00,011 : INFO : Validation metric decreased (0.377243 --> 0.367924).  Saving model ...
2024-08-15 17:29:00,119 : INFO : Split 4 is finished, the score is: 0.8502
2024-08-15 17:29:00,119 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:00,119 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:00,119 : INFO : Starting training for split 5
2024-08-15 17:29:00,133 : INFO : Starting to tokenize the sequences.
2024-08-15 17:29:00,138 : INFO : Tokenization is finished.
2024-08-15 17:29:00,155 : INFO : Starting to tokenize the sequences.
2024-08-15 17:29:00,160 : INFO : Tokenization is finished.
2024-08-15 17:29:00,164 : INFO : Counting occurences of labels...
2024-08-15 17:29:00,165 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 330, 1615,  754]))
2024-08-15 17:29:00,165 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 84, 396, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:29:00,213 : INFO : Starting epoch 1
2024-08-15 17:29:00,264 : INFO : Current training batch loss: 1.0890 in epoch 1
2024-08-15 17:29:01,078 : INFO : Current training batch loss: 1.0477 in epoch 1
2024-08-15 17:29:01,892 : INFO : Current training batch loss: 0.9248 in epoch 1
2024-08-15 17:29:02,706 : INFO : Current training batch loss: 0.8599 in epoch 1
2024-08-15 17:29:03,522 : INFO : Current training batch loss: 0.8175 in epoch 1
2024-08-15 17:29:03,673 : INFO : Epoch finished, average loss over training batches: 0.9234
2024-08-15 17:29:03,674 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:03,674 : INFO : Training metrics:
2024-08-15 17:29:03,674 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:03,685 : INFO : Accuracy: 0.6376
2024-08-15 17:29:03,685 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:29:03,685 : INFO : Precision score for label_class 1: 0.6458
2024-08-15 17:29:03,685 : INFO : Precision score for label_class 2: 0.5560
2024-08-15 17:29:03,685 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:29:03,685 : INFO : Recall score for label_class 1: 0.9858
2024-08-15 17:29:03,685 : INFO : Recall score for label_class 2: 0.1711
2024-08-15 17:29:03,685 : INFO : Average F1 score: 0.3474
2024-08-15 17:29:04,152 : INFO : Average loss over validation batches: 0.7119
2024-08-15 17:29:04,152 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:04,152 : INFO : Validation metrics:
2024-08-15 17:29:04,152 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:04,156 : INFO : Accuracy: 0.7329
2024-08-15 17:29:04,156 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:29:04,156 : INFO : Precision score for label_class 1: 0.8099
2024-08-15 17:29:04,156 : INFO : Precision score for label_class 2: 0.5640
2024-08-15 17:29:04,156 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:29:04,156 : INFO : Recall score for label_class 1: 0.9470
2024-08-15 17:29:04,156 : INFO : Recall score for label_class 2: 0.6134
2024-08-15 17:29:04,156 : INFO : Average F1 score: 0.4869
2024-08-15 17:29:04,156 : INFO : Validation metric decreased (inf --> 0.711908).  Saving model ...
2024-08-15 17:29:04,257 : INFO : Starting epoch 2
2024-08-15 17:29:04,912 : INFO : Current training batch loss: 0.6667 in epoch 2
2024-08-15 17:29:05,731 : INFO : Current training batch loss: 0.5864 in epoch 2
2024-08-15 17:29:06,542 : INFO : Current training batch loss: 0.4886 in epoch 2
2024-08-15 17:29:07,355 : INFO : Current training batch loss: 0.5414 in epoch 2
2024-08-15 17:29:07,700 : INFO : Epoch finished, average loss over training batches: 0.5914
2024-08-15 17:29:07,700 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:07,700 : INFO : Training metrics:
2024-08-15 17:29:07,700 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:07,712 : INFO : Accuracy: 0.7933
2024-08-15 17:29:07,713 : INFO : Precision score for label_class 0: 0.8571
2024-08-15 17:29:07,713 : INFO : Precision score for label_class 1: 0.8462
2024-08-15 17:29:07,713 : INFO : Precision score for label_class 2: 0.6667
2024-08-15 17:29:07,713 : INFO : Recall score for label_class 0: 0.2182
2024-08-15 17:29:07,713 : INFO : Recall score for label_class 1: 0.9505
2024-08-15 17:29:07,713 : INFO : Recall score for label_class 2: 0.7082
2024-08-15 17:29:07,713 : INFO : Average F1 score: 0.6433
2024-08-15 17:29:08,193 : INFO : Average loss over validation batches: 0.5165
2024-08-15 17:29:08,193 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:08,193 : INFO : Validation metrics:
2024-08-15 17:29:08,193 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:08,197 : INFO : Accuracy: 0.8175
2024-08-15 17:29:08,197 : INFO : Precision score for label_class 0: 0.7778
2024-08-15 17:29:08,198 : INFO : Precision score for label_class 1: 0.8145
2024-08-15 17:29:08,198 : INFO : Precision score for label_class 2: 0.8451
2024-08-15 17:29:08,198 : INFO : Recall score for label_class 0: 0.5833
2024-08-15 17:29:08,198 : INFO : Recall score for label_class 1: 0.9646
2024-08-15 17:29:08,198 : INFO : Recall score for label_class 2: 0.6186
2024-08-15 17:29:08,198 : INFO : Average F1 score: 0.7547
2024-08-15 17:29:08,198 : INFO : Validation metric decreased (0.711908 --> 0.516450).  Saving model ...
2024-08-15 17:29:08,309 : INFO : Starting epoch 3
2024-08-15 17:29:08,777 : INFO : Current training batch loss: 0.4094 in epoch 3
2024-08-15 17:29:09,621 : INFO : Current training batch loss: 0.4810 in epoch 3
2024-08-15 17:29:10,461 : INFO : Current training batch loss: 0.3708 in epoch 3
2024-08-15 17:29:11,298 : INFO : Current training batch loss: 0.3287 in epoch 3
2024-08-15 17:29:11,869 : INFO : Epoch finished, average loss over training batches: 0.3875
2024-08-15 17:29:11,870 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:11,870 : INFO : Training metrics:
2024-08-15 17:29:11,870 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:11,877 : INFO : Accuracy: 0.8907
2024-08-15 17:29:11,877 : INFO : Precision score for label_class 0: 0.8173
2024-08-15 17:29:11,877 : INFO : Precision score for label_class 1: 0.9126
2024-08-15 17:29:11,877 : INFO : Precision score for label_class 2: 0.8711
2024-08-15 17:29:11,877 : INFO : Recall score for label_class 0: 0.7727
2024-08-15 17:29:11,877 : INFO : Recall score for label_class 1: 0.9498
2024-08-15 17:29:11,877 : INFO : Recall score for label_class 2: 0.8156
2024-08-15 17:29:11,877 : INFO : Average F1 score: 0.8559
2024-08-15 17:29:12,343 : INFO : Average loss over validation batches: 0.4176
2024-08-15 17:29:12,344 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:12,344 : INFO : Validation metrics:
2024-08-15 17:29:12,344 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:12,347 : INFO : Accuracy: 0.8546
2024-08-15 17:29:12,347 : INFO : Precision score for label_class 0: 0.8000
2024-08-15 17:29:12,348 : INFO : Precision score for label_class 1: 0.8807
2024-08-15 17:29:12,348 : INFO : Precision score for label_class 2: 0.8167
2024-08-15 17:29:12,348 : INFO : Recall score for label_class 0: 0.7143
2024-08-15 17:29:12,348 : INFO : Recall score for label_class 1: 0.9318
2024-08-15 17:29:12,348 : INFO : Recall score for label_class 2: 0.7577
2024-08-15 17:29:12,348 : INFO : Average F1 score: 0.8154
2024-08-15 17:29:12,348 : INFO : Validation metric decreased (0.516450 --> 0.417617).  Saving model ...
2024-08-15 17:29:12,449 : INFO : Starting epoch 4
2024-08-15 17:29:12,711 : INFO : Current training batch loss: 0.5025 in epoch 4
2024-08-15 17:29:13,560 : INFO : Current training batch loss: 0.3821 in epoch 4
2024-08-15 17:29:14,420 : INFO : Current training batch loss: 0.2801 in epoch 4
2024-08-15 17:29:15,238 : INFO : Current training batch loss: 0.1771 in epoch 4
2024-08-15 17:29:16,015 : INFO : Epoch finished, average loss over training batches: 0.2777
2024-08-15 17:29:16,015 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:16,015 : INFO : Training metrics:
2024-08-15 17:29:16,015 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:16,026 : INFO : Accuracy: 0.9333
2024-08-15 17:29:16,026 : INFO : Precision score for label_class 0: 0.8727
2024-08-15 17:29:16,026 : INFO : Precision score for label_class 1: 0.9488
2024-08-15 17:29:16,026 : INFO : Precision score for label_class 2: 0.9258
2024-08-15 17:29:16,026 : INFO : Recall score for label_class 0: 0.8727
2024-08-15 17:29:16,026 : INFO : Recall score for label_class 1: 0.9641
2024-08-15 17:29:16,026 : INFO : Recall score for label_class 2: 0.8939
2024-08-15 17:29:16,026 : INFO : Average F1 score: 0.9129
2024-08-15 17:29:16,491 : INFO : Average loss over validation batches: 0.3938
2024-08-15 17:29:16,491 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:16,491 : INFO : Validation metrics:
2024-08-15 17:29:16,491 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:16,494 : INFO : Accuracy: 0.8576
2024-08-15 17:29:16,494 : INFO : Precision score for label_class 0: 0.7821
2024-08-15 17:29:16,494 : INFO : Precision score for label_class 1: 0.9066
2024-08-15 17:29:16,494 : INFO : Precision score for label_class 2: 0.7900
2024-08-15 17:29:16,494 : INFO : Recall score for label_class 0: 0.7262
2024-08-15 17:29:16,494 : INFO : Recall score for label_class 1: 0.9066
2024-08-15 17:29:16,494 : INFO : Recall score for label_class 2: 0.8144
2024-08-15 17:29:16,494 : INFO : Average F1 score: 0.8206
2024-08-15 17:29:16,494 : INFO : Validation metric decreased (0.417617 --> 0.393829).  Saving model ...
2024-08-15 17:29:16,595 : INFO : Starting epoch 5
2024-08-15 17:29:16,646 : INFO : Current training batch loss: 0.1715 in epoch 5
2024-08-15 17:29:17,493 : INFO : Current training batch loss: 0.3412 in epoch 5
2024-08-15 17:29:18,316 : INFO : Current training batch loss: 0.2154 in epoch 5
2024-08-15 17:29:19,138 : INFO : Current training batch loss: 0.2446 in epoch 5
2024-08-15 17:29:19,954 : INFO : Current training batch loss: 0.1360 in epoch 5
2024-08-15 17:29:20,105 : INFO : Epoch finished, average loss over training batches: 0.2237
2024-08-15 17:29:20,105 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:20,105 : INFO : Training metrics:
2024-08-15 17:29:20,105 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:20,113 : INFO : Accuracy: 0.9500
2024-08-15 17:29:20,113 : INFO : Precision score for label_class 0: 0.9036
2024-08-15 17:29:20,113 : INFO : Precision score for label_class 1: 0.9598
2024-08-15 17:29:20,113 : INFO : Precision score for label_class 2: 0.9491
2024-08-15 17:29:20,113 : INFO : Recall score for label_class 0: 0.9091
2024-08-15 17:29:20,113 : INFO : Recall score for label_class 1: 0.9746
2024-08-15 17:29:20,113 : INFO : Recall score for label_class 2: 0.9151
2024-08-15 17:29:20,113 : INFO : Average F1 score: 0.9351
2024-08-15 17:29:20,583 : INFO : Average loss over validation batches: 0.3877
2024-08-15 17:29:20,583 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:20,583 : INFO : Validation metrics:
2024-08-15 17:29:20,583 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:20,587 : INFO : Accuracy: 0.8605
2024-08-15 17:29:20,587 : INFO : Precision score for label_class 0: 0.8133
2024-08-15 17:29:20,587 : INFO : Precision score for label_class 1: 0.8908
2024-08-15 17:29:20,587 : INFO : Precision score for label_class 2: 0.8128
2024-08-15 17:29:20,587 : INFO : Recall score for label_class 0: 0.7262
2024-08-15 17:29:20,587 : INFO : Recall score for label_class 1: 0.9268
2024-08-15 17:29:20,587 : INFO : Recall score for label_class 2: 0.7835
2024-08-15 17:29:20,587 : INFO : Average F1 score: 0.8245
2024-08-15 17:29:20,587 : INFO : Validation metric decreased (0.393829 --> 0.387689).  Saving model ...
2024-08-15 17:29:20,689 : INFO : Split 5 is finished, the score is: 0.8245
2024-08-15 17:29:20,689 : INFO : ----------------------------------------------------------------------------------------------------
[I 2024-08-15 17:29:20,698] Trial 12 finished with value: 0.8483122549865028 and parameters: {'n_epochs': 5, 'learning_rate': 2.5983138541835686e-05, 'classifier_dropout': 0.6868890983445625, 'warmup_step_fraction': 0.06941469415703722, 'use_gradient_clipping': False}. Best is trial 1 with value: 0.8513001269595835.
2024-08-15 17:29:20,707 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:20,707 : INFO : Starting training for split 1
2024-08-15 17:29:20,719 : INFO : Starting to tokenize the sequences.
2024-08-15 17:29:20,725 : INFO : Tokenization is finished.
2024-08-15 17:29:20,736 : INFO : Starting to tokenize the sequences.
2024-08-15 17:29:20,741 : INFO : Tokenization is finished.
2024-08-15 17:29:20,741 : INFO : Counting occurences of labels...
2024-08-15 17:29:20,742 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1596,  774]))
2024-08-15 17:29:20,743 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 415, 174]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:29:20,784 : INFO : Starting epoch 1
2024-08-15 17:29:20,835 : INFO : Current training batch loss: 1.1058 in epoch 1
2024-08-15 17:29:21,726 : INFO : Current training batch loss: 0.8647 in epoch 1
2024-08-15 17:29:22,537 : INFO : Current training batch loss: 0.7874 in epoch 1
2024-08-15 17:29:23,348 : INFO : Current training batch loss: 0.6835 in epoch 1
2024-08-15 17:29:24,159 : INFO : Current training batch loss: 0.6047 in epoch 1
2024-08-15 17:29:24,301 : INFO : Epoch finished, average loss over training batches: 0.8076
2024-08-15 17:29:24,302 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:24,302 : INFO : Training metrics:
2024-08-15 17:29:24,302 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:24,312 : INFO : Accuracy: 0.6620
2024-08-15 17:29:24,312 : INFO : Precision score for label_class 0: 0.1277
2024-08-15 17:29:24,312 : INFO : Precision score for label_class 1: 0.7119
2024-08-15 17:29:24,312 : INFO : Precision score for label_class 2: 0.5606
2024-08-15 17:29:24,312 : INFO : Recall score for label_class 0: 0.0366
2024-08-15 17:29:24,312 : INFO : Recall score for label_class 1: 0.9261
2024-08-15 17:29:24,312 : INFO : Recall score for label_class 2: 0.3824
2024-08-15 17:29:24,312 : INFO : Average F1 score: 0.4389
2024-08-15 17:29:24,780 : INFO : Average loss over validation batches: 0.5904
2024-08-15 17:29:24,780 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:24,780 : INFO : Validation metrics:
2024-08-15 17:29:24,780 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:24,783 : INFO : Accuracy: 0.7541
2024-08-15 17:29:24,783 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:29:24,783 : INFO : Precision score for label_class 1: 0.8741
2024-08-15 17:29:24,783 : INFO : Precision score for label_class 2: 0.5447
2024-08-15 17:29:24,783 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:29:24,783 : INFO : Recall score for label_class 1: 0.9036
2024-08-15 17:29:24,783 : INFO : Recall score for label_class 2: 0.7701
2024-08-15 17:29:24,783 : INFO : Average F1 score: 0.5089
2024-08-15 17:29:24,783 : INFO : Validation metric decreased (inf --> 0.590417).  Saving model ...
2024-08-15 17:29:24,887 : INFO : Starting epoch 2
2024-08-15 17:29:25,541 : INFO : Current training batch loss: 0.2769 in epoch 2
2024-08-15 17:29:26,355 : INFO : Current training batch loss: 0.5759 in epoch 2
2024-08-15 17:29:27,168 : INFO : Current training batch loss: 0.4187 in epoch 2
2024-08-15 17:29:27,980 : INFO : Current training batch loss: 0.4213 in epoch 2
2024-08-15 17:29:28,333 : INFO : Epoch finished, average loss over training batches: 0.4373
2024-08-15 17:29:28,333 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:28,333 : INFO : Training metrics:
2024-08-15 17:29:28,333 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:28,341 : INFO : Accuracy: 0.8510
2024-08-15 17:29:28,341 : INFO : Precision score for label_class 0: 0.7843
2024-08-15 17:29:28,341 : INFO : Precision score for label_class 1: 0.8867
2024-08-15 17:29:28,342 : INFO : Precision score for label_class 2: 0.7939
2024-08-15 17:29:28,342 : INFO : Recall score for label_class 0: 0.6098
2024-08-15 17:29:28,342 : INFO : Recall score for label_class 1: 0.9367
2024-08-15 17:29:28,342 : INFO : Recall score for label_class 2: 0.7765
2024-08-15 17:29:28,342 : INFO : Average F1 score: 0.7941
2024-08-15 17:29:28,811 : INFO : Average loss over validation batches: 0.3655
2024-08-15 17:29:28,811 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:28,811 : INFO : Validation metrics:
2024-08-15 17:29:28,811 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:28,815 : INFO : Accuracy: 0.8711
2024-08-15 17:29:28,815 : INFO : Precision score for label_class 0: 0.7708
2024-08-15 17:29:28,815 : INFO : Precision score for label_class 1: 0.8940
2024-08-15 17:29:28,815 : INFO : Precision score for label_class 2: 0.8690
2024-08-15 17:29:28,815 : INFO : Recall score for label_class 0: 0.8605
2024-08-15 17:29:28,815 : INFO : Recall score for label_class 1: 0.9349
2024-08-15 17:29:28,815 : INFO : Recall score for label_class 2: 0.7241
2024-08-15 17:29:28,815 : INFO : Average F1 score: 0.8391
2024-08-15 17:29:28,815 : INFO : Validation metric decreased (0.590417 --> 0.365503).  Saving model ...
2024-08-15 17:29:28,916 : INFO : Starting epoch 3
2024-08-15 17:29:29,377 : INFO : Current training batch loss: 0.3039 in epoch 3
2024-08-15 17:29:30,216 : INFO : Current training batch loss: 0.2627 in epoch 3
2024-08-15 17:29:31,050 : INFO : Current training batch loss: 0.2664 in epoch 3
2024-08-15 17:29:31,885 : INFO : Current training batch loss: 0.1463 in epoch 3
2024-08-15 17:29:32,438 : INFO : Epoch finished, average loss over training batches: 0.2577
2024-08-15 17:29:32,439 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:32,439 : INFO : Training metrics:
2024-08-15 17:29:32,439 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:32,447 : INFO : Accuracy: 0.9211
2024-08-15 17:29:32,447 : INFO : Precision score for label_class 0: 0.8382
2024-08-15 17:29:32,447 : INFO : Precision score for label_class 1: 0.9483
2024-08-15 17:29:32,447 : INFO : Precision score for label_class 2: 0.9011
2024-08-15 17:29:32,447 : INFO : Recall score for label_class 0: 0.8841
2024-08-15 17:29:32,447 : INFO : Recall score for label_class 1: 0.9530
2024-08-15 17:29:32,447 : INFO : Recall score for label_class 2: 0.8708
2024-08-15 17:29:32,447 : INFO : Average F1 score: 0.8989
2024-08-15 17:29:32,919 : INFO : Average loss over validation batches: 0.3267
2024-08-15 17:29:32,919 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:32,919 : INFO : Validation metrics:
2024-08-15 17:29:32,919 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:32,922 : INFO : Accuracy: 0.8889
2024-08-15 17:29:32,922 : INFO : Precision score for label_class 0: 0.8148
2024-08-15 17:29:32,922 : INFO : Precision score for label_class 1: 0.9180
2024-08-15 17:29:32,922 : INFO : Precision score for label_class 2: 0.8503
2024-08-15 17:29:32,922 : INFO : Recall score for label_class 0: 0.7674
2024-08-15 17:29:32,922 : INFO : Recall score for label_class 1: 0.9446
2024-08-15 17:29:32,922 : INFO : Recall score for label_class 2: 0.8161
2024-08-15 17:29:32,922 : INFO : Average F1 score: 0.8515
2024-08-15 17:29:32,922 : INFO : Validation metric decreased (0.365503 --> 0.326747).  Saving model ...
2024-08-15 17:29:33,026 : INFO : Starting epoch 4
2024-08-15 17:29:33,285 : INFO : Current training batch loss: 0.6210 in epoch 4
2024-08-15 17:29:34,127 : INFO : Current training batch loss: 0.1588 in epoch 4
2024-08-15 17:29:34,976 : INFO : Current training batch loss: 0.2287 in epoch 4
2024-08-15 17:29:35,812 : INFO : Current training batch loss: 0.1335 in epoch 4
2024-08-15 17:29:36,592 : INFO : Epoch finished, average loss over training batches: 0.1593
2024-08-15 17:29:36,592 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:36,592 : INFO : Training metrics:
2024-08-15 17:29:36,592 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:36,600 : INFO : Accuracy: 0.9552
2024-08-15 17:29:36,600 : INFO : Precision score for label_class 0: 0.8892
2024-08-15 17:29:36,600 : INFO : Precision score for label_class 1: 0.9678
2024-08-15 17:29:36,600 : INFO : Precision score for label_class 2: 0.9582
2024-08-15 17:29:36,600 : INFO : Recall score for label_class 0: 0.9299
2024-08-15 17:29:36,600 : INFO : Recall score for label_class 1: 0.9781
2024-08-15 17:29:36,600 : INFO : Recall score for label_class 2: 0.9186
2024-08-15 17:29:36,600 : INFO : Average F1 score: 0.9400
2024-08-15 17:29:37,071 : INFO : Average loss over validation batches: 0.4030
2024-08-15 17:29:37,071 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:37,072 : INFO : Validation metrics:
2024-08-15 17:29:37,072 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:37,074 : INFO : Accuracy: 0.8548
2024-08-15 17:29:37,074 : INFO : Precision score for label_class 0: 0.7822
2024-08-15 17:29:37,074 : INFO : Precision score for label_class 1: 0.9579
2024-08-15 17:29:37,074 : INFO : Precision score for label_class 2: 0.7202
2024-08-15 17:29:37,074 : INFO : Recall score for label_class 0: 0.9186
2024-08-15 17:29:37,074 : INFO : Recall score for label_class 1: 0.8217
2024-08-15 17:29:37,074 : INFO : Recall score for label_class 2: 0.9023
2024-08-15 17:29:37,074 : INFO : Average F1 score: 0.8435
2024-08-15 17:29:37,074 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:29:37,074 : INFO : Starting epoch 5
2024-08-15 17:29:37,125 : INFO : Current training batch loss: 0.1529 in epoch 5
2024-08-15 17:29:37,944 : INFO : Current training batch loss: 0.1978 in epoch 5
2024-08-15 17:29:38,783 : INFO : Current training batch loss: 0.0394 in epoch 5
2024-08-15 17:29:39,608 : INFO : Current training batch loss: 0.0615 in epoch 5
2024-08-15 17:29:40,449 : INFO : Current training batch loss: 0.1611 in epoch 5
2024-08-15 17:29:40,606 : INFO : Epoch finished, average loss over training batches: 0.1040
2024-08-15 17:29:40,606 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:40,606 : INFO : Training metrics:
2024-08-15 17:29:40,606 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:40,611 : INFO : Accuracy: 0.9741
2024-08-15 17:29:40,611 : INFO : Precision score for label_class 0: 0.9298
2024-08-15 17:29:40,611 : INFO : Precision score for label_class 1: 0.9819
2024-08-15 17:29:40,611 : INFO : Precision score for label_class 2: 0.9775
2024-08-15 17:29:40,611 : INFO : Recall score for label_class 0: 0.9695
2024-08-15 17:29:40,611 : INFO : Recall score for label_class 1: 0.9843
2024-08-15 17:29:40,611 : INFO : Recall score for label_class 2: 0.9548
2024-08-15 17:29:40,611 : INFO : Average F1 score: 0.9661
2024-08-15 17:29:41,080 : INFO : Average loss over validation batches: 0.3202
2024-08-15 17:29:41,081 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:41,081 : INFO : Validation metrics:
2024-08-15 17:29:41,081 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:41,084 : INFO : Accuracy: 0.9067
2024-08-15 17:29:41,084 : INFO : Precision score for label_class 0: 0.8021
2024-08-15 17:29:41,084 : INFO : Precision score for label_class 1: 0.9267
2024-08-15 17:29:41,084 : INFO : Precision score for label_class 2: 0.9167
2024-08-15 17:29:41,084 : INFO : Recall score for label_class 0: 0.8953
2024-08-15 17:29:41,084 : INFO : Recall score for label_class 1: 0.9446
2024-08-15 17:29:41,084 : INFO : Recall score for label_class 2: 0.8218
2024-08-15 17:29:41,084 : INFO : Average F1 score: 0.8828
2024-08-15 17:29:41,084 : INFO : Validation metric decreased (0.326747 --> 0.320167).  Saving model ...
2024-08-15 17:29:41,181 : INFO : Starting epoch 6
2024-08-15 17:29:41,855 : INFO : Current training batch loss: 0.0214 in epoch 6
2024-08-15 17:29:42,673 : INFO : Current training batch loss: 0.0268 in epoch 6
2024-08-15 17:29:43,491 : INFO : Current training batch loss: 0.0212 in epoch 6
2024-08-15 17:29:44,335 : INFO : Current training batch loss: 0.0181 in epoch 6
2024-08-15 17:29:44,701 : INFO : Epoch finished, average loss over training batches: 0.0635
2024-08-15 17:29:44,702 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:44,702 : INFO : Training metrics:
2024-08-15 17:29:44,702 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:44,706 : INFO : Accuracy: 0.9878
2024-08-15 17:29:44,706 : INFO : Precision score for label_class 0: 0.9585
2024-08-15 17:29:44,706 : INFO : Precision score for label_class 1: 0.9931
2024-08-15 17:29:44,706 : INFO : Precision score for label_class 2: 0.9895
2024-08-15 17:29:44,706 : INFO : Recall score for label_class 0: 0.9848
2024-08-15 17:29:44,706 : INFO : Recall score for label_class 1: 0.9937
2024-08-15 17:29:44,706 : INFO : Recall score for label_class 2: 0.9767
2024-08-15 17:29:44,706 : INFO : Average F1 score: 0.9826
2024-08-15 17:29:45,175 : INFO : Average loss over validation batches: 0.3620
2024-08-15 17:29:45,175 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:45,175 : INFO : Validation metrics:
2024-08-15 17:29:45,175 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:45,179 : INFO : Accuracy: 0.8889
2024-08-15 17:29:45,179 : INFO : Precision score for label_class 0: 0.7677
2024-08-15 17:29:45,179 : INFO : Precision score for label_class 1: 0.9153
2024-08-15 17:29:45,179 : INFO : Precision score for label_class 2: 0.8940
2024-08-15 17:29:45,179 : INFO : Recall score for label_class 0: 0.8837
2024-08-15 17:29:45,179 : INFO : Recall score for label_class 1: 0.9373
2024-08-15 17:29:45,179 : INFO : Recall score for label_class 2: 0.7759
2024-08-15 17:29:45,179 : INFO : Average F1 score: 0.8595
2024-08-15 17:29:45,179 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:29:45,179 : INFO : Starting epoch 7
2024-08-15 17:29:45,647 : INFO : Current training batch loss: 0.0958 in epoch 7
2024-08-15 17:29:46,493 : INFO : Current training batch loss: 0.0227 in epoch 7
2024-08-15 17:29:47,340 : INFO : Current training batch loss: 0.0292 in epoch 7
2024-08-15 17:29:48,179 : INFO : Current training batch loss: 0.0183 in epoch 7
2024-08-15 17:29:48,758 : INFO : Epoch finished, average loss over training batches: 0.0492
2024-08-15 17:29:48,758 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:48,758 : INFO : Training metrics:
2024-08-15 17:29:48,758 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:48,766 : INFO : Accuracy: 0.9911
2024-08-15 17:29:48,766 : INFO : Precision score for label_class 0: 0.9644
2024-08-15 17:29:48,766 : INFO : Precision score for label_class 1: 0.9944
2024-08-15 17:29:48,766 : INFO : Precision score for label_class 2: 0.9961
2024-08-15 17:29:48,766 : INFO : Recall score for label_class 0: 0.9909
2024-08-15 17:29:48,766 : INFO : Recall score for label_class 1: 0.9969
2024-08-15 17:29:48,766 : INFO : Recall score for label_class 2: 0.9793
2024-08-15 17:29:48,766 : INFO : Average F1 score: 0.9869
2024-08-15 17:29:49,235 : INFO : Average loss over validation batches: 0.3544
2024-08-15 17:29:49,235 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:49,235 : INFO : Validation metrics:
2024-08-15 17:29:49,235 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:49,238 : INFO : Accuracy: 0.8874
2024-08-15 17:29:49,238 : INFO : Precision score for label_class 0: 0.8090
2024-08-15 17:29:49,238 : INFO : Precision score for label_class 1: 0.9207
2024-08-15 17:29:49,238 : INFO : Precision score for label_class 2: 0.8471
2024-08-15 17:29:49,238 : INFO : Recall score for label_class 0: 0.8372
2024-08-15 17:29:49,238 : INFO : Recall score for label_class 1: 0.9229
2024-08-15 17:29:49,238 : INFO : Recall score for label_class 2: 0.8276
2024-08-15 17:29:49,238 : INFO : Average F1 score: 0.8606
2024-08-15 17:29:49,238 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:29:49,238 : INFO : Starting epoch 8
2024-08-15 17:29:49,494 : INFO : Current training batch loss: 0.0544 in epoch 8
2024-08-15 17:29:50,334 : INFO : Current training batch loss: 0.0178 in epoch 8
2024-08-15 17:29:51,175 : INFO : Current training batch loss: 0.1514 in epoch 8
2024-08-15 17:29:52,019 : INFO : Current training batch loss: 0.0248 in epoch 8
2024-08-15 17:29:52,787 : INFO : Epoch finished, average loss over training batches: 0.0391
2024-08-15 17:29:52,787 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:52,787 : INFO : Training metrics:
2024-08-15 17:29:52,787 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:52,792 : INFO : Accuracy: 0.9930
2024-08-15 17:29:52,792 : INFO : Precision score for label_class 0: 0.9731
2024-08-15 17:29:52,792 : INFO : Precision score for label_class 1: 0.9950
2024-08-15 17:29:52,792 : INFO : Precision score for label_class 2: 0.9974
2024-08-15 17:29:52,792 : INFO : Recall score for label_class 0: 0.9909
2024-08-15 17:29:52,792 : INFO : Recall score for label_class 1: 0.9975
2024-08-15 17:29:52,792 : INFO : Recall score for label_class 2: 0.9845
2024-08-15 17:29:52,792 : INFO : Average F1 score: 0.9897
2024-08-15 17:29:53,263 : INFO : Average loss over validation batches: 0.3581
2024-08-15 17:29:53,263 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:53,263 : INFO : Validation metrics:
2024-08-15 17:29:53,263 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:53,266 : INFO : Accuracy: 0.8889
2024-08-15 17:29:53,266 : INFO : Precision score for label_class 0: 0.8068
2024-08-15 17:29:53,266 : INFO : Precision score for label_class 1: 0.9293
2024-08-15 17:29:53,266 : INFO : Precision score for label_class 2: 0.8362
2024-08-15 17:29:53,266 : INFO : Recall score for label_class 0: 0.8256
2024-08-15 17:29:53,266 : INFO : Recall score for label_class 1: 0.9181
2024-08-15 17:29:53,266 : INFO : Recall score for label_class 2: 0.8506
2024-08-15 17:29:53,266 : INFO : Average F1 score: 0.8610
2024-08-15 17:29:53,266 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:29:53,266 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:29:53,300 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:29:53,802 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:53,802 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:29:53,802 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:53,805 : INFO : Accuracy: 0.9067
2024-08-15 17:29:53,805 : INFO : Precision score for label_class 0: 0.8021
2024-08-15 17:29:53,805 : INFO : Precision score for label_class 1: 0.9267
2024-08-15 17:29:53,805 : INFO : Precision score for label_class 2: 0.9167
2024-08-15 17:29:53,805 : INFO : Recall score for label_class 0: 0.8953
2024-08-15 17:29:53,805 : INFO : Recall score for label_class 1: 0.9446
2024-08-15 17:29:53,805 : INFO : Recall score for label_class 2: 0.8218
2024-08-15 17:29:53,805 : INFO : Average F1 score: 0.8828
2024-08-15 17:29:53,805 : INFO : Determined score from best model, ending training.
2024-08-15 17:29:53,807 : INFO : Split 1 is finished, the score is: 0.8828
2024-08-15 17:29:53,807 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:53,807 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:53,807 : INFO : Starting training for split 2
2024-08-15 17:29:53,822 : INFO : Starting to tokenize the sequences.
2024-08-15 17:29:53,828 : INFO : Tokenization is finished.
2024-08-15 17:29:53,844 : INFO : Starting to tokenize the sequences.
2024-08-15 17:29:53,849 : INFO : Tokenization is finished.
2024-08-15 17:29:53,853 : INFO : Counting occurences of labels...
2024-08-15 17:29:53,854 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 343, 1601,  754]))
2024-08-15 17:29:53,855 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 71, 410, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:29:53,896 : INFO : Starting epoch 1
2024-08-15 17:29:53,947 : INFO : Current training batch loss: 1.0982 in epoch 1
2024-08-15 17:29:54,762 : INFO : Current training batch loss: 1.0121 in epoch 1
2024-08-15 17:29:55,577 : INFO : Current training batch loss: 0.8422 in epoch 1
2024-08-15 17:29:56,393 : INFO : Current training batch loss: 0.6500 in epoch 1
2024-08-15 17:29:57,218 : INFO : Current training batch loss: 0.6283 in epoch 1
2024-08-15 17:29:57,370 : INFO : Epoch finished, average loss over training batches: 0.8289
2024-08-15 17:29:57,371 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:57,371 : INFO : Training metrics:
2024-08-15 17:29:57,371 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:57,381 : INFO : Accuracy: 0.6405
2024-08-15 17:29:57,381 : INFO : Precision score for label_class 0: 0.1574
2024-08-15 17:29:57,381 : INFO : Precision score for label_class 1: 0.7098
2024-08-15 17:29:57,381 : INFO : Precision score for label_class 2: 0.5575
2024-08-15 17:29:57,381 : INFO : Recall score for label_class 0: 0.0904
2024-08-15 17:29:57,381 : INFO : Recall score for label_class 1: 0.8813
2024-08-15 17:29:57,381 : INFO : Recall score for label_class 2: 0.3793
2024-08-15 17:29:57,381 : INFO : Average F1 score: 0.4509
2024-08-15 17:29:57,850 : INFO : Average loss over validation batches: 0.5679
2024-08-15 17:29:57,850 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:57,850 : INFO : Validation metrics:
2024-08-15 17:29:57,850 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:29:57,853 : INFO : Accuracy: 0.7807
2024-08-15 17:29:57,853 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:29:57,853 : INFO : Precision score for label_class 1: 0.8514
2024-08-15 17:29:57,853 : INFO : Precision score for label_class 2: 0.6384
2024-08-15 17:29:57,853 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:29:57,853 : INFO : Recall score for label_class 1: 0.9366
2024-08-15 17:29:57,853 : INFO : Recall score for label_class 2: 0.7371
2024-08-15 17:29:57,853 : INFO : Average F1 score: 0.5254
2024-08-15 17:29:57,853 : INFO : Validation metric decreased (inf --> 0.567937).  Saving model ...
2024-08-15 17:29:57,950 : INFO : Starting epoch 2
2024-08-15 17:29:58,607 : INFO : Current training batch loss: 0.5976 in epoch 2
2024-08-15 17:29:59,432 : INFO : Current training batch loss: 0.5601 in epoch 2
2024-08-15 17:30:00,269 : INFO : Current training batch loss: 0.3193 in epoch 2
2024-08-15 17:30:01,112 : INFO : Current training batch loss: 0.3842 in epoch 2
2024-08-15 17:30:01,477 : INFO : Epoch finished, average loss over training batches: 0.4445
2024-08-15 17:30:01,477 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:01,477 : INFO : Training metrics:
2024-08-15 17:30:01,477 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:01,484 : INFO : Accuracy: 0.8495
2024-08-15 17:30:01,484 : INFO : Precision score for label_class 0: 0.7394
2024-08-15 17:30:01,485 : INFO : Precision score for label_class 1: 0.8969
2024-08-15 17:30:01,485 : INFO : Precision score for label_class 2: 0.7840
2024-08-15 17:30:01,485 : INFO : Recall score for label_class 0: 0.6122
2024-08-15 17:30:01,485 : INFO : Recall score for label_class 1: 0.9400
2024-08-15 17:30:01,485 : INFO : Recall score for label_class 2: 0.7653
2024-08-15 17:30:01,485 : INFO : Average F1 score: 0.7874
2024-08-15 17:30:01,956 : INFO : Average loss over validation batches: 0.3675
2024-08-15 17:30:01,956 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:01,956 : INFO : Validation metrics:
2024-08-15 17:30:01,956 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:01,960 : INFO : Accuracy: 0.8726
2024-08-15 17:30:01,960 : INFO : Precision score for label_class 0: 0.7600
2024-08-15 17:30:01,960 : INFO : Precision score for label_class 1: 0.9036
2024-08-15 17:30:01,960 : INFO : Precision score for label_class 2: 0.8486
2024-08-15 17:30:01,960 : INFO : Recall score for label_class 0: 0.8028
2024-08-15 17:30:01,960 : INFO : Recall score for label_class 1: 0.9146
2024-08-15 17:30:01,960 : INFO : Recall score for label_class 2: 0.8093
2024-08-15 17:30:01,960 : INFO : Average F1 score: 0.8395
2024-08-15 17:30:01,960 : INFO : Validation metric decreased (0.567937 --> 0.367514).  Saving model ...
2024-08-15 17:30:02,059 : INFO : Starting epoch 3
2024-08-15 17:30:02,527 : INFO : Current training batch loss: 0.2529 in epoch 3
2024-08-15 17:30:03,356 : INFO : Current training batch loss: 0.2540 in epoch 3
2024-08-15 17:30:04,195 : INFO : Current training batch loss: 0.3219 in epoch 3
2024-08-15 17:30:05,037 : INFO : Current training batch loss: 0.0898 in epoch 3
2024-08-15 17:30:05,609 : INFO : Epoch finished, average loss over training batches: 0.2414
2024-08-15 17:30:05,610 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:05,610 : INFO : Training metrics:
2024-08-15 17:30:05,610 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:05,620 : INFO : Accuracy: 0.9262
2024-08-15 17:30:05,620 : INFO : Precision score for label_class 0: 0.8446
2024-08-15 17:30:05,620 : INFO : Precision score for label_class 1: 0.9551
2024-08-15 17:30:05,620 : INFO : Precision score for label_class 2: 0.9028
2024-08-15 17:30:05,620 : INFO : Recall score for label_class 0: 0.8717
2024-08-15 17:30:05,620 : INFO : Recall score for label_class 1: 0.9563
2024-08-15 17:30:05,620 : INFO : Recall score for label_class 2: 0.8873
2024-08-15 17:30:05,620 : INFO : Average F1 score: 0.9029
2024-08-15 17:30:06,086 : INFO : Average loss over validation batches: 0.3743
2024-08-15 17:30:06,086 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:06,086 : INFO : Validation metrics:
2024-08-15 17:30:06,086 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:06,089 : INFO : Accuracy: 0.8652
2024-08-15 17:30:06,090 : INFO : Precision score for label_class 0: 0.7722
2024-08-15 17:30:06,090 : INFO : Precision score for label_class 1: 0.8945
2024-08-15 17:30:06,090 : INFO : Precision score for label_class 2: 0.8380
2024-08-15 17:30:06,090 : INFO : Recall score for label_class 0: 0.8592
2024-08-15 17:30:06,090 : INFO : Recall score for label_class 1: 0.9098
2024-08-15 17:30:06,090 : INFO : Recall score for label_class 2: 0.7732
2024-08-15 17:30:06,090 : INFO : Average F1 score: 0.8399
2024-08-15 17:30:06,090 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:30:06,090 : INFO : Starting epoch 4
2024-08-15 17:30:06,349 : INFO : Current training batch loss: 0.2490 in epoch 4
2024-08-15 17:30:07,189 : INFO : Current training batch loss: 0.1083 in epoch 4
2024-08-15 17:30:08,028 : INFO : Current training batch loss: 0.2688 in epoch 4
2024-08-15 17:30:08,854 : INFO : Current training batch loss: 0.1689 in epoch 4
2024-08-15 17:30:09,615 : INFO : Epoch finished, average loss over training batches: 0.1513
2024-08-15 17:30:09,615 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:09,615 : INFO : Training metrics:
2024-08-15 17:30:09,615 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:09,625 : INFO : Accuracy: 0.9589
2024-08-15 17:30:09,625 : INFO : Precision score for label_class 0: 0.8975
2024-08-15 17:30:09,625 : INFO : Precision score for label_class 1: 0.9738
2024-08-15 17:30:09,625 : INFO : Precision score for label_class 2: 0.9563
2024-08-15 17:30:09,625 : INFO : Recall score for label_class 0: 0.9446
2024-08-15 17:30:09,625 : INFO : Recall score for label_class 1: 0.9763
2024-08-15 17:30:09,625 : INFO : Recall score for label_class 2: 0.9284
2024-08-15 17:30:09,625 : INFO : Average F1 score: 0.9459
2024-08-15 17:30:10,092 : INFO : Average loss over validation batches: 0.4014
2024-08-15 17:30:10,092 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:10,092 : INFO : Validation metrics:
2024-08-15 17:30:10,092 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:10,096 : INFO : Accuracy: 0.8593
2024-08-15 17:30:10,096 : INFO : Precision score for label_class 0: 0.7875
2024-08-15 17:30:10,096 : INFO : Precision score for label_class 1: 0.9357
2024-08-15 17:30:10,096 : INFO : Precision score for label_class 2: 0.7568
2024-08-15 17:30:10,096 : INFO : Recall score for label_class 0: 0.8873
2024-08-15 17:30:10,096 : INFO : Recall score for label_class 1: 0.8512
2024-08-15 17:30:10,096 : INFO : Recall score for label_class 2: 0.8660
2024-08-15 17:30:10,096 : INFO : Average F1 score: 0.8445
2024-08-15 17:30:10,096 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:30:10,096 : INFO : Starting epoch 5
2024-08-15 17:30:10,147 : INFO : Current training batch loss: 0.1375 in epoch 5
2024-08-15 17:30:10,965 : INFO : Current training batch loss: 0.1649 in epoch 5
2024-08-15 17:30:11,780 : INFO : Current training batch loss: 0.0379 in epoch 5
2024-08-15 17:30:12,595 : INFO : Current training batch loss: 0.1471 in epoch 5
2024-08-15 17:30:13,430 : INFO : Current training batch loss: 0.1220 in epoch 5
2024-08-15 17:30:13,575 : INFO : Epoch finished, average loss over training batches: 0.1037
2024-08-15 17:30:13,575 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:13,575 : INFO : Training metrics:
2024-08-15 17:30:13,575 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:13,582 : INFO : Accuracy: 0.9752
2024-08-15 17:30:13,582 : INFO : Precision score for label_class 0: 0.9274
2024-08-15 17:30:13,582 : INFO : Precision score for label_class 1: 0.9862
2024-08-15 17:30:13,582 : INFO : Precision score for label_class 2: 0.9744
2024-08-15 17:30:13,582 : INFO : Recall score for label_class 0: 0.9679
2024-08-15 17:30:13,582 : INFO : Recall score for label_class 1: 0.9850
2024-08-15 17:30:13,582 : INFO : Recall score for label_class 2: 0.9576
2024-08-15 17:30:13,582 : INFO : Average F1 score: 0.9662
2024-08-15 17:30:14,050 : INFO : Average loss over validation batches: 0.3820
2024-08-15 17:30:14,050 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:14,050 : INFO : Validation metrics:
2024-08-15 17:30:14,050 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:14,054 : INFO : Accuracy: 0.8770
2024-08-15 17:30:14,054 : INFO : Precision score for label_class 0: 0.8133
2024-08-15 17:30:14,054 : INFO : Precision score for label_class 1: 0.9242
2024-08-15 17:30:14,054 : INFO : Precision score for label_class 2: 0.8088
2024-08-15 17:30:14,054 : INFO : Recall score for label_class 0: 0.8592
2024-08-15 17:30:14,054 : INFO : Recall score for label_class 1: 0.8927
2024-08-15 17:30:14,054 : INFO : Recall score for label_class 2: 0.8505
2024-08-15 17:30:14,054 : INFO : Average F1 score: 0.8577
2024-08-15 17:30:14,054 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:30:14,054 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:30:14,086 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:30:14,585 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:14,585 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:30:14,585 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:14,588 : INFO : Accuracy: 0.8726
2024-08-15 17:30:14,588 : INFO : Precision score for label_class 0: 0.7600
2024-08-15 17:30:14,588 : INFO : Precision score for label_class 1: 0.9036
2024-08-15 17:30:14,588 : INFO : Precision score for label_class 2: 0.8486
2024-08-15 17:30:14,588 : INFO : Recall score for label_class 0: 0.8028
2024-08-15 17:30:14,588 : INFO : Recall score for label_class 1: 0.9146
2024-08-15 17:30:14,588 : INFO : Recall score for label_class 2: 0.8093
2024-08-15 17:30:14,588 : INFO : Average F1 score: 0.8395
2024-08-15 17:30:14,588 : INFO : Determined score from best model, ending training.
2024-08-15 17:30:14,590 : INFO : Split 2 is finished, the score is: 0.8395
2024-08-15 17:30:14,590 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:14,590 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:14,590 : INFO : Starting training for split 3
2024-08-15 17:30:14,606 : INFO : Starting to tokenize the sequences.
2024-08-15 17:30:14,612 : INFO : Tokenization is finished.
2024-08-15 17:30:14,630 : INFO : Starting to tokenize the sequences.
2024-08-15 17:30:14,635 : INFO : Tokenization is finished.
2024-08-15 17:30:14,639 : INFO : Counting occurences of labels...
2024-08-15 17:30:14,640 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1611,  759]))
2024-08-15 17:30:14,641 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 400, 189]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:30:14,684 : INFO : Starting epoch 1
2024-08-15 17:30:14,736 : INFO : Current training batch loss: 1.0910 in epoch 1
2024-08-15 17:30:15,570 : INFO : Current training batch loss: 1.0003 in epoch 1
2024-08-15 17:30:16,408 : INFO : Current training batch loss: 0.7859 in epoch 1
2024-08-15 17:30:17,243 : INFO : Current training batch loss: 0.6918 in epoch 1
2024-08-15 17:30:18,073 : INFO : Current training batch loss: 0.6130 in epoch 1
2024-08-15 17:30:18,230 : INFO : Epoch finished, average loss over training batches: 0.8229
2024-08-15 17:30:18,231 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:18,231 : INFO : Training metrics:
2024-08-15 17:30:18,231 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:18,238 : INFO : Accuracy: 0.6646
2024-08-15 17:30:18,238 : INFO : Precision score for label_class 0: 0.4545
2024-08-15 17:30:18,238 : INFO : Precision score for label_class 1: 0.6965
2024-08-15 17:30:18,238 : INFO : Precision score for label_class 2: 0.5364
2024-08-15 17:30:18,238 : INFO : Recall score for label_class 0: 0.0152
2024-08-15 17:30:18,238 : INFO : Recall score for label_class 1: 0.9361
2024-08-15 17:30:18,238 : INFO : Recall score for label_class 2: 0.3689
2024-08-15 17:30:18,238 : INFO : Average F1 score: 0.4218
2024-08-15 17:30:18,707 : INFO : Average loss over validation batches: 0.5731
2024-08-15 17:30:18,707 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:18,707 : INFO : Validation metrics:
2024-08-15 17:30:18,707 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:18,709 : INFO : Accuracy: 0.7630
2024-08-15 17:30:18,709 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:30:18,709 : INFO : Precision score for label_class 1: 0.8867
2024-08-15 17:30:18,709 : INFO : Precision score for label_class 2: 0.5762
2024-08-15 17:30:18,709 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:30:18,709 : INFO : Recall score for label_class 1: 0.9000
2024-08-15 17:30:18,710 : INFO : Recall score for label_class 2: 0.8201
2024-08-15 17:30:18,710 : INFO : Average F1 score: 0.5234
2024-08-15 17:30:18,710 : INFO : Validation metric decreased (inf --> 0.573118).  Saving model ...
2024-08-15 17:30:18,807 : INFO : Starting epoch 2
2024-08-15 17:30:19,469 : INFO : Current training batch loss: 0.5638 in epoch 2
2024-08-15 17:30:20,302 : INFO : Current training batch loss: 0.3535 in epoch 2
2024-08-15 17:30:21,121 : INFO : Current training batch loss: 0.3721 in epoch 2
2024-08-15 17:30:21,947 : INFO : Current training batch loss: 0.4041 in epoch 2
2024-08-15 17:30:22,311 : INFO : Epoch finished, average loss over training batches: 0.4369
2024-08-15 17:30:22,312 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:22,312 : INFO : Training metrics:
2024-08-15 17:30:22,312 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:22,315 : INFO : Accuracy: 0.8514
2024-08-15 17:30:22,315 : INFO : Precision score for label_class 0: 0.7577
2024-08-15 17:30:22,315 : INFO : Precision score for label_class 1: 0.8833
2024-08-15 17:30:22,315 : INFO : Precision score for label_class 2: 0.8138
2024-08-15 17:30:22,315 : INFO : Recall score for label_class 0: 0.6768
2024-08-15 17:30:22,315 : INFO : Recall score for label_class 1: 0.9299
2024-08-15 17:30:22,315 : INFO : Recall score for label_class 2: 0.7602
2024-08-15 17:30:22,315 : INFO : Average F1 score: 0.8023
2024-08-15 17:30:22,781 : INFO : Average loss over validation batches: 0.3981
2024-08-15 17:30:22,782 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:22,782 : INFO : Validation metrics:
2024-08-15 17:30:22,782 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:22,785 : INFO : Accuracy: 0.8607
2024-08-15 17:30:22,785 : INFO : Precision score for label_class 0: 0.7778
2024-08-15 17:30:22,785 : INFO : Precision score for label_class 1: 0.8794
2024-08-15 17:30:22,785 : INFO : Precision score for label_class 2: 0.8571
2024-08-15 17:30:22,785 : INFO : Recall score for label_class 0: 0.8140
2024-08-15 17:30:22,785 : INFO : Recall score for label_class 1: 0.9475
2024-08-15 17:30:22,785 : INFO : Recall score for label_class 2: 0.6984
2024-08-15 17:30:22,785 : INFO : Average F1 score: 0.8258
2024-08-15 17:30:22,785 : INFO : Validation metric decreased (0.573118 --> 0.398051).  Saving model ...
2024-08-15 17:30:22,890 : INFO : Starting epoch 3
2024-08-15 17:30:23,343 : INFO : Current training batch loss: 0.1910 in epoch 3
2024-08-15 17:30:24,158 : INFO : Current training batch loss: 0.2003 in epoch 3
2024-08-15 17:30:24,973 : INFO : Current training batch loss: 0.2356 in epoch 3
2024-08-15 17:30:25,799 : INFO : Current training batch loss: 0.0552 in epoch 3
2024-08-15 17:30:26,357 : INFO : Epoch finished, average loss over training batches: 0.2405
2024-08-15 17:30:26,357 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:26,357 : INFO : Training metrics:
2024-08-15 17:30:26,358 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:26,365 : INFO : Accuracy: 0.9266
2024-08-15 17:30:26,365 : INFO : Precision score for label_class 0: 0.8435
2024-08-15 17:30:26,365 : INFO : Precision score for label_class 1: 0.9540
2024-08-15 17:30:26,365 : INFO : Precision score for label_class 2: 0.9058
2024-08-15 17:30:26,365 : INFO : Recall score for label_class 0: 0.8872
2024-08-15 17:30:26,365 : INFO : Recall score for label_class 1: 0.9534
2024-08-15 17:30:26,365 : INFO : Recall score for label_class 2: 0.8867
2024-08-15 17:30:26,365 : INFO : Average F1 score: 0.9049
2024-08-15 17:30:26,830 : INFO : Average loss over validation batches: 0.3849
2024-08-15 17:30:26,830 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:26,830 : INFO : Validation metrics:
2024-08-15 17:30:26,830 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:26,832 : INFO : Accuracy: 0.8430
2024-08-15 17:30:26,832 : INFO : Precision score for label_class 0: 0.8592
2024-08-15 17:30:26,832 : INFO : Precision score for label_class 1: 0.9213
2024-08-15 17:30:26,832 : INFO : Precision score for label_class 2: 0.7040
2024-08-15 17:30:26,832 : INFO : Recall score for label_class 0: 0.7093
2024-08-15 17:30:26,832 : INFO : Recall score for label_class 1: 0.8775
2024-08-15 17:30:26,832 : INFO : Recall score for label_class 2: 0.8307
2024-08-15 17:30:26,832 : INFO : Average F1 score: 0.8127
2024-08-15 17:30:26,833 : INFO : Validation metric decreased (0.398051 --> 0.384865).  Saving model ...
2024-08-15 17:30:26,936 : INFO : Starting epoch 4
2024-08-15 17:30:27,188 : INFO : Current training batch loss: 0.3244 in epoch 4
2024-08-15 17:30:28,003 : INFO : Current training batch loss: 0.1711 in epoch 4
2024-08-15 17:30:28,818 : INFO : Current training batch loss: 0.2462 in epoch 4
2024-08-15 17:30:29,643 : INFO : Current training batch loss: 0.0795 in epoch 4
2024-08-15 17:30:30,419 : INFO : Epoch finished, average loss over training batches: 0.1441
2024-08-15 17:30:30,420 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:30,420 : INFO : Training metrics:
2024-08-15 17:30:30,420 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:30,423 : INFO : Accuracy: 0.9618
2024-08-15 17:30:30,423 : INFO : Precision score for label_class 0: 0.8934
2024-08-15 17:30:30,423 : INFO : Precision score for label_class 1: 0.9776
2024-08-15 17:30:30,423 : INFO : Precision score for label_class 2: 0.9596
2024-08-15 17:30:30,423 : INFO : Recall score for label_class 0: 0.9451
2024-08-15 17:30:30,423 : INFO : Recall score for label_class 1: 0.9758
2024-08-15 17:30:30,423 : INFO : Recall score for label_class 2: 0.9394
2024-08-15 17:30:30,423 : INFO : Average F1 score: 0.9482
2024-08-15 17:30:30,889 : INFO : Average loss over validation batches: 0.4563
2024-08-15 17:30:30,889 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:30,889 : INFO : Validation metrics:
2024-08-15 17:30:30,889 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:30,892 : INFO : Accuracy: 0.8430
2024-08-15 17:30:30,892 : INFO : Precision score for label_class 0: 0.7500
2024-08-15 17:30:30,892 : INFO : Precision score for label_class 1: 0.9507
2024-08-15 17:30:30,892 : INFO : Precision score for label_class 2: 0.7212
2024-08-15 17:30:30,892 : INFO : Recall score for label_class 0: 0.9070
2024-08-15 17:30:30,892 : INFO : Recall score for label_class 1: 0.8200
2024-08-15 17:30:30,892 : INFO : Recall score for label_class 2: 0.8624
2024-08-15 17:30:30,892 : INFO : Average F1 score: 0.8290
2024-08-15 17:30:30,892 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:30:30,892 : INFO : Starting epoch 5
2024-08-15 17:30:30,943 : INFO : Current training batch loss: 0.0861 in epoch 5
2024-08-15 17:30:31,765 : INFO : Current training batch loss: 0.2949 in epoch 5
2024-08-15 17:30:32,583 : INFO : Current training batch loss: 0.0284 in epoch 5
2024-08-15 17:30:33,405 : INFO : Current training batch loss: 0.1882 in epoch 5
2024-08-15 17:30:34,224 : INFO : Current training batch loss: 0.1978 in epoch 5
2024-08-15 17:30:34,377 : INFO : Epoch finished, average loss over training batches: 0.0998
2024-08-15 17:30:34,377 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:34,377 : INFO : Training metrics:
2024-08-15 17:30:34,377 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:34,382 : INFO : Accuracy: 0.9741
2024-08-15 17:30:34,382 : INFO : Precision score for label_class 0: 0.9040
2024-08-15 17:30:34,382 : INFO : Precision score for label_class 1: 0.9851
2024-08-15 17:30:34,382 : INFO : Precision score for label_class 2: 0.9837
2024-08-15 17:30:34,382 : INFO : Recall score for label_class 0: 0.9756
2024-08-15 17:30:34,382 : INFO : Recall score for label_class 1: 0.9845
2024-08-15 17:30:34,382 : INFO : Recall score for label_class 2: 0.9513
2024-08-15 17:30:34,382 : INFO : Average F1 score: 0.9635
2024-08-15 17:30:34,851 : INFO : Average loss over validation batches: 0.4163
2024-08-15 17:30:34,851 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:34,852 : INFO : Validation metrics:
2024-08-15 17:30:34,852 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:34,854 : INFO : Accuracy: 0.8667
2024-08-15 17:30:34,854 : INFO : Precision score for label_class 0: 0.7766
2024-08-15 17:30:34,854 : INFO : Precision score for label_class 1: 0.9223
2024-08-15 17:30:34,854 : INFO : Precision score for label_class 2: 0.8000
2024-08-15 17:30:34,854 : INFO : Recall score for label_class 0: 0.8488
2024-08-15 17:30:34,854 : INFO : Recall score for label_class 1: 0.8900
2024-08-15 17:30:34,854 : INFO : Recall score for label_class 2: 0.8254
2024-08-15 17:30:34,854 : INFO : Average F1 score: 0.8432
2024-08-15 17:30:34,854 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:30:34,854 : INFO : Starting epoch 6
2024-08-15 17:30:35,528 : INFO : Current training batch loss: 0.2080 in epoch 6
2024-08-15 17:30:36,372 : INFO : Current training batch loss: 0.0381 in epoch 6
2024-08-15 17:30:37,304 : INFO : Current training batch loss: 0.0236 in epoch 6
2024-08-15 17:30:38,131 : INFO : Current training batch loss: 0.0167 in epoch 6
2024-08-15 17:30:38,483 : INFO : Epoch finished, average loss over training batches: 0.0690
2024-08-15 17:30:38,483 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:38,483 : INFO : Training metrics:
2024-08-15 17:30:38,483 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:38,490 : INFO : Accuracy: 0.9830
2024-08-15 17:30:38,490 : INFO : Precision score for label_class 0: 0.9282
2024-08-15 17:30:38,490 : INFO : Precision score for label_class 1: 0.9919
2024-08-15 17:30:38,490 : INFO : Precision score for label_class 2: 0.9892
2024-08-15 17:30:38,490 : INFO : Recall score for label_class 0: 0.9848
2024-08-15 17:30:38,490 : INFO : Recall score for label_class 1: 0.9888
2024-08-15 17:30:38,490 : INFO : Recall score for label_class 2: 0.9697
2024-08-15 17:30:38,490 : INFO : Average F1 score: 0.9751
2024-08-15 17:30:38,956 : INFO : Average loss over validation batches: 0.4572
2024-08-15 17:30:38,956 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:38,956 : INFO : Validation metrics:
2024-08-15 17:30:38,956 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:38,959 : INFO : Accuracy: 0.8711
2024-08-15 17:30:38,959 : INFO : Precision score for label_class 0: 0.8043
2024-08-15 17:30:38,959 : INFO : Precision score for label_class 1: 0.8808
2024-08-15 17:30:38,959 : INFO : Precision score for label_class 2: 0.8839
2024-08-15 17:30:38,959 : INFO : Recall score for label_class 0: 0.8605
2024-08-15 17:30:38,959 : INFO : Recall score for label_class 1: 0.9425
2024-08-15 17:30:38,959 : INFO : Recall score for label_class 2: 0.7249
2024-08-15 17:30:38,959 : INFO : Average F1 score: 0.8462
2024-08-15 17:30:38,959 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:30:38,959 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:30:38,992 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:30:39,487 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:39,487 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:30:39,487 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:39,489 : INFO : Accuracy: 0.8430
2024-08-15 17:30:39,490 : INFO : Precision score for label_class 0: 0.8592
2024-08-15 17:30:39,490 : INFO : Precision score for label_class 1: 0.9213
2024-08-15 17:30:39,490 : INFO : Precision score for label_class 2: 0.7040
2024-08-15 17:30:39,490 : INFO : Recall score for label_class 0: 0.7093
2024-08-15 17:30:39,490 : INFO : Recall score for label_class 1: 0.8775
2024-08-15 17:30:39,490 : INFO : Recall score for label_class 2: 0.8307
2024-08-15 17:30:39,490 : INFO : Average F1 score: 0.8127
2024-08-15 17:30:39,490 : INFO : Determined score from best model, ending training.
2024-08-15 17:30:39,491 : INFO : Split 3 is finished, the score is: 0.8127
2024-08-15 17:30:39,491 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:39,491 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:39,491 : INFO : Starting training for split 4
2024-08-15 17:30:39,510 : INFO : Starting to tokenize the sequences.
2024-08-15 17:30:39,516 : INFO : Tokenization is finished.
2024-08-15 17:30:39,532 : INFO : Starting to tokenize the sequences.
2024-08-15 17:30:39,537 : INFO : Tokenization is finished.
2024-08-15 17:30:39,542 : INFO : Counting occurences of labels...
2024-08-15 17:30:39,542 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 327, 1621,  751]))
2024-08-15 17:30:39,543 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 87, 390, 197]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:30:39,584 : INFO : Starting epoch 1
2024-08-15 17:30:39,635 : INFO : Current training batch loss: 1.1309 in epoch 1
2024-08-15 17:30:40,449 : INFO : Current training batch loss: 1.0121 in epoch 1
2024-08-15 17:30:41,264 : INFO : Current training batch loss: 0.7960 in epoch 1
2024-08-15 17:30:42,079 : INFO : Current training batch loss: 0.6521 in epoch 1
2024-08-15 17:30:42,893 : INFO : Current training batch loss: 0.6524 in epoch 1
2024-08-15 17:30:43,044 : INFO : Epoch finished, average loss over training batches: 0.8446
2024-08-15 17:30:43,044 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:43,044 : INFO : Training metrics:
2024-08-15 17:30:43,044 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:43,052 : INFO : Accuracy: 0.6291
2024-08-15 17:30:43,052 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:30:43,052 : INFO : Precision score for label_class 1: 0.7038
2024-08-15 17:30:43,052 : INFO : Precision score for label_class 2: 0.4328
2024-08-15 17:30:43,052 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:30:43,052 : INFO : Recall score for label_class 1: 0.8489
2024-08-15 17:30:43,052 : INFO : Recall score for label_class 2: 0.4288
2024-08-15 17:30:43,052 : INFO : Average F1 score: 0.4001
2024-08-15 17:30:43,521 : INFO : Average loss over validation batches: 0.6128
2024-08-15 17:30:43,521 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:43,521 : INFO : Validation metrics:
2024-08-15 17:30:43,521 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:43,525 : INFO : Accuracy: 0.7611
2024-08-15 17:30:43,525 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:30:43,525 : INFO : Precision score for label_class 1: 0.8514
2024-08-15 17:30:43,525 : INFO : Precision score for label_class 2: 0.6080
2024-08-15 17:30:43,525 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:30:43,525 : INFO : Recall score for label_class 1: 0.9256
2024-08-15 17:30:43,525 : INFO : Recall score for label_class 2: 0.7716
2024-08-15 17:30:43,525 : INFO : Average F1 score: 0.5224
2024-08-15 17:30:43,525 : INFO : Validation metric decreased (inf --> 0.612807).  Saving model ...
2024-08-15 17:30:43,624 : INFO : Starting epoch 2
2024-08-15 17:30:44,279 : INFO : Current training batch loss: 0.5619 in epoch 2
2024-08-15 17:30:45,092 : INFO : Current training batch loss: 0.3624 in epoch 2
2024-08-15 17:30:45,907 : INFO : Current training batch loss: 0.2866 in epoch 2
2024-08-15 17:30:46,722 : INFO : Current training batch loss: 0.4299 in epoch 2
2024-08-15 17:30:47,073 : INFO : Epoch finished, average loss over training batches: 0.4573
2024-08-15 17:30:47,074 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:47,074 : INFO : Training metrics:
2024-08-15 17:30:47,074 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:47,081 : INFO : Accuracy: 0.8511
2024-08-15 17:30:47,081 : INFO : Precision score for label_class 0: 0.7943
2024-08-15 17:30:47,081 : INFO : Precision score for label_class 1: 0.8799
2024-08-15 17:30:47,081 : INFO : Precision score for label_class 2: 0.8034
2024-08-15 17:30:47,081 : INFO : Recall score for label_class 0: 0.6850
2024-08-15 17:30:47,081 : INFO : Recall score for label_class 1: 0.9309
2024-08-15 17:30:47,081 : INFO : Recall score for label_class 2: 0.7510
2024-08-15 17:30:47,081 : INFO : Average F1 score: 0.8055
2024-08-15 17:30:47,547 : INFO : Average loss over validation batches: 0.4036
2024-08-15 17:30:47,547 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:47,547 : INFO : Validation metrics:
2024-08-15 17:30:47,547 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:47,551 : INFO : Accuracy: 0.8487
2024-08-15 17:30:47,551 : INFO : Precision score for label_class 0: 0.7010
2024-08-15 17:30:47,551 : INFO : Precision score for label_class 1: 0.8645
2024-08-15 17:30:47,551 : INFO : Precision score for label_class 2: 0.8993
2024-08-15 17:30:47,551 : INFO : Recall score for label_class 0: 0.7816
2024-08-15 17:30:47,551 : INFO : Recall score for label_class 1: 0.9487
2024-08-15 17:30:47,551 : INFO : Recall score for label_class 2: 0.6802
2024-08-15 17:30:47,551 : INFO : Average F1 score: 0.8061
2024-08-15 17:30:47,551 : INFO : Validation metric decreased (0.612807 --> 0.403589).  Saving model ...
2024-08-15 17:30:47,655 : INFO : Starting epoch 3
2024-08-15 17:30:48,108 : INFO : Current training batch loss: 0.2488 in epoch 3
2024-08-15 17:30:48,924 : INFO : Current training batch loss: 0.2462 in epoch 3
2024-08-15 17:30:49,738 : INFO : Current training batch loss: 0.1377 in epoch 3
2024-08-15 17:30:50,553 : INFO : Current training batch loss: 0.1410 in epoch 3
2024-08-15 17:30:51,105 : INFO : Epoch finished, average loss over training batches: 0.2574
2024-08-15 17:30:51,106 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:51,106 : INFO : Training metrics:
2024-08-15 17:30:51,106 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:51,113 : INFO : Accuracy: 0.9163
2024-08-15 17:30:51,113 : INFO : Precision score for label_class 0: 0.8525
2024-08-15 17:30:51,113 : INFO : Precision score for label_class 1: 0.9450
2024-08-15 17:30:51,113 : INFO : Precision score for label_class 2: 0.8826
2024-08-15 17:30:51,113 : INFO : Recall score for label_class 0: 0.8838
2024-08-15 17:30:51,113 : INFO : Recall score for label_class 1: 0.9439
2024-08-15 17:30:51,113 : INFO : Recall score for label_class 2: 0.8708
2024-08-15 17:30:51,113 : INFO : Average F1 score: 0.8963
2024-08-15 17:30:51,583 : INFO : Average loss over validation batches: 0.4234
2024-08-15 17:30:51,583 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:51,583 : INFO : Validation metrics:
2024-08-15 17:30:51,583 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:51,587 : INFO : Accuracy: 0.8442
2024-08-15 17:30:51,587 : INFO : Precision score for label_class 0: 0.8727
2024-08-15 17:30:51,587 : INFO : Precision score for label_class 1: 0.8975
2024-08-15 17:30:51,587 : INFO : Precision score for label_class 2: 0.7397
2024-08-15 17:30:51,587 : INFO : Recall score for label_class 0: 0.5517
2024-08-15 17:30:51,587 : INFO : Recall score for label_class 1: 0.9205
2024-08-15 17:30:51,587 : INFO : Recall score for label_class 2: 0.8223
2024-08-15 17:30:51,587 : INFO : Average F1 score: 0.7879
2024-08-15 17:30:51,587 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:30:51,587 : INFO : Starting epoch 4
2024-08-15 17:30:51,839 : INFO : Current training batch loss: 0.3121 in epoch 4
2024-08-15 17:30:52,653 : INFO : Current training batch loss: 0.2907 in epoch 4
2024-08-15 17:30:53,467 : INFO : Current training batch loss: 0.1772 in epoch 4
2024-08-15 17:30:54,282 : INFO : Current training batch loss: 0.1520 in epoch 4
2024-08-15 17:30:55,036 : INFO : Epoch finished, average loss over training batches: 0.1570
2024-08-15 17:30:55,036 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:55,036 : INFO : Training metrics:
2024-08-15 17:30:55,036 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:55,040 : INFO : Accuracy: 0.9544
2024-08-15 17:30:55,040 : INFO : Precision score for label_class 0: 0.8979
2024-08-15 17:30:55,040 : INFO : Precision score for label_class 1: 0.9740
2024-08-15 17:30:55,040 : INFO : Precision score for label_class 2: 0.9372
2024-08-15 17:30:55,040 : INFO : Recall score for label_class 0: 0.9144
2024-08-15 17:30:55,040 : INFO : Recall score for label_class 1: 0.9716
2024-08-15 17:30:55,040 : INFO : Recall score for label_class 2: 0.9348
2024-08-15 17:30:55,040 : INFO : Average F1 score: 0.9383
2024-08-15 17:30:55,508 : INFO : Average loss over validation batches: 0.3870
2024-08-15 17:30:55,508 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:55,508 : INFO : Validation metrics:
2024-08-15 17:30:55,508 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:55,512 : INFO : Accuracy: 0.8650
2024-08-15 17:30:55,512 : INFO : Precision score for label_class 0: 0.7865
2024-08-15 17:30:55,512 : INFO : Precision score for label_class 1: 0.8867
2024-08-15 17:30:55,512 : INFO : Precision score for label_class 2: 0.8547
2024-08-15 17:30:55,512 : INFO : Recall score for label_class 0: 0.8046
2024-08-15 17:30:55,512 : INFO : Recall score for label_class 1: 0.9231
2024-08-15 17:30:55,512 : INFO : Recall score for label_class 2: 0.7766
2024-08-15 17:30:55,512 : INFO : Average F1 score: 0.8379
2024-08-15 17:30:55,512 : INFO : Validation metric decreased (0.403589 --> 0.386996).  Saving model ...
2024-08-15 17:30:55,614 : INFO : Starting epoch 5
2024-08-15 17:30:55,665 : INFO : Current training batch loss: 0.1012 in epoch 5
2024-08-15 17:30:56,479 : INFO : Current training batch loss: 0.1284 in epoch 5
2024-08-15 17:30:57,293 : INFO : Current training batch loss: 0.0322 in epoch 5
2024-08-15 17:30:58,108 : INFO : Current training batch loss: 0.0678 in epoch 5
2024-08-15 17:30:58,923 : INFO : Current training batch loss: 0.3343 in epoch 5
2024-08-15 17:30:59,074 : INFO : Epoch finished, average loss over training batches: 0.0967
2024-08-15 17:30:59,074 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:59,074 : INFO : Training metrics:
2024-08-15 17:30:59,074 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:59,078 : INFO : Accuracy: 0.9774
2024-08-15 17:30:59,079 : INFO : Precision score for label_class 0: 0.9256
2024-08-15 17:30:59,079 : INFO : Precision score for label_class 1: 0.9907
2024-08-15 17:30:59,079 : INFO : Precision score for label_class 2: 0.9721
2024-08-15 17:30:59,079 : INFO : Recall score for label_class 0: 0.9511
2024-08-15 17:30:59,079 : INFO : Recall score for label_class 1: 0.9846
2024-08-15 17:30:59,079 : INFO : Recall score for label_class 2: 0.9734
2024-08-15 17:30:59,079 : INFO : Average F1 score: 0.9662
2024-08-15 17:30:59,546 : INFO : Average loss over validation batches: 0.4269
2024-08-15 17:30:59,546 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:59,546 : INFO : Validation metrics:
2024-08-15 17:30:59,546 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:30:59,550 : INFO : Accuracy: 0.8709
2024-08-15 17:30:59,550 : INFO : Precision score for label_class 0: 0.7978
2024-08-15 17:30:59,550 : INFO : Precision score for label_class 1: 0.8741
2024-08-15 17:30:59,550 : INFO : Precision score for label_class 2: 0.9024
2024-08-15 17:30:59,550 : INFO : Recall score for label_class 0: 0.8161
2024-08-15 17:30:59,550 : INFO : Recall score for label_class 1: 0.9436
2024-08-15 17:30:59,550 : INFO : Recall score for label_class 2: 0.7513
2024-08-15 17:30:59,550 : INFO : Average F1 score: 0.8448
2024-08-15 17:30:59,550 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:30:59,550 : INFO : Starting epoch 6
2024-08-15 17:31:00,203 : INFO : Current training batch loss: 0.0380 in epoch 6
2024-08-15 17:31:01,018 : INFO : Current training batch loss: 0.1083 in epoch 6
2024-08-15 17:31:01,833 : INFO : Current training batch loss: 0.0275 in epoch 6
2024-08-15 17:31:02,648 : INFO : Current training batch loss: 0.0189 in epoch 6
2024-08-15 17:31:03,000 : INFO : Epoch finished, average loss over training batches: 0.0654
2024-08-15 17:31:03,001 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:03,001 : INFO : Training metrics:
2024-08-15 17:31:03,001 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:03,005 : INFO : Accuracy: 0.9870
2024-08-15 17:31:03,005 : INFO : Precision score for label_class 0: 0.9635
2024-08-15 17:31:03,005 : INFO : Precision score for label_class 1: 0.9932
2024-08-15 17:31:03,005 : INFO : Precision score for label_class 2: 0.9840
2024-08-15 17:31:03,005 : INFO : Recall score for label_class 0: 0.9694
2024-08-15 17:31:03,005 : INFO : Recall score for label_class 1: 0.9938
2024-08-15 17:31:03,005 : INFO : Recall score for label_class 2: 0.9800
2024-08-15 17:31:03,005 : INFO : Average F1 score: 0.9807
2024-08-15 17:31:03,471 : INFO : Average loss over validation batches: 0.4495
2024-08-15 17:31:03,471 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:03,471 : INFO : Validation metrics:
2024-08-15 17:31:03,472 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:03,475 : INFO : Accuracy: 0.8605
2024-08-15 17:31:03,475 : INFO : Precision score for label_class 0: 0.7865
2024-08-15 17:31:03,475 : INFO : Precision score for label_class 1: 0.8708
2024-08-15 17:31:03,475 : INFO : Precision score for label_class 2: 0.8743
2024-08-15 17:31:03,475 : INFO : Recall score for label_class 0: 0.8046
2024-08-15 17:31:03,475 : INFO : Recall score for label_class 1: 0.9333
2024-08-15 17:31:03,475 : INFO : Recall score for label_class 2: 0.7411
2024-08-15 17:31:03,476 : INFO : Average F1 score: 0.8329
2024-08-15 17:31:03,476 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:31:03,476 : INFO : Starting epoch 7
2024-08-15 17:31:03,928 : INFO : Current training batch loss: 0.0194 in epoch 7
2024-08-15 17:31:04,743 : INFO : Current training batch loss: 0.0304 in epoch 7
2024-08-15 17:31:05,558 : INFO : Current training batch loss: 0.0221 in epoch 7
2024-08-15 17:31:06,373 : INFO : Current training batch loss: 0.0151 in epoch 7
2024-08-15 17:31:06,926 : INFO : Epoch finished, average loss over training batches: 0.0464
2024-08-15 17:31:06,926 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:06,926 : INFO : Training metrics:
2024-08-15 17:31:06,926 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:06,933 : INFO : Accuracy: 0.9918
2024-08-15 17:31:06,933 : INFO : Precision score for label_class 0: 0.9786
2024-08-15 17:31:06,933 : INFO : Precision score for label_class 1: 0.9951
2024-08-15 17:31:06,933 : INFO : Precision score for label_class 2: 0.9906
2024-08-15 17:31:06,933 : INFO : Recall score for label_class 0: 0.9786
2024-08-15 17:31:06,933 : INFO : Recall score for label_class 1: 0.9975
2024-08-15 17:31:06,933 : INFO : Recall score for label_class 2: 0.9854
2024-08-15 17:31:06,933 : INFO : Average F1 score: 0.9876
2024-08-15 17:31:07,400 : INFO : Average loss over validation batches: 0.4448
2024-08-15 17:31:07,400 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:07,400 : INFO : Validation metrics:
2024-08-15 17:31:07,400 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:07,404 : INFO : Accuracy: 0.8709
2024-08-15 17:31:07,404 : INFO : Precision score for label_class 0: 0.7841
2024-08-15 17:31:07,404 : INFO : Precision score for label_class 1: 0.9082
2024-08-15 17:31:07,404 : INFO : Precision score for label_class 2: 0.8351
2024-08-15 17:31:07,404 : INFO : Recall score for label_class 0: 0.7931
2024-08-15 17:31:07,404 : INFO : Recall score for label_class 1: 0.9128
2024-08-15 17:31:07,404 : INFO : Recall score for label_class 2: 0.8223
2024-08-15 17:31:07,404 : INFO : Average F1 score: 0.8426
2024-08-15 17:31:07,404 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:31:07,404 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:31:07,439 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:31:07,940 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:07,940 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:31:07,940 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:07,944 : INFO : Accuracy: 0.8650
2024-08-15 17:31:07,944 : INFO : Precision score for label_class 0: 0.7865
2024-08-15 17:31:07,944 : INFO : Precision score for label_class 1: 0.8867
2024-08-15 17:31:07,944 : INFO : Precision score for label_class 2: 0.8547
2024-08-15 17:31:07,944 : INFO : Recall score for label_class 0: 0.8046
2024-08-15 17:31:07,944 : INFO : Recall score for label_class 1: 0.9231
2024-08-15 17:31:07,944 : INFO : Recall score for label_class 2: 0.7766
2024-08-15 17:31:07,944 : INFO : Average F1 score: 0.8379
2024-08-15 17:31:07,944 : INFO : Determined score from best model, ending training.
2024-08-15 17:31:07,949 : INFO : Split 4 is finished, the score is: 0.8379
2024-08-15 17:31:07,949 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:07,949 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:07,949 : INFO : Starting training for split 5
2024-08-15 17:31:07,963 : INFO : Starting to tokenize the sequences.
2024-08-15 17:31:07,968 : INFO : Tokenization is finished.
2024-08-15 17:31:07,986 : INFO : Starting to tokenize the sequences.
2024-08-15 17:31:07,991 : INFO : Tokenization is finished.
2024-08-15 17:31:07,996 : INFO : Counting occurences of labels...
2024-08-15 17:31:07,997 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 330, 1615,  754]))
2024-08-15 17:31:07,997 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 84, 396, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:31:08,041 : INFO : Starting epoch 1
2024-08-15 17:31:08,093 : INFO : Current training batch loss: 1.0740 in epoch 1
2024-08-15 17:31:08,926 : INFO : Current training batch loss: 1.0021 in epoch 1
2024-08-15 17:31:09,754 : INFO : Current training batch loss: 0.7705 in epoch 1
2024-08-15 17:31:10,572 : INFO : Current training batch loss: 0.6820 in epoch 1
2024-08-15 17:31:11,388 : INFO : Current training batch loss: 0.6485 in epoch 1
2024-08-15 17:31:11,538 : INFO : Epoch finished, average loss over training batches: 0.8333
2024-08-15 17:31:11,538 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:11,538 : INFO : Training metrics:
2024-08-15 17:31:11,538 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:11,549 : INFO : Accuracy: 0.6699
2024-08-15 17:31:11,549 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:31:11,549 : INFO : Precision score for label_class 1: 0.6980
2024-08-15 17:31:11,549 : INFO : Precision score for label_class 2: 0.5413
2024-08-15 17:31:11,549 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:31:11,549 : INFO : Recall score for label_class 1: 0.9573
2024-08-15 17:31:11,549 : INFO : Recall score for label_class 2: 0.3475
2024-08-15 17:31:11,549 : INFO : Average F1 score: 0.4102
2024-08-15 17:31:12,016 : INFO : Average loss over validation batches: 0.6182
2024-08-15 17:31:12,016 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:12,016 : INFO : Validation metrics:
2024-08-15 17:31:12,016 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:12,019 : INFO : Accuracy: 0.7315
2024-08-15 17:31:12,020 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:31:12,020 : INFO : Precision score for label_class 1: 0.8307
2024-08-15 17:31:12,020 : INFO : Precision score for label_class 2: 0.5485
2024-08-15 17:31:12,020 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:31:12,020 : INFO : Recall score for label_class 1: 0.9167
2024-08-15 17:31:12,020 : INFO : Recall score for label_class 2: 0.6701
2024-08-15 17:31:12,020 : INFO : Average F1 score: 0.4916
2024-08-15 17:31:12,020 : INFO : Validation metric decreased (inf --> 0.618200).  Saving model ...
2024-08-15 17:31:12,121 : INFO : Starting epoch 2
2024-08-15 17:31:12,775 : INFO : Current training batch loss: 0.6380 in epoch 2
2024-08-15 17:31:13,590 : INFO : Current training batch loss: 0.4280 in epoch 2
2024-08-15 17:31:14,405 : INFO : Current training batch loss: 0.2619 in epoch 2
2024-08-15 17:31:15,220 : INFO : Current training batch loss: 0.5458 in epoch 2
2024-08-15 17:31:15,572 : INFO : Epoch finished, average loss over training batches: 0.4703
2024-08-15 17:31:15,572 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:15,572 : INFO : Training metrics:
2024-08-15 17:31:15,572 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:15,583 : INFO : Accuracy: 0.8396
2024-08-15 17:31:15,583 : INFO : Precision score for label_class 0: 0.7983
2024-08-15 17:31:15,583 : INFO : Precision score for label_class 1: 0.8808
2024-08-15 17:31:15,583 : INFO : Precision score for label_class 2: 0.7586
2024-08-15 17:31:15,583 : INFO : Recall score for label_class 0: 0.5636
2024-08-15 17:31:15,583 : INFO : Recall score for label_class 1: 0.9337
2024-08-15 17:31:15,583 : INFO : Recall score for label_class 2: 0.7586
2024-08-15 17:31:15,583 : INFO : Average F1 score: 0.7753
2024-08-15 17:31:16,049 : INFO : Average loss over validation batches: 0.4520
2024-08-15 17:31:16,049 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:16,049 : INFO : Validation metrics:
2024-08-15 17:31:16,049 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:16,052 : INFO : Accuracy: 0.8309
2024-08-15 17:31:16,052 : INFO : Precision score for label_class 0: 0.8033
2024-08-15 17:31:16,052 : INFO : Precision score for label_class 1: 0.8509
2024-08-15 17:31:16,052 : INFO : Precision score for label_class 2: 0.7910
2024-08-15 17:31:16,052 : INFO : Recall score for label_class 0: 0.5833
2024-08-15 17:31:16,052 : INFO : Recall score for label_class 1: 0.9369
2024-08-15 17:31:16,052 : INFO : Recall score for label_class 2: 0.7216
2024-08-15 17:31:16,052 : INFO : Average F1 score: 0.7741
2024-08-15 17:31:16,052 : INFO : Validation metric decreased (0.618200 --> 0.451984).  Saving model ...
2024-08-15 17:31:16,151 : INFO : Starting epoch 3
2024-08-15 17:31:16,603 : INFO : Current training batch loss: 0.2902 in epoch 3
2024-08-15 17:31:17,418 : INFO : Current training batch loss: 0.3649 in epoch 3
2024-08-15 17:31:18,233 : INFO : Current training batch loss: 0.2104 in epoch 3
2024-08-15 17:31:19,047 : INFO : Current training batch loss: 0.2137 in epoch 3
2024-08-15 17:31:19,600 : INFO : Epoch finished, average loss over training batches: 0.2630
2024-08-15 17:31:19,600 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:19,600 : INFO : Training metrics:
2024-08-15 17:31:19,600 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:19,611 : INFO : Accuracy: 0.9200
2024-08-15 17:31:19,611 : INFO : Precision score for label_class 0: 0.8597
2024-08-15 17:31:19,611 : INFO : Precision score for label_class 1: 0.9418
2024-08-15 17:31:19,611 : INFO : Precision score for label_class 2: 0.8988
2024-08-15 17:31:19,611 : INFO : Recall score for label_class 0: 0.8727
2024-08-15 17:31:19,611 : INFO : Recall score for label_class 1: 0.9523
2024-08-15 17:31:19,611 : INFO : Recall score for label_class 2: 0.8714
2024-08-15 17:31:19,611 : INFO : Average F1 score: 0.8994
2024-08-15 17:31:20,078 : INFO : Average loss over validation batches: 0.4207
2024-08-15 17:31:20,078 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:20,078 : INFO : Validation metrics:
2024-08-15 17:31:20,078 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:20,081 : INFO : Accuracy: 0.8338
2024-08-15 17:31:20,081 : INFO : Precision score for label_class 0: 0.8308
2024-08-15 17:31:20,081 : INFO : Precision score for label_class 1: 0.8622
2024-08-15 17:31:20,082 : INFO : Precision score for label_class 2: 0.7713
2024-08-15 17:31:20,082 : INFO : Recall score for label_class 0: 0.6429
2024-08-15 17:31:20,082 : INFO : Recall score for label_class 1: 0.9167
2024-08-15 17:31:20,082 : INFO : Recall score for label_class 2: 0.7474
2024-08-15 17:31:20,082 : INFO : Average F1 score: 0.7909
2024-08-15 17:31:20,082 : INFO : Validation metric decreased (0.451984 --> 0.420674).  Saving model ...
2024-08-15 17:31:20,184 : INFO : Starting epoch 4
2024-08-15 17:31:20,436 : INFO : Current training batch loss: 0.4318 in epoch 4
2024-08-15 17:31:21,251 : INFO : Current training batch loss: 0.1787 in epoch 4
2024-08-15 17:31:22,065 : INFO : Current training batch loss: 0.1817 in epoch 4
2024-08-15 17:31:22,880 : INFO : Current training batch loss: 0.0529 in epoch 4
2024-08-15 17:31:23,634 : INFO : Epoch finished, average loss over training batches: 0.1647
2024-08-15 17:31:23,634 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:23,634 : INFO : Training metrics:
2024-08-15 17:31:23,634 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:23,641 : INFO : Accuracy: 0.9522
2024-08-15 17:31:23,641 : INFO : Precision score for label_class 0: 0.9094
2024-08-15 17:31:23,641 : INFO : Precision score for label_class 1: 0.9650
2024-08-15 17:31:23,641 : INFO : Precision score for label_class 2: 0.9431
2024-08-15 17:31:23,641 : INFO : Recall score for label_class 0: 0.9121
2024-08-15 17:31:23,641 : INFO : Recall score for label_class 1: 0.9740
2024-08-15 17:31:23,641 : INFO : Recall score for label_class 2: 0.9231
2024-08-15 17:31:23,641 : INFO : Average F1 score: 0.9377
2024-08-15 17:31:24,109 : INFO : Average loss over validation batches: 0.4420
2024-08-15 17:31:24,109 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:24,109 : INFO : Validation metrics:
2024-08-15 17:31:24,109 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:24,113 : INFO : Accuracy: 0.8457
2024-08-15 17:31:24,113 : INFO : Precision score for label_class 0: 0.7128
2024-08-15 17:31:24,113 : INFO : Precision score for label_class 1: 0.9081
2024-08-15 17:31:24,113 : INFO : Precision score for label_class 2: 0.7889
2024-08-15 17:31:24,113 : INFO : Recall score for label_class 0: 0.7976
2024-08-15 17:31:24,113 : INFO : Recall score for label_class 1: 0.8737
2024-08-15 17:31:24,113 : INFO : Recall score for label_class 2: 0.8093
2024-08-15 17:31:24,113 : INFO : Average F1 score: 0.8141
2024-08-15 17:31:24,113 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:31:24,113 : INFO : Starting epoch 5
2024-08-15 17:31:24,164 : INFO : Current training batch loss: 0.0610 in epoch 5
2024-08-15 17:31:24,979 : INFO : Current training batch loss: 0.1779 in epoch 5
2024-08-15 17:31:25,794 : INFO : Current training batch loss: 0.0349 in epoch 5
2024-08-15 17:31:26,609 : INFO : Current training batch loss: 0.1132 in epoch 5
2024-08-15 17:31:27,425 : INFO : Current training batch loss: 0.0573 in epoch 5
2024-08-15 17:31:27,576 : INFO : Epoch finished, average loss over training batches: 0.1040
2024-08-15 17:31:27,576 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:27,576 : INFO : Training metrics:
2024-08-15 17:31:27,576 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:27,583 : INFO : Accuracy: 0.9711
2024-08-15 17:31:27,583 : INFO : Precision score for label_class 0: 0.9217
2024-08-15 17:31:27,583 : INFO : Precision score for label_class 1: 0.9826
2024-08-15 17:31:27,583 : INFO : Precision score for label_class 2: 0.9690
2024-08-15 17:31:27,583 : INFO : Recall score for label_class 0: 0.9636
2024-08-15 17:31:27,584 : INFO : Recall score for label_class 1: 0.9808
2024-08-15 17:31:27,584 : INFO : Recall score for label_class 2: 0.9536
2024-08-15 17:31:27,584 : INFO : Average F1 score: 0.9617
2024-08-15 17:31:28,051 : INFO : Average loss over validation batches: 0.4654
2024-08-15 17:31:28,051 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:28,051 : INFO : Validation metrics:
2024-08-15 17:31:28,051 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:28,055 : INFO : Accuracy: 0.8457
2024-08-15 17:31:28,055 : INFO : Precision score for label_class 0: 0.7419
2024-08-15 17:31:28,055 : INFO : Precision score for label_class 1: 0.8869
2024-08-15 17:31:28,055 : INFO : Precision score for label_class 2: 0.8087
2024-08-15 17:31:28,055 : INFO : Recall score for label_class 0: 0.8214
2024-08-15 17:31:28,055 : INFO : Recall score for label_class 1: 0.8914
2024-08-15 17:31:28,055 : INFO : Recall score for label_class 2: 0.7629
2024-08-15 17:31:28,055 : INFO : Average F1 score: 0.8180
2024-08-15 17:31:28,055 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:31:28,055 : INFO : Starting epoch 6
2024-08-15 17:31:28,709 : INFO : Current training batch loss: 0.0276 in epoch 6
2024-08-15 17:31:29,523 : INFO : Current training batch loss: 0.0612 in epoch 6
2024-08-15 17:31:30,339 : INFO : Current training batch loss: 0.0300 in epoch 6
2024-08-15 17:31:31,154 : INFO : Current training batch loss: 0.0218 in epoch 6
2024-08-15 17:31:31,506 : INFO : Epoch finished, average loss over training batches: 0.0605
2024-08-15 17:31:31,507 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:31,507 : INFO : Training metrics:
2024-08-15 17:31:31,507 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:31,515 : INFO : Accuracy: 0.9878
2024-08-15 17:31:31,515 : INFO : Precision score for label_class 0: 0.9556
2024-08-15 17:31:31,515 : INFO : Precision score for label_class 1: 0.9932
2024-08-15 17:31:31,515 : INFO : Precision score for label_class 2: 0.9906
2024-08-15 17:31:31,515 : INFO : Recall score for label_class 0: 0.9788
2024-08-15 17:31:31,515 : INFO : Recall score for label_class 1: 0.9920
2024-08-15 17:31:31,515 : INFO : Recall score for label_class 2: 0.9828
2024-08-15 17:31:31,515 : INFO : Average F1 score: 0.9821
2024-08-15 17:31:31,982 : INFO : Average loss over validation batches: 0.4801
2024-08-15 17:31:31,983 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:31,983 : INFO : Validation metrics:
2024-08-15 17:31:31,983 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:31,986 : INFO : Accuracy: 0.8576
2024-08-15 17:31:31,986 : INFO : Precision score for label_class 0: 0.7753
2024-08-15 17:31:31,986 : INFO : Precision score for label_class 1: 0.9134
2024-08-15 17:31:31,986 : INFO : Precision score for label_class 2: 0.7892
2024-08-15 17:31:31,986 : INFO : Recall score for label_class 0: 0.8214
2024-08-15 17:31:31,986 : INFO : Recall score for label_class 1: 0.8788
2024-08-15 17:31:31,986 : INFO : Recall score for label_class 2: 0.8299
2024-08-15 17:31:31,986 : INFO : Average F1 score: 0.8342
2024-08-15 17:31:31,986 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:31:31,986 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:31:32,020 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:31:32,524 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:32,524 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:31:32,524 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:32,527 : INFO : Accuracy: 0.8338
2024-08-15 17:31:32,528 : INFO : Precision score for label_class 0: 0.8308
2024-08-15 17:31:32,528 : INFO : Precision score for label_class 1: 0.8622
2024-08-15 17:31:32,528 : INFO : Precision score for label_class 2: 0.7713
2024-08-15 17:31:32,528 : INFO : Recall score for label_class 0: 0.6429
2024-08-15 17:31:32,528 : INFO : Recall score for label_class 1: 0.9167
2024-08-15 17:31:32,528 : INFO : Recall score for label_class 2: 0.7474
2024-08-15 17:31:32,528 : INFO : Average F1 score: 0.7909
2024-08-15 17:31:32,528 : INFO : Determined score from best model, ending training.
2024-08-15 17:31:32,529 : INFO : Split 5 is finished, the score is: 0.7909
2024-08-15 17:31:32,529 : INFO : ----------------------------------------------------------------------------------------------------
[I 2024-08-15 17:31:32,543] Trial 13 finished with value: 0.8327508142426476 and parameters: {'n_epochs': 8, 'learning_rate': 5.090856794565032e-05, 'classifier_dropout': 0.2919866837672007, 'warmup_step_fraction': 0.02939394123849349, 'use_gradient_clipping': False}. Best is trial 1 with value: 0.8513001269595835.
2024-08-15 17:31:32,551 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:32,551 : INFO : Starting training for split 1
2024-08-15 17:31:32,563 : INFO : Starting to tokenize the sequences.
2024-08-15 17:31:32,569 : INFO : Tokenization is finished.
2024-08-15 17:31:32,581 : INFO : Starting to tokenize the sequences.
2024-08-15 17:31:32,586 : INFO : Tokenization is finished.
2024-08-15 17:31:32,586 : INFO : Counting occurences of labels...
2024-08-15 17:31:32,587 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1596,  774]))
2024-08-15 17:31:32,588 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 415, 174]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:31:32,634 : INFO : Starting epoch 1
2024-08-15 17:31:32,688 : INFO : Current training batch loss: 1.0928 in epoch 1
2024-08-15 17:31:33,508 : INFO : Current training batch loss: 0.8971 in epoch 1
2024-08-15 17:31:34,323 : INFO : Current training batch loss: 0.9143 in epoch 1
2024-08-15 17:31:35,138 : INFO : Current training batch loss: 0.7383 in epoch 1
2024-08-15 17:31:35,953 : INFO : Current training batch loss: 0.7195 in epoch 1
2024-08-15 17:31:36,193 : INFO : Epoch finished, average loss over training batches: 0.8588
2024-08-15 17:31:36,194 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:36,194 : INFO : Training metrics:
2024-08-15 17:31:36,194 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:36,199 : INFO : Accuracy: 0.6497
2024-08-15 17:31:36,199 : INFO : Precision score for label_class 0: 0.5000
2024-08-15 17:31:36,199 : INFO : Precision score for label_class 1: 0.6788
2024-08-15 17:31:36,199 : INFO : Precision score for label_class 2: 0.5157
2024-08-15 17:31:36,199 : INFO : Recall score for label_class 0: 0.0030
2024-08-15 17:31:36,199 : INFO : Recall score for label_class 1: 0.9430
2024-08-15 17:31:36,199 : INFO : Recall score for label_class 2: 0.3191
2024-08-15 17:31:36,199 : INFO : Average F1 score: 0.3966
2024-08-15 17:31:36,666 : INFO : Average loss over validation batches: 0.6834
2024-08-15 17:31:36,667 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:36,667 : INFO : Validation metrics:
2024-08-15 17:31:36,667 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:36,669 : INFO : Accuracy: 0.7333
2024-08-15 17:31:36,669 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:31:36,669 : INFO : Precision score for label_class 1: 0.8248
2024-08-15 17:31:36,669 : INFO : Precision score for label_class 2: 0.5266
2024-08-15 17:31:36,669 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:31:36,669 : INFO : Recall score for label_class 1: 0.9301
2024-08-15 17:31:36,669 : INFO : Recall score for label_class 2: 0.6264
2024-08-15 17:31:36,669 : INFO : Average F1 score: 0.4822
2024-08-15 17:31:36,669 : INFO : Validation metric decreased (inf --> 0.683355).  Saving model ...
2024-08-15 17:31:36,781 : INFO : Starting epoch 2
2024-08-15 17:31:37,435 : INFO : Current training batch loss: 0.4188 in epoch 2
2024-08-15 17:31:38,249 : INFO : Current training batch loss: 0.6379 in epoch 2
2024-08-15 17:31:39,064 : INFO : Current training batch loss: 0.4528 in epoch 2
2024-08-15 17:31:39,879 : INFO : Current training batch loss: 0.3614 in epoch 2
2024-08-15 17:31:40,231 : INFO : Epoch finished, average loss over training batches: 0.5338
2024-08-15 17:31:40,231 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:40,231 : INFO : Training metrics:
2024-08-15 17:31:40,231 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:40,237 : INFO : Accuracy: 0.8069
2024-08-15 17:31:40,237 : INFO : Precision score for label_class 0: 0.7634
2024-08-15 17:31:40,237 : INFO : Precision score for label_class 1: 0.8661
2024-08-15 17:31:40,237 : INFO : Precision score for label_class 2: 0.6924
2024-08-15 17:31:40,237 : INFO : Recall score for label_class 0: 0.3049
2024-08-15 17:31:40,237 : INFO : Recall score for label_class 1: 0.9361
2024-08-15 17:31:40,237 : INFO : Recall score for label_class 2: 0.7532
2024-08-15 17:31:40,237 : INFO : Average F1 score: 0.6857
2024-08-15 17:31:40,705 : INFO : Average loss over validation batches: 0.4386
2024-08-15 17:31:40,705 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:40,705 : INFO : Validation metrics:
2024-08-15 17:31:40,705 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:40,708 : INFO : Accuracy: 0.8533
2024-08-15 17:31:40,708 : INFO : Precision score for label_class 0: 0.7609
2024-08-15 17:31:40,708 : INFO : Precision score for label_class 1: 0.9173
2024-08-15 17:31:40,708 : INFO : Precision score for label_class 2: 0.7609
2024-08-15 17:31:40,708 : INFO : Recall score for label_class 0: 0.8140
2024-08-15 17:31:40,708 : INFO : Recall score for label_class 1: 0.8819
2024-08-15 17:31:40,708 : INFO : Recall score for label_class 2: 0.8046
2024-08-15 17:31:40,708 : INFO : Average F1 score: 0.8226
2024-08-15 17:31:40,708 : INFO : Validation metric decreased (0.683355 --> 0.438566).  Saving model ...
2024-08-15 17:31:40,812 : INFO : Starting epoch 3
2024-08-15 17:31:41,265 : INFO : Current training batch loss: 0.3452 in epoch 3
2024-08-15 17:31:42,081 : INFO : Current training batch loss: 0.3992 in epoch 3
2024-08-15 17:31:42,895 : INFO : Current training batch loss: 0.3599 in epoch 3
2024-08-15 17:31:43,710 : INFO : Current training batch loss: 0.1862 in epoch 3
2024-08-15 17:31:44,263 : INFO : Epoch finished, average loss over training batches: 0.3253
2024-08-15 17:31:44,263 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:44,263 : INFO : Training metrics:
2024-08-15 17:31:44,264 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:44,271 : INFO : Accuracy: 0.9029
2024-08-15 17:31:44,272 : INFO : Precision score for label_class 0: 0.8053
2024-08-15 17:31:44,272 : INFO : Precision score for label_class 1: 0.9322
2024-08-15 17:31:44,272 : INFO : Precision score for label_class 2: 0.8833
2024-08-15 17:31:44,272 : INFO : Recall score for label_class 0: 0.8323
2024-08-15 17:31:44,272 : INFO : Recall score for label_class 1: 0.9474
2024-08-15 17:31:44,272 : INFO : Recall score for label_class 2: 0.8411
2024-08-15 17:31:44,272 : INFO : Average F1 score: 0.8733
2024-08-15 17:31:44,741 : INFO : Average loss over validation batches: 0.3734
2024-08-15 17:31:44,741 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:44,741 : INFO : Validation metrics:
2024-08-15 17:31:44,742 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:44,744 : INFO : Accuracy: 0.8667
2024-08-15 17:31:44,744 : INFO : Precision score for label_class 0: 0.7117
2024-08-15 17:31:44,744 : INFO : Precision score for label_class 1: 0.9167
2024-08-15 17:31:44,744 : INFO : Precision score for label_class 2: 0.8462
2024-08-15 17:31:44,744 : INFO : Recall score for label_class 0: 0.9186
2024-08-15 17:31:44,744 : INFO : Recall score for label_class 1: 0.9012
2024-08-15 17:31:44,744 : INFO : Recall score for label_class 2: 0.7586
2024-08-15 17:31:44,744 : INFO : Average F1 score: 0.8370
2024-08-15 17:31:44,744 : INFO : Validation metric decreased (0.438566 --> 0.373448).  Saving model ...
2024-08-15 17:31:44,849 : INFO : Starting epoch 4
2024-08-15 17:31:45,101 : INFO : Current training batch loss: 0.5252 in epoch 4
2024-08-15 17:31:45,915 : INFO : Current training batch loss: 0.2560 in epoch 4
2024-08-15 17:31:46,730 : INFO : Current training batch loss: 0.3042 in epoch 4
2024-08-15 17:31:47,545 : INFO : Current training batch loss: 0.1643 in epoch 4
2024-08-15 17:31:48,300 : INFO : Epoch finished, average loss over training batches: 0.2181
2024-08-15 17:31:48,300 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:48,300 : INFO : Training metrics:
2024-08-15 17:31:48,300 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:48,305 : INFO : Accuracy: 0.9388
2024-08-15 17:31:48,305 : INFO : Precision score for label_class 0: 0.8592
2024-08-15 17:31:48,305 : INFO : Precision score for label_class 1: 0.9601
2024-08-15 17:31:48,305 : INFO : Precision score for label_class 2: 0.9304
2024-08-15 17:31:48,305 : INFO : Recall score for label_class 0: 0.9116
2024-08-15 17:31:48,305 : INFO : Recall score for label_class 1: 0.9643
2024-08-15 17:31:48,305 : INFO : Recall score for label_class 2: 0.8979
2024-08-15 17:31:48,305 : INFO : Average F1 score: 0.9202
2024-08-15 17:31:48,774 : INFO : Average loss over validation batches: 0.3659
2024-08-15 17:31:48,775 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:48,775 : INFO : Validation metrics:
2024-08-15 17:31:48,775 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:48,777 : INFO : Accuracy: 0.8622
2024-08-15 17:31:48,778 : INFO : Precision score for label_class 0: 0.7653
2024-08-15 17:31:48,778 : INFO : Precision score for label_class 1: 0.9326
2024-08-15 17:31:48,778 : INFO : Precision score for label_class 2: 0.7696
2024-08-15 17:31:48,778 : INFO : Recall score for label_class 0: 0.8721
2024-08-15 17:31:48,778 : INFO : Recall score for label_class 1: 0.8675
2024-08-15 17:31:48,778 : INFO : Recall score for label_class 2: 0.8448
2024-08-15 17:31:48,778 : INFO : Average F1 score: 0.8399
2024-08-15 17:31:48,778 : INFO : Validation metric decreased (0.373448 --> 0.365874).  Saving model ...
2024-08-15 17:31:48,881 : INFO : Starting epoch 5
2024-08-15 17:31:48,933 : INFO : Current training batch loss: 0.1284 in epoch 5
2024-08-15 17:31:49,747 : INFO : Current training batch loss: 0.2712 in epoch 5
2024-08-15 17:31:50,562 : INFO : Current training batch loss: 0.0664 in epoch 5
2024-08-15 17:31:51,384 : INFO : Current training batch loss: 0.2280 in epoch 5
2024-08-15 17:31:52,200 : INFO : Current training batch loss: 0.1314 in epoch 5
2024-08-15 17:31:52,350 : INFO : Epoch finished, average loss over training batches: 0.1533
2024-08-15 17:31:52,350 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:52,350 : INFO : Training metrics:
2024-08-15 17:31:52,350 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:52,358 : INFO : Accuracy: 0.9600
2024-08-15 17:31:52,358 : INFO : Precision score for label_class 0: 0.9009
2024-08-15 17:31:52,358 : INFO : Precision score for label_class 1: 0.9720
2024-08-15 17:31:52,358 : INFO : Precision score for label_class 2: 0.9613
2024-08-15 17:31:52,358 : INFO : Recall score for label_class 0: 0.9421
2024-08-15 17:31:52,358 : INFO : Recall score for label_class 1: 0.9774
2024-08-15 17:31:52,358 : INFO : Recall score for label_class 2: 0.9315
2024-08-15 17:31:52,358 : INFO : Average F1 score: 0.9473
2024-08-15 17:31:52,827 : INFO : Average loss over validation batches: 0.5771
2024-08-15 17:31:52,828 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:52,828 : INFO : Validation metrics:
2024-08-15 17:31:52,828 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:52,830 : INFO : Accuracy: 0.7956
2024-08-15 17:31:52,830 : INFO : Precision score for label_class 0: 0.6667
2024-08-15 17:31:52,830 : INFO : Precision score for label_class 1: 0.9707
2024-08-15 17:31:52,830 : INFO : Precision score for label_class 2: 0.6411
2024-08-15 17:31:52,830 : INFO : Recall score for label_class 0: 0.9302
2024-08-15 17:31:52,830 : INFO : Recall score for label_class 1: 0.7181
2024-08-15 17:31:52,830 : INFO : Recall score for label_class 2: 0.9138
2024-08-15 17:31:52,830 : INFO : Average F1 score: 0.7852
2024-08-15 17:31:52,830 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:31:52,830 : INFO : Starting epoch 6
2024-08-15 17:31:53,484 : INFO : Current training batch loss: 0.0306 in epoch 6
2024-08-15 17:31:54,299 : INFO : Current training batch loss: 0.0789 in epoch 6
2024-08-15 17:31:55,123 : INFO : Current training batch loss: 0.0439 in epoch 6
2024-08-15 17:31:55,944 : INFO : Current training batch loss: 0.0451 in epoch 6
2024-08-15 17:31:56,300 : INFO : Epoch finished, average loss over training batches: 0.1306
2024-08-15 17:31:56,300 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:56,300 : INFO : Training metrics:
2024-08-15 17:31:56,301 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:56,305 : INFO : Accuracy: 0.9640
2024-08-15 17:31:56,305 : INFO : Precision score for label_class 0: 0.9265
2024-08-15 17:31:56,305 : INFO : Precision score for label_class 1: 0.9738
2024-08-15 17:31:56,305 : INFO : Precision score for label_class 2: 0.9603
2024-08-15 17:31:56,305 : INFO : Recall score for label_class 0: 0.9604
2024-08-15 17:31:56,305 : INFO : Recall score for label_class 1: 0.9774
2024-08-15 17:31:56,305 : INFO : Recall score for label_class 2: 0.9380
2024-08-15 17:31:56,305 : INFO : Average F1 score: 0.9559
2024-08-15 17:31:56,772 : INFO : Average loss over validation batches: 0.3481
2024-08-15 17:31:56,772 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:56,772 : INFO : Validation metrics:
2024-08-15 17:31:56,772 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:31:56,776 : INFO : Accuracy: 0.8785
2024-08-15 17:31:56,776 : INFO : Precision score for label_class 0: 0.7723
2024-08-15 17:31:56,776 : INFO : Precision score for label_class 1: 0.9115
2024-08-15 17:31:56,776 : INFO : Precision score for label_class 2: 0.8590
2024-08-15 17:31:56,776 : INFO : Recall score for label_class 0: 0.9070
2024-08-15 17:31:56,776 : INFO : Recall score for label_class 1: 0.9181
2024-08-15 17:31:56,776 : INFO : Recall score for label_class 2: 0.7701
2024-08-15 17:31:56,776 : INFO : Average F1 score: 0.8537
2024-08-15 17:31:56,776 : INFO : Validation metric decreased (0.365874 --> 0.348053).  Saving model ...
2024-08-15 17:31:56,877 : INFO : Starting epoch 7
2024-08-15 17:31:57,338 : INFO : Current training batch loss: 0.0550 in epoch 7
2024-08-15 17:31:58,164 : INFO : Current training batch loss: 0.0334 in epoch 7
2024-08-15 17:31:58,982 : INFO : Current training batch loss: 0.0533 in epoch 7
2024-08-15 17:31:59,799 : INFO : Current training batch loss: 0.0266 in epoch 7
2024-08-15 17:32:00,355 : INFO : Epoch finished, average loss over training batches: 0.0913
2024-08-15 17:32:00,355 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:00,355 : INFO : Training metrics:
2024-08-15 17:32:00,355 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:00,360 : INFO : Accuracy: 0.9789
2024-08-15 17:32:00,360 : INFO : Precision score for label_class 0: 0.9331
2024-08-15 17:32:00,360 : INFO : Precision score for label_class 1: 0.9887
2024-08-15 17:32:00,360 : INFO : Precision score for label_class 2: 0.9790
2024-08-15 17:32:00,360 : INFO : Recall score for label_class 0: 0.9787
2024-08-15 17:32:00,360 : INFO : Recall score for label_class 1: 0.9868
2024-08-15 17:32:00,360 : INFO : Recall score for label_class 2: 0.9625
2024-08-15 17:32:00,360 : INFO : Average F1 score: 0.9713
2024-08-15 17:32:00,827 : INFO : Average loss over validation batches: 0.3785
2024-08-15 17:32:00,827 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:00,827 : INFO : Validation metrics:
2024-08-15 17:32:00,827 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:00,830 : INFO : Accuracy: 0.8652
2024-08-15 17:32:00,831 : INFO : Precision score for label_class 0: 0.7212
2024-08-15 17:32:00,831 : INFO : Precision score for label_class 1: 0.9185
2024-08-15 17:32:00,831 : INFO : Precision score for label_class 2: 0.8253
2024-08-15 17:32:00,831 : INFO : Recall score for label_class 0: 0.8721
2024-08-15 17:32:00,831 : INFO : Recall score for label_class 1: 0.8964
2024-08-15 17:32:00,831 : INFO : Recall score for label_class 2: 0.7874
2024-08-15 17:32:00,831 : INFO : Average F1 score: 0.8342
2024-08-15 17:32:00,831 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:32:00,831 : INFO : Starting epoch 8
2024-08-15 17:32:01,084 : INFO : Current training batch loss: 0.1339 in epoch 8
2024-08-15 17:32:01,908 : INFO : Current training batch loss: 0.0319 in epoch 8
2024-08-15 17:32:02,737 : INFO : Current training batch loss: 0.1633 in epoch 8
2024-08-15 17:32:03,558 : INFO : Current training batch loss: 0.1185 in epoch 8
2024-08-15 17:32:04,330 : INFO : Epoch finished, average loss over training batches: 0.0718
2024-08-15 17:32:04,330 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:04,330 : INFO : Training metrics:
2024-08-15 17:32:04,330 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:04,336 : INFO : Accuracy: 0.9855
2024-08-15 17:32:04,336 : INFO : Precision score for label_class 0: 0.9364
2024-08-15 17:32:04,336 : INFO : Precision score for label_class 1: 0.9937
2024-08-15 17:32:04,336 : INFO : Precision score for label_class 2: 0.9908
2024-08-15 17:32:04,336 : INFO : Recall score for label_class 0: 0.9878
2024-08-15 17:32:04,336 : INFO : Recall score for label_class 1: 0.9925
2024-08-15 17:32:04,336 : INFO : Recall score for label_class 2: 0.9703
2024-08-15 17:32:04,336 : INFO : Average F1 score: 0.9783
2024-08-15 17:32:04,805 : INFO : Average loss over validation batches: 0.3851
2024-08-15 17:32:04,805 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:04,805 : INFO : Validation metrics:
2024-08-15 17:32:04,805 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:04,808 : INFO : Accuracy: 0.8726
2024-08-15 17:32:04,808 : INFO : Precision score for label_class 0: 0.7800
2024-08-15 17:32:04,808 : INFO : Precision score for label_class 1: 0.9089
2024-08-15 17:32:04,808 : INFO : Precision score for label_class 2: 0.8354
2024-08-15 17:32:04,808 : INFO : Recall score for label_class 0: 0.9070
2024-08-15 17:32:04,808 : INFO : Recall score for label_class 1: 0.9133
2024-08-15 17:32:04,808 : INFO : Recall score for label_class 2: 0.7586
2024-08-15 17:32:04,808 : INFO : Average F1 score: 0.8483
2024-08-15 17:32:04,808 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:32:04,808 : INFO : Starting epoch 9
2024-08-15 17:32:04,860 : INFO : Current training batch loss: 0.0258 in epoch 9
2024-08-15 17:32:05,685 : INFO : Current training batch loss: 0.1703 in epoch 9
2024-08-15 17:32:06,517 : INFO : Current training batch loss: 0.0315 in epoch 9
2024-08-15 17:32:07,328 : INFO : Current training batch loss: 0.1306 in epoch 9
2024-08-15 17:32:08,138 : INFO : Current training batch loss: 0.0179 in epoch 9
2024-08-15 17:32:08,281 : INFO : Epoch finished, average loss over training batches: 0.0613
2024-08-15 17:32:08,281 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:08,281 : INFO : Training metrics:
2024-08-15 17:32:08,281 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:08,289 : INFO : Accuracy: 0.9881
2024-08-15 17:32:08,289 : INFO : Precision score for label_class 0: 0.9451
2024-08-15 17:32:08,289 : INFO : Precision score for label_class 1: 0.9944
2024-08-15 17:32:08,289 : INFO : Precision score for label_class 2: 0.9947
2024-08-15 17:32:08,289 : INFO : Recall score for label_class 0: 0.9970
2024-08-15 17:32:08,289 : INFO : Recall score for label_class 1: 0.9931
2024-08-15 17:32:08,289 : INFO : Recall score for label_class 2: 0.9742
2024-08-15 17:32:08,289 : INFO : Average F1 score: 0.9828
2024-08-15 17:32:08,756 : INFO : Average loss over validation batches: 0.3869
2024-08-15 17:32:08,757 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:08,757 : INFO : Validation metrics:
2024-08-15 17:32:08,757 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:08,759 : INFO : Accuracy: 0.8756
2024-08-15 17:32:08,759 : INFO : Precision score for label_class 0: 0.7732
2024-08-15 17:32:08,760 : INFO : Precision score for label_class 1: 0.9240
2024-08-15 17:32:08,760 : INFO : Precision score for label_class 2: 0.8176
2024-08-15 17:32:08,760 : INFO : Recall score for label_class 0: 0.8721
2024-08-15 17:32:08,760 : INFO : Recall score for label_class 1: 0.9084
2024-08-15 17:32:08,760 : INFO : Recall score for label_class 2: 0.7989
2024-08-15 17:32:08,760 : INFO : Average F1 score: 0.8480
2024-08-15 17:32:08,760 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:32:08,760 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:32:08,800 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:32:09,303 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:09,303 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:32:09,303 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:09,306 : INFO : Accuracy: 0.8785
2024-08-15 17:32:09,306 : INFO : Precision score for label_class 0: 0.7723
2024-08-15 17:32:09,306 : INFO : Precision score for label_class 1: 0.9115
2024-08-15 17:32:09,306 : INFO : Precision score for label_class 2: 0.8590
2024-08-15 17:32:09,306 : INFO : Recall score for label_class 0: 0.9070
2024-08-15 17:32:09,306 : INFO : Recall score for label_class 1: 0.9181
2024-08-15 17:32:09,306 : INFO : Recall score for label_class 2: 0.7701
2024-08-15 17:32:09,306 : INFO : Average F1 score: 0.8537
2024-08-15 17:32:09,306 : INFO : Determined score from best model, ending training.
2024-08-15 17:32:09,314 : INFO : Split 1 is finished, the score is: 0.8537
2024-08-15 17:32:09,314 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:09,314 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:09,314 : INFO : Starting training for split 2
2024-08-15 17:32:09,327 : INFO : Starting to tokenize the sequences.
2024-08-15 17:32:09,333 : INFO : Tokenization is finished.
2024-08-15 17:32:09,350 : INFO : Starting to tokenize the sequences.
2024-08-15 17:32:09,355 : INFO : Tokenization is finished.
2024-08-15 17:32:09,360 : INFO : Counting occurences of labels...
2024-08-15 17:32:09,361 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 343, 1601,  754]))
2024-08-15 17:32:09,361 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 71, 410, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:32:09,410 : INFO : Starting epoch 1
2024-08-15 17:32:09,461 : INFO : Current training batch loss: 1.1026 in epoch 1
2024-08-15 17:32:10,275 : INFO : Current training batch loss: 1.0065 in epoch 1
2024-08-15 17:32:11,086 : INFO : Current training batch loss: 0.8960 in epoch 1
2024-08-15 17:32:11,897 : INFO : Current training batch loss: 0.7010 in epoch 1
2024-08-15 17:32:12,707 : INFO : Current training batch loss: 0.7829 in epoch 1
2024-08-15 17:32:12,850 : INFO : Epoch finished, average loss over training batches: 0.8596
2024-08-15 17:32:12,851 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:12,851 : INFO : Training metrics:
2024-08-15 17:32:12,851 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:12,860 : INFO : Accuracy: 0.6401
2024-08-15 17:32:12,860 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:32:12,860 : INFO : Precision score for label_class 1: 0.6864
2024-08-15 17:32:12,860 : INFO : Precision score for label_class 2: 0.4613
2024-08-15 17:32:12,860 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:32:12,860 : INFO : Recall score for label_class 1: 0.9188
2024-08-15 17:32:12,860 : INFO : Recall score for label_class 2: 0.3395
2024-08-15 17:32:12,860 : INFO : Average F1 score: 0.3923
2024-08-15 17:32:13,326 : INFO : Average loss over validation batches: 0.6426
2024-08-15 17:32:13,326 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:13,326 : INFO : Validation metrics:
2024-08-15 17:32:13,326 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:13,330 : INFO : Accuracy: 0.7511
2024-08-15 17:32:13,330 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:32:13,330 : INFO : Precision score for label_class 1: 0.8217
2024-08-15 17:32:13,330 : INFO : Precision score for label_class 2: 0.6000
2024-08-15 17:32:13,330 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:32:13,330 : INFO : Recall score for label_class 1: 0.9220
2024-08-15 17:32:13,330 : INFO : Recall score for label_class 2: 0.6649
2024-08-15 17:32:13,330 : INFO : Average F1 score: 0.4999
2024-08-15 17:32:13,330 : INFO : Validation metric decreased (inf --> 0.642602).  Saving model ...
2024-08-15 17:32:13,431 : INFO : Starting epoch 2
2024-08-15 17:32:14,082 : INFO : Current training batch loss: 0.6404 in epoch 2
2024-08-15 17:32:14,892 : INFO : Current training batch loss: 0.5957 in epoch 2
2024-08-15 17:32:15,703 : INFO : Current training batch loss: 0.4095 in epoch 2
2024-08-15 17:32:16,515 : INFO : Current training batch loss: 0.3817 in epoch 2
2024-08-15 17:32:16,858 : INFO : Epoch finished, average loss over training batches: 0.5106
2024-08-15 17:32:16,859 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:16,859 : INFO : Training metrics:
2024-08-15 17:32:16,859 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:16,868 : INFO : Accuracy: 0.8221
2024-08-15 17:32:16,868 : INFO : Precision score for label_class 0: 0.8239
2024-08-15 17:32:16,868 : INFO : Precision score for label_class 1: 0.8707
2024-08-15 17:32:16,868 : INFO : Precision score for label_class 2: 0.7152
2024-08-15 17:32:16,868 : INFO : Recall score for label_class 0: 0.4227
2024-08-15 17:32:16,868 : INFO : Recall score for label_class 1: 0.9419
2024-08-15 17:32:16,868 : INFO : Recall score for label_class 2: 0.7493
2024-08-15 17:32:16,868 : INFO : Average F1 score: 0.7318
2024-08-15 17:32:17,334 : INFO : Average loss over validation batches: 0.4101
2024-08-15 17:32:17,334 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:17,334 : INFO : Validation metrics:
2024-08-15 17:32:17,334 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:17,337 : INFO : Accuracy: 0.8607
2024-08-15 17:32:17,337 : INFO : Precision score for label_class 0: 0.7534
2024-08-15 17:32:17,337 : INFO : Precision score for label_class 1: 0.8796
2024-08-15 17:32:17,338 : INFO : Precision score for label_class 2: 0.8588
2024-08-15 17:32:17,338 : INFO : Recall score for label_class 0: 0.7746
2024-08-15 17:32:17,338 : INFO : Recall score for label_class 1: 0.9268
2024-08-15 17:32:17,338 : INFO : Recall score for label_class 2: 0.7526
2024-08-15 17:32:17,338 : INFO : Average F1 score: 0.8229
2024-08-15 17:32:17,338 : INFO : Validation metric decreased (0.642602 --> 0.410091).  Saving model ...
2024-08-15 17:32:17,439 : INFO : Starting epoch 3
2024-08-15 17:32:17,890 : INFO : Current training batch loss: 0.3281 in epoch 3
2024-08-15 17:32:18,699 : INFO : Current training batch loss: 0.3555 in epoch 3
2024-08-15 17:32:19,510 : INFO : Current training batch loss: 0.3507 in epoch 3
2024-08-15 17:32:20,320 : INFO : Current training batch loss: 0.2001 in epoch 3
2024-08-15 17:32:20,872 : INFO : Epoch finished, average loss over training batches: 0.2904
2024-08-15 17:32:20,873 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:20,873 : INFO : Training metrics:
2024-08-15 17:32:20,873 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:20,881 : INFO : Accuracy: 0.9218
2024-08-15 17:32:20,881 : INFO : Precision score for label_class 0: 0.8391
2024-08-15 17:32:20,881 : INFO : Precision score for label_class 1: 0.9486
2024-08-15 17:32:20,881 : INFO : Precision score for label_class 2: 0.9020
2024-08-15 17:32:20,881 : INFO : Recall score for label_class 0: 0.8513
2024-08-15 17:32:20,881 : INFO : Recall score for label_class 1: 0.9569
2024-08-15 17:32:20,881 : INFO : Recall score for label_class 2: 0.8793
2024-08-15 17:32:20,881 : INFO : Average F1 score: 0.8961
2024-08-15 17:32:21,349 : INFO : Average loss over validation batches: 0.3982
2024-08-15 17:32:21,350 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:21,350 : INFO : Validation metrics:
2024-08-15 17:32:21,350 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:21,353 : INFO : Accuracy: 0.8696
2024-08-15 17:32:21,353 : INFO : Precision score for label_class 0: 0.7808
2024-08-15 17:32:21,353 : INFO : Precision score for label_class 1: 0.8719
2024-08-15 17:32:21,353 : INFO : Precision score for label_class 2: 0.9045
2024-08-15 17:32:21,353 : INFO : Recall score for label_class 0: 0.8028
2024-08-15 17:32:21,353 : INFO : Recall score for label_class 1: 0.9463
2024-08-15 17:32:21,353 : INFO : Recall score for label_class 2: 0.7320
2024-08-15 17:32:21,353 : INFO : Average F1 score: 0.8361
2024-08-15 17:32:21,353 : INFO : Validation metric decreased (0.410091 --> 0.398222).  Saving model ...
2024-08-15 17:32:21,457 : INFO : Starting epoch 4
2024-08-15 17:32:21,710 : INFO : Current training batch loss: 0.3045 in epoch 4
2024-08-15 17:32:22,527 : INFO : Current training batch loss: 0.1552 in epoch 4
2024-08-15 17:32:23,342 : INFO : Current training batch loss: 0.3383 in epoch 4
2024-08-15 17:32:24,156 : INFO : Current training batch loss: 0.1519 in epoch 4
2024-08-15 17:32:24,911 : INFO : Epoch finished, average loss over training batches: 0.1912
2024-08-15 17:32:24,911 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:24,911 : INFO : Training metrics:
2024-08-15 17:32:24,911 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:24,922 : INFO : Accuracy: 0.9503
2024-08-15 17:32:24,922 : INFO : Precision score for label_class 0: 0.8936
2024-08-15 17:32:24,922 : INFO : Precision score for label_class 1: 0.9670
2024-08-15 17:32:24,922 : INFO : Precision score for label_class 2: 0.9413
2024-08-15 17:32:24,922 : INFO : Recall score for label_class 0: 0.9300
2024-08-15 17:32:24,922 : INFO : Recall score for label_class 1: 0.9713
2024-08-15 17:32:24,922 : INFO : Recall score for label_class 2: 0.9151
2024-08-15 17:32:24,922 : INFO : Average F1 score: 0.9362
2024-08-15 17:32:25,389 : INFO : Average loss over validation batches: 0.4136
2024-08-15 17:32:25,389 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:25,389 : INFO : Validation metrics:
2024-08-15 17:32:25,389 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:25,393 : INFO : Accuracy: 0.8474
2024-08-15 17:32:25,393 : INFO : Precision score for label_class 0: 0.7568
2024-08-15 17:32:25,393 : INFO : Precision score for label_class 1: 0.8856
2024-08-15 17:32:25,393 : INFO : Precision score for label_class 2: 0.8000
2024-08-15 17:32:25,393 : INFO : Recall score for label_class 0: 0.7887
2024-08-15 17:32:25,393 : INFO : Recall score for label_class 1: 0.8878
2024-08-15 17:32:25,393 : INFO : Recall score for label_class 2: 0.7835
2024-08-15 17:32:25,393 : INFO : Average F1 score: 0.8169
2024-08-15 17:32:25,393 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:32:25,393 : INFO : Starting epoch 5
2024-08-15 17:32:25,443 : INFO : Current training batch loss: 0.1307 in epoch 5
2024-08-15 17:32:26,259 : INFO : Current training batch loss: 0.2278 in epoch 5
2024-08-15 17:32:27,074 : INFO : Current training batch loss: 0.0687 in epoch 5
2024-08-15 17:32:27,890 : INFO : Current training batch loss: 0.0999 in epoch 5
2024-08-15 17:32:28,706 : INFO : Current training batch loss: 0.1420 in epoch 5
2024-08-15 17:32:28,857 : INFO : Epoch finished, average loss over training batches: 0.1434
2024-08-15 17:32:28,857 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:28,857 : INFO : Training metrics:
2024-08-15 17:32:28,857 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:28,867 : INFO : Accuracy: 0.9648
2024-08-15 17:32:28,867 : INFO : Precision score for label_class 0: 0.9205
2024-08-15 17:32:28,867 : INFO : Precision score for label_class 1: 0.9728
2024-08-15 17:32:28,867 : INFO : Precision score for label_class 2: 0.9685
2024-08-15 17:32:28,867 : INFO : Recall score for label_class 0: 0.9446
2024-08-15 17:32:28,867 : INFO : Recall score for label_class 1: 0.9819
2024-08-15 17:32:28,867 : INFO : Recall score for label_class 2: 0.9377
2024-08-15 17:32:28,867 : INFO : Average F1 score: 0.9542
2024-08-15 17:32:29,336 : INFO : Average loss over validation batches: 0.5273
2024-08-15 17:32:29,337 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:29,337 : INFO : Validation metrics:
2024-08-15 17:32:29,337 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:29,340 : INFO : Accuracy: 0.8133
2024-08-15 17:32:29,340 : INFO : Precision score for label_class 0: 0.7442
2024-08-15 17:32:29,340 : INFO : Precision score for label_class 1: 0.9375
2024-08-15 17:32:29,340 : INFO : Precision score for label_class 2: 0.6719
2024-08-15 17:32:29,340 : INFO : Recall score for label_class 0: 0.9014
2024-08-15 17:32:29,340 : INFO : Recall score for label_class 1: 0.7683
2024-08-15 17:32:29,340 : INFO : Recall score for label_class 2: 0.8763
2024-08-15 17:32:29,340 : INFO : Average F1 score: 0.8068
2024-08-15 17:32:29,340 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:32:29,340 : INFO : Starting epoch 6
2024-08-15 17:32:29,994 : INFO : Current training batch loss: 0.2066 in epoch 6
2024-08-15 17:32:30,809 : INFO : Current training batch loss: 0.1283 in epoch 6
2024-08-15 17:32:31,625 : INFO : Current training batch loss: 0.0434 in epoch 6
2024-08-15 17:32:32,442 : INFO : Current training batch loss: 0.0283 in epoch 6
2024-08-15 17:32:32,796 : INFO : Epoch finished, average loss over training batches: 0.1184
2024-08-15 17:32:32,796 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:32,796 : INFO : Training metrics:
2024-08-15 17:32:32,796 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:32,803 : INFO : Accuracy: 0.9726
2024-08-15 17:32:32,803 : INFO : Precision score for label_class 0: 0.9244
2024-08-15 17:32:32,803 : INFO : Precision score for label_class 1: 0.9831
2024-08-15 17:32:32,803 : INFO : Precision score for label_class 2: 0.9730
2024-08-15 17:32:32,803 : INFO : Recall score for label_class 0: 0.9621
2024-08-15 17:32:32,803 : INFO : Recall score for label_class 1: 0.9831
2024-08-15 17:32:32,803 : INFO : Recall score for label_class 2: 0.9549
2024-08-15 17:32:32,803 : INFO : Average F1 score: 0.9633
2024-08-15 17:32:33,272 : INFO : Average loss over validation batches: 0.4552
2024-08-15 17:32:33,272 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:33,272 : INFO : Validation metrics:
2024-08-15 17:32:33,273 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:33,276 : INFO : Accuracy: 0.8593
2024-08-15 17:32:33,276 : INFO : Precision score for label_class 0: 0.7349
2024-08-15 17:32:33,276 : INFO : Precision score for label_class 1: 0.8716
2024-08-15 17:32:33,276 : INFO : Precision score for label_class 2: 0.8910
2024-08-15 17:32:33,276 : INFO : Recall score for label_class 0: 0.8592
2024-08-15 17:32:33,276 : INFO : Recall score for label_class 1: 0.9268
2024-08-15 17:32:33,276 : INFO : Recall score for label_class 2: 0.7165
2024-08-15 17:32:33,276 : INFO : Average F1 score: 0.8283
2024-08-15 17:32:33,276 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:32:33,276 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:32:33,311 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:32:33,806 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:33,806 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:32:33,806 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:33,810 : INFO : Accuracy: 0.8696
2024-08-15 17:32:33,810 : INFO : Precision score for label_class 0: 0.7808
2024-08-15 17:32:33,810 : INFO : Precision score for label_class 1: 0.8719
2024-08-15 17:32:33,810 : INFO : Precision score for label_class 2: 0.9045
2024-08-15 17:32:33,810 : INFO : Recall score for label_class 0: 0.8028
2024-08-15 17:32:33,810 : INFO : Recall score for label_class 1: 0.9463
2024-08-15 17:32:33,810 : INFO : Recall score for label_class 2: 0.7320
2024-08-15 17:32:33,810 : INFO : Average F1 score: 0.8361
2024-08-15 17:32:33,810 : INFO : Determined score from best model, ending training.
2024-08-15 17:32:33,811 : INFO : Split 2 is finished, the score is: 0.8361
2024-08-15 17:32:33,811 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:33,811 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:33,811 : INFO : Starting training for split 3
2024-08-15 17:32:33,825 : INFO : Starting to tokenize the sequences.
2024-08-15 17:32:33,831 : INFO : Tokenization is finished.
2024-08-15 17:32:33,848 : INFO : Starting to tokenize the sequences.
2024-08-15 17:32:33,853 : INFO : Tokenization is finished.
2024-08-15 17:32:33,858 : INFO : Counting occurences of labels...
2024-08-15 17:32:33,859 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1611,  759]))
2024-08-15 17:32:33,860 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 400, 189]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:32:33,904 : INFO : Starting epoch 1
2024-08-15 17:32:33,955 : INFO : Current training batch loss: 1.0779 in epoch 1
2024-08-15 17:32:34,786 : INFO : Current training batch loss: 0.9993 in epoch 1
2024-08-15 17:32:35,603 : INFO : Current training batch loss: 0.8041 in epoch 1
2024-08-15 17:32:36,421 : INFO : Current training batch loss: 0.7239 in epoch 1
2024-08-15 17:32:37,240 : INFO : Current training batch loss: 0.7411 in epoch 1
2024-08-15 17:32:37,392 : INFO : Epoch finished, average loss over training batches: 0.8378
2024-08-15 17:32:37,392 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:37,392 : INFO : Training metrics:
2024-08-15 17:32:37,393 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:37,396 : INFO : Accuracy: 0.6668
2024-08-15 17:32:37,396 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:32:37,396 : INFO : Precision score for label_class 1: 0.6892
2024-08-15 17:32:37,396 : INFO : Precision score for label_class 2: 0.5505
2024-08-15 17:32:37,396 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:32:37,396 : INFO : Recall score for label_class 1: 0.9677
2024-08-15 17:32:37,396 : INFO : Recall score for label_class 2: 0.3162
2024-08-15 17:32:37,396 : INFO : Average F1 score: 0.4022
2024-08-15 17:32:37,863 : INFO : Average loss over validation batches: 0.6208
2024-08-15 17:32:37,863 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:37,863 : INFO : Validation metrics:
2024-08-15 17:32:37,863 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:37,865 : INFO : Accuracy: 0.7615
2024-08-15 17:32:37,865 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:32:37,865 : INFO : Precision score for label_class 1: 0.8816
2024-08-15 17:32:37,865 : INFO : Precision score for label_class 2: 0.5709
2024-08-15 17:32:37,865 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:32:37,865 : INFO : Recall score for label_class 1: 0.9125
2024-08-15 17:32:37,865 : INFO : Recall score for label_class 2: 0.7884
2024-08-15 17:32:37,865 : INFO : Average F1 score: 0.5197
2024-08-15 17:32:37,865 : INFO : Validation metric decreased (inf --> 0.620796).  Saving model ...
2024-08-15 17:32:37,977 : INFO : Starting epoch 2
2024-08-15 17:32:38,633 : INFO : Current training batch loss: 0.6010 in epoch 2
2024-08-15 17:32:39,451 : INFO : Current training batch loss: 0.5340 in epoch 2
2024-08-15 17:32:40,269 : INFO : Current training batch loss: 0.4059 in epoch 2
2024-08-15 17:32:41,099 : INFO : Current training batch loss: 0.3917 in epoch 2
2024-08-15 17:32:41,454 : INFO : Epoch finished, average loss over training batches: 0.5160
2024-08-15 17:32:41,454 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:41,455 : INFO : Training metrics:
2024-08-15 17:32:41,455 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:41,458 : INFO : Accuracy: 0.8176
2024-08-15 17:32:41,458 : INFO : Precision score for label_class 0: 0.7939
2024-08-15 17:32:41,458 : INFO : Precision score for label_class 1: 0.8694
2024-08-15 17:32:41,458 : INFO : Precision score for label_class 2: 0.7111
2024-08-15 17:32:41,458 : INFO : Recall score for label_class 0: 0.3994
2024-08-15 17:32:41,458 : INFO : Recall score for label_class 1: 0.9336
2024-08-15 17:32:41,458 : INFO : Recall score for label_class 2: 0.7523
2024-08-15 17:32:41,458 : INFO : Average F1 score: 0.7210
2024-08-15 17:32:41,923 : INFO : Average loss over validation batches: 0.4068
2024-08-15 17:32:41,923 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:41,923 : INFO : Validation metrics:
2024-08-15 17:32:41,924 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:41,927 : INFO : Accuracy: 0.8667
2024-08-15 17:32:41,927 : INFO : Precision score for label_class 0: 0.7717
2024-08-15 17:32:41,927 : INFO : Precision score for label_class 1: 0.8990
2024-08-15 17:32:41,927 : INFO : Precision score for label_class 2: 0.8383
2024-08-15 17:32:41,927 : INFO : Recall score for label_class 0: 0.8256
2024-08-15 17:32:41,927 : INFO : Recall score for label_class 1: 0.9350
2024-08-15 17:32:41,927 : INFO : Recall score for label_class 2: 0.7407
2024-08-15 17:32:41,927 : INFO : Average F1 score: 0.8336
2024-08-15 17:32:41,927 : INFO : Validation metric decreased (0.620796 --> 0.406775).  Saving model ...
2024-08-15 17:32:42,029 : INFO : Starting epoch 3
2024-08-15 17:32:42,490 : INFO : Current training batch loss: 0.2988 in epoch 3
2024-08-15 17:32:43,323 : INFO : Current training batch loss: 0.3610 in epoch 3
2024-08-15 17:32:44,141 : INFO : Current training batch loss: 0.2759 in epoch 3
2024-08-15 17:32:44,979 : INFO : Current training batch loss: 0.1824 in epoch 3
2024-08-15 17:32:45,536 : INFO : Epoch finished, average loss over training batches: 0.3010
2024-08-15 17:32:45,536 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:45,536 : INFO : Training metrics:
2024-08-15 17:32:45,536 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:45,543 : INFO : Accuracy: 0.9044
2024-08-15 17:32:45,543 : INFO : Precision score for label_class 0: 0.8129
2024-08-15 17:32:45,543 : INFO : Precision score for label_class 1: 0.9346
2024-08-15 17:32:45,543 : INFO : Precision score for label_class 2: 0.8801
2024-08-15 17:32:45,543 : INFO : Recall score for label_class 0: 0.8476
2024-08-15 17:32:45,543 : INFO : Recall score for label_class 1: 0.9410
2024-08-15 17:32:45,543 : INFO : Recall score for label_class 2: 0.8511
2024-08-15 17:32:45,543 : INFO : Average F1 score: 0.8777
2024-08-15 17:32:46,009 : INFO : Average loss over validation batches: 0.3675
2024-08-15 17:32:46,009 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:46,009 : INFO : Validation metrics:
2024-08-15 17:32:46,009 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:46,012 : INFO : Accuracy: 0.8741
2024-08-15 17:32:46,012 : INFO : Precision score for label_class 0: 0.7857
2024-08-15 17:32:46,012 : INFO : Precision score for label_class 1: 0.9152
2024-08-15 17:32:46,012 : INFO : Precision score for label_class 2: 0.8295
2024-08-15 17:32:46,012 : INFO : Recall score for label_class 0: 0.8953
2024-08-15 17:32:46,012 : INFO : Recall score for label_class 1: 0.9175
2024-08-15 17:32:46,012 : INFO : Recall score for label_class 2: 0.7725
2024-08-15 17:32:46,012 : INFO : Average F1 score: 0.8511
2024-08-15 17:32:46,012 : INFO : Validation metric decreased (0.406775 --> 0.367512).  Saving model ...
2024-08-15 17:32:46,116 : INFO : Starting epoch 4
2024-08-15 17:32:46,373 : INFO : Current training batch loss: 0.3969 in epoch 4
2024-08-15 17:32:47,200 : INFO : Current training batch loss: 0.2366 in epoch 4
2024-08-15 17:32:48,035 : INFO : Current training batch loss: 0.2501 in epoch 4
2024-08-15 17:32:48,858 : INFO : Current training batch loss: 0.1667 in epoch 4
2024-08-15 17:32:49,617 : INFO : Epoch finished, average loss over training batches: 0.1959
2024-08-15 17:32:49,617 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:49,617 : INFO : Training metrics:
2024-08-15 17:32:49,617 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:49,624 : INFO : Accuracy: 0.9477
2024-08-15 17:32:49,624 : INFO : Precision score for label_class 0: 0.8732
2024-08-15 17:32:49,624 : INFO : Precision score for label_class 1: 0.9654
2024-08-15 17:32:49,624 : INFO : Precision score for label_class 2: 0.9441
2024-08-15 17:32:49,624 : INFO : Recall score for label_class 0: 0.9238
2024-08-15 17:32:49,624 : INFO : Recall score for label_class 1: 0.9696
2024-08-15 17:32:49,624 : INFO : Recall score for label_class 2: 0.9117
2024-08-15 17:32:49,624 : INFO : Average F1 score: 0.9310
2024-08-15 17:32:50,092 : INFO : Average loss over validation batches: 0.3884
2024-08-15 17:32:50,092 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:50,093 : INFO : Validation metrics:
2024-08-15 17:32:50,093 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:50,095 : INFO : Accuracy: 0.8533
2024-08-15 17:32:50,095 : INFO : Precision score for label_class 0: 0.7500
2024-08-15 17:32:50,095 : INFO : Precision score for label_class 1: 0.9412
2024-08-15 17:32:50,095 : INFO : Precision score for label_class 2: 0.7570
2024-08-15 17:32:50,095 : INFO : Recall score for label_class 0: 0.9070
2024-08-15 17:32:50,095 : INFO : Recall score for label_class 1: 0.8400
2024-08-15 17:32:50,095 : INFO : Recall score for label_class 2: 0.8571
2024-08-15 17:32:50,095 : INFO : Average F1 score: 0.8376
2024-08-15 17:32:50,095 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:32:50,095 : INFO : Starting epoch 5
2024-08-15 17:32:50,146 : INFO : Current training batch loss: 0.1324 in epoch 5
2024-08-15 17:32:50,964 : INFO : Current training batch loss: 0.3140 in epoch 5
2024-08-15 17:32:51,871 : INFO : Current training batch loss: 0.0586 in epoch 5
2024-08-15 17:32:52,696 : INFO : Current training batch loss: 0.1270 in epoch 5
2024-08-15 17:32:53,538 : INFO : Current training batch loss: 0.1797 in epoch 5
2024-08-15 17:32:53,695 : INFO : Epoch finished, average loss over training batches: 0.1372
2024-08-15 17:32:53,695 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:53,695 : INFO : Training metrics:
2024-08-15 17:32:53,695 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:53,702 : INFO : Accuracy: 0.9678
2024-08-15 17:32:53,702 : INFO : Precision score for label_class 0: 0.8895
2024-08-15 17:32:53,702 : INFO : Precision score for label_class 1: 0.9795
2024-08-15 17:32:53,702 : INFO : Precision score for label_class 2: 0.9795
2024-08-15 17:32:53,702 : INFO : Recall score for label_class 0: 0.9573
2024-08-15 17:32:53,702 : INFO : Recall score for label_class 1: 0.9808
2024-08-15 17:32:53,702 : INFO : Recall score for label_class 2: 0.9447
2024-08-15 17:32:53,702 : INFO : Average F1 score: 0.9547
2024-08-15 17:32:54,171 : INFO : Average loss over validation batches: 0.4918
2024-08-15 17:32:54,171 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:54,171 : INFO : Validation metrics:
2024-08-15 17:32:54,171 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:54,173 : INFO : Accuracy: 0.8207
2024-08-15 17:32:54,173 : INFO : Precision score for label_class 0: 0.7157
2024-08-15 17:32:54,173 : INFO : Precision score for label_class 1: 0.9543
2024-08-15 17:32:54,173 : INFO : Precision score for label_class 2: 0.6857
2024-08-15 17:32:54,173 : INFO : Recall score for label_class 0: 0.8488
2024-08-15 17:32:54,173 : INFO : Recall score for label_class 1: 0.7825
2024-08-15 17:32:54,173 : INFO : Recall score for label_class 2: 0.8889
2024-08-15 17:32:54,173 : INFO : Average F1 score: 0.8036
2024-08-15 17:32:54,173 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:32:54,173 : INFO : Starting epoch 6
2024-08-15 17:32:54,849 : INFO : Current training batch loss: 0.2272 in epoch 6
2024-08-15 17:32:55,687 : INFO : Current training batch loss: 0.1368 in epoch 6
2024-08-15 17:32:56,529 : INFO : Current training batch loss: 0.0359 in epoch 6
2024-08-15 17:32:57,349 : INFO : Current training batch loss: 0.0668 in epoch 6
2024-08-15 17:32:57,701 : INFO : Epoch finished, average loss over training batches: 0.1130
2024-08-15 17:32:57,701 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:57,701 : INFO : Training metrics:
2024-08-15 17:32:57,701 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:57,705 : INFO : Accuracy: 0.9711
2024-08-15 17:32:57,705 : INFO : Precision score for label_class 0: 0.9060
2024-08-15 17:32:57,705 : INFO : Precision score for label_class 1: 0.9802
2024-08-15 17:32:57,705 : INFO : Precision score for label_class 2: 0.9822
2024-08-15 17:32:57,705 : INFO : Recall score for label_class 0: 0.9695
2024-08-15 17:32:57,705 : INFO : Recall score for label_class 1: 0.9845
2024-08-15 17:32:57,705 : INFO : Recall score for label_class 2: 0.9433
2024-08-15 17:32:57,705 : INFO : Average F1 score: 0.9605
2024-08-15 17:32:58,171 : INFO : Average loss over validation batches: 0.5404
2024-08-15 17:32:58,171 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:58,171 : INFO : Validation metrics:
2024-08-15 17:32:58,171 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:58,174 : INFO : Accuracy: 0.8074
2024-08-15 17:32:58,174 : INFO : Precision score for label_class 0: 0.7473
2024-08-15 17:32:58,174 : INFO : Precision score for label_class 1: 0.9505
2024-08-15 17:32:58,174 : INFO : Precision score for label_class 2: 0.6513
2024-08-15 17:32:58,174 : INFO : Recall score for label_class 0: 0.7907
2024-08-15 17:32:58,174 : INFO : Recall score for label_class 1: 0.7675
2024-08-15 17:32:58,174 : INFO : Recall score for label_class 2: 0.8995
2024-08-15 17:32:58,174 : INFO : Average F1 score: 0.7911
2024-08-15 17:32:58,174 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:32:58,174 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:32:58,212 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:32:58,710 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:58,710 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:32:58,710 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:58,713 : INFO : Accuracy: 0.8741
2024-08-15 17:32:58,713 : INFO : Precision score for label_class 0: 0.7857
2024-08-15 17:32:58,713 : INFO : Precision score for label_class 1: 0.9152
2024-08-15 17:32:58,713 : INFO : Precision score for label_class 2: 0.8295
2024-08-15 17:32:58,713 : INFO : Recall score for label_class 0: 0.8953
2024-08-15 17:32:58,713 : INFO : Recall score for label_class 1: 0.9175
2024-08-15 17:32:58,713 : INFO : Recall score for label_class 2: 0.7725
2024-08-15 17:32:58,713 : INFO : Average F1 score: 0.8511
2024-08-15 17:32:58,713 : INFO : Determined score from best model, ending training.
2024-08-15 17:32:58,714 : INFO : Split 3 is finished, the score is: 0.8511
2024-08-15 17:32:58,714 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:58,720 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:32:58,720 : INFO : Starting training for split 4
2024-08-15 17:32:58,734 : INFO : Starting to tokenize the sequences.
2024-08-15 17:32:58,740 : INFO : Tokenization is finished.
2024-08-15 17:32:58,756 : INFO : Starting to tokenize the sequences.
2024-08-15 17:32:58,761 : INFO : Tokenization is finished.
2024-08-15 17:32:58,766 : INFO : Counting occurences of labels...
2024-08-15 17:32:58,767 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 327, 1621,  751]))
2024-08-15 17:32:58,767 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 87, 390, 197]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:32:58,817 : INFO : Starting epoch 1
2024-08-15 17:32:58,869 : INFO : Current training batch loss: 1.0907 in epoch 1
2024-08-15 17:32:59,683 : INFO : Current training batch loss: 0.9988 in epoch 1
2024-08-15 17:33:00,498 : INFO : Current training batch loss: 0.8058 in epoch 1
2024-08-15 17:33:01,313 : INFO : Current training batch loss: 0.6750 in epoch 1
2024-08-15 17:33:02,129 : INFO : Current training batch loss: 0.6874 in epoch 1
2024-08-15 17:33:02,279 : INFO : Epoch finished, average loss over training batches: 0.8437
2024-08-15 17:33:02,279 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:02,280 : INFO : Training metrics:
2024-08-15 17:33:02,280 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:02,287 : INFO : Accuracy: 0.6465
2024-08-15 17:33:02,287 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:33:02,287 : INFO : Precision score for label_class 1: 0.6941
2024-08-15 17:33:02,287 : INFO : Precision score for label_class 2: 0.4743
2024-08-15 17:33:02,287 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:33:02,287 : INFO : Recall score for label_class 1: 0.9056
2024-08-15 17:33:02,287 : INFO : Recall score for label_class 2: 0.3688
2024-08-15 17:33:02,287 : INFO : Average F1 score: 0.4003
2024-08-15 17:33:02,753 : INFO : Average loss over validation batches: 0.6606
2024-08-15 17:33:02,753 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:02,753 : INFO : Validation metrics:
2024-08-15 17:33:02,753 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:02,756 : INFO : Accuracy: 0.7522
2024-08-15 17:33:02,757 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:33:02,757 : INFO : Precision score for label_class 1: 0.8372
2024-08-15 17:33:02,757 : INFO : Precision score for label_class 2: 0.6025
2024-08-15 17:33:02,757 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:33:02,757 : INFO : Recall score for label_class 1: 0.9231
2024-08-15 17:33:02,757 : INFO : Recall score for label_class 2: 0.7462
2024-08-15 17:33:02,757 : INFO : Average F1 score: 0.5149
2024-08-15 17:33:02,757 : INFO : Validation metric decreased (inf --> 0.660586).  Saving model ...
2024-08-15 17:33:02,863 : INFO : Starting epoch 2
2024-08-15 17:33:03,517 : INFO : Current training batch loss: 0.6591 in epoch 2
2024-08-15 17:33:04,331 : INFO : Current training batch loss: 0.4829 in epoch 2
2024-08-15 17:33:05,145 : INFO : Current training batch loss: 0.3967 in epoch 2
2024-08-15 17:33:05,960 : INFO : Current training batch loss: 0.4003 in epoch 2
2024-08-15 17:33:06,312 : INFO : Epoch finished, average loss over training batches: 0.5209
2024-08-15 17:33:06,312 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:06,312 : INFO : Training metrics:
2024-08-15 17:33:06,312 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:06,319 : INFO : Accuracy: 0.8233
2024-08-15 17:33:06,320 : INFO : Precision score for label_class 0: 0.8188
2024-08-15 17:33:06,320 : INFO : Precision score for label_class 1: 0.8691
2024-08-15 17:33:06,320 : INFO : Precision score for label_class 2: 0.7210
2024-08-15 17:33:06,320 : INFO : Recall score for label_class 0: 0.3731
2024-08-15 17:33:06,320 : INFO : Recall score for label_class 1: 0.9463
2024-08-15 17:33:06,320 : INFO : Recall score for label_class 2: 0.7537
2024-08-15 17:33:06,320 : INFO : Average F1 score: 0.7186
2024-08-15 17:33:06,787 : INFO : Average loss over validation batches: 0.4393
2024-08-15 17:33:06,787 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:06,787 : INFO : Validation metrics:
2024-08-15 17:33:06,787 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:06,791 : INFO : Accuracy: 0.8531
2024-08-15 17:33:06,791 : INFO : Precision score for label_class 0: 0.7113
2024-08-15 17:33:06,791 : INFO : Precision score for label_class 1: 0.8654
2024-08-15 17:33:06,791 : INFO : Precision score for label_class 2: 0.9110
2024-08-15 17:33:06,791 : INFO : Recall score for label_class 0: 0.7931
2024-08-15 17:33:06,791 : INFO : Recall score for label_class 1: 0.9564
2024-08-15 17:33:06,791 : INFO : Recall score for label_class 2: 0.6751
2024-08-15 17:33:06,791 : INFO : Average F1 score: 0.8114
2024-08-15 17:33:06,791 : INFO : Validation metric decreased (0.660586 --> 0.439331).  Saving model ...
2024-08-15 17:33:06,889 : INFO : Starting epoch 3
2024-08-15 17:33:07,342 : INFO : Current training batch loss: 0.3100 in epoch 3
2024-08-15 17:33:08,157 : INFO : Current training batch loss: 0.2936 in epoch 3
2024-08-15 17:33:08,971 : INFO : Current training batch loss: 0.3279 in epoch 3
2024-08-15 17:33:09,786 : INFO : Current training batch loss: 0.1249 in epoch 3
2024-08-15 17:33:10,339 : INFO : Epoch finished, average loss over training batches: 0.3073
2024-08-15 17:33:10,339 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:10,339 : INFO : Training metrics:
2024-08-15 17:33:10,339 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:10,344 : INFO : Accuracy: 0.9059
2024-08-15 17:33:10,344 : INFO : Precision score for label_class 0: 0.8171
2024-08-15 17:33:10,344 : INFO : Precision score for label_class 1: 0.9365
2024-08-15 17:33:10,344 : INFO : Precision score for label_class 2: 0.8783
2024-08-15 17:33:10,345 : INFO : Recall score for label_class 0: 0.8471
2024-08-15 17:33:10,345 : INFO : Recall score for label_class 1: 0.9457
2024-08-15 17:33:10,345 : INFO : Recall score for label_class 2: 0.8455
2024-08-15 17:33:10,345 : INFO : Average F1 score: 0.8782
2024-08-15 17:33:10,813 : INFO : Average loss over validation batches: 0.3742
2024-08-15 17:33:10,814 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:10,814 : INFO : Validation metrics:
2024-08-15 17:33:10,814 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:10,817 : INFO : Accuracy: 0.8680
2024-08-15 17:33:10,817 : INFO : Precision score for label_class 0: 0.8293
2024-08-15 17:33:10,817 : INFO : Precision score for label_class 1: 0.9121
2024-08-15 17:33:10,817 : INFO : Precision score for label_class 2: 0.8000
2024-08-15 17:33:10,817 : INFO : Recall score for label_class 0: 0.7816
2024-08-15 17:33:10,817 : INFO : Recall score for label_class 1: 0.9051
2024-08-15 17:33:10,817 : INFO : Recall score for label_class 2: 0.8325
2024-08-15 17:33:10,817 : INFO : Average F1 score: 0.8431
2024-08-15 17:33:10,817 : INFO : Validation metric decreased (0.439331 --> 0.374213).  Saving model ...
2024-08-15 17:33:10,916 : INFO : Starting epoch 4
2024-08-15 17:33:11,168 : INFO : Current training batch loss: 0.4294 in epoch 4
2024-08-15 17:33:11,998 : INFO : Current training batch loss: 0.3053 in epoch 4
2024-08-15 17:33:12,821 : INFO : Current training batch loss: 0.1951 in epoch 4
2024-08-15 17:33:13,639 : INFO : Current training batch loss: 0.1679 in epoch 4
2024-08-15 17:33:14,397 : INFO : Epoch finished, average loss over training batches: 0.1922
2024-08-15 17:33:14,397 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:14,397 : INFO : Training metrics:
2024-08-15 17:33:14,397 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:14,401 : INFO : Accuracy: 0.9466
2024-08-15 17:33:14,401 : INFO : Precision score for label_class 0: 0.8813
2024-08-15 17:33:14,401 : INFO : Precision score for label_class 1: 0.9668
2024-08-15 17:33:14,401 : INFO : Precision score for label_class 2: 0.9322
2024-08-15 17:33:14,401 : INFO : Recall score for label_class 0: 0.9083
2024-08-15 17:33:14,401 : INFO : Recall score for label_class 1: 0.9692
2024-08-15 17:33:14,401 : INFO : Recall score for label_class 2: 0.9148
2024-08-15 17:33:14,401 : INFO : Average F1 score: 0.9286
2024-08-15 17:33:14,866 : INFO : Average loss over validation batches: 0.3762
2024-08-15 17:33:14,866 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:14,866 : INFO : Validation metrics:
2024-08-15 17:33:14,866 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:14,869 : INFO : Accuracy: 0.8650
2024-08-15 17:33:14,869 : INFO : Precision score for label_class 0: 0.8000
2024-08-15 17:33:14,869 : INFO : Precision score for label_class 1: 0.9342
2024-08-15 17:33:14,869 : INFO : Precision score for label_class 2: 0.7763
2024-08-15 17:33:14,869 : INFO : Recall score for label_class 0: 0.8276
2024-08-15 17:33:14,870 : INFO : Recall score for label_class 1: 0.8744
2024-08-15 17:33:14,870 : INFO : Recall score for label_class 2: 0.8629
2024-08-15 17:33:14,870 : INFO : Average F1 score: 0.8447
2024-08-15 17:33:14,870 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:33:14,870 : INFO : Starting epoch 5
2024-08-15 17:33:14,920 : INFO : Current training batch loss: 0.1191 in epoch 5
2024-08-15 17:33:15,737 : INFO : Current training batch loss: 0.2537 in epoch 5
2024-08-15 17:33:16,555 : INFO : Current training batch loss: 0.0542 in epoch 5
2024-08-15 17:33:17,375 : INFO : Current training batch loss: 0.1151 in epoch 5
2024-08-15 17:33:18,193 : INFO : Current training batch loss: 0.3006 in epoch 5
2024-08-15 17:33:18,345 : INFO : Epoch finished, average loss over training batches: 0.1281
2024-08-15 17:33:18,345 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:18,345 : INFO : Training metrics:
2024-08-15 17:33:18,345 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:18,349 : INFO : Accuracy: 0.9685
2024-08-15 17:33:18,349 : INFO : Precision score for label_class 0: 0.9174
2024-08-15 17:33:18,349 : INFO : Precision score for label_class 1: 0.9797
2024-08-15 17:33:18,349 : INFO : Precision score for label_class 2: 0.9674
2024-08-15 17:33:18,349 : INFO : Recall score for label_class 0: 0.9511
2024-08-15 17:33:18,349 : INFO : Recall score for label_class 1: 0.9809
2024-08-15 17:33:18,349 : INFO : Recall score for label_class 2: 0.9494
2024-08-15 17:33:18,349 : INFO : Average F1 score: 0.9575
2024-08-15 17:33:18,816 : INFO : Average loss over validation batches: 0.3926
2024-08-15 17:33:18,816 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:18,816 : INFO : Validation metrics:
2024-08-15 17:33:18,816 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:18,819 : INFO : Accuracy: 0.8635
2024-08-15 17:33:18,819 : INFO : Precision score for label_class 0: 0.7423
2024-08-15 17:33:18,819 : INFO : Precision score for label_class 1: 0.9297
2024-08-15 17:33:18,819 : INFO : Precision score for label_class 2: 0.8019
2024-08-15 17:33:18,819 : INFO : Recall score for label_class 0: 0.8276
2024-08-15 17:33:18,819 : INFO : Recall score for label_class 1: 0.8821
2024-08-15 17:33:18,819 : INFO : Recall score for label_class 2: 0.8426
2024-08-15 17:33:18,819 : INFO : Average F1 score: 0.8366
2024-08-15 17:33:18,819 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:33:18,819 : INFO : Starting epoch 6
2024-08-15 17:33:19,476 : INFO : Current training batch loss: 0.1128 in epoch 6
2024-08-15 17:33:20,293 : INFO : Current training batch loss: 0.0506 in epoch 6
2024-08-15 17:33:21,112 : INFO : Current training batch loss: 0.0448 in epoch 6
2024-08-15 17:33:21,934 : INFO : Current training batch loss: 0.0286 in epoch 6
2024-08-15 17:33:22,289 : INFO : Epoch finished, average loss over training batches: 0.0899
2024-08-15 17:33:22,289 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:22,289 : INFO : Training metrics:
2024-08-15 17:33:22,289 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:22,296 : INFO : Accuracy: 0.9793
2024-08-15 17:33:22,296 : INFO : Precision score for label_class 0: 0.9399
2024-08-15 17:33:22,296 : INFO : Precision score for label_class 1: 0.9865
2024-08-15 17:33:22,296 : INFO : Precision score for label_class 2: 0.9811
2024-08-15 17:33:22,296 : INFO : Recall score for label_class 0: 0.9572
2024-08-15 17:33:22,296 : INFO : Recall score for label_class 1: 0.9895
2024-08-15 17:33:22,296 : INFO : Recall score for label_class 2: 0.9667
2024-08-15 17:33:22,296 : INFO : Average F1 score: 0.9701
2024-08-15 17:33:22,761 : INFO : Average loss over validation batches: 0.4506
2024-08-15 17:33:22,762 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:22,762 : INFO : Validation metrics:
2024-08-15 17:33:22,762 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:22,765 : INFO : Accuracy: 0.8650
2024-08-15 17:33:22,765 : INFO : Precision score for label_class 0: 0.7717
2024-08-15 17:33:22,765 : INFO : Precision score for label_class 1: 0.8682
2024-08-15 17:33:22,765 : INFO : Precision score for label_class 2: 0.9108
2024-08-15 17:33:22,765 : INFO : Recall score for label_class 0: 0.8161
2024-08-15 17:33:22,765 : INFO : Recall score for label_class 1: 0.9462
2024-08-15 17:33:22,765 : INFO : Recall score for label_class 2: 0.7259
2024-08-15 17:33:22,765 : INFO : Average F1 score: 0.8356
2024-08-15 17:33:22,765 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:33:22,765 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:33:22,804 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:33:23,306 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:23,307 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:33:23,307 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:23,310 : INFO : Accuracy: 0.8680
2024-08-15 17:33:23,310 : INFO : Precision score for label_class 0: 0.8293
2024-08-15 17:33:23,310 : INFO : Precision score for label_class 1: 0.9121
2024-08-15 17:33:23,310 : INFO : Precision score for label_class 2: 0.8000
2024-08-15 17:33:23,310 : INFO : Recall score for label_class 0: 0.7816
2024-08-15 17:33:23,310 : INFO : Recall score for label_class 1: 0.9051
2024-08-15 17:33:23,310 : INFO : Recall score for label_class 2: 0.8325
2024-08-15 17:33:23,310 : INFO : Average F1 score: 0.8431
2024-08-15 17:33:23,310 : INFO : Determined score from best model, ending training.
2024-08-15 17:33:23,317 : INFO : Split 4 is finished, the score is: 0.8431
2024-08-15 17:33:23,317 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:23,317 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:23,317 : INFO : Starting training for split 5
2024-08-15 17:33:23,330 : INFO : Starting to tokenize the sequences.
2024-08-15 17:33:23,335 : INFO : Tokenization is finished.
2024-08-15 17:33:23,352 : INFO : Starting to tokenize the sequences.
2024-08-15 17:33:23,357 : INFO : Tokenization is finished.
2024-08-15 17:33:23,362 : INFO : Counting occurences of labels...
2024-08-15 17:33:23,363 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 330, 1615,  754]))
2024-08-15 17:33:23,364 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 84, 396, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:33:23,412 : INFO : Starting epoch 1
2024-08-15 17:33:23,463 : INFO : Current training batch loss: 1.0959 in epoch 1
2024-08-15 17:33:24,285 : INFO : Current training batch loss: 0.9968 in epoch 1
2024-08-15 17:33:25,103 : INFO : Current training batch loss: 0.7967 in epoch 1
2024-08-15 17:33:25,920 : INFO : Current training batch loss: 0.7146 in epoch 1
2024-08-15 17:33:26,738 : INFO : Current training batch loss: 0.7285 in epoch 1
2024-08-15 17:33:26,891 : INFO : Epoch finished, average loss over training batches: 0.8426
2024-08-15 17:33:26,891 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:26,891 : INFO : Training metrics:
2024-08-15 17:33:26,891 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:26,902 : INFO : Accuracy: 0.6599
2024-08-15 17:33:26,902 : INFO : Precision score for label_class 0: 0.6667
2024-08-15 17:33:26,902 : INFO : Precision score for label_class 1: 0.6872
2024-08-15 17:33:26,902 : INFO : Precision score for label_class 2: 0.5290
2024-08-15 17:33:26,902 : INFO : Recall score for label_class 0: 0.0121
2024-08-15 17:33:26,902 : INFO : Recall score for label_class 1: 0.9480
2024-08-15 17:33:26,902 : INFO : Recall score for label_class 2: 0.3263
2024-08-15 17:33:26,902 : INFO : Average F1 score: 0.4081
2024-08-15 17:33:27,369 : INFO : Average loss over validation batches: 0.6265
2024-08-15 17:33:27,369 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:27,369 : INFO : Validation metrics:
2024-08-15 17:33:27,369 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:27,372 : INFO : Accuracy: 0.7211
2024-08-15 17:33:27,373 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:33:27,373 : INFO : Precision score for label_class 1: 0.7987
2024-08-15 17:33:27,373 : INFO : Precision score for label_class 2: 0.5459
2024-08-15 17:33:27,373 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:33:27,373 : INFO : Recall score for label_class 1: 0.9419
2024-08-15 17:33:27,373 : INFO : Recall score for label_class 2: 0.5825
2024-08-15 17:33:27,373 : INFO : Average F1 score: 0.4760
2024-08-15 17:33:27,373 : INFO : Validation metric decreased (inf --> 0.626530).  Saving model ...
2024-08-15 17:33:27,471 : INFO : Starting epoch 2
2024-08-15 17:33:28,130 : INFO : Current training batch loss: 0.5830 in epoch 2
2024-08-15 17:33:28,949 : INFO : Current training batch loss: 0.4507 in epoch 2
2024-08-15 17:33:29,772 : INFO : Current training batch loss: 0.3104 in epoch 2
2024-08-15 17:33:30,604 : INFO : Current training batch loss: 0.4213 in epoch 2
2024-08-15 17:33:30,967 : INFO : Epoch finished, average loss over training batches: 0.4800
2024-08-15 17:33:30,968 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:30,968 : INFO : Training metrics:
2024-08-15 17:33:30,968 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:30,978 : INFO : Accuracy: 0.8436
2024-08-15 17:33:30,978 : INFO : Precision score for label_class 0: 0.8007
2024-08-15 17:33:30,978 : INFO : Precision score for label_class 1: 0.8641
2024-08-15 17:33:30,978 : INFO : Precision score for label_class 2: 0.8072
2024-08-15 17:33:30,978 : INFO : Recall score for label_class 0: 0.6697
2024-08-15 17:33:30,978 : INFO : Recall score for label_class 1: 0.9412
2024-08-15 17:33:30,978 : INFO : Recall score for label_class 2: 0.7109
2024-08-15 17:33:30,978 : INFO : Average F1 score: 0.7955
2024-08-15 17:33:31,445 : INFO : Average loss over validation batches: 0.4274
2024-08-15 17:33:31,445 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:31,445 : INFO : Validation metrics:
2024-08-15 17:33:31,445 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:31,449 : INFO : Accuracy: 0.8457
2024-08-15 17:33:31,449 : INFO : Precision score for label_class 0: 0.7945
2024-08-15 17:33:31,449 : INFO : Precision score for label_class 1: 0.8562
2024-08-15 17:33:31,449 : INFO : Precision score for label_class 2: 0.8405
2024-08-15 17:33:31,449 : INFO : Recall score for label_class 0: 0.6905
2024-08-15 17:33:31,449 : INFO : Recall score for label_class 1: 0.9470
2024-08-15 17:33:31,449 : INFO : Recall score for label_class 2: 0.7062
2024-08-15 17:33:31,449 : INFO : Average F1 score: 0.8019
2024-08-15 17:33:31,449 : INFO : Validation metric decreased (0.626530 --> 0.427409).  Saving model ...
2024-08-15 17:33:31,552 : INFO : Starting epoch 3
2024-08-15 17:33:32,009 : INFO : Current training batch loss: 0.2792 in epoch 3
2024-08-15 17:33:32,830 : INFO : Current training batch loss: 0.3655 in epoch 3
2024-08-15 17:33:33,653 : INFO : Current training batch loss: 0.4099 in epoch 3
2024-08-15 17:33:34,471 : INFO : Current training batch loss: 0.2138 in epoch 3
2024-08-15 17:33:35,028 : INFO : Epoch finished, average loss over training batches: 0.2894
2024-08-15 17:33:35,028 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:35,028 : INFO : Training metrics:
2024-08-15 17:33:35,028 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:35,038 : INFO : Accuracy: 0.9114
2024-08-15 17:33:35,038 : INFO : Precision score for label_class 0: 0.8580
2024-08-15 17:33:35,038 : INFO : Precision score for label_class 1: 0.9339
2024-08-15 17:33:35,038 : INFO : Precision score for label_class 2: 0.8857
2024-08-15 17:33:35,038 : INFO : Recall score for label_class 0: 0.8788
2024-08-15 17:33:35,038 : INFO : Recall score for label_class 1: 0.9455
2024-08-15 17:33:35,038 : INFO : Recall score for label_class 2: 0.8528
2024-08-15 17:33:35,038 : INFO : Average F1 score: 0.8923
2024-08-15 17:33:35,504 : INFO : Average loss over validation batches: 0.3983
2024-08-15 17:33:35,504 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:35,504 : INFO : Validation metrics:
2024-08-15 17:33:35,504 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:35,507 : INFO : Accuracy: 0.8576
2024-08-15 17:33:35,507 : INFO : Precision score for label_class 0: 0.8852
2024-08-15 17:33:35,507 : INFO : Precision score for label_class 1: 0.8810
2024-08-15 17:33:35,507 : INFO : Precision score for label_class 2: 0.7979
2024-08-15 17:33:35,507 : INFO : Recall score for label_class 0: 0.6429
2024-08-15 17:33:35,507 : INFO : Recall score for label_class 1: 0.9343
2024-08-15 17:33:35,507 : INFO : Recall score for label_class 2: 0.7938
2024-08-15 17:33:35,507 : INFO : Average F1 score: 0.8159
2024-08-15 17:33:35,508 : INFO : Validation metric decreased (0.427409 --> 0.398258).  Saving model ...
2024-08-15 17:33:35,611 : INFO : Starting epoch 4
2024-08-15 17:33:35,864 : INFO : Current training batch loss: 0.3390 in epoch 4
2024-08-15 17:33:36,681 : INFO : Current training batch loss: 0.2385 in epoch 4
2024-08-15 17:33:37,499 : INFO : Current training batch loss: 0.1832 in epoch 4
2024-08-15 17:33:38,317 : INFO : Current training batch loss: 0.1211 in epoch 4
2024-08-15 17:33:39,075 : INFO : Epoch finished, average loss over training batches: 0.1940
2024-08-15 17:33:39,075 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:39,075 : INFO : Training metrics:
2024-08-15 17:33:39,075 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:39,085 : INFO : Accuracy: 0.9452
2024-08-15 17:33:39,085 : INFO : Precision score for label_class 0: 0.8961
2024-08-15 17:33:39,085 : INFO : Precision score for label_class 1: 0.9641
2024-08-15 17:33:39,085 : INFO : Precision score for label_class 2: 0.9263
2024-08-15 17:33:39,085 : INFO : Recall score for label_class 0: 0.9152
2024-08-15 17:33:39,085 : INFO : Recall score for label_class 1: 0.9647
2024-08-15 17:33:39,085 : INFO : Recall score for label_class 2: 0.9164
2024-08-15 17:33:39,085 : INFO : Average F1 score: 0.9304
2024-08-15 17:33:39,551 : INFO : Average loss over validation batches: 0.4256
2024-08-15 17:33:39,552 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:39,552 : INFO : Validation metrics:
2024-08-15 17:33:39,552 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:39,555 : INFO : Accuracy: 0.8591
2024-08-15 17:33:39,555 : INFO : Precision score for label_class 0: 0.8243
2024-08-15 17:33:39,555 : INFO : Precision score for label_class 1: 0.8753
2024-08-15 17:33:39,555 : INFO : Precision score for label_class 2: 0.8343
2024-08-15 17:33:39,555 : INFO : Recall score for label_class 0: 0.7262
2024-08-15 17:33:39,555 : INFO : Recall score for label_class 1: 0.9394
2024-08-15 17:33:39,555 : INFO : Recall score for label_class 2: 0.7526
2024-08-15 17:33:39,555 : INFO : Average F1 score: 0.8232
2024-08-15 17:33:39,555 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:33:39,555 : INFO : Starting epoch 5
2024-08-15 17:33:39,606 : INFO : Current training batch loss: 0.2318 in epoch 5
2024-08-15 17:33:40,424 : INFO : Current training batch loss: 0.1269 in epoch 5
2024-08-15 17:33:41,241 : INFO : Current training batch loss: 0.0721 in epoch 5
2024-08-15 17:33:42,063 : INFO : Current training batch loss: 0.0845 in epoch 5
2024-08-15 17:33:42,882 : INFO : Current training batch loss: 0.0885 in epoch 5
2024-08-15 17:33:43,034 : INFO : Epoch finished, average loss over training batches: 0.1352
2024-08-15 17:33:43,034 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:43,034 : INFO : Training metrics:
2024-08-15 17:33:43,034 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:43,041 : INFO : Accuracy: 0.9648
2024-08-15 17:33:43,041 : INFO : Precision score for label_class 0: 0.9256
2024-08-15 17:33:43,041 : INFO : Precision score for label_class 1: 0.9795
2024-08-15 17:33:43,041 : INFO : Precision score for label_class 2: 0.9507
2024-08-15 17:33:43,041 : INFO : Recall score for label_class 0: 0.9424
2024-08-15 17:33:43,041 : INFO : Recall score for label_class 1: 0.9783
2024-08-15 17:33:43,041 : INFO : Recall score for label_class 2: 0.9456
2024-08-15 17:33:43,041 : INFO : Average F1 score: 0.9537
2024-08-15 17:33:43,509 : INFO : Average loss over validation batches: 0.4586
2024-08-15 17:33:43,509 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:43,509 : INFO : Validation metrics:
2024-08-15 17:33:43,509 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:43,513 : INFO : Accuracy: 0.8516
2024-08-15 17:33:43,513 : INFO : Precision score for label_class 0: 0.7100
2024-08-15 17:33:43,513 : INFO : Precision score for label_class 1: 0.9000
2024-08-15 17:33:43,513 : INFO : Precision score for label_class 2: 0.8261
2024-08-15 17:33:43,513 : INFO : Recall score for label_class 0: 0.8452
2024-08-15 17:33:43,513 : INFO : Recall score for label_class 1: 0.8864
2024-08-15 17:33:43,513 : INFO : Recall score for label_class 2: 0.7835
2024-08-15 17:33:43,513 : INFO : Average F1 score: 0.8230
2024-08-15 17:33:43,513 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:33:43,513 : INFO : Starting epoch 6
2024-08-15 17:33:44,169 : INFO : Current training batch loss: 0.1534 in epoch 6
2024-08-15 17:33:44,988 : INFO : Current training batch loss: 0.1375 in epoch 6
2024-08-15 17:33:45,806 : INFO : Current training batch loss: 0.0420 in epoch 6
2024-08-15 17:33:46,624 : INFO : Current training batch loss: 0.1117 in epoch 6
2024-08-15 17:33:46,979 : INFO : Epoch finished, average loss over training batches: 0.1012
2024-08-15 17:33:46,979 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:46,979 : INFO : Training metrics:
2024-08-15 17:33:46,979 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:46,986 : INFO : Accuracy: 0.9744
2024-08-15 17:33:46,986 : INFO : Precision score for label_class 0: 0.9265
2024-08-15 17:33:46,986 : INFO : Precision score for label_class 1: 0.9846
2024-08-15 17:33:46,986 : INFO : Precision score for label_class 2: 0.9743
2024-08-15 17:33:46,986 : INFO : Recall score for label_class 0: 0.9545
2024-08-15 17:33:46,986 : INFO : Recall score for label_class 1: 0.9876
2024-08-15 17:33:46,986 : INFO : Recall score for label_class 2: 0.9549
2024-08-15 17:33:46,986 : INFO : Average F1 score: 0.9636
2024-08-15 17:33:47,452 : INFO : Average loss over validation batches: 0.4416
2024-08-15 17:33:47,452 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:47,452 : INFO : Validation metrics:
2024-08-15 17:33:47,452 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:47,456 : INFO : Accuracy: 0.8531
2024-08-15 17:33:47,456 : INFO : Precision score for label_class 0: 0.7113
2024-08-15 17:33:47,456 : INFO : Precision score for label_class 1: 0.9220
2024-08-15 17:33:47,456 : INFO : Precision score for label_class 2: 0.7951
2024-08-15 17:33:47,456 : INFO : Recall score for label_class 0: 0.8214
2024-08-15 17:33:47,456 : INFO : Recall score for label_class 1: 0.8662
2024-08-15 17:33:47,456 : INFO : Recall score for label_class 2: 0.8402
2024-08-15 17:33:47,456 : INFO : Average F1 score: 0.8242
2024-08-15 17:33:47,456 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:33:47,456 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:33:47,490 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:33:47,989 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:47,990 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:33:47,990 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:47,993 : INFO : Accuracy: 0.8576
2024-08-15 17:33:47,993 : INFO : Precision score for label_class 0: 0.8852
2024-08-15 17:33:47,993 : INFO : Precision score for label_class 1: 0.8810
2024-08-15 17:33:47,993 : INFO : Precision score for label_class 2: 0.7979
2024-08-15 17:33:47,993 : INFO : Recall score for label_class 0: 0.6429
2024-08-15 17:33:47,993 : INFO : Recall score for label_class 1: 0.9343
2024-08-15 17:33:47,993 : INFO : Recall score for label_class 2: 0.7938
2024-08-15 17:33:47,993 : INFO : Average F1 score: 0.8159
2024-08-15 17:33:47,993 : INFO : Determined score from best model, ending training.
2024-08-15 17:33:47,994 : INFO : Split 5 is finished, the score is: 0.8159
2024-08-15 17:33:47,994 : INFO : ----------------------------------------------------------------------------------------------------
[I 2024-08-15 17:33:48,009] Trial 14 finished with value: 0.8399761073163672 and parameters: {'n_epochs': 10, 'learning_rate': 3.314814969945931e-05, 'classifier_dropout': 0.5146403576698599, 'warmup_step_fraction': 0.011531929363719808, 'use_gradient_clipping': False}. Best is trial 1 with value: 0.8513001269595835.
2024-08-15 17:33:48,017 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:48,017 : INFO : Starting training for split 1
2024-08-15 17:33:48,030 : INFO : Starting to tokenize the sequences.
2024-08-15 17:33:48,035 : INFO : Tokenization is finished.
2024-08-15 17:33:48,047 : INFO : Starting to tokenize the sequences.
2024-08-15 17:33:48,052 : INFO : Tokenization is finished.
2024-08-15 17:33:48,052 : INFO : Counting occurences of labels...
2024-08-15 17:33:48,053 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1596,  774]))
2024-08-15 17:33:48,053 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 415, 174]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:33:48,106 : INFO : Starting epoch 1
2024-08-15 17:33:48,157 : INFO : Current training batch loss: 1.1135 in epoch 1
2024-08-15 17:33:48,986 : INFO : Current training batch loss: 1.0573 in epoch 1
2024-08-15 17:33:49,818 : INFO : Current training batch loss: 1.0251 in epoch 1
2024-08-15 17:33:50,644 : INFO : Current training batch loss: 0.9028 in epoch 1
2024-08-15 17:33:51,485 : INFO : Current training batch loss: 0.8937 in epoch 1
2024-08-15 17:33:51,641 : INFO : Epoch finished, average loss over training batches: 0.9777
2024-08-15 17:33:51,642 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:51,642 : INFO : Training metrics:
2024-08-15 17:33:51,642 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:51,650 : INFO : Accuracy: 0.5471
2024-08-15 17:33:51,650 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:33:51,650 : INFO : Precision score for label_class 1: 0.6205
2024-08-15 17:33:51,650 : INFO : Precision score for label_class 2: 0.3377
2024-08-15 17:33:51,650 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:33:51,650 : INFO : Recall score for label_class 1: 0.7807
2024-08-15 17:33:51,650 : INFO : Recall score for label_class 2: 0.2972
2024-08-15 17:33:51,650 : INFO : Average F1 score: 0.3359
2024-08-15 17:33:52,117 : INFO : Average loss over validation batches: 0.8066
2024-08-15 17:33:52,117 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:52,117 : INFO : Validation metrics:
2024-08-15 17:33:52,117 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:52,120 : INFO : Accuracy: 0.6874
2024-08-15 17:33:52,120 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:33:52,120 : INFO : Precision score for label_class 1: 0.7458
2024-08-15 17:33:52,120 : INFO : Precision score for label_class 2: 0.4722
2024-08-15 17:33:52,120 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:33:52,120 : INFO : Recall score for label_class 1: 0.9542
2024-08-15 17:33:52,120 : INFO : Recall score for label_class 2: 0.3908
2024-08-15 17:33:52,120 : INFO : Average F1 score: 0.4216
2024-08-15 17:33:52,120 : INFO : Validation metric decreased (inf --> 0.806646).  Saving model ...
2024-08-15 17:33:52,228 : INFO : Starting epoch 2
2024-08-15 17:33:52,900 : INFO : Current training batch loss: 0.6683 in epoch 2
2024-08-15 17:33:53,736 : INFO : Current training batch loss: 0.7255 in epoch 2
2024-08-15 17:33:54,661 : INFO : Current training batch loss: 0.7120 in epoch 2
2024-08-15 17:33:55,506 : INFO : Current training batch loss: 0.5768 in epoch 2
2024-08-15 17:33:55,871 : INFO : Epoch finished, average loss over training batches: 0.7204
2024-08-15 17:33:55,872 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:55,872 : INFO : Training metrics:
2024-08-15 17:33:55,872 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:55,876 : INFO : Accuracy: 0.7205
2024-08-15 17:33:55,876 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:33:55,876 : INFO : Precision score for label_class 1: 0.7776
2024-08-15 17:33:55,876 : INFO : Precision score for label_class 2: 0.5691
2024-08-15 17:33:55,876 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:33:55,876 : INFO : Recall score for label_class 1: 0.9549
2024-08-15 17:33:55,876 : INFO : Recall score for label_class 2: 0.5426
2024-08-15 17:33:55,876 : INFO : Average F1 score: 0.4709
2024-08-15 17:33:56,343 : INFO : Average loss over validation batches: 0.6638
2024-08-15 17:33:56,343 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:56,343 : INFO : Validation metrics:
2024-08-15 17:33:56,343 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:33:56,346 : INFO : Accuracy: 0.7289
2024-08-15 17:33:56,346 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:33:56,346 : INFO : Precision score for label_class 1: 0.8333
2024-08-15 17:33:56,346 : INFO : Precision score for label_class 2: 0.5114
2024-08-15 17:33:56,346 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:33:56,346 : INFO : Recall score for label_class 1: 0.9157
2024-08-15 17:33:56,346 : INFO : Recall score for label_class 2: 0.6437
2024-08-15 17:33:56,346 : INFO : Average F1 score: 0.4808
2024-08-15 17:33:56,346 : INFO : Validation metric decreased (0.806646 --> 0.663756).  Saving model ...
2024-08-15 17:33:56,448 : INFO : Starting epoch 3
2024-08-15 17:33:56,918 : INFO : Current training batch loss: 0.5750 in epoch 3
2024-08-15 17:33:57,762 : INFO : Current training batch loss: 0.5827 in epoch 3
2024-08-15 17:33:58,600 : INFO : Current training batch loss: 0.5520 in epoch 3
2024-08-15 17:33:59,435 : INFO : Current training batch loss: 0.4542 in epoch 3
2024-08-15 17:34:00,006 : INFO : Epoch finished, average loss over training batches: 0.5688
2024-08-15 17:34:00,006 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:00,006 : INFO : Training metrics:
2024-08-15 17:34:00,006 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:00,015 : INFO : Accuracy: 0.7902
2024-08-15 17:34:00,015 : INFO : Precision score for label_class 0: 0.8000
2024-08-15 17:34:00,015 : INFO : Precision score for label_class 1: 0.8689
2024-08-15 17:34:00,015 : INFO : Precision score for label_class 2: 0.6407
2024-08-15 17:34:00,015 : INFO : Recall score for label_class 0: 0.0488
2024-08-15 17:34:00,015 : INFO : Recall score for label_class 1: 0.9549
2024-08-15 17:34:00,015 : INFO : Recall score for label_class 2: 0.7649
2024-08-15 17:34:00,015 : INFO : Average F1 score: 0.5664
2024-08-15 17:34:00,485 : INFO : Average loss over validation batches: 0.5458
2024-08-15 17:34:00,485 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:00,485 : INFO : Validation metrics:
2024-08-15 17:34:00,485 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:00,488 : INFO : Accuracy: 0.8000
2024-08-15 17:34:00,488 : INFO : Precision score for label_class 0: 0.8333
2024-08-15 17:34:00,488 : INFO : Precision score for label_class 1: 0.8817
2024-08-15 17:34:00,488 : INFO : Precision score for label_class 2: 0.6308
2024-08-15 17:34:00,488 : INFO : Recall score for label_class 0: 0.2907
2024-08-15 17:34:00,488 : INFO : Recall score for label_class 1: 0.9157
2024-08-15 17:34:00,488 : INFO : Recall score for label_class 2: 0.7759
2024-08-15 17:34:00,488 : INFO : Average F1 score: 0.6751
2024-08-15 17:34:00,488 : INFO : Validation metric decreased (0.663756 --> 0.545785).  Saving model ...
2024-08-15 17:34:00,591 : INFO : Starting epoch 4
2024-08-15 17:34:00,845 : INFO : Current training batch loss: 0.7655 in epoch 4
2024-08-15 17:34:01,660 : INFO : Current training batch loss: 0.4801 in epoch 4
2024-08-15 17:34:02,475 : INFO : Current training batch loss: 0.4652 in epoch 4
2024-08-15 17:34:03,290 : INFO : Current training batch loss: 0.3688 in epoch 4
2024-08-15 17:34:04,044 : INFO : Epoch finished, average loss over training batches: 0.4640
2024-08-15 17:34:04,044 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:04,044 : INFO : Training metrics:
2024-08-15 17:34:04,044 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:04,052 : INFO : Accuracy: 0.8762
2024-08-15 17:34:04,052 : INFO : Precision score for label_class 0: 0.8426
2024-08-15 17:34:04,052 : INFO : Precision score for label_class 1: 0.9012
2024-08-15 17:34:04,052 : INFO : Precision score for label_class 2: 0.8298
2024-08-15 17:34:04,052 : INFO : Recall score for label_class 0: 0.6037
2024-08-15 17:34:04,052 : INFO : Recall score for label_class 1: 0.9662
2024-08-15 17:34:04,052 : INFO : Recall score for label_class 2: 0.8062
2024-08-15 17:34:04,052 : INFO : Average F1 score: 0.8179
2024-08-15 17:34:04,522 : INFO : Average loss over validation batches: 0.5050
2024-08-15 17:34:04,522 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:04,522 : INFO : Validation metrics:
2024-08-15 17:34:04,522 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:04,525 : INFO : Accuracy: 0.8489
2024-08-15 17:34:04,525 : INFO : Precision score for label_class 0: 0.8025
2024-08-15 17:34:04,525 : INFO : Precision score for label_class 1: 0.9125
2024-08-15 17:34:04,525 : INFO : Precision score for label_class 2: 0.7371
2024-08-15 17:34:04,525 : INFO : Recall score for label_class 0: 0.7558
2024-08-15 17:34:04,525 : INFO : Recall score for label_class 1: 0.8795
2024-08-15 17:34:04,525 : INFO : Recall score for label_class 2: 0.8218
2024-08-15 17:34:04,525 : INFO : Average F1 score: 0.8171
2024-08-15 17:34:04,525 : INFO : Validation metric decreased (0.545785 --> 0.504989).  Saving model ...
2024-08-15 17:34:04,627 : INFO : Starting epoch 5
2024-08-15 17:34:04,679 : INFO : Current training batch loss: 0.4228 in epoch 5
2024-08-15 17:34:05,494 : INFO : Current training batch loss: 0.5159 in epoch 5
2024-08-15 17:34:06,309 : INFO : Current training batch loss: 0.4129 in epoch 5
2024-08-15 17:34:07,124 : INFO : Current training batch loss: 0.4148 in epoch 5
2024-08-15 17:34:07,940 : INFO : Current training batch loss: 0.4105 in epoch 5
2024-08-15 17:34:08,091 : INFO : Epoch finished, average loss over training batches: 0.4090
2024-08-15 17:34:08,092 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:08,092 : INFO : Training metrics:
2024-08-15 17:34:08,092 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:08,096 : INFO : Accuracy: 0.9021
2024-08-15 17:34:08,096 : INFO : Precision score for label_class 0: 0.8255
2024-08-15 17:34:08,096 : INFO : Precision score for label_class 1: 0.9228
2024-08-15 17:34:08,096 : INFO : Precision score for label_class 2: 0.8863
2024-08-15 17:34:08,096 : INFO : Recall score for label_class 0: 0.7500
2024-08-15 17:34:08,096 : INFO : Recall score for label_class 1: 0.9655
2024-08-15 17:34:08,096 : INFO : Recall score for label_class 2: 0.8359
2024-08-15 17:34:08,096 : INFO : Average F1 score: 0.8633
2024-08-15 17:34:08,566 : INFO : Average loss over validation batches: 0.4685
2024-08-15 17:34:08,567 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:08,567 : INFO : Validation metrics:
2024-08-15 17:34:08,567 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:08,570 : INFO : Accuracy: 0.8652
2024-08-15 17:34:08,570 : INFO : Precision score for label_class 0: 0.8171
2024-08-15 17:34:08,570 : INFO : Precision score for label_class 1: 0.8928
2024-08-15 17:34:08,570 : INFO : Precision score for label_class 2: 0.8171
2024-08-15 17:34:08,570 : INFO : Recall score for label_class 0: 0.7791
2024-08-15 17:34:08,570 : INFO : Recall score for label_class 1: 0.9229
2024-08-15 17:34:08,570 : INFO : Recall score for label_class 2: 0.7701
2024-08-15 17:34:08,570 : INFO : Average F1 score: 0.8327
2024-08-15 17:34:08,570 : INFO : Validation metric decreased (0.504989 --> 0.468484).  Saving model ...
2024-08-15 17:34:08,676 : INFO : Split 1 is finished, the score is: 0.8327
2024-08-15 17:34:08,676 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:08,676 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:08,676 : INFO : Starting training for split 2
2024-08-15 17:34:08,691 : INFO : Starting to tokenize the sequences.
2024-08-15 17:34:08,697 : INFO : Tokenization is finished.
2024-08-15 17:34:08,714 : INFO : Starting to tokenize the sequences.
2024-08-15 17:34:08,719 : INFO : Tokenization is finished.
2024-08-15 17:34:08,723 : INFO : Counting occurences of labels...
2024-08-15 17:34:08,724 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 343, 1601,  754]))
2024-08-15 17:34:08,725 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 71, 410, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:34:08,772 : INFO : Starting epoch 1
2024-08-15 17:34:08,824 : INFO : Current training batch loss: 1.0927 in epoch 1
2024-08-15 17:34:09,638 : INFO : Current training batch loss: 1.0646 in epoch 1
2024-08-15 17:34:10,453 : INFO : Current training batch loss: 1.0255 in epoch 1
2024-08-15 17:34:11,268 : INFO : Current training batch loss: 0.9046 in epoch 1
2024-08-15 17:34:12,083 : INFO : Current training batch loss: 0.8893 in epoch 1
2024-08-15 17:34:12,234 : INFO : Epoch finished, average loss over training batches: 0.9711
2024-08-15 17:34:12,234 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:12,234 : INFO : Training metrics:
2024-08-15 17:34:12,234 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:12,245 : INFO : Accuracy: 0.5953
2024-08-15 17:34:12,245 : INFO : Precision score for label_class 0: 0.0364
2024-08-15 17:34:12,245 : INFO : Precision score for label_class 1: 0.6119
2024-08-15 17:34:12,245 : INFO : Precision score for label_class 2: 0.5041
2024-08-15 17:34:12,245 : INFO : Recall score for label_class 0: 0.0058
2024-08-15 17:34:12,245 : INFO : Recall score for label_class 1: 0.9631
2024-08-15 17:34:12,245 : INFO : Recall score for label_class 2: 0.0822
2024-08-15 17:34:12,245 : INFO : Average F1 score: 0.2999
2024-08-15 17:34:12,713 : INFO : Average loss over validation batches: 0.8226
2024-08-15 17:34:12,713 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:12,713 : INFO : Validation metrics:
2024-08-15 17:34:12,714 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:12,717 : INFO : Accuracy: 0.6919
2024-08-15 17:34:12,717 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:34:12,718 : INFO : Precision score for label_class 1: 0.7211
2024-08-15 17:34:12,718 : INFO : Precision score for label_class 2: 0.5692
2024-08-15 17:34:12,718 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:34:12,718 : INFO : Recall score for label_class 1: 0.9585
2024-08-15 17:34:12,718 : INFO : Recall score for label_class 2: 0.3814
2024-08-15 17:34:12,718 : INFO : Average F1 score: 0.4266
2024-08-15 17:34:12,718 : INFO : Validation metric decreased (inf --> 0.822585).  Saving model ...
2024-08-15 17:34:12,821 : INFO : Starting epoch 2
2024-08-15 17:34:13,475 : INFO : Current training batch loss: 0.7862 in epoch 2
2024-08-15 17:34:14,290 : INFO : Current training batch loss: 0.7216 in epoch 2
2024-08-15 17:34:15,104 : INFO : Current training batch loss: 0.7316 in epoch 2
2024-08-15 17:34:15,919 : INFO : Current training batch loss: 0.5829 in epoch 2
2024-08-15 17:34:16,271 : INFO : Epoch finished, average loss over training batches: 0.7356
2024-08-15 17:34:16,271 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:16,271 : INFO : Training metrics:
2024-08-15 17:34:16,271 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:16,278 : INFO : Accuracy: 0.7161
2024-08-15 17:34:16,278 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:34:16,278 : INFO : Precision score for label_class 1: 0.7755
2024-08-15 17:34:16,278 : INFO : Precision score for label_class 2: 0.5528
2024-08-15 17:34:16,278 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:34:16,278 : INFO : Recall score for label_class 1: 0.9582
2024-08-15 17:34:16,278 : INFO : Recall score for label_class 2: 0.5279
2024-08-15 17:34:16,278 : INFO : Average F1 score: 0.4657
2024-08-15 17:34:16,746 : INFO : Average loss over validation batches: 0.6623
2024-08-15 17:34:16,747 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:16,747 : INFO : Validation metrics:
2024-08-15 17:34:16,747 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:16,751 : INFO : Accuracy: 0.7422
2024-08-15 17:34:16,751 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:34:16,751 : INFO : Precision score for label_class 1: 0.8042
2024-08-15 17:34:16,751 : INFO : Precision score for label_class 2: 0.5950
2024-08-15 17:34:16,751 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:34:16,751 : INFO : Recall score for label_class 1: 0.9317
2024-08-15 17:34:16,751 : INFO : Recall score for label_class 2: 0.6134
2024-08-15 17:34:16,751 : INFO : Average F1 score: 0.4891
2024-08-15 17:34:16,751 : INFO : Validation metric decreased (0.822585 --> 0.662309).  Saving model ...
2024-08-15 17:34:16,854 : INFO : Starting epoch 3
2024-08-15 17:34:17,306 : INFO : Current training batch loss: 0.7072 in epoch 3
2024-08-15 17:34:18,116 : INFO : Current training batch loss: 0.6454 in epoch 3
2024-08-15 17:34:18,926 : INFO : Current training batch loss: 0.6409 in epoch 3
2024-08-15 17:34:19,736 : INFO : Current training batch loss: 0.5144 in epoch 3
2024-08-15 17:34:20,278 : INFO : Epoch finished, average loss over training batches: 0.6128
2024-08-15 17:34:20,278 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:20,278 : INFO : Training metrics:
2024-08-15 17:34:20,278 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:20,288 : INFO : Accuracy: 0.7572
2024-08-15 17:34:20,288 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:34:20,288 : INFO : Precision score for label_class 1: 0.8387
2024-08-15 17:34:20,288 : INFO : Precision score for label_class 2: 0.5891
2024-08-15 17:34:20,288 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:34:20,288 : INFO : Recall score for label_class 1: 0.9519
2024-08-15 17:34:20,288 : INFO : Recall score for label_class 2: 0.6883
2024-08-15 17:34:20,288 : INFO : Average F1 score: 0.5089
2024-08-15 17:34:20,755 : INFO : Average loss over validation batches: 0.5848
2024-08-15 17:34:20,756 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:20,756 : INFO : Validation metrics:
2024-08-15 17:34:20,756 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:20,759 : INFO : Accuracy: 0.7778
2024-08-15 17:34:20,759 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:34:20,759 : INFO : Precision score for label_class 1: 0.8607
2024-08-15 17:34:20,759 : INFO : Precision score for label_class 2: 0.6245
2024-08-15 17:34:20,759 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:34:20,759 : INFO : Recall score for label_class 1: 0.9195
2024-08-15 17:34:20,759 : INFO : Recall score for label_class 2: 0.7629
2024-08-15 17:34:20,759 : INFO : Average F1 score: 0.5253
2024-08-15 17:34:20,759 : INFO : Validation metric decreased (0.662309 --> 0.584841).  Saving model ...
2024-08-15 17:34:20,862 : INFO : Starting epoch 4
2024-08-15 17:34:21,113 : INFO : Current training batch loss: 0.7110 in epoch 4
2024-08-15 17:34:21,923 : INFO : Current training batch loss: 0.5033 in epoch 4
2024-08-15 17:34:22,733 : INFO : Current training batch loss: 0.4784 in epoch 4
2024-08-15 17:34:23,544 : INFO : Current training batch loss: 0.4219 in epoch 4
2024-08-15 17:34:24,298 : INFO : Epoch finished, average loss over training batches: 0.5330
2024-08-15 17:34:24,298 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:24,298 : INFO : Training metrics:
2024-08-15 17:34:24,298 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:24,309 : INFO : Accuracy: 0.7924
2024-08-15 17:34:24,309 : INFO : Precision score for label_class 0: 1.0000
2024-08-15 17:34:24,309 : INFO : Precision score for label_class 1: 0.8872
2024-08-15 17:34:24,309 : INFO : Precision score for label_class 2: 0.6229
2024-08-15 17:34:24,310 : INFO : Recall score for label_class 0: 0.0058
2024-08-15 17:34:24,310 : INFO : Recall score for label_class 1: 0.9575
2024-08-15 17:34:24,310 : INFO : Recall score for label_class 2: 0.7997
2024-08-15 17:34:24,310 : INFO : Average F1 score: 0.5443
2024-08-15 17:34:24,781 : INFO : Average loss over validation batches: 0.5483
2024-08-15 17:34:24,781 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:24,781 : INFO : Validation metrics:
2024-08-15 17:34:24,781 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:24,785 : INFO : Accuracy: 0.7867
2024-08-15 17:34:24,785 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:34:24,785 : INFO : Precision score for label_class 1: 0.8710
2024-08-15 17:34:24,785 : INFO : Precision score for label_class 2: 0.6349
2024-08-15 17:34:24,785 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:34:24,785 : INFO : Recall score for label_class 1: 0.9220
2024-08-15 17:34:24,785 : INFO : Recall score for label_class 2: 0.7887
2024-08-15 17:34:24,785 : INFO : Average F1 score: 0.5331
2024-08-15 17:34:24,785 : INFO : Validation metric decreased (0.584841 --> 0.548277).  Saving model ...
2024-08-15 17:34:24,889 : INFO : Starting epoch 5
2024-08-15 17:34:24,940 : INFO : Current training batch loss: 0.4586 in epoch 5
2024-08-15 17:34:25,755 : INFO : Current training batch loss: 0.6457 in epoch 5
2024-08-15 17:34:26,571 : INFO : Current training batch loss: 0.4990 in epoch 5
2024-08-15 17:34:27,389 : INFO : Current training batch loss: 0.4921 in epoch 5
2024-08-15 17:34:28,205 : INFO : Current training batch loss: 0.4858 in epoch 5
2024-08-15 17:34:28,356 : INFO : Epoch finished, average loss over training batches: 0.4903
2024-08-15 17:34:28,357 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:28,357 : INFO : Training metrics:
2024-08-15 17:34:28,357 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:28,368 : INFO : Accuracy: 0.8150
2024-08-15 17:34:28,368 : INFO : Precision score for label_class 0: 1.0000
2024-08-15 17:34:28,368 : INFO : Precision score for label_class 1: 0.9065
2024-08-15 17:34:28,368 : INFO : Precision score for label_class 2: 0.6513
2024-08-15 17:34:28,368 : INFO : Recall score for label_class 0: 0.0641
2024-08-15 17:34:28,368 : INFO : Recall score for label_class 1: 0.9631
2024-08-15 17:34:28,368 : INFO : Recall score for label_class 2: 0.8422
2024-08-15 17:34:28,368 : INFO : Average F1 score: 0.5964
2024-08-15 17:34:28,837 : INFO : Average loss over validation batches: 0.5279
2024-08-15 17:34:28,837 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:28,837 : INFO : Validation metrics:
2024-08-15 17:34:28,837 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:28,840 : INFO : Accuracy: 0.7956
2024-08-15 17:34:28,840 : INFO : Precision score for label_class 0: 0.7500
2024-08-15 17:34:28,840 : INFO : Precision score for label_class 1: 0.8597
2024-08-15 17:34:28,840 : INFO : Precision score for label_class 2: 0.6667
2024-08-15 17:34:28,840 : INFO : Recall score for label_class 0: 0.0423
2024-08-15 17:34:28,840 : INFO : Recall score for label_class 1: 0.9415
2024-08-15 17:34:28,840 : INFO : Recall score for label_class 2: 0.7629
2024-08-15 17:34:28,840 : INFO : Average F1 score: 0.5634
2024-08-15 17:34:28,840 : INFO : Validation metric decreased (0.548277 --> 0.527892).  Saving model ...
2024-08-15 17:34:28,946 : INFO : Split 2 is finished, the score is: 0.5634
2024-08-15 17:34:28,946 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:28,946 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:28,946 : INFO : Starting training for split 3
2024-08-15 17:34:28,961 : INFO : Starting to tokenize the sequences.
2024-08-15 17:34:28,967 : INFO : Tokenization is finished.
2024-08-15 17:34:28,988 : INFO : Starting to tokenize the sequences.
2024-08-15 17:34:28,993 : INFO : Tokenization is finished.
2024-08-15 17:34:28,999 : INFO : Counting occurences of labels...
2024-08-15 17:34:29,000 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1611,  759]))
2024-08-15 17:34:29,000 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 400, 189]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:34:29,059 : INFO : Starting epoch 1
2024-08-15 17:34:29,111 : INFO : Current training batch loss: 1.0823 in epoch 1
2024-08-15 17:34:29,928 : INFO : Current training batch loss: 1.0638 in epoch 1
2024-08-15 17:34:30,743 : INFO : Current training batch loss: 0.9548 in epoch 1
2024-08-15 17:34:31,558 : INFO : Current training batch loss: 0.8983 in epoch 1
2024-08-15 17:34:32,374 : INFO : Current training batch loss: 0.8737 in epoch 1
2024-08-15 17:34:32,524 : INFO : Epoch finished, average loss over training batches: 0.9601
2024-08-15 17:34:32,524 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:32,524 : INFO : Training metrics:
2024-08-15 17:34:32,525 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:32,532 : INFO : Accuracy: 0.6045
2024-08-15 17:34:32,532 : INFO : Precision score for label_class 0: 0.1250
2024-08-15 17:34:32,532 : INFO : Precision score for label_class 1: 0.6224
2024-08-15 17:34:32,532 : INFO : Precision score for label_class 2: 0.5036
2024-08-15 17:34:32,532 : INFO : Recall score for label_class 0: 0.0244
2024-08-15 17:34:32,532 : INFO : Recall score for label_class 1: 0.9640
2024-08-15 17:34:32,532 : INFO : Recall score for label_class 2: 0.0922
2024-08-15 17:34:32,532 : INFO : Average F1 score: 0.3177
2024-08-15 17:34:32,998 : INFO : Average loss over validation batches: 0.8051
2024-08-15 17:34:32,998 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:32,998 : INFO : Validation metrics:
2024-08-15 17:34:32,998 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:33,001 : INFO : Accuracy: 0.6844
2024-08-15 17:34:33,001 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:34:33,001 : INFO : Precision score for label_class 1: 0.7431
2024-08-15 17:34:33,001 : INFO : Precision score for label_class 2: 0.5089
2024-08-15 17:34:33,001 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:34:33,001 : INFO : Recall score for label_class 1: 0.9400
2024-08-15 17:34:33,001 : INFO : Recall score for label_class 2: 0.4550
2024-08-15 17:34:33,001 : INFO : Average F1 score: 0.4368
2024-08-15 17:34:33,001 : INFO : Validation metric decreased (inf --> 0.805053).  Saving model ...
2024-08-15 17:34:33,105 : INFO : Starting epoch 2
2024-08-15 17:34:33,759 : INFO : Current training batch loss: 0.7579 in epoch 2
2024-08-15 17:34:34,574 : INFO : Current training batch loss: 0.7002 in epoch 2
2024-08-15 17:34:35,388 : INFO : Current training batch loss: 0.6645 in epoch 2
2024-08-15 17:34:36,205 : INFO : Current training batch loss: 0.5772 in epoch 2
2024-08-15 17:34:36,556 : INFO : Epoch finished, average loss over training batches: 0.6908
2024-08-15 17:34:36,557 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:36,557 : INFO : Training metrics:
2024-08-15 17:34:36,557 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:36,564 : INFO : Accuracy: 0.7335
2024-08-15 17:34:36,564 : INFO : Precision score for label_class 0: 0.5714
2024-08-15 17:34:36,564 : INFO : Precision score for label_class 1: 0.7986
2024-08-15 17:34:36,564 : INFO : Precision score for label_class 2: 0.5736
2024-08-15 17:34:36,564 : INFO : Recall score for label_class 0: 0.0122
2024-08-15 17:34:36,564 : INFO : Recall score for label_class 1: 0.9503
2024-08-15 17:34:36,564 : INFO : Recall score for label_class 2: 0.5850
2024-08-15 17:34:36,565 : INFO : Average F1 score: 0.4904
2024-08-15 17:34:37,031 : INFO : Average loss over validation batches: 0.5984
2024-08-15 17:34:37,031 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:37,031 : INFO : Validation metrics:
2024-08-15 17:34:37,031 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:37,034 : INFO : Accuracy: 0.7719
2024-08-15 17:34:37,034 : INFO : Precision score for label_class 0: 0.8000
2024-08-15 17:34:37,034 : INFO : Precision score for label_class 1: 0.8396
2024-08-15 17:34:37,034 : INFO : Precision score for label_class 2: 0.6238
2024-08-15 17:34:37,034 : INFO : Recall score for label_class 0: 0.0930
2024-08-15 17:34:37,034 : INFO : Recall score for label_class 1: 0.9550
2024-08-15 17:34:37,034 : INFO : Recall score for label_class 2: 0.6931
2024-08-15 17:34:37,034 : INFO : Average F1 score: 0.5723
2024-08-15 17:34:37,034 : INFO : Validation metric decreased (0.805053 --> 0.598435).  Saving model ...
2024-08-15 17:34:37,137 : INFO : Starting epoch 3
2024-08-15 17:34:37,604 : INFO : Current training batch loss: 0.5670 in epoch 3
2024-08-15 17:34:38,438 : INFO : Current training batch loss: 0.4596 in epoch 3
2024-08-15 17:34:39,279 : INFO : Current training batch loss: 0.4954 in epoch 3
2024-08-15 17:34:40,121 : INFO : Current training batch loss: 0.3752 in epoch 3
2024-08-15 17:34:40,693 : INFO : Epoch finished, average loss over training batches: 0.5182
2024-08-15 17:34:40,694 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:40,694 : INFO : Training metrics:
2024-08-15 17:34:40,694 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:40,698 : INFO : Accuracy: 0.8495
2024-08-15 17:34:40,698 : INFO : Precision score for label_class 0: 0.8087
2024-08-15 17:34:40,698 : INFO : Precision score for label_class 1: 0.8769
2024-08-15 17:34:40,698 : INFO : Precision score for label_class 2: 0.7961
2024-08-15 17:34:40,698 : INFO : Recall score for label_class 0: 0.5671
2024-08-15 17:34:40,698 : INFO : Recall score for label_class 1: 0.9510
2024-08-15 17:34:40,698 : INFO : Recall score for label_class 2: 0.7563
2024-08-15 17:34:40,698 : INFO : Average F1 score: 0.7849
2024-08-15 17:34:41,163 : INFO : Average loss over validation batches: 0.4792
2024-08-15 17:34:41,164 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:41,164 : INFO : Validation metrics:
2024-08-15 17:34:41,164 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:41,166 : INFO : Accuracy: 0.8681
2024-08-15 17:34:41,166 : INFO : Precision score for label_class 0: 0.8462
2024-08-15 17:34:41,166 : INFO : Precision score for label_class 1: 0.9017
2024-08-15 17:34:41,166 : INFO : Precision score for label_class 2: 0.8053
2024-08-15 17:34:41,166 : INFO : Recall score for label_class 0: 0.7674
2024-08-15 17:34:41,166 : INFO : Recall score for label_class 1: 0.9175
2024-08-15 17:34:41,166 : INFO : Recall score for label_class 2: 0.8095
2024-08-15 17:34:41,166 : INFO : Average F1 score: 0.8406
2024-08-15 17:34:41,166 : INFO : Validation metric decreased (0.598435 --> 0.479183).  Saving model ...
2024-08-15 17:34:41,271 : INFO : Starting epoch 4
2024-08-15 17:34:41,526 : INFO : Current training batch loss: 0.5934 in epoch 4
2024-08-15 17:34:42,344 : INFO : Current training batch loss: 0.6656 in epoch 4
2024-08-15 17:34:43,166 : INFO : Current training batch loss: 0.4379 in epoch 4
2024-08-15 17:34:43,987 : INFO : Current training batch loss: 0.3441 in epoch 4
2024-08-15 17:34:44,742 : INFO : Epoch finished, average loss over training batches: 0.4150
2024-08-15 17:34:44,742 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:44,742 : INFO : Training metrics:
2024-08-15 17:34:44,742 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:44,747 : INFO : Accuracy: 0.8984
2024-08-15 17:34:44,747 : INFO : Precision score for label_class 0: 0.8255
2024-08-15 17:34:44,747 : INFO : Precision score for label_class 1: 0.9103
2024-08-15 17:34:44,747 : INFO : Precision score for label_class 2: 0.9032
2024-08-15 17:34:44,747 : INFO : Recall score for label_class 0: 0.8079
2024-08-15 17:34:44,747 : INFO : Recall score for label_class 1: 0.9578
2024-08-15 17:34:44,747 : INFO : Recall score for label_class 2: 0.8116
2024-08-15 17:34:44,747 : INFO : Average F1 score: 0.8684
2024-08-15 17:34:45,215 : INFO : Average loss over validation batches: 0.4396
2024-08-15 17:34:45,215 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:45,215 : INFO : Validation metrics:
2024-08-15 17:34:45,215 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:45,218 : INFO : Accuracy: 0.8652
2024-08-15 17:34:45,218 : INFO : Precision score for label_class 0: 0.8000
2024-08-15 17:34:45,218 : INFO : Precision score for label_class 1: 0.9160
2024-08-15 17:34:45,218 : INFO : Precision score for label_class 2: 0.7919
2024-08-15 17:34:45,218 : INFO : Recall score for label_class 0: 0.7907
2024-08-15 17:34:45,218 : INFO : Recall score for label_class 1: 0.9000
2024-08-15 17:34:45,218 : INFO : Recall score for label_class 2: 0.8254
2024-08-15 17:34:45,218 : INFO : Average F1 score: 0.8372
2024-08-15 17:34:45,218 : INFO : Validation metric decreased (0.479183 --> 0.439592).  Saving model ...
2024-08-15 17:34:45,321 : INFO : Starting epoch 5
2024-08-15 17:34:45,372 : INFO : Current training batch loss: 0.3368 in epoch 5
2024-08-15 17:34:46,187 : INFO : Current training batch loss: 0.5034 in epoch 5
2024-08-15 17:34:47,003 : INFO : Current training batch loss: 0.3286 in epoch 5
2024-08-15 17:34:47,834 : INFO : Current training batch loss: 0.3827 in epoch 5
2024-08-15 17:34:48,664 : INFO : Current training batch loss: 0.4092 in epoch 5
2024-08-15 17:34:48,815 : INFO : Epoch finished, average loss over training batches: 0.3660
2024-08-15 17:34:48,815 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:48,815 : INFO : Training metrics:
2024-08-15 17:34:48,816 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:48,819 : INFO : Accuracy: 0.9136
2024-08-15 17:34:48,819 : INFO : Precision score for label_class 0: 0.8442
2024-08-15 17:34:48,819 : INFO : Precision score for label_class 1: 0.9274
2024-08-15 17:34:48,819 : INFO : Precision score for label_class 2: 0.9127
2024-08-15 17:34:48,819 : INFO : Recall score for label_class 0: 0.8262
2024-08-15 17:34:48,819 : INFO : Recall score for label_class 1: 0.9597
2024-08-15 17:34:48,819 : INFO : Recall score for label_class 2: 0.8538
2024-08-15 17:34:48,820 : INFO : Average F1 score: 0.8869
2024-08-15 17:34:49,287 : INFO : Average loss over validation batches: 0.4184
2024-08-15 17:34:49,287 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:49,287 : INFO : Validation metrics:
2024-08-15 17:34:49,287 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:49,290 : INFO : Accuracy: 0.8681
2024-08-15 17:34:49,290 : INFO : Precision score for label_class 0: 0.8293
2024-08-15 17:34:49,290 : INFO : Precision score for label_class 1: 0.8998
2024-08-15 17:34:49,290 : INFO : Precision score for label_class 2: 0.8152
2024-08-15 17:34:49,290 : INFO : Recall score for label_class 0: 0.7907
2024-08-15 17:34:49,290 : INFO : Recall score for label_class 1: 0.9200
2024-08-15 17:34:49,290 : INFO : Recall score for label_class 2: 0.7937
2024-08-15 17:34:49,290 : INFO : Average F1 score: 0.8412
2024-08-15 17:34:49,290 : INFO : Validation metric decreased (0.439592 --> 0.418389).  Saving model ...
2024-08-15 17:34:49,394 : INFO : Split 3 is finished, the score is: 0.8412
2024-08-15 17:34:49,394 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:49,395 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:49,395 : INFO : Starting training for split 4
2024-08-15 17:34:49,409 : INFO : Starting to tokenize the sequences.
2024-08-15 17:34:49,415 : INFO : Tokenization is finished.
2024-08-15 17:34:49,431 : INFO : Starting to tokenize the sequences.
2024-08-15 17:34:49,436 : INFO : Tokenization is finished.
2024-08-15 17:34:49,444 : INFO : Counting occurences of labels...
2024-08-15 17:34:49,445 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 327, 1621,  751]))
2024-08-15 17:34:49,445 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 87, 390, 197]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:34:49,497 : INFO : Starting epoch 1
2024-08-15 17:34:49,549 : INFO : Current training batch loss: 1.1061 in epoch 1
2024-08-15 17:34:50,371 : INFO : Current training batch loss: 1.0747 in epoch 1
2024-08-15 17:34:51,185 : INFO : Current training batch loss: 0.9739 in epoch 1
2024-08-15 17:34:52,000 : INFO : Current training batch loss: 0.8996 in epoch 1
2024-08-15 17:34:52,814 : INFO : Current training batch loss: 0.8824 in epoch 1
2024-08-15 17:34:52,965 : INFO : Epoch finished, average loss over training batches: 0.9857
2024-08-15 17:34:52,965 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:52,965 : INFO : Training metrics:
2024-08-15 17:34:52,965 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:52,973 : INFO : Accuracy: 0.5535
2024-08-15 17:34:52,973 : INFO : Precision score for label_class 0: 0.1146
2024-08-15 17:34:52,973 : INFO : Precision score for label_class 1: 0.6069
2024-08-15 17:34:52,973 : INFO : Precision score for label_class 2: 0.4324
2024-08-15 17:34:52,973 : INFO : Recall score for label_class 0: 0.0887
2024-08-15 17:34:52,973 : INFO : Recall score for label_class 1: 0.8742
2024-08-15 17:34:52,973 : INFO : Recall score for label_class 2: 0.0639
2024-08-15 17:34:52,973 : INFO : Average F1 score: 0.3092
2024-08-15 17:34:53,442 : INFO : Average loss over validation batches: 0.8648
2024-08-15 17:34:53,442 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:53,442 : INFO : Validation metrics:
2024-08-15 17:34:53,442 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:53,446 : INFO : Accuracy: 0.6751
2024-08-15 17:34:53,446 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:34:53,446 : INFO : Precision score for label_class 1: 0.7058
2024-08-15 17:34:53,446 : INFO : Precision score for label_class 2: 0.5547
2024-08-15 17:34:53,446 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:34:53,446 : INFO : Recall score for label_class 1: 0.9718
2024-08-15 17:34:53,446 : INFO : Recall score for label_class 2: 0.3858
2024-08-15 17:34:53,446 : INFO : Average F1 score: 0.4243
2024-08-15 17:34:53,446 : INFO : Validation metric decreased (inf --> 0.864775).  Saving model ...
2024-08-15 17:34:53,557 : INFO : Starting epoch 2
2024-08-15 17:34:54,211 : INFO : Current training batch loss: 0.8021 in epoch 2
2024-08-15 17:34:55,025 : INFO : Current training batch loss: 0.7708 in epoch 2
2024-08-15 17:34:55,840 : INFO : Current training batch loss: 0.6761 in epoch 2
2024-08-15 17:34:56,655 : INFO : Current training batch loss: 0.6086 in epoch 2
2024-08-15 17:34:57,007 : INFO : Epoch finished, average loss over training batches: 0.7377
2024-08-15 17:34:57,007 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:57,007 : INFO : Training metrics:
2024-08-15 17:34:57,007 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:57,014 : INFO : Accuracy: 0.7158
2024-08-15 17:34:57,015 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:34:57,015 : INFO : Precision score for label_class 1: 0.7730
2024-08-15 17:34:57,015 : INFO : Precision score for label_class 2: 0.5522
2024-08-15 17:34:57,015 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:34:57,015 : INFO : Recall score for label_class 1: 0.9537
2024-08-15 17:34:57,015 : INFO : Recall score for label_class 2: 0.5140
2024-08-15 17:34:57,015 : INFO : Average F1 score: 0.4621
2024-08-15 17:34:57,481 : INFO : Average loss over validation batches: 0.6703
2024-08-15 17:34:57,481 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:57,481 : INFO : Validation metrics:
2024-08-15 17:34:57,481 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:34:57,484 : INFO : Accuracy: 0.7433
2024-08-15 17:34:57,484 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:34:57,484 : INFO : Precision score for label_class 1: 0.8280
2024-08-15 17:34:57,484 : INFO : Precision score for label_class 2: 0.5882
2024-08-15 17:34:57,484 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:34:57,485 : INFO : Recall score for label_class 1: 0.9256
2024-08-15 17:34:57,485 : INFO : Recall score for label_class 2: 0.7107
2024-08-15 17:34:57,485 : INFO : Average F1 score: 0.5059
2024-08-15 17:34:57,485 : INFO : Validation metric decreased (0.864775 --> 0.670277).  Saving model ...
2024-08-15 17:34:57,589 : INFO : Starting epoch 3
2024-08-15 17:34:58,042 : INFO : Current training batch loss: 0.6657 in epoch 3
2024-08-15 17:34:58,864 : INFO : Current training batch loss: 0.5676 in epoch 3
2024-08-15 17:34:59,679 : INFO : Current training batch loss: 0.6642 in epoch 3
2024-08-15 17:35:00,493 : INFO : Current training batch loss: 0.4787 in epoch 3
2024-08-15 17:35:01,046 : INFO : Epoch finished, average loss over training batches: 0.5899
2024-08-15 17:35:01,046 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:01,046 : INFO : Training metrics:
2024-08-15 17:35:01,046 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:01,050 : INFO : Accuracy: 0.7758
2024-08-15 17:35:01,050 : INFO : Precision score for label_class 0: 0.9091
2024-08-15 17:35:01,050 : INFO : Precision score for label_class 1: 0.8577
2024-08-15 17:35:01,050 : INFO : Precision score for label_class 2: 0.6105
2024-08-15 17:35:01,050 : INFO : Recall score for label_class 0: 0.0306
2024-08-15 17:35:01,050 : INFO : Recall score for label_class 1: 0.9482
2024-08-15 17:35:01,050 : INFO : Recall score for label_class 2: 0.7284
2024-08-15 17:35:01,050 : INFO : Average F1 score: 0.5414
2024-08-15 17:35:01,517 : INFO : Average loss over validation batches: 0.5585
2024-08-15 17:35:01,517 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:01,517 : INFO : Validation metrics:
2024-08-15 17:35:01,517 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:01,520 : INFO : Accuracy: 0.7953
2024-08-15 17:35:01,520 : INFO : Precision score for label_class 0: 0.8333
2024-08-15 17:35:01,520 : INFO : Precision score for label_class 1: 0.8723
2024-08-15 17:35:01,520 : INFO : Precision score for label_class 2: 0.6569
2024-08-15 17:35:01,520 : INFO : Recall score for label_class 0: 0.1149
2024-08-15 17:35:01,520 : INFO : Recall score for label_class 1: 0.9462
2024-08-15 17:35:01,520 : INFO : Recall score for label_class 2: 0.7970
2024-08-15 17:35:01,520 : INFO : Average F1 score: 0.6100
2024-08-15 17:35:01,520 : INFO : Validation metric decreased (0.670277 --> 0.558490).  Saving model ...
2024-08-15 17:35:01,621 : INFO : Starting epoch 4
2024-08-15 17:35:01,872 : INFO : Current training batch loss: 0.6657 in epoch 4
2024-08-15 17:35:02,682 : INFO : Current training batch loss: 0.7192 in epoch 4
2024-08-15 17:35:03,502 : INFO : Current training batch loss: 0.4675 in epoch 4
2024-08-15 17:35:04,321 : INFO : Current training batch loss: 0.3866 in epoch 4
2024-08-15 17:35:05,077 : INFO : Epoch finished, average loss over training batches: 0.4932
2024-08-15 17:35:05,078 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:05,078 : INFO : Training metrics:
2024-08-15 17:35:05,078 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:05,085 : INFO : Accuracy: 0.8492
2024-08-15 17:35:05,085 : INFO : Precision score for label_class 0: 0.8182
2024-08-15 17:35:05,085 : INFO : Precision score for label_class 1: 0.8879
2024-08-15 17:35:05,085 : INFO : Precision score for label_class 2: 0.7676
2024-08-15 17:35:05,085 : INFO : Recall score for label_class 0: 0.4954
2024-08-15 17:35:05,085 : INFO : Recall score for label_class 1: 0.9574
2024-08-15 17:35:05,085 : INFO : Recall score for label_class 2: 0.7696
2024-08-15 17:35:05,085 : INFO : Average F1 score: 0.7690
2024-08-15 17:35:05,555 : INFO : Average loss over validation batches: 0.5056
2024-08-15 17:35:05,555 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:05,555 : INFO : Validation metrics:
2024-08-15 17:35:05,555 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:05,558 : INFO : Accuracy: 0.8427
2024-08-15 17:35:05,558 : INFO : Precision score for label_class 0: 0.7662
2024-08-15 17:35:05,558 : INFO : Precision score for label_class 1: 0.9003
2024-08-15 17:35:05,558 : INFO : Precision score for label_class 2: 0.7621
2024-08-15 17:35:05,558 : INFO : Recall score for label_class 0: 0.6782
2024-08-15 17:35:05,558 : INFO : Recall score for label_class 1: 0.9026
2024-08-15 17:35:05,558 : INFO : Recall score for label_class 2: 0.7970
2024-08-15 17:35:05,558 : INFO : Average F1 score: 0.8000
2024-08-15 17:35:05,558 : INFO : Validation metric decreased (0.558490 --> 0.505565).  Saving model ...
2024-08-15 17:35:05,660 : INFO : Starting epoch 5
2024-08-15 17:35:05,712 : INFO : Current training batch loss: 0.4054 in epoch 5
2024-08-15 17:35:06,536 : INFO : Current training batch loss: 0.6234 in epoch 5
2024-08-15 17:35:07,354 : INFO : Current training batch loss: 0.4109 in epoch 5
2024-08-15 17:35:08,189 : INFO : Current training batch loss: 0.4217 in epoch 5
2024-08-15 17:35:09,009 : INFO : Current training batch loss: 0.4193 in epoch 5
2024-08-15 17:35:09,161 : INFO : Epoch finished, average loss over training batches: 0.4370
2024-08-15 17:35:09,162 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:09,162 : INFO : Training metrics:
2024-08-15 17:35:09,162 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:09,165 : INFO : Accuracy: 0.8840
2024-08-15 17:35:09,165 : INFO : Precision score for label_class 0: 0.8099
2024-08-15 17:35:09,165 : INFO : Precision score for label_class 1: 0.9087
2024-08-15 17:35:09,165 : INFO : Precision score for label_class 2: 0.8543
2024-08-15 17:35:09,165 : INFO : Recall score for label_class 0: 0.7034
2024-08-15 17:35:09,165 : INFO : Recall score for label_class 1: 0.9574
2024-08-15 17:35:09,165 : INFO : Recall score for label_class 2: 0.8043
2024-08-15 17:35:09,165 : INFO : Average F1 score: 0.8379
2024-08-15 17:35:09,722 : INFO : Average loss over validation batches: 0.4780
2024-08-15 17:35:09,722 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:09,722 : INFO : Validation metrics:
2024-08-15 17:35:09,722 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:09,726 : INFO : Accuracy: 0.8591
2024-08-15 17:35:09,726 : INFO : Precision score for label_class 0: 0.7294
2024-08-15 17:35:09,726 : INFO : Precision score for label_class 1: 0.8849
2024-08-15 17:35:09,726 : INFO : Precision score for label_class 2: 0.8605
2024-08-15 17:35:09,726 : INFO : Recall score for label_class 0: 0.7126
2024-08-15 17:35:09,726 : INFO : Recall score for label_class 1: 0.9462
2024-08-15 17:35:09,726 : INFO : Recall score for label_class 2: 0.7513
2024-08-15 17:35:09,726 : INFO : Average F1 score: 0.8125
2024-08-15 17:35:09,726 : INFO : Validation metric decreased (0.505565 --> 0.477957).  Saving model ...
2024-08-15 17:35:09,829 : INFO : Split 4 is finished, the score is: 0.8125
2024-08-15 17:35:09,829 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:09,829 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:09,829 : INFO : Starting training for split 5
2024-08-15 17:35:09,845 : INFO : Starting to tokenize the sequences.
2024-08-15 17:35:09,851 : INFO : Tokenization is finished.
2024-08-15 17:35:09,870 : INFO : Starting to tokenize the sequences.
2024-08-15 17:35:09,875 : INFO : Tokenization is finished.
2024-08-15 17:35:09,879 : INFO : Counting occurences of labels...
2024-08-15 17:35:09,881 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 330, 1615,  754]))
2024-08-15 17:35:09,881 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 84, 396, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:35:09,929 : INFO : Starting epoch 1
2024-08-15 17:35:09,981 : INFO : Current training batch loss: 1.1242 in epoch 1
2024-08-15 17:35:10,812 : INFO : Current training batch loss: 1.0815 in epoch 1
2024-08-15 17:35:11,644 : INFO : Current training batch loss: 0.9690 in epoch 1
2024-08-15 17:35:12,479 : INFO : Current training batch loss: 0.8948 in epoch 1
2024-08-15 17:35:13,297 : INFO : Current training batch loss: 0.9218 in epoch 1
2024-08-15 17:35:13,449 : INFO : Epoch finished, average loss over training batches: 0.9885
2024-08-15 17:35:13,449 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:13,449 : INFO : Training metrics:
2024-08-15 17:35:13,449 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:13,459 : INFO : Accuracy: 0.5128
2024-08-15 17:35:13,460 : INFO : Precision score for label_class 0: 0.1298
2024-08-15 17:35:13,460 : INFO : Precision score for label_class 1: 0.6034
2024-08-15 17:35:13,460 : INFO : Precision score for label_class 2: 0.6000
2024-08-15 17:35:13,460 : INFO : Recall score for label_class 0: 0.2030
2024-08-15 17:35:13,460 : INFO : Recall score for label_class 1: 0.8006
2024-08-15 17:35:13,460 : INFO : Recall score for label_class 2: 0.0318
2024-08-15 17:35:13,460 : INFO : Average F1 score: 0.3023
2024-08-15 17:35:13,927 : INFO : Average loss over validation batches: 0.8426
2024-08-15 17:35:13,927 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:13,927 : INFO : Validation metrics:
2024-08-15 17:35:13,927 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:13,931 : INFO : Accuracy: 0.6528
2024-08-15 17:35:13,931 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:35:13,931 : INFO : Precision score for label_class 1: 0.6961
2024-08-15 17:35:13,931 : INFO : Precision score for label_class 2: 0.4733
2024-08-15 17:35:13,931 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:35:13,931 : INFO : Recall score for label_class 1: 0.9545
2024-08-15 17:35:13,931 : INFO : Recall score for label_class 2: 0.3196
2024-08-15 17:35:13,931 : INFO : Average F1 score: 0.3956
2024-08-15 17:35:13,931 : INFO : Validation metric decreased (inf --> 0.842565).  Saving model ...
2024-08-15 17:35:14,033 : INFO : Starting epoch 2
2024-08-15 17:35:14,696 : INFO : Current training batch loss: 0.7964 in epoch 2
2024-08-15 17:35:15,513 : INFO : Current training batch loss: 0.7815 in epoch 2
2024-08-15 17:35:16,350 : INFO : Current training batch loss: 0.6858 in epoch 2
2024-08-15 17:35:17,167 : INFO : Current training batch loss: 0.6766 in epoch 2
2024-08-15 17:35:17,521 : INFO : Epoch finished, average loss over training batches: 0.7415
2024-08-15 17:35:17,522 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:17,522 : INFO : Training metrics:
2024-08-15 17:35:17,522 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:17,533 : INFO : Accuracy: 0.7136
2024-08-15 17:35:17,533 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:35:17,533 : INFO : Precision score for label_class 1: 0.7661
2024-08-15 17:35:17,533 : INFO : Precision score for label_class 2: 0.5620
2024-08-15 17:35:17,533 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:35:17,533 : INFO : Recall score for label_class 1: 0.9511
2024-08-15 17:35:17,533 : INFO : Recall score for label_class 2: 0.5172
2024-08-15 17:35:17,533 : INFO : Average F1 score: 0.4624
2024-08-15 17:35:17,999 : INFO : Average loss over validation batches: 0.6436
2024-08-15 17:35:17,999 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:17,999 : INFO : Validation metrics:
2024-08-15 17:35:17,999 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:18,002 : INFO : Accuracy: 0.7329
2024-08-15 17:35:18,002 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:35:18,002 : INFO : Precision score for label_class 1: 0.8017
2024-08-15 17:35:18,002 : INFO : Precision score for label_class 2: 0.5756
2024-08-15 17:35:18,002 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:35:18,002 : INFO : Recall score for label_class 1: 0.9495
2024-08-15 17:35:18,002 : INFO : Recall score for label_class 2: 0.6082
2024-08-15 17:35:18,002 : INFO : Average F1 score: 0.4869
2024-08-15 17:35:18,002 : INFO : Validation metric decreased (0.842565 --> 0.643624).  Saving model ...
2024-08-15 17:35:18,104 : INFO : Starting epoch 3
2024-08-15 17:35:18,558 : INFO : Current training batch loss: 0.6400 in epoch 3
2024-08-15 17:35:19,376 : INFO : Current training batch loss: 0.5449 in epoch 3
2024-08-15 17:35:20,194 : INFO : Current training batch loss: 0.6162 in epoch 3
2024-08-15 17:35:21,011 : INFO : Current training batch loss: 0.5015 in epoch 3
2024-08-15 17:35:21,565 : INFO : Epoch finished, average loss over training batches: 0.5807
2024-08-15 17:35:21,565 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:21,565 : INFO : Training metrics:
2024-08-15 17:35:21,566 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:21,576 : INFO : Accuracy: 0.7921
2024-08-15 17:35:21,576 : INFO : Precision score for label_class 0: 0.9565
2024-08-15 17:35:21,576 : INFO : Precision score for label_class 1: 0.8673
2024-08-15 17:35:21,576 : INFO : Precision score for label_class 2: 0.6392
2024-08-15 17:35:21,576 : INFO : Recall score for label_class 0: 0.0667
2024-08-15 17:35:21,576 : INFO : Recall score for label_class 1: 0.9548
2024-08-15 17:35:21,576 : INFO : Recall score for label_class 2: 0.7613
2024-08-15 17:35:21,576 : INFO : Average F1 score: 0.5762
2024-08-15 17:35:22,043 : INFO : Average loss over validation batches: 0.5624
2024-08-15 17:35:22,043 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:22,043 : INFO : Validation metrics:
2024-08-15 17:35:22,044 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:22,047 : INFO : Accuracy: 0.7774
2024-08-15 17:35:22,047 : INFO : Precision score for label_class 0: 0.7857
2024-08-15 17:35:22,047 : INFO : Precision score for label_class 1: 0.8378
2024-08-15 17:35:22,047 : INFO : Precision score for label_class 2: 0.6476
2024-08-15 17:35:22,047 : INFO : Recall score for label_class 0: 0.1310
2024-08-15 17:35:22,047 : INFO : Recall score for label_class 1: 0.9520
2024-08-15 17:35:22,047 : INFO : Recall score for label_class 2: 0.7010
2024-08-15 17:35:22,047 : INFO : Average F1 score: 0.5963
2024-08-15 17:35:22,047 : INFO : Validation metric decreased (0.643624 --> 0.562384).  Saving model ...
2024-08-15 17:35:22,149 : INFO : Starting epoch 4
2024-08-15 17:35:22,405 : INFO : Current training batch loss: 0.6598 in epoch 4
2024-08-15 17:35:23,250 : INFO : Current training batch loss: 0.6982 in epoch 4
2024-08-15 17:35:24,067 : INFO : Current training batch loss: 0.5113 in epoch 4
2024-08-15 17:35:24,882 : INFO : Current training batch loss: 0.4067 in epoch 4
2024-08-15 17:35:25,637 : INFO : Epoch finished, average loss over training batches: 0.4831
2024-08-15 17:35:25,637 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:25,637 : INFO : Training metrics:
2024-08-15 17:35:25,637 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:25,644 : INFO : Accuracy: 0.8785
2024-08-15 17:35:25,644 : INFO : Precision score for label_class 0: 0.8390
2024-08-15 17:35:25,644 : INFO : Precision score for label_class 1: 0.9016
2024-08-15 17:35:25,644 : INFO : Precision score for label_class 2: 0.8359
2024-08-15 17:35:25,644 : INFO : Recall score for label_class 0: 0.6000
2024-08-15 17:35:25,645 : INFO : Recall score for label_class 1: 0.9703
2024-08-15 17:35:25,645 : INFO : Recall score for label_class 2: 0.8037
2024-08-15 17:35:25,645 : INFO : Average F1 score: 0.8179
2024-08-15 17:35:26,118 : INFO : Average loss over validation batches: 0.5129
2024-08-15 17:35:26,119 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:26,119 : INFO : Validation metrics:
2024-08-15 17:35:26,119 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:26,122 : INFO : Accuracy: 0.8264
2024-08-15 17:35:26,122 : INFO : Precision score for label_class 0: 0.7833
2024-08-15 17:35:26,122 : INFO : Precision score for label_class 1: 0.8765
2024-08-15 17:35:26,122 : INFO : Precision score for label_class 2: 0.7363
2024-08-15 17:35:26,122 : INFO : Recall score for label_class 0: 0.5595
2024-08-15 17:35:26,122 : INFO : Recall score for label_class 1: 0.9141
2024-08-15 17:35:26,122 : INFO : Recall score for label_class 2: 0.7629
2024-08-15 17:35:26,122 : INFO : Average F1 score: 0.7657
2024-08-15 17:35:26,122 : INFO : Validation metric decreased (0.562384 --> 0.512919).  Saving model ...
2024-08-15 17:35:26,222 : INFO : Starting epoch 5
2024-08-15 17:35:26,273 : INFO : Current training batch loss: 0.3801 in epoch 5
2024-08-15 17:35:27,121 : INFO : Current training batch loss: 0.6295 in epoch 5
2024-08-15 17:35:27,946 : INFO : Current training batch loss: 0.4114 in epoch 5
2024-08-15 17:35:28,770 : INFO : Current training batch loss: 0.4240 in epoch 5
2024-08-15 17:35:29,585 : INFO : Current training batch loss: 0.4117 in epoch 5
2024-08-15 17:35:29,735 : INFO : Epoch finished, average loss over training batches: 0.4288
2024-08-15 17:35:29,736 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:29,736 : INFO : Training metrics:
2024-08-15 17:35:29,736 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:29,744 : INFO : Accuracy: 0.9033
2024-08-15 17:35:29,744 : INFO : Precision score for label_class 0: 0.8407
2024-08-15 17:35:29,744 : INFO : Precision score for label_class 1: 0.9134
2024-08-15 17:35:29,744 : INFO : Precision score for label_class 2: 0.9050
2024-08-15 17:35:29,744 : INFO : Recall score for label_class 0: 0.7515
2024-08-15 17:35:29,744 : INFO : Recall score for label_class 1: 0.9728
2024-08-15 17:35:29,744 : INFO : Recall score for label_class 2: 0.8210
2024-08-15 17:35:29,744 : INFO : Average F1 score: 0.8655
2024-08-15 17:35:30,211 : INFO : Average loss over validation batches: 0.4975
2024-08-15 17:35:30,211 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:30,211 : INFO : Validation metrics:
2024-08-15 17:35:30,211 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:30,215 : INFO : Accuracy: 0.8368
2024-08-15 17:35:30,215 : INFO : Precision score for label_class 0: 0.7647
2024-08-15 17:35:30,215 : INFO : Precision score for label_class 1: 0.8645
2024-08-15 17:35:30,215 : INFO : Precision score for label_class 2: 0.7978
2024-08-15 17:35:30,215 : INFO : Recall score for label_class 0: 0.6190
2024-08-15 17:35:30,215 : INFO : Recall score for label_class 1: 0.9343
2024-08-15 17:35:30,215 : INFO : Recall score for label_class 2: 0.7320
2024-08-15 17:35:30,215 : INFO : Average F1 score: 0.7819
2024-08-15 17:35:30,215 : INFO : Validation metric decreased (0.512919 --> 0.497543).  Saving model ...
2024-08-15 17:35:30,316 : INFO : Split 5 is finished, the score is: 0.7819
2024-08-15 17:35:30,316 : INFO : ----------------------------------------------------------------------------------------------------
[I 2024-08-15 17:35:30,326] Trial 15 finished with value: 0.7663495884941154 and parameters: {'n_epochs': 5, 'learning_rate': 1.5184442325716543e-05, 'classifier_dropout': 0.12387215526686078, 'warmup_step_fraction': 0.061514524439956045, 'use_gradient_clipping': False}. Best is trial 1 with value: 0.8513001269595835.
2024-08-15 17:35:30,334 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:30,334 : INFO : Starting training for split 1
2024-08-15 17:35:30,346 : INFO : Starting to tokenize the sequences.
2024-08-15 17:35:30,351 : INFO : Tokenization is finished.
2024-08-15 17:35:30,366 : INFO : Starting to tokenize the sequences.
2024-08-15 17:35:30,371 : INFO : Tokenization is finished.
2024-08-15 17:35:30,371 : INFO : Counting occurences of labels...
2024-08-15 17:35:30,372 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1596,  774]))
2024-08-15 17:35:30,373 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 415, 174]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:35:30,424 : INFO : Starting epoch 1
2024-08-15 17:35:30,476 : INFO : Current training batch loss: 1.1164 in epoch 1
2024-08-15 17:35:31,288 : INFO : Current training batch loss: 0.8265 in epoch 1
2024-08-15 17:35:32,100 : INFO : Current training batch loss: 0.8191 in epoch 1
2024-08-15 17:35:32,912 : INFO : Current training batch loss: 0.7776 in epoch 1
2024-08-15 17:35:33,725 : INFO : Current training batch loss: 0.6672 in epoch 1
2024-08-15 17:35:33,868 : INFO : Epoch finished, average loss over training batches: 0.7970
2024-08-15 17:35:33,869 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:33,869 : INFO : Training metrics:
2024-08-15 17:35:33,869 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:33,878 : INFO : Accuracy: 0.6690
2024-08-15 17:35:33,878 : INFO : Precision score for label_class 0: 0.2338
2024-08-15 17:35:33,878 : INFO : Precision score for label_class 1: 0.7372
2024-08-15 17:35:33,878 : INFO : Precision score for label_class 2: 0.5548
2024-08-15 17:35:33,878 : INFO : Recall score for label_class 0: 0.1098
2024-08-15 17:35:33,878 : INFO : Recall score for label_class 1: 0.9054
2024-08-15 17:35:33,878 : INFO : Recall score for label_class 2: 0.4186
2024-08-15 17:35:33,878 : INFO : Average F1 score: 0.4798
2024-08-15 17:35:34,345 : INFO : Average loss over validation batches: 0.6431
2024-08-15 17:35:34,345 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:34,345 : INFO : Validation metrics:
2024-08-15 17:35:34,345 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:34,348 : INFO : Accuracy: 0.7274
2024-08-15 17:35:34,348 : INFO : Precision score for label_class 0: 1.0000
2024-08-15 17:35:34,348 : INFO : Precision score for label_class 1: 0.8322
2024-08-15 17:35:34,348 : INFO : Precision score for label_class 2: 0.5068
2024-08-15 17:35:34,348 : INFO : Recall score for label_class 0: 0.0349
2024-08-15 17:35:34,348 : INFO : Recall score for label_class 1: 0.9084
2024-08-15 17:35:34,348 : INFO : Recall score for label_class 2: 0.6379
2024-08-15 17:35:34,348 : INFO : Average F1 score: 0.5003
2024-08-15 17:35:34,348 : INFO : Validation metric decreased (inf --> 0.643131).  Saving model ...
2024-08-15 17:35:34,457 : INFO : Starting epoch 2
2024-08-15 17:35:35,111 : INFO : Current training batch loss: 0.3686 in epoch 2
2024-08-15 17:35:35,927 : INFO : Current training batch loss: 0.5371 in epoch 2
2024-08-15 17:35:36,744 : INFO : Current training batch loss: 0.4656 in epoch 2
2024-08-15 17:35:37,557 : INFO : Current training batch loss: 0.3894 in epoch 2
2024-08-15 17:35:37,910 : INFO : Epoch finished, average loss over training batches: 0.5175
2024-08-15 17:35:37,911 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:37,911 : INFO : Training metrics:
2024-08-15 17:35:37,911 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:37,919 : INFO : Accuracy: 0.8340
2024-08-15 17:35:37,919 : INFO : Precision score for label_class 0: 0.8085
2024-08-15 17:35:37,919 : INFO : Precision score for label_class 1: 0.8783
2024-08-15 17:35:37,919 : INFO : Precision score for label_class 2: 0.7437
2024-08-15 17:35:37,919 : INFO : Recall score for label_class 0: 0.4634
2024-08-15 17:35:37,919 : INFO : Recall score for label_class 1: 0.9455
2024-08-15 17:35:37,919 : INFO : Recall score for label_class 2: 0.7610
2024-08-15 17:35:37,919 : INFO : Average F1 score: 0.7507
2024-08-15 17:35:38,386 : INFO : Average loss over validation batches: 0.4949
2024-08-15 17:35:38,386 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:38,386 : INFO : Validation metrics:
2024-08-15 17:35:38,386 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:38,389 : INFO : Accuracy: 0.8607
2024-08-15 17:35:38,389 : INFO : Precision score for label_class 0: 0.8193
2024-08-15 17:35:38,389 : INFO : Precision score for label_class 1: 0.8860
2024-08-15 17:35:38,389 : INFO : Precision score for label_class 2: 0.8148
2024-08-15 17:35:38,389 : INFO : Recall score for label_class 0: 0.7907
2024-08-15 17:35:38,389 : INFO : Recall score for label_class 1: 0.9181
2024-08-15 17:35:38,389 : INFO : Recall score for label_class 2: 0.7586
2024-08-15 17:35:38,389 : INFO : Average F1 score: 0.8307
2024-08-15 17:35:38,389 : INFO : Validation metric decreased (0.643131 --> 0.494895).  Saving model ...
2024-08-15 17:35:38,492 : INFO : Split 1 is finished, the score is: 0.8307
2024-08-15 17:35:38,492 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:38,492 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:38,492 : INFO : Starting training for split 2
2024-08-15 17:35:38,508 : INFO : Starting to tokenize the sequences.
2024-08-15 17:35:38,515 : INFO : Tokenization is finished.
2024-08-15 17:35:38,533 : INFO : Starting to tokenize the sequences.
2024-08-15 17:35:38,538 : INFO : Tokenization is finished.
2024-08-15 17:35:38,542 : INFO : Counting occurences of labels...
2024-08-15 17:35:38,543 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 343, 1601,  754]))
2024-08-15 17:35:38,544 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 71, 410, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:35:38,589 : INFO : Starting epoch 1
2024-08-15 17:35:38,641 : INFO : Current training batch loss: 1.0964 in epoch 1
2024-08-15 17:35:39,458 : INFO : Current training batch loss: 0.9667 in epoch 1
2024-08-15 17:35:40,281 : INFO : Current training batch loss: 0.7713 in epoch 1
2024-08-15 17:35:41,098 : INFO : Current training batch loss: 0.6291 in epoch 1
2024-08-15 17:35:41,915 : INFO : Current training batch loss: 0.5954 in epoch 1
2024-08-15 17:35:42,067 : INFO : Epoch finished, average loss over training batches: 0.7780
2024-08-15 17:35:42,067 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:42,067 : INFO : Training metrics:
2024-08-15 17:35:42,067 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:42,078 : INFO : Accuracy: 0.7005
2024-08-15 17:35:42,078 : INFO : Precision score for label_class 0: 0.6630
2024-08-15 17:35:42,078 : INFO : Precision score for label_class 1: 0.7185
2024-08-15 17:35:42,078 : INFO : Precision score for label_class 2: 0.6299
2024-08-15 17:35:42,078 : INFO : Recall score for label_class 0: 0.1778
2024-08-15 17:35:42,078 : INFO : Recall score for label_class 1: 0.9500
2024-08-15 17:35:42,078 : INFO : Recall score for label_class 2: 0.4085
2024-08-15 17:35:42,078 : INFO : Average F1 score: 0.5314
2024-08-15 17:35:42,548 : INFO : Average loss over validation batches: 0.5577
2024-08-15 17:35:42,548 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:42,548 : INFO : Validation metrics:
2024-08-15 17:35:42,548 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:42,552 : INFO : Accuracy: 0.8341
2024-08-15 17:35:42,552 : INFO : Precision score for label_class 0: 0.8000
2024-08-15 17:35:42,552 : INFO : Precision score for label_class 1: 0.8395
2024-08-15 17:35:42,552 : INFO : Precision score for label_class 2: 0.8293
2024-08-15 17:35:42,552 : INFO : Recall score for label_class 0: 0.5634
2024-08-15 17:35:42,552 : INFO : Recall score for label_class 1: 0.9439
2024-08-15 17:35:42,552 : INFO : Recall score for label_class 2: 0.7010
2024-08-15 17:35:42,552 : INFO : Average F1 score: 0.7699
2024-08-15 17:35:42,552 : INFO : Validation metric decreased (inf --> 0.557663).  Saving model ...
2024-08-15 17:35:42,650 : INFO : Starting epoch 2
2024-08-15 17:35:43,307 : INFO : Current training batch loss: 0.5568 in epoch 2
2024-08-15 17:35:44,124 : INFO : Current training batch loss: 0.5030 in epoch 2
2024-08-15 17:35:44,946 : INFO : Current training batch loss: 0.3638 in epoch 2
2024-08-15 17:35:45,764 : INFO : Current training batch loss: 0.3397 in epoch 2
2024-08-15 17:35:46,117 : INFO : Epoch finished, average loss over training batches: 0.4567
2024-08-15 17:35:46,118 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:46,118 : INFO : Training metrics:
2024-08-15 17:35:46,118 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:46,128 : INFO : Accuracy: 0.8669
2024-08-15 17:35:46,128 : INFO : Precision score for label_class 0: 0.8123
2024-08-15 17:35:46,128 : INFO : Precision score for label_class 1: 0.8868
2024-08-15 17:35:46,129 : INFO : Precision score for label_class 2: 0.8408
2024-08-15 17:35:46,129 : INFO : Recall score for label_class 0: 0.6939
2024-08-15 17:35:46,129 : INFO : Recall score for label_class 1: 0.9494
2024-08-15 17:35:46,129 : INFO : Recall score for label_class 2: 0.7706
2024-08-15 17:35:46,129 : INFO : Average F1 score: 0.8232
2024-08-15 17:35:46,598 : INFO : Average loss over validation batches: 0.4531
2024-08-15 17:35:46,598 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:46,598 : INFO : Validation metrics:
2024-08-15 17:35:46,598 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:46,602 : INFO : Accuracy: 0.8459
2024-08-15 17:35:46,602 : INFO : Precision score for label_class 0: 0.7206
2024-08-15 17:35:46,602 : INFO : Precision score for label_class 1: 0.8521
2024-08-15 17:35:46,602 : INFO : Precision score for label_class 2: 0.8831
2024-08-15 17:35:46,602 : INFO : Recall score for label_class 0: 0.6901
2024-08-15 17:35:46,602 : INFO : Recall score for label_class 1: 0.9415
2024-08-15 17:35:46,602 : INFO : Recall score for label_class 2: 0.7010
2024-08-15 17:35:46,602 : INFO : Average F1 score: 0.7937
2024-08-15 17:35:46,602 : INFO : Validation metric decreased (0.557663 --> 0.453101).  Saving model ...
2024-08-15 17:35:46,708 : INFO : Split 2 is finished, the score is: 0.7937
2024-08-15 17:35:46,708 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:46,708 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:46,708 : INFO : Starting training for split 3
2024-08-15 17:35:46,722 : INFO : Starting to tokenize the sequences.
2024-08-15 17:35:46,728 : INFO : Tokenization is finished.
2024-08-15 17:35:46,750 : INFO : Starting to tokenize the sequences.
2024-08-15 17:35:46,755 : INFO : Tokenization is finished.
2024-08-15 17:35:46,761 : INFO : Counting occurences of labels...
2024-08-15 17:35:46,762 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1611,  759]))
2024-08-15 17:35:46,762 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 400, 189]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:35:46,807 : INFO : Starting epoch 1
2024-08-15 17:35:46,858 : INFO : Current training batch loss: 1.0905 in epoch 1
2024-08-15 17:35:47,721 : INFO : Current training batch loss: 0.9733 in epoch 1
2024-08-15 17:35:48,572 : INFO : Current training batch loss: 0.7142 in epoch 1
2024-08-15 17:35:49,438 : INFO : Current training batch loss: 0.6698 in epoch 1
2024-08-15 17:35:50,301 : INFO : Current training batch loss: 0.5964 in epoch 1
2024-08-15 17:35:50,462 : INFO : Epoch finished, average loss over training batches: 0.7772
2024-08-15 17:35:50,462 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:50,462 : INFO : Training metrics:
2024-08-15 17:35:50,462 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:50,467 : INFO : Accuracy: 0.6894
2024-08-15 17:35:50,467 : INFO : Precision score for label_class 0: 0.1961
2024-08-15 17:35:50,467 : INFO : Precision score for label_class 1: 0.7260
2024-08-15 17:35:50,467 : INFO : Precision score for label_class 2: 0.6010
2024-08-15 17:35:50,467 : INFO : Recall score for label_class 0: 0.0305
2024-08-15 17:35:50,467 : INFO : Recall score for label_class 1: 0.9342
2024-08-15 17:35:50,467 : INFO : Recall score for label_class 2: 0.4545
2024-08-15 17:35:50,467 : INFO : Average F1 score: 0.4625
2024-08-15 17:35:50,934 : INFO : Average loss over validation batches: 0.5633
2024-08-15 17:35:50,935 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:50,935 : INFO : Validation metrics:
2024-08-15 17:35:50,935 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:50,937 : INFO : Accuracy: 0.7733
2024-08-15 17:35:50,937 : INFO : Precision score for label_class 0: 1.0000
2024-08-15 17:35:50,937 : INFO : Precision score for label_class 1: 0.8900
2024-08-15 17:35:50,937 : INFO : Precision score for label_class 2: 0.5925
2024-08-15 17:35:50,937 : INFO : Recall score for label_class 0: 0.0116
2024-08-15 17:35:50,937 : INFO : Recall score for label_class 1: 0.9100
2024-08-15 17:35:50,937 : INFO : Recall score for label_class 2: 0.8307
2024-08-15 17:35:50,937 : INFO : Average F1 score: 0.5382
2024-08-15 17:35:50,937 : INFO : Validation metric decreased (inf --> 0.563336).  Saving model ...
2024-08-15 17:35:51,041 : INFO : Starting epoch 2
2024-08-15 17:35:51,733 : INFO : Current training batch loss: 0.5686 in epoch 2
2024-08-15 17:35:52,596 : INFO : Current training batch loss: 0.4276 in epoch 2
2024-08-15 17:35:53,456 : INFO : Current training batch loss: 0.4183 in epoch 2
2024-08-15 17:35:54,317 : INFO : Current training batch loss: 0.2915 in epoch 2
2024-08-15 17:35:54,673 : INFO : Epoch finished, average loss over training batches: 0.4803
2024-08-15 17:35:54,673 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:54,673 : INFO : Training metrics:
2024-08-15 17:35:54,673 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:54,678 : INFO : Accuracy: 0.8510
2024-08-15 17:35:54,678 : INFO : Precision score for label_class 0: 0.7890
2024-08-15 17:35:54,678 : INFO : Precision score for label_class 1: 0.8786
2024-08-15 17:35:54,678 : INFO : Precision score for label_class 2: 0.8050
2024-08-15 17:35:54,678 : INFO : Recall score for label_class 0: 0.5701
2024-08-15 17:35:54,678 : INFO : Recall score for label_class 1: 0.9479
2024-08-15 17:35:54,678 : INFO : Recall score for label_class 2: 0.7668
2024-08-15 17:35:54,678 : INFO : Average F1 score: 0.7864
2024-08-15 17:35:55,151 : INFO : Average loss over validation batches: 0.4396
2024-08-15 17:35:55,151 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:55,151 : INFO : Validation metrics:
2024-08-15 17:35:55,151 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:55,154 : INFO : Accuracy: 0.8711
2024-08-15 17:35:55,154 : INFO : Precision score for label_class 0: 0.7765
2024-08-15 17:35:55,154 : INFO : Precision score for label_class 1: 0.8863
2024-08-15 17:35:55,154 : INFO : Precision score for label_class 2: 0.8805
2024-08-15 17:35:55,154 : INFO : Recall score for label_class 0: 0.7674
2024-08-15 17:35:55,154 : INFO : Recall score for label_class 1: 0.9550
2024-08-15 17:35:55,154 : INFO : Recall score for label_class 2: 0.7407
2024-08-15 17:35:55,154 : INFO : Average F1 score: 0.8320
2024-08-15 17:35:55,154 : INFO : Validation metric decreased (0.563336 --> 0.439572).  Saving model ...
2024-08-15 17:35:55,254 : INFO : Split 3 is finished, the score is: 0.8320
2024-08-15 17:35:55,254 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:55,254 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:55,254 : INFO : Starting training for split 4
2024-08-15 17:35:55,268 : INFO : Starting to tokenize the sequences.
2024-08-15 17:35:55,274 : INFO : Tokenization is finished.
2024-08-15 17:35:55,290 : INFO : Starting to tokenize the sequences.
2024-08-15 17:35:55,295 : INFO : Tokenization is finished.
2024-08-15 17:35:55,305 : INFO : Counting occurences of labels...
2024-08-15 17:35:55,306 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 327, 1621,  751]))
2024-08-15 17:35:55,306 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 87, 390, 197]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:35:55,418 : INFO : Starting epoch 1
2024-08-15 17:35:55,475 : INFO : Current training batch loss: 1.0868 in epoch 1
2024-08-15 17:35:56,299 : INFO : Current training batch loss: 0.9729 in epoch 1
2024-08-15 17:35:57,116 : INFO : Current training batch loss: 0.7388 in epoch 1
2024-08-15 17:35:57,935 : INFO : Current training batch loss: 0.5995 in epoch 1
2024-08-15 17:35:58,753 : INFO : Current training batch loss: 0.5359 in epoch 1
2024-08-15 17:35:58,905 : INFO : Epoch finished, average loss over training batches: 0.7786
2024-08-15 17:35:58,905 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:58,905 : INFO : Training metrics:
2024-08-15 17:35:58,905 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:58,913 : INFO : Accuracy: 0.6984
2024-08-15 17:35:58,913 : INFO : Precision score for label_class 0: 0.6154
2024-08-15 17:35:58,913 : INFO : Precision score for label_class 1: 0.7291
2024-08-15 17:35:58,913 : INFO : Precision score for label_class 2: 0.5860
2024-08-15 17:35:58,913 : INFO : Recall score for label_class 0: 0.0489
2024-08-15 17:35:58,913 : INFO : Recall score for label_class 1: 0.9513
2024-08-15 17:35:58,913 : INFO : Recall score for label_class 2: 0.4354
2024-08-15 17:35:58,913 : INFO : Average F1 score: 0.4719
2024-08-15 17:35:59,380 : INFO : Average loss over validation batches: 0.5683
2024-08-15 17:35:59,380 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:59,380 : INFO : Validation metrics:
2024-08-15 17:35:59,380 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:35:59,383 : INFO : Accuracy: 0.8116
2024-08-15 17:35:59,383 : INFO : Precision score for label_class 0: 0.7234
2024-08-15 17:35:59,383 : INFO : Precision score for label_class 1: 0.8500
2024-08-15 17:35:59,383 : INFO : Precision score for label_class 2: 0.7433
2024-08-15 17:35:59,383 : INFO : Recall score for label_class 0: 0.3908
2024-08-15 17:35:59,383 : INFO : Recall score for label_class 1: 0.9590
2024-08-15 17:35:59,383 : INFO : Recall score for label_class 2: 0.7056
2024-08-15 17:35:59,383 : INFO : Average F1 score: 0.7109
2024-08-15 17:35:59,383 : INFO : Validation metric decreased (inf --> 0.568337).  Saving model ...
2024-08-15 17:35:59,495 : INFO : Starting epoch 2
2024-08-15 17:36:00,151 : INFO : Current training batch loss: 0.5432 in epoch 2
2024-08-15 17:36:00,981 : INFO : Current training batch loss: 0.4145 in epoch 2
2024-08-15 17:36:01,798 : INFO : Current training batch loss: 0.3249 in epoch 2
2024-08-15 17:36:02,615 : INFO : Current training batch loss: 0.3612 in epoch 2
2024-08-15 17:36:02,968 : INFO : Epoch finished, average loss over training batches: 0.4530
2024-08-15 17:36:02,969 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:02,969 : INFO : Training metrics:
2024-08-15 17:36:02,969 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:02,972 : INFO : Accuracy: 0.8711
2024-08-15 17:36:02,973 : INFO : Precision score for label_class 0: 0.8062
2024-08-15 17:36:02,973 : INFO : Precision score for label_class 1: 0.8921
2024-08-15 17:36:02,973 : INFO : Precision score for label_class 2: 0.8463
2024-08-15 17:36:02,973 : INFO : Recall score for label_class 0: 0.7125
2024-08-15 17:36:02,973 : INFO : Recall score for label_class 1: 0.9432
2024-08-15 17:36:02,973 : INFO : Recall score for label_class 2: 0.7843
2024-08-15 17:36:02,973 : INFO : Average F1 score: 0.8292
2024-08-15 17:36:03,440 : INFO : Average loss over validation batches: 0.4450
2024-08-15 17:36:03,440 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:03,440 : INFO : Validation metrics:
2024-08-15 17:36:03,440 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:03,443 : INFO : Accuracy: 0.8531
2024-08-15 17:36:03,443 : INFO : Precision score for label_class 0: 0.7083
2024-08-15 17:36:03,443 : INFO : Precision score for label_class 1: 0.8914
2024-08-15 17:36:03,443 : INFO : Precision score for label_class 2: 0.8439
2024-08-15 17:36:03,443 : INFO : Recall score for label_class 0: 0.7816
2024-08-15 17:36:03,443 : INFO : Recall score for label_class 1: 0.9256
2024-08-15 17:36:03,443 : INFO : Recall score for label_class 2: 0.7411
2024-08-15 17:36:03,443 : INFO : Average F1 score: 0.8135
2024-08-15 17:36:03,443 : INFO : Validation metric decreased (0.568337 --> 0.445038).  Saving model ...
2024-08-15 17:36:03,546 : INFO : Split 4 is finished, the score is: 0.8135
2024-08-15 17:36:03,546 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:03,546 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:03,546 : INFO : Starting training for split 5
2024-08-15 17:36:03,560 : INFO : Starting to tokenize the sequences.
2024-08-15 17:36:03,565 : INFO : Tokenization is finished.
2024-08-15 17:36:03,582 : INFO : Starting to tokenize the sequences.
2024-08-15 17:36:03,587 : INFO : Tokenization is finished.
2024-08-15 17:36:03,592 : INFO : Counting occurences of labels...
2024-08-15 17:36:03,593 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 330, 1615,  754]))
2024-08-15 17:36:03,593 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 84, 396, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:36:03,636 : INFO : Starting epoch 1
2024-08-15 17:36:03,687 : INFO : Current training batch loss: 1.1314 in epoch 1
2024-08-15 17:36:04,505 : INFO : Current training batch loss: 0.9835 in epoch 1
2024-08-15 17:36:05,322 : INFO : Current training batch loss: 0.7271 in epoch 1
2024-08-15 17:36:06,139 : INFO : Current training batch loss: 0.6340 in epoch 1
2024-08-15 17:36:06,958 : INFO : Current training batch loss: 0.6540 in epoch 1
2024-08-15 17:36:07,114 : INFO : Epoch finished, average loss over training batches: 0.8036
2024-08-15 17:36:07,114 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:07,114 : INFO : Training metrics:
2024-08-15 17:36:07,114 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:07,125 : INFO : Accuracy: 0.6614
2024-08-15 17:36:07,125 : INFO : Precision score for label_class 0: 0.8000
2024-08-15 17:36:07,125 : INFO : Precision score for label_class 1: 0.7198
2024-08-15 17:36:07,125 : INFO : Precision score for label_class 2: 0.4875
2024-08-15 17:36:07,125 : INFO : Recall score for label_class 0: 0.0121
2024-08-15 17:36:07,125 : INFO : Recall score for label_class 1: 0.8972
2024-08-15 17:36:07,125 : INFO : Recall score for label_class 2: 0.4403
2024-08-15 17:36:07,125 : INFO : Average F1 score: 0.4285
2024-08-15 17:36:07,592 : INFO : Average loss over validation batches: 0.6454
2024-08-15 17:36:07,592 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:07,592 : INFO : Validation metrics:
2024-08-15 17:36:07,592 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:07,596 : INFO : Accuracy: 0.7077
2024-08-15 17:36:07,596 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:36:07,596 : INFO : Precision score for label_class 1: 0.8212
2024-08-15 17:36:07,596 : INFO : Precision score for label_class 2: 0.5141
2024-08-15 17:36:07,596 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:36:07,596 : INFO : Recall score for label_class 1: 0.8813
2024-08-15 17:36:07,596 : INFO : Recall score for label_class 2: 0.6598
2024-08-15 17:36:07,596 : INFO : Average F1 score: 0.4760
2024-08-15 17:36:07,596 : INFO : Validation metric decreased (inf --> 0.645392).  Saving model ...
2024-08-15 17:36:07,700 : INFO : Starting epoch 2
2024-08-15 17:36:08,356 : INFO : Current training batch loss: 0.6705 in epoch 2
2024-08-15 17:36:09,173 : INFO : Current training batch loss: 0.4435 in epoch 2
2024-08-15 17:36:09,990 : INFO : Current training batch loss: 0.3877 in epoch 2
2024-08-15 17:36:10,894 : INFO : Current training batch loss: 0.5006 in epoch 2
2024-08-15 17:36:11,248 : INFO : Epoch finished, average loss over training batches: 0.5279
2024-08-15 17:36:11,248 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:11,248 : INFO : Training metrics:
2024-08-15 17:36:11,248 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:11,259 : INFO : Accuracy: 0.8310
2024-08-15 17:36:11,259 : INFO : Precision score for label_class 0: 0.7823
2024-08-15 17:36:11,259 : INFO : Precision score for label_class 1: 0.8662
2024-08-15 17:36:11,259 : INFO : Precision score for label_class 2: 0.7597
2024-08-15 17:36:11,259 : INFO : Recall score for label_class 0: 0.5879
2024-08-15 17:36:11,259 : INFO : Recall score for label_class 1: 0.9418
2024-08-15 17:36:11,259 : INFO : Recall score for label_class 2: 0.7003
2024-08-15 17:36:11,259 : INFO : Average F1 score: 0.7675
2024-08-15 17:36:11,726 : INFO : Average loss over validation batches: 0.5056
2024-08-15 17:36:11,726 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:11,726 : INFO : Validation metrics:
2024-08-15 17:36:11,726 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:11,729 : INFO : Accuracy: 0.8234
2024-08-15 17:36:11,729 : INFO : Precision score for label_class 0: 0.7222
2024-08-15 17:36:11,729 : INFO : Precision score for label_class 1: 0.8818
2024-08-15 17:36:11,729 : INFO : Precision score for label_class 2: 0.7398
2024-08-15 17:36:11,729 : INFO : Recall score for label_class 0: 0.6190
2024-08-15 17:36:11,729 : INFO : Recall score for label_class 1: 0.9040
2024-08-15 17:36:11,729 : INFO : Recall score for label_class 2: 0.7474
2024-08-15 17:36:11,729 : INFO : Average F1 score: 0.7677
2024-08-15 17:36:11,729 : INFO : Validation metric decreased (0.645392 --> 0.505617).  Saving model ...
2024-08-15 17:36:11,834 : INFO : Split 5 is finished, the score is: 0.7677
2024-08-15 17:36:11,834 : INFO : ----------------------------------------------------------------------------------------------------
[I 2024-08-15 17:36:11,843] Trial 16 finished with value: 0.8075255441515976 and parameters: {'n_epochs': 2, 'learning_rate': 5.8321775660558034e-05, 'classifier_dropout': 0.7579486157348764, 'warmup_step_fraction': 0.027184273812942014, 'use_gradient_clipping': True}. Best is trial 1 with value: 0.8513001269595835.
2024-08-15 17:36:11,852 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:11,852 : INFO : Starting training for split 1
2024-08-15 17:36:11,866 : INFO : Starting to tokenize the sequences.
2024-08-15 17:36:11,871 : INFO : Tokenization is finished.
2024-08-15 17:36:11,884 : INFO : Starting to tokenize the sequences.
2024-08-15 17:36:11,889 : INFO : Tokenization is finished.
2024-08-15 17:36:11,889 : INFO : Counting occurences of labels...
2024-08-15 17:36:11,890 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1596,  774]))
2024-08-15 17:36:11,890 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 415, 174]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:36:11,930 : INFO : Starting epoch 1
2024-08-15 17:36:11,981 : INFO : Current training batch loss: 1.1196 in epoch 1
2024-08-15 17:36:12,795 : INFO : Current training batch loss: 0.9736 in epoch 1
2024-08-15 17:36:13,610 : INFO : Current training batch loss: 0.9488 in epoch 1
2024-08-15 17:36:14,424 : INFO : Current training batch loss: 0.7258 in epoch 1
2024-08-15 17:36:15,239 : INFO : Current training batch loss: 0.7256 in epoch 1
2024-08-15 17:36:15,389 : INFO : Epoch finished, average loss over training batches: 0.8830
2024-08-15 17:36:15,389 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:15,389 : INFO : Training metrics:
2024-08-15 17:36:15,389 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:15,397 : INFO : Accuracy: 0.5975
2024-08-15 17:36:15,397 : INFO : Precision score for label_class 0: 0.1254
2024-08-15 17:36:15,397 : INFO : Precision score for label_class 1: 0.6760
2024-08-15 17:36:15,397 : INFO : Precision score for label_class 2: 0.5310
2024-08-15 17:36:15,397 : INFO : Recall score for label_class 0: 0.1098
2024-08-15 17:36:15,397 : INFO : Recall score for label_class 1: 0.8640
2024-08-15 17:36:15,397 : INFO : Recall score for label_class 2: 0.2545
2024-08-15 17:36:15,397 : INFO : Average F1 score: 0.4066
2024-08-15 17:36:15,864 : INFO : Average loss over validation batches: 0.6970
2024-08-15 17:36:15,864 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:15,864 : INFO : Validation metrics:
2024-08-15 17:36:15,864 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:15,867 : INFO : Accuracy: 0.7156
2024-08-15 17:36:15,867 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:36:15,867 : INFO : Precision score for label_class 1: 0.8252
2024-08-15 17:36:15,867 : INFO : Precision score for label_class 2: 0.4933
2024-08-15 17:36:15,867 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:36:15,867 : INFO : Recall score for label_class 1: 0.8988
2024-08-15 17:36:15,867 : INFO : Recall score for label_class 2: 0.6322
2024-08-15 17:36:15,867 : INFO : Average F1 score: 0.4715
2024-08-15 17:36:15,867 : INFO : Validation metric decreased (inf --> 0.696963).  Saving model ...
2024-08-15 17:36:15,970 : INFO : Starting epoch 2
2024-08-15 17:36:16,624 : INFO : Current training batch loss: 0.3768 in epoch 2
2024-08-15 17:36:17,438 : INFO : Current training batch loss: 0.6566 in epoch 2
2024-08-15 17:36:18,252 : INFO : Current training batch loss: 0.4150 in epoch 2
2024-08-15 17:36:19,067 : INFO : Current training batch loss: 0.3453 in epoch 2
2024-08-15 17:36:19,418 : INFO : Epoch finished, average loss over training batches: 0.5184
2024-08-15 17:36:19,419 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:19,419 : INFO : Training metrics:
2024-08-15 17:36:19,419 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:19,427 : INFO : Accuracy: 0.8058
2024-08-15 17:36:19,427 : INFO : Precision score for label_class 0: 0.7514
2024-08-15 17:36:19,427 : INFO : Precision score for label_class 1: 0.8621
2024-08-15 17:36:19,427 : INFO : Precision score for label_class 2: 0.6986
2024-08-15 17:36:19,427 : INFO : Recall score for label_class 0: 0.3963
2024-08-15 17:36:19,427 : INFO : Recall score for label_class 1: 0.9248
2024-08-15 17:36:19,427 : INFO : Recall score for label_class 2: 0.7339
2024-08-15 17:36:19,427 : INFO : Average F1 score: 0.7091
2024-08-15 17:36:19,894 : INFO : Average loss over validation batches: 0.4027
2024-08-15 17:36:19,894 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:19,894 : INFO : Validation metrics:
2024-08-15 17:36:19,894 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:19,896 : INFO : Accuracy: 0.8474
2024-08-15 17:36:19,897 : INFO : Precision score for label_class 0: 0.8000
2024-08-15 17:36:19,897 : INFO : Precision score for label_class 1: 0.9273
2024-08-15 17:36:19,897 : INFO : Precision score for label_class 2: 0.7171
2024-08-15 17:36:19,897 : INFO : Recall score for label_class 0: 0.7907
2024-08-15 17:36:19,897 : INFO : Recall score for label_class 1: 0.8602
2024-08-15 17:36:19,897 : INFO : Recall score for label_class 2: 0.8448
2024-08-15 17:36:19,897 : INFO : Average F1 score: 0.8212
2024-08-15 17:36:19,897 : INFO : Validation metric decreased (0.696963 --> 0.402743).  Saving model ...
2024-08-15 17:36:20,000 : INFO : Starting epoch 3
2024-08-15 17:36:20,453 : INFO : Current training batch loss: 0.3359 in epoch 3
2024-08-15 17:36:21,267 : INFO : Current training batch loss: 0.3453 in epoch 3
2024-08-15 17:36:22,084 : INFO : Current training batch loss: 0.2562 in epoch 3
2024-08-15 17:36:22,899 : INFO : Current training batch loss: 0.1138 in epoch 3
2024-08-15 17:36:23,451 : INFO : Epoch finished, average loss over training batches: 0.2876
2024-08-15 17:36:23,451 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:23,451 : INFO : Training metrics:
2024-08-15 17:36:23,451 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:23,459 : INFO : Accuracy: 0.9081
2024-08-15 17:36:23,459 : INFO : Precision score for label_class 0: 0.8143
2024-08-15 17:36:23,459 : INFO : Precision score for label_class 1: 0.9344
2024-08-15 17:36:23,459 : INFO : Precision score for label_class 2: 0.8948
2024-08-15 17:36:23,459 : INFO : Recall score for label_class 0: 0.8689
2024-08-15 17:36:23,459 : INFO : Recall score for label_class 1: 0.9461
2024-08-15 17:36:23,459 : INFO : Recall score for label_class 2: 0.8463
2024-08-15 17:36:23,459 : INFO : Average F1 score: 0.8836
2024-08-15 17:36:23,928 : INFO : Average loss over validation batches: 0.3431
2024-08-15 17:36:23,928 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:23,928 : INFO : Validation metrics:
2024-08-15 17:36:23,928 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:23,931 : INFO : Accuracy: 0.8756
2024-08-15 17:36:23,931 : INFO : Precision score for label_class 0: 0.7647
2024-08-15 17:36:23,932 : INFO : Precision score for label_class 1: 0.8998
2024-08-15 17:36:23,932 : INFO : Precision score for label_class 2: 0.8819
2024-08-15 17:36:23,932 : INFO : Recall score for label_class 0: 0.9070
2024-08-15 17:36:23,932 : INFO : Recall score for label_class 1: 0.9301
2024-08-15 17:36:23,932 : INFO : Recall score for label_class 2: 0.7299
2024-08-15 17:36:23,932 : INFO : Average F1 score: 0.8477
2024-08-15 17:36:23,932 : INFO : Validation metric decreased (0.402743 --> 0.343140).  Saving model ...
2024-08-15 17:36:24,034 : INFO : Starting epoch 4
2024-08-15 17:36:24,286 : INFO : Current training batch loss: 0.4445 in epoch 4
2024-08-15 17:36:25,100 : INFO : Current training batch loss: 0.1940 in epoch 4
2024-08-15 17:36:25,915 : INFO : Current training batch loss: 0.2949 in epoch 4
2024-08-15 17:36:26,729 : INFO : Current training batch loss: 0.1801 in epoch 4
2024-08-15 17:36:27,486 : INFO : Epoch finished, average loss over training batches: 0.1760
2024-08-15 17:36:27,486 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:27,486 : INFO : Training metrics:
2024-08-15 17:36:27,486 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:27,491 : INFO : Accuracy: 0.9474
2024-08-15 17:36:27,491 : INFO : Precision score for label_class 0: 0.8746
2024-08-15 17:36:27,491 : INFO : Precision score for label_class 1: 0.9674
2024-08-15 17:36:27,491 : INFO : Precision score for label_class 2: 0.9387
2024-08-15 17:36:27,491 : INFO : Recall score for label_class 0: 0.9360
2024-08-15 17:36:27,491 : INFO : Recall score for label_class 1: 0.9674
2024-08-15 17:36:27,491 : INFO : Recall score for label_class 2: 0.9109
2024-08-15 17:36:27,491 : INFO : Average F1 score: 0.9321
2024-08-15 17:36:27,959 : INFO : Average loss over validation batches: 0.3647
2024-08-15 17:36:27,959 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:27,959 : INFO : Validation metrics:
2024-08-15 17:36:27,959 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:27,962 : INFO : Accuracy: 0.8681
2024-08-15 17:36:27,962 : INFO : Precision score for label_class 0: 0.7549
2024-08-15 17:36:27,962 : INFO : Precision score for label_class 1: 0.9356
2024-08-15 17:36:27,962 : INFO : Precision score for label_class 2: 0.7892
2024-08-15 17:36:27,962 : INFO : Recall score for label_class 0: 0.8953
2024-08-15 17:36:27,962 : INFO : Recall score for label_class 1: 0.8747
2024-08-15 17:36:27,962 : INFO : Recall score for label_class 2: 0.8391
2024-08-15 17:36:27,962 : INFO : Average F1 score: 0.8455
2024-08-15 17:36:27,962 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:36:27,962 : INFO : Starting epoch 5
2024-08-15 17:36:28,013 : INFO : Current training batch loss: 0.0671 in epoch 5
2024-08-15 17:36:28,827 : INFO : Current training batch loss: 0.1883 in epoch 5
2024-08-15 17:36:29,649 : INFO : Current training batch loss: 0.0492 in epoch 5
2024-08-15 17:36:30,464 : INFO : Current training batch loss: 0.1694 in epoch 5
2024-08-15 17:36:31,279 : INFO : Current training batch loss: 0.1484 in epoch 5
2024-08-15 17:36:31,430 : INFO : Epoch finished, average loss over training batches: 0.1162
2024-08-15 17:36:31,431 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:31,431 : INFO : Training metrics:
2024-08-15 17:36:31,431 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:31,435 : INFO : Accuracy: 0.9703
2024-08-15 17:36:31,436 : INFO : Precision score for label_class 0: 0.9091
2024-08-15 17:36:31,436 : INFO : Precision score for label_class 1: 0.9801
2024-08-15 17:36:31,436 : INFO : Precision score for label_class 2: 0.9784
2024-08-15 17:36:31,436 : INFO : Recall score for label_class 0: 0.9756
2024-08-15 17:36:31,436 : INFO : Recall score for label_class 1: 0.9856
2024-08-15 17:36:31,436 : INFO : Recall score for label_class 2: 0.9367
2024-08-15 17:36:31,436 : INFO : Average F1 score: 0.9604
2024-08-15 17:36:31,901 : INFO : Average loss over validation batches: 0.3472
2024-08-15 17:36:31,901 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:31,901 : INFO : Validation metrics:
2024-08-15 17:36:31,901 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:31,904 : INFO : Accuracy: 0.8785
2024-08-15 17:36:31,904 : INFO : Precision score for label_class 0: 0.7273
2024-08-15 17:36:31,904 : INFO : Precision score for label_class 1: 0.9459
2024-08-15 17:36:31,904 : INFO : Precision score for label_class 2: 0.8249
2024-08-15 17:36:31,904 : INFO : Recall score for label_class 0: 0.9302
2024-08-15 17:36:31,904 : INFO : Recall score for label_class 1: 0.8843
2024-08-15 17:36:31,904 : INFO : Recall score for label_class 2: 0.8391
2024-08-15 17:36:31,904 : INFO : Average F1 score: 0.8541
2024-08-15 17:36:31,904 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:36:31,904 : INFO : Starting epoch 6
2024-08-15 17:36:32,564 : INFO : Current training batch loss: 0.0404 in epoch 6
2024-08-15 17:36:33,393 : INFO : Current training batch loss: 0.0727 in epoch 6
2024-08-15 17:36:34,226 : INFO : Current training batch loss: 0.2079 in epoch 6
2024-08-15 17:36:35,042 : INFO : Current training batch loss: 0.0286 in epoch 6
2024-08-15 17:36:35,385 : INFO : Epoch finished, average loss over training batches: 0.0852
2024-08-15 17:36:35,385 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:35,386 : INFO : Training metrics:
2024-08-15 17:36:35,386 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:35,395 : INFO : Accuracy: 0.9781
2024-08-15 17:36:35,395 : INFO : Precision score for label_class 0: 0.9335
2024-08-15 17:36:35,395 : INFO : Precision score for label_class 1: 0.9862
2024-08-15 17:36:35,395 : INFO : Precision score for label_class 2: 0.9814
2024-08-15 17:36:35,395 : INFO : Recall score for label_class 0: 0.9848
2024-08-15 17:36:35,395 : INFO : Recall score for label_class 1: 0.9881
2024-08-15 17:36:35,395 : INFO : Recall score for label_class 2: 0.9548
2024-08-15 17:36:35,395 : INFO : Average F1 score: 0.9712
2024-08-15 17:36:35,861 : INFO : Average loss over validation batches: 0.3897
2024-08-15 17:36:35,861 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:35,861 : INFO : Validation metrics:
2024-08-15 17:36:35,861 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:35,865 : INFO : Accuracy: 0.8726
2024-08-15 17:36:35,865 : INFO : Precision score for label_class 0: 0.7524
2024-08-15 17:36:35,865 : INFO : Precision score for label_class 1: 0.8956
2024-08-15 17:36:35,865 : INFO : Precision score for label_class 2: 0.8921
2024-08-15 17:36:35,865 : INFO : Recall score for label_class 0: 0.9186
2024-08-15 17:36:35,865 : INFO : Recall score for label_class 1: 0.9301
2024-08-15 17:36:35,865 : INFO : Recall score for label_class 2: 0.7126
2024-08-15 17:36:35,865 : INFO : Average F1 score: 0.8440
2024-08-15 17:36:35,865 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:36:35,865 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:36:35,896 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:36:36,394 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:36,394 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:36:36,394 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:36,398 : INFO : Accuracy: 0.8756
2024-08-15 17:36:36,398 : INFO : Precision score for label_class 0: 0.7647
2024-08-15 17:36:36,398 : INFO : Precision score for label_class 1: 0.8998
2024-08-15 17:36:36,398 : INFO : Precision score for label_class 2: 0.8819
2024-08-15 17:36:36,398 : INFO : Recall score for label_class 0: 0.9070
2024-08-15 17:36:36,398 : INFO : Recall score for label_class 1: 0.9301
2024-08-15 17:36:36,398 : INFO : Recall score for label_class 2: 0.7299
2024-08-15 17:36:36,398 : INFO : Average F1 score: 0.8477
2024-08-15 17:36:36,398 : INFO : Determined score from best model, ending training.
2024-08-15 17:36:36,399 : INFO : Split 1 is finished, the score is: 0.8477
2024-08-15 17:36:36,399 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:36,399 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:36,399 : INFO : Starting training for split 2
2024-08-15 17:36:36,412 : INFO : Starting to tokenize the sequences.
2024-08-15 17:36:36,418 : INFO : Tokenization is finished.
2024-08-15 17:36:36,441 : INFO : Starting to tokenize the sequences.
2024-08-15 17:36:36,446 : INFO : Tokenization is finished.
2024-08-15 17:36:36,451 : INFO : Counting occurences of labels...
2024-08-15 17:36:36,452 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 343, 1601,  754]))
2024-08-15 17:36:36,453 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 71, 410, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:36:36,496 : INFO : Starting epoch 1
2024-08-15 17:36:36,547 : INFO : Current training batch loss: 1.0909 in epoch 1
2024-08-15 17:36:37,362 : INFO : Current training batch loss: 1.0256 in epoch 1
2024-08-15 17:36:38,183 : INFO : Current training batch loss: 0.9035 in epoch 1
2024-08-15 17:36:39,003 : INFO : Current training batch loss: 0.6542 in epoch 1
2024-08-15 17:36:39,813 : INFO : Current training batch loss: 0.6214 in epoch 1
2024-08-15 17:36:39,955 : INFO : Epoch finished, average loss over training batches: 0.8461
2024-08-15 17:36:39,956 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:39,956 : INFO : Training metrics:
2024-08-15 17:36:39,956 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:39,965 : INFO : Accuracy: 0.6616
2024-08-15 17:36:39,965 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:36:39,965 : INFO : Precision score for label_class 1: 0.6874
2024-08-15 17:36:39,965 : INFO : Precision score for label_class 2: 0.5411
2024-08-15 17:36:39,965 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:36:39,965 : INFO : Recall score for label_class 1: 0.9544
2024-08-15 17:36:39,965 : INFO : Recall score for label_class 2: 0.3408
2024-08-15 17:36:39,965 : INFO : Average F1 score: 0.4058
2024-08-15 17:36:40,434 : INFO : Average loss over validation batches: 0.5606
2024-08-15 17:36:40,435 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:40,435 : INFO : Validation metrics:
2024-08-15 17:36:40,435 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:40,439 : INFO : Accuracy: 0.7852
2024-08-15 17:36:40,439 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:36:40,439 : INFO : Precision score for label_class 1: 0.8453
2024-08-15 17:36:40,439 : INFO : Precision score for label_class 2: 0.6574
2024-08-15 17:36:40,439 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:36:40,439 : INFO : Recall score for label_class 1: 0.9463
2024-08-15 17:36:40,439 : INFO : Recall score for label_class 2: 0.7320
2024-08-15 17:36:40,439 : INFO : Average F1 score: 0.5286
2024-08-15 17:36:40,439 : INFO : Validation metric decreased (inf --> 0.560643).  Saving model ...
2024-08-15 17:36:40,538 : INFO : Starting epoch 2
2024-08-15 17:36:41,194 : INFO : Current training batch loss: 0.5688 in epoch 2
2024-08-15 17:36:42,019 : INFO : Current training batch loss: 0.4706 in epoch 2
2024-08-15 17:36:42,853 : INFO : Current training batch loss: 0.2902 in epoch 2
2024-08-15 17:36:43,690 : INFO : Current training batch loss: 0.3201 in epoch 2
2024-08-15 17:36:44,039 : INFO : Epoch finished, average loss over training batches: 0.4128
2024-08-15 17:36:44,039 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:44,039 : INFO : Training metrics:
2024-08-15 17:36:44,039 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:44,048 : INFO : Accuracy: 0.8599
2024-08-15 17:36:44,048 : INFO : Precision score for label_class 0: 0.7717
2024-08-15 17:36:44,048 : INFO : Precision score for label_class 1: 0.8956
2024-08-15 17:36:44,048 : INFO : Precision score for label_class 2: 0.8141
2024-08-15 17:36:44,048 : INFO : Recall score for label_class 0: 0.6997
2024-08-15 17:36:44,048 : INFO : Recall score for label_class 1: 0.9382
2024-08-15 17:36:44,048 : INFO : Recall score for label_class 2: 0.7666
2024-08-15 17:36:44,048 : INFO : Average F1 score: 0.8133
2024-08-15 17:36:44,518 : INFO : Average loss over validation batches: 0.3844
2024-08-15 17:36:44,518 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:44,518 : INFO : Validation metrics:
2024-08-15 17:36:44,518 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:44,521 : INFO : Accuracy: 0.8637
2024-08-15 17:36:44,521 : INFO : Precision score for label_class 0: 0.7079
2024-08-15 17:36:44,521 : INFO : Precision score for label_class 1: 0.9146
2024-08-15 17:36:44,521 : INFO : Precision score for label_class 2: 0.8298
2024-08-15 17:36:44,521 : INFO : Recall score for label_class 0: 0.8873
2024-08-15 17:36:44,521 : INFO : Recall score for label_class 1: 0.8878
2024-08-15 17:36:44,521 : INFO : Recall score for label_class 2: 0.8041
2024-08-15 17:36:44,521 : INFO : Average F1 score: 0.8351
2024-08-15 17:36:44,521 : INFO : Validation metric decreased (0.560643 --> 0.384373).  Saving model ...
2024-08-15 17:36:44,623 : INFO : Starting epoch 3
2024-08-15 17:36:45,093 : INFO : Current training batch loss: 0.2956 in epoch 3
2024-08-15 17:36:45,935 : INFO : Current training batch loss: 0.2931 in epoch 3
2024-08-15 17:36:46,778 : INFO : Current training batch loss: 0.2234 in epoch 3
2024-08-15 17:36:47,626 : INFO : Current training batch loss: 0.0562 in epoch 3
2024-08-15 17:36:48,192 : INFO : Epoch finished, average loss over training batches: 0.2326
2024-08-15 17:36:48,192 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:48,192 : INFO : Training metrics:
2024-08-15 17:36:48,192 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:48,200 : INFO : Accuracy: 0.9270
2024-08-15 17:36:48,200 : INFO : Precision score for label_class 0: 0.8428
2024-08-15 17:36:48,200 : INFO : Precision score for label_class 1: 0.9539
2024-08-15 17:36:48,200 : INFO : Precision score for label_class 2: 0.9102
2024-08-15 17:36:48,200 : INFO : Recall score for label_class 0: 0.9067
2024-08-15 17:36:48,200 : INFO : Recall score for label_class 1: 0.9563
2024-08-15 17:36:48,200 : INFO : Recall score for label_class 2: 0.8740
2024-08-15 17:36:48,200 : INFO : Average F1 score: 0.9068
2024-08-15 17:36:48,668 : INFO : Average loss over validation batches: 0.3940
2024-08-15 17:36:48,668 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:48,668 : INFO : Validation metrics:
2024-08-15 17:36:48,668 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:48,671 : INFO : Accuracy: 0.8637
2024-08-15 17:36:48,671 : INFO : Precision score for label_class 0: 0.8136
2024-08-15 17:36:48,671 : INFO : Precision score for label_class 1: 0.8879
2024-08-15 17:36:48,671 : INFO : Precision score for label_class 2: 0.8245
2024-08-15 17:36:48,671 : INFO : Recall score for label_class 0: 0.6761
2024-08-15 17:36:48,671 : INFO : Recall score for label_class 1: 0.9268
2024-08-15 17:36:48,671 : INFO : Recall score for label_class 2: 0.7990
2024-08-15 17:36:48,671 : INFO : Average F1 score: 0.8190
2024-08-15 17:36:48,671 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:36:48,671 : INFO : Starting epoch 4
2024-08-15 17:36:48,923 : INFO : Current training batch loss: 0.2704 in epoch 4
2024-08-15 17:36:49,738 : INFO : Current training batch loss: 0.0833 in epoch 4
2024-08-15 17:36:50,552 : INFO : Current training batch loss: 0.1729 in epoch 4
2024-08-15 17:36:51,368 : INFO : Current training batch loss: 0.1355 in epoch 4
2024-08-15 17:36:52,121 : INFO : Epoch finished, average loss over training batches: 0.1450
2024-08-15 17:36:52,122 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:52,122 : INFO : Training metrics:
2024-08-15 17:36:52,122 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:52,129 : INFO : Accuracy: 0.9577
2024-08-15 17:36:52,129 : INFO : Precision score for label_class 0: 0.8989
2024-08-15 17:36:52,129 : INFO : Precision score for label_class 1: 0.9726
2024-08-15 17:36:52,129 : INFO : Precision score for label_class 2: 0.9537
2024-08-15 17:36:52,129 : INFO : Recall score for label_class 0: 0.9329
2024-08-15 17:36:52,129 : INFO : Recall score for label_class 1: 0.9769
2024-08-15 17:36:52,129 : INFO : Recall score for label_class 2: 0.9284
2024-08-15 17:36:52,129 : INFO : Average F1 score: 0.9437
2024-08-15 17:36:52,596 : INFO : Average loss over validation batches: 0.4153
2024-08-15 17:36:52,596 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:52,596 : INFO : Validation metrics:
2024-08-15 17:36:52,596 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:52,600 : INFO : Accuracy: 0.8622
2024-08-15 17:36:52,600 : INFO : Precision score for label_class 0: 0.7407
2024-08-15 17:36:52,600 : INFO : Precision score for label_class 1: 0.9137
2024-08-15 17:36:52,600 : INFO : Precision score for label_class 2: 0.8100
2024-08-15 17:36:52,600 : INFO : Recall score for label_class 0: 0.8451
2024-08-15 17:36:52,600 : INFO : Recall score for label_class 1: 0.8780
2024-08-15 17:36:52,600 : INFO : Recall score for label_class 2: 0.8351
2024-08-15 17:36:52,600 : INFO : Average F1 score: 0.8358
2024-08-15 17:36:52,600 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:36:52,600 : INFO : Starting epoch 5
2024-08-15 17:36:52,650 : INFO : Current training batch loss: 0.1124 in epoch 5
2024-08-15 17:36:53,465 : INFO : Current training batch loss: 0.0929 in epoch 5
2024-08-15 17:36:54,280 : INFO : Current training batch loss: 0.0274 in epoch 5
2024-08-15 17:36:55,096 : INFO : Current training batch loss: 0.0321 in epoch 5
2024-08-15 17:36:55,916 : INFO : Current training batch loss: 0.0971 in epoch 5
2024-08-15 17:36:56,067 : INFO : Epoch finished, average loss over training batches: 0.0895
2024-08-15 17:36:56,067 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:56,067 : INFO : Training metrics:
2024-08-15 17:36:56,067 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:56,077 : INFO : Accuracy: 0.9748
2024-08-15 17:36:56,077 : INFO : Precision score for label_class 0: 0.9320
2024-08-15 17:36:56,077 : INFO : Precision score for label_class 1: 0.9844
2024-08-15 17:36:56,077 : INFO : Precision score for label_class 2: 0.9744
2024-08-15 17:36:56,077 : INFO : Recall score for label_class 0: 0.9592
2024-08-15 17:36:56,077 : INFO : Recall score for label_class 1: 0.9856
2024-08-15 17:36:56,077 : INFO : Recall score for label_class 2: 0.9589
2024-08-15 17:36:56,077 : INFO : Average F1 score: 0.9657
2024-08-15 17:36:56,545 : INFO : Average loss over validation batches: 0.4187
2024-08-15 17:36:56,545 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:56,545 : INFO : Validation metrics:
2024-08-15 17:36:56,545 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:56,549 : INFO : Accuracy: 0.8548
2024-08-15 17:36:56,549 : INFO : Precision score for label_class 0: 0.8028
2024-08-15 17:36:56,549 : INFO : Precision score for label_class 1: 0.9152
2024-08-15 17:36:56,549 : INFO : Precision score for label_class 2: 0.7628
2024-08-15 17:36:56,549 : INFO : Recall score for label_class 0: 0.8028
2024-08-15 17:36:56,549 : INFO : Recall score for label_class 1: 0.8683
2024-08-15 17:36:56,549 : INFO : Recall score for label_class 2: 0.8454
2024-08-15 17:36:56,549 : INFO : Average F1 score: 0.8320
2024-08-15 17:36:56,549 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:36:56,549 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:36:56,580 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:36:57,081 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:57,081 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:36:57,082 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:57,085 : INFO : Accuracy: 0.8637
2024-08-15 17:36:57,085 : INFO : Precision score for label_class 0: 0.7079
2024-08-15 17:36:57,085 : INFO : Precision score for label_class 1: 0.9146
2024-08-15 17:36:57,085 : INFO : Precision score for label_class 2: 0.8298
2024-08-15 17:36:57,085 : INFO : Recall score for label_class 0: 0.8873
2024-08-15 17:36:57,085 : INFO : Recall score for label_class 1: 0.8878
2024-08-15 17:36:57,085 : INFO : Recall score for label_class 2: 0.8041
2024-08-15 17:36:57,085 : INFO : Average F1 score: 0.8351
2024-08-15 17:36:57,085 : INFO : Determined score from best model, ending training.
2024-08-15 17:36:57,086 : INFO : Split 2 is finished, the score is: 0.8351
2024-08-15 17:36:57,086 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:57,086 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:36:57,086 : INFO : Starting training for split 3
2024-08-15 17:36:57,106 : INFO : Starting to tokenize the sequences.
2024-08-15 17:36:57,112 : INFO : Tokenization is finished.
2024-08-15 17:36:57,129 : INFO : Starting to tokenize the sequences.
2024-08-15 17:36:57,133 : INFO : Tokenization is finished.
2024-08-15 17:36:57,138 : INFO : Counting occurences of labels...
2024-08-15 17:36:57,139 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1611,  759]))
2024-08-15 17:36:57,140 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 400, 189]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:36:57,186 : INFO : Starting epoch 1
2024-08-15 17:36:57,237 : INFO : Current training batch loss: 1.1043 in epoch 1
2024-08-15 17:36:58,052 : INFO : Current training batch loss: 1.0393 in epoch 1
2024-08-15 17:36:58,868 : INFO : Current training batch loss: 0.8685 in epoch 1
2024-08-15 17:36:59,684 : INFO : Current training batch loss: 0.7681 in epoch 1
2024-08-15 17:37:00,499 : INFO : Current training batch loss: 0.7616 in epoch 1
2024-08-15 17:37:00,649 : INFO : Epoch finished, average loss over training batches: 0.8820
2024-08-15 17:37:00,649 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:00,649 : INFO : Training metrics:
2024-08-15 17:37:00,650 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:00,657 : INFO : Accuracy: 0.6134
2024-08-15 17:37:00,657 : INFO : Precision score for label_class 0: 0.1183
2024-08-15 17:37:00,657 : INFO : Precision score for label_class 1: 0.6713
2024-08-15 17:37:00,657 : INFO : Precision score for label_class 2: 0.5078
2024-08-15 17:37:00,657 : INFO : Recall score for label_class 0: 0.0610
2024-08-15 17:37:00,657 : INFO : Recall score for label_class 1: 0.8939
2024-08-15 17:37:00,657 : INFO : Recall score for label_class 2: 0.2569
2024-08-15 17:37:00,657 : INFO : Average F1 score: 0.3962
2024-08-15 17:37:01,123 : INFO : Average loss over validation batches: 0.6626
2024-08-15 17:37:01,123 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:01,123 : INFO : Validation metrics:
2024-08-15 17:37:01,123 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:01,126 : INFO : Accuracy: 0.7170
2024-08-15 17:37:01,126 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:37:01,126 : INFO : Precision score for label_class 1: 0.8096
2024-08-15 17:37:01,126 : INFO : Precision score for label_class 2: 0.5229
2024-08-15 17:37:01,126 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:37:01,126 : INFO : Recall score for label_class 1: 0.9250
2024-08-15 17:37:01,126 : INFO : Recall score for label_class 2: 0.6032
2024-08-15 17:37:01,126 : INFO : Average F1 score: 0.4746
2024-08-15 17:37:01,126 : INFO : Validation metric decreased (inf --> 0.662563).  Saving model ...
2024-08-15 17:37:01,227 : INFO : Starting epoch 2
2024-08-15 17:37:01,881 : INFO : Current training batch loss: 0.6498 in epoch 2
2024-08-15 17:37:02,696 : INFO : Current training batch loss: 0.5276 in epoch 2
2024-08-15 17:37:03,510 : INFO : Current training batch loss: 0.4700 in epoch 2
2024-08-15 17:37:04,325 : INFO : Current training batch loss: 0.4426 in epoch 2
2024-08-15 17:37:04,677 : INFO : Epoch finished, average loss over training batches: 0.5351
2024-08-15 17:37:04,677 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:04,677 : INFO : Training metrics:
2024-08-15 17:37:04,677 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:04,681 : INFO : Accuracy: 0.8058
2024-08-15 17:37:04,681 : INFO : Precision score for label_class 0: 0.7245
2024-08-15 17:37:04,681 : INFO : Precision score for label_class 1: 0.8656
2024-08-15 17:37:04,681 : INFO : Precision score for label_class 2: 0.6933
2024-08-15 17:37:04,681 : INFO : Recall score for label_class 0: 0.4329
2024-08-15 17:37:04,682 : INFO : Recall score for label_class 1: 0.9274
2024-08-15 17:37:04,682 : INFO : Recall score for label_class 2: 0.7088
2024-08-15 17:37:04,682 : INFO : Average F1 score: 0.7128
2024-08-15 17:37:05,147 : INFO : Average loss over validation batches: 0.4339
2024-08-15 17:37:05,147 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:05,147 : INFO : Validation metrics:
2024-08-15 17:37:05,147 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:05,149 : INFO : Accuracy: 0.8356
2024-08-15 17:37:05,149 : INFO : Precision score for label_class 0: 0.8704
2024-08-15 17:37:05,149 : INFO : Precision score for label_class 1: 0.9030
2024-08-15 17:37:05,149 : INFO : Precision score for label_class 2: 0.7032
2024-08-15 17:37:05,149 : INFO : Recall score for label_class 0: 0.5465
2024-08-15 17:37:05,149 : INFO : Recall score for label_class 1: 0.9075
2024-08-15 17:37:05,149 : INFO : Recall score for label_class 2: 0.8148
2024-08-15 17:37:05,149 : INFO : Average F1 score: 0.7772
2024-08-15 17:37:05,149 : INFO : Validation metric decreased (0.662563 --> 0.433878).  Saving model ...
2024-08-15 17:37:05,252 : INFO : Starting epoch 3
2024-08-15 17:37:05,705 : INFO : Current training batch loss: 0.4173 in epoch 3
2024-08-15 17:37:06,520 : INFO : Current training batch loss: 0.4271 in epoch 3
2024-08-15 17:37:07,335 : INFO : Current training batch loss: 0.3331 in epoch 3
2024-08-15 17:37:08,151 : INFO : Current training batch loss: 0.1698 in epoch 3
2024-08-15 17:37:08,704 : INFO : Epoch finished, average loss over training batches: 0.3178
2024-08-15 17:37:08,704 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:08,704 : INFO : Training metrics:
2024-08-15 17:37:08,704 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:08,708 : INFO : Accuracy: 0.8907
2024-08-15 17:37:08,708 : INFO : Precision score for label_class 0: 0.8037
2024-08-15 17:37:08,708 : INFO : Precision score for label_class 1: 0.9297
2024-08-15 17:37:08,708 : INFO : Precision score for label_class 2: 0.8442
2024-08-15 17:37:08,708 : INFO : Recall score for label_class 0: 0.7988
2024-08-15 17:37:08,708 : INFO : Recall score for label_class 1: 0.9354
2024-08-15 17:37:08,708 : INFO : Recall score for label_class 2: 0.8353
2024-08-15 17:37:08,708 : INFO : Average F1 score: 0.8578
2024-08-15 17:37:09,175 : INFO : Average loss over validation batches: 0.3486
2024-08-15 17:37:09,175 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:09,175 : INFO : Validation metrics:
2024-08-15 17:37:09,175 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:09,177 : INFO : Accuracy: 0.8830
2024-08-15 17:37:09,177 : INFO : Precision score for label_class 0: 0.8816
2024-08-15 17:37:09,177 : INFO : Precision score for label_class 1: 0.9026
2024-08-15 17:37:09,177 : INFO : Precision score for label_class 2: 0.8371
2024-08-15 17:37:09,177 : INFO : Recall score for label_class 0: 0.7791
2024-08-15 17:37:09,177 : INFO : Recall score for label_class 1: 0.9500
2024-08-15 17:37:09,177 : INFO : Recall score for label_class 2: 0.7884
2024-08-15 17:37:09,177 : INFO : Average F1 score: 0.8549
2024-08-15 17:37:09,177 : INFO : Validation metric decreased (0.433878 --> 0.348575).  Saving model ...
2024-08-15 17:37:09,282 : INFO : Starting epoch 4
2024-08-15 17:37:09,540 : INFO : Current training batch loss: 0.4282 in epoch 4
2024-08-15 17:37:10,363 : INFO : Current training batch loss: 0.2510 in epoch 4
2024-08-15 17:37:11,183 : INFO : Current training batch loss: 0.3243 in epoch 4
2024-08-15 17:37:12,001 : INFO : Current training batch loss: 0.1307 in epoch 4
2024-08-15 17:37:12,760 : INFO : Epoch finished, average loss over training batches: 0.1867
2024-08-15 17:37:12,760 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:12,760 : INFO : Training metrics:
2024-08-15 17:37:12,760 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:12,765 : INFO : Accuracy: 0.9463
2024-08-15 17:37:12,765 : INFO : Precision score for label_class 0: 0.8765
2024-08-15 17:37:12,765 : INFO : Precision score for label_class 1: 0.9660
2024-08-15 17:37:12,765 : INFO : Precision score for label_class 2: 0.9353
2024-08-15 17:37:12,765 : INFO : Recall score for label_class 0: 0.9085
2024-08-15 17:37:12,765 : INFO : Recall score for label_class 1: 0.9690
2024-08-15 17:37:12,765 : INFO : Recall score for label_class 2: 0.9144
2024-08-15 17:37:12,765 : INFO : Average F1 score: 0.9281
2024-08-15 17:37:13,232 : INFO : Average loss over validation batches: 0.3967
2024-08-15 17:37:13,233 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:13,233 : INFO : Validation metrics:
2024-08-15 17:37:13,233 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:13,235 : INFO : Accuracy: 0.8593
2024-08-15 17:37:13,235 : INFO : Precision score for label_class 0: 0.7624
2024-08-15 17:37:13,235 : INFO : Precision score for label_class 1: 0.9382
2024-08-15 17:37:13,235 : INFO : Precision score for label_class 2: 0.7624
2024-08-15 17:37:13,235 : INFO : Recall score for label_class 0: 0.8953
2024-08-15 17:37:13,235 : INFO : Recall score for label_class 1: 0.8725
2024-08-15 17:37:13,235 : INFO : Recall score for label_class 2: 0.8148
2024-08-15 17:37:13,235 : INFO : Average F1 score: 0.8385
2024-08-15 17:37:13,235 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:37:13,235 : INFO : Starting epoch 5
2024-08-15 17:37:13,286 : INFO : Current training batch loss: 0.1427 in epoch 5
2024-08-15 17:37:14,105 : INFO : Current training batch loss: 0.1068 in epoch 5
2024-08-15 17:37:14,935 : INFO : Current training batch loss: 0.0363 in epoch 5
2024-08-15 17:37:15,759 : INFO : Current training batch loss: 0.0397 in epoch 5
2024-08-15 17:37:16,578 : INFO : Current training batch loss: 0.0337 in epoch 5
2024-08-15 17:37:16,731 : INFO : Epoch finished, average loss over training batches: 0.1229
2024-08-15 17:37:16,731 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:16,731 : INFO : Training metrics:
2024-08-15 17:37:16,731 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:16,738 : INFO : Accuracy: 0.9692
2024-08-15 17:37:16,738 : INFO : Precision score for label_class 0: 0.8991
2024-08-15 17:37:16,738 : INFO : Precision score for label_class 1: 0.9826
2024-08-15 17:37:16,738 : INFO : Precision score for label_class 2: 0.9730
2024-08-15 17:37:16,738 : INFO : Recall score for label_class 0: 0.9512
2024-08-15 17:37:16,738 : INFO : Recall score for label_class 1: 0.9820
2024-08-15 17:37:16,738 : INFO : Recall score for label_class 2: 0.9499
2024-08-15 17:37:16,738 : INFO : Average F1 score: 0.9560
2024-08-15 17:37:17,204 : INFO : Average loss over validation batches: 0.4640
2024-08-15 17:37:17,204 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:17,205 : INFO : Validation metrics:
2024-08-15 17:37:17,205 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:17,207 : INFO : Accuracy: 0.8489
2024-08-15 17:37:17,207 : INFO : Precision score for label_class 0: 0.7290
2024-08-15 17:37:17,207 : INFO : Precision score for label_class 1: 0.9438
2024-08-15 17:37:17,207 : INFO : Precision score for label_class 2: 0.7500
2024-08-15 17:37:17,207 : INFO : Recall score for label_class 0: 0.9070
2024-08-15 17:37:17,207 : INFO : Recall score for label_class 1: 0.8400
2024-08-15 17:37:17,207 : INFO : Recall score for label_class 2: 0.8413
2024-08-15 17:37:17,207 : INFO : Average F1 score: 0.8301
2024-08-15 17:37:17,207 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:37:17,207 : INFO : Starting epoch 6
2024-08-15 17:37:17,864 : INFO : Current training batch loss: 0.1226 in epoch 6
2024-08-15 17:37:18,769 : INFO : Current training batch loss: 0.1169 in epoch 6
2024-08-15 17:37:19,596 : INFO : Current training batch loss: 0.0258 in epoch 6
2024-08-15 17:37:20,415 : INFO : Current training batch loss: 0.0416 in epoch 6
2024-08-15 17:37:20,770 : INFO : Epoch finished, average loss over training batches: 0.1039
2024-08-15 17:37:20,771 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:20,771 : INFO : Training metrics:
2024-08-15 17:37:20,771 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:20,774 : INFO : Accuracy: 0.9707
2024-08-15 17:37:20,774 : INFO : Precision score for label_class 0: 0.9222
2024-08-15 17:37:20,774 : INFO : Precision score for label_class 1: 0.9796
2024-08-15 17:37:20,774 : INFO : Precision score for label_class 2: 0.9741
2024-08-15 17:37:20,774 : INFO : Recall score for label_class 0: 0.9756
2024-08-15 17:37:20,774 : INFO : Recall score for label_class 1: 0.9826
2024-08-15 17:37:20,774 : INFO : Recall score for label_class 2: 0.9433
2024-08-15 17:37:20,774 : INFO : Average F1 score: 0.9626
2024-08-15 17:37:21,242 : INFO : Average loss over validation batches: 0.4392
2024-08-15 17:37:21,242 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:21,242 : INFO : Validation metrics:
2024-08-15 17:37:21,242 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:21,245 : INFO : Accuracy: 0.8519
2024-08-15 17:37:21,245 : INFO : Precision score for label_class 0: 0.7222
2024-08-15 17:37:21,245 : INFO : Precision score for label_class 1: 0.9317
2024-08-15 17:37:21,245 : INFO : Precision score for label_class 2: 0.7761
2024-08-15 17:37:21,245 : INFO : Recall score for label_class 0: 0.9070
2024-08-15 17:37:21,245 : INFO : Recall score for label_class 1: 0.8525
2024-08-15 17:37:21,245 : INFO : Recall score for label_class 2: 0.8254
2024-08-15 17:37:21,245 : INFO : Average F1 score: 0.8315
2024-08-15 17:37:21,245 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:37:21,245 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:37:21,277 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:37:21,774 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:21,774 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:37:21,774 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:21,776 : INFO : Accuracy: 0.8830
2024-08-15 17:37:21,776 : INFO : Precision score for label_class 0: 0.8816
2024-08-15 17:37:21,776 : INFO : Precision score for label_class 1: 0.9026
2024-08-15 17:37:21,776 : INFO : Precision score for label_class 2: 0.8371
2024-08-15 17:37:21,776 : INFO : Recall score for label_class 0: 0.7791
2024-08-15 17:37:21,776 : INFO : Recall score for label_class 1: 0.9500
2024-08-15 17:37:21,776 : INFO : Recall score for label_class 2: 0.7884
2024-08-15 17:37:21,776 : INFO : Average F1 score: 0.8549
2024-08-15 17:37:21,776 : INFO : Determined score from best model, ending training.
2024-08-15 17:37:21,778 : INFO : Split 3 is finished, the score is: 0.8549
2024-08-15 17:37:21,778 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:21,778 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:21,778 : INFO : Starting training for split 4
2024-08-15 17:37:21,793 : INFO : Starting to tokenize the sequences.
2024-08-15 17:37:21,799 : INFO : Tokenization is finished.
2024-08-15 17:37:21,816 : INFO : Starting to tokenize the sequences.
2024-08-15 17:37:21,820 : INFO : Tokenization is finished.
2024-08-15 17:37:21,825 : INFO : Counting occurences of labels...
2024-08-15 17:37:21,826 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 327, 1621,  751]))
2024-08-15 17:37:21,826 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 87, 390, 197]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:37:21,868 : INFO : Starting epoch 1
2024-08-15 17:37:21,920 : INFO : Current training batch loss: 1.0950 in epoch 1
2024-08-15 17:37:22,741 : INFO : Current training batch loss: 1.0268 in epoch 1
2024-08-15 17:37:23,559 : INFO : Current training batch loss: 0.8245 in epoch 1
2024-08-15 17:37:24,377 : INFO : Current training batch loss: 0.7146 in epoch 1
2024-08-15 17:37:25,195 : INFO : Current training batch loss: 0.7108 in epoch 1
2024-08-15 17:37:25,347 : INFO : Epoch finished, average loss over training batches: 0.8575
2024-08-15 17:37:25,348 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:25,348 : INFO : Training metrics:
2024-08-15 17:37:25,348 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:25,355 : INFO : Accuracy: 0.6591
2024-08-15 17:37:25,355 : INFO : Precision score for label_class 0: 0.1429
2024-08-15 17:37:25,355 : INFO : Precision score for label_class 1: 0.6831
2024-08-15 17:37:25,355 : INFO : Precision score for label_class 2: 0.5462
2024-08-15 17:37:25,355 : INFO : Recall score for label_class 0: 0.0092
2024-08-15 17:37:25,355 : INFO : Recall score for label_class 1: 0.9642
2024-08-15 17:37:25,355 : INFO : Recall score for label_class 2: 0.2836
2024-08-15 17:37:25,355 : INFO : Average F1 score: 0.3968
2024-08-15 17:37:25,823 : INFO : Average loss over validation batches: 0.6512
2024-08-15 17:37:25,823 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:25,823 : INFO : Validation metrics:
2024-08-15 17:37:25,823 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:25,826 : INFO : Accuracy: 0.7270
2024-08-15 17:37:25,826 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:37:25,826 : INFO : Precision score for label_class 1: 0.8207
2024-08-15 17:37:25,826 : INFO : Precision score for label_class 2: 0.5565
2024-08-15 17:37:25,826 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:37:25,826 : INFO : Recall score for label_class 1: 0.9154
2024-08-15 17:37:25,826 : INFO : Recall score for label_class 2: 0.6751
2024-08-15 17:37:25,826 : INFO : Average F1 score: 0.4918
2024-08-15 17:37:25,826 : INFO : Validation metric decreased (inf --> 0.651226).  Saving model ...
2024-08-15 17:37:25,934 : INFO : Starting epoch 2
2024-08-15 17:37:26,590 : INFO : Current training batch loss: 0.6136 in epoch 2
2024-08-15 17:37:27,407 : INFO : Current training batch loss: 0.4463 in epoch 2
2024-08-15 17:37:28,234 : INFO : Current training batch loss: 0.2852 in epoch 2
2024-08-15 17:37:29,062 : INFO : Current training batch loss: 0.3975 in epoch 2
2024-08-15 17:37:29,414 : INFO : Epoch finished, average loss over training batches: 0.4810
2024-08-15 17:37:29,415 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:29,415 : INFO : Training metrics:
2024-08-15 17:37:29,415 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:29,418 : INFO : Accuracy: 0.8333
2024-08-15 17:37:29,418 : INFO : Precision score for label_class 0: 0.7762
2024-08-15 17:37:29,418 : INFO : Precision score for label_class 1: 0.8645
2024-08-15 17:37:29,418 : INFO : Precision score for label_class 2: 0.7792
2024-08-15 17:37:29,418 : INFO : Recall score for label_class 0: 0.6789
2024-08-15 17:37:29,418 : INFO : Recall score for label_class 1: 0.9173
2024-08-15 17:37:29,418 : INFO : Recall score for label_class 2: 0.7190
2024-08-15 17:37:29,418 : INFO : Average F1 score: 0.7875
2024-08-15 17:37:29,887 : INFO : Average loss over validation batches: 0.3862
2024-08-15 17:37:29,887 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:29,887 : INFO : Validation metrics:
2024-08-15 17:37:29,887 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:29,890 : INFO : Accuracy: 0.8650
2024-08-15 17:37:29,890 : INFO : Precision score for label_class 0: 0.8500
2024-08-15 17:37:29,890 : INFO : Precision score for label_class 1: 0.8886
2024-08-15 17:37:29,890 : INFO : Precision score for label_class 2: 0.8211
2024-08-15 17:37:29,890 : INFO : Recall score for label_class 0: 0.7816
2024-08-15 17:37:29,890 : INFO : Recall score for label_class 1: 0.9205
2024-08-15 17:37:29,890 : INFO : Recall score for label_class 2: 0.7919
2024-08-15 17:37:29,890 : INFO : Average F1 score: 0.8416
2024-08-15 17:37:29,890 : INFO : Validation metric decreased (0.651226 --> 0.386212).  Saving model ...
2024-08-15 17:37:29,990 : INFO : Starting epoch 3
2024-08-15 17:37:30,459 : INFO : Current training batch loss: 0.3174 in epoch 3
2024-08-15 17:37:31,321 : INFO : Current training batch loss: 0.4027 in epoch 3
2024-08-15 17:37:32,137 : INFO : Current training batch loss: 0.2815 in epoch 3
2024-08-15 17:37:32,953 : INFO : Current training batch loss: 0.1268 in epoch 3
2024-08-15 17:37:33,506 : INFO : Epoch finished, average loss over training batches: 0.2649
2024-08-15 17:37:33,506 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:33,506 : INFO : Training metrics:
2024-08-15 17:37:33,506 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:33,510 : INFO : Accuracy: 0.9181
2024-08-15 17:37:33,510 : INFO : Precision score for label_class 0: 0.8534
2024-08-15 17:37:33,510 : INFO : Precision score for label_class 1: 0.9429
2024-08-15 17:37:33,510 : INFO : Precision score for label_class 2: 0.8930
2024-08-15 17:37:33,510 : INFO : Recall score for label_class 0: 0.8899
2024-08-15 17:37:33,510 : INFO : Recall score for label_class 1: 0.9476
2024-08-15 17:37:33,510 : INFO : Recall score for label_class 2: 0.8668
2024-08-15 17:37:33,510 : INFO : Average F1 score: 0.8987
2024-08-15 17:37:33,979 : INFO : Average loss over validation batches: 0.3964
2024-08-15 17:37:33,979 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:33,979 : INFO : Validation metrics:
2024-08-15 17:37:33,979 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:33,982 : INFO : Accuracy: 0.8591
2024-08-15 17:37:33,982 : INFO : Precision score for label_class 0: 0.8553
2024-08-15 17:37:33,982 : INFO : Precision score for label_class 1: 0.9003
2024-08-15 17:37:33,982 : INFO : Precision score for label_class 2: 0.7826
2024-08-15 17:37:33,982 : INFO : Recall score for label_class 0: 0.7471
2024-08-15 17:37:33,982 : INFO : Recall score for label_class 1: 0.9026
2024-08-15 17:37:33,982 : INFO : Recall score for label_class 2: 0.8223
2024-08-15 17:37:33,982 : INFO : Average F1 score: 0.8336
2024-08-15 17:37:33,982 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:37:33,982 : INFO : Starting epoch 4
2024-08-15 17:37:34,234 : INFO : Current training batch loss: 0.3949 in epoch 4
2024-08-15 17:37:35,057 : INFO : Current training batch loss: 0.2536 in epoch 4
2024-08-15 17:37:35,886 : INFO : Current training batch loss: 0.1702 in epoch 4
2024-08-15 17:37:36,712 : INFO : Current training batch loss: 0.1566 in epoch 4
2024-08-15 17:37:37,471 : INFO : Epoch finished, average loss over training batches: 0.1684
2024-08-15 17:37:37,471 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:37,471 : INFO : Training metrics:
2024-08-15 17:37:37,471 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:37,477 : INFO : Accuracy: 0.9511
2024-08-15 17:37:37,477 : INFO : Precision score for label_class 0: 0.8879
2024-08-15 17:37:37,477 : INFO : Precision score for label_class 1: 0.9714
2024-08-15 17:37:37,477 : INFO : Precision score for label_class 2: 0.9359
2024-08-15 17:37:37,477 : INFO : Recall score for label_class 0: 0.9205
2024-08-15 17:37:37,477 : INFO : Recall score for label_class 1: 0.9655
2024-08-15 17:37:37,477 : INFO : Recall score for label_class 2: 0.9334
2024-08-15 17:37:37,477 : INFO : Average F1 score: 0.9357
2024-08-15 17:37:37,946 : INFO : Average loss over validation batches: 0.3882
2024-08-15 17:37:37,946 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:37,946 : INFO : Validation metrics:
2024-08-15 17:37:37,946 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:37,950 : INFO : Accuracy: 0.8605
2024-08-15 17:37:37,950 : INFO : Precision score for label_class 0: 0.8000
2024-08-15 17:37:37,950 : INFO : Precision score for label_class 1: 0.8959
2024-08-15 17:37:37,950 : INFO : Precision score for label_class 2: 0.8154
2024-08-15 17:37:37,950 : INFO : Recall score for label_class 0: 0.7816
2024-08-15 17:37:37,950 : INFO : Recall score for label_class 1: 0.9051
2024-08-15 17:37:37,950 : INFO : Recall score for label_class 2: 0.8071
2024-08-15 17:37:37,950 : INFO : Average F1 score: 0.8341
2024-08-15 17:37:37,950 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:37:37,950 : INFO : Starting epoch 5
2024-08-15 17:37:38,001 : INFO : Current training batch loss: 0.0409 in epoch 5
2024-08-15 17:37:38,816 : INFO : Current training batch loss: 0.0682 in epoch 5
2024-08-15 17:37:39,633 : INFO : Current training batch loss: 0.0381 in epoch 5
2024-08-15 17:37:40,455 : INFO : Current training batch loss: 0.1091 in epoch 5
2024-08-15 17:37:41,296 : INFO : Current training batch loss: 0.2626 in epoch 5
2024-08-15 17:37:41,452 : INFO : Epoch finished, average loss over training batches: 0.1049
2024-08-15 17:37:41,453 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:41,453 : INFO : Training metrics:
2024-08-15 17:37:41,453 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:41,456 : INFO : Accuracy: 0.9733
2024-08-15 17:37:41,456 : INFO : Precision score for label_class 0: 0.9120
2024-08-15 17:37:41,456 : INFO : Precision score for label_class 1: 0.9888
2024-08-15 17:37:41,456 : INFO : Precision score for label_class 2: 0.9679
2024-08-15 17:37:41,456 : INFO : Recall score for label_class 0: 0.9511
2024-08-15 17:37:41,456 : INFO : Recall score for label_class 1: 0.9821
2024-08-15 17:37:41,456 : INFO : Recall score for label_class 2: 0.9640
2024-08-15 17:37:41,456 : INFO : Average F1 score: 0.9609
2024-08-15 17:37:41,927 : INFO : Average loss over validation batches: 0.4355
2024-08-15 17:37:41,928 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:41,928 : INFO : Validation metrics:
2024-08-15 17:37:41,928 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:41,931 : INFO : Accuracy: 0.8694
2024-08-15 17:37:41,931 : INFO : Precision score for label_class 0: 0.7912
2024-08-15 17:37:41,931 : INFO : Precision score for label_class 1: 0.9051
2024-08-15 17:37:41,931 : INFO : Precision score for label_class 2: 0.8342
2024-08-15 17:37:41,931 : INFO : Recall score for label_class 0: 0.8276
2024-08-15 17:37:41,931 : INFO : Recall score for label_class 1: 0.9051
2024-08-15 17:37:41,931 : INFO : Recall score for label_class 2: 0.8173
2024-08-15 17:37:41,931 : INFO : Average F1 score: 0.8466
2024-08-15 17:37:41,931 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:37:41,931 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:37:41,967 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:37:42,471 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:42,471 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:37:42,471 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:42,475 : INFO : Accuracy: 0.8650
2024-08-15 17:37:42,475 : INFO : Precision score for label_class 0: 0.8500
2024-08-15 17:37:42,475 : INFO : Precision score for label_class 1: 0.8886
2024-08-15 17:37:42,475 : INFO : Precision score for label_class 2: 0.8211
2024-08-15 17:37:42,475 : INFO : Recall score for label_class 0: 0.7816
2024-08-15 17:37:42,475 : INFO : Recall score for label_class 1: 0.9205
2024-08-15 17:37:42,475 : INFO : Recall score for label_class 2: 0.7919
2024-08-15 17:37:42,475 : INFO : Average F1 score: 0.8416
2024-08-15 17:37:42,475 : INFO : Determined score from best model, ending training.
2024-08-15 17:37:42,482 : INFO : Split 4 is finished, the score is: 0.8416
2024-08-15 17:37:42,482 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:42,482 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:42,482 : INFO : Starting training for split 5
2024-08-15 17:37:42,495 : INFO : Starting to tokenize the sequences.
2024-08-15 17:37:42,500 : INFO : Tokenization is finished.
2024-08-15 17:37:42,518 : INFO : Starting to tokenize the sequences.
2024-08-15 17:37:42,523 : INFO : Tokenization is finished.
2024-08-15 17:37:42,528 : INFO : Counting occurences of labels...
2024-08-15 17:37:42,529 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 330, 1615,  754]))
2024-08-15 17:37:42,529 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 84, 396, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:37:42,579 : INFO : Starting epoch 1
2024-08-15 17:37:42,630 : INFO : Current training batch loss: 1.0703 in epoch 1
2024-08-15 17:37:43,445 : INFO : Current training batch loss: 1.0158 in epoch 1
2024-08-15 17:37:44,259 : INFO : Current training batch loss: 0.8032 in epoch 1
2024-08-15 17:37:45,074 : INFO : Current training batch loss: 0.7060 in epoch 1
2024-08-15 17:37:45,889 : INFO : Current training batch loss: 0.6541 in epoch 1
2024-08-15 17:37:46,040 : INFO : Epoch finished, average loss over training batches: 0.8368
2024-08-15 17:37:46,040 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:46,040 : INFO : Training metrics:
2024-08-15 17:37:46,040 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:46,051 : INFO : Accuracy: 0.6632
2024-08-15 17:37:46,051 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:37:46,051 : INFO : Precision score for label_class 1: 0.6873
2024-08-15 17:37:46,051 : INFO : Precision score for label_class 2: 0.5388
2024-08-15 17:37:46,051 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:37:46,051 : INFO : Recall score for label_class 1: 0.9622
2024-08-15 17:37:46,051 : INFO : Recall score for label_class 2: 0.3130
2024-08-15 17:37:46,051 : INFO : Average F1 score: 0.3993
2024-08-15 17:37:46,526 : INFO : Average loss over validation batches: 0.5962
2024-08-15 17:37:46,526 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:46,526 : INFO : Validation metrics:
2024-08-15 17:37:46,526 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:46,529 : INFO : Accuracy: 0.7374
2024-08-15 17:37:46,529 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:37:46,529 : INFO : Precision score for label_class 1: 0.8372
2024-08-15 17:37:46,529 : INFO : Precision score for label_class 2: 0.5546
2024-08-15 17:37:46,529 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:37:46,529 : INFO : Recall score for label_class 1: 0.9217
2024-08-15 17:37:46,529 : INFO : Recall score for label_class 2: 0.6804
2024-08-15 17:37:46,529 : INFO : Average F1 score: 0.4962
2024-08-15 17:37:46,530 : INFO : Validation metric decreased (inf --> 0.596193).  Saving model ...
2024-08-15 17:37:46,630 : INFO : Starting epoch 2
2024-08-15 17:37:47,288 : INFO : Current training batch loss: 0.5782 in epoch 2
2024-08-15 17:37:48,106 : INFO : Current training batch loss: 0.3882 in epoch 2
2024-08-15 17:37:48,924 : INFO : Current training batch loss: 0.2550 in epoch 2
2024-08-15 17:37:49,743 : INFO : Current training batch loss: 0.4225 in epoch 2
2024-08-15 17:37:50,098 : INFO : Epoch finished, average loss over training batches: 0.4456
2024-08-15 17:37:50,098 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:50,098 : INFO : Training metrics:
2024-08-15 17:37:50,098 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:50,106 : INFO : Accuracy: 0.8507
2024-08-15 17:37:50,106 : INFO : Precision score for label_class 0: 0.8077
2024-08-15 17:37:50,106 : INFO : Precision score for label_class 1: 0.8767
2024-08-15 17:37:50,106 : INFO : Precision score for label_class 2: 0.8029
2024-08-15 17:37:50,106 : INFO : Recall score for label_class 0: 0.7000
2024-08-15 17:37:50,106 : INFO : Recall score for label_class 1: 0.9381
2024-08-15 17:37:50,106 : INFO : Recall score for label_class 2: 0.7294
2024-08-15 17:37:50,106 : INFO : Average F1 score: 0.8069
2024-08-15 17:37:50,573 : INFO : Average loss over validation batches: 0.3784
2024-08-15 17:37:50,573 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:50,573 : INFO : Validation metrics:
2024-08-15 17:37:50,574 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:50,577 : INFO : Accuracy: 0.8635
2024-08-15 17:37:50,577 : INFO : Precision score for label_class 0: 0.7765
2024-08-15 17:37:50,577 : INFO : Precision score for label_class 1: 0.8886
2024-08-15 17:37:50,577 : INFO : Precision score for label_class 2: 0.8466
2024-08-15 17:37:50,577 : INFO : Recall score for label_class 0: 0.7857
2024-08-15 17:37:50,577 : INFO : Recall score for label_class 1: 0.9268
2024-08-15 17:37:50,577 : INFO : Recall score for label_class 2: 0.7680
2024-08-15 17:37:50,577 : INFO : Average F1 score: 0.8313
2024-08-15 17:37:50,577 : INFO : Validation metric decreased (0.596193 --> 0.378442).  Saving model ...
2024-08-15 17:37:50,675 : INFO : Starting epoch 3
2024-08-15 17:37:51,128 : INFO : Current training batch loss: 0.2101 in epoch 3
2024-08-15 17:37:51,943 : INFO : Current training batch loss: 0.3026 in epoch 3
2024-08-15 17:37:52,791 : INFO : Current training batch loss: 0.3646 in epoch 3
2024-08-15 17:37:53,611 : INFO : Current training batch loss: 0.2006 in epoch 3
2024-08-15 17:37:54,164 : INFO : Epoch finished, average loss over training batches: 0.2678
2024-08-15 17:37:54,165 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:54,165 : INFO : Training metrics:
2024-08-15 17:37:54,165 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:54,172 : INFO : Accuracy: 0.9140
2024-08-15 17:37:54,172 : INFO : Precision score for label_class 0: 0.8372
2024-08-15 17:37:54,172 : INFO : Precision score for label_class 1: 0.9428
2024-08-15 17:37:54,172 : INFO : Precision score for label_class 2: 0.8861
2024-08-15 17:37:54,172 : INFO : Recall score for label_class 0: 0.8727
2024-08-15 17:37:54,172 : INFO : Recall score for label_class 1: 0.9492
2024-08-15 17:37:54,172 : INFO : Recall score for label_class 2: 0.8568
2024-08-15 17:37:54,172 : INFO : Average F1 score: 0.8906
2024-08-15 17:37:54,640 : INFO : Average loss over validation batches: 0.4014
2024-08-15 17:37:54,641 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:54,641 : INFO : Validation metrics:
2024-08-15 17:37:54,641 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:54,644 : INFO : Accuracy: 0.8457
2024-08-15 17:37:54,645 : INFO : Precision score for label_class 0: 0.8710
2024-08-15 17:37:54,645 : INFO : Precision score for label_class 1: 0.8491
2024-08-15 17:37:54,645 : INFO : Precision score for label_class 2: 0.8274
2024-08-15 17:37:54,645 : INFO : Recall score for label_class 0: 0.6429
2024-08-15 17:37:54,645 : INFO : Recall score for label_class 1: 0.9520
2024-08-15 17:37:54,645 : INFO : Recall score for label_class 2: 0.7165
2024-08-15 17:37:54,645 : INFO : Average F1 score: 0.8018
2024-08-15 17:37:54,645 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:37:54,645 : INFO : Starting epoch 4
2024-08-15 17:37:54,897 : INFO : Current training batch loss: 0.4218 in epoch 4
2024-08-15 17:37:55,718 : INFO : Current training batch loss: 0.1495 in epoch 4
2024-08-15 17:37:56,539 : INFO : Current training batch loss: 0.2126 in epoch 4
2024-08-15 17:37:57,378 : INFO : Current training batch loss: 0.1523 in epoch 4
2024-08-15 17:37:58,136 : INFO : Epoch finished, average loss over training batches: 0.1744
2024-08-15 17:37:58,136 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:58,136 : INFO : Training metrics:
2024-08-15 17:37:58,136 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:58,143 : INFO : Accuracy: 0.9489
2024-08-15 17:37:58,143 : INFO : Precision score for label_class 0: 0.9102
2024-08-15 17:37:58,143 : INFO : Precision score for label_class 1: 0.9619
2024-08-15 17:37:58,143 : INFO : Precision score for label_class 2: 0.9375
2024-08-15 17:37:58,143 : INFO : Recall score for label_class 0: 0.9212
2024-08-15 17:37:58,143 : INFO : Recall score for label_class 1: 0.9703
2024-08-15 17:37:58,143 : INFO : Recall score for label_class 2: 0.9151
2024-08-15 17:37:58,143 : INFO : Average F1 score: 0.9360
2024-08-15 17:37:58,609 : INFO : Average loss over validation batches: 0.4104
2024-08-15 17:37:58,609 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:58,609 : INFO : Validation metrics:
2024-08-15 17:37:58,609 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:37:58,612 : INFO : Accuracy: 0.8576
2024-08-15 17:37:58,612 : INFO : Precision score for label_class 0: 0.7263
2024-08-15 17:37:58,612 : INFO : Precision score for label_class 1: 0.9038
2024-08-15 17:37:58,612 : INFO : Precision score for label_class 2: 0.8261
2024-08-15 17:37:58,612 : INFO : Recall score for label_class 0: 0.8214
2024-08-15 17:37:58,612 : INFO : Recall score for label_class 1: 0.9015
2024-08-15 17:37:58,612 : INFO : Recall score for label_class 2: 0.7835
2024-08-15 17:37:58,612 : INFO : Average F1 score: 0.8259
2024-08-15 17:37:58,612 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:37:58,612 : INFO : Starting epoch 5
2024-08-15 17:37:58,663 : INFO : Current training batch loss: 0.0522 in epoch 5
2024-08-15 17:37:59,480 : INFO : Current training batch loss: 0.1187 in epoch 5
2024-08-15 17:38:00,298 : INFO : Current training batch loss: 0.0317 in epoch 5
2024-08-15 17:38:01,116 : INFO : Current training batch loss: 0.0958 in epoch 5
2024-08-15 17:38:01,946 : INFO : Current training batch loss: 0.0235 in epoch 5
2024-08-15 17:38:02,103 : INFO : Epoch finished, average loss over training batches: 0.1014
2024-08-15 17:38:02,103 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:02,103 : INFO : Training metrics:
2024-08-15 17:38:02,103 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:02,110 : INFO : Accuracy: 0.9737
2024-08-15 17:38:02,110 : INFO : Precision score for label_class 0: 0.9267
2024-08-15 17:38:02,110 : INFO : Precision score for label_class 1: 0.9827
2024-08-15 17:38:02,110 : INFO : Precision score for label_class 2: 0.9756
2024-08-15 17:38:02,110 : INFO : Recall score for label_class 0: 0.9576
2024-08-15 17:38:02,110 : INFO : Recall score for label_class 1: 0.9864
2024-08-15 17:38:02,110 : INFO : Recall score for label_class 2: 0.9536
2024-08-15 17:38:02,110 : INFO : Average F1 score: 0.9636
2024-08-15 17:38:02,577 : INFO : Average loss over validation batches: 0.4540
2024-08-15 17:38:02,577 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:02,577 : INFO : Validation metrics:
2024-08-15 17:38:02,577 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:02,580 : INFO : Accuracy: 0.8383
2024-08-15 17:38:02,580 : INFO : Precision score for label_class 0: 0.7158
2024-08-15 17:38:02,580 : INFO : Precision score for label_class 1: 0.9300
2024-08-15 17:38:02,580 : INFO : Precision score for label_class 2: 0.7432
2024-08-15 17:38:02,580 : INFO : Recall score for label_class 0: 0.8095
2024-08-15 17:38:02,580 : INFO : Recall score for label_class 1: 0.8384
2024-08-15 17:38:02,580 : INFO : Recall score for label_class 2: 0.8505
2024-08-15 17:38:02,580 : INFO : Average F1 score: 0.8116
2024-08-15 17:38:02,580 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:38:02,580 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:38:02,614 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:38:03,116 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:03,116 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:38:03,117 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:03,120 : INFO : Accuracy: 0.8635
2024-08-15 17:38:03,120 : INFO : Precision score for label_class 0: 0.7765
2024-08-15 17:38:03,120 : INFO : Precision score for label_class 1: 0.8886
2024-08-15 17:38:03,120 : INFO : Precision score for label_class 2: 0.8466
2024-08-15 17:38:03,120 : INFO : Recall score for label_class 0: 0.7857
2024-08-15 17:38:03,120 : INFO : Recall score for label_class 1: 0.9268
2024-08-15 17:38:03,120 : INFO : Recall score for label_class 2: 0.7680
2024-08-15 17:38:03,120 : INFO : Average F1 score: 0.8313
2024-08-15 17:38:03,120 : INFO : Determined score from best model, ending training.
2024-08-15 17:38:03,121 : INFO : Split 5 is finished, the score is: 0.8313
2024-08-15 17:38:03,121 : INFO : ----------------------------------------------------------------------------------------------------
[I 2024-08-15 17:38:03,136] Trial 17 finished with value: 0.8421289115645582 and parameters: {'n_epochs': 10, 'learning_rate': 5.063961961986326e-05, 'classifier_dropout': 0.4239496749731814, 'warmup_step_fraction': 0.0404958079302055, 'use_gradient_clipping': False}. Best is trial 1 with value: 0.8513001269595835.
2024-08-15 17:38:03,145 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:03,145 : INFO : Starting training for split 1
2024-08-15 17:38:03,157 : INFO : Starting to tokenize the sequences.
2024-08-15 17:38:03,162 : INFO : Tokenization is finished.
2024-08-15 17:38:03,174 : INFO : Starting to tokenize the sequences.
2024-08-15 17:38:03,179 : INFO : Tokenization is finished.
2024-08-15 17:38:03,179 : INFO : Counting occurences of labels...
2024-08-15 17:38:03,180 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1596,  774]))
2024-08-15 17:38:03,180 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 415, 174]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:38:03,234 : INFO : Starting epoch 1
2024-08-15 17:38:03,286 : INFO : Current training batch loss: 1.0962 in epoch 1
2024-08-15 17:38:04,104 : INFO : Current training batch loss: 0.7918 in epoch 1
2024-08-15 17:38:04,921 : INFO : Current training batch loss: 0.7608 in epoch 1
2024-08-15 17:38:05,738 : INFO : Current training batch loss: 0.6950 in epoch 1
2024-08-15 17:38:06,556 : INFO : Current training batch loss: 0.5584 in epoch 1
2024-08-15 17:38:06,708 : INFO : Epoch finished, average loss over training batches: 0.7710
2024-08-15 17:38:06,708 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:06,708 : INFO : Training metrics:
2024-08-15 17:38:06,708 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:06,717 : INFO : Accuracy: 0.6798
2024-08-15 17:38:06,717 : INFO : Precision score for label_class 0: 0.3425
2024-08-15 17:38:06,717 : INFO : Precision score for label_class 1: 0.7195
2024-08-15 17:38:06,717 : INFO : Precision score for label_class 2: 0.5656
2024-08-15 17:38:06,717 : INFO : Recall score for label_class 0: 0.0762
2024-08-15 17:38:06,717 : INFO : Recall score for label_class 1: 0.9499
2024-08-15 17:38:06,717 : INFO : Recall score for label_class 2: 0.3786
2024-08-15 17:38:06,717 : INFO : Average F1 score: 0.4657
2024-08-15 17:38:07,182 : INFO : Average loss over validation batches: 0.5621
2024-08-15 17:38:07,183 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:07,183 : INFO : Validation metrics:
2024-08-15 17:38:07,183 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:07,185 : INFO : Accuracy: 0.7630
2024-08-15 17:38:07,185 : INFO : Precision score for label_class 0: 1.0000
2024-08-15 17:38:07,185 : INFO : Precision score for label_class 1: 0.8937
2024-08-15 17:38:07,185 : INFO : Precision score for label_class 2: 0.5538
2024-08-15 17:38:07,185 : INFO : Recall score for label_class 0: 0.0116
2024-08-15 17:38:07,185 : INFO : Recall score for label_class 1: 0.8916
2024-08-15 17:38:07,185 : INFO : Recall score for label_class 2: 0.8276
2024-08-15 17:38:07,185 : INFO : Average F1 score: 0.5264
2024-08-15 17:38:07,185 : INFO : Validation metric decreased (inf --> 0.562089).  Saving model ...
2024-08-15 17:38:07,297 : INFO : Starting epoch 2
2024-08-15 17:38:07,965 : INFO : Current training batch loss: 0.2648 in epoch 2
2024-08-15 17:38:08,791 : INFO : Current training batch loss: 0.4741 in epoch 2
2024-08-15 17:38:09,608 : INFO : Current training batch loss: 0.4574 in epoch 2
2024-08-15 17:38:10,429 : INFO : Current training batch loss: 0.2987 in epoch 2
2024-08-15 17:38:10,784 : INFO : Epoch finished, average loss over training batches: 0.4031
2024-08-15 17:38:10,784 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:10,784 : INFO : Training metrics:
2024-08-15 17:38:10,784 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:10,788 : INFO : Accuracy: 0.8625
2024-08-15 17:38:10,788 : INFO : Precision score for label_class 0: 0.7978
2024-08-15 17:38:10,788 : INFO : Precision score for label_class 1: 0.8954
2024-08-15 17:38:10,788 : INFO : Precision score for label_class 2: 0.8140
2024-08-15 17:38:10,788 : INFO : Recall score for label_class 0: 0.6738
2024-08-15 17:38:10,788 : INFO : Recall score for label_class 1: 0.9330
2024-08-15 17:38:10,789 : INFO : Recall score for label_class 2: 0.7972
2024-08-15 17:38:10,789 : INFO : Average F1 score: 0.8166
2024-08-15 17:38:11,253 : INFO : Average loss over validation batches: 0.3465
2024-08-15 17:38:11,253 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:11,254 : INFO : Validation metrics:
2024-08-15 17:38:11,254 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:11,256 : INFO : Accuracy: 0.8726
2024-08-15 17:38:11,256 : INFO : Precision score for label_class 0: 0.7692
2024-08-15 17:38:11,256 : INFO : Precision score for label_class 1: 0.9139
2024-08-15 17:38:11,256 : INFO : Precision score for label_class 2: 0.8253
2024-08-15 17:38:11,256 : INFO : Recall score for label_class 0: 0.8140
2024-08-15 17:38:11,256 : INFO : Recall score for label_class 1: 0.9205
2024-08-15 17:38:11,256 : INFO : Recall score for label_class 2: 0.7874
2024-08-15 17:38:11,256 : INFO : Average F1 score: 0.8380
2024-08-15 17:38:11,256 : INFO : Validation metric decreased (0.562089 --> 0.346453).  Saving model ...
2024-08-15 17:38:11,360 : INFO : Starting epoch 3
2024-08-15 17:38:11,814 : INFO : Current training batch loss: 0.3182 in epoch 3
2024-08-15 17:38:12,631 : INFO : Current training batch loss: 0.2036 in epoch 3
2024-08-15 17:38:13,469 : INFO : Current training batch loss: 0.2708 in epoch 3
2024-08-15 17:38:14,296 : INFO : Current training batch loss: 0.1202 in epoch 3
2024-08-15 17:38:14,863 : INFO : Epoch finished, average loss over training batches: 0.2305
2024-08-15 17:38:14,863 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:14,863 : INFO : Training metrics:
2024-08-15 17:38:14,863 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:14,869 : INFO : Accuracy: 0.9307
2024-08-15 17:38:14,869 : INFO : Precision score for label_class 0: 0.8410
2024-08-15 17:38:14,869 : INFO : Precision score for label_class 1: 0.9551
2024-08-15 17:38:14,869 : INFO : Precision score for label_class 2: 0.9198
2024-08-15 17:38:14,869 : INFO : Recall score for label_class 0: 0.8872
2024-08-15 17:38:14,869 : INFO : Recall score for label_class 1: 0.9599
2024-08-15 17:38:14,869 : INFO : Recall score for label_class 2: 0.8889
2024-08-15 17:38:14,869 : INFO : Average F1 score: 0.9084
2024-08-15 17:38:15,336 : INFO : Average loss over validation batches: 0.3635
2024-08-15 17:38:15,336 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:15,336 : INFO : Validation metrics:
2024-08-15 17:38:15,336 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:15,339 : INFO : Accuracy: 0.8622
2024-08-15 17:38:15,339 : INFO : Precision score for label_class 0: 0.7477
2024-08-15 17:38:15,339 : INFO : Precision score for label_class 1: 0.9588
2024-08-15 17:38:15,339 : INFO : Precision score for label_class 2: 0.7500
2024-08-15 17:38:15,339 : INFO : Recall score for label_class 0: 0.9302
2024-08-15 17:38:15,339 : INFO : Recall score for label_class 1: 0.8410
2024-08-15 17:38:15,339 : INFO : Recall score for label_class 2: 0.8793
2024-08-15 17:38:15,339 : INFO : Average F1 score: 0.8449
2024-08-15 17:38:15,339 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:38:15,339 : INFO : Starting epoch 4
2024-08-15 17:38:15,597 : INFO : Current training batch loss: 0.3975 in epoch 4
2024-08-15 17:38:16,441 : INFO : Current training batch loss: 0.0724 in epoch 4
2024-08-15 17:38:17,272 : INFO : Current training batch loss: 0.2405 in epoch 4
2024-08-15 17:38:18,086 : INFO : Current training batch loss: 0.1630 in epoch 4
2024-08-15 17:38:18,840 : INFO : Epoch finished, average loss over training batches: 0.1339
2024-08-15 17:38:18,840 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:18,841 : INFO : Training metrics:
2024-08-15 17:38:18,841 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:18,848 : INFO : Accuracy: 0.9659
2024-08-15 17:38:18,848 : INFO : Precision score for label_class 0: 0.8937
2024-08-15 17:38:18,848 : INFO : Precision score for label_class 1: 0.9812
2024-08-15 17:38:18,848 : INFO : Precision score for label_class 2: 0.9669
2024-08-15 17:38:18,849 : INFO : Recall score for label_class 0: 0.9482
2024-08-15 17:38:18,849 : INFO : Recall score for label_class 1: 0.9799
2024-08-15 17:38:18,849 : INFO : Recall score for label_class 2: 0.9444
2024-08-15 17:38:18,849 : INFO : Average F1 score: 0.9521
2024-08-15 17:38:19,328 : INFO : Average loss over validation batches: 0.3198
2024-08-15 17:38:19,329 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:19,329 : INFO : Validation metrics:
2024-08-15 17:38:19,329 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:19,332 : INFO : Accuracy: 0.8963
2024-08-15 17:38:19,332 : INFO : Precision score for label_class 0: 0.8000
2024-08-15 17:38:19,332 : INFO : Precision score for label_class 1: 0.9257
2024-08-15 17:38:19,332 : INFO : Precision score for label_class 2: 0.8797
2024-08-15 17:38:19,332 : INFO : Recall score for label_class 0: 0.9302
2024-08-15 17:38:19,332 : INFO : Recall score for label_class 1: 0.9301
2024-08-15 17:38:19,332 : INFO : Recall score for label_class 2: 0.7989
2024-08-15 17:38:19,332 : INFO : Average F1 score: 0.8751
2024-08-15 17:38:19,332 : INFO : Validation metric decreased (0.346453 --> 0.319766).  Saving model ...
2024-08-15 17:38:19,449 : INFO : Split 1 is finished, the score is: 0.8751
2024-08-15 17:38:19,449 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:19,449 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:19,449 : INFO : Starting training for split 2
2024-08-15 17:38:19,468 : INFO : Starting to tokenize the sequences.
2024-08-15 17:38:19,474 : INFO : Tokenization is finished.
2024-08-15 17:38:19,492 : INFO : Starting to tokenize the sequences.
2024-08-15 17:38:19,497 : INFO : Tokenization is finished.
2024-08-15 17:38:19,502 : INFO : Counting occurences of labels...
2024-08-15 17:38:19,503 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 343, 1601,  754]))
2024-08-15 17:38:19,504 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 71, 410, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:38:19,667 : INFO : Starting epoch 1
2024-08-15 17:38:19,718 : INFO : Current training batch loss: 1.1129 in epoch 1
2024-08-15 17:38:20,536 : INFO : Current training batch loss: 0.9917 in epoch 1
2024-08-15 17:38:21,350 : INFO : Current training batch loss: 0.7784 in epoch 1
2024-08-15 17:38:22,165 : INFO : Current training batch loss: 0.6336 in epoch 1
2024-08-15 17:38:22,980 : INFO : Current training batch loss: 0.6247 in epoch 1
2024-08-15 17:38:23,131 : INFO : Epoch finished, average loss over training batches: 0.7910
2024-08-15 17:38:23,131 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:23,131 : INFO : Training metrics:
2024-08-15 17:38:23,131 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:23,142 : INFO : Accuracy: 0.6523
2024-08-15 17:38:23,142 : INFO : Precision score for label_class 0: 0.3333
2024-08-15 17:38:23,142 : INFO : Precision score for label_class 1: 0.7166
2024-08-15 17:38:23,142 : INFO : Precision score for label_class 2: 0.4872
2024-08-15 17:38:23,142 : INFO : Recall score for label_class 0: 0.0991
2024-08-15 17:38:23,142 : INFO : Recall score for label_class 1: 0.9001
2024-08-15 17:38:23,142 : INFO : Recall score for label_class 2: 0.3780
2024-08-15 17:38:23,142 : INFO : Average F1 score: 0.4588
2024-08-15 17:38:23,609 : INFO : Average loss over validation batches: 0.5377
2024-08-15 17:38:23,610 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:23,610 : INFO : Validation metrics:
2024-08-15 17:38:23,610 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:23,613 : INFO : Accuracy: 0.7807
2024-08-15 17:38:23,613 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:38:23,613 : INFO : Precision score for label_class 1: 0.8744
2024-08-15 17:38:23,613 : INFO : Precision score for label_class 2: 0.6245
2024-08-15 17:38:23,613 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:38:23,613 : INFO : Recall score for label_class 1: 0.9000
2024-08-15 17:38:23,613 : INFO : Recall score for label_class 2: 0.8144
2024-08-15 17:38:23,613 : INFO : Average F1 score: 0.5313
2024-08-15 17:38:23,613 : INFO : Validation metric decreased (inf --> 0.537743).  Saving model ...
2024-08-15 17:38:23,715 : INFO : Starting epoch 2
2024-08-15 17:38:24,368 : INFO : Current training batch loss: 0.5090 in epoch 2
2024-08-15 17:38:25,182 : INFO : Current training batch loss: 0.4802 in epoch 2
2024-08-15 17:38:25,996 : INFO : Current training batch loss: 0.3132 in epoch 2
2024-08-15 17:38:26,811 : INFO : Current training batch loss: 0.2985 in epoch 2
2024-08-15 17:38:27,162 : INFO : Epoch finished, average loss over training batches: 0.3994
2024-08-15 17:38:27,162 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:27,162 : INFO : Training metrics:
2024-08-15 17:38:27,162 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:27,169 : INFO : Accuracy: 0.8662
2024-08-15 17:38:27,170 : INFO : Precision score for label_class 0: 0.7812
2024-08-15 17:38:27,170 : INFO : Precision score for label_class 1: 0.9019
2024-08-15 17:38:27,170 : INFO : Precision score for label_class 2: 0.8215
2024-08-15 17:38:27,170 : INFO : Recall score for label_class 0: 0.7289
2024-08-15 17:38:27,170 : INFO : Recall score for label_class 1: 0.9357
2024-08-15 17:38:27,170 : INFO : Recall score for label_class 2: 0.7812
2024-08-15 17:38:27,170 : INFO : Average F1 score: 0.8245
2024-08-15 17:38:27,635 : INFO : Average loss over validation batches: 0.3690
2024-08-15 17:38:27,635 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:27,635 : INFO : Validation metrics:
2024-08-15 17:38:27,635 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:27,638 : INFO : Accuracy: 0.8652
2024-08-15 17:38:27,638 : INFO : Precision score for label_class 0: 0.7750
2024-08-15 17:38:27,638 : INFO : Precision score for label_class 1: 0.9121
2024-08-15 17:38:27,638 : INFO : Precision score for label_class 2: 0.8071
2024-08-15 17:38:27,638 : INFO : Recall score for label_class 0: 0.8732
2024-08-15 17:38:27,638 : INFO : Recall score for label_class 1: 0.8854
2024-08-15 17:38:27,638 : INFO : Recall score for label_class 2: 0.8196
2024-08-15 17:38:27,638 : INFO : Average F1 score: 0.8443
2024-08-15 17:38:27,638 : INFO : Validation metric decreased (0.537743 --> 0.369032).  Saving model ...
2024-08-15 17:38:27,739 : INFO : Starting epoch 3
2024-08-15 17:38:28,192 : INFO : Current training batch loss: 0.1626 in epoch 3
2024-08-15 17:38:29,007 : INFO : Current training batch loss: 0.2018 in epoch 3
2024-08-15 17:38:29,822 : INFO : Current training batch loss: 0.2384 in epoch 3
2024-08-15 17:38:30,636 : INFO : Current training batch loss: 0.0565 in epoch 3
2024-08-15 17:38:31,189 : INFO : Epoch finished, average loss over training batches: 0.2181
2024-08-15 17:38:31,189 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:31,189 : INFO : Training metrics:
2024-08-15 17:38:31,189 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:31,197 : INFO : Accuracy: 0.9366
2024-08-15 17:38:31,197 : INFO : Precision score for label_class 0: 0.8678
2024-08-15 17:38:31,197 : INFO : Precision score for label_class 1: 0.9571
2024-08-15 17:38:31,197 : INFO : Precision score for label_class 2: 0.9255
2024-08-15 17:38:31,197 : INFO : Recall score for label_class 0: 0.9184
2024-08-15 17:38:31,197 : INFO : Recall score for label_class 1: 0.9625
2024-08-15 17:38:31,197 : INFO : Recall score for label_class 2: 0.8899
2024-08-15 17:38:31,197 : INFO : Average F1 score: 0.9198
2024-08-15 17:38:31,665 : INFO : Average loss over validation batches: 0.3613
2024-08-15 17:38:31,665 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:31,665 : INFO : Validation metrics:
2024-08-15 17:38:31,665 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:31,668 : INFO : Accuracy: 0.8800
2024-08-15 17:38:31,668 : INFO : Precision score for label_class 0: 0.8056
2024-08-15 17:38:31,668 : INFO : Precision score for label_class 1: 0.9183
2024-08-15 17:38:31,668 : INFO : Precision score for label_class 2: 0.8291
2024-08-15 17:38:31,668 : INFO : Recall score for label_class 0: 0.8169
2024-08-15 17:38:31,668 : INFO : Recall score for label_class 1: 0.9049
2024-08-15 17:38:31,668 : INFO : Recall score for label_class 2: 0.8505
2024-08-15 17:38:31,668 : INFO : Average F1 score: 0.8541
2024-08-15 17:38:31,668 : INFO : Validation metric decreased (0.369032 --> 0.361264).  Saving model ...
2024-08-15 17:38:31,771 : INFO : Starting epoch 4
2024-08-15 17:38:32,024 : INFO : Current training batch loss: 0.2455 in epoch 4
2024-08-15 17:38:32,839 : INFO : Current training batch loss: 0.2288 in epoch 4
2024-08-15 17:38:33,655 : INFO : Current training batch loss: 0.2350 in epoch 4
2024-08-15 17:38:34,469 : INFO : Current training batch loss: 0.1495 in epoch 4
2024-08-15 17:38:35,223 : INFO : Epoch finished, average loss over training batches: 0.1351
2024-08-15 17:38:35,223 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:35,223 : INFO : Training metrics:
2024-08-15 17:38:35,223 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:35,231 : INFO : Accuracy: 0.9681
2024-08-15 17:38:35,231 : INFO : Precision score for label_class 0: 0.9160
2024-08-15 17:38:35,231 : INFO : Precision score for label_class 1: 0.9795
2024-08-15 17:38:35,231 : INFO : Precision score for label_class 2: 0.9686
2024-08-15 17:38:35,231 : INFO : Recall score for label_class 0: 0.9534
2024-08-15 17:38:35,231 : INFO : Recall score for label_class 1: 0.9844
2024-08-15 17:38:35,231 : INFO : Recall score for label_class 2: 0.9403
2024-08-15 17:38:35,231 : INFO : Average F1 score: 0.9568
2024-08-15 17:38:35,700 : INFO : Average loss over validation batches: 0.3599
2024-08-15 17:38:35,700 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:35,700 : INFO : Validation metrics:
2024-08-15 17:38:35,700 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:35,703 : INFO : Accuracy: 0.8756
2024-08-15 17:38:35,703 : INFO : Precision score for label_class 0: 0.8169
2024-08-15 17:38:35,703 : INFO : Precision score for label_class 1: 0.8868
2024-08-15 17:38:35,703 : INFO : Precision score for label_class 2: 0.8713
2024-08-15 17:38:35,703 : INFO : Recall score for label_class 0: 0.8169
2024-08-15 17:38:35,703 : INFO : Recall score for label_class 1: 0.9366
2024-08-15 17:38:35,703 : INFO : Recall score for label_class 2: 0.7680
2024-08-15 17:38:35,703 : INFO : Average F1 score: 0.8481
2024-08-15 17:38:35,703 : INFO : Validation metric decreased (0.361264 --> 0.359885).  Saving model ...
2024-08-15 17:38:35,805 : INFO : Split 2 is finished, the score is: 0.8481
2024-08-15 17:38:35,805 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:35,805 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:35,805 : INFO : Starting training for split 3
2024-08-15 17:38:35,819 : INFO : Starting to tokenize the sequences.
2024-08-15 17:38:35,826 : INFO : Tokenization is finished.
2024-08-15 17:38:35,848 : INFO : Starting to tokenize the sequences.
2024-08-15 17:38:35,853 : INFO : Tokenization is finished.
2024-08-15 17:38:35,859 : INFO : Counting occurences of labels...
2024-08-15 17:38:35,860 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1611,  759]))
2024-08-15 17:38:35,860 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 400, 189]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:38:35,906 : INFO : Starting epoch 1
2024-08-15 17:38:35,957 : INFO : Current training batch loss: 1.1314 in epoch 1
2024-08-15 17:38:36,776 : INFO : Current training batch loss: 0.9677 in epoch 1
2024-08-15 17:38:37,595 : INFO : Current training batch loss: 0.6843 in epoch 1
2024-08-15 17:38:38,420 : INFO : Current training batch loss: 0.6188 in epoch 1
2024-08-15 17:38:39,239 : INFO : Current training batch loss: 0.5289 in epoch 1
2024-08-15 17:38:39,391 : INFO : Epoch finished, average loss over training batches: 0.7552
2024-08-15 17:38:39,391 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:39,391 : INFO : Training metrics:
2024-08-15 17:38:39,391 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:39,399 : INFO : Accuracy: 0.6757
2024-08-15 17:38:39,399 : INFO : Precision score for label_class 0: 0.5405
2024-08-15 17:38:39,399 : INFO : Precision score for label_class 1: 0.7450
2024-08-15 17:38:39,399 : INFO : Precision score for label_class 2: 0.5135
2024-08-15 17:38:39,399 : INFO : Recall score for label_class 0: 0.0610
2024-08-15 17:38:39,399 : INFO : Recall score for label_class 1: 0.8721
2024-08-15 17:38:39,399 : INFO : Recall score for label_class 2: 0.5244
2024-08-15 17:38:39,399 : INFO : Average F1 score: 0.4773
2024-08-15 17:38:39,864 : INFO : Average loss over validation batches: 0.5046
2024-08-15 17:38:39,865 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:39,865 : INFO : Validation metrics:
2024-08-15 17:38:39,865 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:39,867 : INFO : Accuracy: 0.8089
2024-08-15 17:38:39,867 : INFO : Precision score for label_class 0: 0.8542
2024-08-15 17:38:39,867 : INFO : Precision score for label_class 1: 0.9016
2024-08-15 17:38:39,867 : INFO : Precision score for label_class 2: 0.6515
2024-08-15 17:38:39,867 : INFO : Recall score for label_class 0: 0.4767
2024-08-15 17:38:39,867 : INFO : Recall score for label_class 1: 0.8700
2024-08-15 17:38:39,867 : INFO : Recall score for label_class 2: 0.8307
2024-08-15 17:38:39,867 : INFO : Average F1 score: 0.7426
2024-08-15 17:38:39,867 : INFO : Validation metric decreased (inf --> 0.504624).  Saving model ...
2024-08-15 17:38:39,971 : INFO : Starting epoch 2
2024-08-15 17:38:40,633 : INFO : Current training batch loss: 0.5118 in epoch 2
2024-08-15 17:38:41,451 : INFO : Current training batch loss: 0.2984 in epoch 2
2024-08-15 17:38:42,269 : INFO : Current training batch loss: 0.2752 in epoch 2
2024-08-15 17:38:43,087 : INFO : Current training batch loss: 0.2750 in epoch 2
2024-08-15 17:38:43,442 : INFO : Epoch finished, average loss over training batches: 0.3694
2024-08-15 17:38:43,442 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:43,442 : INFO : Training metrics:
2024-08-15 17:38:43,442 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:43,445 : INFO : Accuracy: 0.8762
2024-08-15 17:38:43,446 : INFO : Precision score for label_class 0: 0.7711
2024-08-15 17:38:43,446 : INFO : Precision score for label_class 1: 0.9040
2024-08-15 17:38:43,446 : INFO : Precision score for label_class 2: 0.8600
2024-08-15 17:38:43,446 : INFO : Recall score for label_class 0: 0.7805
2024-08-15 17:38:43,446 : INFO : Recall score for label_class 1: 0.9348
2024-08-15 17:38:43,446 : INFO : Recall score for label_class 2: 0.7931
2024-08-15 17:38:43,446 : INFO : Average F1 score: 0.8400
2024-08-15 17:38:43,912 : INFO : Average loss over validation batches: 0.3553
2024-08-15 17:38:43,912 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:43,912 : INFO : Validation metrics:
2024-08-15 17:38:43,912 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:43,915 : INFO : Accuracy: 0.8726
2024-08-15 17:38:43,915 : INFO : Precision score for label_class 0: 0.8514
2024-08-15 17:38:43,915 : INFO : Precision score for label_class 1: 0.9268
2024-08-15 17:38:43,915 : INFO : Precision score for label_class 2: 0.7756
2024-08-15 17:38:43,915 : INFO : Recall score for label_class 0: 0.7326
2024-08-15 17:38:43,915 : INFO : Recall score for label_class 1: 0.9175
2024-08-15 17:38:43,915 : INFO : Recall score for label_class 2: 0.8413
2024-08-15 17:38:43,915 : INFO : Average F1 score: 0.8389
2024-08-15 17:38:43,915 : INFO : Validation metric decreased (0.504624 --> 0.355283).  Saving model ...
2024-08-15 17:38:44,011 : INFO : Starting epoch 3
2024-08-15 17:38:44,470 : INFO : Current training batch loss: 0.1684 in epoch 3
2024-08-15 17:38:45,289 : INFO : Current training batch loss: 0.2240 in epoch 3
2024-08-15 17:38:46,106 : INFO : Current training batch loss: 0.2699 in epoch 3
2024-08-15 17:38:46,932 : INFO : Current training batch loss: 0.0659 in epoch 3
2024-08-15 17:38:47,497 : INFO : Epoch finished, average loss over training batches: 0.2063
2024-08-15 17:38:47,497 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:47,497 : INFO : Training metrics:
2024-08-15 17:38:47,497 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:47,501 : INFO : Accuracy: 0.9403
2024-08-15 17:38:47,501 : INFO : Precision score for label_class 0: 0.8649
2024-08-15 17:38:47,501 : INFO : Precision score for label_class 1: 0.9581
2024-08-15 17:38:47,501 : INFO : Precision score for label_class 2: 0.9366
2024-08-15 17:38:47,501 : INFO : Recall score for label_class 0: 0.9177
2024-08-15 17:38:47,501 : INFO : Recall score for label_class 1: 0.9659
2024-08-15 17:38:47,501 : INFO : Recall score for label_class 2: 0.8959
2024-08-15 17:38:47,501 : INFO : Average F1 score: 0.9228
2024-08-15 17:38:47,968 : INFO : Average loss over validation batches: 0.3685
2024-08-15 17:38:47,968 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:47,968 : INFO : Validation metrics:
2024-08-15 17:38:47,968 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:47,970 : INFO : Accuracy: 0.8637
2024-08-15 17:38:47,970 : INFO : Precision score for label_class 0: 0.7895
2024-08-15 17:38:47,970 : INFO : Precision score for label_class 1: 0.9457
2024-08-15 17:38:47,970 : INFO : Precision score for label_class 2: 0.7547
2024-08-15 17:38:47,970 : INFO : Recall score for label_class 0: 0.8721
2024-08-15 17:38:47,970 : INFO : Recall score for label_class 1: 0.8700
2024-08-15 17:38:47,970 : INFO : Recall score for label_class 2: 0.8466
2024-08-15 17:38:47,970 : INFO : Average F1 score: 0.8443
2024-08-15 17:38:47,970 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:38:47,970 : INFO : Starting epoch 4
2024-08-15 17:38:48,228 : INFO : Current training batch loss: 0.2790 in epoch 4
2024-08-15 17:38:49,046 : INFO : Current training batch loss: 0.3187 in epoch 4
2024-08-15 17:38:49,864 : INFO : Current training batch loss: 0.2146 in epoch 4
2024-08-15 17:38:50,684 : INFO : Current training batch loss: 0.0790 in epoch 4
2024-08-15 17:38:51,462 : INFO : Epoch finished, average loss over training batches: 0.1377
2024-08-15 17:38:51,463 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:51,463 : INFO : Training metrics:
2024-08-15 17:38:51,463 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:51,466 : INFO : Accuracy: 0.9644
2024-08-15 17:38:51,466 : INFO : Precision score for label_class 0: 0.8986
2024-08-15 17:38:51,466 : INFO : Precision score for label_class 1: 0.9771
2024-08-15 17:38:51,466 : INFO : Precision score for label_class 2: 0.9674
2024-08-15 17:38:51,466 : INFO : Recall score for label_class 0: 0.9451
2024-08-15 17:38:51,466 : INFO : Recall score for label_class 1: 0.9808
2024-08-15 17:38:51,466 : INFO : Recall score for label_class 2: 0.9381
2024-08-15 17:38:51,467 : INFO : Average F1 score: 0.9509
2024-08-15 17:38:51,934 : INFO : Average loss over validation batches: 0.3327
2024-08-15 17:38:51,934 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:51,934 : INFO : Validation metrics:
2024-08-15 17:38:51,934 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:51,937 : INFO : Accuracy: 0.8948
2024-08-15 17:38:51,937 : INFO : Precision score for label_class 0: 0.8261
2024-08-15 17:38:51,937 : INFO : Precision score for label_class 1: 0.9240
2024-08-15 17:38:51,937 : INFO : Precision score for label_class 2: 0.8629
2024-08-15 17:38:51,937 : INFO : Recall score for label_class 0: 0.8837
2024-08-15 17:38:51,937 : INFO : Recall score for label_class 1: 0.9425
2024-08-15 17:38:51,937 : INFO : Recall score for label_class 2: 0.7989
2024-08-15 17:38:51,937 : INFO : Average F1 score: 0.8723
2024-08-15 17:38:51,937 : INFO : Validation metric decreased (0.355283 --> 0.332749).  Saving model ...
2024-08-15 17:38:52,033 : INFO : Split 3 is finished, the score is: 0.8723
2024-08-15 17:38:52,033 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:52,034 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:52,034 : INFO : Starting training for split 4
2024-08-15 17:38:52,049 : INFO : Starting to tokenize the sequences.
2024-08-15 17:38:52,055 : INFO : Tokenization is finished.
2024-08-15 17:38:52,071 : INFO : Starting to tokenize the sequences.
2024-08-15 17:38:52,076 : INFO : Tokenization is finished.
2024-08-15 17:38:52,085 : INFO : Counting occurences of labels...
2024-08-15 17:38:52,086 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 327, 1621,  751]))
2024-08-15 17:38:52,086 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 87, 390, 197]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:38:52,137 : INFO : Starting epoch 1
2024-08-15 17:38:52,188 : INFO : Current training batch loss: 1.1085 in epoch 1
2024-08-15 17:38:53,006 : INFO : Current training batch loss: 0.9710 in epoch 1
2024-08-15 17:38:53,827 : INFO : Current training batch loss: 0.7217 in epoch 1
2024-08-15 17:38:54,646 : INFO : Current training batch loss: 0.5975 in epoch 1
2024-08-15 17:38:55,463 : INFO : Current training batch loss: 0.6486 in epoch 1
2024-08-15 17:38:55,616 : INFO : Epoch finished, average loss over training batches: 0.7920
2024-08-15 17:38:55,616 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:55,616 : INFO : Training metrics:
2024-08-15 17:38:55,616 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:55,624 : INFO : Accuracy: 0.6654
2024-08-15 17:38:55,624 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:38:55,624 : INFO : Precision score for label_class 1: 0.7253
2024-08-15 17:38:55,624 : INFO : Precision score for label_class 2: 0.4898
2024-08-15 17:38:55,624 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:38:55,624 : INFO : Recall score for label_class 1: 0.9007
2024-08-15 17:38:55,624 : INFO : Recall score for label_class 2: 0.4474
2024-08-15 17:38:55,624 : INFO : Average F1 score: 0.4237
2024-08-15 17:38:56,091 : INFO : Average loss over validation batches: 0.6512
2024-08-15 17:38:56,091 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:56,091 : INFO : Validation metrics:
2024-08-15 17:38:56,091 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:56,095 : INFO : Accuracy: 0.7433
2024-08-15 17:38:56,095 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:38:56,095 : INFO : Precision score for label_class 1: 0.8082
2024-08-15 17:38:56,095 : INFO : Precision score for label_class 2: 0.6000
2024-08-15 17:38:56,095 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:38:56,095 : INFO : Recall score for label_class 1: 0.9615
2024-08-15 17:38:56,095 : INFO : Recall score for label_class 2: 0.6396
2024-08-15 17:38:56,095 : INFO : Average F1 score: 0.4991
2024-08-15 17:38:56,095 : INFO : Validation metric decreased (inf --> 0.651174).  Saving model ...
2024-08-15 17:38:56,201 : INFO : Starting epoch 2
2024-08-15 17:38:56,858 : INFO : Current training batch loss: 0.6360 in epoch 2
2024-08-15 17:38:57,675 : INFO : Current training batch loss: 0.4766 in epoch 2
2024-08-15 17:38:58,498 : INFO : Current training batch loss: 0.3199 in epoch 2
2024-08-15 17:38:59,338 : INFO : Current training batch loss: 0.3496 in epoch 2
2024-08-15 17:38:59,697 : INFO : Epoch finished, average loss over training batches: 0.5063
2024-08-15 17:38:59,697 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:59,697 : INFO : Training metrics:
2024-08-15 17:38:59,697 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:38:59,704 : INFO : Accuracy: 0.8007
2024-08-15 17:38:59,704 : INFO : Precision score for label_class 0: 0.7642
2024-08-15 17:38:59,704 : INFO : Precision score for label_class 1: 0.8792
2024-08-15 17:38:59,704 : INFO : Precision score for label_class 2: 0.6521
2024-08-15 17:38:59,704 : INFO : Recall score for label_class 0: 0.2875
2024-08-15 17:38:59,704 : INFO : Recall score for label_class 1: 0.9247
2024-08-15 17:38:59,704 : INFO : Recall score for label_class 2: 0.7563
2024-08-15 17:38:59,704 : INFO : Average F1 score: 0.6732
2024-08-15 17:39:00,170 : INFO : Average loss over validation batches: 0.4651
2024-08-15 17:39:00,170 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:00,170 : INFO : Validation metrics:
2024-08-15 17:39:00,170 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:00,173 : INFO : Accuracy: 0.8101
2024-08-15 17:39:00,173 : INFO : Precision score for label_class 0: 0.6542
2024-08-15 17:39:00,173 : INFO : Precision score for label_class 1: 0.9259
2024-08-15 17:39:00,173 : INFO : Precision score for label_class 2: 0.6991
2024-08-15 17:39:00,173 : INFO : Recall score for label_class 0: 0.8046
2024-08-15 17:39:00,173 : INFO : Recall score for label_class 1: 0.8333
2024-08-15 17:39:00,173 : INFO : Recall score for label_class 2: 0.7665
2024-08-15 17:39:00,173 : INFO : Average F1 score: 0.7767
2024-08-15 17:39:00,174 : INFO : Validation metric decreased (0.651174 --> 0.465075).  Saving model ...
2024-08-15 17:39:00,269 : INFO : Starting epoch 3
2024-08-15 17:39:00,731 : INFO : Current training batch loss: 0.3801 in epoch 3
2024-08-15 17:39:01,551 : INFO : Current training batch loss: 0.3550 in epoch 3
2024-08-15 17:39:02,369 : INFO : Current training batch loss: 0.1518 in epoch 3
2024-08-15 17:39:03,186 : INFO : Current training batch loss: 0.1820 in epoch 3
2024-08-15 17:39:03,743 : INFO : Epoch finished, average loss over training batches: 0.2790
2024-08-15 17:39:03,743 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:03,743 : INFO : Training metrics:
2024-08-15 17:39:03,743 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:03,747 : INFO : Accuracy: 0.9137
2024-08-15 17:39:03,747 : INFO : Precision score for label_class 0: 0.8116
2024-08-15 17:39:03,747 : INFO : Precision score for label_class 1: 0.9471
2024-08-15 17:39:03,747 : INFO : Precision score for label_class 2: 0.8872
2024-08-15 17:39:03,747 : INFO : Recall score for label_class 0: 0.8563
2024-08-15 17:39:03,747 : INFO : Recall score for label_class 1: 0.9506
2024-08-15 17:39:03,747 : INFO : Recall score for label_class 2: 0.8589
2024-08-15 17:39:03,747 : INFO : Average F1 score: 0.8850
2024-08-15 17:39:04,215 : INFO : Average loss over validation batches: 0.3802
2024-08-15 17:39:04,215 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:04,215 : INFO : Validation metrics:
2024-08-15 17:39:04,215 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:04,219 : INFO : Accuracy: 0.8576
2024-08-15 17:39:04,219 : INFO : Precision score for label_class 0: 0.7865
2024-08-15 17:39:04,219 : INFO : Precision score for label_class 1: 0.9039
2024-08-15 17:39:04,219 : INFO : Precision score for label_class 2: 0.8000
2024-08-15 17:39:04,219 : INFO : Recall score for label_class 0: 0.8046
2024-08-15 17:39:04,219 : INFO : Recall score for label_class 1: 0.8923
2024-08-15 17:39:04,219 : INFO : Recall score for label_class 2: 0.8122
2024-08-15 17:39:04,219 : INFO : Average F1 score: 0.8332
2024-08-15 17:39:04,219 : INFO : Validation metric decreased (0.465075 --> 0.380237).  Saving model ...
2024-08-15 17:39:04,320 : INFO : Starting epoch 4
2024-08-15 17:39:04,574 : INFO : Current training batch loss: 0.3360 in epoch 4
2024-08-15 17:39:05,391 : INFO : Current training batch loss: 0.1964 in epoch 4
2024-08-15 17:39:06,210 : INFO : Current training batch loss: 0.1738 in epoch 4
2024-08-15 17:39:07,040 : INFO : Current training batch loss: 0.1606 in epoch 4
2024-08-15 17:39:07,794 : INFO : Epoch finished, average loss over training batches: 0.1723
2024-08-15 17:39:07,794 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:07,794 : INFO : Training metrics:
2024-08-15 17:39:07,794 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:07,801 : INFO : Accuracy: 0.9533
2024-08-15 17:39:07,801 : INFO : Precision score for label_class 0: 0.8732
2024-08-15 17:39:07,801 : INFO : Precision score for label_class 1: 0.9764
2024-08-15 17:39:07,801 : INFO : Precision score for label_class 2: 0.9408
2024-08-15 17:39:07,801 : INFO : Recall score for label_class 0: 0.9266
2024-08-15 17:39:07,801 : INFO : Recall score for label_class 1: 0.9692
2024-08-15 17:39:07,801 : INFO : Recall score for label_class 2: 0.9308
2024-08-15 17:39:07,801 : INFO : Average F1 score: 0.9359
2024-08-15 17:39:08,267 : INFO : Average loss over validation batches: 0.3689
2024-08-15 17:39:08,267 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:08,267 : INFO : Validation metrics:
2024-08-15 17:39:08,267 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:08,270 : INFO : Accuracy: 0.8694
2024-08-15 17:39:08,270 : INFO : Precision score for label_class 0: 0.7889
2024-08-15 17:39:08,270 : INFO : Precision score for label_class 1: 0.8928
2024-08-15 17:39:08,270 : INFO : Precision score for label_class 2: 0.8579
2024-08-15 17:39:08,270 : INFO : Recall score for label_class 0: 0.8161
2024-08-15 17:39:08,270 : INFO : Recall score for label_class 1: 0.9179
2024-08-15 17:39:08,270 : INFO : Recall score for label_class 2: 0.7970
2024-08-15 17:39:08,270 : INFO : Average F1 score: 0.8446
2024-08-15 17:39:08,270 : INFO : Validation metric decreased (0.380237 --> 0.368878).  Saving model ...
2024-08-15 17:39:08,374 : INFO : Split 4 is finished, the score is: 0.8446
2024-08-15 17:39:08,374 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:08,374 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:08,374 : INFO : Starting training for split 5
2024-08-15 17:39:08,390 : INFO : Starting to tokenize the sequences.
2024-08-15 17:39:08,396 : INFO : Tokenization is finished.
2024-08-15 17:39:08,414 : INFO : Starting to tokenize the sequences.
2024-08-15 17:39:08,418 : INFO : Tokenization is finished.
2024-08-15 17:39:08,423 : INFO : Counting occurences of labels...
2024-08-15 17:39:08,424 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 330, 1615,  754]))
2024-08-15 17:39:08,425 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 84, 396, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:39:08,471 : INFO : Starting epoch 1
2024-08-15 17:39:08,523 : INFO : Current training batch loss: 1.1208 in epoch 1
2024-08-15 17:39:09,337 : INFO : Current training batch loss: 0.9797 in epoch 1
2024-08-15 17:39:10,152 : INFO : Current training batch loss: 0.6894 in epoch 1
2024-08-15 17:39:10,967 : INFO : Current training batch loss: 0.6654 in epoch 1
2024-08-15 17:39:11,794 : INFO : Current training batch loss: 0.6614 in epoch 1
2024-08-15 17:39:11,951 : INFO : Epoch finished, average loss over training batches: 0.7673
2024-08-15 17:39:11,952 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:11,952 : INFO : Training metrics:
2024-08-15 17:39:11,952 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:11,963 : INFO : Accuracy: 0.6732
2024-08-15 17:39:11,963 : INFO : Precision score for label_class 0: 0.8500
2024-08-15 17:39:11,963 : INFO : Precision score for label_class 1: 0.7307
2024-08-15 17:39:11,963 : INFO : Precision score for label_class 2: 0.5105
2024-08-15 17:39:11,963 : INFO : Recall score for label_class 0: 0.0515
2024-08-15 17:39:11,963 : INFO : Recall score for label_class 1: 0.8885
2024-08-15 17:39:11,963 : INFO : Recall score for label_class 2: 0.4841
2024-08-15 17:39:11,963 : INFO : Average F1 score: 0.4653
2024-08-15 17:39:12,433 : INFO : Average loss over validation batches: 0.5102
2024-08-15 17:39:12,433 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:12,433 : INFO : Validation metrics:
2024-08-15 17:39:12,433 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:12,436 : INFO : Accuracy: 0.8116
2024-08-15 17:39:12,436 : INFO : Precision score for label_class 0: 0.7797
2024-08-15 17:39:12,436 : INFO : Precision score for label_class 1: 0.8311
2024-08-15 17:39:12,436 : INFO : Precision score for label_class 2: 0.7697
2024-08-15 17:39:12,437 : INFO : Recall score for label_class 0: 0.5476
2024-08-15 17:39:12,437 : INFO : Recall score for label_class 1: 0.9444
2024-08-15 17:39:12,437 : INFO : Recall score for label_class 2: 0.6546
2024-08-15 17:39:12,437 : INFO : Average F1 score: 0.7450
2024-08-15 17:39:12,437 : INFO : Validation metric decreased (inf --> 0.510226).  Saving model ...
2024-08-15 17:39:12,546 : INFO : Starting epoch 2
2024-08-15 17:39:13,201 : INFO : Current training batch loss: 0.4823 in epoch 2
2024-08-15 17:39:14,014 : INFO : Current training batch loss: 0.3077 in epoch 2
2024-08-15 17:39:14,829 : INFO : Current training batch loss: 0.2284 in epoch 2
2024-08-15 17:39:15,644 : INFO : Current training batch loss: 0.3925 in epoch 2
2024-08-15 17:39:15,996 : INFO : Epoch finished, average loss over training batches: 0.3921
2024-08-15 17:39:15,996 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:15,996 : INFO : Training metrics:
2024-08-15 17:39:15,996 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:16,003 : INFO : Accuracy: 0.8688
2024-08-15 17:39:16,003 : INFO : Precision score for label_class 0: 0.7888
2024-08-15 17:39:16,003 : INFO : Precision score for label_class 1: 0.8932
2024-08-15 17:39:16,003 : INFO : Precision score for label_class 2: 0.8463
2024-08-15 17:39:16,003 : INFO : Recall score for label_class 0: 0.7697
2024-08-15 17:39:16,003 : INFO : Recall score for label_class 1: 0.9368
2024-08-15 17:39:16,004 : INFO : Recall score for label_class 2: 0.7666
2024-08-15 17:39:16,004 : INFO : Average F1 score: 0.8327
2024-08-15 17:39:16,468 : INFO : Average loss over validation batches: 0.4065
2024-08-15 17:39:16,468 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:16,468 : INFO : Validation metrics:
2024-08-15 17:39:16,468 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:16,471 : INFO : Accuracy: 0.8427
2024-08-15 17:39:16,471 : INFO : Precision score for label_class 0: 0.8095
2024-08-15 17:39:16,471 : INFO : Precision score for label_class 1: 0.8798
2024-08-15 17:39:16,471 : INFO : Precision score for label_class 2: 0.7744
2024-08-15 17:39:16,471 : INFO : Recall score for label_class 0: 0.6071
2024-08-15 17:39:16,471 : INFO : Recall score for label_class 1: 0.9242
2024-08-15 17:39:16,471 : INFO : Recall score for label_class 2: 0.7784
2024-08-15 17:39:16,471 : INFO : Average F1 score: 0.7906
2024-08-15 17:39:16,471 : INFO : Validation metric decreased (0.510226 --> 0.406544).  Saving model ...
2024-08-15 17:39:16,570 : INFO : Starting epoch 3
2024-08-15 17:39:17,023 : INFO : Current training batch loss: 0.1751 in epoch 3
2024-08-15 17:39:17,838 : INFO : Current training batch loss: 0.1770 in epoch 3
2024-08-15 17:39:18,653 : INFO : Current training batch loss: 0.1056 in epoch 3
2024-08-15 17:39:19,467 : INFO : Current training batch loss: 0.1881 in epoch 3
2024-08-15 17:39:20,020 : INFO : Epoch finished, average loss over training batches: 0.2082
2024-08-15 17:39:20,021 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:20,021 : INFO : Training metrics:
2024-08-15 17:39:20,021 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:20,028 : INFO : Accuracy: 0.9363
2024-08-15 17:39:20,028 : INFO : Precision score for label_class 0: 0.8655
2024-08-15 17:39:20,028 : INFO : Precision score for label_class 1: 0.9564
2024-08-15 17:39:20,028 : INFO : Precision score for label_class 2: 0.9246
2024-08-15 17:39:20,028 : INFO : Recall score for label_class 0: 0.8970
2024-08-15 17:39:20,028 : INFO : Recall score for label_class 1: 0.9641
2024-08-15 17:39:20,028 : INFO : Recall score for label_class 2: 0.8939
2024-08-15 17:39:20,028 : INFO : Average F1 score: 0.9167
2024-08-15 17:39:20,494 : INFO : Average loss over validation batches: 0.4123
2024-08-15 17:39:20,494 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:20,494 : INFO : Validation metrics:
2024-08-15 17:39:20,494 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:20,497 : INFO : Accuracy: 0.8635
2024-08-15 17:39:20,497 : INFO : Precision score for label_class 0: 0.8026
2024-08-15 17:39:20,497 : INFO : Precision score for label_class 1: 0.9057
2024-08-15 17:39:20,497 : INFO : Precision score for label_class 2: 0.8000
2024-08-15 17:39:20,497 : INFO : Recall score for label_class 0: 0.7262
2024-08-15 17:39:20,497 : INFO : Recall score for label_class 1: 0.9217
2024-08-15 17:39:20,497 : INFO : Recall score for label_class 2: 0.8041
2024-08-15 17:39:20,497 : INFO : Average F1 score: 0.8261
2024-08-15 17:39:20,497 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:39:20,497 : INFO : Starting epoch 4
2024-08-15 17:39:20,749 : INFO : Current training batch loss: 0.2779 in epoch 4
2024-08-15 17:39:21,564 : INFO : Current training batch loss: 0.1712 in epoch 4
2024-08-15 17:39:22,378 : INFO : Current training batch loss: 0.1179 in epoch 4
2024-08-15 17:39:23,193 : INFO : Current training batch loss: 0.0544 in epoch 4
2024-08-15 17:39:23,947 : INFO : Epoch finished, average loss over training batches: 0.1229
2024-08-15 17:39:23,948 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:23,948 : INFO : Training metrics:
2024-08-15 17:39:23,948 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:23,955 : INFO : Accuracy: 0.9718
2024-08-15 17:39:23,955 : INFO : Precision score for label_class 0: 0.9263
2024-08-15 17:39:23,955 : INFO : Precision score for label_class 1: 0.9809
2024-08-15 17:39:23,955 : INFO : Precision score for label_class 2: 0.9730
2024-08-15 17:39:23,955 : INFO : Recall score for label_class 0: 0.9515
2024-08-15 17:39:23,955 : INFO : Recall score for label_class 1: 0.9839
2024-08-15 17:39:23,955 : INFO : Recall score for label_class 2: 0.9549
2024-08-15 17:39:23,955 : INFO : Average F1 score: 0.9617
2024-08-15 17:39:24,422 : INFO : Average loss over validation batches: 0.4153
2024-08-15 17:39:24,423 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:24,423 : INFO : Validation metrics:
2024-08-15 17:39:24,423 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:24,426 : INFO : Accuracy: 0.8457
2024-08-15 17:39:24,426 : INFO : Precision score for label_class 0: 0.7470
2024-08-15 17:39:24,426 : INFO : Precision score for label_class 1: 0.9089
2024-08-15 17:39:24,426 : INFO : Precision score for label_class 2: 0.7681
2024-08-15 17:39:24,426 : INFO : Recall score for label_class 0: 0.7381
2024-08-15 17:39:24,426 : INFO : Recall score for label_class 1: 0.8813
2024-08-15 17:39:24,426 : INFO : Recall score for label_class 2: 0.8196
2024-08-15 17:39:24,426 : INFO : Average F1 score: 0.8101
2024-08-15 17:39:24,426 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:39:24,426 : INFO : Last epoch reached, validation loss was better before, loading best model during training.
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:39:24,459 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:39:24,962 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:24,962 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:39:24,962 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:24,966 : INFO : Accuracy: 0.8427
2024-08-15 17:39:24,966 : INFO : Precision score for label_class 0: 0.8095
2024-08-15 17:39:24,966 : INFO : Precision score for label_class 1: 0.8798
2024-08-15 17:39:24,966 : INFO : Precision score for label_class 2: 0.7744
2024-08-15 17:39:24,966 : INFO : Recall score for label_class 0: 0.6071
2024-08-15 17:39:24,966 : INFO : Recall score for label_class 1: 0.9242
2024-08-15 17:39:24,966 : INFO : Recall score for label_class 2: 0.7784
2024-08-15 17:39:24,966 : INFO : Average F1 score: 0.7906
2024-08-15 17:39:24,966 : INFO : Determined score from best model, ending training.
2024-08-15 17:39:24,968 : INFO : Split 5 is finished, the score is: 0.7906
2024-08-15 17:39:24,968 : INFO : ----------------------------------------------------------------------------------------------------
[I 2024-08-15 17:39:24,982] Trial 18 finished with value: 0.8461370718177224 and parameters: {'n_epochs': 4, 'learning_rate': 7.438352424630069e-05, 'classifier_dropout': 0.25097384742907114, 'warmup_step_fraction': 0.02355528302654277, 'use_gradient_clipping': False}. Best is trial 1 with value: 0.8513001269595835.
2024-08-15 17:39:24,990 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:24,990 : INFO : Starting training for split 1
2024-08-15 17:39:25,003 : INFO : Starting to tokenize the sequences.
2024-08-15 17:39:25,008 : INFO : Tokenization is finished.
2024-08-15 17:39:25,020 : INFO : Starting to tokenize the sequences.
2024-08-15 17:39:25,025 : INFO : Tokenization is finished.
2024-08-15 17:39:25,025 : INFO : Counting occurences of labels...
2024-08-15 17:39:25,026 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1596,  774]))
2024-08-15 17:39:25,027 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 415, 174]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:39:25,071 : INFO : Starting epoch 1
2024-08-15 17:39:25,212 : INFO : Current training batch loss: 1.0895 in epoch 1
2024-08-15 17:39:26,063 : INFO : Current training batch loss: 0.8855 in epoch 1
2024-08-15 17:39:26,894 : INFO : Current training batch loss: 0.8851 in epoch 1
2024-08-15 17:39:27,719 : INFO : Current training batch loss: 0.7182 in epoch 1
2024-08-15 17:39:28,559 : INFO : Current training batch loss: 0.7190 in epoch 1
2024-08-15 17:39:28,715 : INFO : Epoch finished, average loss over training batches: 0.8471
2024-08-15 17:39:28,716 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:28,716 : INFO : Training metrics:
2024-08-15 17:39:28,716 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:28,724 : INFO : Accuracy: 0.6605
2024-08-15 17:39:28,724 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:39:28,724 : INFO : Precision score for label_class 1: 0.6905
2024-08-15 17:39:28,724 : INFO : Precision score for label_class 2: 0.5349
2024-08-15 17:39:28,724 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:39:28,724 : INFO : Recall score for label_class 1: 0.9436
2024-08-15 17:39:28,724 : INFO : Recall score for label_class 2: 0.3566
2024-08-15 17:39:28,724 : INFO : Average F1 score: 0.4085
2024-08-15 17:39:29,192 : INFO : Average loss over validation batches: 0.6880
2024-08-15 17:39:29,192 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:29,192 : INFO : Validation metrics:
2024-08-15 17:39:29,192 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:29,195 : INFO : Accuracy: 0.7215
2024-08-15 17:39:29,195 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:39:29,195 : INFO : Precision score for label_class 1: 0.8382
2024-08-15 17:39:29,195 : INFO : Precision score for label_class 2: 0.4957
2024-08-15 17:39:29,195 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:39:29,195 : INFO : Recall score for label_class 1: 0.8988
2024-08-15 17:39:29,195 : INFO : Recall score for label_class 2: 0.6552
2024-08-15 17:39:29,195 : INFO : Average F1 score: 0.4773
2024-08-15 17:39:29,195 : INFO : Validation metric decreased (inf --> 0.687964).  Saving model ...
2024-08-15 17:39:29,287 : INFO : Starting epoch 2
2024-08-15 17:39:29,943 : INFO : Current training batch loss: 0.4232 in epoch 2
2024-08-15 17:39:30,760 : INFO : Current training batch loss: 0.6013 in epoch 2
2024-08-15 17:39:31,576 : INFO : Current training batch loss: 0.4153 in epoch 2
2024-08-15 17:39:32,393 : INFO : Current training batch loss: 0.3641 in epoch 2
2024-08-15 17:39:32,755 : INFO : Epoch finished, average loss over training batches: 0.5227
2024-08-15 17:39:32,756 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:32,756 : INFO : Training metrics:
2024-08-15 17:39:32,756 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:32,764 : INFO : Accuracy: 0.8347
2024-08-15 17:39:32,764 : INFO : Precision score for label_class 0: 0.8143
2024-08-15 17:39:32,764 : INFO : Precision score for label_class 1: 0.8643
2024-08-15 17:39:32,764 : INFO : Precision score for label_class 2: 0.7706
2024-08-15 17:39:32,764 : INFO : Recall score for label_class 0: 0.5213
2024-08-15 17:39:32,764 : INFO : Recall score for label_class 1: 0.9461
2024-08-15 17:39:32,764 : INFO : Recall score for label_class 2: 0.7377
2024-08-15 17:39:32,764 : INFO : Average F1 score: 0.7643
2024-08-15 17:39:33,231 : INFO : Average loss over validation batches: 0.4482
2024-08-15 17:39:33,231 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:33,231 : INFO : Validation metrics:
2024-08-15 17:39:33,231 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:33,233 : INFO : Accuracy: 0.8563
2024-08-15 17:39:33,234 : INFO : Precision score for label_class 0: 0.7955
2024-08-15 17:39:33,234 : INFO : Precision score for label_class 1: 0.9084
2024-08-15 17:39:33,234 : INFO : Precision score for label_class 2: 0.7705
2024-08-15 17:39:33,234 : INFO : Recall score for label_class 0: 0.8140
2024-08-15 17:39:33,234 : INFO : Recall score for label_class 1: 0.8843
2024-08-15 17:39:33,234 : INFO : Recall score for label_class 2: 0.8103
2024-08-15 17:39:33,234 : INFO : Average F1 score: 0.8302
2024-08-15 17:39:33,234 : INFO : Validation metric decreased (0.687964 --> 0.448205).  Saving model ...
2024-08-15 17:39:33,326 : INFO : Starting epoch 3
2024-08-15 17:39:33,781 : INFO : Current training batch loss: 0.3850 in epoch 3
2024-08-15 17:39:34,598 : INFO : Current training batch loss: 0.3745 in epoch 3
2024-08-15 17:39:35,415 : INFO : Current training batch loss: 0.3597 in epoch 3
2024-08-15 17:39:36,232 : INFO : Current training batch loss: 0.2496 in epoch 3
2024-08-15 17:39:36,787 : INFO : Epoch finished, average loss over training batches: 0.3392
2024-08-15 17:39:36,787 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:36,787 : INFO : Training metrics:
2024-08-15 17:39:36,787 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:36,792 : INFO : Accuracy: 0.9092
2024-08-15 17:39:36,792 : INFO : Precision score for label_class 0: 0.8248
2024-08-15 17:39:36,792 : INFO : Precision score for label_class 1: 0.9356
2024-08-15 17:39:36,792 : INFO : Precision score for label_class 2: 0.8887
2024-08-15 17:39:36,792 : INFO : Recall score for label_class 0: 0.8323
2024-08-15 17:39:36,792 : INFO : Recall score for label_class 1: 0.9555
2024-08-15 17:39:36,792 : INFO : Recall score for label_class 2: 0.8463
2024-08-15 17:39:36,792 : INFO : Average F1 score: 0.8803
2024-08-15 17:39:37,261 : INFO : Average loss over validation batches: 0.3786
2024-08-15 17:39:37,261 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:37,261 : INFO : Validation metrics:
2024-08-15 17:39:37,261 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:37,264 : INFO : Accuracy: 0.8726
2024-08-15 17:39:37,264 : INFO : Precision score for label_class 0: 0.7872
2024-08-15 17:39:37,264 : INFO : Precision score for label_class 1: 0.9229
2024-08-15 17:39:37,264 : INFO : Precision score for label_class 2: 0.8045
2024-08-15 17:39:37,264 : INFO : Recall score for label_class 0: 0.8605
2024-08-15 17:39:37,264 : INFO : Recall score for label_class 1: 0.8940
2024-08-15 17:39:37,264 : INFO : Recall score for label_class 2: 0.8276
2024-08-15 17:39:37,264 : INFO : Average F1 score: 0.8488
2024-08-15 17:39:37,264 : INFO : Validation metric decreased (0.448205 --> 0.378613).  Saving model ...
2024-08-15 17:39:37,365 : INFO : Starting epoch 4
2024-08-15 17:39:37,618 : INFO : Current training batch loss: 0.5614 in epoch 4
2024-08-15 17:39:38,435 : INFO : Current training batch loss: 0.3202 in epoch 4
2024-08-15 17:39:39,252 : INFO : Current training batch loss: 0.3344 in epoch 4
2024-08-15 17:39:40,069 : INFO : Current training batch loss: 0.1625 in epoch 4
2024-08-15 17:39:40,825 : INFO : Epoch finished, average loss over training batches: 0.2425
2024-08-15 17:39:40,825 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:40,825 : INFO : Training metrics:
2024-08-15 17:39:40,825 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:40,830 : INFO : Accuracy: 0.9377
2024-08-15 17:39:40,830 : INFO : Precision score for label_class 0: 0.8534
2024-08-15 17:39:40,830 : INFO : Precision score for label_class 1: 0.9591
2024-08-15 17:39:40,830 : INFO : Precision score for label_class 2: 0.9300
2024-08-15 17:39:40,830 : INFO : Recall score for label_class 0: 0.8872
2024-08-15 17:39:40,830 : INFO : Recall score for label_class 1: 0.9699
2024-08-15 17:39:40,830 : INFO : Recall score for label_class 2: 0.8928
2024-08-15 17:39:40,830 : INFO : Average F1 score: 0.9151
2024-08-15 17:39:41,297 : INFO : Average loss over validation batches: 0.4497
2024-08-15 17:39:41,298 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:41,298 : INFO : Validation metrics:
2024-08-15 17:39:41,298 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:41,300 : INFO : Accuracy: 0.8370
2024-08-15 17:39:41,300 : INFO : Precision score for label_class 0: 0.6639
2024-08-15 17:39:41,300 : INFO : Precision score for label_class 1: 0.9544
2024-08-15 17:39:41,300 : INFO : Precision score for label_class 2: 0.7366
2024-08-15 17:39:41,300 : INFO : Recall score for label_class 0: 0.9186
2024-08-15 17:39:41,300 : INFO : Recall score for label_class 1: 0.8072
2024-08-15 17:39:41,300 : INFO : Recall score for label_class 2: 0.8678
2024-08-15 17:39:41,300 : INFO : Average F1 score: 0.8141
2024-08-15 17:39:41,300 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:39:41,300 : INFO : Starting epoch 5
2024-08-15 17:39:41,351 : INFO : Current training batch loss: 0.1811 in epoch 5
2024-08-15 17:39:42,169 : INFO : Current training batch loss: 0.3078 in epoch 5
2024-08-15 17:39:42,987 : INFO : Current training batch loss: 0.0903 in epoch 5
2024-08-15 17:39:43,804 : INFO : Current training batch loss: 0.1978 in epoch 5
2024-08-15 17:39:44,621 : INFO : Current training batch loss: 0.2269 in epoch 5
2024-08-15 17:39:44,773 : INFO : Epoch finished, average loss over training batches: 0.1800
2024-08-15 17:39:44,774 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:44,774 : INFO : Training metrics:
2024-08-15 17:39:44,774 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:44,782 : INFO : Accuracy: 0.9574
2024-08-15 17:39:44,782 : INFO : Precision score for label_class 0: 0.8817
2024-08-15 17:39:44,782 : INFO : Precision score for label_class 1: 0.9732
2024-08-15 17:39:44,782 : INFO : Precision score for label_class 2: 0.9577
2024-08-15 17:39:44,782 : INFO : Recall score for label_class 0: 0.9085
2024-08-15 17:39:44,782 : INFO : Recall score for label_class 1: 0.9781
2024-08-15 17:39:44,782 : INFO : Recall score for label_class 2: 0.9354
2024-08-15 17:39:44,782 : INFO : Average F1 score: 0.9390
2024-08-15 17:39:45,253 : INFO : Average loss over validation batches: 0.3799
2024-08-15 17:39:45,253 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:45,254 : INFO : Validation metrics:
2024-08-15 17:39:45,254 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:45,257 : INFO : Accuracy: 0.8800
2024-08-15 17:39:45,257 : INFO : Precision score for label_class 0: 0.7596
2024-08-15 17:39:45,257 : INFO : Precision score for label_class 1: 0.9369
2024-08-15 17:39:45,257 : INFO : Precision score for label_class 2: 0.8229
2024-08-15 17:39:45,257 : INFO : Recall score for label_class 0: 0.9186
2024-08-15 17:39:45,257 : INFO : Recall score for label_class 1: 0.8940
2024-08-15 17:39:45,257 : INFO : Recall score for label_class 2: 0.8276
2024-08-15 17:39:45,257 : INFO : Average F1 score: 0.8572
2024-08-15 17:39:45,257 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:39:45,257 : INFO : Starting epoch 6
2024-08-15 17:39:45,913 : INFO : Current training batch loss: 0.0448 in epoch 6
2024-08-15 17:39:46,730 : INFO : Current training batch loss: 0.1756 in epoch 6
2024-08-15 17:39:47,548 : INFO : Current training batch loss: 0.0575 in epoch 6
2024-08-15 17:39:48,364 : INFO : Current training batch loss: 0.0475 in epoch 6
2024-08-15 17:39:48,718 : INFO : Epoch finished, average loss over training batches: 0.1381
2024-08-15 17:39:48,718 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:48,718 : INFO : Training metrics:
2024-08-15 17:39:48,718 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:48,723 : INFO : Accuracy: 0.9703
2024-08-15 17:39:48,723 : INFO : Precision score for label_class 0: 0.9147
2024-08-15 17:39:48,723 : INFO : Precision score for label_class 1: 0.9831
2024-08-15 17:39:48,723 : INFO : Precision score for label_class 2: 0.9685
2024-08-15 17:39:48,723 : INFO : Recall score for label_class 0: 0.9482
2024-08-15 17:39:48,723 : INFO : Recall score for label_class 1: 0.9831
2024-08-15 17:39:48,723 : INFO : Recall score for label_class 2: 0.9535
2024-08-15 17:39:48,723 : INFO : Average F1 score: 0.9584
2024-08-15 17:39:49,192 : INFO : Average loss over validation batches: 0.3806
2024-08-15 17:39:49,192 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:49,192 : INFO : Validation metrics:
2024-08-15 17:39:49,192 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:49,195 : INFO : Accuracy: 0.8830
2024-08-15 17:39:49,195 : INFO : Precision score for label_class 0: 0.7723
2024-08-15 17:39:49,195 : INFO : Precision score for label_class 1: 0.9165
2024-08-15 17:39:49,195 : INFO : Precision score for label_class 2: 0.8645
2024-08-15 17:39:49,195 : INFO : Recall score for label_class 0: 0.9070
2024-08-15 17:39:49,195 : INFO : Recall score for label_class 1: 0.9253
2024-08-15 17:39:49,195 : INFO : Recall score for label_class 2: 0.7701
2024-08-15 17:39:49,195 : INFO : Average F1 score: 0.8566
2024-08-15 17:39:49,195 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:39:49,195 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:39:49,229 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:39:49,725 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:49,725 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:39:49,725 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:49,727 : INFO : Accuracy: 0.8726
2024-08-15 17:39:49,727 : INFO : Precision score for label_class 0: 0.7872
2024-08-15 17:39:49,727 : INFO : Precision score for label_class 1: 0.9229
2024-08-15 17:39:49,727 : INFO : Precision score for label_class 2: 0.8045
2024-08-15 17:39:49,727 : INFO : Recall score for label_class 0: 0.8605
2024-08-15 17:39:49,727 : INFO : Recall score for label_class 1: 0.8940
2024-08-15 17:39:49,727 : INFO : Recall score for label_class 2: 0.8276
2024-08-15 17:39:49,727 : INFO : Average F1 score: 0.8488
2024-08-15 17:39:49,727 : INFO : Determined score from best model, ending training.
2024-08-15 17:39:49,734 : INFO : Split 1 is finished, the score is: 0.8488
2024-08-15 17:39:49,734 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:49,734 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:49,734 : INFO : Starting training for split 2
2024-08-15 17:39:49,748 : INFO : Starting to tokenize the sequences.
2024-08-15 17:39:49,754 : INFO : Tokenization is finished.
2024-08-15 17:39:49,771 : INFO : Starting to tokenize the sequences.
2024-08-15 17:39:49,776 : INFO : Tokenization is finished.
2024-08-15 17:39:49,781 : INFO : Counting occurences of labels...
2024-08-15 17:39:49,782 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 343, 1601,  754]))
2024-08-15 17:39:49,782 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 71, 410, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:39:49,834 : INFO : Starting epoch 1
2024-08-15 17:39:49,885 : INFO : Current training batch loss: 1.0830 in epoch 1
2024-08-15 17:39:50,703 : INFO : Current training batch loss: 0.9944 in epoch 1
2024-08-15 17:39:51,520 : INFO : Current training batch loss: 0.8849 in epoch 1
2024-08-15 17:39:52,339 : INFO : Current training batch loss: 0.6994 in epoch 1
2024-08-15 17:39:53,156 : INFO : Current training batch loss: 0.6526 in epoch 1
2024-08-15 17:39:53,308 : INFO : Epoch finished, average loss over training batches: 0.8354
2024-08-15 17:39:53,308 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:53,308 : INFO : Training metrics:
2024-08-15 17:39:53,308 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:53,316 : INFO : Accuracy: 0.6572
2024-08-15 17:39:53,316 : INFO : Precision score for label_class 0: 0.6250
2024-08-15 17:39:53,316 : INFO : Precision score for label_class 1: 0.6791
2024-08-15 17:39:53,316 : INFO : Precision score for label_class 2: 0.5375
2024-08-15 17:39:53,316 : INFO : Recall score for label_class 0: 0.0875
2024-08-15 17:39:53,316 : INFO : Recall score for label_class 1: 0.9544
2024-08-15 17:39:53,316 : INFO : Recall score for label_class 2: 0.2851
2024-08-15 17:39:53,316 : INFO : Average F1 score: 0.4399
2024-08-15 17:39:53,786 : INFO : Average loss over validation batches: 0.5996
2024-08-15 17:39:53,786 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:53,786 : INFO : Validation metrics:
2024-08-15 17:39:53,786 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:53,790 : INFO : Accuracy: 0.8074
2024-08-15 17:39:53,790 : INFO : Precision score for label_class 0: 0.8750
2024-08-15 17:39:53,790 : INFO : Precision score for label_class 1: 0.8255
2024-08-15 17:39:53,790 : INFO : Precision score for label_class 2: 0.7457
2024-08-15 17:39:53,790 : INFO : Recall score for label_class 0: 0.3944
2024-08-15 17:39:53,790 : INFO : Recall score for label_class 1: 0.9463
2024-08-15 17:39:53,790 : INFO : Recall score for label_class 2: 0.6649
2024-08-15 17:39:53,790 : INFO : Average F1 score: 0.7095
2024-08-15 17:39:53,790 : INFO : Validation metric decreased (inf --> 0.599599).  Saving model ...
2024-08-15 17:39:53,893 : INFO : Starting epoch 2
2024-08-15 17:39:54,549 : INFO : Current training batch loss: 0.5545 in epoch 2
2024-08-15 17:39:55,366 : INFO : Current training batch loss: 0.5505 in epoch 2
2024-08-15 17:39:56,193 : INFO : Current training batch loss: 0.4621 in epoch 2
2024-08-15 17:39:57,006 : INFO : Current training batch loss: 0.4104 in epoch 2
2024-08-15 17:39:57,350 : INFO : Epoch finished, average loss over training batches: 0.4755
2024-08-15 17:39:57,350 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:57,350 : INFO : Training metrics:
2024-08-15 17:39:57,350 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:57,358 : INFO : Accuracy: 0.8603
2024-08-15 17:39:57,358 : INFO : Precision score for label_class 0: 0.8006
2024-08-15 17:39:57,358 : INFO : Precision score for label_class 1: 0.8815
2024-08-15 17:39:57,358 : INFO : Precision score for label_class 2: 0.8348
2024-08-15 17:39:57,358 : INFO : Recall score for label_class 0: 0.7376
2024-08-15 17:39:57,358 : INFO : Recall score for label_class 1: 0.9382
2024-08-15 17:39:57,358 : INFO : Recall score for label_class 2: 0.7507
2024-08-15 17:39:57,358 : INFO : Average F1 score: 0.8224
2024-08-15 17:39:57,827 : INFO : Average loss over validation batches: 0.4180
2024-08-15 17:39:57,828 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:57,828 : INFO : Validation metrics:
2024-08-15 17:39:57,828 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:39:57,831 : INFO : Accuracy: 0.8637
2024-08-15 17:39:57,831 : INFO : Precision score for label_class 0: 0.7969
2024-08-15 17:39:57,831 : INFO : Precision score for label_class 1: 0.8759
2024-08-15 17:39:57,831 : INFO : Precision score for label_class 2: 0.8580
2024-08-15 17:39:57,831 : INFO : Recall score for label_class 0: 0.7183
2024-08-15 17:39:57,831 : INFO : Recall score for label_class 1: 0.9293
2024-08-15 17:39:57,831 : INFO : Recall score for label_class 2: 0.7784
2024-08-15 17:39:57,831 : INFO : Average F1 score: 0.8245
2024-08-15 17:39:57,831 : INFO : Validation metric decreased (0.599599 --> 0.417956).  Saving model ...
2024-08-15 17:39:57,928 : INFO : Starting epoch 3
2024-08-15 17:39:58,392 : INFO : Current training batch loss: 0.2664 in epoch 3
2024-08-15 17:39:59,214 : INFO : Current training batch loss: 0.2552 in epoch 3
2024-08-15 17:40:00,036 : INFO : Current training batch loss: 0.3958 in epoch 3
2024-08-15 17:40:00,855 : INFO : Current training batch loss: 0.1853 in epoch 3
2024-08-15 17:40:01,432 : INFO : Epoch finished, average loss over training batches: 0.2996
2024-08-15 17:40:01,433 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:01,433 : INFO : Training metrics:
2024-08-15 17:40:01,433 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:01,443 : INFO : Accuracy: 0.9222
2024-08-15 17:40:01,443 : INFO : Precision score for label_class 0: 0.8632
2024-08-15 17:40:01,443 : INFO : Precision score for label_class 1: 0.9395
2024-08-15 17:40:01,443 : INFO : Precision score for label_class 2: 0.9114
2024-08-15 17:40:01,443 : INFO : Recall score for label_class 0: 0.8834
2024-08-15 17:40:01,443 : INFO : Recall score for label_class 1: 0.9600
2024-08-15 17:40:01,443 : INFO : Recall score for label_class 2: 0.8594
2024-08-15 17:40:01,443 : INFO : Average F1 score: 0.9025
2024-08-15 17:40:01,914 : INFO : Average loss over validation batches: 0.3833
2024-08-15 17:40:01,914 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:01,914 : INFO : Validation metrics:
2024-08-15 17:40:01,914 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:01,917 : INFO : Accuracy: 0.8711
2024-08-15 17:40:01,917 : INFO : Precision score for label_class 0: 0.8116
2024-08-15 17:40:01,917 : INFO : Precision score for label_class 1: 0.8879
2024-08-15 17:40:01,917 : INFO : Precision score for label_class 2: 0.8539
2024-08-15 17:40:01,917 : INFO : Recall score for label_class 0: 0.7887
2024-08-15 17:40:01,917 : INFO : Recall score for label_class 1: 0.9268
2024-08-15 17:40:01,917 : INFO : Recall score for label_class 2: 0.7835
2024-08-15 17:40:01,917 : INFO : Average F1 score: 0.8414
2024-08-15 17:40:01,917 : INFO : Validation metric decreased (0.417956 --> 0.383263).  Saving model ...
2024-08-15 17:40:02,021 : INFO : Starting epoch 4
2024-08-15 17:40:02,275 : INFO : Current training batch loss: 0.3637 in epoch 4
2024-08-15 17:40:03,101 : INFO : Current training batch loss: 0.2166 in epoch 4
2024-08-15 17:40:03,940 : INFO : Current training batch loss: 0.3084 in epoch 4
2024-08-15 17:40:04,758 : INFO : Current training batch loss: 0.1787 in epoch 4
2024-08-15 17:40:05,503 : INFO : Epoch finished, average loss over training batches: 0.2127
2024-08-15 17:40:05,503 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:05,503 : INFO : Training metrics:
2024-08-15 17:40:05,503 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:05,511 : INFO : Accuracy: 0.9474
2024-08-15 17:40:05,511 : INFO : Precision score for label_class 0: 0.8946
2024-08-15 17:40:05,511 : INFO : Precision score for label_class 1: 0.9594
2024-08-15 17:40:05,511 : INFO : Precision score for label_class 2: 0.9458
2024-08-15 17:40:05,511 : INFO : Recall score for label_class 0: 0.9155
2024-08-15 17:40:05,511 : INFO : Recall score for label_class 1: 0.9750
2024-08-15 17:40:05,511 : INFO : Recall score for label_class 2: 0.9032
2024-08-15 17:40:05,511 : INFO : Average F1 score: 0.9320
2024-08-15 17:40:05,989 : INFO : Average loss over validation batches: 0.4139
2024-08-15 17:40:05,989 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:05,989 : INFO : Validation metrics:
2024-08-15 17:40:05,989 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:05,993 : INFO : Accuracy: 0.8533
2024-08-15 17:40:05,993 : INFO : Precision score for label_class 0: 0.7191
2024-08-15 17:40:05,993 : INFO : Precision score for label_class 1: 0.9351
2024-08-15 17:40:05,993 : INFO : Precision score for label_class 2: 0.7685
2024-08-15 17:40:05,993 : INFO : Recall score for label_class 0: 0.9014
2024-08-15 17:40:05,993 : INFO : Recall score for label_class 1: 0.8439
2024-08-15 17:40:05,993 : INFO : Recall score for label_class 2: 0.8557
2024-08-15 17:40:05,993 : INFO : Average F1 score: 0.8323
2024-08-15 17:40:05,993 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:40:05,993 : INFO : Starting epoch 5
2024-08-15 17:40:06,045 : INFO : Current training batch loss: 0.1617 in epoch 5
2024-08-15 17:40:06,875 : INFO : Current training batch loss: 0.3902 in epoch 5
2024-08-15 17:40:07,694 : INFO : Current training batch loss: 0.0723 in epoch 5
2024-08-15 17:40:08,512 : INFO : Current training batch loss: 0.1790 in epoch 5
2024-08-15 17:40:09,332 : INFO : Current training batch loss: 0.3903 in epoch 5
2024-08-15 17:40:09,484 : INFO : Epoch finished, average loss over training batches: 0.1654
2024-08-15 17:40:09,484 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:09,484 : INFO : Training metrics:
2024-08-15 17:40:09,484 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:09,494 : INFO : Accuracy: 0.9615
2024-08-15 17:40:09,494 : INFO : Precision score for label_class 0: 0.9101
2024-08-15 17:40:09,494 : INFO : Precision score for label_class 1: 0.9703
2024-08-15 17:40:09,494 : INFO : Precision score for label_class 2: 0.9669
2024-08-15 17:40:09,494 : INFO : Recall score for label_class 0: 0.9446
2024-08-15 17:40:09,494 : INFO : Recall score for label_class 1: 0.9794
2024-08-15 17:40:09,495 : INFO : Recall score for label_class 2: 0.9310
2024-08-15 17:40:09,495 : INFO : Average F1 score: 0.9502
2024-08-15 17:40:09,965 : INFO : Average loss over validation batches: 0.4163
2024-08-15 17:40:09,965 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:09,965 : INFO : Validation metrics:
2024-08-15 17:40:09,965 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:09,969 : INFO : Accuracy: 0.8667
2024-08-15 17:40:09,969 : INFO : Precision score for label_class 0: 0.7662
2024-08-15 17:40:09,969 : INFO : Precision score for label_class 1: 0.8799
2024-08-15 17:40:09,969 : INFO : Precision score for label_class 2: 0.8788
2024-08-15 17:40:09,969 : INFO : Recall score for label_class 0: 0.8310
2024-08-15 17:40:09,969 : INFO : Recall score for label_class 1: 0.9293
2024-08-15 17:40:09,969 : INFO : Recall score for label_class 2: 0.7474
2024-08-15 17:40:09,969 : INFO : Average F1 score: 0.8363
2024-08-15 17:40:09,969 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:40:09,969 : INFO : Starting epoch 6
2024-08-15 17:40:10,625 : INFO : Current training batch loss: 0.1440 in epoch 6
2024-08-15 17:40:11,443 : INFO : Current training batch loss: 0.1768 in epoch 6
2024-08-15 17:40:12,262 : INFO : Current training batch loss: 0.0477 in epoch 6
2024-08-15 17:40:13,079 : INFO : Current training batch loss: 0.0824 in epoch 6
2024-08-15 17:40:13,433 : INFO : Epoch finished, average loss over training batches: 0.1214
2024-08-15 17:40:13,433 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:13,433 : INFO : Training metrics:
2024-08-15 17:40:13,433 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:13,441 : INFO : Accuracy: 0.9744
2024-08-15 17:40:13,441 : INFO : Precision score for label_class 0: 0.9237
2024-08-15 17:40:13,441 : INFO : Precision score for label_class 1: 0.9838
2024-08-15 17:40:13,441 : INFO : Precision score for label_class 2: 0.9783
2024-08-15 17:40:13,441 : INFO : Recall score for label_class 0: 0.9534
2024-08-15 17:40:13,441 : INFO : Recall score for label_class 1: 0.9875
2024-08-15 17:40:13,441 : INFO : Recall score for label_class 2: 0.9562
2024-08-15 17:40:13,441 : INFO : Average F1 score: 0.9637
2024-08-15 17:40:13,910 : INFO : Average loss over validation batches: 0.4540
2024-08-15 17:40:13,910 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:13,910 : INFO : Validation metrics:
2024-08-15 17:40:13,910 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:13,914 : INFO : Accuracy: 0.8681
2024-08-15 17:40:13,914 : INFO : Precision score for label_class 0: 0.7568
2024-08-15 17:40:13,914 : INFO : Precision score for label_class 1: 0.8702
2024-08-15 17:40:13,914 : INFO : Precision score for label_class 2: 0.9156
2024-08-15 17:40:13,914 : INFO : Recall score for label_class 0: 0.7887
2024-08-15 17:40:13,914 : INFO : Recall score for label_class 1: 0.9488
2024-08-15 17:40:13,914 : INFO : Recall score for label_class 2: 0.7268
2024-08-15 17:40:13,914 : INFO : Average F1 score: 0.8302
2024-08-15 17:40:13,914 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:40:13,914 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:40:13,951 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:40:14,449 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:14,449 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:40:14,449 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:14,453 : INFO : Accuracy: 0.8711
2024-08-15 17:40:14,453 : INFO : Precision score for label_class 0: 0.8116
2024-08-15 17:40:14,453 : INFO : Precision score for label_class 1: 0.8879
2024-08-15 17:40:14,453 : INFO : Precision score for label_class 2: 0.8539
2024-08-15 17:40:14,453 : INFO : Recall score for label_class 0: 0.7887
2024-08-15 17:40:14,453 : INFO : Recall score for label_class 1: 0.9268
2024-08-15 17:40:14,453 : INFO : Recall score for label_class 2: 0.7835
2024-08-15 17:40:14,453 : INFO : Average F1 score: 0.8414
2024-08-15 17:40:14,453 : INFO : Determined score from best model, ending training.
2024-08-15 17:40:14,454 : INFO : Split 2 is finished, the score is: 0.8414
2024-08-15 17:40:14,454 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:14,454 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:14,454 : INFO : Starting training for split 3
2024-08-15 17:40:14,467 : INFO : Starting to tokenize the sequences.
2024-08-15 17:40:14,473 : INFO : Tokenization is finished.
2024-08-15 17:40:14,490 : INFO : Starting to tokenize the sequences.
2024-08-15 17:40:14,495 : INFO : Tokenization is finished.
2024-08-15 17:40:14,500 : INFO : Counting occurences of labels...
2024-08-15 17:40:14,501 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1611,  759]))
2024-08-15 17:40:14,501 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 400, 189]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:40:14,542 : INFO : Starting epoch 1
2024-08-15 17:40:14,594 : INFO : Current training batch loss: 1.0971 in epoch 1
2024-08-15 17:40:15,418 : INFO : Current training batch loss: 1.0004 in epoch 1
2024-08-15 17:40:16,235 : INFO : Current training batch loss: 0.8112 in epoch 1
2024-08-15 17:40:17,053 : INFO : Current training batch loss: 0.7049 in epoch 1
2024-08-15 17:40:17,870 : INFO : Current training batch loss: 0.7426 in epoch 1
2024-08-15 17:40:18,022 : INFO : Epoch finished, average loss over training batches: 0.8502
2024-08-15 17:40:18,023 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:18,023 : INFO : Training metrics:
2024-08-15 17:40:18,023 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:18,030 : INFO : Accuracy: 0.6490
2024-08-15 17:40:18,030 : INFO : Precision score for label_class 0: 0.1507
2024-08-15 17:40:18,030 : INFO : Precision score for label_class 1: 0.6835
2024-08-15 17:40:18,030 : INFO : Precision score for label_class 2: 0.5521
2024-08-15 17:40:18,030 : INFO : Recall score for label_class 0: 0.0335
2024-08-15 17:40:18,030 : INFO : Recall score for label_class 1: 0.9385
2024-08-15 17:40:18,030 : INFO : Recall score for label_class 2: 0.3004
2024-08-15 17:40:18,030 : INFO : Average F1 score: 0.4116
2024-08-15 17:40:18,496 : INFO : Average loss over validation batches: 0.6753
2024-08-15 17:40:18,496 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:18,496 : INFO : Validation metrics:
2024-08-15 17:40:18,496 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:18,499 : INFO : Accuracy: 0.7363
2024-08-15 17:40:18,499 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:40:18,499 : INFO : Precision score for label_class 1: 0.8494
2024-08-15 17:40:18,499 : INFO : Precision score for label_class 2: 0.5440
2024-08-15 17:40:18,499 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:40:18,499 : INFO : Recall score for label_class 1: 0.9025
2024-08-15 17:40:18,499 : INFO : Recall score for label_class 2: 0.7196
2024-08-15 17:40:18,499 : INFO : Average F1 score: 0.4982
2024-08-15 17:40:18,499 : INFO : Validation metric decreased (inf --> 0.675305).  Saving model ...
2024-08-15 17:40:18,611 : INFO : Starting epoch 2
2024-08-15 17:40:19,268 : INFO : Current training batch loss: 0.6255 in epoch 2
2024-08-15 17:40:20,085 : INFO : Current training batch loss: 0.5185 in epoch 2
2024-08-15 17:40:20,902 : INFO : Current training batch loss: 0.5095 in epoch 2
2024-08-15 17:40:21,720 : INFO : Current training batch loss: 0.4548 in epoch 2
2024-08-15 17:40:22,073 : INFO : Epoch finished, average loss over training batches: 0.5658
2024-08-15 17:40:22,074 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:22,074 : INFO : Training metrics:
2024-08-15 17:40:22,074 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:22,081 : INFO : Accuracy: 0.7954
2024-08-15 17:40:22,081 : INFO : Precision score for label_class 0: 0.8125
2024-08-15 17:40:22,081 : INFO : Precision score for label_class 1: 0.8598
2024-08-15 17:40:22,081 : INFO : Precision score for label_class 2: 0.6596
2024-08-15 17:40:22,081 : INFO : Recall score for label_class 0: 0.1982
2024-08-15 17:40:22,081 : INFO : Recall score for label_class 1: 0.9441
2024-08-15 17:40:22,081 : INFO : Recall score for label_class 2: 0.7378
2024-08-15 17:40:22,081 : INFO : Average F1 score: 0.6384
2024-08-15 17:40:22,547 : INFO : Average loss over validation batches: 0.4754
2024-08-15 17:40:22,547 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:22,547 : INFO : Validation metrics:
2024-08-15 17:40:22,547 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:22,549 : INFO : Accuracy: 0.8607
2024-08-15 17:40:22,549 : INFO : Precision score for label_class 0: 0.8219
2024-08-15 17:40:22,549 : INFO : Precision score for label_class 1: 0.8871
2024-08-15 17:40:22,549 : INFO : Precision score for label_class 2: 0.8136
2024-08-15 17:40:22,549 : INFO : Recall score for label_class 0: 0.6977
2024-08-15 17:40:22,549 : INFO : Recall score for label_class 1: 0.9425
2024-08-15 17:40:22,549 : INFO : Recall score for label_class 2: 0.7619
2024-08-15 17:40:22,549 : INFO : Average F1 score: 0.8185
2024-08-15 17:40:22,549 : INFO : Validation metric decreased (0.675305 --> 0.475421).  Saving model ...
2024-08-15 17:40:22,652 : INFO : Starting epoch 3
2024-08-15 17:40:23,107 : INFO : Current training batch loss: 0.4060 in epoch 3
2024-08-15 17:40:23,925 : INFO : Current training batch loss: 0.4162 in epoch 3
2024-08-15 17:40:24,743 : INFO : Current training batch loss: 0.4055 in epoch 3
2024-08-15 17:40:25,564 : INFO : Current training batch loss: 0.2270 in epoch 3
2024-08-15 17:40:26,129 : INFO : Epoch finished, average loss over training batches: 0.3639
2024-08-15 17:40:26,130 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:26,130 : INFO : Training metrics:
2024-08-15 17:40:26,130 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:26,137 : INFO : Accuracy: 0.8992
2024-08-15 17:40:26,137 : INFO : Precision score for label_class 0: 0.8086
2024-08-15 17:40:26,137 : INFO : Precision score for label_class 1: 0.9258
2024-08-15 17:40:26,137 : INFO : Precision score for label_class 2: 0.8787
2024-08-15 17:40:26,137 : INFO : Recall score for label_class 0: 0.7988
2024-08-15 17:40:26,137 : INFO : Recall score for label_class 1: 0.9522
2024-08-15 17:40:26,137 : INFO : Recall score for label_class 2: 0.8300
2024-08-15 17:40:26,137 : INFO : Average F1 score: 0.8654
2024-08-15 17:40:26,612 : INFO : Average loss over validation batches: 0.3885
2024-08-15 17:40:26,612 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:26,612 : INFO : Validation metrics:
2024-08-15 17:40:26,612 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:26,615 : INFO : Accuracy: 0.8622
2024-08-15 17:40:26,615 : INFO : Precision score for label_class 0: 0.8333
2024-08-15 17:40:26,615 : INFO : Precision score for label_class 1: 0.9201
2024-08-15 17:40:26,615 : INFO : Precision score for label_class 2: 0.7635
2024-08-15 17:40:26,615 : INFO : Recall score for label_class 0: 0.8140
2024-08-15 17:40:26,615 : INFO : Recall score for label_class 1: 0.8925
2024-08-15 17:40:26,615 : INFO : Recall score for label_class 2: 0.8201
2024-08-15 17:40:26,615 : INFO : Average F1 score: 0.8401
2024-08-15 17:40:26,615 : INFO : Validation metric decreased (0.475421 --> 0.388472).  Saving model ...
2024-08-15 17:40:26,719 : INFO : Starting epoch 4
2024-08-15 17:40:26,972 : INFO : Current training batch loss: 0.3751 in epoch 4
2024-08-15 17:40:27,790 : INFO : Current training batch loss: 0.3586 in epoch 4
2024-08-15 17:40:28,620 : INFO : Current training batch loss: 0.2702 in epoch 4
2024-08-15 17:40:29,437 : INFO : Current training batch loss: 0.1655 in epoch 4
2024-08-15 17:40:30,194 : INFO : Epoch finished, average loss over training batches: 0.2489
2024-08-15 17:40:30,194 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:30,194 : INFO : Training metrics:
2024-08-15 17:40:30,194 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:30,202 : INFO : Accuracy: 0.9344
2024-08-15 17:40:30,202 : INFO : Precision score for label_class 0: 0.8671
2024-08-15 17:40:30,202 : INFO : Precision score for label_class 1: 0.9533
2024-08-15 17:40:30,202 : INFO : Precision score for label_class 2: 0.9228
2024-08-15 17:40:30,202 : INFO : Recall score for label_class 0: 0.8750
2024-08-15 17:40:30,202 : INFO : Recall score for label_class 1: 0.9640
2024-08-15 17:40:30,202 : INFO : Recall score for label_class 2: 0.8972
2024-08-15 17:40:30,202 : INFO : Average F1 score: 0.9132
2024-08-15 17:40:30,669 : INFO : Average loss over validation batches: 0.3936
2024-08-15 17:40:30,669 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:30,669 : INFO : Validation metrics:
2024-08-15 17:40:30,669 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:30,671 : INFO : Accuracy: 0.8563
2024-08-15 17:40:30,671 : INFO : Precision score for label_class 0: 0.7379
2024-08-15 17:40:30,671 : INFO : Precision score for label_class 1: 0.9375
2024-08-15 17:40:30,671 : INFO : Precision score for label_class 2: 0.7696
2024-08-15 17:40:30,671 : INFO : Recall score for label_class 0: 0.8837
2024-08-15 17:40:30,671 : INFO : Recall score for label_class 1: 0.8625
2024-08-15 17:40:30,671 : INFO : Recall score for label_class 2: 0.8307
2024-08-15 17:40:30,671 : INFO : Average F1 score: 0.8339
2024-08-15 17:40:30,671 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:40:30,671 : INFO : Starting epoch 5
2024-08-15 17:40:30,722 : INFO : Current training batch loss: 0.1881 in epoch 5
2024-08-15 17:40:31,542 : INFO : Current training batch loss: 0.3287 in epoch 5
2024-08-15 17:40:32,364 : INFO : Current training batch loss: 0.1582 in epoch 5
2024-08-15 17:40:33,185 : INFO : Current training batch loss: 0.1694 in epoch 5
2024-08-15 17:40:34,003 : INFO : Current training batch loss: 0.2081 in epoch 5
2024-08-15 17:40:34,155 : INFO : Epoch finished, average loss over training batches: 0.1810
2024-08-15 17:40:34,156 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:34,156 : INFO : Training metrics:
2024-08-15 17:40:34,156 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:34,159 : INFO : Accuracy: 0.9589
2024-08-15 17:40:34,160 : INFO : Precision score for label_class 0: 0.8905
2024-08-15 17:40:34,160 : INFO : Precision score for label_class 1: 0.9711
2024-08-15 17:40:34,160 : INFO : Precision score for label_class 2: 0.9632
2024-08-15 17:40:34,160 : INFO : Recall score for label_class 0: 0.9177
2024-08-15 17:40:34,160 : INFO : Recall score for label_class 1: 0.9808
2024-08-15 17:40:34,160 : INFO : Recall score for label_class 2: 0.9302
2024-08-15 17:40:34,160 : INFO : Average F1 score: 0.9421
2024-08-15 17:40:34,627 : INFO : Average loss over validation batches: 0.4026
2024-08-15 17:40:34,627 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:34,627 : INFO : Validation metrics:
2024-08-15 17:40:34,627 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:34,629 : INFO : Accuracy: 0.8681
2024-08-15 17:40:34,629 : INFO : Precision score for label_class 0: 0.7429
2024-08-15 17:40:34,629 : INFO : Precision score for label_class 1: 0.9318
2024-08-15 17:40:34,629 : INFO : Precision score for label_class 2: 0.8095
2024-08-15 17:40:34,629 : INFO : Recall score for label_class 0: 0.9070
2024-08-15 17:40:34,629 : INFO : Recall score for label_class 1: 0.8875
2024-08-15 17:40:34,629 : INFO : Recall score for label_class 2: 0.8095
2024-08-15 17:40:34,629 : INFO : Average F1 score: 0.8451
2024-08-15 17:40:34,629 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:40:34,629 : INFO : Starting epoch 6
2024-08-15 17:40:35,286 : INFO : Current training batch loss: 0.1884 in epoch 6
2024-08-15 17:40:36,197 : INFO : Current training batch loss: 0.1125 in epoch 6
2024-08-15 17:40:37,015 : INFO : Current training batch loss: 0.0689 in epoch 6
2024-08-15 17:40:37,850 : INFO : Current training batch loss: 0.1028 in epoch 6
2024-08-15 17:40:38,204 : INFO : Epoch finished, average loss over training batches: 0.1494
2024-08-15 17:40:38,204 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:38,204 : INFO : Training metrics:
2024-08-15 17:40:38,204 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:38,208 : INFO : Accuracy: 0.9681
2024-08-15 17:40:38,208 : INFO : Precision score for label_class 0: 0.9115
2024-08-15 17:40:38,208 : INFO : Precision score for label_class 1: 0.9796
2024-08-15 17:40:38,208 : INFO : Precision score for label_class 2: 0.9690
2024-08-15 17:40:38,208 : INFO : Recall score for label_class 0: 0.9421
2024-08-15 17:40:38,208 : INFO : Recall score for label_class 1: 0.9826
2024-08-15 17:40:38,208 : INFO : Recall score for label_class 2: 0.9486
2024-08-15 17:40:38,208 : INFO : Average F1 score: 0.9555
2024-08-15 17:40:38,676 : INFO : Average loss over validation batches: 0.4629
2024-08-15 17:40:38,676 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:38,676 : INFO : Validation metrics:
2024-08-15 17:40:38,676 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:38,679 : INFO : Accuracy: 0.8756
2024-08-15 17:40:38,679 : INFO : Precision score for label_class 0: 0.7935
2024-08-15 17:40:38,679 : INFO : Precision score for label_class 1: 0.8807
2024-08-15 17:40:38,679 : INFO : Precision score for label_class 2: 0.9116
2024-08-15 17:40:38,679 : INFO : Recall score for label_class 0: 0.8488
2024-08-15 17:40:38,679 : INFO : Recall score for label_class 1: 0.9600
2024-08-15 17:40:38,679 : INFO : Recall score for label_class 2: 0.7090
2024-08-15 17:40:38,679 : INFO : Average F1 score: 0.8455
2024-08-15 17:40:38,679 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:40:38,679 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:40:38,718 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:40:39,218 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:39,218 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:40:39,218 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:39,221 : INFO : Accuracy: 0.8622
2024-08-15 17:40:39,221 : INFO : Precision score for label_class 0: 0.8333
2024-08-15 17:40:39,221 : INFO : Precision score for label_class 1: 0.9201
2024-08-15 17:40:39,221 : INFO : Precision score for label_class 2: 0.7635
2024-08-15 17:40:39,221 : INFO : Recall score for label_class 0: 0.8140
2024-08-15 17:40:39,221 : INFO : Recall score for label_class 1: 0.8925
2024-08-15 17:40:39,221 : INFO : Recall score for label_class 2: 0.8201
2024-08-15 17:40:39,221 : INFO : Average F1 score: 0.8401
2024-08-15 17:40:39,221 : INFO : Determined score from best model, ending training.
2024-08-15 17:40:39,222 : INFO : Split 3 is finished, the score is: 0.8401
2024-08-15 17:40:39,223 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:39,223 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:39,223 : INFO : Starting training for split 4
2024-08-15 17:40:39,237 : INFO : Starting to tokenize the sequences.
2024-08-15 17:40:39,243 : INFO : Tokenization is finished.
2024-08-15 17:40:39,259 : INFO : Starting to tokenize the sequences.
2024-08-15 17:40:39,264 : INFO : Tokenization is finished.
2024-08-15 17:40:39,269 : INFO : Counting occurences of labels...
2024-08-15 17:40:39,270 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 327, 1621,  751]))
2024-08-15 17:40:39,270 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 87, 390, 197]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:40:39,314 : INFO : Starting epoch 1
2024-08-15 17:40:39,365 : INFO : Current training batch loss: 1.1137 in epoch 1
2024-08-15 17:40:40,187 : INFO : Current training batch loss: 1.0043 in epoch 1
2024-08-15 17:40:41,005 : INFO : Current training batch loss: 0.8053 in epoch 1
2024-08-15 17:40:41,845 : INFO : Current training batch loss: 0.6915 in epoch 1
2024-08-15 17:40:42,663 : INFO : Current training batch loss: 0.7410 in epoch 1
2024-08-15 17:40:42,815 : INFO : Epoch finished, average loss over training batches: 0.8512
2024-08-15 17:40:42,815 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:42,815 : INFO : Training metrics:
2024-08-15 17:40:42,815 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:42,823 : INFO : Accuracy: 0.6443
2024-08-15 17:40:42,823 : INFO : Precision score for label_class 0: 0.0882
2024-08-15 17:40:42,823 : INFO : Precision score for label_class 1: 0.6952
2024-08-15 17:40:42,823 : INFO : Precision score for label_class 2: 0.4827
2024-08-15 17:40:42,823 : INFO : Recall score for label_class 0: 0.0092
2024-08-15 17:40:42,823 : INFO : Recall score for label_class 1: 0.9075
2024-08-15 17:40:42,823 : INFO : Recall score for label_class 2: 0.3529
2024-08-15 17:40:42,823 : INFO : Average F1 score: 0.4039
2024-08-15 17:40:43,293 : INFO : Average loss over validation batches: 0.6794
2024-08-15 17:40:43,293 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:43,293 : INFO : Validation metrics:
2024-08-15 17:40:43,293 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:43,296 : INFO : Accuracy: 0.7300
2024-08-15 17:40:43,296 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:40:43,296 : INFO : Precision score for label_class 1: 0.8373
2024-08-15 17:40:43,296 : INFO : Precision score for label_class 2: 0.5547
2024-08-15 17:40:43,296 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:40:43,296 : INFO : Recall score for label_class 1: 0.8974
2024-08-15 17:40:43,296 : INFO : Recall score for label_class 2: 0.7208
2024-08-15 17:40:43,296 : INFO : Average F1 score: 0.4978
2024-08-15 17:40:43,296 : INFO : Validation metric decreased (inf --> 0.679355).  Saving model ...
2024-08-15 17:40:43,408 : INFO : Starting epoch 2
2024-08-15 17:40:44,067 : INFO : Current training batch loss: 0.6782 in epoch 2
2024-08-15 17:40:44,904 : INFO : Current training batch loss: 0.4829 in epoch 2
2024-08-15 17:40:45,732 : INFO : Current training batch loss: 0.4056 in epoch 2
2024-08-15 17:40:46,547 : INFO : Current training batch loss: 0.4281 in epoch 2
2024-08-15 17:40:46,894 : INFO : Epoch finished, average loss over training batches: 0.5503
2024-08-15 17:40:46,894 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:46,894 : INFO : Training metrics:
2024-08-15 17:40:46,894 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:46,902 : INFO : Accuracy: 0.8218
2024-08-15 17:40:46,902 : INFO : Precision score for label_class 0: 0.8280
2024-08-15 17:40:46,902 : INFO : Precision score for label_class 1: 0.8600
2024-08-15 17:40:46,902 : INFO : Precision score for label_class 2: 0.7287
2024-08-15 17:40:46,902 : INFO : Recall score for label_class 0: 0.4709
2024-08-15 17:40:46,902 : INFO : Recall score for label_class 1: 0.9402
2024-08-15 17:40:46,902 : INFO : Recall score for label_class 2: 0.7190
2024-08-15 17:40:46,902 : INFO : Average F1 score: 0.7409
2024-08-15 17:40:47,387 : INFO : Average loss over validation batches: 0.4607
2024-08-15 17:40:47,387 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:47,387 : INFO : Validation metrics:
2024-08-15 17:40:47,387 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:47,390 : INFO : Accuracy: 0.8561
2024-08-15 17:40:47,390 : INFO : Precision score for label_class 0: 0.7097
2024-08-15 17:40:47,390 : INFO : Precision score for label_class 1: 0.8786
2024-08-15 17:40:47,390 : INFO : Precision score for label_class 2: 0.8820
2024-08-15 17:40:47,390 : INFO : Recall score for label_class 0: 0.7586
2024-08-15 17:40:47,390 : INFO : Recall score for label_class 1: 0.9462
2024-08-15 17:40:47,390 : INFO : Recall score for label_class 2: 0.7208
2024-08-15 17:40:47,390 : INFO : Average F1 score: 0.8126
2024-08-15 17:40:47,390 : INFO : Validation metric decreased (0.679355 --> 0.460736).  Saving model ...
2024-08-15 17:40:47,492 : INFO : Starting epoch 3
2024-08-15 17:40:47,944 : INFO : Current training batch loss: 0.3815 in epoch 3
2024-08-15 17:40:48,768 : INFO : Current training batch loss: 0.4363 in epoch 3
2024-08-15 17:40:49,585 : INFO : Current training batch loss: 0.3144 in epoch 3
2024-08-15 17:40:50,406 : INFO : Current training batch loss: 0.2259 in epoch 3
2024-08-15 17:40:50,970 : INFO : Epoch finished, average loss over training batches: 0.3475
2024-08-15 17:40:50,970 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:50,970 : INFO : Training metrics:
2024-08-15 17:40:50,970 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:50,978 : INFO : Accuracy: 0.9081
2024-08-15 17:40:50,978 : INFO : Precision score for label_class 0: 0.8354
2024-08-15 17:40:50,978 : INFO : Precision score for label_class 1: 0.9339
2024-08-15 17:40:50,978 : INFO : Precision score for label_class 2: 0.8821
2024-08-15 17:40:50,978 : INFO : Recall score for label_class 0: 0.8379
2024-08-15 17:40:50,978 : INFO : Recall score for label_class 1: 0.9506
2024-08-15 17:40:50,978 : INFO : Recall score for label_class 2: 0.8469
2024-08-15 17:40:50,978 : INFO : Average F1 score: 0.8810
2024-08-15 17:40:51,447 : INFO : Average loss over validation batches: 0.4047
2024-08-15 17:40:51,448 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:51,448 : INFO : Validation metrics:
2024-08-15 17:40:51,448 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:51,451 : INFO : Accuracy: 0.8591
2024-08-15 17:40:51,452 : INFO : Precision score for label_class 0: 0.7447
2024-08-15 17:40:51,452 : INFO : Precision score for label_class 1: 0.9028
2024-08-15 17:40:51,452 : INFO : Precision score for label_class 2: 0.8254
2024-08-15 17:40:51,452 : INFO : Recall score for label_class 0: 0.8046
2024-08-15 17:40:51,452 : INFO : Recall score for label_class 1: 0.9051
2024-08-15 17:40:51,452 : INFO : Recall score for label_class 2: 0.7919
2024-08-15 17:40:51,452 : INFO : Average F1 score: 0.8286
2024-08-15 17:40:51,452 : INFO : Validation metric decreased (0.460736 --> 0.404684).  Saving model ...
2024-08-15 17:40:51,553 : INFO : Starting epoch 4
2024-08-15 17:40:51,805 : INFO : Current training batch loss: 0.3719 in epoch 4
2024-08-15 17:40:52,616 : INFO : Current training batch loss: 0.3191 in epoch 4
2024-08-15 17:40:53,428 : INFO : Current training batch loss: 0.2518 in epoch 4
2024-08-15 17:40:54,259 : INFO : Current training batch loss: 0.1856 in epoch 4
2024-08-15 17:40:55,031 : INFO : Epoch finished, average loss over training batches: 0.2433
2024-08-15 17:40:55,031 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:55,031 : INFO : Training metrics:
2024-08-15 17:40:55,031 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:55,036 : INFO : Accuracy: 0.9396
2024-08-15 17:40:55,036 : INFO : Precision score for label_class 0: 0.8618
2024-08-15 17:40:55,036 : INFO : Precision score for label_class 1: 0.9596
2024-08-15 17:40:55,036 : INFO : Precision score for label_class 2: 0.9311
2024-08-15 17:40:55,036 : INFO : Recall score for label_class 0: 0.8960
2024-08-15 17:40:55,036 : INFO : Recall score for label_class 1: 0.9667
2024-08-15 17:40:55,036 : INFO : Recall score for label_class 2: 0.9001
2024-08-15 17:40:55,036 : INFO : Average F1 score: 0.9190
2024-08-15 17:40:55,515 : INFO : Average loss over validation batches: 0.4348
2024-08-15 17:40:55,515 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:55,515 : INFO : Validation metrics:
2024-08-15 17:40:55,515 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:55,519 : INFO : Accuracy: 0.8516
2024-08-15 17:40:55,519 : INFO : Precision score for label_class 0: 0.7255
2024-08-15 17:40:55,519 : INFO : Precision score for label_class 1: 0.9288
2024-08-15 17:40:55,519 : INFO : Precision score for label_class 2: 0.7778
2024-08-15 17:40:55,519 : INFO : Recall score for label_class 0: 0.8506
2024-08-15 17:40:55,519 : INFO : Recall score for label_class 1: 0.8692
2024-08-15 17:40:55,519 : INFO : Recall score for label_class 2: 0.8173
2024-08-15 17:40:55,519 : INFO : Average F1 score: 0.8260
2024-08-15 17:40:55,519 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:40:55,519 : INFO : Starting epoch 5
2024-08-15 17:40:55,569 : INFO : Current training batch loss: 0.1573 in epoch 5
2024-08-15 17:40:56,381 : INFO : Current training batch loss: 0.5218 in epoch 5
2024-08-15 17:40:57,197 : INFO : Current training batch loss: 0.1587 in epoch 5
2024-08-15 17:40:58,032 : INFO : Current training batch loss: 0.1983 in epoch 5
2024-08-15 17:40:58,861 : INFO : Current training batch loss: 0.2178 in epoch 5
2024-08-15 17:40:59,014 : INFO : Epoch finished, average loss over training batches: 0.2009
2024-08-15 17:40:59,014 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:59,014 : INFO : Training metrics:
2024-08-15 17:40:59,014 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:59,021 : INFO : Accuracy: 0.9526
2024-08-15 17:40:59,021 : INFO : Precision score for label_class 0: 0.8988
2024-08-15 17:40:59,021 : INFO : Precision score for label_class 1: 0.9663
2024-08-15 17:40:59,021 : INFO : Precision score for label_class 2: 0.9466
2024-08-15 17:40:59,022 : INFO : Recall score for label_class 0: 0.9235
2024-08-15 17:40:59,022 : INFO : Recall score for label_class 1: 0.9729
2024-08-15 17:40:59,022 : INFO : Recall score for label_class 2: 0.9214
2024-08-15 17:40:59,022 : INFO : Average F1 score: 0.9382
2024-08-15 17:40:59,489 : INFO : Average loss over validation batches: 0.4191
2024-08-15 17:40:59,489 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:59,489 : INFO : Validation metrics:
2024-08-15 17:40:59,489 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:40:59,493 : INFO : Accuracy: 0.8546
2024-08-15 17:40:59,493 : INFO : Precision score for label_class 0: 0.7048
2024-08-15 17:40:59,493 : INFO : Precision score for label_class 1: 0.9134
2024-08-15 17:40:59,493 : INFO : Precision score for label_class 2: 0.8191
2024-08-15 17:40:59,493 : INFO : Recall score for label_class 0: 0.8506
2024-08-15 17:40:59,493 : INFO : Recall score for label_class 1: 0.8923
2024-08-15 17:40:59,493 : INFO : Recall score for label_class 2: 0.7817
2024-08-15 17:40:59,493 : INFO : Average F1 score: 0.8245
2024-08-15 17:40:59,493 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:40:59,493 : INFO : Starting epoch 6
2024-08-15 17:41:00,149 : INFO : Current training batch loss: 0.2678 in epoch 6
2024-08-15 17:41:00,977 : INFO : Current training batch loss: 0.1160 in epoch 6
2024-08-15 17:41:01,798 : INFO : Current training batch loss: 0.0714 in epoch 6
2024-08-15 17:41:02,640 : INFO : Current training batch loss: 0.0561 in epoch 6
2024-08-15 17:41:02,994 : INFO : Epoch finished, average loss over training batches: 0.1532
2024-08-15 17:41:02,994 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:02,994 : INFO : Training metrics:
2024-08-15 17:41:02,994 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:02,998 : INFO : Accuracy: 0.9659
2024-08-15 17:41:02,998 : INFO : Precision score for label_class 0: 0.9112
2024-08-15 17:41:02,998 : INFO : Precision score for label_class 1: 0.9767
2024-08-15 17:41:02,998 : INFO : Precision score for label_class 2: 0.9672
2024-08-15 17:41:02,998 : INFO : Recall score for label_class 0: 0.9419
2024-08-15 17:41:02,998 : INFO : Recall score for label_class 1: 0.9815
2024-08-15 17:41:02,998 : INFO : Recall score for label_class 2: 0.9427
2024-08-15 17:41:02,998 : INFO : Average F1 score: 0.9534
2024-08-15 17:41:03,471 : INFO : Average loss over validation batches: 0.4437
2024-08-15 17:41:03,471 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:03,471 : INFO : Validation metrics:
2024-08-15 17:41:03,471 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:03,475 : INFO : Accuracy: 0.8546
2024-08-15 17:41:03,475 : INFO : Precision score for label_class 0: 0.7129
2024-08-15 17:41:03,475 : INFO : Precision score for label_class 1: 0.8861
2024-08-15 17:41:03,475 : INFO : Precision score for label_class 2: 0.8639
2024-08-15 17:41:03,475 : INFO : Recall score for label_class 0: 0.8276
2024-08-15 17:41:03,475 : INFO : Recall score for label_class 1: 0.9179
2024-08-15 17:41:03,475 : INFO : Recall score for label_class 2: 0.7411
2024-08-15 17:41:03,475 : INFO : Average F1 score: 0.8218
2024-08-15 17:41:03,475 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:41:03,475 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:41:03,513 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:41:04,014 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:04,014 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:41:04,014 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:04,018 : INFO : Accuracy: 0.8591
2024-08-15 17:41:04,018 : INFO : Precision score for label_class 0: 0.7447
2024-08-15 17:41:04,018 : INFO : Precision score for label_class 1: 0.9028
2024-08-15 17:41:04,018 : INFO : Precision score for label_class 2: 0.8254
2024-08-15 17:41:04,018 : INFO : Recall score for label_class 0: 0.8046
2024-08-15 17:41:04,018 : INFO : Recall score for label_class 1: 0.9051
2024-08-15 17:41:04,018 : INFO : Recall score for label_class 2: 0.7919
2024-08-15 17:41:04,018 : INFO : Average F1 score: 0.8286
2024-08-15 17:41:04,018 : INFO : Determined score from best model, ending training.
2024-08-15 17:41:04,019 : INFO : Split 4 is finished, the score is: 0.8286
2024-08-15 17:41:04,019 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:04,019 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:04,020 : INFO : Starting training for split 5
2024-08-15 17:41:04,034 : INFO : Starting to tokenize the sequences.
2024-08-15 17:41:04,039 : INFO : Tokenization is finished.
2024-08-15 17:41:04,056 : INFO : Starting to tokenize the sequences.
2024-08-15 17:41:04,061 : INFO : Tokenization is finished.
2024-08-15 17:41:04,066 : INFO : Counting occurences of labels...
2024-08-15 17:41:04,067 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 330, 1615,  754]))
2024-08-15 17:41:04,067 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 84, 396, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:41:04,109 : INFO : Starting epoch 1
2024-08-15 17:41:04,161 : INFO : Current training batch loss: 1.0805 in epoch 1
2024-08-15 17:41:04,997 : INFO : Current training batch loss: 0.9968 in epoch 1
2024-08-15 17:41:05,826 : INFO : Current training batch loss: 0.8188 in epoch 1
2024-08-15 17:41:06,644 : INFO : Current training batch loss: 0.7079 in epoch 1
2024-08-15 17:41:07,461 : INFO : Current training batch loss: 0.7054 in epoch 1
2024-08-15 17:41:07,613 : INFO : Epoch finished, average loss over training batches: 0.8500
2024-08-15 17:41:07,613 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:07,613 : INFO : Training metrics:
2024-08-15 17:41:07,613 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:07,624 : INFO : Accuracy: 0.6625
2024-08-15 17:41:07,624 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:41:07,624 : INFO : Precision score for label_class 1: 0.6800
2024-08-15 17:41:07,624 : INFO : Precision score for label_class 2: 0.5663
2024-08-15 17:41:07,624 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:41:07,624 : INFO : Recall score for label_class 1: 0.9697
2024-08-15 17:41:07,624 : INFO : Recall score for label_class 2: 0.2944
2024-08-15 17:41:07,624 : INFO : Average F1 score: 0.3956
2024-08-15 17:41:08,101 : INFO : Average loss over validation batches: 0.6606
2024-08-15 17:41:08,101 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:08,101 : INFO : Validation metrics:
2024-08-15 17:41:08,101 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:08,104 : INFO : Accuracy: 0.7285
2024-08-15 17:41:08,104 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:41:08,104 : INFO : Precision score for label_class 1: 0.8147
2024-08-15 17:41:08,104 : INFO : Precision score for label_class 2: 0.5575
2024-08-15 17:41:08,104 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:41:08,104 : INFO : Recall score for label_class 1: 0.9217
2024-08-15 17:41:08,104 : INFO : Recall score for label_class 2: 0.6495
2024-08-15 17:41:08,104 : INFO : Average F1 score: 0.4883
2024-08-15 17:41:08,104 : INFO : Validation metric decreased (inf --> 0.660551).  Saving model ...
2024-08-15 17:41:08,213 : INFO : Starting epoch 2
2024-08-15 17:41:08,893 : INFO : Current training batch loss: 0.6246 in epoch 2
2024-08-15 17:41:09,718 : INFO : Current training batch loss: 0.4909 in epoch 2
2024-08-15 17:41:10,535 : INFO : Current training batch loss: 0.3861 in epoch 2
2024-08-15 17:41:11,352 : INFO : Current training batch loss: 0.5430 in epoch 2
2024-08-15 17:41:11,706 : INFO : Epoch finished, average loss over training batches: 0.5301
2024-08-15 17:41:11,706 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:11,706 : INFO : Training metrics:
2024-08-15 17:41:11,706 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:11,717 : INFO : Accuracy: 0.8266
2024-08-15 17:41:11,717 : INFO : Precision score for label_class 0: 0.7925
2024-08-15 17:41:11,717 : INFO : Precision score for label_class 1: 0.8656
2024-08-15 17:41:11,717 : INFO : Precision score for label_class 2: 0.7442
2024-08-15 17:41:11,717 : INFO : Recall score for label_class 0: 0.5091
2024-08-15 17:41:11,717 : INFO : Recall score for label_class 1: 0.9368
2024-08-15 17:41:11,717 : INFO : Recall score for label_class 2: 0.7294
2024-08-15 17:41:11,717 : INFO : Average F1 score: 0.7522
2024-08-15 17:41:12,182 : INFO : Average loss over validation batches: 0.4982
2024-08-15 17:41:12,182 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:12,182 : INFO : Validation metrics:
2024-08-15 17:41:12,182 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:12,186 : INFO : Accuracy: 0.8249
2024-08-15 17:41:12,186 : INFO : Precision score for label_class 0: 0.7714
2024-08-15 17:41:12,186 : INFO : Precision score for label_class 1: 0.8326
2024-08-15 17:41:12,186 : INFO : Precision score for label_class 2: 0.8267
2024-08-15 17:41:12,186 : INFO : Recall score for label_class 0: 0.6429
2024-08-15 17:41:12,186 : INFO : Recall score for label_class 1: 0.9545
2024-08-15 17:41:12,186 : INFO : Recall score for label_class 2: 0.6392
2024-08-15 17:41:12,186 : INFO : Average F1 score: 0.7705
2024-08-15 17:41:12,186 : INFO : Validation metric decreased (0.660551 --> 0.498178).  Saving model ...
2024-08-15 17:41:12,289 : INFO : Starting epoch 3
2024-08-15 17:41:12,743 : INFO : Current training batch loss: 0.3557 in epoch 3
2024-08-15 17:41:13,565 : INFO : Current training batch loss: 0.4214 in epoch 3
2024-08-15 17:41:14,383 : INFO : Current training batch loss: 0.3858 in epoch 3
2024-08-15 17:41:15,200 : INFO : Current training batch loss: 0.2431 in epoch 3
2024-08-15 17:41:15,755 : INFO : Epoch finished, average loss over training batches: 0.3517
2024-08-15 17:41:15,755 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:15,755 : INFO : Training metrics:
2024-08-15 17:41:15,755 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:15,764 : INFO : Accuracy: 0.9014
2024-08-15 17:41:15,764 : INFO : Precision score for label_class 0: 0.8354
2024-08-15 17:41:15,764 : INFO : Precision score for label_class 1: 0.9221
2024-08-15 17:41:15,764 : INFO : Precision score for label_class 2: 0.8833
2024-08-15 17:41:15,764 : INFO : Recall score for label_class 0: 0.8152
2024-08-15 17:41:15,764 : INFO : Recall score for label_class 1: 0.9461
2024-08-15 17:41:15,764 : INFO : Recall score for label_class 2: 0.8435
2024-08-15 17:41:15,764 : INFO : Average F1 score: 0.8740
2024-08-15 17:41:16,235 : INFO : Average loss over validation batches: 0.4401
2024-08-15 17:41:16,235 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:16,235 : INFO : Validation metrics:
2024-08-15 17:41:16,235 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:16,238 : INFO : Accuracy: 0.8412
2024-08-15 17:41:16,238 : INFO : Precision score for label_class 0: 0.7763
2024-08-15 17:41:16,238 : INFO : Precision score for label_class 1: 0.9065
2024-08-15 17:41:16,238 : INFO : Precision score for label_class 2: 0.7465
2024-08-15 17:41:16,238 : INFO : Recall score for label_class 0: 0.7024
2024-08-15 17:41:16,238 : INFO : Recall score for label_class 1: 0.8813
2024-08-15 17:41:16,238 : INFO : Recall score for label_class 2: 0.8196
2024-08-15 17:41:16,238 : INFO : Average F1 score: 0.8042
2024-08-15 17:41:16,238 : INFO : Validation metric decreased (0.498178 --> 0.440127).  Saving model ...
2024-08-15 17:41:16,343 : INFO : Starting epoch 4
2024-08-15 17:41:16,597 : INFO : Current training batch loss: 0.4223 in epoch 4
2024-08-15 17:41:17,421 : INFO : Current training batch loss: 0.2921 in epoch 4
2024-08-15 17:41:18,245 : INFO : Current training batch loss: 0.3076 in epoch 4
2024-08-15 17:41:19,070 : INFO : Current training batch loss: 0.1421 in epoch 4
2024-08-15 17:41:19,816 : INFO : Epoch finished, average loss over training batches: 0.2423
2024-08-15 17:41:19,816 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:19,816 : INFO : Training metrics:
2024-08-15 17:41:19,816 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:19,828 : INFO : Accuracy: 0.9422
2024-08-15 17:41:19,828 : INFO : Precision score for label_class 0: 0.8728
2024-08-15 17:41:19,828 : INFO : Precision score for label_class 1: 0.9624
2024-08-15 17:41:19,828 : INFO : Precision score for label_class 2: 0.9297
2024-08-15 17:41:19,828 : INFO : Recall score for label_class 0: 0.8939
2024-08-15 17:41:19,828 : INFO : Recall score for label_class 1: 0.9659
2024-08-15 17:41:19,828 : INFO : Recall score for label_class 2: 0.9125
2024-08-15 17:41:19,828 : INFO : Average F1 score: 0.9228
2024-08-15 17:41:20,311 : INFO : Average loss over validation batches: 0.4275
2024-08-15 17:41:20,311 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:20,311 : INFO : Validation metrics:
2024-08-15 17:41:20,311 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:20,315 : INFO : Accuracy: 0.8546
2024-08-15 17:41:20,315 : INFO : Precision score for label_class 0: 0.7647
2024-08-15 17:41:20,315 : INFO : Precision score for label_class 1: 0.9117
2024-08-15 17:41:20,315 : INFO : Precision score for label_class 2: 0.7843
2024-08-15 17:41:20,315 : INFO : Recall score for label_class 0: 0.7738
2024-08-15 17:41:20,315 : INFO : Recall score for label_class 1: 0.8864
2024-08-15 17:41:20,315 : INFO : Recall score for label_class 2: 0.8247
2024-08-15 17:41:20,315 : INFO : Average F1 score: 0.8240
2024-08-15 17:41:20,315 : INFO : Validation metric decreased (0.440127 --> 0.427496).  Saving model ...
2024-08-15 17:41:20,418 : INFO : Starting epoch 5
2024-08-15 17:41:20,469 : INFO : Current training batch loss: 0.1066 in epoch 5
2024-08-15 17:41:21,300 : INFO : Current training batch loss: 0.1696 in epoch 5
2024-08-15 17:41:22,124 : INFO : Current training batch loss: 0.0975 in epoch 5
2024-08-15 17:41:22,947 : INFO : Current training batch loss: 0.2338 in epoch 5
2024-08-15 17:41:23,765 : INFO : Current training batch loss: 0.0678 in epoch 5
2024-08-15 17:41:23,917 : INFO : Epoch finished, average loss over training batches: 0.1869
2024-08-15 17:41:23,917 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:23,917 : INFO : Training metrics:
2024-08-15 17:41:23,917 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:23,924 : INFO : Accuracy: 0.9567
2024-08-15 17:41:23,924 : INFO : Precision score for label_class 0: 0.8941
2024-08-15 17:41:23,924 : INFO : Precision score for label_class 1: 0.9722
2024-08-15 17:41:23,924 : INFO : Precision score for label_class 2: 0.9514
2024-08-15 17:41:23,924 : INFO : Recall score for label_class 0: 0.9212
2024-08-15 17:41:23,924 : INFO : Recall score for label_class 1: 0.9746
2024-08-15 17:41:23,924 : INFO : Recall score for label_class 2: 0.9337
2024-08-15 17:41:23,924 : INFO : Average F1 score: 0.9411
2024-08-15 17:41:24,393 : INFO : Average loss over validation batches: 0.4682
2024-08-15 17:41:24,393 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:24,393 : INFO : Validation metrics:
2024-08-15 17:41:24,393 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:24,397 : INFO : Accuracy: 0.8368
2024-08-15 17:41:24,397 : INFO : Precision score for label_class 0: 0.7283
2024-08-15 17:41:24,397 : INFO : Precision score for label_class 1: 0.9205
2024-08-15 17:41:24,397 : INFO : Precision score for label_class 2: 0.7419
2024-08-15 17:41:24,397 : INFO : Recall score for label_class 0: 0.7976
2024-08-15 17:41:24,397 : INFO : Recall score for label_class 1: 0.8485
2024-08-15 17:41:24,397 : INFO : Recall score for label_class 2: 0.8299
2024-08-15 17:41:24,397 : INFO : Average F1 score: 0.8093
2024-08-15 17:41:24,397 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:41:24,397 : INFO : Starting epoch 6
2024-08-15 17:41:25,062 : INFO : Current training batch loss: 0.2421 in epoch 6
2024-08-15 17:41:25,899 : INFO : Current training batch loss: 0.1104 in epoch 6
2024-08-15 17:41:26,717 : INFO : Current training batch loss: 0.0623 in epoch 6
2024-08-15 17:41:27,535 : INFO : Current training batch loss: 0.2685 in epoch 6
2024-08-15 17:41:27,888 : INFO : Epoch finished, average loss over training batches: 0.1552
2024-08-15 17:41:27,889 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:27,889 : INFO : Training metrics:
2024-08-15 17:41:27,889 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:27,896 : INFO : Accuracy: 0.9670
2024-08-15 17:41:27,896 : INFO : Precision score for label_class 0: 0.9204
2024-08-15 17:41:27,896 : INFO : Precision score for label_class 1: 0.9754
2024-08-15 17:41:27,896 : INFO : Precision score for label_class 2: 0.9699
2024-08-15 17:41:27,896 : INFO : Recall score for label_class 0: 0.9455
2024-08-15 17:41:27,896 : INFO : Recall score for label_class 1: 0.9839
2024-08-15 17:41:27,896 : INFO : Recall score for label_class 2: 0.9403
2024-08-15 17:41:27,896 : INFO : Average F1 score: 0.9558
2024-08-15 17:41:28,363 : INFO : Average loss over validation batches: 0.4540
2024-08-15 17:41:28,363 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:28,363 : INFO : Validation metrics:
2024-08-15 17:41:28,363 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:28,367 : INFO : Accuracy: 0.8442
2024-08-15 17:41:28,367 : INFO : Precision score for label_class 0: 0.7667
2024-08-15 17:41:28,367 : INFO : Precision score for label_class 1: 0.9164
2024-08-15 17:41:28,367 : INFO : Precision score for label_class 2: 0.7512
2024-08-15 17:41:28,367 : INFO : Recall score for label_class 0: 0.8214
2024-08-15 17:41:28,367 : INFO : Recall score for label_class 1: 0.8586
2024-08-15 17:41:28,367 : INFO : Recall score for label_class 2: 0.8247
2024-08-15 17:41:28,367 : INFO : Average F1 score: 0.8220
2024-08-15 17:41:28,367 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:41:28,367 : INFO : Starting epoch 7
2024-08-15 17:41:28,821 : INFO : Current training batch loss: 0.0495 in epoch 7
2024-08-15 17:41:29,638 : INFO : Current training batch loss: 0.1150 in epoch 7
2024-08-15 17:41:30,453 : INFO : Current training batch loss: 0.0591 in epoch 7
2024-08-15 17:41:31,270 : INFO : Current training batch loss: 0.1669 in epoch 7
2024-08-15 17:41:31,824 : INFO : Epoch finished, average loss over training batches: 0.1270
2024-08-15 17:41:31,824 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:31,824 : INFO : Training metrics:
2024-08-15 17:41:31,824 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:31,835 : INFO : Accuracy: 0.9730
2024-08-15 17:41:31,835 : INFO : Precision score for label_class 0: 0.9347
2024-08-15 17:41:31,835 : INFO : Precision score for label_class 1: 0.9803
2024-08-15 17:41:31,835 : INFO : Precision score for label_class 2: 0.9742
2024-08-15 17:41:31,835 : INFO : Recall score for label_class 0: 0.9545
2024-08-15 17:41:31,835 : INFO : Recall score for label_class 1: 0.9864
2024-08-15 17:41:31,835 : INFO : Recall score for label_class 2: 0.9523
2024-08-15 17:41:31,835 : INFO : Average F1 score: 0.9637
2024-08-15 17:41:32,300 : INFO : Average loss over validation batches: 0.4613
2024-08-15 17:41:32,300 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:32,300 : INFO : Validation metrics:
2024-08-15 17:41:32,300 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:32,303 : INFO : Accuracy: 0.8457
2024-08-15 17:41:32,303 : INFO : Precision score for label_class 0: 0.7882
2024-08-15 17:41:32,303 : INFO : Precision score for label_class 1: 0.8992
2024-08-15 17:41:32,303 : INFO : Precision score for label_class 2: 0.7673
2024-08-15 17:41:32,304 : INFO : Recall score for label_class 0: 0.7976
2024-08-15 17:41:32,304 : INFO : Recall score for label_class 1: 0.8788
2024-08-15 17:41:32,304 : INFO : Recall score for label_class 2: 0.7990
2024-08-15 17:41:32,304 : INFO : Average F1 score: 0.8215
2024-08-15 17:41:32,304 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:41:32,304 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:41:32,343 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:41:32,842 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:32,842 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:41:32,842 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:32,846 : INFO : Accuracy: 0.8546
2024-08-15 17:41:32,846 : INFO : Precision score for label_class 0: 0.7647
2024-08-15 17:41:32,846 : INFO : Precision score for label_class 1: 0.9117
2024-08-15 17:41:32,846 : INFO : Precision score for label_class 2: 0.7843
2024-08-15 17:41:32,846 : INFO : Recall score for label_class 0: 0.7738
2024-08-15 17:41:32,846 : INFO : Recall score for label_class 1: 0.8864
2024-08-15 17:41:32,846 : INFO : Recall score for label_class 2: 0.8247
2024-08-15 17:41:32,846 : INFO : Average F1 score: 0.8240
2024-08-15 17:41:32,846 : INFO : Determined score from best model, ending training.
2024-08-15 17:41:32,847 : INFO : Split 5 is finished, the score is: 0.8240
2024-08-15 17:41:32,847 : INFO : ----------------------------------------------------------------------------------------------------
[I 2024-08-15 17:41:32,862] Trial 19 finished with value: 0.836579214654926 and parameters: {'n_epochs': 7, 'learning_rate': 3.315991150264123e-05, 'classifier_dropout': 0.5795565198799646, 'warmup_step_fraction': 0.010340710708131206, 'use_gradient_clipping': True}. Best is trial 1 with value: 0.8513001269595835.
2024-08-15 17:41:32,871 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:32,871 : INFO : Starting training for split 1
2024-08-15 17:41:32,883 : INFO : Starting to tokenize the sequences.
2024-08-15 17:41:32,889 : INFO : Tokenization is finished.
2024-08-15 17:41:32,901 : INFO : Starting to tokenize the sequences.
2024-08-15 17:41:32,906 : INFO : Tokenization is finished.
2024-08-15 17:41:32,906 : INFO : Counting occurences of labels...
2024-08-15 17:41:32,907 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1596,  774]))
2024-08-15 17:41:32,907 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 415, 174]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:41:32,959 : INFO : Starting epoch 1
2024-08-15 17:41:33,010 : INFO : Current training batch loss: 1.1045 in epoch 1
2024-08-15 17:41:34,186 : INFO : Current training batch loss: 0.9557 in epoch 1
2024-08-15 17:41:35,010 : INFO : Current training batch loss: 0.9748 in epoch 1
2024-08-15 17:41:35,917 : INFO : Current training batch loss: 0.8743 in epoch 1
2024-08-15 17:41:36,731 : INFO : Current training batch loss: 0.6720 in epoch 1
2024-08-15 17:41:36,881 : INFO : Epoch finished, average loss over training batches: 0.8711
2024-08-15 17:41:36,882 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:36,882 : INFO : Training metrics:
2024-08-15 17:41:36,882 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:36,890 : INFO : Accuracy: 0.6156
2024-08-15 17:41:36,890 : INFO : Precision score for label_class 0: 0.2163
2024-08-15 17:41:36,890 : INFO : Precision score for label_class 1: 0.6776
2024-08-15 17:41:36,890 : INFO : Precision score for label_class 2: 0.4949
2024-08-15 17:41:36,890 : INFO : Recall score for label_class 0: 0.1372
2024-08-15 17:41:36,890 : INFO : Recall score for label_class 1: 0.8916
2024-08-15 17:41:36,890 : INFO : Recall score for label_class 2: 0.2494
2024-08-15 17:41:36,890 : INFO : Average F1 score: 0.4232
2024-08-15 17:41:37,367 : INFO : Average loss over validation batches: 0.6500
2024-08-15 17:41:37,367 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:37,367 : INFO : Validation metrics:
2024-08-15 17:41:37,367 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:37,369 : INFO : Accuracy: 0.6978
2024-08-15 17:41:37,369 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:41:37,369 : INFO : Precision score for label_class 1: 0.8920
2024-08-15 17:41:37,369 : INFO : Precision score for label_class 2: 0.4745
2024-08-15 17:41:37,369 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:41:37,369 : INFO : Recall score for label_class 1: 0.7759
2024-08-15 17:41:37,369 : INFO : Recall score for label_class 2: 0.8563
2024-08-15 17:41:37,369 : INFO : Average F1 score: 0.4802
2024-08-15 17:41:37,369 : INFO : Validation metric decreased (inf --> 0.650050).  Saving model ...
2024-08-15 17:41:37,478 : INFO : Starting epoch 2
2024-08-15 17:41:38,132 : INFO : Current training batch loss: 0.2710 in epoch 2
2024-08-15 17:41:38,954 : INFO : Current training batch loss: 0.5174 in epoch 2
2024-08-15 17:41:39,773 : INFO : Current training batch loss: 0.2935 in epoch 2
2024-08-15 17:41:40,586 : INFO : Current training batch loss: 0.3704 in epoch 2
2024-08-15 17:41:40,938 : INFO : Epoch finished, average loss over training batches: 0.4418
2024-08-15 17:41:40,938 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:40,938 : INFO : Training metrics:
2024-08-15 17:41:40,938 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:40,946 : INFO : Accuracy: 0.8477
2024-08-15 17:41:40,946 : INFO : Precision score for label_class 0: 0.7687
2024-08-15 17:41:40,946 : INFO : Precision score for label_class 1: 0.8795
2024-08-15 17:41:40,946 : INFO : Precision score for label_class 2: 0.8057
2024-08-15 17:41:40,946 : INFO : Recall score for label_class 0: 0.6585
2024-08-15 17:41:40,946 : INFO : Recall score for label_class 1: 0.9236
2024-08-15 17:41:40,946 : INFO : Recall score for label_class 2: 0.7713
2024-08-15 17:41:40,946 : INFO : Average F1 score: 0.7995
2024-08-15 17:41:41,412 : INFO : Average loss over validation batches: 0.4167
2024-08-15 17:41:41,412 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:41,412 : INFO : Validation metrics:
2024-08-15 17:41:41,412 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:41,415 : INFO : Accuracy: 0.8489
2024-08-15 17:41:41,415 : INFO : Precision score for label_class 0: 0.7037
2024-08-15 17:41:41,415 : INFO : Precision score for label_class 1: 0.9267
2024-08-15 17:41:41,415 : INFO : Precision score for label_class 2: 0.7730
2024-08-15 17:41:41,415 : INFO : Recall score for label_class 0: 0.8837
2024-08-15 17:41:41,415 : INFO : Recall score for label_class 1: 0.8530
2024-08-15 17:41:41,415 : INFO : Recall score for label_class 2: 0.8218
2024-08-15 17:41:41,415 : INFO : Average F1 score: 0.8228
2024-08-15 17:41:41,415 : INFO : Validation metric decreased (0.650050 --> 0.416745).  Saving model ...
2024-08-15 17:41:41,518 : INFO : Starting epoch 3
2024-08-15 17:41:41,971 : INFO : Current training batch loss: 0.3401 in epoch 3
2024-08-15 17:41:42,785 : INFO : Current training batch loss: 0.3723 in epoch 3
2024-08-15 17:41:43,599 : INFO : Current training batch loss: 0.2693 in epoch 3
2024-08-15 17:41:44,413 : INFO : Current training batch loss: 0.0790 in epoch 3
2024-08-15 17:41:44,966 : INFO : Epoch finished, average loss over training batches: 0.2481
2024-08-15 17:41:44,966 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:44,966 : INFO : Training metrics:
2024-08-15 17:41:44,966 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:44,971 : INFO : Accuracy: 0.9151
2024-08-15 17:41:44,971 : INFO : Precision score for label_class 0: 0.8338
2024-08-15 17:41:44,971 : INFO : Precision score for label_class 1: 0.9397
2024-08-15 17:41:44,971 : INFO : Precision score for label_class 2: 0.8995
2024-08-15 17:41:44,971 : INFO : Recall score for label_class 0: 0.8720
2024-08-15 17:41:44,971 : INFO : Recall score for label_class 1: 0.9474
2024-08-15 17:41:44,971 : INFO : Recall score for label_class 2: 0.8669
2024-08-15 17:41:44,971 : INFO : Average F1 score: 0.8930
2024-08-15 17:41:45,438 : INFO : Average loss over validation batches: 0.3512
2024-08-15 17:41:45,438 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:45,438 : INFO : Validation metrics:
2024-08-15 17:41:45,438 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:45,442 : INFO : Accuracy: 0.8667
2024-08-15 17:41:45,442 : INFO : Precision score for label_class 0: 0.7609
2024-08-15 17:41:45,442 : INFO : Precision score for label_class 1: 0.8988
2024-08-15 17:41:45,442 : INFO : Precision score for label_class 2: 0.8418
2024-08-15 17:41:45,442 : INFO : Recall score for label_class 0: 0.8140
2024-08-15 17:41:45,442 : INFO : Recall score for label_class 1: 0.9205
2024-08-15 17:41:45,442 : INFO : Recall score for label_class 2: 0.7644
2024-08-15 17:41:45,442 : INFO : Average F1 score: 0.8324
2024-08-15 17:41:45,442 : INFO : Validation metric decreased (0.416745 --> 0.351200).  Saving model ...
2024-08-15 17:41:45,542 : INFO : Starting epoch 4
2024-08-15 17:41:45,793 : INFO : Current training batch loss: 0.4652 in epoch 4
2024-08-15 17:41:46,608 : INFO : Current training batch loss: 0.0745 in epoch 4
2024-08-15 17:41:47,422 : INFO : Current training batch loss: 0.4464 in epoch 4
2024-08-15 17:41:48,237 : INFO : Current training batch loss: 0.2141 in epoch 4
2024-08-15 17:41:48,990 : INFO : Epoch finished, average loss over training batches: 0.1461
2024-08-15 17:41:48,991 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:48,991 : INFO : Training metrics:
2024-08-15 17:41:48,991 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:48,995 : INFO : Accuracy: 0.9548
2024-08-15 17:41:48,996 : INFO : Precision score for label_class 0: 0.8895
2024-08-15 17:41:48,996 : INFO : Precision score for label_class 1: 0.9718
2024-08-15 17:41:48,996 : INFO : Precision score for label_class 2: 0.9494
2024-08-15 17:41:48,996 : INFO : Recall score for label_class 0: 0.9573
2024-08-15 17:41:48,996 : INFO : Recall score for label_class 1: 0.9706
2024-08-15 17:41:48,996 : INFO : Recall score for label_class 2: 0.9212
2024-08-15 17:41:48,996 : INFO : Average F1 score: 0.9428
2024-08-15 17:41:49,462 : INFO : Average loss over validation batches: 0.3270
2024-08-15 17:41:49,462 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:49,462 : INFO : Validation metrics:
2024-08-15 17:41:49,462 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:49,465 : INFO : Accuracy: 0.8830
2024-08-15 17:41:49,465 : INFO : Precision score for label_class 0: 0.7742
2024-08-15 17:41:49,465 : INFO : Precision score for label_class 1: 0.9263
2024-08-15 17:41:49,465 : INFO : Precision score for label_class 2: 0.8400
2024-08-15 17:41:49,465 : INFO : Recall score for label_class 0: 0.8372
2024-08-15 17:41:49,465 : INFO : Recall score for label_class 1: 0.9084
2024-08-15 17:41:49,465 : INFO : Recall score for label_class 2: 0.8448
2024-08-15 17:41:49,465 : INFO : Average F1 score: 0.8547
2024-08-15 17:41:49,465 : INFO : Validation metric decreased (0.351200 --> 0.327036).  Saving model ...
2024-08-15 17:41:49,569 : INFO : Starting epoch 5
2024-08-15 17:41:49,620 : INFO : Current training batch loss: 0.0833 in epoch 5
2024-08-15 17:41:50,434 : INFO : Current training batch loss: 0.0666 in epoch 5
2024-08-15 17:41:51,249 : INFO : Current training batch loss: 0.0681 in epoch 5
2024-08-15 17:41:52,063 : INFO : Current training batch loss: 0.0191 in epoch 5
2024-08-15 17:41:52,878 : INFO : Current training batch loss: 0.0732 in epoch 5
2024-08-15 17:41:53,028 : INFO : Epoch finished, average loss over training batches: 0.0995
2024-08-15 17:41:53,029 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:53,029 : INFO : Training metrics:
2024-08-15 17:41:53,029 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:53,037 : INFO : Accuracy: 0.9707
2024-08-15 17:41:53,037 : INFO : Precision score for label_class 0: 0.9220
2024-08-15 17:41:53,037 : INFO : Precision score for label_class 1: 0.9830
2024-08-15 17:41:53,037 : INFO : Precision score for label_class 2: 0.9671
2024-08-15 17:41:53,037 : INFO : Recall score for label_class 0: 0.9726
2024-08-15 17:41:53,037 : INFO : Recall score for label_class 1: 0.9806
2024-08-15 17:41:53,037 : INFO : Recall score for label_class 2: 0.9496
2024-08-15 17:41:53,037 : INFO : Average F1 score: 0.9622
2024-08-15 17:41:53,504 : INFO : Average loss over validation batches: 0.3924
2024-08-15 17:41:53,504 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:53,504 : INFO : Validation metrics:
2024-08-15 17:41:53,504 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:53,507 : INFO : Accuracy: 0.8785
2024-08-15 17:41:53,507 : INFO : Precision score for label_class 0: 0.7802
2024-08-15 17:41:53,507 : INFO : Precision score for label_class 1: 0.9267
2024-08-15 17:41:53,507 : INFO : Precision score for label_class 2: 0.8171
2024-08-15 17:41:53,507 : INFO : Recall score for label_class 0: 0.8256
2024-08-15 17:41:53,507 : INFO : Recall score for label_class 1: 0.9133
2024-08-15 17:41:53,507 : INFO : Recall score for label_class 2: 0.8218
2024-08-15 17:41:53,507 : INFO : Average F1 score: 0.8472
2024-08-15 17:41:53,507 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:41:53,507 : INFO : Starting epoch 6
2024-08-15 17:41:54,161 : INFO : Current training batch loss: 0.0070 in epoch 6
2024-08-15 17:41:54,975 : INFO : Current training batch loss: 0.0238 in epoch 6
2024-08-15 17:41:55,789 : INFO : Current training batch loss: 0.0152 in epoch 6
2024-08-15 17:41:56,604 : INFO : Current training batch loss: 0.0087 in epoch 6
2024-08-15 17:41:56,955 : INFO : Epoch finished, average loss over training batches: 0.0645
2024-08-15 17:41:56,955 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:56,955 : INFO : Training metrics:
2024-08-15 17:41:56,955 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:56,963 : INFO : Accuracy: 0.9804
2024-08-15 17:41:56,963 : INFO : Precision score for label_class 0: 0.9556
2024-08-15 17:41:56,963 : INFO : Precision score for label_class 1: 0.9899
2024-08-15 17:41:56,963 : INFO : Precision score for label_class 2: 0.9714
2024-08-15 17:41:56,963 : INFO : Recall score for label_class 0: 0.9848
2024-08-15 17:41:56,963 : INFO : Recall score for label_class 1: 0.9862
2024-08-15 17:41:56,963 : INFO : Recall score for label_class 2: 0.9664
2024-08-15 17:41:56,963 : INFO : Average F1 score: 0.9757
2024-08-15 17:41:57,431 : INFO : Average loss over validation batches: 0.3854
2024-08-15 17:41:57,431 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:57,431 : INFO : Validation metrics:
2024-08-15 17:41:57,431 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:41:57,434 : INFO : Accuracy: 0.8919
2024-08-15 17:41:57,434 : INFO : Precision score for label_class 0: 0.8085
2024-08-15 17:41:57,434 : INFO : Precision score for label_class 1: 0.9233
2024-08-15 17:41:57,434 : INFO : Precision score for label_class 2: 0.8598
2024-08-15 17:41:57,434 : INFO : Recall score for label_class 0: 0.8837
2024-08-15 17:41:57,434 : INFO : Recall score for label_class 1: 0.9277
2024-08-15 17:41:57,434 : INFO : Recall score for label_class 2: 0.8103
2024-08-15 17:41:57,434 : INFO : Average F1 score: 0.8681
2024-08-15 17:41:57,434 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:41:57,434 : INFO : Starting epoch 7
2024-08-15 17:41:57,886 : INFO : Current training batch loss: 0.1308 in epoch 7
2024-08-15 17:41:58,701 : INFO : Current training batch loss: 0.0236 in epoch 7
2024-08-15 17:41:59,515 : INFO : Current training batch loss: 0.0102 in epoch 7
2024-08-15 17:42:00,329 : INFO : Current training batch loss: 0.0091 in epoch 7
2024-08-15 17:42:00,882 : INFO : Epoch finished, average loss over training batches: 0.0411
2024-08-15 17:42:00,882 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:00,882 : INFO : Training metrics:
2024-08-15 17:42:00,882 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:00,887 : INFO : Accuracy: 0.9870
2024-08-15 17:42:00,887 : INFO : Precision score for label_class 0: 0.9552
2024-08-15 17:42:00,887 : INFO : Precision score for label_class 1: 0.9944
2024-08-15 17:42:00,887 : INFO : Precision score for label_class 2: 0.9857
2024-08-15 17:42:00,887 : INFO : Recall score for label_class 0: 0.9756
2024-08-15 17:42:00,887 : INFO : Recall score for label_class 1: 0.9925
2024-08-15 17:42:00,887 : INFO : Recall score for label_class 2: 0.9806
2024-08-15 17:42:00,887 : INFO : Average F1 score: 0.9806
2024-08-15 17:42:01,353 : INFO : Average loss over validation batches: 0.5152
2024-08-15 17:42:01,353 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:01,353 : INFO : Validation metrics:
2024-08-15 17:42:01,353 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:01,357 : INFO : Accuracy: 0.8681
2024-08-15 17:42:01,357 : INFO : Precision score for label_class 0: 0.7708
2024-08-15 17:42:01,357 : INFO : Precision score for label_class 1: 0.8733
2024-08-15 17:42:01,357 : INFO : Precision score for label_class 2: 0.9225
2024-08-15 17:42:01,357 : INFO : Recall score for label_class 0: 0.8605
2024-08-15 17:42:01,357 : INFO : Recall score for label_class 1: 0.9470
2024-08-15 17:42:01,357 : INFO : Recall score for label_class 2: 0.6839
2024-08-15 17:42:01,357 : INFO : Average F1 score: 0.8358
2024-08-15 17:42:01,357 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:42:01,357 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:42:01,394 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:42:01,910 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:01,911 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:42:01,911 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:01,914 : INFO : Accuracy: 0.8830
2024-08-15 17:42:01,914 : INFO : Precision score for label_class 0: 0.7742
2024-08-15 17:42:01,914 : INFO : Precision score for label_class 1: 0.9263
2024-08-15 17:42:01,914 : INFO : Precision score for label_class 2: 0.8400
2024-08-15 17:42:01,914 : INFO : Recall score for label_class 0: 0.8372
2024-08-15 17:42:01,914 : INFO : Recall score for label_class 1: 0.9084
2024-08-15 17:42:01,914 : INFO : Recall score for label_class 2: 0.8448
2024-08-15 17:42:01,914 : INFO : Average F1 score: 0.8547
2024-08-15 17:42:01,914 : INFO : Determined score from best model, ending training.
2024-08-15 17:42:01,921 : INFO : Split 1 is finished, the score is: 0.8547
2024-08-15 17:42:01,921 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:01,921 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:01,921 : INFO : Starting training for split 2
2024-08-15 17:42:01,935 : INFO : Starting to tokenize the sequences.
2024-08-15 17:42:01,941 : INFO : Tokenization is finished.
2024-08-15 17:42:01,958 : INFO : Starting to tokenize the sequences.
2024-08-15 17:42:01,963 : INFO : Tokenization is finished.
2024-08-15 17:42:01,968 : INFO : Counting occurences of labels...
2024-08-15 17:42:01,969 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 343, 1601,  754]))
2024-08-15 17:42:01,969 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 71, 410, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:42:02,016 : INFO : Starting epoch 1
2024-08-15 17:42:02,068 : INFO : Current training batch loss: 1.1127 in epoch 1
2024-08-15 17:42:02,882 : INFO : Current training batch loss: 1.0356 in epoch 1
2024-08-15 17:42:03,697 : INFO : Current training batch loss: 0.9458 in epoch 1
2024-08-15 17:42:04,523 : INFO : Current training batch loss: 0.6346 in epoch 1
2024-08-15 17:42:05,337 : INFO : Current training batch loss: 0.6574 in epoch 1
2024-08-15 17:42:05,497 : INFO : Epoch finished, average loss over training batches: 0.8668
2024-08-15 17:42:05,498 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:05,498 : INFO : Training metrics:
2024-08-15 17:42:05,498 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:05,512 : INFO : Accuracy: 0.6138
2024-08-15 17:42:05,513 : INFO : Precision score for label_class 0: 0.4098
2024-08-15 17:42:05,513 : INFO : Precision score for label_class 1: 0.6746
2024-08-15 17:42:05,513 : INFO : Precision score for label_class 2: 0.4330
2024-08-15 17:42:05,513 : INFO : Recall score for label_class 0: 0.0729
2024-08-15 17:42:05,513 : INFO : Recall score for label_class 1: 0.8532
2024-08-15 17:42:05,513 : INFO : Recall score for label_class 2: 0.3515
2024-08-15 17:42:05,513 : INFO : Average F1 score: 0.4217
2024-08-15 17:42:05,998 : INFO : Average loss over validation batches: 0.5810
2024-08-15 17:42:05,998 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:05,998 : INFO : Validation metrics:
2024-08-15 17:42:05,998 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:06,001 : INFO : Accuracy: 0.7674
2024-08-15 17:42:06,001 : INFO : Precision score for label_class 0: 0.7333
2024-08-15 17:42:06,001 : INFO : Precision score for label_class 1: 0.8895
2024-08-15 17:42:06,001 : INFO : Precision score for label_class 2: 0.6173
2024-08-15 17:42:06,001 : INFO : Recall score for label_class 0: 0.4648
2024-08-15 17:42:06,001 : INFO : Recall score for label_class 1: 0.7659
2024-08-15 17:42:06,001 : INFO : Recall score for label_class 2: 0.8814
2024-08-15 17:42:06,001 : INFO : Average F1 score: 0.7060
2024-08-15 17:42:06,002 : INFO : Validation metric decreased (inf --> 0.580989).  Saving model ...
2024-08-15 17:42:06,103 : INFO : Starting epoch 2
2024-08-15 17:42:06,756 : INFO : Current training batch loss: 0.4666 in epoch 2
2024-08-15 17:42:07,571 : INFO : Current training batch loss: 0.4272 in epoch 2
2024-08-15 17:42:08,400 : INFO : Current training batch loss: 0.2882 in epoch 2
2024-08-15 17:42:09,215 : INFO : Current training batch loss: 0.2913 in epoch 2
2024-08-15 17:42:09,566 : INFO : Epoch finished, average loss over training batches: 0.3985
2024-08-15 17:42:09,566 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:09,566 : INFO : Training metrics:
2024-08-15 17:42:09,566 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:09,575 : INFO : Accuracy: 0.8621
2024-08-15 17:42:09,575 : INFO : Precision score for label_class 0: 0.7870
2024-08-15 17:42:09,575 : INFO : Precision score for label_class 1: 0.8930
2024-08-15 17:42:09,575 : INFO : Precision score for label_class 2: 0.8258
2024-08-15 17:42:09,575 : INFO : Recall score for label_class 0: 0.7755
2024-08-15 17:42:09,575 : INFO : Recall score for label_class 1: 0.9225
2024-08-15 17:42:09,575 : INFO : Recall score for label_class 2: 0.7732
2024-08-15 17:42:09,575 : INFO : Average F1 score: 0.8291
2024-08-15 17:42:10,038 : INFO : Average loss over validation batches: 0.4174
2024-08-15 17:42:10,039 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:10,039 : INFO : Validation metrics:
2024-08-15 17:42:10,039 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:10,042 : INFO : Accuracy: 0.8430
2024-08-15 17:42:10,042 : INFO : Precision score for label_class 0: 0.7612
2024-08-15 17:42:10,042 : INFO : Precision score for label_class 1: 0.9059
2024-08-15 17:42:10,042 : INFO : Precision score for label_class 2: 0.7535
2024-08-15 17:42:10,042 : INFO : Recall score for label_class 0: 0.7183
2024-08-15 17:42:10,042 : INFO : Recall score for label_class 1: 0.8683
2024-08-15 17:42:10,042 : INFO : Recall score for label_class 2: 0.8351
2024-08-15 17:42:10,042 : INFO : Average F1 score: 0.8060
2024-08-15 17:42:10,042 : INFO : Validation metric decreased (0.580989 --> 0.417450).  Saving model ...
2024-08-15 17:42:10,139 : INFO : Starting epoch 3
2024-08-15 17:42:10,592 : INFO : Current training batch loss: 0.2064 in epoch 3
2024-08-15 17:42:11,406 : INFO : Current training batch loss: 0.2558 in epoch 3
2024-08-15 17:42:12,221 : INFO : Current training batch loss: 0.2212 in epoch 3
2024-08-15 17:42:13,035 : INFO : Current training batch loss: 0.0732 in epoch 3
2024-08-15 17:42:13,604 : INFO : Epoch finished, average loss over training batches: 0.2002
2024-08-15 17:42:13,604 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:13,604 : INFO : Training metrics:
2024-08-15 17:42:13,604 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:13,617 : INFO : Accuracy: 0.9351
2024-08-15 17:42:13,617 : INFO : Precision score for label_class 0: 0.8746
2024-08-15 17:42:13,617 : INFO : Precision score for label_class 1: 0.9547
2024-08-15 17:42:13,617 : INFO : Precision score for label_class 2: 0.9211
2024-08-15 17:42:13,617 : INFO : Recall score for label_class 0: 0.8950
2024-08-15 17:42:13,617 : INFO : Recall score for label_class 1: 0.9613
2024-08-15 17:42:13,617 : INFO : Recall score for label_class 2: 0.8979
2024-08-15 17:42:13,617 : INFO : Average F1 score: 0.9173
2024-08-15 17:42:14,093 : INFO : Average loss over validation batches: 0.4351
2024-08-15 17:42:14,093 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:14,093 : INFO : Validation metrics:
2024-08-15 17:42:14,093 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:14,097 : INFO : Accuracy: 0.8607
2024-08-15 17:42:14,097 : INFO : Precision score for label_class 0: 0.8154
2024-08-15 17:42:14,097 : INFO : Precision score for label_class 1: 0.8699
2024-08-15 17:42:14,097 : INFO : Precision score for label_class 2: 0.8547
2024-08-15 17:42:14,097 : INFO : Recall score for label_class 0: 0.7465
2024-08-15 17:42:14,097 : INFO : Recall score for label_class 1: 0.9293
2024-08-15 17:42:14,097 : INFO : Recall score for label_class 2: 0.7577
2024-08-15 17:42:14,097 : INFO : Average F1 score: 0.8271
2024-08-15 17:42:14,097 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:42:14,097 : INFO : Starting epoch 4
2024-08-15 17:42:14,348 : INFO : Current training batch loss: 0.3065 in epoch 4
2024-08-15 17:42:15,160 : INFO : Current training batch loss: 0.0557 in epoch 4
2024-08-15 17:42:15,969 : INFO : Current training batch loss: 0.1249 in epoch 4
2024-08-15 17:42:16,781 : INFO : Current training batch loss: 0.1628 in epoch 4
2024-08-15 17:42:17,523 : INFO : Epoch finished, average loss over training batches: 0.1216
2024-08-15 17:42:17,523 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:17,523 : INFO : Training metrics:
2024-08-15 17:42:17,523 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:17,535 : INFO : Accuracy: 0.9626
2024-08-15 17:42:17,535 : INFO : Precision score for label_class 0: 0.8933
2024-08-15 17:42:17,535 : INFO : Precision score for label_class 1: 0.9812
2024-08-15 17:42:17,535 : INFO : Precision score for label_class 2: 0.9555
2024-08-15 17:42:17,535 : INFO : Recall score for label_class 0: 0.9271
2024-08-15 17:42:17,535 : INFO : Recall score for label_class 1: 0.9806
2024-08-15 17:42:17,535 : INFO : Recall score for label_class 2: 0.9403
2024-08-15 17:42:17,535 : INFO : Average F1 score: 0.9462
2024-08-15 17:42:18,000 : INFO : Average loss over validation batches: 0.4226
2024-08-15 17:42:18,000 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:18,000 : INFO : Validation metrics:
2024-08-15 17:42:18,000 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:18,004 : INFO : Accuracy: 0.8681
2024-08-15 17:42:18,004 : INFO : Precision score for label_class 0: 0.8406
2024-08-15 17:42:18,004 : INFO : Precision score for label_class 1: 0.8947
2024-08-15 17:42:18,004 : INFO : Precision score for label_class 2: 0.8191
2024-08-15 17:42:18,004 : INFO : Recall score for label_class 0: 0.8169
2024-08-15 17:42:18,004 : INFO : Recall score for label_class 1: 0.9122
2024-08-15 17:42:18,004 : INFO : Recall score for label_class 2: 0.7938
2024-08-15 17:42:18,004 : INFO : Average F1 score: 0.8461
2024-08-15 17:42:18,004 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:42:18,004 : INFO : Starting epoch 5
2024-08-15 17:42:18,054 : INFO : Current training batch loss: 0.1431 in epoch 5
2024-08-15 17:42:18,864 : INFO : Current training batch loss: 0.0830 in epoch 5
2024-08-15 17:42:19,675 : INFO : Current training batch loss: 0.0224 in epoch 5
2024-08-15 17:42:20,486 : INFO : Current training batch loss: 0.1166 in epoch 5
2024-08-15 17:42:21,302 : INFO : Current training batch loss: 0.0124 in epoch 5
2024-08-15 17:42:21,452 : INFO : Epoch finished, average loss over training batches: 0.0850
2024-08-15 17:42:21,452 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:21,452 : INFO : Training metrics:
2024-08-15 17:42:21,453 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:21,463 : INFO : Accuracy: 0.9766
2024-08-15 17:42:21,463 : INFO : Precision score for label_class 0: 0.9410
2024-08-15 17:42:21,463 : INFO : Precision score for label_class 1: 0.9875
2024-08-15 17:42:21,463 : INFO : Precision score for label_class 2: 0.9705
2024-08-15 17:42:21,463 : INFO : Recall score for label_class 0: 0.9767
2024-08-15 17:42:21,463 : INFO : Recall score for label_class 1: 0.9850
2024-08-15 17:42:21,463 : INFO : Recall score for label_class 2: 0.9589
2024-08-15 17:42:21,463 : INFO : Average F1 score: 0.9698
2024-08-15 17:42:21,928 : INFO : Average loss over validation batches: 0.5618
2024-08-15 17:42:21,928 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:21,928 : INFO : Validation metrics:
2024-08-15 17:42:21,928 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:21,932 : INFO : Accuracy: 0.8385
2024-08-15 17:42:21,932 : INFO : Precision score for label_class 0: 0.7229
2024-08-15 17:42:21,932 : INFO : Precision score for label_class 1: 0.9239
2024-08-15 17:42:21,932 : INFO : Precision score for label_class 2: 0.7411
2024-08-15 17:42:21,932 : INFO : Recall score for label_class 0: 0.8451
2024-08-15 17:42:21,932 : INFO : Recall score for label_class 1: 0.8293
2024-08-15 17:42:21,932 : INFO : Recall score for label_class 2: 0.8557
2024-08-15 17:42:21,932 : INFO : Average F1 score: 0.8158
2024-08-15 17:42:21,932 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:42:21,932 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:42:21,964 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:42:22,468 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:22,468 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:42:22,468 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:22,472 : INFO : Accuracy: 0.8430
2024-08-15 17:42:22,472 : INFO : Precision score for label_class 0: 0.7612
2024-08-15 17:42:22,472 : INFO : Precision score for label_class 1: 0.9059
2024-08-15 17:42:22,472 : INFO : Precision score for label_class 2: 0.7535
2024-08-15 17:42:22,472 : INFO : Recall score for label_class 0: 0.7183
2024-08-15 17:42:22,472 : INFO : Recall score for label_class 1: 0.8683
2024-08-15 17:42:22,472 : INFO : Recall score for label_class 2: 0.8351
2024-08-15 17:42:22,472 : INFO : Average F1 score: 0.8060
2024-08-15 17:42:22,472 : INFO : Determined score from best model, ending training.
2024-08-15 17:42:22,474 : INFO : Split 2 is finished, the score is: 0.8060
2024-08-15 17:42:22,474 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:22,474 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:22,474 : INFO : Starting training for split 3
2024-08-15 17:42:22,492 : INFO : Starting to tokenize the sequences.
2024-08-15 17:42:22,498 : INFO : Tokenization is finished.
2024-08-15 17:42:22,515 : INFO : Starting to tokenize the sequences.
2024-08-15 17:42:22,519 : INFO : Tokenization is finished.
2024-08-15 17:42:22,524 : INFO : Counting occurences of labels...
2024-08-15 17:42:22,525 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1611,  759]))
2024-08-15 17:42:22,525 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 400, 189]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:42:22,567 : INFO : Starting epoch 1
2024-08-15 17:42:22,618 : INFO : Current training batch loss: 1.1042 in epoch 1
2024-08-15 17:42:23,433 : INFO : Current training batch loss: 1.0297 in epoch 1
2024-08-15 17:42:24,243 : INFO : Current training batch loss: 0.8743 in epoch 1
2024-08-15 17:42:25,078 : INFO : Current training batch loss: 0.7948 in epoch 1
2024-08-15 17:42:25,892 : INFO : Current training batch loss: 0.6842 in epoch 1
2024-08-15 17:42:26,043 : INFO : Epoch finished, average loss over training batches: 0.8749
2024-08-15 17:42:26,043 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:26,043 : INFO : Training metrics:
2024-08-15 17:42:26,043 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:26,050 : INFO : Accuracy: 0.6134
2024-08-15 17:42:26,051 : INFO : Precision score for label_class 0: 0.3066
2024-08-15 17:42:26,051 : INFO : Precision score for label_class 1: 0.6703
2024-08-15 17:42:26,051 : INFO : Precision score for label_class 2: 0.4255
2024-08-15 17:42:26,051 : INFO : Recall score for label_class 0: 0.1280
2024-08-15 17:42:26,051 : INFO : Recall score for label_class 1: 0.8895
2024-08-15 17:42:26,051 : INFO : Recall score for label_class 2: 0.2372
2024-08-15 17:42:26,051 : INFO : Average F1 score: 0.4166
2024-08-15 17:42:26,514 : INFO : Average loss over validation batches: 0.5956
2024-08-15 17:42:26,515 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:26,515 : INFO : Validation metrics:
2024-08-15 17:42:26,515 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:26,517 : INFO : Accuracy: 0.7348
2024-08-15 17:42:26,517 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:42:26,517 : INFO : Precision score for label_class 1: 0.8564
2024-08-15 17:42:26,517 : INFO : Precision score for label_class 2: 0.5455
2024-08-15 17:42:26,517 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:42:26,517 : INFO : Recall score for label_class 1: 0.8800
2024-08-15 17:42:26,517 : INFO : Recall score for label_class 2: 0.7619
2024-08-15 17:42:26,517 : INFO : Average F1 score: 0.5013
2024-08-15 17:42:26,517 : INFO : Validation metric decreased (inf --> 0.595581).  Saving model ...
2024-08-15 17:42:26,628 : INFO : Starting epoch 2
2024-08-15 17:42:27,282 : INFO : Current training batch loss: 0.5692 in epoch 2
2024-08-15 17:42:28,097 : INFO : Current training batch loss: 0.4350 in epoch 2
2024-08-15 17:42:28,911 : INFO : Current training batch loss: 0.3809 in epoch 2
2024-08-15 17:42:29,727 : INFO : Current training batch loss: 0.2960 in epoch 2
2024-08-15 17:42:30,086 : INFO : Epoch finished, average loss over training batches: 0.4482
2024-08-15 17:42:30,086 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:30,086 : INFO : Training metrics:
2024-08-15 17:42:30,086 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:30,095 : INFO : Accuracy: 0.8365
2024-08-15 17:42:30,095 : INFO : Precision score for label_class 0: 0.7692
2024-08-15 17:42:30,095 : INFO : Precision score for label_class 1: 0.8754
2024-08-15 17:42:30,095 : INFO : Precision score for label_class 2: 0.7739
2024-08-15 17:42:30,095 : INFO : Recall score for label_class 0: 0.7012
2024-08-15 17:42:30,095 : INFO : Recall score for label_class 1: 0.9119
2024-08-15 17:42:30,095 : INFO : Recall score for label_class 2: 0.7352
2024-08-15 17:42:30,095 : INFO : Average F1 score: 0.7937
2024-08-15 17:42:30,564 : INFO : Average loss over validation batches: 0.4032
2024-08-15 17:42:30,564 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:30,564 : INFO : Validation metrics:
2024-08-15 17:42:30,564 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:30,566 : INFO : Accuracy: 0.8563
2024-08-15 17:42:30,566 : INFO : Precision score for label_class 0: 0.8293
2024-08-15 17:42:30,566 : INFO : Precision score for label_class 1: 0.9075
2024-08-15 17:42:30,567 : INFO : Precision score for label_class 2: 0.7617
2024-08-15 17:42:30,567 : INFO : Recall score for label_class 0: 0.7907
2024-08-15 17:42:30,567 : INFO : Recall score for label_class 1: 0.9075
2024-08-15 17:42:30,567 : INFO : Recall score for label_class 2: 0.7778
2024-08-15 17:42:30,567 : INFO : Average F1 score: 0.8289
2024-08-15 17:42:30,567 : INFO : Validation metric decreased (0.595581 --> 0.403162).  Saving model ...
2024-08-15 17:42:30,688 : INFO : Starting epoch 3
2024-08-15 17:42:31,139 : INFO : Current training batch loss: 0.1951 in epoch 3
2024-08-15 17:42:31,949 : INFO : Current training batch loss: 0.2641 in epoch 3
2024-08-15 17:42:32,759 : INFO : Current training batch loss: 0.2021 in epoch 3
2024-08-15 17:42:33,574 : INFO : Current training batch loss: 0.1493 in epoch 3
2024-08-15 17:42:34,127 : INFO : Epoch finished, average loss over training batches: 0.2516
2024-08-15 17:42:34,127 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:34,127 : INFO : Training metrics:
2024-08-15 17:42:34,127 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:34,131 : INFO : Accuracy: 0.9188
2024-08-15 17:42:34,131 : INFO : Precision score for label_class 0: 0.8090
2024-08-15 17:42:34,131 : INFO : Precision score for label_class 1: 0.9548
2024-08-15 17:42:34,131 : INFO : Precision score for label_class 2: 0.8947
2024-08-15 17:42:34,131 : INFO : Recall score for label_class 0: 0.8780
2024-08-15 17:42:34,131 : INFO : Recall score for label_class 1: 0.9435
2024-08-15 17:42:34,131 : INFO : Recall score for label_class 2: 0.8841
2024-08-15 17:42:34,131 : INFO : Average F1 score: 0.8935
2024-08-15 17:42:34,596 : INFO : Average loss over validation batches: 0.4386
2024-08-15 17:42:34,596 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:34,596 : INFO : Validation metrics:
2024-08-15 17:42:34,596 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:34,599 : INFO : Accuracy: 0.8681
2024-08-15 17:42:34,599 : INFO : Precision score for label_class 0: 0.8000
2024-08-15 17:42:34,599 : INFO : Precision score for label_class 1: 0.8879
2024-08-15 17:42:34,599 : INFO : Precision score for label_class 2: 0.8519
2024-08-15 17:42:34,599 : INFO : Recall score for label_class 0: 0.7907
2024-08-15 17:42:34,599 : INFO : Recall score for label_class 1: 0.9500
2024-08-15 17:42:34,599 : INFO : Recall score for label_class 2: 0.7302
2024-08-15 17:42:34,599 : INFO : Average F1 score: 0.8332
2024-08-15 17:42:34,599 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:42:34,599 : INFO : Starting epoch 4
2024-08-15 17:42:34,851 : INFO : Current training batch loss: 0.3641 in epoch 4
2024-08-15 17:42:35,665 : INFO : Current training batch loss: 0.2483 in epoch 4
2024-08-15 17:42:36,480 : INFO : Current training batch loss: 0.3057 in epoch 4
2024-08-15 17:42:37,295 : INFO : Current training batch loss: 0.1360 in epoch 4
2024-08-15 17:42:38,049 : INFO : Epoch finished, average loss over training batches: 0.1547
2024-08-15 17:42:38,050 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:38,050 : INFO : Training metrics:
2024-08-15 17:42:38,050 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:38,057 : INFO : Accuracy: 0.9518
2024-08-15 17:42:38,057 : INFO : Precision score for label_class 0: 0.8704
2024-08-15 17:42:38,057 : INFO : Precision score for label_class 1: 0.9767
2024-08-15 17:42:38,057 : INFO : Precision score for label_class 2: 0.9376
2024-08-15 17:42:38,057 : INFO : Recall score for label_class 0: 0.9421
2024-08-15 17:42:38,057 : INFO : Recall score for label_class 1: 0.9640
2024-08-15 17:42:38,057 : INFO : Recall score for label_class 2: 0.9302
2024-08-15 17:42:38,057 : INFO : Average F1 score: 0.9363
2024-08-15 17:42:38,525 : INFO : Average loss over validation batches: 0.4251
2024-08-15 17:42:38,525 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:38,525 : INFO : Validation metrics:
2024-08-15 17:42:38,525 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:38,527 : INFO : Accuracy: 0.8474
2024-08-15 17:42:38,527 : INFO : Precision score for label_class 0: 0.7978
2024-08-15 17:42:38,527 : INFO : Precision score for label_class 1: 0.9492
2024-08-15 17:42:38,527 : INFO : Precision score for label_class 2: 0.7112
2024-08-15 17:42:38,527 : INFO : Recall score for label_class 0: 0.8256
2024-08-15 17:42:38,527 : INFO : Recall score for label_class 1: 0.8400
2024-08-15 17:42:38,527 : INFO : Recall score for label_class 2: 0.8730
2024-08-15 17:42:38,527 : INFO : Average F1 score: 0.8288
2024-08-15 17:42:38,527 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:42:38,527 : INFO : Starting epoch 5
2024-08-15 17:42:38,578 : INFO : Current training batch loss: 0.0407 in epoch 5
2024-08-15 17:42:39,393 : INFO : Current training batch loss: 0.1716 in epoch 5
2024-08-15 17:42:40,208 : INFO : Current training batch loss: 0.0207 in epoch 5
2024-08-15 17:42:41,019 : INFO : Current training batch loss: 0.2027 in epoch 5
2024-08-15 17:42:41,830 : INFO : Current training batch loss: 0.0130 in epoch 5
2024-08-15 17:42:41,973 : INFO : Epoch finished, average loss over training batches: 0.0917
2024-08-15 17:42:41,973 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:41,973 : INFO : Training metrics:
2024-08-15 17:42:41,973 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:41,982 : INFO : Accuracy: 0.9752
2024-08-15 17:42:41,982 : INFO : Precision score for label_class 0: 0.9065
2024-08-15 17:42:41,982 : INFO : Precision score for label_class 1: 0.9912
2024-08-15 17:42:41,982 : INFO : Precision score for label_class 2: 0.9734
2024-08-15 17:42:41,982 : INFO : Recall score for label_class 0: 0.9756
2024-08-15 17:42:41,982 : INFO : Recall score for label_class 1: 0.9801
2024-08-15 17:42:41,982 : INFO : Recall score for label_class 2: 0.9644
2024-08-15 17:42:41,982 : INFO : Average F1 score: 0.9648
2024-08-15 17:42:42,446 : INFO : Average loss over validation batches: 0.4735
2024-08-15 17:42:42,446 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:42,446 : INFO : Validation metrics:
2024-08-15 17:42:42,446 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:42,448 : INFO : Accuracy: 0.8474
2024-08-15 17:42:42,448 : INFO : Precision score for label_class 0: 0.8391
2024-08-15 17:42:42,448 : INFO : Precision score for label_class 1: 0.9456
2024-08-15 17:42:42,448 : INFO : Precision score for label_class 2: 0.7071
2024-08-15 17:42:42,448 : INFO : Recall score for label_class 0: 0.8488
2024-08-15 17:42:42,448 : INFO : Recall score for label_class 1: 0.8250
2024-08-15 17:42:42,448 : INFO : Recall score for label_class 2: 0.8942
2024-08-15 17:42:42,448 : INFO : Average F1 score: 0.8383
2024-08-15 17:42:42,448 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:42:42,448 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:42:42,487 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:42:43,076 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:43,076 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:42:43,076 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:43,079 : INFO : Accuracy: 0.8563
2024-08-15 17:42:43,079 : INFO : Precision score for label_class 0: 0.8293
2024-08-15 17:42:43,079 : INFO : Precision score for label_class 1: 0.9075
2024-08-15 17:42:43,079 : INFO : Precision score for label_class 2: 0.7617
2024-08-15 17:42:43,079 : INFO : Recall score for label_class 0: 0.7907
2024-08-15 17:42:43,079 : INFO : Recall score for label_class 1: 0.9075
2024-08-15 17:42:43,079 : INFO : Recall score for label_class 2: 0.7778
2024-08-15 17:42:43,079 : INFO : Average F1 score: 0.8289
2024-08-15 17:42:43,079 : INFO : Determined score from best model, ending training.
2024-08-15 17:42:43,080 : INFO : Split 3 is finished, the score is: 0.8289
2024-08-15 17:42:43,080 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:43,080 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:43,080 : INFO : Starting training for split 4
2024-08-15 17:42:43,100 : INFO : Starting to tokenize the sequences.
2024-08-15 17:42:43,106 : INFO : Tokenization is finished.
2024-08-15 17:42:43,123 : INFO : Starting to tokenize the sequences.
2024-08-15 17:42:43,127 : INFO : Tokenization is finished.
2024-08-15 17:42:43,132 : INFO : Counting occurences of labels...
2024-08-15 17:42:43,133 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 327, 1621,  751]))
2024-08-15 17:42:43,133 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 87, 390, 197]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:42:43,188 : INFO : Starting epoch 1
2024-08-15 17:42:43,239 : INFO : Current training batch loss: 1.0778 in epoch 1
2024-08-15 17:42:44,049 : INFO : Current training batch loss: 1.0295 in epoch 1
2024-08-15 17:42:44,859 : INFO : Current training batch loss: 0.8210 in epoch 1
2024-08-15 17:42:45,668 : INFO : Current training batch loss: 0.6803 in epoch 1
2024-08-15 17:42:46,478 : INFO : Current training batch loss: 0.5479 in epoch 1
2024-08-15 17:42:46,621 : INFO : Epoch finished, average loss over training batches: 0.8318
2024-08-15 17:42:46,621 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:46,621 : INFO : Training metrics:
2024-08-15 17:42:46,621 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:46,630 : INFO : Accuracy: 0.6688
2024-08-15 17:42:46,631 : INFO : Precision score for label_class 0: 0.3810
2024-08-15 17:42:46,631 : INFO : Precision score for label_class 1: 0.6887
2024-08-15 17:42:46,631 : INFO : Precision score for label_class 2: 0.5871
2024-08-15 17:42:46,631 : INFO : Recall score for label_class 0: 0.0489
2024-08-15 17:42:46,631 : INFO : Recall score for label_class 1: 0.9581
2024-08-15 17:42:46,631 : INFO : Recall score for label_class 2: 0.3142
2024-08-15 17:42:46,631 : INFO : Average F1 score: 0.4325
2024-08-15 17:42:47,097 : INFO : Average loss over validation batches: 0.5686
2024-08-15 17:42:47,097 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:47,097 : INFO : Validation metrics:
2024-08-15 17:42:47,097 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:47,101 : INFO : Accuracy: 0.7537
2024-08-15 17:42:47,101 : INFO : Precision score for label_class 0: 0.5000
2024-08-15 17:42:47,101 : INFO : Precision score for label_class 1: 0.8854
2024-08-15 17:42:47,101 : INFO : Precision score for label_class 2: 0.5799
2024-08-15 17:42:47,101 : INFO : Recall score for label_class 0: 0.0115
2024-08-15 17:42:47,101 : INFO : Recall score for label_class 1: 0.8718
2024-08-15 17:42:47,101 : INFO : Recall score for label_class 2: 0.8477
2024-08-15 17:42:47,101 : INFO : Average F1 score: 0.5299
2024-08-15 17:42:47,101 : INFO : Validation metric decreased (inf --> 0.568602).  Saving model ...
2024-08-15 17:42:47,210 : INFO : Starting epoch 2
2024-08-15 17:42:47,860 : INFO : Current training batch loss: 0.5824 in epoch 2
2024-08-15 17:42:48,672 : INFO : Current training batch loss: 0.3559 in epoch 2
2024-08-15 17:42:49,485 : INFO : Current training batch loss: 0.2239 in epoch 2
2024-08-15 17:42:50,299 : INFO : Current training batch loss: 0.6616 in epoch 2
2024-08-15 17:42:50,650 : INFO : Epoch finished, average loss over training batches: 0.4188
2024-08-15 17:42:50,650 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:50,651 : INFO : Training metrics:
2024-08-15 17:42:50,651 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:50,654 : INFO : Accuracy: 0.8492
2024-08-15 17:42:50,654 : INFO : Precision score for label_class 0: 0.7558
2024-08-15 17:42:50,654 : INFO : Precision score for label_class 1: 0.8893
2024-08-15 17:42:50,654 : INFO : Precision score for label_class 2: 0.7947
2024-08-15 17:42:50,654 : INFO : Recall score for label_class 0: 0.7003
2024-08-15 17:42:50,654 : INFO : Recall score for label_class 1: 0.9217
2024-08-15 17:42:50,654 : INFO : Recall score for label_class 2: 0.7577
2024-08-15 17:42:50,654 : INFO : Average F1 score: 0.8026
2024-08-15 17:42:51,117 : INFO : Average loss over validation batches: 0.4003
2024-08-15 17:42:51,117 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:51,118 : INFO : Validation metrics:
2024-08-15 17:42:51,118 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:51,121 : INFO : Accuracy: 0.8561
2024-08-15 17:42:51,121 : INFO : Precision score for label_class 0: 0.7553
2024-08-15 17:42:51,121 : INFO : Precision score for label_class 1: 0.8642
2024-08-15 17:42:51,121 : INFO : Precision score for label_class 2: 0.8954
2024-08-15 17:42:51,121 : INFO : Recall score for label_class 0: 0.8161
2024-08-15 17:42:51,121 : INFO : Recall score for label_class 1: 0.9462
2024-08-15 17:42:51,121 : INFO : Recall score for label_class 2: 0.6954
2024-08-15 17:42:51,121 : INFO : Average F1 score: 0.8236
2024-08-15 17:42:51,121 : INFO : Validation metric decreased (0.568602 --> 0.400341).  Saving model ...
2024-08-15 17:42:51,222 : INFO : Starting epoch 3
2024-08-15 17:42:51,675 : INFO : Current training batch loss: 0.2322 in epoch 3
2024-08-15 17:42:52,490 : INFO : Current training batch loss: 0.2791 in epoch 3
2024-08-15 17:42:53,304 : INFO : Current training batch loss: 0.2509 in epoch 3
2024-08-15 17:42:54,118 : INFO : Current training batch loss: 0.0660 in epoch 3
2024-08-15 17:42:54,671 : INFO : Epoch finished, average loss over training batches: 0.2177
2024-08-15 17:42:54,671 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:54,671 : INFO : Training metrics:
2024-08-15 17:42:54,671 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:54,675 : INFO : Accuracy: 0.9315
2024-08-15 17:42:54,675 : INFO : Precision score for label_class 0: 0.8787
2024-08-15 17:42:54,675 : INFO : Precision score for label_class 1: 0.9537
2024-08-15 17:42:54,675 : INFO : Precision score for label_class 2: 0.9070
2024-08-15 17:42:54,675 : INFO : Recall score for label_class 0: 0.9083
2024-08-15 17:42:54,675 : INFO : Recall score for label_class 1: 0.9525
2024-08-15 17:42:54,675 : INFO : Recall score for label_class 2: 0.8961
2024-08-15 17:42:54,675 : INFO : Average F1 score: 0.9160
2024-08-15 17:42:55,140 : INFO : Average loss over validation batches: 0.3873
2024-08-15 17:42:55,141 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:55,141 : INFO : Validation metrics:
2024-08-15 17:42:55,141 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:55,144 : INFO : Accuracy: 0.8620
2024-08-15 17:42:55,144 : INFO : Precision score for label_class 0: 0.7634
2024-08-15 17:42:55,144 : INFO : Precision score for label_class 1: 0.8889
2024-08-15 17:42:55,144 : INFO : Precision score for label_class 2: 0.8523
2024-08-15 17:42:55,144 : INFO : Recall score for label_class 0: 0.8161
2024-08-15 17:42:55,144 : INFO : Recall score for label_class 1: 0.9231
2024-08-15 17:42:55,144 : INFO : Recall score for label_class 2: 0.7614
2024-08-15 17:42:55,144 : INFO : Average F1 score: 0.8329
2024-08-15 17:42:55,144 : INFO : Validation metric decreased (0.400341 --> 0.387255).  Saving model ...
2024-08-15 17:42:55,247 : INFO : Starting epoch 4
2024-08-15 17:42:55,500 : INFO : Current training batch loss: 0.2942 in epoch 4
2024-08-15 17:42:56,314 : INFO : Current training batch loss: 0.3097 in epoch 4
2024-08-15 17:42:57,140 : INFO : Current training batch loss: 0.1259 in epoch 4
2024-08-15 17:42:57,962 : INFO : Current training batch loss: 0.0989 in epoch 4
2024-08-15 17:42:58,715 : INFO : Epoch finished, average loss over training batches: 0.1302
2024-08-15 17:42:58,716 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:58,716 : INFO : Training metrics:
2024-08-15 17:42:58,716 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:58,720 : INFO : Accuracy: 0.9600
2024-08-15 17:42:58,720 : INFO : Precision score for label_class 0: 0.9043
2024-08-15 17:42:58,720 : INFO : Precision score for label_class 1: 0.9782
2024-08-15 17:42:58,720 : INFO : Precision score for label_class 2: 0.9465
2024-08-15 17:42:58,720 : INFO : Recall score for label_class 0: 0.9541
2024-08-15 17:42:58,720 : INFO : Recall score for label_class 1: 0.9698
2024-08-15 17:42:58,720 : INFO : Recall score for label_class 2: 0.9414
2024-08-15 17:42:58,720 : INFO : Average F1 score: 0.9488
2024-08-15 17:42:59,185 : INFO : Average loss over validation batches: 0.4693
2024-08-15 17:42:59,185 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:59,185 : INFO : Validation metrics:
2024-08-15 17:42:59,185 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:42:59,188 : INFO : Accuracy: 0.8576
2024-08-15 17:42:59,188 : INFO : Precision score for label_class 0: 0.8983
2024-08-15 17:42:59,188 : INFO : Precision score for label_class 1: 0.8815
2024-08-15 17:42:59,188 : INFO : Precision score for label_class 2: 0.8000
2024-08-15 17:42:59,188 : INFO : Recall score for label_class 0: 0.6092
2024-08-15 17:42:59,188 : INFO : Recall score for label_class 1: 0.9154
2024-08-15 17:42:59,188 : INFO : Recall score for label_class 2: 0.8528
2024-08-15 17:42:59,188 : INFO : Average F1 score: 0.8166
2024-08-15 17:42:59,188 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:42:59,188 : INFO : Starting epoch 5
2024-08-15 17:42:59,239 : INFO : Current training batch loss: 0.0362 in epoch 5
2024-08-15 17:43:00,053 : INFO : Current training batch loss: 0.1077 in epoch 5
2024-08-15 17:43:00,870 : INFO : Current training batch loss: 0.0209 in epoch 5
2024-08-15 17:43:01,685 : INFO : Current training batch loss: 0.0501 in epoch 5
2024-08-15 17:43:02,499 : INFO : Current training batch loss: 0.0104 in epoch 5
2024-08-15 17:43:02,642 : INFO : Epoch finished, average loss over training batches: 0.0765
2024-08-15 17:43:02,643 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:02,643 : INFO : Training metrics:
2024-08-15 17:43:02,643 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:02,648 : INFO : Accuracy: 0.9785
2024-08-15 17:43:02,648 : INFO : Precision score for label_class 0: 0.9233
2024-08-15 17:43:02,648 : INFO : Precision score for label_class 1: 0.9895
2024-08-15 17:43:02,648 : INFO : Precision score for label_class 2: 0.9798
2024-08-15 17:43:02,648 : INFO : Recall score for label_class 0: 0.9572
2024-08-15 17:43:02,648 : INFO : Recall score for label_class 1: 0.9864
2024-08-15 17:43:02,648 : INFO : Recall score for label_class 2: 0.9707
2024-08-15 17:43:02,648 : INFO : Average F1 score: 0.9677
2024-08-15 17:43:03,114 : INFO : Average loss over validation batches: 0.4697
2024-08-15 17:43:03,114 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:03,114 : INFO : Validation metrics:
2024-08-15 17:43:03,114 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:03,117 : INFO : Accuracy: 0.8650
2024-08-15 17:43:03,117 : INFO : Precision score for label_class 0: 0.7037
2024-08-15 17:43:03,117 : INFO : Precision score for label_class 1: 0.9206
2024-08-15 17:43:03,117 : INFO : Precision score for label_class 2: 0.8457
2024-08-15 17:43:03,117 : INFO : Recall score for label_class 0: 0.8736
2024-08-15 17:43:03,117 : INFO : Recall score for label_class 1: 0.8923
2024-08-15 17:43:03,117 : INFO : Recall score for label_class 2: 0.8071
2024-08-15 17:43:03,117 : INFO : Average F1 score: 0.8372
2024-08-15 17:43:03,117 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:43:03,117 : INFO : Starting epoch 6
2024-08-15 17:43:03,782 : INFO : Current training batch loss: 0.0480 in epoch 6
2024-08-15 17:43:04,615 : INFO : Current training batch loss: 0.0410 in epoch 6
2024-08-15 17:43:05,451 : INFO : Current training batch loss: 0.0133 in epoch 6
2024-08-15 17:43:06,297 : INFO : Current training batch loss: 0.1070 in epoch 6
2024-08-15 17:43:06,655 : INFO : Epoch finished, average loss over training batches: 0.0501
2024-08-15 17:43:06,655 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:06,655 : INFO : Training metrics:
2024-08-15 17:43:06,655 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:06,662 : INFO : Accuracy: 0.9856
2024-08-15 17:43:06,662 : INFO : Precision score for label_class 0: 0.9581
2024-08-15 17:43:06,662 : INFO : Precision score for label_class 1: 0.9932
2024-08-15 17:43:06,662 : INFO : Precision score for label_class 2: 0.9813
2024-08-15 17:43:06,662 : INFO : Recall score for label_class 0: 0.9786
2024-08-15 17:43:06,662 : INFO : Recall score for label_class 1: 0.9914
2024-08-15 17:43:06,662 : INFO : Recall score for label_class 2: 0.9760
2024-08-15 17:43:06,662 : INFO : Average F1 score: 0.9797
2024-08-15 17:43:07,155 : INFO : Average loss over validation batches: 0.5895
2024-08-15 17:43:07,155 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:07,155 : INFO : Validation metrics:
2024-08-15 17:43:07,155 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:07,158 : INFO : Accuracy: 0.8546
2024-08-15 17:43:07,158 : INFO : Precision score for label_class 0: 0.7308
2024-08-15 17:43:07,158 : INFO : Precision score for label_class 1: 0.9452
2024-08-15 17:43:07,158 : INFO : Precision score for label_class 2: 0.7713
2024-08-15 17:43:07,158 : INFO : Recall score for label_class 0: 0.8736
2024-08-15 17:43:07,158 : INFO : Recall score for label_class 1: 0.8410
2024-08-15 17:43:07,158 : INFO : Recall score for label_class 2: 0.8731
2024-08-15 17:43:07,158 : INFO : Average F1 score: 0.8350
2024-08-15 17:43:07,158 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:43:07,158 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:43:07,197 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:43:07,697 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:07,697 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:43:07,697 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:07,700 : INFO : Accuracy: 0.8620
2024-08-15 17:43:07,700 : INFO : Precision score for label_class 0: 0.7634
2024-08-15 17:43:07,700 : INFO : Precision score for label_class 1: 0.8889
2024-08-15 17:43:07,700 : INFO : Precision score for label_class 2: 0.8523
2024-08-15 17:43:07,700 : INFO : Recall score for label_class 0: 0.8161
2024-08-15 17:43:07,700 : INFO : Recall score for label_class 1: 0.9231
2024-08-15 17:43:07,700 : INFO : Recall score for label_class 2: 0.7614
2024-08-15 17:43:07,700 : INFO : Average F1 score: 0.8329
2024-08-15 17:43:07,700 : INFO : Determined score from best model, ending training.
2024-08-15 17:43:07,705 : INFO : Split 4 is finished, the score is: 0.8329
2024-08-15 17:43:07,706 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:07,706 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:07,706 : INFO : Starting training for split 5
2024-08-15 17:43:07,720 : INFO : Starting to tokenize the sequences.
2024-08-15 17:43:07,725 : INFO : Tokenization is finished.
2024-08-15 17:43:07,743 : INFO : Starting to tokenize the sequences.
2024-08-15 17:43:07,748 : INFO : Tokenization is finished.
2024-08-15 17:43:07,754 : INFO : Counting occurences of labels...
2024-08-15 17:43:07,755 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 330, 1615,  754]))
2024-08-15 17:43:07,756 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 84, 396, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:43:07,809 : INFO : Starting epoch 1
2024-08-15 17:43:07,863 : INFO : Current training batch loss: 1.1005 in epoch 1
2024-08-15 17:43:08,691 : INFO : Current training batch loss: 1.0291 in epoch 1
2024-08-15 17:43:09,530 : INFO : Current training batch loss: 0.7936 in epoch 1
2024-08-15 17:43:10,356 : INFO : Current training batch loss: 0.6584 in epoch 1
2024-08-15 17:43:11,189 : INFO : Current training batch loss: 0.7851 in epoch 1
2024-08-15 17:43:11,333 : INFO : Epoch finished, average loss over training batches: 0.8465
2024-08-15 17:43:11,333 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:11,333 : INFO : Training metrics:
2024-08-15 17:43:11,333 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:11,345 : INFO : Accuracy: 0.6276
2024-08-15 17:43:11,345 : INFO : Precision score for label_class 0: 0.1211
2024-08-15 17:43:11,345 : INFO : Precision score for label_class 1: 0.6982
2024-08-15 17:43:11,345 : INFO : Precision score for label_class 2: 0.5571
2024-08-15 17:43:11,345 : INFO : Recall score for label_class 0: 0.0818
2024-08-15 17:43:11,345 : INFO : Recall score for label_class 1: 0.8811
2024-08-15 17:43:11,345 : INFO : Recall score for label_class 2: 0.3236
2024-08-15 17:43:11,345 : INFO : Average F1 score: 0.4287
2024-08-15 17:43:11,812 : INFO : Average loss over validation batches: 0.6414
2024-08-15 17:43:11,812 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:11,812 : INFO : Validation metrics:
2024-08-15 17:43:11,812 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:11,816 : INFO : Accuracy: 0.7151
2024-08-15 17:43:11,816 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:43:11,816 : INFO : Precision score for label_class 1: 0.8199
2024-08-15 17:43:11,816 : INFO : Precision score for label_class 2: 0.5270
2024-08-15 17:43:11,816 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:43:11,816 : INFO : Recall score for label_class 1: 0.8965
2024-08-15 17:43:11,816 : INFO : Recall score for label_class 2: 0.6546
2024-08-15 17:43:11,816 : INFO : Average F1 score: 0.4801
2024-08-15 17:43:11,816 : INFO : Validation metric decreased (inf --> 0.641448).  Saving model ...
2024-08-15 17:43:11,920 : INFO : Starting epoch 2
2024-08-15 17:43:12,602 : INFO : Current training batch loss: 0.5916 in epoch 2
2024-08-15 17:43:13,430 : INFO : Current training batch loss: 0.4214 in epoch 2
2024-08-15 17:43:14,258 : INFO : Current training batch loss: 0.2717 in epoch 2
2024-08-15 17:43:15,075 : INFO : Current training batch loss: 0.4788 in epoch 2
2024-08-15 17:43:15,429 : INFO : Epoch finished, average loss over training batches: 0.4748
2024-08-15 17:43:15,430 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:15,430 : INFO : Training metrics:
2024-08-15 17:43:15,430 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:15,437 : INFO : Accuracy: 0.8270
2024-08-15 17:43:15,437 : INFO : Precision score for label_class 0: 0.7500
2024-08-15 17:43:15,437 : INFO : Precision score for label_class 1: 0.8655
2024-08-15 17:43:15,437 : INFO : Precision score for label_class 2: 0.7636
2024-08-15 17:43:15,437 : INFO : Recall score for label_class 0: 0.6455
2024-08-15 17:43:15,437 : INFO : Recall score for label_class 1: 0.9201
2024-08-15 17:43:15,437 : INFO : Recall score for label_class 2: 0.7069
2024-08-15 17:43:15,437 : INFO : Average F1 score: 0.7733
2024-08-15 17:43:15,908 : INFO : Average loss over validation batches: 0.4868
2024-08-15 17:43:15,908 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:15,908 : INFO : Validation metrics:
2024-08-15 17:43:15,908 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:15,911 : INFO : Accuracy: 0.8323
2024-08-15 17:43:15,911 : INFO : Precision score for label_class 0: 0.7887
2024-08-15 17:43:15,911 : INFO : Precision score for label_class 1: 0.8490
2024-08-15 17:43:15,911 : INFO : Precision score for label_class 2: 0.8072
2024-08-15 17:43:15,911 : INFO : Recall score for label_class 0: 0.6667
2024-08-15 17:43:15,911 : INFO : Recall score for label_class 1: 0.9369
2024-08-15 17:43:15,911 : INFO : Recall score for label_class 2: 0.6907
2024-08-15 17:43:15,911 : INFO : Average F1 score: 0.7859
2024-08-15 17:43:15,911 : INFO : Validation metric decreased (0.641448 --> 0.486815).  Saving model ...
2024-08-15 17:43:16,009 : INFO : Starting epoch 3
2024-08-15 17:43:16,477 : INFO : Current training batch loss: 0.3407 in epoch 3
2024-08-15 17:43:17,320 : INFO : Current training batch loss: 0.3625 in epoch 3
2024-08-15 17:43:18,158 : INFO : Current training batch loss: 0.2560 in epoch 3
2024-08-15 17:43:18,997 : INFO : Current training batch loss: 0.2058 in epoch 3
2024-08-15 17:43:19,573 : INFO : Epoch finished, average loss over training batches: 0.2537
2024-08-15 17:43:19,574 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:19,574 : INFO : Training metrics:
2024-08-15 17:43:19,574 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:19,584 : INFO : Accuracy: 0.9137
2024-08-15 17:43:19,584 : INFO : Precision score for label_class 0: 0.8533
2024-08-15 17:43:19,584 : INFO : Precision score for label_class 1: 0.9440
2024-08-15 17:43:19,584 : INFO : Precision score for label_class 2: 0.8758
2024-08-15 17:43:19,584 : INFO : Recall score for label_class 0: 0.8636
2024-08-15 17:43:19,584 : INFO : Recall score for label_class 1: 0.9399
2024-08-15 17:43:19,584 : INFO : Recall score for label_class 2: 0.8793
2024-08-15 17:43:19,584 : INFO : Average F1 score: 0.8927
2024-08-15 17:43:20,054 : INFO : Average loss over validation batches: 0.4218
2024-08-15 17:43:20,054 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:20,054 : INFO : Validation metrics:
2024-08-15 17:43:20,054 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:20,057 : INFO : Accuracy: 0.8501
2024-08-15 17:43:20,058 : INFO : Precision score for label_class 0: 0.7765
2024-08-15 17:43:20,058 : INFO : Precision score for label_class 1: 0.8628
2024-08-15 17:43:20,058 : INFO : Precision score for label_class 2: 0.8553
2024-08-15 17:43:20,058 : INFO : Recall score for label_class 0: 0.7857
2024-08-15 17:43:20,058 : INFO : Recall score for label_class 1: 0.9369
2024-08-15 17:43:20,058 : INFO : Recall score for label_class 2: 0.7010
2024-08-15 17:43:20,058 : INFO : Average F1 score: 0.8166
2024-08-15 17:43:20,058 : INFO : Validation metric decreased (0.486815 --> 0.421833).  Saving model ...
2024-08-15 17:43:20,161 : INFO : Starting epoch 4
2024-08-15 17:43:20,419 : INFO : Current training batch loss: 0.2374 in epoch 4
2024-08-15 17:43:21,257 : INFO : Current training batch loss: 0.2094 in epoch 4
2024-08-15 17:43:22,139 : INFO : Current training batch loss: 0.2445 in epoch 4
2024-08-15 17:43:22,964 : INFO : Current training batch loss: 0.0527 in epoch 4
2024-08-15 17:43:23,738 : INFO : Epoch finished, average loss over training batches: 0.1536
2024-08-15 17:43:23,738 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:23,738 : INFO : Training metrics:
2024-08-15 17:43:23,738 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:23,745 : INFO : Accuracy: 0.9474
2024-08-15 17:43:23,745 : INFO : Precision score for label_class 0: 0.8866
2024-08-15 17:43:23,745 : INFO : Precision score for label_class 1: 0.9683
2024-08-15 17:43:23,745 : INFO : Precision score for label_class 2: 0.9303
2024-08-15 17:43:23,745 : INFO : Recall score for label_class 0: 0.9242
2024-08-15 17:43:23,745 : INFO : Recall score for label_class 1: 0.9647
2024-08-15 17:43:23,745 : INFO : Recall score for label_class 2: 0.9204
2024-08-15 17:43:23,745 : INFO : Average F1 score: 0.9323
2024-08-15 17:43:24,209 : INFO : Average loss over validation batches: 0.4825
2024-08-15 17:43:24,209 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:24,209 : INFO : Validation metrics:
2024-08-15 17:43:24,209 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:24,212 : INFO : Accuracy: 0.8398
2024-08-15 17:43:24,212 : INFO : Precision score for label_class 0: 0.7564
2024-08-15 17:43:24,212 : INFO : Precision score for label_class 1: 0.8588
2024-08-15 17:43:24,212 : INFO : Precision score for label_class 2: 0.8304
2024-08-15 17:43:24,212 : INFO : Recall score for label_class 0: 0.7024
2024-08-15 17:43:24,212 : INFO : Recall score for label_class 1: 0.9217
2024-08-15 17:43:24,212 : INFO : Recall score for label_class 2: 0.7320
2024-08-15 17:43:24,212 : INFO : Average F1 score: 0.7985
2024-08-15 17:43:24,212 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:43:24,212 : INFO : Starting epoch 5
2024-08-15 17:43:24,263 : INFO : Current training batch loss: 0.0320 in epoch 5
2024-08-15 17:43:25,100 : INFO : Current training batch loss: 0.1659 in epoch 5
2024-08-15 17:43:25,939 : INFO : Current training batch loss: 0.0229 in epoch 5
2024-08-15 17:43:26,778 : INFO : Current training batch loss: 0.0812 in epoch 5
2024-08-15 17:43:27,618 : INFO : Current training batch loss: 0.1097 in epoch 5
2024-08-15 17:43:27,776 : INFO : Epoch finished, average loss over training batches: 0.0864
2024-08-15 17:43:27,776 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:27,776 : INFO : Training metrics:
2024-08-15 17:43:27,776 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:27,783 : INFO : Accuracy: 0.9726
2024-08-15 17:43:27,783 : INFO : Precision score for label_class 0: 0.9258
2024-08-15 17:43:27,783 : INFO : Precision score for label_class 1: 0.9863
2024-08-15 17:43:27,783 : INFO : Precision score for label_class 2: 0.9641
2024-08-15 17:43:27,783 : INFO : Recall score for label_class 0: 0.9455
2024-08-15 17:43:27,783 : INFO : Recall score for label_class 1: 0.9827
2024-08-15 17:43:27,783 : INFO : Recall score for label_class 2: 0.9629
2024-08-15 17:43:27,783 : INFO : Average F1 score: 0.9612
2024-08-15 17:43:28,254 : INFO : Average loss over validation batches: 0.5387
2024-08-15 17:43:28,254 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:28,254 : INFO : Validation metrics:
2024-08-15 17:43:28,254 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:28,258 : INFO : Accuracy: 0.8427
2024-08-15 17:43:28,258 : INFO : Precision score for label_class 0: 0.7241
2024-08-15 17:43:28,258 : INFO : Precision score for label_class 1: 0.9041
2024-08-15 17:43:28,258 : INFO : Precision score for label_class 2: 0.7761
2024-08-15 17:43:28,258 : INFO : Recall score for label_class 0: 0.7500
2024-08-15 17:43:28,258 : INFO : Recall score for label_class 1: 0.8813
2024-08-15 17:43:28,258 : INFO : Recall score for label_class 2: 0.8041
2024-08-15 17:43:28,258 : INFO : Average F1 score: 0.8064
2024-08-15 17:43:28,258 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:43:28,258 : INFO : Starting epoch 6
2024-08-15 17:43:28,943 : INFO : Current training batch loss: 0.0293 in epoch 6
2024-08-15 17:43:29,787 : INFO : Current training batch loss: 0.0531 in epoch 6
2024-08-15 17:43:30,605 : INFO : Current training batch loss: 0.0109 in epoch 6
2024-08-15 17:43:31,423 : INFO : Current training batch loss: 0.1118 in epoch 6
2024-08-15 17:43:31,778 : INFO : Epoch finished, average loss over training batches: 0.0451
2024-08-15 17:43:31,778 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:31,778 : INFO : Training metrics:
2024-08-15 17:43:31,778 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:31,785 : INFO : Accuracy: 0.9893
2024-08-15 17:43:31,786 : INFO : Precision score for label_class 0: 0.9642
2024-08-15 17:43:31,786 : INFO : Precision score for label_class 1: 0.9944
2024-08-15 17:43:31,786 : INFO : Precision score for label_class 2: 0.9893
2024-08-15 17:43:31,786 : INFO : Recall score for label_class 0: 0.9788
2024-08-15 17:43:31,786 : INFO : Recall score for label_class 1: 0.9938
2024-08-15 17:43:31,786 : INFO : Recall score for label_class 2: 0.9841
2024-08-15 17:43:31,786 : INFO : Average F1 score: 0.9841
2024-08-15 17:43:32,250 : INFO : Average loss over validation batches: 0.5609
2024-08-15 17:43:32,250 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:32,250 : INFO : Validation metrics:
2024-08-15 17:43:32,250 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:32,254 : INFO : Accuracy: 0.8487
2024-08-15 17:43:32,254 : INFO : Precision score for label_class 0: 0.7701
2024-08-15 17:43:32,254 : INFO : Precision score for label_class 1: 0.9021
2024-08-15 17:43:32,254 : INFO : Precision score for label_class 2: 0.7789
2024-08-15 17:43:32,254 : INFO : Recall score for label_class 0: 0.7976
2024-08-15 17:43:32,254 : INFO : Recall score for label_class 1: 0.8838
2024-08-15 17:43:32,254 : INFO : Recall score for label_class 2: 0.7990
2024-08-15 17:43:32,254 : INFO : Average F1 score: 0.8218
2024-08-15 17:43:32,254 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:43:32,254 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:43:32,289 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:43:32,788 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:32,788 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:43:32,788 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:32,791 : INFO : Accuracy: 0.8501
2024-08-15 17:43:32,791 : INFO : Precision score for label_class 0: 0.7765
2024-08-15 17:43:32,791 : INFO : Precision score for label_class 1: 0.8628
2024-08-15 17:43:32,791 : INFO : Precision score for label_class 2: 0.8553
2024-08-15 17:43:32,791 : INFO : Recall score for label_class 0: 0.7857
2024-08-15 17:43:32,791 : INFO : Recall score for label_class 1: 0.9369
2024-08-15 17:43:32,791 : INFO : Recall score for label_class 2: 0.7010
2024-08-15 17:43:32,791 : INFO : Average F1 score: 0.8166
2024-08-15 17:43:32,791 : INFO : Determined score from best model, ending training.
2024-08-15 17:43:32,793 : INFO : Split 5 is finished, the score is: 0.8166
2024-08-15 17:43:32,793 : INFO : ----------------------------------------------------------------------------------------------------
[I 2024-08-15 17:43:32,802] Trial 20 finished with value: 0.8278358051643666 and parameters: {'n_epochs': 12, 'learning_rate': 9.057219104067053e-05, 'classifier_dropout': 0.753959440613879, 'warmup_step_fraction': 0.05924936946995301, 'use_gradient_clipping': False}. Best is trial 1 with value: 0.8513001269595835.
2024-08-15 17:43:32,811 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:32,811 : INFO : Starting training for split 1
2024-08-15 17:43:32,823 : INFO : Starting to tokenize the sequences.
2024-08-15 17:43:32,828 : INFO : Tokenization is finished.
2024-08-15 17:43:32,840 : INFO : Starting to tokenize the sequences.
2024-08-15 17:43:32,846 : INFO : Tokenization is finished.
2024-08-15 17:43:32,846 : INFO : Counting occurences of labels...
2024-08-15 17:43:32,847 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1596,  774]))
2024-08-15 17:43:32,847 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 415, 174]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:43:32,890 : INFO : Starting epoch 1
2024-08-15 17:43:32,942 : INFO : Current training batch loss: 1.0742 in epoch 1
2024-08-15 17:43:33,791 : INFO : Current training batch loss: 0.9872 in epoch 1
2024-08-15 17:43:34,625 : INFO : Current training batch loss: 0.9986 in epoch 1
2024-08-15 17:43:35,479 : INFO : Current training batch loss: 0.8255 in epoch 1
2024-08-15 17:43:36,295 : INFO : Current training batch loss: 0.8033 in epoch 1
2024-08-15 17:43:36,448 : INFO : Epoch finished, average loss over training batches: 0.9133
2024-08-15 17:43:36,448 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:36,448 : INFO : Training metrics:
2024-08-15 17:43:36,448 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:36,456 : INFO : Accuracy: 0.6431
2024-08-15 17:43:36,456 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:43:36,456 : INFO : Precision score for label_class 1: 0.6533
2024-08-15 17:43:36,456 : INFO : Precision score for label_class 2: 0.5615
2024-08-15 17:43:36,456 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:43:36,457 : INFO : Recall score for label_class 1: 0.9812
2024-08-15 17:43:36,457 : INFO : Recall score for label_class 2: 0.2183
2024-08-15 17:43:36,457 : INFO : Average F1 score: 0.3663
2024-08-15 17:43:36,929 : INFO : Average loss over validation batches: 0.7281
2024-08-15 17:43:36,929 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:36,929 : INFO : Validation metrics:
2024-08-15 17:43:36,929 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:36,932 : INFO : Accuracy: 0.7215
2024-08-15 17:43:36,932 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:43:36,932 : INFO : Precision score for label_class 1: 0.8174
2024-08-15 17:43:36,932 : INFO : Precision score for label_class 2: 0.5000
2024-08-15 17:43:36,932 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:43:36,932 : INFO : Recall score for label_class 1: 0.9277
2024-08-15 17:43:36,932 : INFO : Recall score for label_class 2: 0.5862
2024-08-15 17:43:36,932 : INFO : Average F1 score: 0.4696
2024-08-15 17:43:36,932 : INFO : Validation metric decreased (inf --> 0.728089).  Saving model ...
2024-08-15 17:43:37,043 : INFO : Starting epoch 2
2024-08-15 17:43:37,717 : INFO : Current training batch loss: 0.5196 in epoch 2
2024-08-15 17:43:38,571 : INFO : Current training batch loss: 0.6170 in epoch 2
2024-08-15 17:43:39,388 : INFO : Current training batch loss: 0.5476 in epoch 2
2024-08-15 17:43:40,205 : INFO : Current training batch loss: 0.4907 in epoch 2
2024-08-15 17:43:40,559 : INFO : Epoch finished, average loss over training batches: 0.5837
2024-08-15 17:43:40,559 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:40,559 : INFO : Training metrics:
2024-08-15 17:43:40,559 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:40,565 : INFO : Accuracy: 0.8080
2024-08-15 17:43:40,565 : INFO : Precision score for label_class 0: 0.8308
2024-08-15 17:43:40,565 : INFO : Precision score for label_class 1: 0.8560
2024-08-15 17:43:40,565 : INFO : Precision score for label_class 2: 0.7017
2024-08-15 17:43:40,565 : INFO : Recall score for label_class 0: 0.3293
2024-08-15 17:43:40,565 : INFO : Recall score for label_class 1: 0.9386
2024-08-15 17:43:40,565 : INFO : Recall score for label_class 2: 0.7416
2024-08-15 17:43:40,565 : INFO : Average F1 score: 0.6960
2024-08-15 17:43:41,032 : INFO : Average loss over validation batches: 0.4845
2024-08-15 17:43:41,032 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:41,032 : INFO : Validation metrics:
2024-08-15 17:43:41,032 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:41,035 : INFO : Accuracy: 0.8593
2024-08-15 17:43:41,035 : INFO : Precision score for label_class 0: 0.8400
2024-08-15 17:43:41,035 : INFO : Precision score for label_class 1: 0.8810
2024-08-15 17:43:41,035 : INFO : Precision score for label_class 2: 0.8098
2024-08-15 17:43:41,035 : INFO : Recall score for label_class 0: 0.7326
2024-08-15 17:43:41,035 : INFO : Recall score for label_class 1: 0.9277
2024-08-15 17:43:41,035 : INFO : Recall score for label_class 2: 0.7586
2024-08-15 17:43:41,035 : INFO : Average F1 score: 0.8232
2024-08-15 17:43:41,035 : INFO : Validation metric decreased (0.728089 --> 0.484465).  Saving model ...
2024-08-15 17:43:41,136 : INFO : Starting epoch 3
2024-08-15 17:43:41,590 : INFO : Current training batch loss: 0.4283 in epoch 3
2024-08-15 17:43:42,408 : INFO : Current training batch loss: 0.4726 in epoch 3
2024-08-15 17:43:43,225 : INFO : Current training batch loss: 0.3840 in epoch 3
2024-08-15 17:43:44,065 : INFO : Current training batch loss: 0.3326 in epoch 3
2024-08-15 17:43:44,629 : INFO : Epoch finished, average loss over training batches: 0.3912
2024-08-15 17:43:44,630 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:44,630 : INFO : Training metrics:
2024-08-15 17:43:44,630 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:44,638 : INFO : Accuracy: 0.8951
2024-08-15 17:43:44,638 : INFO : Precision score for label_class 0: 0.8121
2024-08-15 17:43:44,638 : INFO : Precision score for label_class 1: 0.9152
2024-08-15 17:43:44,638 : INFO : Precision score for label_class 2: 0.8849
2024-08-15 17:43:44,638 : INFO : Recall score for label_class 0: 0.7774
2024-08-15 17:43:44,638 : INFO : Recall score for label_class 1: 0.9536
2024-08-15 17:43:44,638 : INFO : Recall score for label_class 2: 0.8243
2024-08-15 17:43:44,638 : INFO : Average F1 score: 0.8606
2024-08-15 17:43:45,113 : INFO : Average loss over validation batches: 0.4036
2024-08-15 17:43:45,113 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:45,113 : INFO : Validation metrics:
2024-08-15 17:43:45,113 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:45,116 : INFO : Accuracy: 0.8711
2024-08-15 17:43:45,116 : INFO : Precision score for label_class 0: 0.7917
2024-08-15 17:43:45,116 : INFO : Precision score for label_class 1: 0.9221
2024-08-15 17:43:45,116 : INFO : Precision score for label_class 2: 0.8011
2024-08-15 17:43:45,116 : INFO : Recall score for label_class 0: 0.8837
2024-08-15 17:43:45,116 : INFO : Recall score for label_class 1: 0.8843
2024-08-15 17:43:45,116 : INFO : Recall score for label_class 2: 0.8333
2024-08-15 17:43:45,116 : INFO : Average F1 score: 0.8516
2024-08-15 17:43:45,116 : INFO : Validation metric decreased (0.484465 --> 0.403568).  Saving model ...
2024-08-15 17:43:45,214 : INFO : Starting epoch 4
2024-08-15 17:43:45,467 : INFO : Current training batch loss: 0.7245 in epoch 4
2024-08-15 17:43:46,300 : INFO : Current training batch loss: 0.2824 in epoch 4
2024-08-15 17:43:47,141 : INFO : Current training batch loss: 0.3907 in epoch 4
2024-08-15 17:43:47,974 : INFO : Current training batch loss: 0.2497 in epoch 4
2024-08-15 17:43:48,735 : INFO : Epoch finished, average loss over training batches: 0.2976
2024-08-15 17:43:48,735 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:48,735 : INFO : Training metrics:
2024-08-15 17:43:48,735 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:48,743 : INFO : Accuracy: 0.9288
2024-08-15 17:43:48,743 : INFO : Precision score for label_class 0: 0.8498
2024-08-15 17:43:48,743 : INFO : Precision score for label_class 1: 0.9417
2024-08-15 17:43:48,743 : INFO : Precision score for label_class 2: 0.9360
2024-08-15 17:43:48,743 : INFO : Recall score for label_class 0: 0.8628
2024-08-15 17:43:48,743 : INFO : Recall score for label_class 1: 0.9712
2024-08-15 17:43:48,743 : INFO : Recall score for label_class 2: 0.8695
2024-08-15 17:43:48,743 : INFO : Average F1 score: 0.9047
2024-08-15 17:43:49,233 : INFO : Average loss over validation batches: 0.4234
2024-08-15 17:43:49,234 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:49,234 : INFO : Validation metrics:
2024-08-15 17:43:49,234 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:49,236 : INFO : Accuracy: 0.8444
2024-08-15 17:43:49,236 : INFO : Precision score for label_class 0: 0.7429
2024-08-15 17:43:49,236 : INFO : Precision score for label_class 1: 0.9370
2024-08-15 17:43:49,237 : INFO : Precision score for label_class 2: 0.7317
2024-08-15 17:43:49,237 : INFO : Recall score for label_class 0: 0.9070
2024-08-15 17:43:49,237 : INFO : Recall score for label_class 1: 0.8241
2024-08-15 17:43:49,237 : INFO : Recall score for label_class 2: 0.8621
2024-08-15 17:43:49,237 : INFO : Average F1 score: 0.8284
2024-08-15 17:43:49,237 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:43:49,237 : INFO : Starting epoch 5
2024-08-15 17:43:49,287 : INFO : Current training batch loss: 0.2531 in epoch 5
2024-08-15 17:43:50,120 : INFO : Current training batch loss: 0.4280 in epoch 5
2024-08-15 17:43:51,042 : INFO : Current training batch loss: 0.2454 in epoch 5
2024-08-15 17:43:51,862 : INFO : Current training batch loss: 0.3003 in epoch 5
2024-08-15 17:43:52,697 : INFO : Current training batch loss: 0.3119 in epoch 5
2024-08-15 17:43:52,854 : INFO : Epoch finished, average loss over training batches: 0.2583
2024-08-15 17:43:52,854 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:52,854 : INFO : Training metrics:
2024-08-15 17:43:52,854 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:52,862 : INFO : Accuracy: 0.9426
2024-08-15 17:43:52,862 : INFO : Precision score for label_class 0: 0.8791
2024-08-15 17:43:52,862 : INFO : Precision score for label_class 1: 0.9567
2024-08-15 17:43:52,862 : INFO : Precision score for label_class 2: 0.9409
2024-08-15 17:43:52,862 : INFO : Recall score for label_class 0: 0.9085
2024-08-15 17:43:52,862 : INFO : Recall score for label_class 1: 0.9680
2024-08-15 17:43:52,862 : INFO : Recall score for label_class 2: 0.9044
2024-08-15 17:43:52,862 : INFO : Average F1 score: 0.9260
2024-08-15 17:43:53,330 : INFO : Average loss over validation batches: 0.3630
2024-08-15 17:43:53,330 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:53,330 : INFO : Validation metrics:
2024-08-15 17:43:53,330 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:53,333 : INFO : Accuracy: 0.8889
2024-08-15 17:43:53,333 : INFO : Precision score for label_class 0: 0.8085
2024-08-15 17:43:53,333 : INFO : Precision score for label_class 1: 0.9123
2024-08-15 17:43:53,333 : INFO : Precision score for label_class 2: 0.8742
2024-08-15 17:43:53,333 : INFO : Recall score for label_class 0: 0.8837
2024-08-15 17:43:53,333 : INFO : Recall score for label_class 1: 0.9277
2024-08-15 17:43:53,333 : INFO : Recall score for label_class 2: 0.7989
2024-08-15 17:43:53,333 : INFO : Average F1 score: 0.8664
2024-08-15 17:43:53,333 : INFO : Validation metric decreased (0.403568 --> 0.363039).  Saving model ...
2024-08-15 17:43:53,436 : INFO : Split 1 is finished, the score is: 0.8664
2024-08-15 17:43:53,436 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:53,436 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:53,436 : INFO : Starting training for split 2
2024-08-15 17:43:53,453 : INFO : Starting to tokenize the sequences.
2024-08-15 17:43:53,459 : INFO : Tokenization is finished.
2024-08-15 17:43:53,477 : INFO : Starting to tokenize the sequences.
2024-08-15 17:43:53,482 : INFO : Tokenization is finished.
2024-08-15 17:43:53,487 : INFO : Counting occurences of labels...
2024-08-15 17:43:53,488 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 343, 1601,  754]))
2024-08-15 17:43:53,488 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 71, 410, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:43:53,535 : INFO : Starting epoch 1
2024-08-15 17:43:53,587 : INFO : Current training batch loss: 1.0764 in epoch 1
2024-08-15 17:43:54,432 : INFO : Current training batch loss: 1.0378 in epoch 1
2024-08-15 17:43:55,283 : INFO : Current training batch loss: 1.0065 in epoch 1
2024-08-15 17:43:56,131 : INFO : Current training batch loss: 0.8348 in epoch 1
2024-08-15 17:43:56,970 : INFO : Current training batch loss: 0.8382 in epoch 1
2024-08-15 17:43:57,128 : INFO : Epoch finished, average loss over training batches: 0.9209
2024-08-15 17:43:57,128 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:57,128 : INFO : Training metrics:
2024-08-15 17:43:57,128 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:57,139 : INFO : Accuracy: 0.6327
2024-08-15 17:43:57,139 : INFO : Precision score for label_class 0: 0.2000
2024-08-15 17:43:57,139 : INFO : Precision score for label_class 1: 0.6456
2024-08-15 17:43:57,139 : INFO : Precision score for label_class 2: 0.5242
2024-08-15 17:43:57,139 : INFO : Recall score for label_class 0: 0.0029
2024-08-15 17:43:57,139 : INFO : Recall score for label_class 1: 0.9775
2024-08-15 17:43:57,139 : INFO : Recall score for label_class 2: 0.1870
2024-08-15 17:43:57,139 : INFO : Average F1 score: 0.3530
2024-08-15 17:43:57,606 : INFO : Average loss over validation batches: 0.7357
2024-08-15 17:43:57,607 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:57,607 : INFO : Validation metrics:
2024-08-15 17:43:57,607 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:43:57,611 : INFO : Accuracy: 0.7230
2024-08-15 17:43:57,611 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:43:57,611 : INFO : Precision score for label_class 1: 0.7826
2024-08-15 17:43:57,611 : INFO : Precision score for label_class 2: 0.5729
2024-08-15 17:43:57,611 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:43:57,611 : INFO : Recall score for label_class 1: 0.9220
2024-08-15 17:43:57,611 : INFO : Recall score for label_class 2: 0.5670
2024-08-15 17:43:57,611 : INFO : Average F1 score: 0.4722
2024-08-15 17:43:57,611 : INFO : Validation metric decreased (inf --> 0.735687).  Saving model ...
2024-08-15 17:43:57,711 : INFO : Starting epoch 2
2024-08-15 17:43:58,400 : INFO : Current training batch loss: 0.6890 in epoch 2
2024-08-15 17:43:59,235 : INFO : Current training batch loss: 0.6289 in epoch 2
2024-08-15 17:44:00,065 : INFO : Current training batch loss: 0.5607 in epoch 2
2024-08-15 17:44:00,882 : INFO : Current training batch loss: 0.5052 in epoch 2
2024-08-15 17:44:01,246 : INFO : Epoch finished, average loss over training batches: 0.6143
2024-08-15 17:44:01,246 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:01,246 : INFO : Training metrics:
2024-08-15 17:44:01,246 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:01,257 : INFO : Accuracy: 0.7832
2024-08-15 17:44:01,257 : INFO : Precision score for label_class 0: 0.7787
2024-08-15 17:44:01,257 : INFO : Precision score for label_class 1: 0.8388
2024-08-15 17:44:01,257 : INFO : Precision score for label_class 2: 0.6537
2024-08-15 17:44:01,257 : INFO : Recall score for label_class 0: 0.2770
2024-08-15 17:44:01,257 : INFO : Recall score for label_class 1: 0.9457
2024-08-15 17:44:01,257 : INFO : Recall score for label_class 2: 0.6684
2024-08-15 17:44:01,257 : INFO : Average F1 score: 0.6529
2024-08-15 17:44:01,722 : INFO : Average loss over validation batches: 0.5039
2024-08-15 17:44:01,722 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:01,722 : INFO : Validation metrics:
2024-08-15 17:44:01,722 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:01,726 : INFO : Accuracy: 0.8504
2024-08-15 17:44:01,726 : INFO : Precision score for label_class 0: 0.8000
2024-08-15 17:44:01,726 : INFO : Precision score for label_class 1: 0.8452
2024-08-15 17:44:01,726 : INFO : Precision score for label_class 2: 0.8839
2024-08-15 17:44:01,726 : INFO : Recall score for label_class 0: 0.6197
2024-08-15 17:44:01,726 : INFO : Recall score for label_class 1: 0.9585
2024-08-15 17:44:01,726 : INFO : Recall score for label_class 2: 0.7062
2024-08-15 17:44:01,726 : INFO : Average F1 score: 0.7939
2024-08-15 17:44:01,726 : INFO : Validation metric decreased (0.735687 --> 0.503857).  Saving model ...
2024-08-15 17:44:01,822 : INFO : Starting epoch 3
2024-08-15 17:44:02,289 : INFO : Current training batch loss: 0.4164 in epoch 3
2024-08-15 17:44:03,127 : INFO : Current training batch loss: 0.4689 in epoch 3
2024-08-15 17:44:03,965 : INFO : Current training batch loss: 0.4390 in epoch 3
2024-08-15 17:44:04,809 : INFO : Current training batch loss: 0.2964 in epoch 3
2024-08-15 17:44:05,404 : INFO : Epoch finished, average loss over training batches: 0.4060
2024-08-15 17:44:05,405 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:05,405 : INFO : Training metrics:
2024-08-15 17:44:05,405 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:05,415 : INFO : Accuracy: 0.8873
2024-08-15 17:44:05,415 : INFO : Precision score for label_class 0: 0.7952
2024-08-15 17:44:05,415 : INFO : Precision score for label_class 1: 0.9162
2024-08-15 17:44:05,415 : INFO : Precision score for label_class 2: 0.8628
2024-08-15 17:44:05,415 : INFO : Recall score for label_class 0: 0.7697
2024-08-15 17:44:05,415 : INFO : Recall score for label_class 1: 0.9494
2024-08-15 17:44:05,415 : INFO : Recall score for label_class 2: 0.8090
2024-08-15 17:44:05,415 : INFO : Average F1 score: 0.8499
2024-08-15 17:44:05,904 : INFO : Average loss over validation batches: 0.4170
2024-08-15 17:44:05,905 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:05,905 : INFO : Validation metrics:
2024-08-15 17:44:05,905 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:05,908 : INFO : Accuracy: 0.8667
2024-08-15 17:44:05,908 : INFO : Precision score for label_class 0: 0.7826
2024-08-15 17:44:05,908 : INFO : Precision score for label_class 1: 0.8819
2024-08-15 17:44:05,908 : INFO : Precision score for label_class 2: 0.8621
2024-08-15 17:44:05,908 : INFO : Recall score for label_class 0: 0.7606
2024-08-15 17:44:05,908 : INFO : Recall score for label_class 1: 0.9293
2024-08-15 17:44:05,908 : INFO : Recall score for label_class 2: 0.7732
2024-08-15 17:44:05,908 : INFO : Average F1 score: 0.8305
2024-08-15 17:44:05,908 : INFO : Validation metric decreased (0.503857 --> 0.417037).  Saving model ...
2024-08-15 17:44:06,011 : INFO : Starting epoch 4
2024-08-15 17:44:06,270 : INFO : Current training batch loss: 0.4915 in epoch 4
2024-08-15 17:44:07,117 : INFO : Current training batch loss: 0.3030 in epoch 4
2024-08-15 17:44:07,961 : INFO : Current training batch loss: 0.4099 in epoch 4
2024-08-15 17:44:08,797 : INFO : Current training batch loss: 0.2665 in epoch 4
2024-08-15 17:44:09,555 : INFO : Epoch finished, average loss over training batches: 0.3028
2024-08-15 17:44:09,555 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:09,555 : INFO : Training metrics:
2024-08-15 17:44:09,555 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:09,565 : INFO : Accuracy: 0.9266
2024-08-15 17:44:09,565 : INFO : Precision score for label_class 0: 0.8513
2024-08-15 17:44:09,565 : INFO : Precision score for label_class 1: 0.9439
2024-08-15 17:44:09,565 : INFO : Precision score for label_class 2: 0.9230
2024-08-15 17:44:09,565 : INFO : Recall score for label_class 0: 0.8513
2024-08-15 17:44:09,565 : INFO : Recall score for label_class 1: 0.9675
2024-08-15 17:44:09,565 : INFO : Recall score for label_class 2: 0.8740
2024-08-15 17:44:09,565 : INFO : Average F1 score: 0.9016
2024-08-15 17:44:10,033 : INFO : Average loss over validation batches: 0.3994
2024-08-15 17:44:10,033 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:10,033 : INFO : Validation metrics:
2024-08-15 17:44:10,033 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:10,036 : INFO : Accuracy: 0.8667
2024-08-15 17:44:10,036 : INFO : Precision score for label_class 0: 0.7317
2024-08-15 17:44:10,036 : INFO : Precision score for label_class 1: 0.9127
2024-08-15 17:44:10,036 : INFO : Precision score for label_class 2: 0.8281
2024-08-15 17:44:10,036 : INFO : Recall score for label_class 0: 0.8451
2024-08-15 17:44:10,036 : INFO : Recall score for label_class 1: 0.8927
2024-08-15 17:44:10,036 : INFO : Recall score for label_class 2: 0.8196
2024-08-15 17:44:10,036 : INFO : Average F1 score: 0.8369
2024-08-15 17:44:10,037 : INFO : Validation metric decreased (0.417037 --> 0.399386).  Saving model ...
2024-08-15 17:44:10,139 : INFO : Starting epoch 5
2024-08-15 17:44:10,190 : INFO : Current training batch loss: 0.2469 in epoch 5
2024-08-15 17:44:11,004 : INFO : Current training batch loss: 0.4186 in epoch 5
2024-08-15 17:44:11,826 : INFO : Current training batch loss: 0.2577 in epoch 5
2024-08-15 17:44:12,640 : INFO : Current training batch loss: 0.2474 in epoch 5
2024-08-15 17:44:13,465 : INFO : Current training batch loss: 0.3210 in epoch 5
2024-08-15 17:44:13,607 : INFO : Epoch finished, average loss over training batches: 0.2554
2024-08-15 17:44:13,607 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:13,608 : INFO : Training metrics:
2024-08-15 17:44:13,608 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:13,617 : INFO : Accuracy: 0.9444
2024-08-15 17:44:13,617 : INFO : Precision score for label_class 0: 0.8873
2024-08-15 17:44:13,617 : INFO : Precision score for label_class 1: 0.9615
2024-08-15 17:44:13,617 : INFO : Precision score for label_class 2: 0.9338
2024-08-15 17:44:13,617 : INFO : Recall score for label_class 0: 0.8950
2024-08-15 17:44:13,617 : INFO : Recall score for label_class 1: 0.9681
2024-08-15 17:44:13,617 : INFO : Recall score for label_class 2: 0.9164
2024-08-15 17:44:13,617 : INFO : Average F1 score: 0.9270
2024-08-15 17:44:14,085 : INFO : Average loss over validation batches: 0.3824
2024-08-15 17:44:14,085 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:14,085 : INFO : Validation metrics:
2024-08-15 17:44:14,085 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:14,088 : INFO : Accuracy: 0.8741
2024-08-15 17:44:14,088 : INFO : Precision score for label_class 0: 0.7887
2024-08-15 17:44:14,088 : INFO : Precision score for label_class 1: 0.8813
2024-08-15 17:44:14,088 : INFO : Precision score for label_class 2: 0.8916
2024-08-15 17:44:14,088 : INFO : Recall score for label_class 0: 0.7887
2024-08-15 17:44:14,088 : INFO : Recall score for label_class 1: 0.9415
2024-08-15 17:44:14,088 : INFO : Recall score for label_class 2: 0.7629
2024-08-15 17:44:14,088 : INFO : Average F1 score: 0.8404
2024-08-15 17:44:14,088 : INFO : Validation metric decreased (0.399386 --> 0.382359).  Saving model ...
2024-08-15 17:44:14,192 : INFO : Split 2 is finished, the score is: 0.8404
2024-08-15 17:44:14,192 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:14,193 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:14,193 : INFO : Starting training for split 3
2024-08-15 17:44:14,207 : INFO : Starting to tokenize the sequences.
2024-08-15 17:44:14,213 : INFO : Tokenization is finished.
2024-08-15 17:44:14,235 : INFO : Starting to tokenize the sequences.
2024-08-15 17:44:14,240 : INFO : Tokenization is finished.
2024-08-15 17:44:14,245 : INFO : Counting occurences of labels...
2024-08-15 17:44:14,246 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1611,  759]))
2024-08-15 17:44:14,246 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 400, 189]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:44:14,294 : INFO : Starting epoch 1
2024-08-15 17:44:14,345 : INFO : Current training batch loss: 1.1168 in epoch 1
2024-08-15 17:44:15,154 : INFO : Current training batch loss: 1.0698 in epoch 1
2024-08-15 17:44:15,963 : INFO : Current training batch loss: 0.9369 in epoch 1
2024-08-15 17:44:16,772 : INFO : Current training batch loss: 0.8965 in epoch 1
2024-08-15 17:44:17,582 : INFO : Current training batch loss: 0.8471 in epoch 1
2024-08-15 17:44:17,724 : INFO : Epoch finished, average loss over training batches: 0.9538
2024-08-15 17:44:17,724 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:17,724 : INFO : Training metrics:
2024-08-15 17:44:17,724 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:17,733 : INFO : Accuracy: 0.5478
2024-08-15 17:44:17,733 : INFO : Precision score for label_class 0: 0.1328
2024-08-15 17:44:17,733 : INFO : Precision score for label_class 1: 0.6254
2024-08-15 17:44:17,733 : INFO : Precision score for label_class 2: 0.3868
2024-08-15 17:44:17,733 : INFO : Recall score for label_class 0: 0.1098
2024-08-15 17:44:17,733 : INFO : Recall score for label_class 1: 0.8187
2024-08-15 17:44:17,733 : INFO : Recall score for label_class 2: 0.1621
2024-08-15 17:44:17,733 : INFO : Average F1 score: 0.3526
2024-08-15 17:44:18,196 : INFO : Average loss over validation batches: 0.7860
2024-08-15 17:44:18,197 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:18,197 : INFO : Validation metrics:
2024-08-15 17:44:18,197 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:18,199 : INFO : Accuracy: 0.6800
2024-08-15 17:44:18,199 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:44:18,200 : INFO : Precision score for label_class 1: 0.7317
2024-08-15 17:44:18,200 : INFO : Precision score for label_class 2: 0.5096
2024-08-15 17:44:18,200 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:44:18,200 : INFO : Recall score for label_class 1: 0.9475
2024-08-15 17:44:18,200 : INFO : Recall score for label_class 2: 0.4233
2024-08-15 17:44:18,200 : INFO : Average F1 score: 0.4294
2024-08-15 17:44:18,200 : INFO : Validation metric decreased (inf --> 0.785978).  Saving model ...
2024-08-15 17:44:18,302 : INFO : Starting epoch 2
2024-08-15 17:44:18,951 : INFO : Current training batch loss: 0.7289 in epoch 2
2024-08-15 17:44:19,760 : INFO : Current training batch loss: 0.6633 in epoch 2
2024-08-15 17:44:20,569 : INFO : Current training batch loss: 0.6203 in epoch 2
2024-08-15 17:44:21,378 : INFO : Current training batch loss: 0.5522 in epoch 2
2024-08-15 17:44:21,721 : INFO : Epoch finished, average loss over training batches: 0.6577
2024-08-15 17:44:21,721 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:21,721 : INFO : Training metrics:
2024-08-15 17:44:21,721 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:21,730 : INFO : Accuracy: 0.7457
2024-08-15 17:44:21,730 : INFO : Precision score for label_class 0: 0.5000
2024-08-15 17:44:21,730 : INFO : Precision score for label_class 1: 0.8105
2024-08-15 17:44:21,730 : INFO : Precision score for label_class 2: 0.5942
2024-08-15 17:44:21,730 : INFO : Recall score for label_class 0: 0.0122
2024-08-15 17:44:21,730 : INFO : Recall score for label_class 1: 0.9528
2024-08-15 17:44:21,730 : INFO : Recall score for label_class 2: 0.6232
2024-08-15 17:44:21,730 : INFO : Average F1 score: 0.5027
2024-08-15 17:44:22,195 : INFO : Average loss over validation batches: 0.5648
2024-08-15 17:44:22,195 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:22,195 : INFO : Validation metrics:
2024-08-15 17:44:22,195 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:22,199 : INFO : Accuracy: 0.7911
2024-08-15 17:44:22,199 : INFO : Precision score for label_class 0: 0.9167
2024-08-15 17:44:22,199 : INFO : Precision score for label_class 1: 0.8597
2024-08-15 17:44:22,199 : INFO : Precision score for label_class 2: 0.6471
2024-08-15 17:44:22,199 : INFO : Recall score for label_class 0: 0.1279
2024-08-15 17:44:22,199 : INFO : Recall score for label_class 1: 0.9500
2024-08-15 17:44:22,199 : INFO : Recall score for label_class 2: 0.7566
2024-08-15 17:44:22,199 : INFO : Average F1 score: 0.6082
2024-08-15 17:44:22,199 : INFO : Validation metric decreased (0.785978 --> 0.564790).  Saving model ...
2024-08-15 17:44:22,300 : INFO : Starting epoch 3
2024-08-15 17:44:22,750 : INFO : Current training batch loss: 0.5054 in epoch 3
2024-08-15 17:44:23,559 : INFO : Current training batch loss: 0.4573 in epoch 3
2024-08-15 17:44:24,369 : INFO : Current training batch loss: 0.4312 in epoch 3
2024-08-15 17:44:25,179 : INFO : Current training batch loss: 0.3194 in epoch 3
2024-08-15 17:44:25,721 : INFO : Epoch finished, average loss over training batches: 0.4637
2024-08-15 17:44:25,721 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:25,721 : INFO : Training metrics:
2024-08-15 17:44:25,721 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:25,727 : INFO : Accuracy: 0.8632
2024-08-15 17:44:25,727 : INFO : Precision score for label_class 0: 0.8178
2024-08-15 17:44:25,727 : INFO : Precision score for label_class 1: 0.8923
2024-08-15 17:44:25,727 : INFO : Precision score for label_class 2: 0.8104
2024-08-15 17:44:25,727 : INFO : Recall score for label_class 0: 0.6159
2024-08-15 17:44:25,727 : INFO : Recall score for label_class 1: 0.9516
2024-08-15 17:44:25,728 : INFO : Recall score for label_class 2: 0.7826
2024-08-15 17:44:25,728 : INFO : Average F1 score: 0.8066
2024-08-15 17:44:26,191 : INFO : Average loss over validation batches: 0.4374
2024-08-15 17:44:26,191 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:26,191 : INFO : Validation metrics:
2024-08-15 17:44:26,191 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:26,194 : INFO : Accuracy: 0.8681
2024-08-15 17:44:26,194 : INFO : Precision score for label_class 0: 0.8214
2024-08-15 17:44:26,194 : INFO : Precision score for label_class 1: 0.9186
2024-08-15 17:44:26,194 : INFO : Precision score for label_class 2: 0.7879
2024-08-15 17:44:26,194 : INFO : Recall score for label_class 0: 0.8023
2024-08-15 17:44:26,194 : INFO : Recall score for label_class 1: 0.9025
2024-08-15 17:44:26,194 : INFO : Recall score for label_class 2: 0.8254
2024-08-15 17:44:26,194 : INFO : Average F1 score: 0.8428
2024-08-15 17:44:26,194 : INFO : Validation metric decreased (0.564790 --> 0.437420).  Saving model ...
2024-08-15 17:44:26,295 : INFO : Starting epoch 4
2024-08-15 17:44:26,545 : INFO : Current training batch loss: 0.5190 in epoch 4
2024-08-15 17:44:27,354 : INFO : Current training batch loss: 0.4861 in epoch 4
2024-08-15 17:44:28,164 : INFO : Current training batch loss: 0.4079 in epoch 4
2024-08-15 17:44:28,979 : INFO : Current training batch loss: 0.2407 in epoch 4
2024-08-15 17:44:29,732 : INFO : Epoch finished, average loss over training batches: 0.3469
2024-08-15 17:44:29,733 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:29,733 : INFO : Training metrics:
2024-08-15 17:44:29,733 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:29,737 : INFO : Accuracy: 0.9066
2024-08-15 17:44:29,737 : INFO : Precision score for label_class 0: 0.8072
2024-08-15 17:44:29,737 : INFO : Precision score for label_class 1: 0.9295
2024-08-15 17:44:29,737 : INFO : Precision score for label_class 2: 0.8996
2024-08-15 17:44:29,737 : INFO : Recall score for label_class 0: 0.8171
2024-08-15 17:44:29,737 : INFO : Recall score for label_class 1: 0.9572
2024-08-15 17:44:29,737 : INFO : Recall score for label_class 2: 0.8379
2024-08-15 17:44:29,737 : INFO : Average F1 score: 0.8743
2024-08-15 17:44:30,201 : INFO : Average loss over validation batches: 0.4075
2024-08-15 17:44:30,201 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:30,201 : INFO : Validation metrics:
2024-08-15 17:44:30,201 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:30,204 : INFO : Accuracy: 0.8607
2024-08-15 17:44:30,204 : INFO : Precision score for label_class 0: 0.8068
2024-08-15 17:44:30,204 : INFO : Precision score for label_class 1: 0.9288
2024-08-15 17:44:30,204 : INFO : Precision score for label_class 2: 0.7596
2024-08-15 17:44:30,204 : INFO : Recall score for label_class 0: 0.8256
2024-08-15 17:44:30,204 : INFO : Recall score for label_class 1: 0.8800
2024-08-15 17:44:30,204 : INFO : Recall score for label_class 2: 0.8360
2024-08-15 17:44:30,204 : INFO : Average F1 score: 0.8386
2024-08-15 17:44:30,204 : INFO : Validation metric decreased (0.437420 --> 0.407496).  Saving model ...
2024-08-15 17:44:30,303 : INFO : Starting epoch 5
2024-08-15 17:44:30,355 : INFO : Current training batch loss: 0.3304 in epoch 5
2024-08-15 17:44:31,170 : INFO : Current training batch loss: 0.4351 in epoch 5
2024-08-15 17:44:31,985 : INFO : Current training batch loss: 0.2338 in epoch 5
2024-08-15 17:44:32,800 : INFO : Current training batch loss: 0.3027 in epoch 5
2024-08-15 17:44:33,616 : INFO : Current training batch loss: 0.3261 in epoch 5
2024-08-15 17:44:33,759 : INFO : Epoch finished, average loss over training batches: 0.2892
2024-08-15 17:44:33,759 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:33,759 : INFO : Training metrics:
2024-08-15 17:44:33,759 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:33,768 : INFO : Accuracy: 0.9288
2024-08-15 17:44:33,768 : INFO : Precision score for label_class 0: 0.8466
2024-08-15 17:44:33,768 : INFO : Precision score for label_class 1: 0.9488
2024-08-15 17:44:33,768 : INFO : Precision score for label_class 2: 0.9208
2024-08-15 17:44:33,768 : INFO : Recall score for label_class 0: 0.8415
2024-08-15 17:44:33,768 : INFO : Recall score for label_class 1: 0.9659
2024-08-15 17:44:33,768 : INFO : Recall score for label_class 2: 0.8880
2024-08-15 17:44:33,768 : INFO : Average F1 score: 0.9018
2024-08-15 17:44:34,233 : INFO : Average loss over validation batches: 0.3777
2024-08-15 17:44:34,233 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:34,233 : INFO : Validation metrics:
2024-08-15 17:44:34,234 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:34,236 : INFO : Accuracy: 0.8800
2024-08-15 17:44:34,236 : INFO : Precision score for label_class 0: 0.8276
2024-08-15 17:44:34,236 : INFO : Precision score for label_class 1: 0.9056
2024-08-15 17:44:34,236 : INFO : Precision score for label_class 2: 0.8457
2024-08-15 17:44:34,236 : INFO : Recall score for label_class 0: 0.8372
2024-08-15 17:44:34,236 : INFO : Recall score for label_class 1: 0.9350
2024-08-15 17:44:34,236 : INFO : Recall score for label_class 2: 0.7831
2024-08-15 17:44:34,236 : INFO : Average F1 score: 0.8552
2024-08-15 17:44:34,236 : INFO : Validation metric decreased (0.407496 --> 0.377710).  Saving model ...
2024-08-15 17:44:34,340 : INFO : Split 3 is finished, the score is: 0.8552
2024-08-15 17:44:34,340 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:34,340 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:34,340 : INFO : Starting training for split 4
2024-08-15 17:44:34,359 : INFO : Starting to tokenize the sequences.
2024-08-15 17:44:34,369 : INFO : Tokenization is finished.
2024-08-15 17:44:34,388 : INFO : Starting to tokenize the sequences.
2024-08-15 17:44:34,393 : INFO : Tokenization is finished.
2024-08-15 17:44:34,403 : INFO : Counting occurences of labels...
2024-08-15 17:44:34,404 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 327, 1621,  751]))
2024-08-15 17:44:34,404 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 87, 390, 197]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:44:34,512 : INFO : Starting epoch 1
2024-08-15 17:44:34,563 : INFO : Current training batch loss: 1.1156 in epoch 1
2024-08-15 17:44:35,378 : INFO : Current training batch loss: 1.0654 in epoch 1
2024-08-15 17:44:36,193 : INFO : Current training batch loss: 0.9423 in epoch 1
2024-08-15 17:44:37,007 : INFO : Current training batch loss: 0.8700 in epoch 1
2024-08-15 17:44:37,822 : INFO : Current training batch loss: 0.8230 in epoch 1
2024-08-15 17:44:37,972 : INFO : Epoch finished, average loss over training batches: 0.9421
2024-08-15 17:44:37,973 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:37,973 : INFO : Training metrics:
2024-08-15 17:44:37,973 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:37,980 : INFO : Accuracy: 0.5791
2024-08-15 17:44:37,980 : INFO : Precision score for label_class 0: 0.1089
2024-08-15 17:44:37,980 : INFO : Precision score for label_class 1: 0.6508
2024-08-15 17:44:37,980 : INFO : Precision score for label_class 2: 0.3902
2024-08-15 17:44:37,980 : INFO : Recall score for label_class 0: 0.0336
2024-08-15 17:44:37,980 : INFO : Recall score for label_class 1: 0.8291
2024-08-15 17:44:37,980 : INFO : Recall score for label_class 2: 0.2770
2024-08-15 17:44:37,980 : INFO : Average F1 score: 0.3682
2024-08-15 17:44:38,446 : INFO : Average loss over validation batches: 0.7605
2024-08-15 17:44:38,446 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:38,446 : INFO : Validation metrics:
2024-08-15 17:44:38,446 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:38,449 : INFO : Accuracy: 0.7181
2024-08-15 17:44:38,449 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:44:38,449 : INFO : Precision score for label_class 1: 0.7939
2024-08-15 17:44:38,449 : INFO : Precision score for label_class 2: 0.5596
2024-08-15 17:44:38,449 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:44:38,449 : INFO : Recall score for label_class 1: 0.9282
2024-08-15 17:44:38,449 : INFO : Recall score for label_class 2: 0.6193
2024-08-15 17:44:38,449 : INFO : Average F1 score: 0.4812
2024-08-15 17:44:38,449 : INFO : Validation metric decreased (inf --> 0.760518).  Saving model ...
2024-08-15 17:44:38,561 : INFO : Starting epoch 2
2024-08-15 17:44:39,214 : INFO : Current training batch loss: 0.7105 in epoch 2
2024-08-15 17:44:40,028 : INFO : Current training batch loss: 0.6288 in epoch 2
2024-08-15 17:44:40,842 : INFO : Current training batch loss: 0.5230 in epoch 2
2024-08-15 17:44:41,657 : INFO : Current training batch loss: 0.5116 in epoch 2
2024-08-15 17:44:42,008 : INFO : Epoch finished, average loss over training batches: 0.6220
2024-08-15 17:44:42,009 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:42,009 : INFO : Training metrics:
2024-08-15 17:44:42,009 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:42,013 : INFO : Accuracy: 0.7818
2024-08-15 17:44:42,013 : INFO : Precision score for label_class 0: 0.8218
2024-08-15 17:44:42,013 : INFO : Precision score for label_class 1: 0.8376
2024-08-15 17:44:42,013 : INFO : Precision score for label_class 2: 0.6485
2024-08-15 17:44:42,013 : INFO : Recall score for label_class 0: 0.2538
2024-08-15 17:44:42,013 : INFO : Recall score for label_class 1: 0.9352
2024-08-15 17:44:42,013 : INFO : Recall score for label_class 2: 0.6804
2024-08-15 17:44:42,013 : INFO : Average F1 score: 0.6452
2024-08-15 17:44:42,476 : INFO : Average loss over validation batches: 0.5202
2024-08-15 17:44:42,476 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:42,476 : INFO : Validation metrics:
2024-08-15 17:44:42,476 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:42,480 : INFO : Accuracy: 0.8338
2024-08-15 17:44:42,480 : INFO : Precision score for label_class 0: 0.7536
2024-08-15 17:44:42,480 : INFO : Precision score for label_class 1: 0.8649
2024-08-15 17:44:42,480 : INFO : Precision score for label_class 2: 0.7923
2024-08-15 17:44:42,480 : INFO : Recall score for label_class 0: 0.5977
2024-08-15 17:44:42,480 : INFO : Recall score for label_class 1: 0.9359
2024-08-15 17:44:42,480 : INFO : Recall score for label_class 2: 0.7360
2024-08-15 17:44:42,480 : INFO : Average F1 score: 0.7763
2024-08-15 17:44:42,480 : INFO : Validation metric decreased (0.760518 --> 0.520196).  Saving model ...
2024-08-15 17:44:42,583 : INFO : Starting epoch 3
2024-08-15 17:44:43,036 : INFO : Current training batch loss: 0.4206 in epoch 3
2024-08-15 17:44:43,853 : INFO : Current training batch loss: 0.4220 in epoch 3
2024-08-15 17:44:44,670 : INFO : Current training batch loss: 0.4415 in epoch 3
2024-08-15 17:44:45,505 : INFO : Current training batch loss: 0.3078 in epoch 3
2024-08-15 17:44:46,081 : INFO : Epoch finished, average loss over training batches: 0.4181
2024-08-15 17:44:46,082 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:46,082 : INFO : Training metrics:
2024-08-15 17:44:46,082 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:46,085 : INFO : Accuracy: 0.8859
2024-08-15 17:44:46,085 : INFO : Precision score for label_class 0: 0.8113
2024-08-15 17:44:46,085 : INFO : Precision score for label_class 1: 0.9093
2024-08-15 17:44:46,085 : INFO : Precision score for label_class 2: 0.8622
2024-08-15 17:44:46,086 : INFO : Recall score for label_class 0: 0.7492
2024-08-15 17:44:46,086 : INFO : Recall score for label_class 1: 0.9457
2024-08-15 17:44:46,086 : INFO : Recall score for label_class 2: 0.8162
2024-08-15 17:44:46,086 : INFO : Average F1 score: 0.8482
2024-08-15 17:44:46,552 : INFO : Average loss over validation batches: 0.4255
2024-08-15 17:44:46,553 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:46,553 : INFO : Validation metrics:
2024-08-15 17:44:46,553 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:46,556 : INFO : Accuracy: 0.8620
2024-08-15 17:44:46,556 : INFO : Precision score for label_class 0: 0.7312
2024-08-15 17:44:46,556 : INFO : Precision score for label_class 1: 0.9018
2024-08-15 17:44:46,556 : INFO : Precision score for label_class 2: 0.8424
2024-08-15 17:44:46,556 : INFO : Recall score for label_class 0: 0.7816
2024-08-15 17:44:46,556 : INFO : Recall score for label_class 1: 0.9179
2024-08-15 17:44:46,556 : INFO : Recall score for label_class 2: 0.7868
2024-08-15 17:44:46,556 : INFO : Average F1 score: 0.8263
2024-08-15 17:44:46,556 : INFO : Validation metric decreased (0.520196 --> 0.425513).  Saving model ...
2024-08-15 17:44:46,658 : INFO : Starting epoch 4
2024-08-15 17:44:46,917 : INFO : Current training batch loss: 0.4944 in epoch 4
2024-08-15 17:44:47,743 : INFO : Current training batch loss: 0.4022 in epoch 4
2024-08-15 17:44:48,564 : INFO : Current training batch loss: 0.2995 in epoch 4
2024-08-15 17:44:49,400 : INFO : Current training batch loss: 0.2311 in epoch 4
2024-08-15 17:44:50,162 : INFO : Epoch finished, average loss over training batches: 0.3091
2024-08-15 17:44:50,162 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:50,162 : INFO : Training metrics:
2024-08-15 17:44:50,162 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:50,169 : INFO : Accuracy: 0.9233
2024-08-15 17:44:50,169 : INFO : Precision score for label_class 0: 0.8464
2024-08-15 17:44:50,169 : INFO : Precision score for label_class 1: 0.9447
2024-08-15 17:44:50,169 : INFO : Precision score for label_class 2: 0.9100
2024-08-15 17:44:50,169 : INFO : Recall score for label_class 0: 0.8593
2024-08-15 17:44:50,169 : INFO : Recall score for label_class 1: 0.9587
2024-08-15 17:44:50,169 : INFO : Recall score for label_class 2: 0.8748
2024-08-15 17:44:50,169 : INFO : Average F1 score: 0.8988
2024-08-15 17:44:50,637 : INFO : Average loss over validation batches: 0.4129
2024-08-15 17:44:50,637 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:50,637 : INFO : Validation metrics:
2024-08-15 17:44:50,638 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:50,641 : INFO : Accuracy: 0.8576
2024-08-15 17:44:50,641 : INFO : Precision score for label_class 0: 0.7273
2024-08-15 17:44:50,641 : INFO : Precision score for label_class 1: 0.9182
2024-08-15 17:44:50,641 : INFO : Precision score for label_class 2: 0.8061
2024-08-15 17:44:50,641 : INFO : Recall score for label_class 0: 0.8276
2024-08-15 17:44:50,641 : INFO : Recall score for label_class 1: 0.8923
2024-08-15 17:44:50,641 : INFO : Recall score for label_class 2: 0.8020
2024-08-15 17:44:50,641 : INFO : Average F1 score: 0.8278
2024-08-15 17:44:50,641 : INFO : Validation metric decreased (0.425513 --> 0.412925).  Saving model ...
2024-08-15 17:44:50,747 : INFO : Starting epoch 5
2024-08-15 17:44:50,798 : INFO : Current training batch loss: 0.2378 in epoch 5
2024-08-15 17:44:51,637 : INFO : Current training batch loss: 0.4324 in epoch 5
2024-08-15 17:44:52,535 : INFO : Current training batch loss: 0.1773 in epoch 5
2024-08-15 17:44:53,370 : INFO : Current training batch loss: 0.2755 in epoch 5
2024-08-15 17:44:54,209 : INFO : Current training batch loss: 0.3159 in epoch 5
2024-08-15 17:44:54,354 : INFO : Epoch finished, average loss over training batches: 0.2604
2024-08-15 17:44:54,355 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:54,355 : INFO : Training metrics:
2024-08-15 17:44:54,355 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:54,359 : INFO : Accuracy: 0.9411
2024-08-15 17:44:54,359 : INFO : Precision score for label_class 0: 0.8651
2024-08-15 17:44:54,359 : INFO : Precision score for label_class 1: 0.9612
2024-08-15 17:44:54,359 : INFO : Precision score for label_class 2: 0.9319
2024-08-15 17:44:54,359 : INFO : Recall score for label_class 0: 0.9021
2024-08-15 17:44:54,359 : INFO : Recall score for label_class 1: 0.9630
2024-08-15 17:44:54,359 : INFO : Recall score for label_class 2: 0.9108
2024-08-15 17:44:54,359 : INFO : Average F1 score: 0.9222
2024-08-15 17:44:54,830 : INFO : Average loss over validation batches: 0.3911
2024-08-15 17:44:54,830 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:54,830 : INFO : Validation metrics:
2024-08-15 17:44:54,830 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:54,833 : INFO : Accuracy: 0.8650
2024-08-15 17:44:54,833 : INFO : Precision score for label_class 0: 0.7473
2024-08-15 17:44:54,833 : INFO : Precision score for label_class 1: 0.8963
2024-08-15 17:44:54,833 : INFO : Precision score for label_class 2: 0.8539
2024-08-15 17:44:54,833 : INFO : Recall score for label_class 0: 0.7816
2024-08-15 17:44:54,833 : INFO : Recall score for label_class 1: 0.9308
2024-08-15 17:44:54,833 : INFO : Recall score for label_class 2: 0.7716
2024-08-15 17:44:54,833 : INFO : Average F1 score: 0.8293
2024-08-15 17:44:54,833 : INFO : Validation metric decreased (0.412925 --> 0.391101).  Saving model ...
2024-08-15 17:44:54,938 : INFO : Split 4 is finished, the score is: 0.8293
2024-08-15 17:44:54,938 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:54,938 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:54,938 : INFO : Starting training for split 5
2024-08-15 17:44:54,954 : INFO : Starting to tokenize the sequences.
2024-08-15 17:44:54,960 : INFO : Tokenization is finished.
2024-08-15 17:44:54,977 : INFO : Starting to tokenize the sequences.
2024-08-15 17:44:54,982 : INFO : Tokenization is finished.
2024-08-15 17:44:54,987 : INFO : Counting occurences of labels...
2024-08-15 17:44:54,988 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 330, 1615,  754]))
2024-08-15 17:44:54,989 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 84, 396, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:44:55,032 : INFO : Starting epoch 1
2024-08-15 17:44:55,083 : INFO : Current training batch loss: 1.1111 in epoch 1
2024-08-15 17:44:55,910 : INFO : Current training batch loss: 1.0553 in epoch 1
2024-08-15 17:44:56,754 : INFO : Current training batch loss: 0.9408 in epoch 1
2024-08-15 17:44:57,599 : INFO : Current training batch loss: 0.8761 in epoch 1
2024-08-15 17:44:58,433 : INFO : Current training batch loss: 0.8811 in epoch 1
2024-08-15 17:44:58,585 : INFO : Epoch finished, average loss over training batches: 0.9583
2024-08-15 17:44:58,586 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:58,586 : INFO : Training metrics:
2024-08-15 17:44:58,586 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:58,596 : INFO : Accuracy: 0.5572
2024-08-15 17:44:58,596 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:44:58,597 : INFO : Precision score for label_class 1: 0.6133
2024-08-15 17:44:58,597 : INFO : Precision score for label_class 2: 0.2979
2024-08-15 17:44:58,597 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:44:58,597 : INFO : Recall score for label_class 1: 0.8427
2024-08-15 17:44:58,597 : INFO : Recall score for label_class 2: 0.1897
2024-08-15 17:44:58,597 : INFO : Average F1 score: 0.3139
2024-08-15 17:44:59,063 : INFO : Average loss over validation batches: 0.7964
2024-08-15 17:44:59,063 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:59,063 : INFO : Validation metrics:
2024-08-15 17:44:59,063 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:44:59,067 : INFO : Accuracy: 0.6899
2024-08-15 17:44:59,067 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:44:59,067 : INFO : Precision score for label_class 1: 0.7566
2024-08-15 17:44:59,067 : INFO : Precision score for label_class 2: 0.5135
2024-08-15 17:44:59,067 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:44:59,067 : INFO : Recall score for label_class 1: 0.9343
2024-08-15 17:44:59,067 : INFO : Recall score for label_class 2: 0.4897
2024-08-15 17:44:59,067 : INFO : Average F1 score: 0.4458
2024-08-15 17:44:59,067 : INFO : Validation metric decreased (inf --> 0.796421).  Saving model ...
2024-08-15 17:44:59,179 : INFO : Starting epoch 2
2024-08-15 17:44:59,855 : INFO : Current training batch loss: 0.7461 in epoch 2
2024-08-15 17:45:00,687 : INFO : Current training batch loss: 0.6738 in epoch 2
2024-08-15 17:45:01,505 : INFO : Current training batch loss: 0.6121 in epoch 2
2024-08-15 17:45:02,418 : INFO : Current training batch loss: 0.6642 in epoch 2
2024-08-15 17:45:02,776 : INFO : Epoch finished, average loss over training batches: 0.6896
2024-08-15 17:45:02,776 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:02,776 : INFO : Training metrics:
2024-08-15 17:45:02,776 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:02,787 : INFO : Accuracy: 0.7288
2024-08-15 17:45:02,787 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:45:02,787 : INFO : Precision score for label_class 1: 0.7970
2024-08-15 17:45:02,787 : INFO : Precision score for label_class 2: 0.5619
2024-08-15 17:45:02,787 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:45:02,787 : INFO : Recall score for label_class 1: 0.9455
2024-08-15 17:45:02,787 : INFO : Recall score for label_class 2: 0.5836
2024-08-15 17:45:02,787 : INFO : Average F1 score: 0.4792
2024-08-15 17:45:03,253 : INFO : Average loss over validation batches: 0.6199
2024-08-15 17:45:03,253 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:03,253 : INFO : Validation metrics:
2024-08-15 17:45:03,253 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:03,256 : INFO : Accuracy: 0.7478
2024-08-15 17:45:03,256 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:45:03,256 : INFO : Precision score for label_class 1: 0.8406
2024-08-15 17:45:03,256 : INFO : Precision score for label_class 2: 0.5809
2024-08-15 17:45:03,256 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:45:03,256 : INFO : Recall score for label_class 1: 0.9192
2024-08-15 17:45:03,256 : INFO : Recall score for label_class 2: 0.7216
2024-08-15 17:45:03,256 : INFO : Average F1 score: 0.5073
2024-08-15 17:45:03,256 : INFO : Validation metric decreased (0.796421 --> 0.619903).  Saving model ...
2024-08-15 17:45:03,358 : INFO : Starting epoch 3
2024-08-15 17:45:03,812 : INFO : Current training batch loss: 0.5677 in epoch 3
2024-08-15 17:45:04,643 : INFO : Current training batch loss: 0.4995 in epoch 3
2024-08-15 17:45:05,476 : INFO : Current training batch loss: 0.6248 in epoch 3
2024-08-15 17:45:06,309 : INFO : Current training batch loss: 0.4546 in epoch 3
2024-08-15 17:45:06,886 : INFO : Epoch finished, average loss over training batches: 0.5263
2024-08-15 17:45:06,886 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:06,887 : INFO : Training metrics:
2024-08-15 17:45:06,887 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:06,897 : INFO : Accuracy: 0.8147
2024-08-15 17:45:06,897 : INFO : Precision score for label_class 0: 0.8750
2024-08-15 17:45:06,897 : INFO : Precision score for label_class 1: 0.8878
2024-08-15 17:45:06,897 : INFO : Precision score for label_class 2: 0.6693
2024-08-15 17:45:06,897 : INFO : Recall score for label_class 0: 0.1909
2024-08-15 17:45:06,897 : INFO : Recall score for label_class 1: 0.9505
2024-08-15 17:45:06,897 : INFO : Recall score for label_class 2: 0.7971
2024-08-15 17:45:06,897 : INFO : Average F1 score: 0.6530
2024-08-15 17:45:07,366 : INFO : Average loss over validation batches: 0.5482
2024-08-15 17:45:07,366 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:07,366 : INFO : Validation metrics:
2024-08-15 17:45:07,366 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:07,370 : INFO : Accuracy: 0.7834
2024-08-15 17:45:07,370 : INFO : Precision score for label_class 0: 0.9231
2024-08-15 17:45:07,370 : INFO : Precision score for label_class 1: 0.8220
2024-08-15 17:45:07,370 : INFO : Precision score for label_class 2: 0.6736
2024-08-15 17:45:07,370 : INFO : Recall score for label_class 0: 0.2857
2024-08-15 17:45:07,370 : INFO : Recall score for label_class 1: 0.9444
2024-08-15 17:45:07,370 : INFO : Recall score for label_class 2: 0.6701
2024-08-15 17:45:07,370 : INFO : Average F1 score: 0.6624
2024-08-15 17:45:07,370 : INFO : Validation metric decreased (0.619903 --> 0.548168).  Saving model ...
2024-08-15 17:45:07,473 : INFO : Starting epoch 4
2024-08-15 17:45:07,732 : INFO : Current training batch loss: 0.6581 in epoch 4
2024-08-15 17:45:08,574 : INFO : Current training batch loss: 0.5685 in epoch 4
2024-08-15 17:45:09,451 : INFO : Current training batch loss: 0.4626 in epoch 4
2024-08-15 17:45:10,274 : INFO : Current training batch loss: 0.3335 in epoch 4
2024-08-15 17:45:11,054 : INFO : Epoch finished, average loss over training batches: 0.4064
2024-08-15 17:45:11,055 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:11,055 : INFO : Training metrics:
2024-08-15 17:45:11,055 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:11,065 : INFO : Accuracy: 0.8903
2024-08-15 17:45:11,065 : INFO : Precision score for label_class 0: 0.8156
2024-08-15 17:45:11,065 : INFO : Precision score for label_class 1: 0.9177
2024-08-15 17:45:11,065 : INFO : Precision score for label_class 2: 0.8547
2024-08-15 17:45:11,065 : INFO : Recall score for label_class 0: 0.6970
2024-08-15 17:45:11,065 : INFO : Recall score for label_class 1: 0.9666
2024-08-15 17:45:11,065 : INFO : Recall score for label_class 2: 0.8117
2024-08-15 17:45:11,065 : INFO : Average F1 score: 0.8419
2024-08-15 17:45:11,531 : INFO : Average loss over validation batches: 0.4898
2024-08-15 17:45:11,531 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:11,531 : INFO : Validation metrics:
2024-08-15 17:45:11,531 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:11,535 : INFO : Accuracy: 0.8220
2024-08-15 17:45:11,535 : INFO : Precision score for label_class 0: 0.7759
2024-08-15 17:45:11,535 : INFO : Precision score for label_class 1: 0.8842
2024-08-15 17:45:11,535 : INFO : Precision score for label_class 2: 0.7143
2024-08-15 17:45:11,535 : INFO : Recall score for label_class 0: 0.5357
2024-08-15 17:45:11,535 : INFO : Recall score for label_class 1: 0.9066
2024-08-15 17:45:11,535 : INFO : Recall score for label_class 2: 0.7732
2024-08-15 17:45:11,535 : INFO : Average F1 score: 0.7572
2024-08-15 17:45:11,535 : INFO : Validation metric decreased (0.548168 --> 0.489818).  Saving model ...
2024-08-15 17:45:11,638 : INFO : Starting epoch 5
2024-08-15 17:45:11,690 : INFO : Current training batch loss: 0.2914 in epoch 5
2024-08-15 17:45:12,529 : INFO : Current training batch loss: 0.4200 in epoch 5
2024-08-15 17:45:13,372 : INFO : Current training batch loss: 0.2654 in epoch 5
2024-08-15 17:45:14,208 : INFO : Current training batch loss: 0.3158 in epoch 5
2024-08-15 17:45:15,048 : INFO : Current training batch loss: 0.2854 in epoch 5
2024-08-15 17:45:15,206 : INFO : Epoch finished, average loss over training batches: 0.3348
2024-08-15 17:45:15,206 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:15,206 : INFO : Training metrics:
2024-08-15 17:45:15,206 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:15,214 : INFO : Accuracy: 0.9163
2024-08-15 17:45:15,214 : INFO : Precision score for label_class 0: 0.8317
2024-08-15 17:45:15,214 : INFO : Precision score for label_class 1: 0.9385
2024-08-15 17:45:15,214 : INFO : Precision score for label_class 2: 0.9007
2024-08-15 17:45:15,214 : INFO : Recall score for label_class 0: 0.7788
2024-08-15 17:45:15,214 : INFO : Recall score for label_class 1: 0.9734
2024-08-15 17:45:15,214 : INFO : Recall score for label_class 2: 0.8541
2024-08-15 17:45:15,214 : INFO : Average F1 score: 0.8789
2024-08-15 17:45:15,680 : INFO : Average loss over validation batches: 0.4741
2024-08-15 17:45:15,680 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:15,680 : INFO : Validation metrics:
2024-08-15 17:45:15,680 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:15,684 : INFO : Accuracy: 0.8309
2024-08-15 17:45:15,684 : INFO : Precision score for label_class 0: 0.7067
2024-08-15 17:45:15,684 : INFO : Precision score for label_class 1: 0.8942
2024-08-15 17:45:15,684 : INFO : Precision score for label_class 2: 0.7525
2024-08-15 17:45:15,684 : INFO : Recall score for label_class 0: 0.6310
2024-08-15 17:45:15,684 : INFO : Recall score for label_class 1: 0.8965
2024-08-15 17:45:15,684 : INFO : Recall score for label_class 2: 0.7835
2024-08-15 17:45:15,684 : INFO : Average F1 score: 0.7766
2024-08-15 17:45:15,684 : INFO : Validation metric decreased (0.489818 --> 0.474077).  Saving model ...
2024-08-15 17:45:15,788 : INFO : Split 5 is finished, the score is: 0.7766
2024-08-15 17:45:15,788 : INFO : ----------------------------------------------------------------------------------------------------
[I 2024-08-15 17:45:15,798] Trial 21 finished with value: 0.833584412435416 and parameters: {'n_epochs': 5, 'learning_rate': 2.208612110257078e-05, 'classifier_dropout': 0.7353195466635737, 'warmup_step_fraction': 0.07020943335789619, 'use_gradient_clipping': False}. Best is trial 1 with value: 0.8513001269595835.
2024-08-15 17:45:15,807 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:15,808 : INFO : Starting training for split 1
2024-08-15 17:45:15,820 : INFO : Starting to tokenize the sequences.
2024-08-15 17:45:15,826 : INFO : Tokenization is finished.
2024-08-15 17:45:15,838 : INFO : Starting to tokenize the sequences.
2024-08-15 17:45:15,843 : INFO : Tokenization is finished.
2024-08-15 17:45:15,844 : INFO : Counting occurences of labels...
2024-08-15 17:45:15,844 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1596,  774]))
2024-08-15 17:45:15,845 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 415, 174]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:45:15,884 : INFO : Starting epoch 1
2024-08-15 17:45:15,936 : INFO : Current training batch loss: 1.1050 in epoch 1
2024-08-15 17:45:16,756 : INFO : Current training batch loss: 1.0278 in epoch 1
2024-08-15 17:45:17,590 : INFO : Current training batch loss: 1.0191 in epoch 1
2024-08-15 17:45:18,425 : INFO : Current training batch loss: 0.8366 in epoch 1
2024-08-15 17:45:19,247 : INFO : Current training batch loss: 0.8318 in epoch 1
2024-08-15 17:45:19,408 : INFO : Epoch finished, average loss over training batches: 0.9339
2024-08-15 17:45:19,408 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:19,408 : INFO : Training metrics:
2024-08-15 17:45:19,408 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:19,417 : INFO : Accuracy: 0.6090
2024-08-15 17:45:19,417 : INFO : Precision score for label_class 0: 0.1508
2024-08-15 17:45:19,417 : INFO : Precision score for label_class 1: 0.6598
2024-08-15 17:45:19,417 : INFO : Precision score for label_class 2: 0.5321
2024-08-15 17:45:19,417 : INFO : Recall score for label_class 0: 0.0915
2024-08-15 17:45:19,418 : INFO : Recall score for label_class 1: 0.9173
2024-08-15 17:45:19,418 : INFO : Recall score for label_class 2: 0.1925
2024-08-15 17:45:19,418 : INFO : Average F1 score: 0.3880
2024-08-15 17:45:19,894 : INFO : Average loss over validation batches: 0.7317
2024-08-15 17:45:19,894 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:19,894 : INFO : Validation metrics:
2024-08-15 17:45:19,894 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:19,896 : INFO : Accuracy: 0.7170
2024-08-15 17:45:19,896 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:45:19,896 : INFO : Precision score for label_class 1: 0.8041
2024-08-15 17:45:19,896 : INFO : Precision score for label_class 2: 0.4947
2024-08-15 17:45:19,896 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:45:19,897 : INFO : Recall score for label_class 1: 0.9398
2024-08-15 17:45:19,897 : INFO : Recall score for label_class 2: 0.5402
2024-08-15 17:45:19,897 : INFO : Average F1 score: 0.4611
2024-08-15 17:45:19,897 : INFO : Validation metric decreased (inf --> 0.731720).  Saving model ...
2024-08-15 17:45:19,999 : INFO : Starting epoch 2
2024-08-15 17:45:20,670 : INFO : Current training batch loss: 0.4974 in epoch 2
2024-08-15 17:45:21,516 : INFO : Current training batch loss: 0.5807 in epoch 2
2024-08-15 17:45:22,333 : INFO : Current training batch loss: 0.5121 in epoch 2
2024-08-15 17:45:23,150 : INFO : Current training batch loss: 0.4552 in epoch 2
2024-08-15 17:45:23,504 : INFO : Epoch finished, average loss over training batches: 0.5594
2024-08-15 17:45:23,504 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:23,504 : INFO : Training metrics:
2024-08-15 17:45:23,505 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:23,512 : INFO : Accuracy: 0.8143
2024-08-15 17:45:23,512 : INFO : Precision score for label_class 0: 0.8095
2024-08-15 17:45:23,512 : INFO : Precision score for label_class 1: 0.8543
2024-08-15 17:45:23,512 : INFO : Precision score for label_class 2: 0.7233
2024-08-15 17:45:23,512 : INFO : Recall score for label_class 0: 0.4665
2024-08-15 17:45:23,513 : INFO : Recall score for label_class 1: 0.9367
2024-08-15 17:45:23,513 : INFO : Recall score for label_class 2: 0.7093
2024-08-15 17:45:23,513 : INFO : Average F1 score: 0.7339
2024-08-15 17:45:23,978 : INFO : Average loss over validation batches: 0.4467
2024-08-15 17:45:23,978 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:23,978 : INFO : Validation metrics:
2024-08-15 17:45:23,978 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:23,981 : INFO : Accuracy: 0.8637
2024-08-15 17:45:23,981 : INFO : Precision score for label_class 0: 0.8611
2024-08-15 17:45:23,981 : INFO : Precision score for label_class 1: 0.9002
2024-08-15 17:45:23,981 : INFO : Precision score for label_class 2: 0.7802
2024-08-15 17:45:23,981 : INFO : Recall score for label_class 0: 0.7209
2024-08-15 17:45:23,981 : INFO : Recall score for label_class 1: 0.9133
2024-08-15 17:45:23,981 : INFO : Recall score for label_class 2: 0.8161
2024-08-15 17:45:23,981 : INFO : Average F1 score: 0.8298
2024-08-15 17:45:23,981 : INFO : Validation metric decreased (0.731720 --> 0.446746).  Saving model ...
2024-08-15 17:45:24,082 : INFO : Starting epoch 3
2024-08-15 17:45:24,537 : INFO : Current training batch loss: 0.4036 in epoch 3
2024-08-15 17:45:25,376 : INFO : Current training batch loss: 0.4141 in epoch 3
2024-08-15 17:45:26,215 : INFO : Current training batch loss: 0.3641 in epoch 3
2024-08-15 17:45:27,056 : INFO : Current training batch loss: 0.2536 in epoch 3
2024-08-15 17:45:27,628 : INFO : Epoch finished, average loss over training batches: 0.3599
2024-08-15 17:45:27,628 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:27,628 : INFO : Training metrics:
2024-08-15 17:45:27,628 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:27,633 : INFO : Accuracy: 0.8996
2024-08-15 17:45:27,633 : INFO : Precision score for label_class 0: 0.8224
2024-08-15 17:45:27,633 : INFO : Precision score for label_class 1: 0.9215
2024-08-15 17:45:27,633 : INFO : Precision score for label_class 2: 0.8840
2024-08-15 17:45:27,633 : INFO : Recall score for label_class 0: 0.8049
2024-08-15 17:45:27,633 : INFO : Recall score for label_class 1: 0.9492
2024-08-15 17:45:27,633 : INFO : Recall score for label_class 2: 0.8372
2024-08-15 17:45:27,633 : INFO : Average F1 score: 0.8696
2024-08-15 17:45:28,098 : INFO : Average loss over validation batches: 0.3652
2024-08-15 17:45:28,099 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:28,099 : INFO : Validation metrics:
2024-08-15 17:45:28,099 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:28,102 : INFO : Accuracy: 0.8711
2024-08-15 17:45:28,102 : INFO : Precision score for label_class 0: 0.7573
2024-08-15 17:45:28,102 : INFO : Precision score for label_class 1: 0.9225
2024-08-15 17:45:28,102 : INFO : Precision score for label_class 2: 0.8198
2024-08-15 17:45:28,102 : INFO : Recall score for label_class 0: 0.9070
2024-08-15 17:45:28,102 : INFO : Recall score for label_class 1: 0.8892
2024-08-15 17:45:28,102 : INFO : Recall score for label_class 2: 0.8103
2024-08-15 17:45:28,102 : INFO : Average F1 score: 0.8486
2024-08-15 17:45:28,102 : INFO : Validation metric decreased (0.446746 --> 0.365164).  Saving model ...
2024-08-15 17:45:28,204 : INFO : Starting epoch 4
2024-08-15 17:45:28,463 : INFO : Current training batch loss: 0.7270 in epoch 4
2024-08-15 17:45:29,304 : INFO : Current training batch loss: 0.2195 in epoch 4
2024-08-15 17:45:30,143 : INFO : Current training batch loss: 0.3613 in epoch 4
2024-08-15 17:45:30,982 : INFO : Current training batch loss: 0.2321 in epoch 4
2024-08-15 17:45:31,767 : INFO : Epoch finished, average loss over training batches: 0.2687
2024-08-15 17:45:31,768 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:31,768 : INFO : Training metrics:
2024-08-15 17:45:31,768 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:31,776 : INFO : Accuracy: 0.9314
2024-08-15 17:45:31,776 : INFO : Precision score for label_class 0: 0.8538
2024-08-15 17:45:31,776 : INFO : Precision score for label_class 1: 0.9470
2024-08-15 17:45:31,776 : INFO : Precision score for label_class 2: 0.9332
2024-08-15 17:45:31,776 : INFO : Recall score for label_class 0: 0.8902
2024-08-15 17:45:31,776 : INFO : Recall score for label_class 1: 0.9624
2024-08-15 17:45:31,776 : INFO : Recall score for label_class 2: 0.8850
2024-08-15 17:45:31,776 : INFO : Average F1 score: 0.9116
2024-08-15 17:45:32,252 : INFO : Average loss over validation batches: 0.3610
2024-08-15 17:45:32,252 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:32,252 : INFO : Validation metrics:
2024-08-15 17:45:32,252 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:32,255 : INFO : Accuracy: 0.8681
2024-08-15 17:45:32,255 : INFO : Precision score for label_class 0: 0.7477
2024-08-15 17:45:32,255 : INFO : Precision score for label_class 1: 0.9352
2024-08-15 17:45:32,255 : INFO : Precision score for label_class 2: 0.7967
2024-08-15 17:45:32,255 : INFO : Recall score for label_class 0: 0.9302
2024-08-15 17:45:32,255 : INFO : Recall score for label_class 1: 0.8699
2024-08-15 17:45:32,255 : INFO : Recall score for label_class 2: 0.8333
2024-08-15 17:45:32,255 : INFO : Average F1 score: 0.8483
2024-08-15 17:45:32,255 : INFO : Validation metric decreased (0.365164 --> 0.360983).  Saving model ...
2024-08-15 17:45:32,363 : INFO : Starting epoch 5
2024-08-15 17:45:32,414 : INFO : Current training batch loss: 0.1999 in epoch 5
2024-08-15 17:45:33,269 : INFO : Current training batch loss: 0.3158 in epoch 5
2024-08-15 17:45:34,108 : INFO : Current training batch loss: 0.2362 in epoch 5
2024-08-15 17:45:34,943 : INFO : Current training batch loss: 0.2581 in epoch 5
2024-08-15 17:45:35,764 : INFO : Current training batch loss: 0.2919 in epoch 5
2024-08-15 17:45:35,909 : INFO : Epoch finished, average loss over training batches: 0.2225
2024-08-15 17:45:35,910 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:35,910 : INFO : Training metrics:
2024-08-15 17:45:35,910 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:35,915 : INFO : Accuracy: 0.9500
2024-08-15 17:45:35,915 : INFO : Precision score for label_class 0: 0.8768
2024-08-15 17:45:35,915 : INFO : Precision score for label_class 1: 0.9639
2024-08-15 17:45:35,915 : INFO : Precision score for label_class 2: 0.9542
2024-08-15 17:45:35,915 : INFO : Recall score for label_class 0: 0.9329
2024-08-15 17:45:35,915 : INFO : Recall score for label_class 1: 0.9706
2024-08-15 17:45:35,915 : INFO : Recall score for label_class 2: 0.9147
2024-08-15 17:45:35,915 : INFO : Average F1 score: 0.9351
2024-08-15 17:45:36,381 : INFO : Average loss over validation batches: 0.3366
2024-08-15 17:45:36,381 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:36,381 : INFO : Validation metrics:
2024-08-15 17:45:36,381 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:36,384 : INFO : Accuracy: 0.8948
2024-08-15 17:45:36,384 : INFO : Precision score for label_class 0: 0.8229
2024-08-15 17:45:36,384 : INFO : Precision score for label_class 1: 0.9110
2024-08-15 17:45:36,384 : INFO : Precision score for label_class 2: 0.8947
2024-08-15 17:45:36,384 : INFO : Recall score for label_class 0: 0.9186
2024-08-15 17:45:36,384 : INFO : Recall score for label_class 1: 0.9373
2024-08-15 17:45:36,385 : INFO : Recall score for label_class 2: 0.7816
2024-08-15 17:45:36,385 : INFO : Average F1 score: 0.8755
2024-08-15 17:45:36,385 : INFO : Validation metric decreased (0.360983 --> 0.336624).  Saving model ...
2024-08-15 17:45:36,488 : INFO : Split 1 is finished, the score is: 0.8755
2024-08-15 17:45:36,488 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:36,488 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:36,488 : INFO : Starting training for split 2
2024-08-15 17:45:36,502 : INFO : Starting to tokenize the sequences.
2024-08-15 17:45:36,508 : INFO : Tokenization is finished.
2024-08-15 17:45:36,524 : INFO : Starting to tokenize the sequences.
2024-08-15 17:45:36,528 : INFO : Tokenization is finished.
2024-08-15 17:45:36,533 : INFO : Counting occurences of labels...
2024-08-15 17:45:36,534 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 343, 1601,  754]))
2024-08-15 17:45:36,534 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 71, 410, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:45:36,575 : INFO : Starting epoch 1
2024-08-15 17:45:36,626 : INFO : Current training batch loss: 1.0729 in epoch 1
2024-08-15 17:45:37,458 : INFO : Current training batch loss: 1.0575 in epoch 1
2024-08-15 17:45:38,285 : INFO : Current training batch loss: 1.0167 in epoch 1
2024-08-15 17:45:39,113 : INFO : Current training batch loss: 0.8153 in epoch 1
2024-08-15 17:45:39,945 : INFO : Current training batch loss: 0.8497 in epoch 1
2024-08-15 17:45:40,099 : INFO : Epoch finished, average loss over training batches: 0.9305
2024-08-15 17:45:40,100 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:40,100 : INFO : Training metrics:
2024-08-15 17:45:40,100 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:40,110 : INFO : Accuracy: 0.6282
2024-08-15 17:45:40,111 : INFO : Precision score for label_class 0: 0.5000
2024-08-15 17:45:40,111 : INFO : Precision score for label_class 1: 0.6401
2024-08-15 17:45:40,111 : INFO : Precision score for label_class 2: 0.5125
2024-08-15 17:45:40,111 : INFO : Recall score for label_class 0: 0.0146
2024-08-15 17:45:40,111 : INFO : Recall score for label_class 1: 0.9788
2024-08-15 17:45:40,111 : INFO : Recall score for label_class 2: 0.1631
2024-08-15 17:45:40,111 : INFO : Average F1 score: 0.3499
2024-08-15 17:45:40,579 : INFO : Average loss over validation batches: 0.7317
2024-08-15 17:45:40,580 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:40,580 : INFO : Validation metrics:
2024-08-15 17:45:40,580 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:40,584 : INFO : Accuracy: 0.7230
2024-08-15 17:45:40,584 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:45:40,584 : INFO : Precision score for label_class 1: 0.7899
2024-08-15 17:45:40,584 : INFO : Precision score for label_class 2: 0.5628
2024-08-15 17:45:40,584 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:45:40,584 : INFO : Recall score for label_class 1: 0.9171
2024-08-15 17:45:40,584 : INFO : Recall score for label_class 2: 0.5773
2024-08-15 17:45:40,584 : INFO : Average F1 score: 0.4729
2024-08-15 17:45:40,584 : INFO : Validation metric decreased (inf --> 0.731692).  Saving model ...
2024-08-15 17:45:40,686 : INFO : Starting epoch 2
2024-08-15 17:45:41,352 : INFO : Current training batch loss: 0.7175 in epoch 2
2024-08-15 17:45:42,170 : INFO : Current training batch loss: 0.6479 in epoch 2
2024-08-15 17:45:42,987 : INFO : Current training batch loss: 0.5622 in epoch 2
2024-08-15 17:45:43,805 : INFO : Current training batch loss: 0.4871 in epoch 2
2024-08-15 17:45:44,159 : INFO : Epoch finished, average loss over training batches: 0.5982
2024-08-15 17:45:44,160 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:44,160 : INFO : Training metrics:
2024-08-15 17:45:44,160 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:44,167 : INFO : Accuracy: 0.7728
2024-08-15 17:45:44,167 : INFO : Precision score for label_class 0: 0.7759
2024-08-15 17:45:44,167 : INFO : Precision score for label_class 1: 0.8514
2024-08-15 17:45:44,167 : INFO : Precision score for label_class 2: 0.6146
2024-08-15 17:45:44,167 : INFO : Recall score for label_class 0: 0.1312
2024-08-15 17:45:44,167 : INFO : Recall score for label_class 1: 0.9375
2024-08-15 17:45:44,167 : INFO : Recall score for label_class 2: 0.7149
2024-08-15 17:45:44,167 : INFO : Average F1 score: 0.5926
2024-08-15 17:45:44,635 : INFO : Average loss over validation batches: 0.4858
2024-08-15 17:45:44,635 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:44,635 : INFO : Validation metrics:
2024-08-15 17:45:44,635 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:44,638 : INFO : Accuracy: 0.8459
2024-08-15 17:45:44,638 : INFO : Precision score for label_class 0: 0.8163
2024-08-15 17:45:44,638 : INFO : Precision score for label_class 1: 0.8616
2024-08-15 17:45:44,638 : INFO : Precision score for label_class 2: 0.8146
2024-08-15 17:45:44,638 : INFO : Recall score for label_class 0: 0.5634
2024-08-15 17:45:44,638 : INFO : Recall score for label_class 1: 0.9415
2024-08-15 17:45:44,638 : INFO : Recall score for label_class 2: 0.7474
2024-08-15 17:45:44,638 : INFO : Average F1 score: 0.7820
2024-08-15 17:45:44,638 : INFO : Validation metric decreased (0.731692 --> 0.485799).  Saving model ...
2024-08-15 17:45:44,748 : INFO : Starting epoch 3
2024-08-15 17:45:45,218 : INFO : Current training batch loss: 0.4198 in epoch 3
2024-08-15 17:45:46,071 : INFO : Current training batch loss: 0.3832 in epoch 3
2024-08-15 17:45:46,910 : INFO : Current training batch loss: 0.3995 in epoch 3
2024-08-15 17:45:47,756 : INFO : Current training batch loss: 0.2070 in epoch 3
2024-08-15 17:45:48,314 : INFO : Epoch finished, average loss over training batches: 0.3758
2024-08-15 17:45:48,314 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:48,314 : INFO : Training metrics:
2024-08-15 17:45:48,314 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:48,321 : INFO : Accuracy: 0.8958
2024-08-15 17:45:48,321 : INFO : Precision score for label_class 0: 0.8078
2024-08-15 17:45:48,321 : INFO : Precision score for label_class 1: 0.9273
2024-08-15 17:45:48,321 : INFO : Precision score for label_class 2: 0.8656
2024-08-15 17:45:48,321 : INFO : Recall score for label_class 0: 0.7843
2024-08-15 17:45:48,321 : INFO : Recall score for label_class 1: 0.9475
2024-08-15 17:45:48,321 : INFO : Recall score for label_class 2: 0.8369
2024-08-15 17:45:48,321 : INFO : Average F1 score: 0.8614
2024-08-15 17:45:48,815 : INFO : Average loss over validation batches: 0.4002
2024-08-15 17:45:48,815 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:48,815 : INFO : Validation metrics:
2024-08-15 17:45:48,815 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:48,819 : INFO : Accuracy: 0.8652
2024-08-15 17:45:48,819 : INFO : Precision score for label_class 0: 0.7733
2024-08-15 17:45:48,819 : INFO : Precision score for label_class 1: 0.8782
2024-08-15 17:45:48,819 : INFO : Precision score for label_class 2: 0.8727
2024-08-15 17:45:48,819 : INFO : Recall score for label_class 0: 0.8169
2024-08-15 17:45:48,819 : INFO : Recall score for label_class 1: 0.9317
2024-08-15 17:45:48,819 : INFO : Recall score for label_class 2: 0.7423
2024-08-15 17:45:48,819 : INFO : Average F1 score: 0.8336
2024-08-15 17:45:48,819 : INFO : Validation metric decreased (0.485799 --> 0.400170).  Saving model ...
2024-08-15 17:45:48,921 : INFO : Starting epoch 4
2024-08-15 17:45:49,174 : INFO : Current training batch loss: 0.4014 in epoch 4
2024-08-15 17:45:50,001 : INFO : Current training batch loss: 0.1802 in epoch 4
2024-08-15 17:45:50,829 : INFO : Current training batch loss: 0.3378 in epoch 4
2024-08-15 17:45:51,642 : INFO : Current training batch loss: 0.2230 in epoch 4
2024-08-15 17:45:52,430 : INFO : Epoch finished, average loss over training batches: 0.2617
2024-08-15 17:45:52,430 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:52,430 : INFO : Training metrics:
2024-08-15 17:45:52,430 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:52,437 : INFO : Accuracy: 0.9381
2024-08-15 17:45:52,437 : INFO : Precision score for label_class 0: 0.8599
2024-08-15 17:45:52,437 : INFO : Precision score for label_class 1: 0.9557
2024-08-15 17:45:52,437 : INFO : Precision score for label_class 2: 0.9371
2024-08-15 17:45:52,437 : INFO : Recall score for label_class 0: 0.8950
2024-08-15 17:45:52,437 : INFO : Recall score for label_class 1: 0.9706
2024-08-15 17:45:52,437 : INFO : Recall score for label_class 2: 0.8886
2024-08-15 17:45:52,437 : INFO : Average F1 score: 0.9175
2024-08-15 17:45:52,924 : INFO : Average loss over validation batches: 0.3835
2024-08-15 17:45:52,924 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:52,924 : INFO : Validation metrics:
2024-08-15 17:45:52,924 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:52,928 : INFO : Accuracy: 0.8637
2024-08-15 17:45:52,928 : INFO : Precision score for label_class 0: 0.7532
2024-08-15 17:45:52,928 : INFO : Precision score for label_class 1: 0.9039
2024-08-15 17:45:52,928 : INFO : Precision score for label_class 2: 0.8229
2024-08-15 17:45:52,928 : INFO : Recall score for label_class 0: 0.8169
2024-08-15 17:45:52,928 : INFO : Recall score for label_class 1: 0.8951
2024-08-15 17:45:52,928 : INFO : Recall score for label_class 2: 0.8144
2024-08-15 17:45:52,928 : INFO : Average F1 score: 0.8340
2024-08-15 17:45:52,928 : INFO : Validation metric decreased (0.400170 --> 0.383502).  Saving model ...
2024-08-15 17:45:53,031 : INFO : Starting epoch 5
2024-08-15 17:45:53,083 : INFO : Current training batch loss: 0.1990 in epoch 5
2024-08-15 17:45:53,909 : INFO : Current training batch loss: 0.4081 in epoch 5
2024-08-15 17:45:54,731 : INFO : Current training batch loss: 0.2375 in epoch 5
2024-08-15 17:45:55,556 : INFO : Current training batch loss: 0.2655 in epoch 5
2024-08-15 17:45:56,418 : INFO : Current training batch loss: 0.3004 in epoch 5
2024-08-15 17:45:56,571 : INFO : Epoch finished, average loss over training batches: 0.2152
2024-08-15 17:45:56,571 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:56,571 : INFO : Training metrics:
2024-08-15 17:45:56,571 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:56,581 : INFO : Accuracy: 0.9555
2024-08-15 17:45:56,581 : INFO : Precision score for label_class 0: 0.8980
2024-08-15 17:45:56,581 : INFO : Precision score for label_class 1: 0.9702
2024-08-15 17:45:56,581 : INFO : Precision score for label_class 2: 0.9509
2024-08-15 17:45:56,582 : INFO : Recall score for label_class 0: 0.9242
2024-08-15 17:45:56,582 : INFO : Recall score for label_class 1: 0.9769
2024-08-15 17:45:56,582 : INFO : Recall score for label_class 2: 0.9244
2024-08-15 17:45:56,582 : INFO : Average F1 score: 0.9406
2024-08-15 17:45:57,050 : INFO : Average loss over validation batches: 0.3858
2024-08-15 17:45:57,050 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:57,050 : INFO : Validation metrics:
2024-08-15 17:45:57,050 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:57,054 : INFO : Accuracy: 0.8607
2024-08-15 17:45:57,054 : INFO : Precision score for label_class 0: 0.7857
2024-08-15 17:45:57,054 : INFO : Precision score for label_class 1: 0.8739
2024-08-15 17:45:57,054 : INFO : Precision score for label_class 2: 0.8580
2024-08-15 17:45:57,054 : INFO : Recall score for label_class 0: 0.7746
2024-08-15 17:45:57,054 : INFO : Recall score for label_class 1: 0.9293
2024-08-15 17:45:57,054 : INFO : Recall score for label_class 2: 0.7474
2024-08-15 17:45:57,054 : INFO : Average F1 score: 0.8266
2024-08-15 17:45:57,054 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:45:57,054 : INFO : Last epoch reached, validation loss was better before, loading best model during training.
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:45:57,087 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:45:57,591 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:57,591 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:45:57,591 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:57,594 : INFO : Accuracy: 0.8637
2024-08-15 17:45:57,594 : INFO : Precision score for label_class 0: 0.7532
2024-08-15 17:45:57,594 : INFO : Precision score for label_class 1: 0.9039
2024-08-15 17:45:57,594 : INFO : Precision score for label_class 2: 0.8229
2024-08-15 17:45:57,594 : INFO : Recall score for label_class 0: 0.8169
2024-08-15 17:45:57,594 : INFO : Recall score for label_class 1: 0.8951
2024-08-15 17:45:57,594 : INFO : Recall score for label_class 2: 0.8144
2024-08-15 17:45:57,594 : INFO : Average F1 score: 0.8340
2024-08-15 17:45:57,594 : INFO : Determined score from best model, ending training.
2024-08-15 17:45:57,596 : INFO : Split 2 is finished, the score is: 0.8340
2024-08-15 17:45:57,596 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:57,596 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:45:57,596 : INFO : Starting training for split 3
2024-08-15 17:45:57,609 : INFO : Starting to tokenize the sequences.
2024-08-15 17:45:57,615 : INFO : Tokenization is finished.
2024-08-15 17:45:57,632 : INFO : Starting to tokenize the sequences.
2024-08-15 17:45:57,637 : INFO : Tokenization is finished.
2024-08-15 17:45:57,642 : INFO : Counting occurences of labels...
2024-08-15 17:45:57,643 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1611,  759]))
2024-08-15 17:45:57,643 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 400, 189]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:45:57,686 : INFO : Starting epoch 1
2024-08-15 17:45:57,737 : INFO : Current training batch loss: 1.0937 in epoch 1
2024-08-15 17:45:58,579 : INFO : Current training batch loss: 1.0714 in epoch 1
2024-08-15 17:45:59,429 : INFO : Current training batch loss: 0.9589 in epoch 1
2024-08-15 17:46:00,277 : INFO : Current training batch loss: 0.8817 in epoch 1
2024-08-15 17:46:01,118 : INFO : Current training batch loss: 0.8453 in epoch 1
2024-08-15 17:46:01,276 : INFO : Epoch finished, average loss over training batches: 0.9486
2024-08-15 17:46:01,276 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:01,276 : INFO : Training metrics:
2024-08-15 17:46:01,276 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:01,283 : INFO : Accuracy: 0.5764
2024-08-15 17:46:01,283 : INFO : Precision score for label_class 0: 0.1371
2024-08-15 17:46:01,283 : INFO : Precision score for label_class 1: 0.6488
2024-08-15 17:46:01,283 : INFO : Precision score for label_class 2: 0.5223
2024-08-15 17:46:01,283 : INFO : Recall score for label_class 0: 0.1341
2024-08-15 17:46:01,283 : INFO : Recall score for label_class 1: 0.8579
2024-08-15 17:46:01,283 : INFO : Recall score for label_class 2: 0.1700
2024-08-15 17:46:01,283 : INFO : Average F1 score: 0.3770
2024-08-15 17:46:01,748 : INFO : Average loss over validation batches: 0.7471
2024-08-15 17:46:01,749 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:01,749 : INFO : Validation metrics:
2024-08-15 17:46:01,749 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:01,751 : INFO : Accuracy: 0.7007
2024-08-15 17:46:01,752 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:46:01,752 : INFO : Precision score for label_class 1: 0.7755
2024-08-15 17:46:01,752 : INFO : Precision score for label_class 2: 0.5155
2024-08-15 17:46:01,752 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:46:01,752 : INFO : Recall score for label_class 1: 0.9325
2024-08-15 17:46:01,752 : INFO : Recall score for label_class 2: 0.5291
2024-08-15 17:46:01,752 : INFO : Average F1 score: 0.4563
2024-08-15 17:46:01,752 : INFO : Validation metric decreased (inf --> 0.747065).  Saving model ...
2024-08-15 17:46:01,853 : INFO : Starting epoch 2
2024-08-15 17:46:02,537 : INFO : Current training batch loss: 0.6767 in epoch 2
2024-08-15 17:46:03,382 : INFO : Current training batch loss: 0.6286 in epoch 2
2024-08-15 17:46:04,229 : INFO : Current training batch loss: 0.5654 in epoch 2
2024-08-15 17:46:05,069 : INFO : Current training batch loss: 0.4309 in epoch 2
2024-08-15 17:46:05,423 : INFO : Epoch finished, average loss over training batches: 0.6065
2024-08-15 17:46:05,424 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:05,424 : INFO : Training metrics:
2024-08-15 17:46:05,424 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:05,427 : INFO : Accuracy: 0.7839
2024-08-15 17:46:05,427 : INFO : Precision score for label_class 0: 0.7597
2024-08-15 17:46:05,427 : INFO : Precision score for label_class 1: 0.8367
2024-08-15 17:46:05,427 : INFO : Precision score for label_class 2: 0.6627
2024-08-15 17:46:05,427 : INFO : Recall score for label_class 0: 0.2988
2024-08-15 17:46:05,427 : INFO : Recall score for label_class 1: 0.9385
2024-08-15 17:46:05,427 : INFO : Recall score for label_class 2: 0.6653
2024-08-15 17:46:05,427 : INFO : Average F1 score: 0.6592
2024-08-15 17:46:05,904 : INFO : Average loss over validation batches: 0.4786
2024-08-15 17:46:05,904 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:05,904 : INFO : Validation metrics:
2024-08-15 17:46:05,904 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:05,906 : INFO : Accuracy: 0.8711
2024-08-15 17:46:05,906 : INFO : Precision score for label_class 0: 0.8493
2024-08-15 17:46:05,906 : INFO : Precision score for label_class 1: 0.8897
2024-08-15 17:46:05,906 : INFO : Precision score for label_class 2: 0.8352
2024-08-15 17:46:05,906 : INFO : Recall score for label_class 0: 0.7209
2024-08-15 17:46:05,906 : INFO : Recall score for label_class 1: 0.9475
2024-08-15 17:46:05,906 : INFO : Recall score for label_class 2: 0.7778
2024-08-15 17:46:05,906 : INFO : Average F1 score: 0.8343
2024-08-15 17:46:05,906 : INFO : Validation metric decreased (0.747065 --> 0.478601).  Saving model ...
2024-08-15 17:46:06,008 : INFO : Starting epoch 3
2024-08-15 17:46:06,461 : INFO : Current training batch loss: 0.4099 in epoch 3
2024-08-15 17:46:07,302 : INFO : Current training batch loss: 0.3985 in epoch 3
2024-08-15 17:46:08,146 : INFO : Current training batch loss: 0.3737 in epoch 3
2024-08-15 17:46:08,990 : INFO : Current training batch loss: 0.2978 in epoch 3
2024-08-15 17:46:09,575 : INFO : Epoch finished, average loss over training batches: 0.3873
2024-08-15 17:46:09,575 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:09,575 : INFO : Training metrics:
2024-08-15 17:46:09,575 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:09,579 : INFO : Accuracy: 0.8888
2024-08-15 17:46:09,579 : INFO : Precision score for label_class 0: 0.8012
2024-08-15 17:46:09,579 : INFO : Precision score for label_class 1: 0.9108
2024-08-15 17:46:09,579 : INFO : Precision score for label_class 2: 0.8773
2024-08-15 17:46:09,579 : INFO : Recall score for label_class 0: 0.7988
2024-08-15 17:46:09,579 : INFO : Recall score for label_class 1: 0.9441
2024-08-15 17:46:09,579 : INFO : Recall score for label_class 2: 0.8103
2024-08-15 17:46:09,579 : INFO : Average F1 score: 0.8565
2024-08-15 17:46:10,061 : INFO : Average loss over validation batches: 0.3848
2024-08-15 17:46:10,061 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:10,061 : INFO : Validation metrics:
2024-08-15 17:46:10,061 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:10,064 : INFO : Accuracy: 0.8711
2024-08-15 17:46:10,064 : INFO : Precision score for label_class 0: 0.8272
2024-08-15 17:46:10,064 : INFO : Precision score for label_class 1: 0.9046
2024-08-15 17:46:10,064 : INFO : Precision score for label_class 2: 0.8162
2024-08-15 17:46:10,064 : INFO : Recall score for label_class 0: 0.7791
2024-08-15 17:46:10,064 : INFO : Recall score for label_class 1: 0.9250
2024-08-15 17:46:10,064 : INFO : Recall score for label_class 2: 0.7989
2024-08-15 17:46:10,064 : INFO : Average F1 score: 0.8415
2024-08-15 17:46:10,064 : INFO : Validation metric decreased (0.478601 --> 0.384752).  Saving model ...
2024-08-15 17:46:10,164 : INFO : Starting epoch 4
2024-08-15 17:46:10,416 : INFO : Current training batch loss: 0.4643 in epoch 4
2024-08-15 17:46:11,231 : INFO : Current training batch loss: 0.3951 in epoch 4
2024-08-15 17:46:12,046 : INFO : Current training batch loss: 0.3950 in epoch 4
2024-08-15 17:46:12,861 : INFO : Current training batch loss: 0.2115 in epoch 4
2024-08-15 17:46:13,615 : INFO : Epoch finished, average loss over training batches: 0.2716
2024-08-15 17:46:13,615 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:13,615 : INFO : Training metrics:
2024-08-15 17:46:13,615 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:13,620 : INFO : Accuracy: 0.9325
2024-08-15 17:46:13,620 : INFO : Precision score for label_class 0: 0.8534
2024-08-15 17:46:13,620 : INFO : Precision score for label_class 1: 0.9471
2024-08-15 17:46:13,620 : INFO : Precision score for label_class 2: 0.9369
2024-08-15 17:46:13,620 : INFO : Recall score for label_class 0: 0.8872
2024-08-15 17:46:13,620 : INFO : Recall score for label_class 1: 0.9665
2024-08-15 17:46:13,620 : INFO : Recall score for label_class 2: 0.8801
2024-08-15 17:46:13,620 : INFO : Average F1 score: 0.9114
2024-08-15 17:46:14,086 : INFO : Average loss over validation batches: 0.3742
2024-08-15 17:46:14,086 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:14,086 : INFO : Validation metrics:
2024-08-15 17:46:14,086 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:14,089 : INFO : Accuracy: 0.8652
2024-08-15 17:46:14,089 : INFO : Precision score for label_class 0: 0.7677
2024-08-15 17:46:14,089 : INFO : Precision score for label_class 1: 0.9291
2024-08-15 17:46:14,089 : INFO : Precision score for label_class 2: 0.7897
2024-08-15 17:46:14,089 : INFO : Recall score for label_class 0: 0.8837
2024-08-15 17:46:14,089 : INFO : Recall score for label_class 1: 0.8850
2024-08-15 17:46:14,089 : INFO : Recall score for label_class 2: 0.8148
2024-08-15 17:46:14,089 : INFO : Average F1 score: 0.8434
2024-08-15 17:46:14,089 : INFO : Validation metric decreased (0.384752 --> 0.374160).  Saving model ...
2024-08-15 17:46:14,187 : INFO : Starting epoch 5
2024-08-15 17:46:14,238 : INFO : Current training batch loss: 0.1418 in epoch 5
2024-08-15 17:46:15,163 : INFO : Current training batch loss: 0.3654 in epoch 5
2024-08-15 17:46:16,015 : INFO : Current training batch loss: 0.1559 in epoch 5
2024-08-15 17:46:16,857 : INFO : Current training batch loss: 0.2027 in epoch 5
2024-08-15 17:46:17,709 : INFO : Current training batch loss: 0.2941 in epoch 5
2024-08-15 17:46:17,862 : INFO : Epoch finished, average loss over training batches: 0.2198
2024-08-15 17:46:17,862 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:17,862 : INFO : Training metrics:
2024-08-15 17:46:17,862 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:17,866 : INFO : Accuracy: 0.9492
2024-08-15 17:46:17,866 : INFO : Precision score for label_class 0: 0.8671
2024-08-15 17:46:17,866 : INFO : Precision score for label_class 1: 0.9649
2024-08-15 17:46:17,866 : INFO : Precision score for label_class 2: 0.9534
2024-08-15 17:46:17,866 : INFO : Recall score for label_class 0: 0.9146
2024-08-15 17:46:17,866 : INFO : Recall score for label_class 1: 0.9721
2024-08-15 17:46:17,866 : INFO : Recall score for label_class 2: 0.9157
2024-08-15 17:46:17,866 : INFO : Average F1 score: 0.9309
2024-08-15 17:46:18,339 : INFO : Average loss over validation batches: 0.3547
2024-08-15 17:46:18,339 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:18,339 : INFO : Validation metrics:
2024-08-15 17:46:18,339 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:18,342 : INFO : Accuracy: 0.8756
2024-08-15 17:46:18,342 : INFO : Precision score for label_class 0: 0.8022
2024-08-15 17:46:18,342 : INFO : Precision score for label_class 1: 0.9071
2024-08-15 17:46:18,342 : INFO : Precision score for label_class 2: 0.8400
2024-08-15 17:46:18,342 : INFO : Recall score for label_class 0: 0.8488
2024-08-15 17:46:18,342 : INFO : Recall score for label_class 1: 0.9275
2024-08-15 17:46:18,342 : INFO : Recall score for label_class 2: 0.7778
2024-08-15 17:46:18,342 : INFO : Average F1 score: 0.8499
2024-08-15 17:46:18,342 : INFO : Validation metric decreased (0.374160 --> 0.354661).  Saving model ...
2024-08-15 17:46:18,445 : INFO : Split 3 is finished, the score is: 0.8499
2024-08-15 17:46:18,445 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:18,445 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:18,445 : INFO : Starting training for split 4
2024-08-15 17:46:18,460 : INFO : Starting to tokenize the sequences.
2024-08-15 17:46:18,466 : INFO : Tokenization is finished.
2024-08-15 17:46:18,482 : INFO : Starting to tokenize the sequences.
2024-08-15 17:46:18,487 : INFO : Tokenization is finished.
2024-08-15 17:46:18,492 : INFO : Counting occurences of labels...
2024-08-15 17:46:18,493 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 327, 1621,  751]))
2024-08-15 17:46:18,493 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 87, 390, 197]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:46:18,534 : INFO : Starting epoch 1
2024-08-15 17:46:18,585 : INFO : Current training batch loss: 1.0958 in epoch 1
2024-08-15 17:46:19,449 : INFO : Current training batch loss: 1.0634 in epoch 1
2024-08-15 17:46:20,283 : INFO : Current training batch loss: 0.9395 in epoch 1
2024-08-15 17:46:21,114 : INFO : Current training batch loss: 0.8690 in epoch 1
2024-08-15 17:46:21,957 : INFO : Current training batch loss: 0.8034 in epoch 1
2024-08-15 17:46:22,115 : INFO : Epoch finished, average loss over training batches: 0.9316
2024-08-15 17:46:22,115 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:22,115 : INFO : Training metrics:
2024-08-15 17:46:22,115 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:22,122 : INFO : Accuracy: 0.5847
2024-08-15 17:46:22,122 : INFO : Precision score for label_class 0: 0.1994
2024-08-15 17:46:22,122 : INFO : Precision score for label_class 1: 0.6464
2024-08-15 17:46:22,122 : INFO : Precision score for label_class 2: 0.4945
2024-08-15 17:46:22,122 : INFO : Recall score for label_class 0: 0.1896
2024-08-15 17:46:22,122 : INFO : Recall score for label_class 1: 0.8797
2024-08-15 17:46:22,122 : INFO : Recall score for label_class 2: 0.1198
2024-08-15 17:46:22,122 : INFO : Average F1 score: 0.3775
2024-08-15 17:46:22,588 : INFO : Average loss over validation batches: 0.7342
2024-08-15 17:46:22,588 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:22,588 : INFO : Validation metrics:
2024-08-15 17:46:22,588 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:22,591 : INFO : Accuracy: 0.7136
2024-08-15 17:46:22,591 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:46:22,591 : INFO : Precision score for label_class 1: 0.7834
2024-08-15 17:46:22,591 : INFO : Precision score for label_class 2: 0.5517
2024-08-15 17:46:22,591 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:46:22,591 : INFO : Recall score for label_class 1: 0.9462
2024-08-15 17:46:22,591 : INFO : Recall score for label_class 2: 0.5685
2024-08-15 17:46:22,591 : INFO : Average F1 score: 0.4724
2024-08-15 17:46:22,591 : INFO : Validation metric decreased (inf --> 0.734204).  Saving model ...
2024-08-15 17:46:22,688 : INFO : Starting epoch 2
2024-08-15 17:46:23,373 : INFO : Current training batch loss: 0.6927 in epoch 2
2024-08-15 17:46:24,197 : INFO : Current training batch loss: 0.6049 in epoch 2
2024-08-15 17:46:25,024 : INFO : Current training batch loss: 0.4930 in epoch 2
2024-08-15 17:46:25,842 : INFO : Current training batch loss: 0.4616 in epoch 2
2024-08-15 17:46:26,206 : INFO : Epoch finished, average loss over training batches: 0.6014
2024-08-15 17:46:26,206 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:26,206 : INFO : Training metrics:
2024-08-15 17:46:26,206 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:26,214 : INFO : Accuracy: 0.7825
2024-08-15 17:46:26,214 : INFO : Precision score for label_class 0: 0.8320
2024-08-15 17:46:26,214 : INFO : Precision score for label_class 1: 0.8345
2024-08-15 17:46:26,214 : INFO : Precision score for label_class 2: 0.6505
2024-08-15 17:46:26,214 : INFO : Recall score for label_class 0: 0.3180
2024-08-15 17:46:26,214 : INFO : Recall score for label_class 1: 0.9334
2024-08-15 17:46:26,214 : INFO : Recall score for label_class 2: 0.6591
2024-08-15 17:46:26,214 : INFO : Average F1 score: 0.6654
2024-08-15 17:46:26,706 : INFO : Average loss over validation batches: 0.4898
2024-08-15 17:46:26,706 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:26,706 : INFO : Validation metrics:
2024-08-15 17:46:26,706 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:26,709 : INFO : Accuracy: 0.8398
2024-08-15 17:46:26,709 : INFO : Precision score for label_class 0: 0.6809
2024-08-15 17:46:26,709 : INFO : Precision score for label_class 1: 0.8774
2024-08-15 17:46:26,709 : INFO : Precision score for label_class 2: 0.8354
2024-08-15 17:46:26,709 : INFO : Recall score for label_class 0: 0.7356
2024-08-15 17:46:26,709 : INFO : Recall score for label_class 1: 0.9359
2024-08-15 17:46:26,709 : INFO : Recall score for label_class 2: 0.6954
2024-08-15 17:46:26,709 : INFO : Average F1 score: 0.7906
2024-08-15 17:46:26,709 : INFO : Validation metric decreased (0.734204 --> 0.489773).  Saving model ...
2024-08-15 17:46:26,812 : INFO : Starting epoch 3
2024-08-15 17:46:27,263 : INFO : Current training batch loss: 0.4052 in epoch 3
2024-08-15 17:46:28,095 : INFO : Current training batch loss: 0.4242 in epoch 3
2024-08-15 17:46:28,910 : INFO : Current training batch loss: 0.4188 in epoch 3
2024-08-15 17:46:29,733 : INFO : Current training batch loss: 0.2329 in epoch 3
2024-08-15 17:46:30,276 : INFO : Epoch finished, average loss over training batches: 0.3806
2024-08-15 17:46:30,276 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:30,276 : INFO : Training metrics:
2024-08-15 17:46:30,276 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:30,282 : INFO : Accuracy: 0.8918
2024-08-15 17:46:30,282 : INFO : Precision score for label_class 0: 0.8098
2024-08-15 17:46:30,282 : INFO : Precision score for label_class 1: 0.9200
2024-08-15 17:46:30,282 : INFO : Precision score for label_class 2: 0.8634
2024-08-15 17:46:30,282 : INFO : Recall score for label_class 0: 0.8073
2024-08-15 17:46:30,282 : INFO : Recall score for label_class 1: 0.9439
2024-08-15 17:46:30,282 : INFO : Recall score for label_class 2: 0.8162
2024-08-15 17:46:30,282 : INFO : Average F1 score: 0.8598
2024-08-15 17:46:30,751 : INFO : Average loss over validation batches: 0.4052
2024-08-15 17:46:30,751 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:30,751 : INFO : Validation metrics:
2024-08-15 17:46:30,751 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:30,755 : INFO : Accuracy: 0.8576
2024-08-15 17:46:30,755 : INFO : Precision score for label_class 0: 0.7245
2024-08-15 17:46:30,755 : INFO : Precision score for label_class 1: 0.9077
2024-08-15 17:46:30,755 : INFO : Precision score for label_class 2: 0.8226
2024-08-15 17:46:30,755 : INFO : Recall score for label_class 0: 0.8161
2024-08-15 17:46:30,755 : INFO : Recall score for label_class 1: 0.9077
2024-08-15 17:46:30,755 : INFO : Recall score for label_class 2: 0.7766
2024-08-15 17:46:30,755 : INFO : Average F1 score: 0.8247
2024-08-15 17:46:30,755 : INFO : Validation metric decreased (0.489773 --> 0.405204).  Saving model ...
2024-08-15 17:46:30,857 : INFO : Starting epoch 4
2024-08-15 17:46:31,108 : INFO : Current training batch loss: 0.4100 in epoch 4
2024-08-15 17:46:31,930 : INFO : Current training batch loss: 0.3430 in epoch 4
2024-08-15 17:46:32,768 : INFO : Current training batch loss: 0.2380 in epoch 4
2024-08-15 17:46:33,583 : INFO : Current training batch loss: 0.1896 in epoch 4
2024-08-15 17:46:34,337 : INFO : Epoch finished, average loss over training batches: 0.2696
2024-08-15 17:46:34,337 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:34,337 : INFO : Training metrics:
2024-08-15 17:46:34,337 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:34,341 : INFO : Accuracy: 0.9292
2024-08-15 17:46:34,341 : INFO : Precision score for label_class 0: 0.8504
2024-08-15 17:46:34,341 : INFO : Precision score for label_class 1: 0.9506
2024-08-15 17:46:34,341 : INFO : Precision score for label_class 2: 0.9179
2024-08-15 17:46:34,341 : INFO : Recall score for label_class 0: 0.8869
2024-08-15 17:46:34,341 : INFO : Recall score for label_class 1: 0.9611
2024-08-15 17:46:34,341 : INFO : Recall score for label_class 2: 0.8788
2024-08-15 17:46:34,341 : INFO : Average F1 score: 0.9074
2024-08-15 17:46:34,810 : INFO : Average loss over validation batches: 0.3854
2024-08-15 17:46:34,811 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:34,811 : INFO : Validation metrics:
2024-08-15 17:46:34,811 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:34,814 : INFO : Accuracy: 0.8650
2024-08-15 17:46:34,814 : INFO : Precision score for label_class 0: 0.7292
2024-08-15 17:46:34,814 : INFO : Precision score for label_class 1: 0.9305
2024-08-15 17:46:34,814 : INFO : Precision score for label_class 2: 0.8088
2024-08-15 17:46:34,814 : INFO : Recall score for label_class 0: 0.8046
2024-08-15 17:46:34,814 : INFO : Recall score for label_class 1: 0.8923
2024-08-15 17:46:34,814 : INFO : Recall score for label_class 2: 0.8376
2024-08-15 17:46:34,814 : INFO : Average F1 score: 0.8330
2024-08-15 17:46:34,814 : INFO : Validation metric decreased (0.405204 --> 0.385418).  Saving model ...
2024-08-15 17:46:34,916 : INFO : Starting epoch 5
2024-08-15 17:46:34,968 : INFO : Current training batch loss: 0.1857 in epoch 5
2024-08-15 17:46:35,783 : INFO : Current training batch loss: 0.4009 in epoch 5
2024-08-15 17:46:36,598 : INFO : Current training batch loss: 0.1694 in epoch 5
2024-08-15 17:46:37,416 : INFO : Current training batch loss: 0.2489 in epoch 5
2024-08-15 17:46:38,235 : INFO : Current training batch loss: 0.2542 in epoch 5
2024-08-15 17:46:38,387 : INFO : Epoch finished, average loss over training batches: 0.2223
2024-08-15 17:46:38,387 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:38,387 : INFO : Training metrics:
2024-08-15 17:46:38,387 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:38,395 : INFO : Accuracy: 0.9478
2024-08-15 17:46:38,395 : INFO : Precision score for label_class 0: 0.8872
2024-08-15 17:46:38,395 : INFO : Precision score for label_class 1: 0.9672
2024-08-15 17:46:38,395 : INFO : Precision score for label_class 2: 0.9330
2024-08-15 17:46:38,395 : INFO : Recall score for label_class 0: 0.9144
2024-08-15 17:46:38,395 : INFO : Recall score for label_class 1: 0.9642
2024-08-15 17:46:38,395 : INFO : Recall score for label_class 2: 0.9268
2024-08-15 17:46:38,395 : INFO : Average F1 score: 0.9321
2024-08-15 17:46:38,873 : INFO : Average loss over validation batches: 0.3768
2024-08-15 17:46:38,873 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:38,873 : INFO : Validation metrics:
2024-08-15 17:46:38,873 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:38,877 : INFO : Accuracy: 0.8709
2024-08-15 17:46:38,877 : INFO : Precision score for label_class 0: 0.7778
2024-08-15 17:46:38,877 : INFO : Precision score for label_class 1: 0.8936
2024-08-15 17:46:38,877 : INFO : Precision score for label_class 2: 0.8667
2024-08-15 17:46:38,877 : INFO : Recall score for label_class 0: 0.8046
2024-08-15 17:46:38,877 : INFO : Recall score for label_class 1: 0.9256
2024-08-15 17:46:38,877 : INFO : Recall score for label_class 2: 0.7919
2024-08-15 17:46:38,877 : INFO : Average F1 score: 0.8426
2024-08-15 17:46:38,877 : INFO : Validation metric decreased (0.385418 --> 0.376764).  Saving model ...
2024-08-15 17:46:38,981 : INFO : Split 4 is finished, the score is: 0.8426
2024-08-15 17:46:38,981 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:38,981 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:38,981 : INFO : Starting training for split 5
2024-08-15 17:46:38,994 : INFO : Starting to tokenize the sequences.
2024-08-15 17:46:38,999 : INFO : Tokenization is finished.
2024-08-15 17:46:39,017 : INFO : Starting to tokenize the sequences.
2024-08-15 17:46:39,022 : INFO : Tokenization is finished.
2024-08-15 17:46:39,026 : INFO : Counting occurences of labels...
2024-08-15 17:46:39,027 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 330, 1615,  754]))
2024-08-15 17:46:39,028 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 84, 396, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:46:39,069 : INFO : Starting epoch 1
2024-08-15 17:46:39,121 : INFO : Current training batch loss: 1.0910 in epoch 1
2024-08-15 17:46:39,944 : INFO : Current training batch loss: 1.0540 in epoch 1
2024-08-15 17:46:40,759 : INFO : Current training batch loss: 0.9417 in epoch 1
2024-08-15 17:46:41,573 : INFO : Current training batch loss: 0.8583 in epoch 1
2024-08-15 17:46:42,389 : INFO : Current training batch loss: 0.8199 in epoch 1
2024-08-15 17:46:42,539 : INFO : Epoch finished, average loss over training batches: 0.9269
2024-08-15 17:46:42,539 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:42,539 : INFO : Training metrics:
2024-08-15 17:46:42,539 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:42,550 : INFO : Accuracy: 0.6154
2024-08-15 17:46:42,550 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:46:42,551 : INFO : Precision score for label_class 1: 0.6363
2024-08-15 17:46:42,551 : INFO : Precision score for label_class 2: 0.4459
2024-08-15 17:46:42,551 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:46:42,551 : INFO : Recall score for label_class 1: 0.9467
2024-08-15 17:46:42,551 : INFO : Recall score for label_class 2: 0.1751
2024-08-15 17:46:42,551 : INFO : Average F1 score: 0.3375
2024-08-15 17:46:43,016 : INFO : Average loss over validation batches: 0.6910
2024-08-15 17:46:43,017 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:43,017 : INFO : Validation metrics:
2024-08-15 17:46:43,017 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:43,020 : INFO : Accuracy: 0.7270
2024-08-15 17:46:43,020 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:46:43,020 : INFO : Precision score for label_class 1: 0.7840
2024-08-15 17:46:43,020 : INFO : Precision score for label_class 2: 0.5798
2024-08-15 17:46:43,020 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:46:43,020 : INFO : Recall score for label_class 1: 0.9621
2024-08-15 17:46:43,020 : INFO : Recall score for label_class 2: 0.5619
2024-08-15 17:46:43,020 : INFO : Average F1 score: 0.4782
2024-08-15 17:46:43,020 : INFO : Validation metric decreased (inf --> 0.691017).  Saving model ...
2024-08-15 17:46:43,120 : INFO : Starting epoch 2
2024-08-15 17:46:43,774 : INFO : Current training batch loss: 0.6481 in epoch 2
2024-08-15 17:46:44,588 : INFO : Current training batch loss: 0.5302 in epoch 2
2024-08-15 17:46:45,402 : INFO : Current training batch loss: 0.4211 in epoch 2
2024-08-15 17:46:46,218 : INFO : Current training batch loss: 0.4406 in epoch 2
2024-08-15 17:46:46,569 : INFO : Epoch finished, average loss over training batches: 0.5527
2024-08-15 17:46:46,569 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:46,569 : INFO : Training metrics:
2024-08-15 17:46:46,569 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:46,577 : INFO : Accuracy: 0.8210
2024-08-15 17:46:46,577 : INFO : Precision score for label_class 0: 0.8051
2024-08-15 17:46:46,577 : INFO : Precision score for label_class 1: 0.8505
2024-08-15 17:46:46,577 : INFO : Precision score for label_class 2: 0.7504
2024-08-15 17:46:46,577 : INFO : Recall score for label_class 0: 0.4758
2024-08-15 17:46:46,577 : INFO : Recall score for label_class 1: 0.9474
2024-08-15 17:46:46,577 : INFO : Recall score for label_class 2: 0.7016
2024-08-15 17:46:46,577 : INFO : Average F1 score: 0.7399
2024-08-15 17:46:47,041 : INFO : Average loss over validation batches: 0.4908
2024-08-15 17:46:47,041 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:47,041 : INFO : Validation metrics:
2024-08-15 17:46:47,041 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:47,045 : INFO : Accuracy: 0.8294
2024-08-15 17:46:47,045 : INFO : Precision score for label_class 0: 0.7941
2024-08-15 17:46:47,045 : INFO : Precision score for label_class 1: 0.8311
2024-08-15 17:46:47,045 : INFO : Precision score for label_class 2: 0.8400
2024-08-15 17:46:47,045 : INFO : Recall score for label_class 0: 0.6429
2024-08-15 17:46:47,045 : INFO : Recall score for label_class 1: 0.9571
2024-08-15 17:46:47,045 : INFO : Recall score for label_class 2: 0.6495
2024-08-15 17:46:47,045 : INFO : Average F1 score: 0.7776
2024-08-15 17:46:47,045 : INFO : Validation metric decreased (0.691017 --> 0.490849).  Saving model ...
2024-08-15 17:46:47,147 : INFO : Starting epoch 3
2024-08-15 17:46:47,600 : INFO : Current training batch loss: 0.3474 in epoch 3
2024-08-15 17:46:48,414 : INFO : Current training batch loss: 0.4582 in epoch 3
2024-08-15 17:46:49,229 : INFO : Current training batch loss: 0.3449 in epoch 3
2024-08-15 17:46:50,043 : INFO : Current training batch loss: 0.2817 in epoch 3
2024-08-15 17:46:50,597 : INFO : Epoch finished, average loss over training batches: 0.3490
2024-08-15 17:46:50,597 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:50,597 : INFO : Training metrics:
2024-08-15 17:46:50,597 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:50,605 : INFO : Accuracy: 0.9022
2024-08-15 17:46:50,605 : INFO : Precision score for label_class 0: 0.8328
2024-08-15 17:46:50,605 : INFO : Precision score for label_class 1: 0.9246
2024-08-15 17:46:50,605 : INFO : Precision score for label_class 2: 0.8818
2024-08-15 17:46:50,605 : INFO : Recall score for label_class 0: 0.8152
2024-08-15 17:46:50,605 : INFO : Recall score for label_class 1: 0.9486
2024-08-15 17:46:50,605 : INFO : Recall score for label_class 2: 0.8408
2024-08-15 17:46:50,605 : INFO : Average F1 score: 0.8737
2024-08-15 17:46:51,072 : INFO : Average loss over validation batches: 0.4121
2024-08-15 17:46:51,072 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:51,072 : INFO : Validation metrics:
2024-08-15 17:46:51,072 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:51,075 : INFO : Accuracy: 0.8487
2024-08-15 17:46:51,075 : INFO : Precision score for label_class 0: 0.7662
2024-08-15 17:46:51,075 : INFO : Precision score for label_class 1: 0.8738
2024-08-15 17:46:51,075 : INFO : Precision score for label_class 2: 0.8249
2024-08-15 17:46:51,075 : INFO : Recall score for label_class 0: 0.7024
2024-08-15 17:46:51,075 : INFO : Recall score for label_class 1: 0.9268
2024-08-15 17:46:51,075 : INFO : Recall score for label_class 2: 0.7526
2024-08-15 17:46:51,075 : INFO : Average F1 score: 0.8065
2024-08-15 17:46:51,075 : INFO : Validation metric decreased (0.490849 --> 0.412125).  Saving model ...
2024-08-15 17:46:51,177 : INFO : Starting epoch 4
2024-08-15 17:46:51,429 : INFO : Current training batch loss: 0.4181 in epoch 4
2024-08-15 17:46:52,243 : INFO : Current training batch loss: 0.3928 in epoch 4
2024-08-15 17:46:53,059 : INFO : Current training batch loss: 0.2386 in epoch 4
2024-08-15 17:46:53,882 : INFO : Current training batch loss: 0.1445 in epoch 4
2024-08-15 17:46:54,660 : INFO : Epoch finished, average loss over training batches: 0.2477
2024-08-15 17:46:54,661 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:54,661 : INFO : Training metrics:
2024-08-15 17:46:54,661 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:54,671 : INFO : Accuracy: 0.9411
2024-08-15 17:46:54,671 : INFO : Precision score for label_class 0: 0.8886
2024-08-15 17:46:54,671 : INFO : Precision score for label_class 1: 0.9560
2024-08-15 17:46:54,671 : INFO : Precision score for label_class 2: 0.9317
2024-08-15 17:46:54,671 : INFO : Recall score for label_class 0: 0.8939
2024-08-15 17:46:54,671 : INFO : Recall score for label_class 1: 0.9678
2024-08-15 17:46:54,671 : INFO : Recall score for label_class 2: 0.9045
2024-08-15 17:46:54,671 : INFO : Average F1 score: 0.9237
2024-08-15 17:46:55,138 : INFO : Average loss over validation batches: 0.3919
2024-08-15 17:46:55,138 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:55,138 : INFO : Validation metrics:
2024-08-15 17:46:55,138 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:55,142 : INFO : Accuracy: 0.8576
2024-08-15 17:46:55,142 : INFO : Precision score for label_class 0: 0.7805
2024-08-15 17:46:55,142 : INFO : Precision score for label_class 1: 0.9169
2024-08-15 17:46:55,142 : INFO : Precision score for label_class 2: 0.7778
2024-08-15 17:46:55,142 : INFO : Recall score for label_class 0: 0.7619
2024-08-15 17:46:55,142 : INFO : Recall score for label_class 1: 0.8914
2024-08-15 17:46:55,142 : INFO : Recall score for label_class 2: 0.8299
2024-08-15 17:46:55,142 : INFO : Average F1 score: 0.8260
2024-08-15 17:46:55,142 : INFO : Validation metric decreased (0.412125 --> 0.391918).  Saving model ...
2024-08-15 17:46:55,244 : INFO : Starting epoch 5
2024-08-15 17:46:55,294 : INFO : Current training batch loss: 0.1434 in epoch 5
2024-08-15 17:46:56,116 : INFO : Current training batch loss: 0.2924 in epoch 5
2024-08-15 17:46:56,931 : INFO : Current training batch loss: 0.1576 in epoch 5
2024-08-15 17:46:57,750 : INFO : Current training batch loss: 0.2115 in epoch 5
2024-08-15 17:46:58,567 : INFO : Current training batch loss: 0.1144 in epoch 5
2024-08-15 17:46:58,718 : INFO : Epoch finished, average loss over training batches: 0.1957
2024-08-15 17:46:58,719 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:58,719 : INFO : Training metrics:
2024-08-15 17:46:58,719 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:58,726 : INFO : Accuracy: 0.9578
2024-08-15 17:46:58,726 : INFO : Precision score for label_class 0: 0.9072
2024-08-15 17:46:58,726 : INFO : Precision score for label_class 1: 0.9717
2024-08-15 17:46:58,726 : INFO : Precision score for label_class 2: 0.9499
2024-08-15 17:46:58,726 : INFO : Recall score for label_class 0: 0.9182
2024-08-15 17:46:58,726 : INFO : Recall score for label_class 1: 0.9783
2024-08-15 17:46:58,726 : INFO : Recall score for label_class 2: 0.9310
2024-08-15 17:46:58,726 : INFO : Average F1 score: 0.9427
2024-08-15 17:46:59,195 : INFO : Average loss over validation batches: 0.3895
2024-08-15 17:46:59,195 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:59,195 : INFO : Validation metrics:
2024-08-15 17:46:59,195 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:59,198 : INFO : Accuracy: 0.8605
2024-08-15 17:46:59,198 : INFO : Precision score for label_class 0: 0.7901
2024-08-15 17:46:59,198 : INFO : Precision score for label_class 1: 0.9002
2024-08-15 17:46:59,198 : INFO : Precision score for label_class 2: 0.8073
2024-08-15 17:46:59,198 : INFO : Recall score for label_class 0: 0.7619
2024-08-15 17:46:59,198 : INFO : Recall score for label_class 1: 0.9116
2024-08-15 17:46:59,198 : INFO : Recall score for label_class 2: 0.7990
2024-08-15 17:46:59,198 : INFO : Average F1 score: 0.8283
2024-08-15 17:46:59,198 : INFO : Validation metric decreased (0.391918 --> 0.389538).  Saving model ...
2024-08-15 17:46:59,304 : INFO : Split 5 is finished, the score is: 0.8283
2024-08-15 17:46:59,304 : INFO : ----------------------------------------------------------------------------------------------------
[I 2024-08-15 17:46:59,313] Trial 22 finished with value: 0.8460524973013095 and parameters: {'n_epochs': 5, 'learning_rate': 2.6756805967721655e-05, 'classifier_dropout': 0.6614239692739338, 'warmup_step_fraction': 0.09993190895718307, 'use_gradient_clipping': False}. Best is trial 1 with value: 0.8513001269595835.
2024-08-15 17:46:59,322 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:46:59,322 : INFO : Starting training for split 1
2024-08-15 17:46:59,334 : INFO : Starting to tokenize the sequences.
2024-08-15 17:46:59,339 : INFO : Tokenization is finished.
2024-08-15 17:46:59,351 : INFO : Starting to tokenize the sequences.
2024-08-15 17:46:59,356 : INFO : Tokenization is finished.
2024-08-15 17:46:59,356 : INFO : Counting occurences of labels...
2024-08-15 17:46:59,357 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1596,  774]))
2024-08-15 17:46:59,357 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 415, 174]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:46:59,399 : INFO : Starting epoch 1
2024-08-15 17:46:59,450 : INFO : Current training batch loss: 1.1067 in epoch 1
2024-08-15 17:47:00,268 : INFO : Current training batch loss: 1.0430 in epoch 1
2024-08-15 17:47:01,086 : INFO : Current training batch loss: 1.0284 in epoch 1
2024-08-15 17:47:01,917 : INFO : Current training batch loss: 0.9286 in epoch 1
2024-08-15 17:47:02,757 : INFO : Current training batch loss: 0.9105 in epoch 1
2024-08-15 17:47:02,915 : INFO : Epoch finished, average loss over training batches: 0.9929
2024-08-15 17:47:02,915 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:02,915 : INFO : Training metrics:
2024-08-15 17:47:02,915 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:02,924 : INFO : Accuracy: 0.5467
2024-08-15 17:47:02,924 : INFO : Precision score for label_class 0: 0.1364
2024-08-15 17:47:02,924 : INFO : Precision score for label_class 1: 0.5948
2024-08-15 17:47:02,924 : INFO : Precision score for label_class 2: 0.3226
2024-08-15 17:47:02,924 : INFO : Recall score for label_class 0: 0.0183
2024-08-15 17:47:02,924 : INFO : Recall score for label_class 1: 0.8390
2024-08-15 17:47:02,924 : INFO : Recall score for label_class 2: 0.1680
2024-08-15 17:47:02,924 : INFO : Average F1 score: 0.3164
2024-08-15 17:47:03,411 : INFO : Average loss over validation batches: 0.8761
2024-08-15 17:47:03,411 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:03,411 : INFO : Validation metrics:
2024-08-15 17:47:03,411 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:03,414 : INFO : Accuracy: 0.6593
2024-08-15 17:47:03,414 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:47:03,414 : INFO : Precision score for label_class 1: 0.6781
2024-08-15 17:47:03,414 : INFO : Precision score for label_class 2: 0.4762
2024-08-15 17:47:03,414 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:47:03,414 : INFO : Recall score for label_class 1: 1.0000
2024-08-15 17:47:03,414 : INFO : Recall score for label_class 2: 0.1724
2024-08-15 17:47:03,414 : INFO : Average F1 score: 0.3538
2024-08-15 17:47:03,414 : INFO : Validation metric decreased (inf --> 0.876148).  Saving model ...
2024-08-15 17:47:03,517 : INFO : Starting epoch 2
2024-08-15 17:47:04,169 : INFO : Current training batch loss: 0.7387 in epoch 2
2024-08-15 17:47:04,997 : INFO : Current training batch loss: 0.8100 in epoch 2
2024-08-15 17:47:05,835 : INFO : Current training batch loss: 0.7719 in epoch 2
2024-08-15 17:47:06,653 : INFO : Current training batch loss: 0.6473 in epoch 2
2024-08-15 17:47:07,016 : INFO : Epoch finished, average loss over training batches: 0.8044
2024-08-15 17:47:07,016 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:07,016 : INFO : Training metrics:
2024-08-15 17:47:07,016 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:07,021 : INFO : Accuracy: 0.6924
2024-08-15 17:47:07,021 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:47:07,021 : INFO : Precision score for label_class 1: 0.7224
2024-08-15 17:47:07,021 : INFO : Precision score for label_class 2: 0.5735
2024-08-15 17:47:07,021 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:47:07,021 : INFO : Recall score for label_class 1: 0.9749
2024-08-15 17:47:07,021 : INFO : Recall score for label_class 2: 0.4031
2024-08-15 17:47:07,021 : INFO : Average F1 score: 0.4344
2024-08-15 17:47:07,488 : INFO : Average loss over validation batches: 0.7538
2024-08-15 17:47:07,489 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:07,489 : INFO : Validation metrics:
2024-08-15 17:47:07,489 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:07,491 : INFO : Accuracy: 0.7111
2024-08-15 17:47:07,491 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:47:07,491 : INFO : Precision score for label_class 1: 0.8029
2024-08-15 17:47:07,491 : INFO : Precision score for label_class 2: 0.4899
2024-08-15 17:47:07,491 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:47:07,491 : INFO : Recall score for label_class 1: 0.9229
2024-08-15 17:47:07,491 : INFO : Recall score for label_class 2: 0.5575
2024-08-15 17:47:07,491 : INFO : Average F1 score: 0.4601
2024-08-15 17:47:07,491 : INFO : Validation metric decreased (0.876148 --> 0.753808).  Saving model ...
2024-08-15 17:47:07,597 : INFO : Starting epoch 3
2024-08-15 17:47:08,067 : INFO : Current training batch loss: 0.7065 in epoch 3
2024-08-15 17:47:08,911 : INFO : Current training batch loss: 0.7616 in epoch 3
2024-08-15 17:47:09,761 : INFO : Current training batch loss: 0.7163 in epoch 3
2024-08-15 17:47:10,603 : INFO : Current training batch loss: 0.6110 in epoch 3
2024-08-15 17:47:11,179 : INFO : Epoch finished, average loss over training batches: 0.7110
2024-08-15 17:47:11,180 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:11,180 : INFO : Training metrics:
2024-08-15 17:47:11,180 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:11,184 : INFO : Accuracy: 0.7346
2024-08-15 17:47:11,184 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:47:11,184 : INFO : Precision score for label_class 1: 0.7849
2024-08-15 17:47:11,184 : INFO : Precision score for label_class 2: 0.5983
2024-08-15 17:47:11,184 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:47:11,184 : INFO : Recall score for label_class 1: 0.9693
2024-08-15 17:47:11,184 : INFO : Recall score for label_class 2: 0.5620
2024-08-15 17:47:11,184 : INFO : Average F1 score: 0.4823
2024-08-15 17:47:11,654 : INFO : Average loss over validation batches: 0.7236
2024-08-15 17:47:11,654 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:11,654 : INFO : Validation metrics:
2024-08-15 17:47:11,654 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:11,657 : INFO : Accuracy: 0.7244
2024-08-15 17:47:11,657 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:47:11,657 : INFO : Precision score for label_class 1: 0.8170
2024-08-15 17:47:11,657 : INFO : Precision score for label_class 2: 0.5122
2024-08-15 17:47:11,657 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:47:11,657 : INFO : Recall score for label_class 1: 0.9253
2024-08-15 17:47:11,657 : INFO : Recall score for label_class 2: 0.6034
2024-08-15 17:47:11,657 : INFO : Average F1 score: 0.4740
2024-08-15 17:47:11,657 : INFO : Validation metric decreased (0.753808 --> 0.723592).  Saving model ...
2024-08-15 17:47:11,759 : INFO : Split 1 is finished, the score is: 0.4740
2024-08-15 17:47:11,759 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:11,759 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:11,759 : INFO : Starting training for split 2
2024-08-15 17:47:11,774 : INFO : Starting to tokenize the sequences.
2024-08-15 17:47:11,780 : INFO : Tokenization is finished.
2024-08-15 17:47:11,799 : INFO : Starting to tokenize the sequences.
2024-08-15 17:47:11,804 : INFO : Tokenization is finished.
2024-08-15 17:47:11,809 : INFO : Counting occurences of labels...
2024-08-15 17:47:11,810 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 343, 1601,  754]))
2024-08-15 17:47:11,811 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 71, 410, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:47:11,852 : INFO : Starting epoch 1
2024-08-15 17:47:11,903 : INFO : Current training batch loss: 1.0919 in epoch 1
2024-08-15 17:47:12,767 : INFO : Current training batch loss: 1.0585 in epoch 1
2024-08-15 17:47:13,613 : INFO : Current training batch loss: 1.0269 in epoch 1
2024-08-15 17:47:14,444 : INFO : Current training batch loss: 0.9243 in epoch 1
2024-08-15 17:47:15,261 : INFO : Current training batch loss: 0.9179 in epoch 1
2024-08-15 17:47:15,418 : INFO : Epoch finished, average loss over training batches: 0.9831
2024-08-15 17:47:15,419 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:15,419 : INFO : Training metrics:
2024-08-15 17:47:15,419 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:15,429 : INFO : Accuracy: 0.5593
2024-08-15 17:47:15,430 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:47:15,430 : INFO : Precision score for label_class 1: 0.6025
2024-08-15 17:47:15,430 : INFO : Precision score for label_class 2: 0.2966
2024-08-15 17:47:15,430 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:47:15,430 : INFO : Recall score for label_class 1: 0.8720
2024-08-15 17:47:15,430 : INFO : Recall score for label_class 2: 0.1499
2024-08-15 17:47:15,430 : INFO : Average F1 score: 0.3039
2024-08-15 17:47:15,903 : INFO : Average loss over validation batches: 0.8600
2024-08-15 17:47:15,903 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:15,903 : INFO : Validation metrics:
2024-08-15 17:47:15,903 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:15,907 : INFO : Accuracy: 0.6696
2024-08-15 17:47:15,907 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:47:15,907 : INFO : Precision score for label_class 1: 0.6886
2024-08-15 17:47:15,907 : INFO : Precision score for label_class 2: 0.5567
2024-08-15 17:47:15,907 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:47:15,907 : INFO : Recall score for label_class 1: 0.9707
2024-08-15 17:47:15,907 : INFO : Recall score for label_class 2: 0.2784
2024-08-15 17:47:15,907 : INFO : Average F1 score: 0.3923
2024-08-15 17:47:15,907 : INFO : Validation metric decreased (inf --> 0.859954).  Saving model ...
2024-08-15 17:47:16,008 : INFO : Starting epoch 2
2024-08-15 17:47:16,692 : INFO : Current training batch loss: 0.8426 in epoch 2
2024-08-15 17:47:17,524 : INFO : Current training batch loss: 0.8008 in epoch 2
2024-08-15 17:47:18,365 : INFO : Current training batch loss: 0.7546 in epoch 2
2024-08-15 17:47:19,192 : INFO : Current training batch loss: 0.6378 in epoch 2
2024-08-15 17:47:19,552 : INFO : Epoch finished, average loss over training batches: 0.7868
2024-08-15 17:47:19,553 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:19,553 : INFO : Training metrics:
2024-08-15 17:47:19,553 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:19,560 : INFO : Accuracy: 0.7024
2024-08-15 17:47:19,560 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:47:19,560 : INFO : Precision score for label_class 1: 0.7490
2024-08-15 17:47:19,560 : INFO : Precision score for label_class 2: 0.5517
2024-08-15 17:47:19,560 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:47:19,560 : INFO : Recall score for label_class 1: 0.9638
2024-08-15 17:47:19,560 : INFO : Recall score for label_class 2: 0.4668
2024-08-15 17:47:19,560 : INFO : Average F1 score: 0.4496
2024-08-15 17:47:20,026 : INFO : Average loss over validation batches: 0.7304
2024-08-15 17:47:20,026 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:20,026 : INFO : Validation metrics:
2024-08-15 17:47:20,026 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:20,030 : INFO : Accuracy: 0.7363
2024-08-15 17:47:20,030 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:47:20,030 : INFO : Precision score for label_class 1: 0.7966
2024-08-15 17:47:20,030 : INFO : Precision score for label_class 2: 0.5909
2024-08-15 17:47:20,030 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:47:20,030 : INFO : Recall score for label_class 1: 0.9268
2024-08-15 17:47:20,030 : INFO : Recall score for label_class 2: 0.6031
2024-08-15 17:47:20,030 : INFO : Average F1 score: 0.4846
2024-08-15 17:47:20,030 : INFO : Validation metric decreased (0.859954 --> 0.730379).  Saving model ...
2024-08-15 17:47:20,131 : INFO : Starting epoch 3
2024-08-15 17:47:20,612 : INFO : Current training batch loss: 0.7212 in epoch 3
2024-08-15 17:47:21,429 : INFO : Current training batch loss: 0.7114 in epoch 3
2024-08-15 17:47:22,275 : INFO : Current training batch loss: 0.6805 in epoch 3
2024-08-15 17:47:23,124 : INFO : Current training batch loss: 0.5885 in epoch 3
2024-08-15 17:47:23,681 : INFO : Epoch finished, average loss over training batches: 0.6860
2024-08-15 17:47:23,681 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:23,682 : INFO : Training metrics:
2024-08-15 17:47:23,682 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:23,689 : INFO : Accuracy: 0.7428
2024-08-15 17:47:23,689 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:47:23,689 : INFO : Precision score for label_class 1: 0.8141
2024-08-15 17:47:23,689 : INFO : Precision score for label_class 2: 0.5765
2024-08-15 17:47:23,689 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:47:23,689 : INFO : Recall score for label_class 1: 0.9600
2024-08-15 17:47:23,689 : INFO : Recall score for label_class 2: 0.6194
2024-08-15 17:47:23,689 : INFO : Average F1 score: 0.4927
2024-08-15 17:47:24,154 : INFO : Average loss over validation batches: 0.6801
2024-08-15 17:47:24,154 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:24,154 : INFO : Validation metrics:
2024-08-15 17:47:24,154 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:24,158 : INFO : Accuracy: 0.7556
2024-08-15 17:47:24,158 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:47:24,158 : INFO : Precision score for label_class 1: 0.8126
2024-08-15 17:47:24,158 : INFO : Precision score for label_class 2: 0.6200
2024-08-15 17:47:24,158 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:47:24,158 : INFO : Recall score for label_class 1: 0.9415
2024-08-15 17:47:24,158 : INFO : Recall score for label_class 2: 0.6392
2024-08-15 17:47:24,158 : INFO : Average F1 score: 0.5006
2024-08-15 17:47:24,158 : INFO : Validation metric decreased (0.730379 --> 0.680072).  Saving model ...
2024-08-15 17:47:24,265 : INFO : Split 2 is finished, the score is: 0.5006
2024-08-15 17:47:24,266 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:24,266 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:24,266 : INFO : Starting training for split 3
2024-08-15 17:47:24,280 : INFO : Starting to tokenize the sequences.
2024-08-15 17:47:24,287 : INFO : Tokenization is finished.
2024-08-15 17:47:24,307 : INFO : Starting to tokenize the sequences.
2024-08-15 17:47:24,312 : INFO : Tokenization is finished.
2024-08-15 17:47:24,317 : INFO : Counting occurences of labels...
2024-08-15 17:47:24,318 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1611,  759]))
2024-08-15 17:47:24,318 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 400, 189]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:47:24,452 : INFO : Starting epoch 1
2024-08-15 17:47:24,504 : INFO : Current training batch loss: 1.1070 in epoch 1
2024-08-15 17:47:25,330 : INFO : Current training batch loss: 1.0648 in epoch 1
2024-08-15 17:47:26,157 : INFO : Current training batch loss: 0.9853 in epoch 1
2024-08-15 17:47:26,986 : INFO : Current training batch loss: 0.9484 in epoch 1
2024-08-15 17:47:27,807 : INFO : Current training batch loss: 0.8984 in epoch 1
2024-08-15 17:47:27,965 : INFO : Epoch finished, average loss over training batches: 0.9983
2024-08-15 17:47:27,966 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:27,966 : INFO : Training metrics:
2024-08-15 17:47:27,966 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:27,975 : INFO : Accuracy: 0.5419
2024-08-15 17:47:27,975 : INFO : Precision score for label_class 0: 0.1923
2024-08-15 17:47:27,975 : INFO : Precision score for label_class 1: 0.5900
2024-08-15 17:47:27,975 : INFO : Precision score for label_class 2: 0.2688
2024-08-15 17:47:27,975 : INFO : Recall score for label_class 0: 0.0152
2024-08-15 17:47:27,975 : INFO : Recall score for label_class 1: 0.8423
2024-08-15 17:47:27,975 : INFO : Recall score for label_class 2: 0.1318
2024-08-15 17:47:27,975 : INFO : Average F1 score: 0.2997
2024-08-15 17:47:28,456 : INFO : Average loss over validation batches: 0.8963
2024-08-15 17:47:28,456 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:28,456 : INFO : Validation metrics:
2024-08-15 17:47:28,456 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:28,459 : INFO : Accuracy: 0.6178
2024-08-15 17:47:28,459 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:47:28,460 : INFO : Precision score for label_class 1: 0.6098
2024-08-15 17:47:28,460 : INFO : Precision score for label_class 2: 0.8947
2024-08-15 17:47:28,460 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:47:28,460 : INFO : Recall score for label_class 1: 1.0000
2024-08-15 17:47:28,460 : INFO : Recall score for label_class 2: 0.0899
2024-08-15 17:47:28,460 : INFO : Average F1 score: 0.3070
2024-08-15 17:47:28,460 : INFO : Validation metric decreased (inf --> 0.896283).  Saving model ...
2024-08-15 17:47:28,566 : INFO : Starting epoch 2
2024-08-15 17:47:29,220 : INFO : Current training batch loss: 0.8728 in epoch 2
2024-08-15 17:47:30,042 : INFO : Current training batch loss: 0.8138 in epoch 2
2024-08-15 17:47:30,854 : INFO : Current training batch loss: 0.7752 in epoch 2
2024-08-15 17:47:31,666 : INFO : Current training batch loss: 0.6549 in epoch 2
2024-08-15 17:47:32,012 : INFO : Epoch finished, average loss over training batches: 0.7967
2024-08-15 17:47:32,012 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:32,012 : INFO : Training metrics:
2024-08-15 17:47:32,012 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:32,021 : INFO : Accuracy: 0.7098
2024-08-15 17:47:32,021 : INFO : Precision score for label_class 0: 0.8667
2024-08-15 17:47:32,021 : INFO : Precision score for label_class 1: 0.7372
2024-08-15 17:47:32,021 : INFO : Precision score for label_class 2: 0.6018
2024-08-15 17:47:32,021 : INFO : Recall score for label_class 0: 0.0396
2024-08-15 17:47:32,021 : INFO : Recall score for label_class 1: 0.9714
2024-08-15 17:47:32,021 : INFO : Recall score for label_class 2: 0.4440
2024-08-15 17:47:32,021 : INFO : Average F1 score: 0.4750
2024-08-15 17:47:32,488 : INFO : Average loss over validation batches: 0.7273
2024-08-15 17:47:32,488 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:32,488 : INFO : Validation metrics:
2024-08-15 17:47:32,488 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:32,491 : INFO : Accuracy: 0.7807
2024-08-15 17:47:32,491 : INFO : Precision score for label_class 0: 0.9630
2024-08-15 17:47:32,491 : INFO : Precision score for label_class 1: 0.8102
2024-08-15 17:47:32,491 : INFO : Precision score for label_class 2: 0.6760
2024-08-15 17:47:32,491 : INFO : Recall score for label_class 0: 0.3023
2024-08-15 17:47:32,491 : INFO : Recall score for label_class 1: 0.9500
2024-08-15 17:47:32,491 : INFO : Recall score for label_class 2: 0.6402
2024-08-15 17:47:32,491 : INFO : Average F1 score: 0.6641
2024-08-15 17:47:32,491 : INFO : Validation metric decreased (0.896283 --> 0.727310).  Saving model ...
2024-08-15 17:47:32,594 : INFO : Starting epoch 3
2024-08-15 17:47:33,045 : INFO : Current training batch loss: 0.7524 in epoch 3
2024-08-15 17:47:33,855 : INFO : Current training batch loss: 0.6572 in epoch 3
2024-08-15 17:47:34,666 : INFO : Current training batch loss: 0.6789 in epoch 3
2024-08-15 17:47:35,477 : INFO : Current training batch loss: 0.5829 in epoch 3
2024-08-15 17:47:36,019 : INFO : Epoch finished, average loss over training batches: 0.6799
2024-08-15 17:47:36,020 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:36,020 : INFO : Training metrics:
2024-08-15 17:47:36,020 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:36,026 : INFO : Accuracy: 0.8113
2024-08-15 17:47:36,026 : INFO : Precision score for label_class 0: 0.8805
2024-08-15 17:47:36,026 : INFO : Precision score for label_class 1: 0.8190
2024-08-15 17:47:36,026 : INFO : Precision score for label_class 2: 0.7720
2024-08-15 17:47:36,026 : INFO : Recall score for label_class 0: 0.4268
2024-08-15 17:47:36,026 : INFO : Recall score for label_class 1: 0.9609
2024-08-15 17:47:36,026 : INFO : Recall score for label_class 2: 0.6601
2024-08-15 17:47:36,026 : INFO : Average F1 score: 0.7236
2024-08-15 17:47:36,492 : INFO : Average loss over validation batches: 0.6688
2024-08-15 17:47:36,492 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:36,492 : INFO : Validation metrics:
2024-08-15 17:47:36,492 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:36,494 : INFO : Accuracy: 0.8163
2024-08-15 17:47:36,494 : INFO : Precision score for label_class 0: 0.9762
2024-08-15 17:47:36,494 : INFO : Precision score for label_class 1: 0.8326
2024-08-15 17:47:36,494 : INFO : Precision score for label_class 2: 0.7374
2024-08-15 17:47:36,495 : INFO : Recall score for label_class 0: 0.4767
2024-08-15 17:47:36,495 : INFO : Recall score for label_class 1: 0.9450
2024-08-15 17:47:36,495 : INFO : Recall score for label_class 2: 0.6984
2024-08-15 17:47:36,495 : INFO : Average F1 score: 0.7478
2024-08-15 17:47:36,495 : INFO : Validation metric decreased (0.727310 --> 0.668786).  Saving model ...
2024-08-15 17:47:36,598 : INFO : Split 3 is finished, the score is: 0.7478
2024-08-15 17:47:36,599 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:36,599 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:36,599 : INFO : Starting training for split 4
2024-08-15 17:47:36,612 : INFO : Starting to tokenize the sequences.
2024-08-15 17:47:36,618 : INFO : Tokenization is finished.
2024-08-15 17:47:36,634 : INFO : Starting to tokenize the sequences.
2024-08-15 17:47:36,639 : INFO : Tokenization is finished.
2024-08-15 17:47:36,643 : INFO : Counting occurences of labels...
2024-08-15 17:47:36,644 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 327, 1621,  751]))
2024-08-15 17:47:36,645 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 87, 390, 197]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:47:36,686 : INFO : Starting epoch 1
2024-08-15 17:47:36,737 : INFO : Current training batch loss: 1.1006 in epoch 1
2024-08-15 17:47:37,547 : INFO : Current training batch loss: 1.0657 in epoch 1
2024-08-15 17:47:38,357 : INFO : Current training batch loss: 0.9788 in epoch 1
2024-08-15 17:47:39,167 : INFO : Current training batch loss: 0.9195 in epoch 1
2024-08-15 17:47:39,976 : INFO : Current training batch loss: 0.8992 in epoch 1
2024-08-15 17:47:40,119 : INFO : Epoch finished, average loss over training batches: 0.9868
2024-08-15 17:47:40,120 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:40,120 : INFO : Training metrics:
2024-08-15 17:47:40,120 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:40,129 : INFO : Accuracy: 0.5695
2024-08-15 17:47:40,129 : INFO : Precision score for label_class 0: 0.2049
2024-08-15 17:47:40,129 : INFO : Precision score for label_class 1: 0.6063
2024-08-15 17:47:40,129 : INFO : Precision score for label_class 2: 0.3161
2024-08-15 17:47:40,129 : INFO : Recall score for label_class 0: 0.0765
2024-08-15 17:47:40,129 : INFO : Recall score for label_class 1: 0.8988
2024-08-15 17:47:40,129 : INFO : Recall score for label_class 2: 0.0732
2024-08-15 17:47:40,129 : INFO : Average F1 score: 0.3181
2024-08-15 17:47:40,595 : INFO : Average loss over validation batches: 0.8833
2024-08-15 17:47:40,595 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:40,595 : INFO : Validation metrics:
2024-08-15 17:47:40,595 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:40,599 : INFO : Accuracy: 0.6766
2024-08-15 17:47:40,599 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:47:40,599 : INFO : Precision score for label_class 1: 0.6875
2024-08-15 17:47:40,599 : INFO : Precision score for label_class 2: 0.6228
2024-08-15 17:47:40,599 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:47:40,599 : INFO : Recall score for label_class 1: 0.9872
2024-08-15 17:47:40,599 : INFO : Recall score for label_class 2: 0.3604
2024-08-15 17:47:40,599 : INFO : Average F1 score: 0.4224
2024-08-15 17:47:40,599 : INFO : Validation metric decreased (inf --> 0.883339).  Saving model ...
2024-08-15 17:47:40,708 : INFO : Starting epoch 2
2024-08-15 17:47:41,368 : INFO : Current training batch loss: 0.8416 in epoch 2
2024-08-15 17:47:42,182 : INFO : Current training batch loss: 0.7893 in epoch 2
2024-08-15 17:47:42,996 : INFO : Current training batch loss: 0.7227 in epoch 2
2024-08-15 17:47:43,811 : INFO : Current training batch loss: 0.6696 in epoch 2
2024-08-15 17:47:44,162 : INFO : Epoch finished, average loss over training batches: 0.7684
2024-08-15 17:47:44,163 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:44,163 : INFO : Training metrics:
2024-08-15 17:47:44,163 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:44,170 : INFO : Accuracy: 0.7136
2024-08-15 17:47:44,170 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:47:44,170 : INFO : Precision score for label_class 1: 0.7606
2024-08-15 17:47:44,170 : INFO : Precision score for label_class 2: 0.5660
2024-08-15 17:47:44,170 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:47:44,170 : INFO : Recall score for label_class 1: 0.9605
2024-08-15 17:47:44,170 : INFO : Recall score for label_class 2: 0.4913
2024-08-15 17:47:44,170 : INFO : Average F1 score: 0.4583
2024-08-15 17:47:44,636 : INFO : Average loss over validation batches: 0.7056
2024-08-15 17:47:44,636 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:44,636 : INFO : Validation metrics:
2024-08-15 17:47:44,636 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:44,639 : INFO : Accuracy: 0.7344
2024-08-15 17:47:44,639 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:47:44,639 : INFO : Precision score for label_class 1: 0.8111
2024-08-15 17:47:44,639 : INFO : Precision score for label_class 2: 0.5804
2024-08-15 17:47:44,639 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:47:44,640 : INFO : Recall score for label_class 1: 0.9359
2024-08-15 17:47:44,640 : INFO : Recall score for label_class 2: 0.6599
2024-08-15 17:47:44,640 : INFO : Average F1 score: 0.4955
2024-08-15 17:47:44,640 : INFO : Validation metric decreased (0.883339 --> 0.705607).  Saving model ...
2024-08-15 17:47:44,743 : INFO : Starting epoch 3
2024-08-15 17:47:45,208 : INFO : Current training batch loss: 0.6866 in epoch 3
2024-08-15 17:47:46,020 : INFO : Current training batch loss: 0.6244 in epoch 3
2024-08-15 17:47:46,834 : INFO : Current training batch loss: 0.7435 in epoch 3
2024-08-15 17:47:47,648 : INFO : Current training batch loss: 0.5534 in epoch 3
2024-08-15 17:47:48,200 : INFO : Epoch finished, average loss over training batches: 0.6604
2024-08-15 17:47:48,201 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:48,201 : INFO : Training metrics:
2024-08-15 17:47:48,201 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:48,208 : INFO : Accuracy: 0.7614
2024-08-15 17:47:48,208 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:47:48,208 : INFO : Precision score for label_class 1: 0.8351
2024-08-15 17:47:48,209 : INFO : Precision score for label_class 2: 0.6007
2024-08-15 17:47:48,209 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:47:48,209 : INFO : Recall score for label_class 1: 0.9531
2024-08-15 17:47:48,209 : INFO : Recall score for label_class 2: 0.6791
2024-08-15 17:47:48,209 : INFO : Average F1 score: 0.5092
2024-08-15 17:47:48,680 : INFO : Average loss over validation batches: 0.6652
2024-08-15 17:47:48,680 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:48,680 : INFO : Validation metrics:
2024-08-15 17:47:48,680 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:48,683 : INFO : Accuracy: 0.7685
2024-08-15 17:47:48,683 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:47:48,683 : INFO : Precision score for label_class 1: 0.8432
2024-08-15 17:47:48,683 : INFO : Precision score for label_class 2: 0.6282
2024-08-15 17:47:48,683 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:47:48,683 : INFO : Recall score for label_class 1: 0.9513
2024-08-15 17:47:48,683 : INFO : Recall score for label_class 2: 0.7462
2024-08-15 17:47:48,683 : INFO : Average F1 score: 0.5254
2024-08-15 17:47:48,683 : INFO : Validation metric decreased (0.705607 --> 0.665162).  Saving model ...
2024-08-15 17:47:48,790 : INFO : Split 4 is finished, the score is: 0.5254
2024-08-15 17:47:48,790 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:48,790 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:48,790 : INFO : Starting training for split 5
2024-08-15 17:47:48,803 : INFO : Starting to tokenize the sequences.
2024-08-15 17:47:48,809 : INFO : Tokenization is finished.
2024-08-15 17:47:48,827 : INFO : Starting to tokenize the sequences.
2024-08-15 17:47:48,832 : INFO : Tokenization is finished.
2024-08-15 17:47:48,837 : INFO : Counting occurences of labels...
2024-08-15 17:47:48,838 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 330, 1615,  754]))
2024-08-15 17:47:48,838 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 84, 396, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:47:48,880 : INFO : Starting epoch 1
2024-08-15 17:47:48,931 : INFO : Current training batch loss: 1.0831 in epoch 1
2024-08-15 17:47:49,744 : INFO : Current training batch loss: 1.0643 in epoch 1
2024-08-15 17:47:50,563 : INFO : Current training batch loss: 0.9812 in epoch 1
2024-08-15 17:47:51,386 : INFO : Current training batch loss: 0.9234 in epoch 1
2024-08-15 17:47:52,202 : INFO : Current training batch loss: 0.9534 in epoch 1
2024-08-15 17:47:52,353 : INFO : Epoch finished, average loss over training batches: 0.9940
2024-08-15 17:47:52,353 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:52,353 : INFO : Training metrics:
2024-08-15 17:47:52,353 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:52,360 : INFO : Accuracy: 0.5891
2024-08-15 17:47:52,360 : INFO : Precision score for label_class 0: 0.1064
2024-08-15 17:47:52,360 : INFO : Precision score for label_class 1: 0.5977
2024-08-15 17:47:52,360 : INFO : Precision score for label_class 2: 0.0000
2024-08-15 17:47:52,360 : INFO : Recall score for label_class 0: 0.0152
2024-08-15 17:47:52,360 : INFO : Recall score for label_class 1: 0.9814
2024-08-15 17:47:52,360 : INFO : Recall score for label_class 2: 0.0000
2024-08-15 17:47:52,360 : INFO : Average F1 score: 0.2565
2024-08-15 17:47:52,827 : INFO : Average loss over validation batches: 0.8908
2024-08-15 17:47:52,827 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:52,827 : INFO : Validation metrics:
2024-08-15 17:47:52,827 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:52,831 : INFO : Accuracy: 0.5994
2024-08-15 17:47:52,831 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:47:52,831 : INFO : Precision score for label_class 1: 0.6058
2024-08-15 17:47:52,831 : INFO : Precision score for label_class 2: 0.4091
2024-08-15 17:47:52,831 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:47:52,831 : INFO : Recall score for label_class 1: 0.9975
2024-08-15 17:47:52,831 : INFO : Recall score for label_class 2: 0.0464
2024-08-15 17:47:52,831 : INFO : Average F1 score: 0.2791
2024-08-15 17:47:52,831 : INFO : Validation metric decreased (inf --> 0.890840).  Saving model ...
2024-08-15 17:47:52,934 : INFO : Starting epoch 2
2024-08-15 17:47:53,588 : INFO : Current training batch loss: 0.8774 in epoch 2
2024-08-15 17:47:54,405 : INFO : Current training batch loss: 0.8410 in epoch 2
2024-08-15 17:47:55,220 : INFO : Current training batch loss: 0.8000 in epoch 2
2024-08-15 17:47:56,036 : INFO : Current training batch loss: 0.7249 in epoch 2
2024-08-15 17:47:56,387 : INFO : Epoch finished, average loss over training batches: 0.8166
2024-08-15 17:47:56,388 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:56,388 : INFO : Training metrics:
2024-08-15 17:47:56,388 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:56,399 : INFO : Accuracy: 0.6943
2024-08-15 17:47:56,399 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:47:56,399 : INFO : Precision score for label_class 1: 0.7254
2024-08-15 17:47:56,399 : INFO : Precision score for label_class 2: 0.5690
2024-08-15 17:47:56,399 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:47:56,399 : INFO : Recall score for label_class 1: 0.9715
2024-08-15 17:47:56,399 : INFO : Recall score for label_class 2: 0.4045
2024-08-15 17:47:56,399 : INFO : Average F1 score: 0.4345
2024-08-15 17:47:56,870 : INFO : Average loss over validation batches: 0.7549
2024-08-15 17:47:56,870 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:56,870 : INFO : Validation metrics:
2024-08-15 17:47:56,870 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:47:56,874 : INFO : Accuracy: 0.7151
2024-08-15 17:47:56,874 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:47:56,874 : INFO : Precision score for label_class 1: 0.7695
2024-08-15 17:47:56,874 : INFO : Precision score for label_class 2: 0.5600
2024-08-15 17:47:56,874 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:47:56,874 : INFO : Recall score for label_class 1: 0.9697
2024-08-15 17:47:56,874 : INFO : Recall score for label_class 2: 0.5052
2024-08-15 17:47:56,874 : INFO : Average F1 score: 0.4631
2024-08-15 17:47:56,874 : INFO : Validation metric decreased (0.890840 --> 0.754926).  Saving model ...
2024-08-15 17:47:56,974 : INFO : Starting epoch 3
2024-08-15 17:47:57,427 : INFO : Current training batch loss: 0.7673 in epoch 3
2024-08-15 17:47:58,242 : INFO : Current training batch loss: 0.6846 in epoch 3
2024-08-15 17:47:59,056 : INFO : Current training batch loss: 0.7744 in epoch 3
2024-08-15 17:47:59,871 : INFO : Current training batch loss: 0.6474 in epoch 3
2024-08-15 17:48:00,424 : INFO : Epoch finished, average loss over training batches: 0.7189
2024-08-15 17:48:00,424 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:00,424 : INFO : Training metrics:
2024-08-15 17:48:00,424 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:00,435 : INFO : Accuracy: 0.7399
2024-08-15 17:48:00,435 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:48:00,435 : INFO : Precision score for label_class 1: 0.7964
2024-08-15 17:48:00,435 : INFO : Precision score for label_class 2: 0.5900
2024-08-15 17:48:00,435 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:48:00,435 : INFO : Recall score for label_class 1: 0.9666
2024-08-15 17:48:00,435 : INFO : Recall score for label_class 2: 0.5782
2024-08-15 17:48:00,435 : INFO : Average F1 score: 0.4858
2024-08-15 17:48:00,904 : INFO : Average loss over validation batches: 0.7180
2024-08-15 17:48:00,904 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:00,904 : INFO : Validation metrics:
2024-08-15 17:48:00,904 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:00,907 : INFO : Accuracy: 0.7240
2024-08-15 17:48:00,907 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:48:00,907 : INFO : Precision score for label_class 1: 0.7851
2024-08-15 17:48:00,907 : INFO : Precision score for label_class 2: 0.5684
2024-08-15 17:48:00,907 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:48:00,907 : INFO : Recall score for label_class 1: 0.9596
2024-08-15 17:48:00,907 : INFO : Recall score for label_class 2: 0.5567
2024-08-15 17:48:00,907 : INFO : Average F1 score: 0.4754
2024-08-15 17:48:00,907 : INFO : Validation metric decreased (0.754926 --> 0.718038).  Saving model ...
2024-08-15 17:48:01,012 : INFO : Split 5 is finished, the score is: 0.4754
2024-08-15 17:48:01,012 : INFO : ----------------------------------------------------------------------------------------------------
[I 2024-08-15 17:48:01,022] Trial 23 finished with value: 0.5446102248321301 and parameters: {'n_epochs': 3, 'learning_rate': 1.2132908966587334e-05, 'classifier_dropout': 0.7923234662744618, 'warmup_step_fraction': 0.07603580959391636, 'use_gradient_clipping': False}. Best is trial 1 with value: 0.8513001269595835.
2024-08-15 17:48:01,032 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:01,032 : INFO : Starting training for split 1
2024-08-15 17:48:01,044 : INFO : Starting to tokenize the sequences.
2024-08-15 17:48:01,049 : INFO : Tokenization is finished.
2024-08-15 17:48:01,061 : INFO : Starting to tokenize the sequences.
2024-08-15 17:48:01,067 : INFO : Tokenization is finished.
2024-08-15 17:48:01,067 : INFO : Counting occurences of labels...
2024-08-15 17:48:01,068 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1596,  774]))
2024-08-15 17:48:01,068 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 415, 174]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:48:01,113 : INFO : Starting epoch 1
2024-08-15 17:48:01,164 : INFO : Current training batch loss: 1.0878 in epoch 1
2024-08-15 17:48:01,979 : INFO : Current training batch loss: 0.9879 in epoch 1
2024-08-15 17:48:02,794 : INFO : Current training batch loss: 0.9826 in epoch 1
2024-08-15 17:48:03,608 : INFO : Current training batch loss: 0.7270 in epoch 1
2024-08-15 17:48:04,423 : INFO : Current training batch loss: 0.6666 in epoch 1
2024-08-15 17:48:04,573 : INFO : Epoch finished, average loss over training batches: 0.8794
2024-08-15 17:48:04,574 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:04,574 : INFO : Training metrics:
2024-08-15 17:48:04,574 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:04,582 : INFO : Accuracy: 0.6512
2024-08-15 17:48:04,582 : INFO : Precision score for label_class 0: 0.8000
2024-08-15 17:48:04,582 : INFO : Precision score for label_class 1: 0.6620
2024-08-15 17:48:04,582 : INFO : Precision score for label_class 2: 0.5764
2024-08-15 17:48:04,582 : INFO : Recall score for label_class 0: 0.0122
2024-08-15 17:48:04,582 : INFO : Recall score for label_class 1: 0.9731
2024-08-15 17:48:04,582 : INFO : Recall score for label_class 2: 0.2584
2024-08-15 17:48:04,582 : INFO : Average F1 score: 0.3896
2024-08-15 17:48:05,048 : INFO : Average loss over validation batches: 0.6410
2024-08-15 17:48:05,048 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:05,048 : INFO : Validation metrics:
2024-08-15 17:48:05,048 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:05,051 : INFO : Accuracy: 0.7526
2024-08-15 17:48:05,051 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:48:05,051 : INFO : Precision score for label_class 1: 0.8633
2024-08-15 17:48:05,051 : INFO : Precision score for label_class 2: 0.5466
2024-08-15 17:48:05,051 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:48:05,051 : INFO : Recall score for label_class 1: 0.9133
2024-08-15 17:48:05,051 : INFO : Recall score for label_class 2: 0.7414
2024-08-15 17:48:05,051 : INFO : Average F1 score: 0.5056
2024-08-15 17:48:05,051 : INFO : Validation metric decreased (inf --> 0.640967).  Saving model ...
2024-08-15 17:48:05,155 : INFO : Starting epoch 2
2024-08-15 17:48:05,808 : INFO : Current training batch loss: 0.3300 in epoch 2
2024-08-15 17:48:06,622 : INFO : Current training batch loss: 0.4886 in epoch 2
2024-08-15 17:48:07,436 : INFO : Current training batch loss: 0.3412 in epoch 2
2024-08-15 17:48:08,250 : INFO : Current training batch loss: 0.3081 in epoch 2
2024-08-15 17:48:08,603 : INFO : Epoch finished, average loss over training batches: 0.4621
2024-08-15 17:48:08,604 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:08,604 : INFO : Training metrics:
2024-08-15 17:48:08,604 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:08,608 : INFO : Accuracy: 0.8529
2024-08-15 17:48:08,608 : INFO : Precision score for label_class 0: 0.7992
2024-08-15 17:48:08,608 : INFO : Precision score for label_class 1: 0.8806
2024-08-15 17:48:08,608 : INFO : Precision score for label_class 2: 0.8070
2024-08-15 17:48:08,608 : INFO : Recall score for label_class 0: 0.6067
2024-08-15 17:48:08,608 : INFO : Recall score for label_class 1: 0.9424
2024-08-15 17:48:08,608 : INFO : Recall score for label_class 2: 0.7726
2024-08-15 17:48:08,608 : INFO : Average F1 score: 0.7965
2024-08-15 17:48:09,080 : INFO : Average loss over validation batches: 0.3685
2024-08-15 17:48:09,081 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:09,081 : INFO : Validation metrics:
2024-08-15 17:48:09,081 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:09,084 : INFO : Accuracy: 0.8770
2024-08-15 17:48:09,084 : INFO : Precision score for label_class 0: 0.7912
2024-08-15 17:48:09,084 : INFO : Precision score for label_class 1: 0.9137
2024-08-15 17:48:09,084 : INFO : Precision score for label_class 2: 0.8323
2024-08-15 17:48:09,084 : INFO : Recall score for label_class 0: 0.8372
2024-08-15 17:48:09,084 : INFO : Recall score for label_class 1: 0.9181
2024-08-15 17:48:09,084 : INFO : Recall score for label_class 2: 0.7989
2024-08-15 17:48:09,084 : INFO : Average F1 score: 0.8482
2024-08-15 17:48:09,084 : INFO : Validation metric decreased (0.640967 --> 0.368502).  Saving model ...
2024-08-15 17:48:09,188 : INFO : Starting epoch 3
2024-08-15 17:48:09,641 : INFO : Current training batch loss: 0.3062 in epoch 3
2024-08-15 17:48:10,455 : INFO : Current training batch loss: 0.3611 in epoch 3
2024-08-15 17:48:11,270 : INFO : Current training batch loss: 0.2155 in epoch 3
2024-08-15 17:48:12,086 : INFO : Current training batch loss: 0.2334 in epoch 3
2024-08-15 17:48:12,639 : INFO : Epoch finished, average loss over training batches: 0.2791
2024-08-15 17:48:12,639 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:12,639 : INFO : Training metrics:
2024-08-15 17:48:12,639 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:12,645 : INFO : Accuracy: 0.9170
2024-08-15 17:48:12,645 : INFO : Precision score for label_class 0: 0.8319
2024-08-15 17:48:12,645 : INFO : Precision score for label_class 1: 0.9388
2024-08-15 17:48:12,645 : INFO : Precision score for label_class 2: 0.9084
2024-08-15 17:48:12,645 : INFO : Recall score for label_class 0: 0.8598
2024-08-15 17:48:12,645 : INFO : Recall score for label_class 1: 0.9511
2024-08-15 17:48:12,645 : INFO : Recall score for label_class 2: 0.8708
2024-08-15 17:48:12,645 : INFO : Average F1 score: 0.8932
2024-08-15 17:48:13,120 : INFO : Average loss over validation batches: 0.3286
2024-08-15 17:48:13,120 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:13,120 : INFO : Validation metrics:
2024-08-15 17:48:13,120 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:13,123 : INFO : Accuracy: 0.8889
2024-08-15 17:48:13,123 : INFO : Precision score for label_class 0: 0.7879
2024-08-15 17:48:13,124 : INFO : Precision score for label_class 1: 0.9151
2024-08-15 17:48:13,124 : INFO : Precision score for label_class 2: 0.8816
2024-08-15 17:48:13,124 : INFO : Recall score for label_class 0: 0.9070
2024-08-15 17:48:13,124 : INFO : Recall score for label_class 1: 0.9349
2024-08-15 17:48:13,124 : INFO : Recall score for label_class 2: 0.7701
2024-08-15 17:48:13,124 : INFO : Average F1 score: 0.8634
2024-08-15 17:48:13,124 : INFO : Validation metric decreased (0.368502 --> 0.328587).  Saving model ...
2024-08-15 17:48:13,229 : INFO : Starting epoch 4
2024-08-15 17:48:13,480 : INFO : Current training batch loss: 0.5695 in epoch 4
2024-08-15 17:48:14,295 : INFO : Current training batch loss: 0.0897 in epoch 4
2024-08-15 17:48:15,110 : INFO : Current training batch loss: 0.3516 in epoch 4
2024-08-15 17:48:15,924 : INFO : Current training batch loss: 0.1598 in epoch 4
2024-08-15 17:48:16,689 : INFO : Epoch finished, average loss over training batches: 0.1771
2024-08-15 17:48:16,690 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:16,690 : INFO : Training metrics:
2024-08-15 17:48:16,690 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:16,695 : INFO : Accuracy: 0.9533
2024-08-15 17:48:16,695 : INFO : Precision score for label_class 0: 0.8793
2024-08-15 17:48:16,695 : INFO : Precision score for label_class 1: 0.9677
2024-08-15 17:48:16,695 : INFO : Precision score for label_class 2: 0.9568
2024-08-15 17:48:16,695 : INFO : Recall score for label_class 0: 0.9329
2024-08-15 17:48:16,695 : INFO : Recall score for label_class 1: 0.9762
2024-08-15 17:48:16,695 : INFO : Recall score for label_class 2: 0.9147
2024-08-15 17:48:16,695 : INFO : Average F1 score: 0.9375
2024-08-15 17:48:17,163 : INFO : Average loss over validation batches: 0.4315
2024-08-15 17:48:17,163 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:17,164 : INFO : Validation metrics:
2024-08-15 17:48:17,164 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:17,166 : INFO : Accuracy: 0.8400
2024-08-15 17:48:17,166 : INFO : Precision score for label_class 0: 0.7477
2024-08-15 17:48:17,166 : INFO : Precision score for label_class 1: 0.9545
2024-08-15 17:48:17,166 : INFO : Precision score for label_class 2: 0.6991
2024-08-15 17:48:17,166 : INFO : Recall score for label_class 0: 0.9302
2024-08-15 17:48:17,166 : INFO : Recall score for label_class 1: 0.8096
2024-08-15 17:48:17,166 : INFO : Recall score for label_class 2: 0.8678
2024-08-15 17:48:17,166 : INFO : Average F1 score: 0.8265
2024-08-15 17:48:17,166 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:48:17,166 : INFO : Starting epoch 5
2024-08-15 17:48:17,219 : INFO : Current training batch loss: 0.1790 in epoch 5
2024-08-15 17:48:18,043 : INFO : Current training batch loss: 0.2458 in epoch 5
2024-08-15 17:48:18,866 : INFO : Current training batch loss: 0.0526 in epoch 5
2024-08-15 17:48:19,681 : INFO : Current training batch loss: 0.1747 in epoch 5
2024-08-15 17:48:20,497 : INFO : Current training batch loss: 0.2782 in epoch 5
2024-08-15 17:48:20,648 : INFO : Epoch finished, average loss over training batches: 0.1317
2024-08-15 17:48:20,649 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:20,649 : INFO : Training metrics:
2024-08-15 17:48:20,649 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:20,656 : INFO : Accuracy: 0.9663
2024-08-15 17:48:20,656 : INFO : Precision score for label_class 0: 0.8997
2024-08-15 17:48:20,656 : INFO : Precision score for label_class 1: 0.9794
2024-08-15 17:48:20,656 : INFO : Precision score for label_class 2: 0.9693
2024-08-15 17:48:20,656 : INFO : Recall score for label_class 0: 0.9573
2024-08-15 17:48:20,656 : INFO : Recall score for label_class 1: 0.9812
2024-08-15 17:48:20,656 : INFO : Recall score for label_class 2: 0.9393
2024-08-15 17:48:20,657 : INFO : Average F1 score: 0.9540
2024-08-15 17:48:21,150 : INFO : Average loss over validation batches: 0.3434
2024-08-15 17:48:21,150 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:21,150 : INFO : Validation metrics:
2024-08-15 17:48:21,150 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:21,154 : INFO : Accuracy: 0.8889
2024-08-15 17:48:21,154 : INFO : Precision score for label_class 0: 0.7879
2024-08-15 17:48:21,154 : INFO : Precision score for label_class 1: 0.9095
2024-08-15 17:48:21,154 : INFO : Precision score for label_class 2: 0.8966
2024-08-15 17:48:21,154 : INFO : Recall score for label_class 0: 0.9070
2024-08-15 17:48:21,154 : INFO : Recall score for label_class 1: 0.9446
2024-08-15 17:48:21,154 : INFO : Recall score for label_class 2: 0.7471
2024-08-15 17:48:21,154 : INFO : Average F1 score: 0.8617
2024-08-15 17:48:21,154 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:48:21,154 : INFO : Starting epoch 6
2024-08-15 17:48:21,807 : INFO : Current training batch loss: 0.0247 in epoch 6
2024-08-15 17:48:22,622 : INFO : Current training batch loss: 0.0504 in epoch 6
2024-08-15 17:48:23,436 : INFO : Current training batch loss: 0.0320 in epoch 6
2024-08-15 17:48:24,251 : INFO : Current training batch loss: 0.0338 in epoch 6
2024-08-15 17:48:24,603 : INFO : Epoch finished, average loss over training batches: 0.0905
2024-08-15 17:48:24,603 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:24,603 : INFO : Training metrics:
2024-08-15 17:48:24,603 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:24,611 : INFO : Accuracy: 0.9815
2024-08-15 17:48:24,611 : INFO : Precision score for label_class 0: 0.9410
2024-08-15 17:48:24,611 : INFO : Precision score for label_class 1: 0.9881
2024-08-15 17:48:24,611 : INFO : Precision score for label_class 2: 0.9855
2024-08-15 17:48:24,611 : INFO : Recall score for label_class 0: 0.9726
2024-08-15 17:48:24,611 : INFO : Recall score for label_class 1: 0.9900
2024-08-15 17:48:24,611 : INFO : Recall score for label_class 2: 0.9677
2024-08-15 17:48:24,611 : INFO : Average F1 score: 0.9740
2024-08-15 17:48:25,079 : INFO : Average loss over validation batches: 0.3421
2024-08-15 17:48:25,079 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:25,079 : INFO : Validation metrics:
2024-08-15 17:48:25,079 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:25,082 : INFO : Accuracy: 0.8919
2024-08-15 17:48:25,082 : INFO : Precision score for label_class 0: 0.7736
2024-08-15 17:48:25,082 : INFO : Precision score for label_class 1: 0.9214
2024-08-15 17:48:25,082 : INFO : Precision score for label_class 2: 0.8926
2024-08-15 17:48:25,082 : INFO : Recall score for label_class 0: 0.9535
2024-08-15 17:48:25,082 : INFO : Recall score for label_class 1: 0.9325
2024-08-15 17:48:25,082 : INFO : Recall score for label_class 2: 0.7644
2024-08-15 17:48:25,082 : INFO : Average F1 score: 0.8682
2024-08-15 17:48:25,082 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:48:25,082 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:48:25,115 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:48:25,610 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:25,610 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:48:25,610 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:25,614 : INFO : Accuracy: 0.8889
2024-08-15 17:48:25,614 : INFO : Precision score for label_class 0: 0.7879
2024-08-15 17:48:25,614 : INFO : Precision score for label_class 1: 0.9151
2024-08-15 17:48:25,614 : INFO : Precision score for label_class 2: 0.8816
2024-08-15 17:48:25,614 : INFO : Recall score for label_class 0: 0.9070
2024-08-15 17:48:25,614 : INFO : Recall score for label_class 1: 0.9349
2024-08-15 17:48:25,614 : INFO : Recall score for label_class 2: 0.7701
2024-08-15 17:48:25,614 : INFO : Average F1 score: 0.8634
2024-08-15 17:48:25,614 : INFO : Determined score from best model, ending training.
2024-08-15 17:48:25,615 : INFO : Split 1 is finished, the score is: 0.8634
2024-08-15 17:48:25,615 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:25,615 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:25,615 : INFO : Starting training for split 2
2024-08-15 17:48:25,630 : INFO : Starting to tokenize the sequences.
2024-08-15 17:48:25,636 : INFO : Tokenization is finished.
2024-08-15 17:48:25,653 : INFO : Starting to tokenize the sequences.
2024-08-15 17:48:25,658 : INFO : Tokenization is finished.
2024-08-15 17:48:25,662 : INFO : Counting occurences of labels...
2024-08-15 17:48:25,664 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 343, 1601,  754]))
2024-08-15 17:48:25,664 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 71, 410, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:48:25,706 : INFO : Starting epoch 1
2024-08-15 17:48:25,757 : INFO : Current training batch loss: 1.0836 in epoch 1
2024-08-15 17:48:26,619 : INFO : Current training batch loss: 1.0364 in epoch 1
2024-08-15 17:48:27,440 : INFO : Current training batch loss: 0.9795 in epoch 1
2024-08-15 17:48:28,344 : INFO : Current training batch loss: 0.7397 in epoch 1
2024-08-15 17:48:29,167 : INFO : Current training batch loss: 0.7721 in epoch 1
2024-08-15 17:48:29,318 : INFO : Epoch finished, average loss over training batches: 0.8872
2024-08-15 17:48:29,318 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:29,318 : INFO : Training metrics:
2024-08-15 17:48:29,318 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:29,329 : INFO : Accuracy: 0.6494
2024-08-15 17:48:29,329 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:48:29,329 : INFO : Precision score for label_class 1: 0.6627
2024-08-15 17:48:29,329 : INFO : Precision score for label_class 2: 0.5607
2024-08-15 17:48:29,329 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:48:29,329 : INFO : Recall score for label_class 1: 0.9819
2024-08-15 17:48:29,329 : INFO : Recall score for label_class 2: 0.2387
2024-08-15 17:48:29,329 : INFO : Average F1 score: 0.3754
2024-08-15 17:48:29,800 : INFO : Average loss over validation batches: 0.6593
2024-08-15 17:48:29,800 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:29,800 : INFO : Validation metrics:
2024-08-15 17:48:29,800 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:29,804 : INFO : Accuracy: 0.7348
2024-08-15 17:48:29,804 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:48:29,804 : INFO : Precision score for label_class 1: 0.7983
2024-08-15 17:48:29,804 : INFO : Precision score for label_class 2: 0.5773
2024-08-15 17:48:29,804 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:48:29,804 : INFO : Recall score for label_class 1: 0.9366
2024-08-15 17:48:29,804 : INFO : Recall score for label_class 2: 0.5773
2024-08-15 17:48:29,804 : INFO : Average F1 score: 0.4798
2024-08-15 17:48:29,804 : INFO : Validation metric decreased (inf --> 0.659268).  Saving model ...
2024-08-15 17:48:29,906 : INFO : Starting epoch 2
2024-08-15 17:48:30,575 : INFO : Current training batch loss: 0.6397 in epoch 2
2024-08-15 17:48:31,398 : INFO : Current training batch loss: 0.6018 in epoch 2
2024-08-15 17:48:32,212 : INFO : Current training batch loss: 0.3690 in epoch 2
2024-08-15 17:48:33,027 : INFO : Current training batch loss: 0.3517 in epoch 2
2024-08-15 17:48:33,386 : INFO : Epoch finished, average loss over training batches: 0.5133
2024-08-15 17:48:33,386 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:33,386 : INFO : Training metrics:
2024-08-15 17:48:33,386 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:33,396 : INFO : Accuracy: 0.8132
2024-08-15 17:48:33,396 : INFO : Precision score for label_class 0: 0.7763
2024-08-15 17:48:33,396 : INFO : Precision score for label_class 1: 0.8550
2024-08-15 17:48:33,396 : INFO : Precision score for label_class 2: 0.7248
2024-08-15 17:48:33,396 : INFO : Recall score for label_class 0: 0.4956
2024-08-15 17:48:33,396 : INFO : Recall score for label_class 1: 0.9319
2024-08-15 17:48:33,396 : INFO : Recall score for label_class 2: 0.7056
2024-08-15 17:48:33,396 : INFO : Average F1 score: 0.7373
2024-08-15 17:48:33,863 : INFO : Average loss over validation batches: 0.4041
2024-08-15 17:48:33,863 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:33,863 : INFO : Validation metrics:
2024-08-15 17:48:33,863 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:33,866 : INFO : Accuracy: 0.8593
2024-08-15 17:48:33,866 : INFO : Precision score for label_class 0: 0.7333
2024-08-15 17:48:33,866 : INFO : Precision score for label_class 1: 0.8978
2024-08-15 17:48:33,866 : INFO : Precision score for label_class 2: 0.8254
2024-08-15 17:48:33,866 : INFO : Recall score for label_class 0: 0.7746
2024-08-15 17:48:33,866 : INFO : Recall score for label_class 1: 0.9000
2024-08-15 17:48:33,866 : INFO : Recall score for label_class 2: 0.8041
2024-08-15 17:48:33,866 : INFO : Average F1 score: 0.8223
2024-08-15 17:48:33,866 : INFO : Validation metric decreased (0.659268 --> 0.404068).  Saving model ...
2024-08-15 17:48:33,966 : INFO : Starting epoch 3
2024-08-15 17:48:34,420 : INFO : Current training batch loss: 0.2713 in epoch 3
2024-08-15 17:48:35,234 : INFO : Current training batch loss: 0.2886 in epoch 3
2024-08-15 17:48:36,048 : INFO : Current training batch loss: 0.3210 in epoch 3
2024-08-15 17:48:36,864 : INFO : Current training batch loss: 0.1589 in epoch 3
2024-08-15 17:48:37,425 : INFO : Epoch finished, average loss over training batches: 0.2664
2024-08-15 17:48:37,425 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:37,425 : INFO : Training metrics:
2024-08-15 17:48:37,425 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:37,433 : INFO : Accuracy: 0.9170
2024-08-15 17:48:37,433 : INFO : Precision score for label_class 0: 0.8343
2024-08-15 17:48:37,433 : INFO : Precision score for label_class 1: 0.9431
2024-08-15 17:48:37,433 : INFO : Precision score for label_class 2: 0.8994
2024-08-15 17:48:37,433 : INFO : Recall score for label_class 0: 0.8659
2024-08-15 17:48:37,433 : INFO : Recall score for label_class 1: 0.9519
2024-08-15 17:48:37,433 : INFO : Recall score for label_class 2: 0.8660
2024-08-15 17:48:37,433 : INFO : Average F1 score: 0.8932
2024-08-15 17:48:37,910 : INFO : Average loss over validation batches: 0.3785
2024-08-15 17:48:37,910 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:37,910 : INFO : Validation metrics:
2024-08-15 17:48:37,910 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:37,914 : INFO : Accuracy: 0.8726
2024-08-15 17:48:37,914 : INFO : Precision score for label_class 0: 0.7632
2024-08-15 17:48:37,914 : INFO : Precision score for label_class 1: 0.8915
2024-08-15 17:48:37,914 : INFO : Precision score for label_class 2: 0.8743
2024-08-15 17:48:37,914 : INFO : Recall score for label_class 0: 0.8169
2024-08-15 17:48:37,914 : INFO : Recall score for label_class 1: 0.9220
2024-08-15 17:48:37,914 : INFO : Recall score for label_class 2: 0.7887
2024-08-15 17:48:37,914 : INFO : Average F1 score: 0.8416
2024-08-15 17:48:37,914 : INFO : Validation metric decreased (0.404068 --> 0.378481).  Saving model ...
2024-08-15 17:48:38,017 : INFO : Starting epoch 4
2024-08-15 17:48:38,270 : INFO : Current training batch loss: 0.2842 in epoch 4
2024-08-15 17:48:39,090 : INFO : Current training batch loss: 0.1880 in epoch 4
2024-08-15 17:48:39,912 : INFO : Current training batch loss: 0.2575 in epoch 4
2024-08-15 17:48:40,724 : INFO : Current training batch loss: 0.2012 in epoch 4
2024-08-15 17:48:41,481 : INFO : Epoch finished, average loss over training batches: 0.1640
2024-08-15 17:48:41,481 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:41,481 : INFO : Training metrics:
2024-08-15 17:48:41,481 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:41,491 : INFO : Accuracy: 0.9559
2024-08-15 17:48:41,491 : INFO : Precision score for label_class 0: 0.9000
2024-08-15 17:48:41,491 : INFO : Precision score for label_class 1: 0.9714
2024-08-15 17:48:41,491 : INFO : Precision score for label_class 2: 0.9495
2024-08-15 17:48:41,491 : INFO : Recall score for label_class 0: 0.9446
2024-08-15 17:48:41,491 : INFO : Recall score for label_class 1: 0.9744
2024-08-15 17:48:41,491 : INFO : Recall score for label_class 2: 0.9218
2024-08-15 17:48:41,491 : INFO : Average F1 score: 0.9433
2024-08-15 17:48:41,959 : INFO : Average loss over validation batches: 0.4011
2024-08-15 17:48:41,959 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:41,959 : INFO : Validation metrics:
2024-08-15 17:48:41,959 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:41,963 : INFO : Accuracy: 0.8711
2024-08-15 17:48:41,963 : INFO : Precision score for label_class 0: 0.7808
2024-08-15 17:48:41,963 : INFO : Precision score for label_class 1: 0.8722
2024-08-15 17:48:41,963 : INFO : Precision score for label_class 2: 0.9103
2024-08-15 17:48:41,963 : INFO : Recall score for label_class 0: 0.8028
2024-08-15 17:48:41,963 : INFO : Recall score for label_class 1: 0.9488
2024-08-15 17:48:41,963 : INFO : Recall score for label_class 2: 0.7320
2024-08-15 17:48:41,963 : INFO : Average F1 score: 0.8373
2024-08-15 17:48:41,963 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:48:41,963 : INFO : Starting epoch 5
2024-08-15 17:48:42,014 : INFO : Current training batch loss: 0.1128 in epoch 5
2024-08-15 17:48:42,842 : INFO : Current training batch loss: 0.2704 in epoch 5
2024-08-15 17:48:43,663 : INFO : Current training batch loss: 0.0443 in epoch 5
2024-08-15 17:48:44,507 : INFO : Current training batch loss: 0.1562 in epoch 5
2024-08-15 17:48:45,325 : INFO : Current training batch loss: 0.2197 in epoch 5
2024-08-15 17:48:45,478 : INFO : Epoch finished, average loss over training batches: 0.1180
2024-08-15 17:48:45,478 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:45,479 : INFO : Training metrics:
2024-08-15 17:48:45,479 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:45,489 : INFO : Accuracy: 0.9700
2024-08-15 17:48:45,489 : INFO : Precision score for label_class 0: 0.9345
2024-08-15 17:48:45,489 : INFO : Precision score for label_class 1: 0.9771
2024-08-15 17:48:45,489 : INFO : Precision score for label_class 2: 0.9713
2024-08-15 17:48:45,489 : INFO : Recall score for label_class 0: 0.9563
2024-08-15 17:48:45,489 : INFO : Recall score for label_class 1: 0.9856
2024-08-15 17:48:45,489 : INFO : Recall score for label_class 2: 0.9430
2024-08-15 17:48:45,489 : INFO : Average F1 score: 0.9612
2024-08-15 17:48:45,963 : INFO : Average loss over validation batches: 0.4669
2024-08-15 17:48:45,963 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:45,963 : INFO : Validation metrics:
2024-08-15 17:48:45,963 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:45,966 : INFO : Accuracy: 0.8474
2024-08-15 17:48:45,966 : INFO : Precision score for label_class 0: 0.7284
2024-08-15 17:48:45,966 : INFO : Precision score for label_class 1: 0.9276
2024-08-15 17:48:45,966 : INFO : Precision score for label_class 2: 0.7557
2024-08-15 17:48:45,966 : INFO : Recall score for label_class 0: 0.8310
2024-08-15 17:48:45,966 : INFO : Recall score for label_class 1: 0.8439
2024-08-15 17:48:45,966 : INFO : Recall score for label_class 2: 0.8608
2024-08-15 17:48:45,966 : INFO : Average F1 score: 0.8216
2024-08-15 17:48:45,967 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:48:45,967 : INFO : Starting epoch 6
2024-08-15 17:48:46,634 : INFO : Current training batch loss: 0.0385 in epoch 6
2024-08-15 17:48:47,454 : INFO : Current training batch loss: 0.1378 in epoch 6
2024-08-15 17:48:48,280 : INFO : Current training batch loss: 0.0289 in epoch 6
2024-08-15 17:48:49,098 : INFO : Current training batch loss: 0.0305 in epoch 6
2024-08-15 17:48:49,452 : INFO : Epoch finished, average loss over training batches: 0.0814
2024-08-15 17:48:49,453 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:49,453 : INFO : Training metrics:
2024-08-15 17:48:49,453 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:49,459 : INFO : Accuracy: 0.9841
2024-08-15 17:48:49,460 : INFO : Precision score for label_class 0: 0.9440
2024-08-15 17:48:49,460 : INFO : Precision score for label_class 1: 0.9900
2024-08-15 17:48:49,460 : INFO : Precision score for label_class 2: 0.9905
2024-08-15 17:48:49,460 : INFO : Recall score for label_class 0: 0.9825
2024-08-15 17:48:49,460 : INFO : Recall score for label_class 1: 0.9913
2024-08-15 17:48:49,460 : INFO : Recall score for label_class 2: 0.9695
2024-08-15 17:48:49,460 : INFO : Average F1 score: 0.9778
2024-08-15 17:48:49,926 : INFO : Average loss over validation batches: 0.4272
2024-08-15 17:48:49,926 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:49,926 : INFO : Validation metrics:
2024-08-15 17:48:49,926 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:49,930 : INFO : Accuracy: 0.8593
2024-08-15 17:48:49,930 : INFO : Precision score for label_class 0: 0.7397
2024-08-15 17:48:49,930 : INFO : Precision score for label_class 1: 0.8707
2024-08-15 17:48:49,930 : INFO : Precision score for label_class 2: 0.8820
2024-08-15 17:48:49,930 : INFO : Recall score for label_class 0: 0.7606
2024-08-15 17:48:49,930 : INFO : Recall score for label_class 1: 0.9366
2024-08-15 17:48:49,930 : INFO : Recall score for label_class 2: 0.7320
2024-08-15 17:48:49,930 : INFO : Average F1 score: 0.8175
2024-08-15 17:48:49,930 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:48:49,930 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:48:49,966 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:48:50,466 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:50,466 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:48:50,466 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:50,470 : INFO : Accuracy: 0.8726
2024-08-15 17:48:50,470 : INFO : Precision score for label_class 0: 0.7632
2024-08-15 17:48:50,470 : INFO : Precision score for label_class 1: 0.8915
2024-08-15 17:48:50,470 : INFO : Precision score for label_class 2: 0.8743
2024-08-15 17:48:50,470 : INFO : Recall score for label_class 0: 0.8169
2024-08-15 17:48:50,470 : INFO : Recall score for label_class 1: 0.9220
2024-08-15 17:48:50,470 : INFO : Recall score for label_class 2: 0.7887
2024-08-15 17:48:50,470 : INFO : Average F1 score: 0.8416
2024-08-15 17:48:50,470 : INFO : Determined score from best model, ending training.
2024-08-15 17:48:50,472 : INFO : Split 2 is finished, the score is: 0.8416
2024-08-15 17:48:50,472 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:50,472 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:50,472 : INFO : Starting training for split 3
2024-08-15 17:48:50,485 : INFO : Starting to tokenize the sequences.
2024-08-15 17:48:50,491 : INFO : Tokenization is finished.
2024-08-15 17:48:50,507 : INFO : Starting to tokenize the sequences.
2024-08-15 17:48:50,512 : INFO : Tokenization is finished.
2024-08-15 17:48:50,517 : INFO : Counting occurences of labels...
2024-08-15 17:48:50,518 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 328, 1611,  759]))
2024-08-15 17:48:50,518 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 86, 400, 189]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:48:50,564 : INFO : Starting epoch 1
2024-08-15 17:48:50,615 : INFO : Current training batch loss: 1.0843 in epoch 1
2024-08-15 17:48:51,439 : INFO : Current training batch loss: 1.0422 in epoch 1
2024-08-15 17:48:52,257 : INFO : Current training batch loss: 0.8835 in epoch 1
2024-08-15 17:48:53,079 : INFO : Current training batch loss: 0.7432 in epoch 1
2024-08-15 17:48:53,897 : INFO : Current training batch loss: 0.7452 in epoch 1
2024-08-15 17:48:54,049 : INFO : Epoch finished, average loss over training batches: 0.8755
2024-08-15 17:48:54,050 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:54,050 : INFO : Training metrics:
2024-08-15 17:48:54,050 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:54,057 : INFO : Accuracy: 0.6390
2024-08-15 17:48:54,057 : INFO : Precision score for label_class 0: 0.1359
2024-08-15 17:48:54,057 : INFO : Precision score for label_class 1: 0.6783
2024-08-15 17:48:54,057 : INFO : Precision score for label_class 2: 0.5481
2024-08-15 17:48:54,057 : INFO : Recall score for label_class 0: 0.0427
2024-08-15 17:48:54,057 : INFO : Recall score for label_class 1: 0.9305
2024-08-15 17:48:54,057 : INFO : Recall score for label_class 2: 0.2780
2024-08-15 17:48:54,057 : INFO : Average F1 score: 0.4062
2024-08-15 17:48:54,522 : INFO : Average loss over validation batches: 0.6179
2024-08-15 17:48:54,522 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:54,522 : INFO : Validation metrics:
2024-08-15 17:48:54,522 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:54,525 : INFO : Accuracy: 0.7615
2024-08-15 17:48:54,525 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:48:54,525 : INFO : Precision score for label_class 1: 0.8491
2024-08-15 17:48:54,525 : INFO : Precision score for label_class 2: 0.5931
2024-08-15 17:48:54,525 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:48:54,525 : INFO : Recall score for label_class 1: 0.9425
2024-08-15 17:48:54,525 : INFO : Recall score for label_class 2: 0.7249
2024-08-15 17:48:54,525 : INFO : Average F1 score: 0.5152
2024-08-15 17:48:54,525 : INFO : Validation metric decreased (inf --> 0.617903).  Saving model ...
2024-08-15 17:48:54,626 : INFO : Starting epoch 2
2024-08-15 17:48:55,282 : INFO : Current training batch loss: 0.5979 in epoch 2
2024-08-15 17:48:56,099 : INFO : Current training batch loss: 0.4875 in epoch 2
2024-08-15 17:48:56,916 : INFO : Current training batch loss: 0.3520 in epoch 2
2024-08-15 17:48:57,738 : INFO : Current training batch loss: 0.3717 in epoch 2
2024-08-15 17:48:58,096 : INFO : Epoch finished, average loss over training batches: 0.4781
2024-08-15 17:48:58,096 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:58,096 : INFO : Training metrics:
2024-08-15 17:48:58,096 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:58,100 : INFO : Accuracy: 0.8395
2024-08-15 17:48:58,100 : INFO : Precision score for label_class 0: 0.7708
2024-08-15 17:48:58,100 : INFO : Precision score for label_class 1: 0.8741
2024-08-15 17:48:58,100 : INFO : Precision score for label_class 2: 0.7812
2024-08-15 17:48:58,100 : INFO : Recall score for label_class 0: 0.5945
2024-08-15 17:48:58,100 : INFO : Recall score for label_class 1: 0.9348
2024-08-15 17:48:58,100 : INFO : Recall score for label_class 2: 0.7431
2024-08-15 17:48:58,100 : INFO : Average F1 score: 0.7788
2024-08-15 17:48:58,564 : INFO : Average loss over validation batches: 0.3946
2024-08-15 17:48:58,564 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:58,564 : INFO : Validation metrics:
2024-08-15 17:48:58,564 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:48:58,567 : INFO : Accuracy: 0.8667
2024-08-15 17:48:58,567 : INFO : Precision score for label_class 0: 0.7684
2024-08-15 17:48:58,567 : INFO : Precision score for label_class 1: 0.8947
2024-08-15 17:48:58,567 : INFO : Precision score for label_class 2: 0.8519
2024-08-15 17:48:58,567 : INFO : Recall score for label_class 0: 0.8488
2024-08-15 17:48:58,567 : INFO : Recall score for label_class 1: 0.9350
2024-08-15 17:48:58,567 : INFO : Recall score for label_class 2: 0.7302
2024-08-15 17:48:58,567 : INFO : Average F1 score: 0.8358
2024-08-15 17:48:58,567 : INFO : Validation metric decreased (0.617903 --> 0.394610).  Saving model ...
2024-08-15 17:48:58,670 : INFO : Starting epoch 3
2024-08-15 17:48:59,125 : INFO : Current training batch loss: 0.2844 in epoch 3
2024-08-15 17:48:59,951 : INFO : Current training batch loss: 0.2560 in epoch 3
2024-08-15 17:49:00,778 : INFO : Current training batch loss: 0.2257 in epoch 3
2024-08-15 17:49:01,595 : INFO : Current training batch loss: 0.1480 in epoch 3
2024-08-15 17:49:02,153 : INFO : Epoch finished, average loss over training batches: 0.2627
2024-08-15 17:49:02,154 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:02,154 : INFO : Training metrics:
2024-08-15 17:49:02,154 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:02,157 : INFO : Accuracy: 0.9233
2024-08-15 17:49:02,158 : INFO : Precision score for label_class 0: 0.8254
2024-08-15 17:49:02,158 : INFO : Precision score for label_class 1: 0.9509
2024-08-15 17:49:02,158 : INFO : Precision score for label_class 2: 0.9101
2024-08-15 17:49:02,158 : INFO : Recall score for label_class 0: 0.8933
2024-08-15 17:49:02,158 : INFO : Recall score for label_class 1: 0.9497
2024-08-15 17:49:02,158 : INFO : Recall score for label_class 2: 0.8801
2024-08-15 17:49:02,158 : INFO : Average F1 score: 0.9010
2024-08-15 17:49:02,623 : INFO : Average loss over validation batches: 0.3537
2024-08-15 17:49:02,623 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:02,623 : INFO : Validation metrics:
2024-08-15 17:49:02,623 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:02,626 : INFO : Accuracy: 0.8681
2024-08-15 17:49:02,626 : INFO : Precision score for label_class 0: 0.8161
2024-08-15 17:49:02,626 : INFO : Precision score for label_class 1: 0.9211
2024-08-15 17:49:02,626 : INFO : Precision score for label_class 2: 0.7846
2024-08-15 17:49:02,626 : INFO : Recall score for label_class 0: 0.8256
2024-08-15 17:49:02,626 : INFO : Recall score for label_class 1: 0.9050
2024-08-15 17:49:02,626 : INFO : Recall score for label_class 2: 0.8095
2024-08-15 17:49:02,626 : INFO : Average F1 score: 0.8436
2024-08-15 17:49:02,626 : INFO : Validation metric decreased (0.394610 --> 0.353687).  Saving model ...
2024-08-15 17:49:02,728 : INFO : Starting epoch 4
2024-08-15 17:49:02,982 : INFO : Current training batch loss: 0.3486 in epoch 4
2024-08-15 17:49:03,809 : INFO : Current training batch loss: 0.3270 in epoch 4
2024-08-15 17:49:04,634 : INFO : Current training batch loss: 0.2783 in epoch 4
2024-08-15 17:49:05,451 : INFO : Current training batch loss: 0.0756 in epoch 4
2024-08-15 17:49:06,216 : INFO : Epoch finished, average loss over training batches: 0.1646
2024-08-15 17:49:06,216 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:06,216 : INFO : Training metrics:
2024-08-15 17:49:06,216 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:06,220 : INFO : Accuracy: 0.9589
2024-08-15 17:49:06,220 : INFO : Precision score for label_class 0: 0.8873
2024-08-15 17:49:06,220 : INFO : Precision score for label_class 1: 0.9716
2024-08-15 17:49:06,220 : INFO : Precision score for label_class 2: 0.9644
2024-08-15 17:49:06,220 : INFO : Recall score for label_class 0: 0.9360
2024-08-15 17:49:06,220 : INFO : Recall score for label_class 1: 0.9777
2024-08-15 17:49:06,220 : INFO : Recall score for label_class 2: 0.9289
2024-08-15 17:49:06,220 : INFO : Average F1 score: 0.9440
2024-08-15 17:49:06,686 : INFO : Average loss over validation batches: 0.4163
2024-08-15 17:49:06,686 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:06,686 : INFO : Validation metrics:
2024-08-15 17:49:06,686 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:06,689 : INFO : Accuracy: 0.8430
2024-08-15 17:49:06,689 : INFO : Precision score for label_class 0: 0.7723
2024-08-15 17:49:06,689 : INFO : Precision score for label_class 1: 0.9429
2024-08-15 17:49:06,689 : INFO : Precision score for label_class 2: 0.7188
2024-08-15 17:49:06,689 : INFO : Recall score for label_class 0: 0.9070
2024-08-15 17:49:06,689 : INFO : Recall score for label_class 1: 0.8250
2024-08-15 17:49:06,689 : INFO : Recall score for label_class 2: 0.8519
2024-08-15 17:49:06,689 : INFO : Average F1 score: 0.8313
2024-08-15 17:49:06,689 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:49:06,689 : INFO : Starting epoch 5
2024-08-15 17:49:06,740 : INFO : Current training batch loss: 0.0748 in epoch 5
2024-08-15 17:49:07,559 : INFO : Current training batch loss: 0.3030 in epoch 5
2024-08-15 17:49:08,381 : INFO : Current training batch loss: 0.0575 in epoch 5
2024-08-15 17:49:09,205 : INFO : Current training batch loss: 0.2232 in epoch 5
2024-08-15 17:49:10,025 : INFO : Current training batch loss: 0.1258 in epoch 5
2024-08-15 17:49:10,178 : INFO : Epoch finished, average loss over training batches: 0.1174
2024-08-15 17:49:10,178 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:10,178 : INFO : Training metrics:
2024-08-15 17:49:10,178 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:10,185 : INFO : Accuracy: 0.9692
2024-08-15 17:49:10,185 : INFO : Precision score for label_class 0: 0.9157
2024-08-15 17:49:10,185 : INFO : Precision score for label_class 1: 0.9778
2024-08-15 17:49:10,185 : INFO : Precision score for label_class 2: 0.9755
2024-08-15 17:49:10,185 : INFO : Recall score for label_class 0: 0.9604
2024-08-15 17:49:10,185 : INFO : Recall score for label_class 1: 0.9820
2024-08-15 17:49:10,185 : INFO : Recall score for label_class 2: 0.9460
2024-08-15 17:49:10,185 : INFO : Average F1 score: 0.9593
2024-08-15 17:49:10,649 : INFO : Average loss over validation batches: 0.3950
2024-08-15 17:49:10,650 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:10,650 : INFO : Validation metrics:
2024-08-15 17:49:10,650 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:10,652 : INFO : Accuracy: 0.8652
2024-08-15 17:49:10,652 : INFO : Precision score for label_class 0: 0.7778
2024-08-15 17:49:10,652 : INFO : Precision score for label_class 1: 0.9284
2024-08-15 17:49:10,652 : INFO : Precision score for label_class 2: 0.7889
2024-08-15 17:49:10,652 : INFO : Recall score for label_class 0: 0.8953
2024-08-15 17:49:10,652 : INFO : Recall score for label_class 1: 0.8750
2024-08-15 17:49:10,652 : INFO : Recall score for label_class 2: 0.8307
2024-08-15 17:49:10,652 : INFO : Average F1 score: 0.8475
2024-08-15 17:49:10,652 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:49:10,652 : INFO : Starting epoch 6
2024-08-15 17:49:11,308 : INFO : Current training batch loss: 0.1031 in epoch 6
2024-08-15 17:49:12,126 : INFO : Current training batch loss: 0.1391 in epoch 6
2024-08-15 17:49:12,944 : INFO : Current training batch loss: 0.0290 in epoch 6
2024-08-15 17:49:13,772 : INFO : Current training batch loss: 0.0248 in epoch 6
2024-08-15 17:49:14,126 : INFO : Epoch finished, average loss over training batches: 0.0880
2024-08-15 17:49:14,127 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:14,127 : INFO : Training metrics:
2024-08-15 17:49:14,127 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:14,133 : INFO : Accuracy: 0.9789
2024-08-15 17:49:14,134 : INFO : Precision score for label_class 0: 0.9273
2024-08-15 17:49:14,134 : INFO : Precision score for label_class 1: 0.9894
2024-08-15 17:49:14,134 : INFO : Precision score for label_class 2: 0.9800
2024-08-15 17:49:14,134 : INFO : Recall score for label_class 0: 0.9726
2024-08-15 17:49:14,134 : INFO : Recall score for label_class 1: 0.9845
2024-08-15 17:49:14,134 : INFO : Recall score for label_class 2: 0.9697
2024-08-15 17:49:14,134 : INFO : Average F1 score: 0.9704
2024-08-15 17:49:14,601 : INFO : Average loss over validation batches: 0.4446
2024-08-15 17:49:14,601 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:14,601 : INFO : Validation metrics:
2024-08-15 17:49:14,601 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:14,604 : INFO : Accuracy: 0.8696
2024-08-15 17:49:14,604 : INFO : Precision score for label_class 0: 0.8315
2024-08-15 17:49:14,604 : INFO : Precision score for label_class 1: 0.8713
2024-08-15 17:49:14,604 : INFO : Precision score for label_class 2: 0.8874
2024-08-15 17:49:14,604 : INFO : Recall score for label_class 0: 0.8605
2024-08-15 17:49:14,604 : INFO : Recall score for label_class 1: 0.9475
2024-08-15 17:49:14,604 : INFO : Recall score for label_class 2: 0.7090
2024-08-15 17:49:14,604 : INFO : Average F1 score: 0.8472
2024-08-15 17:49:14,604 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:49:14,604 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:49:14,639 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:49:15,138 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:15,138 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:49:15,138 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:15,140 : INFO : Accuracy: 0.8681
2024-08-15 17:49:15,140 : INFO : Precision score for label_class 0: 0.8161
2024-08-15 17:49:15,141 : INFO : Precision score for label_class 1: 0.9211
2024-08-15 17:49:15,141 : INFO : Precision score for label_class 2: 0.7846
2024-08-15 17:49:15,141 : INFO : Recall score for label_class 0: 0.8256
2024-08-15 17:49:15,141 : INFO : Recall score for label_class 1: 0.9050
2024-08-15 17:49:15,141 : INFO : Recall score for label_class 2: 0.8095
2024-08-15 17:49:15,141 : INFO : Average F1 score: 0.8436
2024-08-15 17:49:15,141 : INFO : Determined score from best model, ending training.
2024-08-15 17:49:15,142 : INFO : Split 3 is finished, the score is: 0.8436
2024-08-15 17:49:15,142 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:15,142 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:15,142 : INFO : Starting training for split 4
2024-08-15 17:49:15,157 : INFO : Starting to tokenize the sequences.
2024-08-15 17:49:15,163 : INFO : Tokenization is finished.
2024-08-15 17:49:15,179 : INFO : Starting to tokenize the sequences.
2024-08-15 17:49:15,184 : INFO : Tokenization is finished.
2024-08-15 17:49:15,189 : INFO : Counting occurences of labels...
2024-08-15 17:49:15,190 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 327, 1621,  751]))
2024-08-15 17:49:15,190 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 87, 390, 197]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:49:15,234 : INFO : Starting epoch 1
2024-08-15 17:49:15,286 : INFO : Current training batch loss: 1.1169 in epoch 1
2024-08-15 17:49:16,109 : INFO : Current training batch loss: 1.0562 in epoch 1
2024-08-15 17:49:16,927 : INFO : Current training batch loss: 0.9227 in epoch 1
2024-08-15 17:49:17,751 : INFO : Current training batch loss: 0.8533 in epoch 1
2024-08-15 17:49:18,570 : INFO : Current training batch loss: 0.7766 in epoch 1
2024-08-15 17:49:18,722 : INFO : Epoch finished, average loss over training batches: 0.9163
2024-08-15 17:49:18,722 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:18,722 : INFO : Training metrics:
2024-08-15 17:49:18,722 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:18,729 : INFO : Accuracy: 0.5684
2024-08-15 17:49:18,729 : INFO : Precision score for label_class 0: 0.1418
2024-08-15 17:49:18,729 : INFO : Precision score for label_class 1: 0.6541
2024-08-15 17:49:18,729 : INFO : Precision score for label_class 2: 0.5333
2024-08-15 17:49:18,729 : INFO : Recall score for label_class 0: 0.1713
2024-08-15 17:49:18,729 : INFO : Recall score for label_class 1: 0.8328
2024-08-15 17:49:18,729 : INFO : Recall score for label_class 2: 0.1704
2024-08-15 17:49:18,729 : INFO : Average F1 score: 0.3820
2024-08-15 17:49:19,196 : INFO : Average loss over validation batches: 0.7013
2024-08-15 17:49:19,196 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:19,196 : INFO : Validation metrics:
2024-08-15 17:49:19,196 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:19,200 : INFO : Accuracy: 0.7226
2024-08-15 17:49:19,200 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:49:19,200 : INFO : Precision score for label_class 1: 0.7815
2024-08-15 17:49:19,200 : INFO : Precision score for label_class 2: 0.5808
2024-08-15 17:49:19,200 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:49:19,200 : INFO : Recall score for label_class 1: 0.9538
2024-08-15 17:49:19,200 : INFO : Recall score for label_class 2: 0.5838
2024-08-15 17:49:19,200 : INFO : Average F1 score: 0.4805
2024-08-15 17:49:19,200 : INFO : Validation metric decreased (inf --> 0.701274).  Saving model ...
2024-08-15 17:49:19,303 : INFO : Starting epoch 2
2024-08-15 17:49:19,958 : INFO : Current training batch loss: 0.6715 in epoch 2
2024-08-15 17:49:20,782 : INFO : Current training batch loss: 0.5451 in epoch 2
2024-08-15 17:49:21,602 : INFO : Current training batch loss: 0.4074 in epoch 2
2024-08-15 17:49:22,425 : INFO : Current training batch loss: 0.4124 in epoch 2
2024-08-15 17:49:22,784 : INFO : Epoch finished, average loss over training batches: 0.5416
2024-08-15 17:49:22,785 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:22,785 : INFO : Training metrics:
2024-08-15 17:49:22,785 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:22,792 : INFO : Accuracy: 0.8114
2024-08-15 17:49:22,792 : INFO : Precision score for label_class 0: 0.8235
2024-08-15 17:49:22,792 : INFO : Precision score for label_class 1: 0.8635
2024-08-15 17:49:22,792 : INFO : Precision score for label_class 2: 0.6929
2024-08-15 17:49:22,792 : INFO : Recall score for label_class 0: 0.3853
2024-08-15 17:49:22,792 : INFO : Recall score for label_class 1: 0.9365
2024-08-15 17:49:22,792 : INFO : Recall score for label_class 2: 0.7270
2024-08-15 17:49:22,792 : INFO : Average F1 score: 0.7110
2024-08-15 17:49:23,258 : INFO : Average loss over validation batches: 0.4452
2024-08-15 17:49:23,258 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:23,258 : INFO : Validation metrics:
2024-08-15 17:49:23,258 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:23,262 : INFO : Accuracy: 0.8442
2024-08-15 17:49:23,262 : INFO : Precision score for label_class 0: 0.7174
2024-08-15 17:49:23,262 : INFO : Precision score for label_class 1: 0.8608
2024-08-15 17:49:23,262 : INFO : Precision score for label_class 2: 0.8742
2024-08-15 17:49:23,262 : INFO : Recall score for label_class 0: 0.7586
2024-08-15 17:49:23,262 : INFO : Recall score for label_class 1: 0.9513
2024-08-15 17:49:23,262 : INFO : Recall score for label_class 2: 0.6701
2024-08-15 17:49:23,262 : INFO : Average F1 score: 0.7999
2024-08-15 17:49:23,262 : INFO : Validation metric decreased (0.701274 --> 0.445163).  Saving model ...
2024-08-15 17:49:23,363 : INFO : Starting epoch 3
2024-08-15 17:49:23,823 : INFO : Current training batch loss: 0.3358 in epoch 3
2024-08-15 17:49:24,649 : INFO : Current training batch loss: 0.3545 in epoch 3
2024-08-15 17:49:25,468 : INFO : Current training batch loss: 0.2705 in epoch 3
2024-08-15 17:49:26,291 : INFO : Current training batch loss: 0.1231 in epoch 3
2024-08-15 17:49:26,851 : INFO : Epoch finished, average loss over training batches: 0.3015
2024-08-15 17:49:26,851 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:26,851 : INFO : Training metrics:
2024-08-15 17:49:26,851 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:26,858 : INFO : Accuracy: 0.9077
2024-08-15 17:49:26,858 : INFO : Precision score for label_class 0: 0.8269
2024-08-15 17:49:26,858 : INFO : Precision score for label_class 1: 0.9371
2024-08-15 17:49:26,858 : INFO : Precision score for label_class 2: 0.8788
2024-08-15 17:49:26,858 : INFO : Recall score for label_class 0: 0.8471
2024-08-15 17:49:26,858 : INFO : Recall score for label_class 1: 0.9469
2024-08-15 17:49:26,858 : INFO : Recall score for label_class 2: 0.8495
2024-08-15 17:49:26,858 : INFO : Average F1 score: 0.8809
2024-08-15 17:49:27,326 : INFO : Average loss over validation batches: 0.3820
2024-08-15 17:49:27,327 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:27,327 : INFO : Validation metrics:
2024-08-15 17:49:27,327 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:27,330 : INFO : Accuracy: 0.8576
2024-08-15 17:49:27,330 : INFO : Precision score for label_class 0: 0.8784
2024-08-15 17:49:27,330 : INFO : Precision score for label_class 1: 0.9021
2024-08-15 17:49:27,330 : INFO : Precision score for label_class 2: 0.7689
2024-08-15 17:49:27,330 : INFO : Recall score for label_class 0: 0.7471
2024-08-15 17:49:27,330 : INFO : Recall score for label_class 1: 0.8974
2024-08-15 17:49:27,330 : INFO : Recall score for label_class 2: 0.8274
2024-08-15 17:49:27,330 : INFO : Average F1 score: 0.8348
2024-08-15 17:49:27,330 : INFO : Validation metric decreased (0.445163 --> 0.382049).  Saving model ...
2024-08-15 17:49:27,432 : INFO : Starting epoch 4
2024-08-15 17:49:27,687 : INFO : Current training batch loss: 0.3373 in epoch 4
2024-08-15 17:49:28,507 : INFO : Current training batch loss: 0.2535 in epoch 4
2024-08-15 17:49:29,327 : INFO : Current training batch loss: 0.1395 in epoch 4
2024-08-15 17:49:30,148 : INFO : Current training batch loss: 0.1523 in epoch 4
2024-08-15 17:49:30,910 : INFO : Epoch finished, average loss over training batches: 0.1927
2024-08-15 17:49:30,910 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:30,910 : INFO : Training metrics:
2024-08-15 17:49:30,910 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:30,915 : INFO : Accuracy: 0.9474
2024-08-15 17:49:30,915 : INFO : Precision score for label_class 0: 0.8896
2024-08-15 17:49:30,915 : INFO : Precision score for label_class 1: 0.9673
2024-08-15 17:49:30,915 : INFO : Precision score for label_class 2: 0.9298
2024-08-15 17:49:30,915 : INFO : Recall score for label_class 0: 0.9113
2024-08-15 17:49:30,916 : INFO : Recall score for label_class 1: 0.9685
2024-08-15 17:49:30,916 : INFO : Recall score for label_class 2: 0.9174
2024-08-15 17:49:30,916 : INFO : Average F1 score: 0.9306
2024-08-15 17:49:31,382 : INFO : Average loss over validation batches: 0.3525
2024-08-15 17:49:31,382 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:31,382 : INFO : Validation metrics:
2024-08-15 17:49:31,382 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:31,386 : INFO : Accuracy: 0.8754
2024-08-15 17:49:31,386 : INFO : Precision score for label_class 0: 0.7629
2024-08-15 17:49:31,386 : INFO : Precision score for label_class 1: 0.9089
2024-08-15 17:49:31,386 : INFO : Precision score for label_class 2: 0.8626
2024-08-15 17:49:31,386 : INFO : Recall score for label_class 0: 0.8506
2024-08-15 17:49:31,386 : INFO : Recall score for label_class 1: 0.9205
2024-08-15 17:49:31,386 : INFO : Recall score for label_class 2: 0.7970
2024-08-15 17:49:31,386 : INFO : Average F1 score: 0.8492
2024-08-15 17:49:31,386 : INFO : Validation metric decreased (0.382049 --> 0.352490).  Saving model ...
2024-08-15 17:49:31,488 : INFO : Starting epoch 5
2024-08-15 17:49:31,540 : INFO : Current training batch loss: 0.1011 in epoch 5
2024-08-15 17:49:32,365 : INFO : Current training batch loss: 0.1069 in epoch 5
2024-08-15 17:49:33,188 : INFO : Current training batch loss: 0.0935 in epoch 5
2024-08-15 17:49:34,006 : INFO : Current training batch loss: 0.0704 in epoch 5
2024-08-15 17:49:34,825 : INFO : Current training batch loss: 0.3155 in epoch 5
2024-08-15 17:49:34,977 : INFO : Epoch finished, average loss over training batches: 0.1268
2024-08-15 17:49:34,977 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:34,977 : INFO : Training metrics:
2024-08-15 17:49:34,977 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:34,984 : INFO : Accuracy: 0.9718
2024-08-15 17:49:34,984 : INFO : Precision score for label_class 0: 0.9120
2024-08-15 17:49:34,984 : INFO : Precision score for label_class 1: 0.9834
2024-08-15 17:49:34,984 : INFO : Precision score for label_class 2: 0.9741
2024-08-15 17:49:34,984 : INFO : Recall score for label_class 0: 0.9511
2024-08-15 17:49:34,984 : INFO : Recall score for label_class 1: 0.9846
2024-08-15 17:49:34,984 : INFO : Recall score for label_class 2: 0.9534
2024-08-15 17:49:34,984 : INFO : Average F1 score: 0.9596
2024-08-15 17:49:35,450 : INFO : Average loss over validation batches: 0.3860
2024-08-15 17:49:35,450 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:35,450 : INFO : Validation metrics:
2024-08-15 17:49:35,450 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:35,454 : INFO : Accuracy: 0.8739
2024-08-15 17:49:35,454 : INFO : Precision score for label_class 0: 0.7708
2024-08-15 17:49:35,454 : INFO : Precision score for label_class 1: 0.9215
2024-08-15 17:49:35,454 : INFO : Precision score for label_class 2: 0.8316
2024-08-15 17:49:35,454 : INFO : Recall score for label_class 0: 0.8506
2024-08-15 17:49:35,454 : INFO : Recall score for label_class 1: 0.9026
2024-08-15 17:49:35,454 : INFO : Recall score for label_class 2: 0.8274
2024-08-15 17:49:35,454 : INFO : Average F1 score: 0.8501
2024-08-15 17:49:35,454 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:49:35,454 : INFO : Starting epoch 6
2024-08-15 17:49:36,119 : INFO : Current training batch loss: 0.0916 in epoch 6
2024-08-15 17:49:36,943 : INFO : Current training batch loss: 0.0495 in epoch 6
2024-08-15 17:49:37,764 : INFO : Current training batch loss: 0.0402 in epoch 6
2024-08-15 17:49:38,582 : INFO : Current training batch loss: 0.0350 in epoch 6
2024-08-15 17:49:38,937 : INFO : Epoch finished, average loss over training batches: 0.0931
2024-08-15 17:49:38,937 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:38,937 : INFO : Training metrics:
2024-08-15 17:49:38,937 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:38,944 : INFO : Accuracy: 0.9807
2024-08-15 17:49:38,944 : INFO : Precision score for label_class 0: 0.9375
2024-08-15 17:49:38,944 : INFO : Precision score for label_class 1: 0.9913
2024-08-15 17:49:38,944 : INFO : Precision score for label_class 2: 0.9772
2024-08-15 17:49:38,944 : INFO : Recall score for label_class 0: 0.9633
2024-08-15 17:49:38,944 : INFO : Recall score for label_class 1: 0.9883
2024-08-15 17:49:38,944 : INFO : Recall score for label_class 2: 0.9720
2024-08-15 17:49:38,944 : INFO : Average F1 score: 0.9716
2024-08-15 17:49:39,412 : INFO : Average loss over validation batches: 0.4177
2024-08-15 17:49:39,412 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:39,412 : INFO : Validation metrics:
2024-08-15 17:49:39,412 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:39,416 : INFO : Accuracy: 0.8798
2024-08-15 17:49:39,416 : INFO : Precision score for label_class 0: 0.7957
2024-08-15 17:49:39,416 : INFO : Precision score for label_class 1: 0.8854
2024-08-15 17:49:39,416 : INFO : Precision score for label_class 2: 0.9136
2024-08-15 17:49:39,416 : INFO : Recall score for label_class 0: 0.8506
2024-08-15 17:49:39,416 : INFO : Recall score for label_class 1: 0.9513
2024-08-15 17:49:39,416 : INFO : Recall score for label_class 2: 0.7513
2024-08-15 17:49:39,416 : INFO : Average F1 score: 0.8546
2024-08-15 17:49:39,416 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:49:39,416 : INFO : Starting epoch 7
2024-08-15 17:49:39,881 : INFO : Current training batch loss: 0.0448 in epoch 7
2024-08-15 17:49:40,702 : INFO : Current training batch loss: 0.1064 in epoch 7
2024-08-15 17:49:41,519 : INFO : Current training batch loss: 0.0356 in epoch 7
2024-08-15 17:49:42,345 : INFO : Current training batch loss: 0.0335 in epoch 7
2024-08-15 17:49:42,906 : INFO : Epoch finished, average loss over training batches: 0.0797
2024-08-15 17:49:42,907 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:42,907 : INFO : Training metrics:
2024-08-15 17:49:42,907 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:42,914 : INFO : Accuracy: 0.9833
2024-08-15 17:49:42,914 : INFO : Precision score for label_class 0: 0.9405
2024-08-15 17:49:42,914 : INFO : Precision score for label_class 1: 0.9938
2024-08-15 17:49:42,914 : INFO : Precision score for label_class 2: 0.9799
2024-08-15 17:49:42,914 : INFO : Recall score for label_class 0: 0.9664
2024-08-15 17:49:42,914 : INFO : Recall score for label_class 1: 0.9907
2024-08-15 17:49:42,914 : INFO : Recall score for label_class 2: 0.9747
2024-08-15 17:49:42,914 : INFO : Average F1 score: 0.9743
2024-08-15 17:49:43,381 : INFO : Average loss over validation batches: 0.3930
2024-08-15 17:49:43,381 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:43,381 : INFO : Validation metrics:
2024-08-15 17:49:43,381 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:43,385 : INFO : Accuracy: 0.8769
2024-08-15 17:49:43,385 : INFO : Precision score for label_class 0: 0.8182
2024-08-15 17:49:43,385 : INFO : Precision score for label_class 1: 0.9126
2024-08-15 17:49:43,385 : INFO : Precision score for label_class 2: 0.8325
2024-08-15 17:49:43,385 : INFO : Recall score for label_class 0: 0.8276
2024-08-15 17:49:43,385 : INFO : Recall score for label_class 1: 0.9103
2024-08-15 17:49:43,385 : INFO : Recall score for label_class 2: 0.8325
2024-08-15 17:49:43,385 : INFO : Average F1 score: 0.8556
2024-08-15 17:49:43,385 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:49:43,385 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:49:43,420 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:49:44,009 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:44,009 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:49:44,009 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:44,013 : INFO : Accuracy: 0.8754
2024-08-15 17:49:44,013 : INFO : Precision score for label_class 0: 0.7629
2024-08-15 17:49:44,013 : INFO : Precision score for label_class 1: 0.9089
2024-08-15 17:49:44,013 : INFO : Precision score for label_class 2: 0.8626
2024-08-15 17:49:44,013 : INFO : Recall score for label_class 0: 0.8506
2024-08-15 17:49:44,013 : INFO : Recall score for label_class 1: 0.9205
2024-08-15 17:49:44,013 : INFO : Recall score for label_class 2: 0.7970
2024-08-15 17:49:44,013 : INFO : Average F1 score: 0.8492
2024-08-15 17:49:44,013 : INFO : Determined score from best model, ending training.
2024-08-15 17:49:44,015 : INFO : Split 4 is finished, the score is: 0.8492
2024-08-15 17:49:44,015 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:44,015 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:44,015 : INFO : Starting training for split 5
2024-08-15 17:49:44,029 : INFO : Starting to tokenize the sequences.
2024-08-15 17:49:44,034 : INFO : Tokenization is finished.
2024-08-15 17:49:44,051 : INFO : Starting to tokenize the sequences.
2024-08-15 17:49:44,056 : INFO : Tokenization is finished.
2024-08-15 17:49:44,061 : INFO : Counting occurences of labels...
2024-08-15 17:49:44,062 : INFO : Occurence of labels for training data: (array([0, 1, 2]), array([ 330, 1615,  754]))
2024-08-15 17:49:44,062 : INFO : Occurence of labels for test data: (array([0, 1, 2]), array([ 84, 396, 194]))
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:49:44,106 : INFO : Starting epoch 1
2024-08-15 17:49:44,158 : INFO : Current training batch loss: 1.1109 in epoch 1
2024-08-15 17:49:44,983 : INFO : Current training batch loss: 1.0577 in epoch 1
2024-08-15 17:49:45,805 : INFO : Current training batch loss: 0.9222 in epoch 1
2024-08-15 17:49:46,623 : INFO : Current training batch loss: 0.8164 in epoch 1
2024-08-15 17:49:47,444 : INFO : Current training batch loss: 0.7485 in epoch 1
2024-08-15 17:49:47,598 : INFO : Epoch finished, average loss over training batches: 0.9122
2024-08-15 17:49:47,599 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:47,599 : INFO : Training metrics:
2024-08-15 17:49:47,599 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:47,609 : INFO : Accuracy: 0.5798
2024-08-15 17:49:47,609 : INFO : Precision score for label_class 0: 0.1425
2024-08-15 17:49:47,609 : INFO : Precision score for label_class 1: 0.6593
2024-08-15 17:49:47,609 : INFO : Precision score for label_class 2: 0.5586
2024-08-15 17:49:47,609 : INFO : Recall score for label_class 0: 0.1576
2024-08-15 17:49:47,609 : INFO : Recall score for label_class 1: 0.8483
2024-08-15 17:49:47,609 : INFO : Recall score for label_class 2: 0.1897
2024-08-15 17:49:47,609 : INFO : Average F1 score: 0.3916
2024-08-15 17:49:48,076 : INFO : Average loss over validation batches: 0.6555
2024-08-15 17:49:48,077 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:48,077 : INFO : Validation metrics:
2024-08-15 17:49:48,077 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:48,080 : INFO : Accuracy: 0.7255
2024-08-15 17:49:48,080 : INFO : Precision score for label_class 0: 0.0000
2024-08-15 17:49:48,080 : INFO : Precision score for label_class 1: 0.8147
2024-08-15 17:49:48,080 : INFO : Precision score for label_class 2: 0.5487
2024-08-15 17:49:48,080 : INFO : Recall score for label_class 0: 0.0000
2024-08-15 17:49:48,080 : INFO : Recall score for label_class 1: 0.9217
2024-08-15 17:49:48,080 : INFO : Recall score for label_class 2: 0.6392
2024-08-15 17:49:48,080 : INFO : Average F1 score: 0.4851
2024-08-15 17:49:48,080 : INFO : Validation metric decreased (inf --> 0.655534).  Saving model ...
2024-08-15 17:49:48,182 : INFO : Starting epoch 2
2024-08-15 17:49:48,844 : INFO : Current training batch loss: 0.6295 in epoch 2
2024-08-15 17:49:49,664 : INFO : Current training batch loss: 0.4927 in epoch 2
2024-08-15 17:49:50,485 : INFO : Current training batch loss: 0.3520 in epoch 2
2024-08-15 17:49:51,310 : INFO : Current training batch loss: 0.4540 in epoch 2
2024-08-15 17:49:51,668 : INFO : Epoch finished, average loss over training batches: 0.5191
2024-08-15 17:49:51,668 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:51,668 : INFO : Training metrics:
2024-08-15 17:49:51,668 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:51,678 : INFO : Accuracy: 0.8214
2024-08-15 17:49:51,679 : INFO : Precision score for label_class 0: 0.7510
2024-08-15 17:49:51,679 : INFO : Precision score for label_class 1: 0.8624
2024-08-15 17:49:51,679 : INFO : Precision score for label_class 2: 0.7440
2024-08-15 17:49:51,679 : INFO : Recall score for label_class 0: 0.5485
2024-08-15 17:49:51,679 : INFO : Recall score for label_class 1: 0.9350
2024-08-15 17:49:51,679 : INFO : Recall score for label_class 2: 0.6976
2024-08-15 17:49:51,679 : INFO : Average F1 score: 0.7504
2024-08-15 17:49:52,144 : INFO : Average loss over validation batches: 0.4599
2024-08-15 17:49:52,145 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:52,145 : INFO : Validation metrics:
2024-08-15 17:49:52,145 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:52,149 : INFO : Accuracy: 0.8309
2024-08-15 17:49:52,149 : INFO : Precision score for label_class 0: 0.8226
2024-08-15 17:49:52,149 : INFO : Precision score for label_class 1: 0.8462
2024-08-15 17:49:52,149 : INFO : Precision score for label_class 2: 0.7941
2024-08-15 17:49:52,149 : INFO : Recall score for label_class 0: 0.6071
2024-08-15 17:49:52,149 : INFO : Recall score for label_class 1: 0.9444
2024-08-15 17:49:52,149 : INFO : Recall score for label_class 2: 0.6959
2024-08-15 17:49:52,149 : INFO : Average F1 score: 0.7777
2024-08-15 17:49:52,149 : INFO : Validation metric decreased (0.655534 --> 0.459865).  Saving model ...
2024-08-15 17:49:52,252 : INFO : Starting epoch 3
2024-08-15 17:49:52,717 : INFO : Current training batch loss: 0.2946 in epoch 3
2024-08-15 17:49:53,541 : INFO : Current training batch loss: 0.4218 in epoch 3
2024-08-15 17:49:54,364 : INFO : Current training batch loss: 0.2469 in epoch 3
2024-08-15 17:49:55,186 : INFO : Current training batch loss: 0.1743 in epoch 3
2024-08-15 17:49:55,745 : INFO : Epoch finished, average loss over training batches: 0.2917
2024-08-15 17:49:55,746 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:55,746 : INFO : Training metrics:
2024-08-15 17:49:55,746 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:55,753 : INFO : Accuracy: 0.9111
2024-08-15 17:49:55,753 : INFO : Precision score for label_class 0: 0.8432
2024-08-15 17:49:55,753 : INFO : Precision score for label_class 1: 0.9401
2024-08-15 17:49:55,753 : INFO : Precision score for label_class 2: 0.8785
2024-08-15 17:49:55,753 : INFO : Recall score for label_class 0: 0.8636
2024-08-15 17:49:55,753 : INFO : Recall score for label_class 1: 0.9430
2024-08-15 17:49:55,753 : INFO : Recall score for label_class 2: 0.8634
2024-08-15 17:49:55,753 : INFO : Average F1 score: 0.8886
2024-08-15 17:49:56,219 : INFO : Average loss over validation batches: 0.4113
2024-08-15 17:49:56,220 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:56,220 : INFO : Validation metrics:
2024-08-15 17:49:56,220 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:56,223 : INFO : Accuracy: 0.8442
2024-08-15 17:49:56,223 : INFO : Precision score for label_class 0: 0.8235
2024-08-15 17:49:56,223 : INFO : Precision score for label_class 1: 0.8642
2024-08-15 17:49:56,224 : INFO : Precision score for label_class 2: 0.8045
2024-08-15 17:49:56,224 : INFO : Recall score for label_class 0: 0.6667
2024-08-15 17:49:56,224 : INFO : Recall score for label_class 1: 0.9318
2024-08-15 17:49:56,224 : INFO : Recall score for label_class 2: 0.7423
2024-08-15 17:49:56,224 : INFO : Average F1 score: 0.8019
2024-08-15 17:49:56,224 : INFO : Validation metric decreased (0.459865 --> 0.411287).  Saving model ...
2024-08-15 17:49:56,326 : INFO : Starting epoch 4
2024-08-15 17:49:56,580 : INFO : Current training batch loss: 0.3891 in epoch 4
2024-08-15 17:49:57,403 : INFO : Current training batch loss: 0.2573 in epoch 4
2024-08-15 17:49:58,220 : INFO : Current training batch loss: 0.1473 in epoch 4
2024-08-15 17:49:59,038 : INFO : Current training batch loss: 0.1267 in epoch 4
2024-08-15 17:49:59,796 : INFO : Epoch finished, average loss over training batches: 0.1883
2024-08-15 17:49:59,796 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:59,796 : INFO : Training metrics:
2024-08-15 17:49:59,796 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:49:59,804 : INFO : Accuracy: 0.9459
2024-08-15 17:49:59,804 : INFO : Precision score for label_class 0: 0.8964
2024-08-15 17:49:59,804 : INFO : Precision score for label_class 1: 0.9612
2024-08-15 17:49:59,804 : INFO : Precision score for label_class 2: 0.9348
2024-08-15 17:49:59,804 : INFO : Recall score for label_class 0: 0.9182
2024-08-15 17:49:59,804 : INFO : Recall score for label_class 1: 0.9672
2024-08-15 17:49:59,804 : INFO : Recall score for label_class 2: 0.9125
2024-08-15 17:49:59,804 : INFO : Average F1 score: 0.9316
2024-08-15 17:50:00,269 : INFO : Average loss over validation batches: 0.3960
2024-08-15 17:50:00,269 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:50:00,269 : INFO : Validation metrics:
2024-08-15 17:50:00,269 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:50:00,273 : INFO : Accuracy: 0.8605
2024-08-15 17:50:00,273 : INFO : Precision score for label_class 0: 0.7955
2024-08-15 17:50:00,273 : INFO : Precision score for label_class 1: 0.8990
2024-08-15 17:50:00,273 : INFO : Precision score for label_class 2: 0.8105
2024-08-15 17:50:00,273 : INFO : Recall score for label_class 0: 0.8333
2024-08-15 17:50:00,273 : INFO : Recall score for label_class 1: 0.8990
2024-08-15 17:50:00,273 : INFO : Recall score for label_class 2: 0.7938
2024-08-15 17:50:00,273 : INFO : Average F1 score: 0.8383
2024-08-15 17:50:00,273 : INFO : Validation metric decreased (0.411287 --> 0.396020).  Saving model ...
2024-08-15 17:50:00,375 : INFO : Starting epoch 5
2024-08-15 17:50:00,426 : INFO : Current training batch loss: 0.1193 in epoch 5
2024-08-15 17:50:01,248 : INFO : Current training batch loss: 0.1965 in epoch 5
2024-08-15 17:50:02,065 : INFO : Current training batch loss: 0.0446 in epoch 5
2024-08-15 17:50:02,880 : INFO : Current training batch loss: 0.1429 in epoch 5
2024-08-15 17:50:03,695 : INFO : Current training batch loss: 0.0499 in epoch 5
2024-08-15 17:50:03,846 : INFO : Epoch finished, average loss over training batches: 0.1208
2024-08-15 17:50:03,846 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:50:03,846 : INFO : Training metrics:
2024-08-15 17:50:03,846 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:50:03,857 : INFO : Accuracy: 0.9711
2024-08-15 17:50:03,857 : INFO : Precision score for label_class 0: 0.9254
2024-08-15 17:50:03,857 : INFO : Precision score for label_class 1: 0.9845
2024-08-15 17:50:03,857 : INFO : Precision score for label_class 2: 0.9628
2024-08-15 17:50:03,857 : INFO : Recall score for label_class 0: 0.9394
2024-08-15 17:50:03,857 : INFO : Recall score for label_class 1: 0.9820
2024-08-15 17:50:03,857 : INFO : Recall score for label_class 2: 0.9615
2024-08-15 17:50:03,857 : INFO : Average F1 score: 0.9593
2024-08-15 17:50:04,323 : INFO : Average loss over validation batches: 0.4240
2024-08-15 17:50:04,323 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:50:04,323 : INFO : Validation metrics:
2024-08-15 17:50:04,323 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:50:04,327 : INFO : Accuracy: 0.8501
2024-08-15 17:50:04,327 : INFO : Precision score for label_class 0: 0.7320
2024-08-15 17:50:04,327 : INFO : Precision score for label_class 1: 0.9288
2024-08-15 17:50:04,327 : INFO : Precision score for label_class 2: 0.7689
2024-08-15 17:50:04,327 : INFO : Recall score for label_class 0: 0.8452
2024-08-15 17:50:04,327 : INFO : Recall score for label_class 1: 0.8561
2024-08-15 17:50:04,327 : INFO : Recall score for label_class 2: 0.8402
2024-08-15 17:50:04,327 : INFO : Average F1 score: 0.8261
2024-08-15 17:50:04,327 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:50:04,327 : INFO : Starting epoch 6
2024-08-15 17:50:04,980 : INFO : Current training batch loss: 0.1436 in epoch 6
2024-08-15 17:50:05,796 : INFO : Current training batch loss: 0.1220 in epoch 6
2024-08-15 17:50:06,611 : INFO : Current training batch loss: 0.0438 in epoch 6
2024-08-15 17:50:07,426 : INFO : Current training batch loss: 0.1057 in epoch 6
2024-08-15 17:50:07,778 : INFO : Epoch finished, average loss over training batches: 0.0908
2024-08-15 17:50:07,779 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:50:07,779 : INFO : Training metrics:
2024-08-15 17:50:07,779 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:50:07,786 : INFO : Accuracy: 0.9818
2024-08-15 17:50:07,786 : INFO : Precision score for label_class 0: 0.9384
2024-08-15 17:50:07,787 : INFO : Precision score for label_class 1: 0.9931
2024-08-15 17:50:07,787 : INFO : Precision score for label_class 2: 0.9774
2024-08-15 17:50:07,787 : INFO : Recall score for label_class 0: 0.9697
2024-08-15 17:50:07,787 : INFO : Recall score for label_class 1: 0.9870
2024-08-15 17:50:07,787 : INFO : Recall score for label_class 2: 0.9761
2024-08-15 17:50:07,787 : INFO : Average F1 score: 0.9735
2024-08-15 17:50:08,254 : INFO : Average loss over validation batches: 0.4279
2024-08-15 17:50:08,254 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:50:08,254 : INFO : Validation metrics:
2024-08-15 17:50:08,254 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:50:08,257 : INFO : Accuracy: 0.8605
2024-08-15 17:50:08,257 : INFO : Precision score for label_class 0: 0.8025
2024-08-15 17:50:08,257 : INFO : Precision score for label_class 1: 0.9084
2024-08-15 17:50:08,257 : INFO : Precision score for label_class 2: 0.7900
2024-08-15 17:50:08,257 : INFO : Recall score for label_class 0: 0.7738
2024-08-15 17:50:08,257 : INFO : Recall score for label_class 1: 0.9015
2024-08-15 17:50:08,257 : INFO : Recall score for label_class 2: 0.8144
2024-08-15 17:50:08,257 : INFO : Average F1 score: 0.8316
2024-08-15 17:50:08,257 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:50:08,257 : INFO : Starting epoch 7
2024-08-15 17:50:08,710 : INFO : Current training batch loss: 0.0298 in epoch 7
2024-08-15 17:50:09,525 : INFO : Current training batch loss: 0.0534 in epoch 7
2024-08-15 17:50:10,340 : INFO : Current training batch loss: 0.0359 in epoch 7
2024-08-15 17:50:11,156 : INFO : Current training batch loss: 0.0271 in epoch 7
2024-08-15 17:50:11,709 : INFO : Epoch finished, average loss over training batches: 0.0710
2024-08-15 17:50:11,710 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:50:11,710 : INFO : Training metrics:
2024-08-15 17:50:11,710 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:50:11,717 : INFO : Accuracy: 0.9870
2024-08-15 17:50:11,717 : INFO : Precision score for label_class 0: 0.9474
2024-08-15 17:50:11,717 : INFO : Precision score for label_class 1: 0.9956
2024-08-15 17:50:11,717 : INFO : Precision score for label_class 2: 0.9867
2024-08-15 17:50:11,717 : INFO : Recall score for label_class 0: 0.9818
2024-08-15 17:50:11,717 : INFO : Recall score for label_class 1: 0.9907
2024-08-15 17:50:11,717 : INFO : Recall score for label_class 2: 0.9814
2024-08-15 17:50:11,717 : INFO : Average F1 score: 0.9805
2024-08-15 17:50:12,184 : INFO : Average loss over validation batches: 0.4389
2024-08-15 17:50:12,184 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:50:12,184 : INFO : Validation metrics:
2024-08-15 17:50:12,184 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:50:12,187 : INFO : Accuracy: 0.8591
2024-08-15 17:50:12,187 : INFO : Precision score for label_class 0: 0.8158
2024-08-15 17:50:12,187 : INFO : Precision score for label_class 1: 0.8983
2024-08-15 17:50:12,187 : INFO : Precision score for label_class 2: 0.7949
2024-08-15 17:50:12,187 : INFO : Recall score for label_class 0: 0.7381
2024-08-15 17:50:12,187 : INFO : Recall score for label_class 1: 0.9141
2024-08-15 17:50:12,187 : INFO : Recall score for label_class 2: 0.7990
2024-08-15 17:50:12,187 : INFO : Average F1 score: 0.8260
2024-08-15 17:50:12,187 : INFO : EarlyStopping counter: 3 out of 3
2024-08-15 17:50:12,187 : INFO : Early stopping, loading best model from before and determine score...
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:50:12,219 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/current_split_model/checkpoint.pth
2024-08-15 17:50:12,714 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:50:12,714 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:50:12,714 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:50:12,718 : INFO : Accuracy: 0.8605
2024-08-15 17:50:12,718 : INFO : Precision score for label_class 0: 0.7955
2024-08-15 17:50:12,718 : INFO : Precision score for label_class 1: 0.8990
2024-08-15 17:50:12,718 : INFO : Precision score for label_class 2: 0.8105
2024-08-15 17:50:12,718 : INFO : Recall score for label_class 0: 0.8333
2024-08-15 17:50:12,718 : INFO : Recall score for label_class 1: 0.8990
2024-08-15 17:50:12,718 : INFO : Recall score for label_class 2: 0.7938
2024-08-15 17:50:12,718 : INFO : Average F1 score: 0.8383
2024-08-15 17:50:12,718 : INFO : Determined score from best model, ending training.
2024-08-15 17:50:12,719 : INFO : Split 5 is finished, the score is: 0.8383
2024-08-15 17:50:12,720 : INFO : ----------------------------------------------------------------------------------------------------
[I 2024-08-15 17:50:12,729] Trial 24 finished with value: 0.8472194446360936 and parameters: {'n_epochs': 7, 'learning_rate': 4.1040048213108805e-05, 'classifier_dropout': 0.8848532437783084, 'warmup_step_fraction': 0.06671469783349737, 'use_gradient_clipping': False}. Best is trial 1 with value: 0.8513001269595835.
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:50:12,770 : INFO : Starting epoch 1
2024-08-15 17:50:12,821 : INFO : Current training batch loss: 1.1142 in epoch 1
2024-08-15 17:50:13,637 : INFO : Current training batch loss: 0.9786 in epoch 1
2024-08-15 17:50:14,452 : INFO : Current training batch loss: 0.7529 in epoch 1
2024-08-15 17:50:15,267 : INFO : Current training batch loss: 0.5985 in epoch 1
2024-08-15 17:50:16,082 : INFO : Current training batch loss: 0.5161 in epoch 1
2024-08-15 17:50:16,897 : INFO : Current training batch loss: 0.4814 in epoch 1
2024-08-15 17:50:17,089 : INFO : Epoch finished, average loss over training batches: 0.7353
2024-08-15 17:50:17,090 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:50:17,090 : INFO : Training metrics:
2024-08-15 17:50:17,090 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:50:17,103 : INFO : Accuracy: 0.7009
2024-08-15 17:50:17,103 : INFO : Precision score for label_class 0: 0.4793
2024-08-15 17:50:17,103 : INFO : Precision score for label_class 1: 0.7437
2024-08-15 17:50:17,103 : INFO : Precision score for label_class 2: 0.5971
2024-08-15 17:50:17,103 : INFO : Recall score for label_class 0: 0.1401
2024-08-15 17:50:17,103 : INFO : Recall score for label_class 1: 0.9189
2024-08-15 17:50:17,103 : INFO : Recall score for label_class 2: 0.4831
2024-08-15 17:50:17,103 : INFO : Average F1 score: 0.5243
2024-08-15 17:50:17,684 : INFO : Average loss over validation batches: 0.4659
2024-08-15 17:50:17,684 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:50:17,684 : INFO : Validation metrics:
2024-08-15 17:50:17,684 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:50:17,687 : INFO : Accuracy: 0.8412
2024-08-15 17:50:17,687 : INFO : Precision score for label_class 0: 0.7711
2024-08-15 17:50:17,687 : INFO : Precision score for label_class 1: 0.8755
2024-08-15 17:50:17,687 : INFO : Precision score for label_class 2: 0.7814
2024-08-15 17:50:17,687 : INFO : Recall score for label_class 0: 0.6400
2024-08-15 17:50:17,687 : INFO : Recall score for label_class 1: 0.9122
2024-08-15 17:50:17,687 : INFO : Recall score for label_class 2: 0.7636
2024-08-15 17:50:17,687 : INFO : Average F1 score: 0.7884
2024-08-15 17:50:17,687 : INFO : Validation metric decreased (inf --> 0.465854).  Saving model ...
2024-08-15 17:50:17,760 : INFO : Starting epoch 2
2024-08-15 17:50:18,375 : INFO : Current training batch loss: 0.5908 in epoch 2
2024-08-15 17:50:19,190 : INFO : Current training batch loss: 0.3768 in epoch 2
2024-08-15 17:50:20,005 : INFO : Current training batch loss: 0.3261 in epoch 2
2024-08-15 17:50:20,820 : INFO : Current training batch loss: 0.2477 in epoch 2
2024-08-15 17:50:21,636 : INFO : Current training batch loss: 0.3616 in epoch 2
2024-08-15 17:50:22,069 : INFO : Epoch finished, average loss over training batches: 0.3533
2024-08-15 17:50:22,070 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:50:22,070 : INFO : Training metrics:
2024-08-15 17:50:22,070 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:50:22,082 : INFO : Accuracy: 0.8829
2024-08-15 17:50:22,082 : INFO : Precision score for label_class 0: 0.7867
2024-08-15 17:50:22,082 : INFO : Precision score for label_class 1: 0.9153
2024-08-15 17:50:22,082 : INFO : Precision score for label_class 2: 0.8538
2024-08-15 17:50:22,082 : INFO : Recall score for label_class 0: 0.8019
2024-08-15 17:50:22,082 : INFO : Recall score for label_class 1: 0.9354
2024-08-15 17:50:22,082 : INFO : Recall score for label_class 2: 0.8070
2024-08-15 17:50:22,082 : INFO : Average F1 score: 0.8497
2024-08-15 17:50:22,664 : INFO : Average loss over validation batches: 0.3390
2024-08-15 17:50:22,664 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:50:22,664 : INFO : Validation metrics:
2024-08-15 17:50:22,664 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:50:22,667 : INFO : Accuracy: 0.8756
2024-08-15 17:50:22,667 : INFO : Precision score for label_class 0: 0.8352
2024-08-15 17:50:22,667 : INFO : Precision score for label_class 1: 0.9112
2024-08-15 17:50:22,667 : INFO : Precision score for label_class 2: 0.8080
2024-08-15 17:50:22,667 : INFO : Recall score for label_class 0: 0.7600
2024-08-15 17:50:22,667 : INFO : Recall score for label_class 1: 0.9198
2024-08-15 17:50:22,667 : INFO : Recall score for label_class 2: 0.8227
2024-08-15 17:50:22,667 : INFO : Average F1 score: 0.8422
2024-08-15 17:50:22,667 : INFO : Validation metric decreased (0.465854 --> 0.338953).  Saving model ...
2024-08-15 17:50:22,766 : INFO : Starting epoch 3
2024-08-15 17:50:23,139 : INFO : Current training batch loss: 0.2173 in epoch 3
2024-08-15 17:50:23,954 : INFO : Current training batch loss: 0.1296 in epoch 3
2024-08-15 17:50:24,770 : INFO : Current training batch loss: 0.1263 in epoch 3
2024-08-15 17:50:25,585 : INFO : Current training batch loss: 0.1749 in epoch 3
2024-08-15 17:50:26,400 : INFO : Current training batch loss: 0.2273 in epoch 3
2024-08-15 17:50:27,075 : INFO : Epoch finished, average loss over training batches: 0.2090
2024-08-15 17:50:27,075 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:50:27,075 : INFO : Training metrics:
2024-08-15 17:50:27,075 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:50:27,084 : INFO : Accuracy: 0.9389
2024-08-15 17:50:27,084 : INFO : Precision score for label_class 0: 0.8667
2024-08-15 17:50:27,084 : INFO : Precision score for label_class 1: 0.9580
2024-08-15 17:50:27,084 : INFO : Precision score for label_class 2: 0.9309
2024-08-15 17:50:27,084 : INFO : Recall score for label_class 0: 0.9106
2024-08-15 17:50:27,084 : INFO : Recall score for label_class 1: 0.9652
2024-08-15 17:50:27,084 : INFO : Recall score for label_class 2: 0.8956
2024-08-15 17:50:27,084 : INFO : Average F1 score: 0.9209
2024-08-15 17:50:27,663 : INFO : Average loss over validation batches: 0.3524
2024-08-15 17:50:27,663 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:50:27,663 : INFO : Validation metrics:
2024-08-15 17:50:27,663 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:50:27,666 : INFO : Accuracy: 0.8661
2024-08-15 17:50:27,666 : INFO : Precision score for label_class 0: 0.7611
2024-08-15 17:50:27,666 : INFO : Precision score for label_class 1: 0.9476
2024-08-15 17:50:27,666 : INFO : Precision score for label_class 2: 0.7598
2024-08-15 17:50:27,666 : INFO : Recall score for label_class 0: 0.8600
2024-08-15 17:50:27,666 : INFO : Recall score for label_class 1: 0.8626
2024-08-15 17:50:27,666 : INFO : Recall score for label_class 2: 0.8773
2024-08-15 17:50:27,666 : INFO : Average F1 score: 0.8417
2024-08-15 17:50:27,666 : INFO : EarlyStopping counter: 1 out of 3
2024-08-15 17:50:27,666 : INFO : Starting epoch 4
2024-08-15 17:50:27,797 : INFO : Current training batch loss: 0.0975 in epoch 4
2024-08-15 17:50:28,612 : INFO : Current training batch loss: 0.0925 in epoch 4
2024-08-15 17:50:29,428 : INFO : Current training batch loss: 0.0611 in epoch 4
2024-08-15 17:50:30,244 : INFO : Current training batch loss: 0.1389 in epoch 4
2024-08-15 17:50:31,059 : INFO : Current training batch loss: 0.3256 in epoch 4
2024-08-15 17:50:31,875 : INFO : Current training batch loss: 0.4182 in epoch 4
2024-08-15 17:50:31,987 : INFO : Epoch finished, average loss over training batches: 0.1450
2024-08-15 17:50:31,987 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:50:31,987 : INFO : Training metrics:
2024-08-15 17:50:31,987 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:50:31,995 : INFO : Accuracy: 0.9612
2024-08-15 17:50:31,995 : INFO : Precision score for label_class 0: 0.9040
2024-08-15 17:50:31,995 : INFO : Precision score for label_class 1: 0.9752
2024-08-15 17:50:31,995 : INFO : Precision score for label_class 2: 0.9570
2024-08-15 17:50:31,995 : INFO : Recall score for label_class 0: 0.9324
2024-08-15 17:50:31,995 : INFO : Recall score for label_class 1: 0.9771
2024-08-15 17:50:31,995 : INFO : Recall score for label_class 2: 0.9399
2024-08-15 17:50:31,995 : INFO : Average F1 score: 0.9475
2024-08-15 17:50:32,575 : INFO : Average loss over validation batches: 0.3394
2024-08-15 17:50:32,575 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:50:32,575 : INFO : Validation metrics:
2024-08-15 17:50:32,575 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:50:32,577 : INFO : Accuracy: 0.8839
2024-08-15 17:50:32,577 : INFO : Precision score for label_class 0: 0.7961
2024-08-15 17:50:32,578 : INFO : Precision score for label_class 1: 0.9057
2024-08-15 17:50:32,578 : INFO : Precision score for label_class 2: 0.8700
2024-08-15 17:50:32,578 : INFO : Recall score for label_class 0: 0.8200
2024-08-15 17:50:32,578 : INFO : Recall score for label_class 1: 0.9351
2024-08-15 17:50:32,578 : INFO : Recall score for label_class 2: 0.7909
2024-08-15 17:50:32,578 : INFO : Average F1 score: 0.8522
2024-08-15 17:50:32,578 : INFO : EarlyStopping counter: 2 out of 3
2024-08-15 17:50:32,578 : INFO : Last epoch reached, validation loss was better before, loading best model during training.
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:50:32,610 : INFO : Loading model from /data/language_models/pretrained_models_downstreaming/financial_phrasebank/mlm_00/checkpoint.pth
2024-08-15 17:50:33,223 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:50:33,224 : INFO : Validation metrics after reloading the model before ending this training:
2024-08-15 17:50:33,224 : INFO : ----------------------------------------------------------------------------------------------------
2024-08-15 17:50:33,227 : INFO : Accuracy: 0.8756
2024-08-15 17:50:33,227 : INFO : Precision score for label_class 0: 0.8352
2024-08-15 17:50:33,227 : INFO : Precision score for label_class 1: 0.9112
2024-08-15 17:50:33,227 : INFO : Precision score for label_class 2: 0.8080
2024-08-15 17:50:33,227 : INFO : Recall score for label_class 0: 0.7600
2024-08-15 17:50:33,227 : INFO : Recall score for label_class 1: 0.9198
2024-08-15 17:50:33,227 : INFO : Recall score for label_class 2: 0.8227
2024-08-15 17:50:33,227 : INFO : Average F1 score: 0.8422
2024-08-15 17:50:33,227 : INFO : Determined score from best model, ending training.
Some weights of ElectraForSequenceClassification were not initialized from the model checkpoint at /data/language_models/pretrained_models/mlm_00/mlm_model and are newly initialized: ['classifier.dense.bias', 'classifier.dense.weight', 'classifier.out_proj.bias', 'classifier.out_proj.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
2024-08-15 17:50:33,260 : INFO : Loading model finetuned model from checkpoint.
2024-08-15 17:50:33,412 : INFO : Determining training scores of final model.
2024-08-15 17:50:34,873 : INFO : Accuracy: 0.9369
2024-08-15 17:50:34,873 : INFO : Precision score for label_class 0: 0.8663
2024-08-15 17:50:34,873 : INFO : Precision score for label_class 1: 0.9580
2024-08-15 17:50:34,873 : INFO : Precision score for label_class 2: 0.9224
2024-08-15 17:50:34,873 : INFO : Recall score for label_class 0: 0.8768
2024-08-15 17:50:34,873 : INFO : Recall score for label_class 1: 0.9652
2024-08-15 17:50:34,873 : INFO : Recall score for label_class 2: 0.9030
2024-08-15 17:50:34,873 : INFO : Average F1 score: 0.9152
2024-08-15 17:50:34,873 : INFO : Determining test scores of final model.
2024-08-15 17:50:35,244 : INFO : Accuracy: 0.8756
2024-08-15 17:50:35,244 : INFO : Precision score for label_class 0: 0.8352
2024-08-15 17:50:35,244 : INFO : Precision score for label_class 1: 0.9112
2024-08-15 17:50:35,244 : INFO : Precision score for label_class 2: 0.8080
2024-08-15 17:50:35,244 : INFO : Recall score for label_class 0: 0.7600
2024-08-15 17:50:35,244 : INFO : Recall score for label_class 1: 0.9198
2024-08-15 17:50:35,244 : INFO : Recall score for label_class 2: 0.8227
2024-08-15 17:50:35,244 : INFO : Average F1 score: 0.8422
